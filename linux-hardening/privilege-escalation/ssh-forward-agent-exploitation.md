<details>

<summary><strong>Aprende hacking en AWS desde cero hasta convertirte en un experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** Consulta los [**PLANES DE SUSCRIPCI칍N**](https://github.com/sponsors/carlospolop)!
* Obt칠n la [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci칩n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **칔nete al** 游눫 [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤gueme en** **Twitter** 游냕 [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositorios de github.

</details>


# Resumen

쯈u칠 puedes hacer si descubres dentro de la configuraci칩n `/etc/ssh_config` o dentro de `$HOME/.ssh/config` esto:
```
ForwardAgent yes
```
Si eres root dentro de la m치quina, probablemente puedas **acceder a cualquier conexi칩n ssh realizada por cualquier agente** que encuentres en el directorio _/tmp_

Suplantar a Bob utilizando uno de los ssh-agent de Bob:
```bash
SSH_AUTH_SOCK=/tmp/ssh-haqzR16816/agent.16816 ssh bob@boston
```
## 쯇or qu칠 funciona esto?

Cuando estableces la variable `SSH_AUTH_SOCK`, est치s accediendo a las claves de Bob que se han utilizado en la conexi칩n ssh de Bob. Entonces, si su clave privada todav칤a est치 all칤 (normalmente lo estar치), podr치s acceder a cualquier host us치ndola.

Como la clave privada se guarda en la memoria del agente sin cifrar, supongo que si eres Bob pero no conoces la contrase침a de la clave privada, a칰n puedes acceder al agente y usarla.

Otra opci칩n es que el usuario propietario del agente y root puedan acceder a la memoria del agente y extraer la clave privada.

# Explicaci칩n detallada y explotaci칩n

**Consulta la [investigaci칩n original aqu칤](https://www.clockwork.com/insights/ssh-agent-hijacking/)**
