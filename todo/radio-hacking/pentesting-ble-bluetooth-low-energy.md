# Pentesting BLE - Bluetooth Low Energy

<details>

<summary><strong>AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§å­¦ã¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•ï¼š

* **HackTricksã§ä¼æ¥­ã‚’å®£ä¼ã—ãŸã„**ã¾ãŸã¯**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„**å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASSï¼†HackTricksã‚¹ãƒ¯ãƒƒã‚°**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã™ã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¦‹ã¤ã‘ã‚‹
* \*\*ğŸ’¬ [Discordã‚°ãƒ«ãƒ¼ãƒ—](https://discord.gg/hRep4RUj7f)\*\*ã«å‚åŠ ã™ã‚‹ã‹ã€[telegramã‚°ãƒ«ãƒ¼ãƒ—](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks\_live)ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹
* **ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€**[**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>

## ã¯ã˜ã‚ã«

Bluetooth 4.0ä»•æ§˜ä»¥é™åˆ©ç”¨å¯èƒ½ãªBLEã¯ã€2400ã‹ã‚‰2483.5 MHzã®ç¯„å›²ã‚’ã‚«ãƒãƒ¼ã™ã‚‹40ãƒãƒ£ãƒ³ãƒãƒ«ã®ã¿ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã“ã‚Œã«å¯¾ã—ã¦ã€å¾“æ¥ã®Bluetoothã¯åŒã˜ç¯„å›²ã§79ãƒãƒ£ãƒ³ãƒãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

BLEãƒ‡ãƒã‚¤ã‚¹ãŒé€šä¿¡ã™ã‚‹æ–¹æ³•ã¯ã€**åºƒå‘Šãƒ‘ã‚±ãƒƒãƒˆ**ï¼ˆ**ãƒ“ãƒ¼ã‚³ãƒ³**ï¼‰ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šè¡Œã‚ã‚Œã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ‘ã‚±ãƒƒãƒˆã¯BLEãƒ‡ãƒã‚¤ã‚¹ã®å­˜åœ¨ã‚’ä»–ã®è¿‘ãã®ãƒ‡ãƒã‚¤ã‚¹ã«ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ“ãƒ¼ã‚³ãƒ³ã¯æ™‚ã€…**ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡**ã™ã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚

ãƒªã‚¹ãƒ‹ãƒ³ã‚°ãƒ‡ãƒã‚¤ã‚¹ã€ã¾ãŸã¯ã‚»ãƒ³ãƒˆãƒ©ãƒ«ãƒ‡ãƒã‚¤ã‚¹ã¨ã‚‚å‘¼ã°ã‚Œã‚‹ãƒ‡ãƒã‚¤ã‚¹ã¯ã€åºƒå‘Šãƒ‘ã‚±ãƒƒãƒˆã«**ã‚¹ã‚­ãƒ£ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã§ã€åºƒå‘Šãƒ‡ãƒã‚¤ã‚¹ã«ç‰¹å®šã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã§ãã¾ã™ã€‚ãã®ã‚¹ã‚­ãƒ£ãƒ³ã¸ã®**å¿œç­”**ã¯ã€åˆæœŸã®åºƒå‘Šãƒªã‚¯ã‚¨ã‚¹ãƒˆã«åã¾ã‚‰ãªã‹ã£ãŸè¿½åŠ æƒ…å ±ã‚’å«ã‚€åŒã˜æ§‹é€ ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã“ã‚Œã«ã¯ã€ãƒ‡ãƒã‚¤ã‚¹ã®å®Œå…¨ãªåå‰ãªã©ãŒå«ã¾ã‚Œã¾ã™ã€‚

![](<../../.gitbook/assets/image (201) (2) (1) (1).png>)

ãƒ—ãƒªã‚¢ãƒ³ãƒ–ãƒ«ãƒã‚¤ãƒˆã¯å‘¨æ³¢æ•°ã‚’åŒæœŸã•ã›ã€4ãƒã‚¤ãƒˆã®ã‚¢ã‚¯ã‚»ã‚¹ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯**æ¥ç¶šè­˜åˆ¥å­**ã§ã‚ã‚Šã€è¤‡æ•°ã®ãƒ‡ãƒã‚¤ã‚¹ãŒåŒã˜ãƒãƒ£ãƒ³ãƒãƒ«ã§æ¥ç¶šã‚’ç¢ºç«‹ã—ã‚ˆã†ã¨ã—ã¦ã„ã‚‹ã‚·ãƒŠãƒªã‚ªã§ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚æ¬¡ã«ã€ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ¦ãƒ‹ãƒƒãƒˆï¼ˆ**PDU**ï¼‰ã«ã¯**åºƒå‘Šãƒ‡ãƒ¼ã‚¿**ãŒå«ã¾ã‚Œã¾ã™ã€‚ã„ãã¤ã‹ã®ç¨®é¡ã®PDUãŒã‚ã‚Šã¾ã™ãŒã€æœ€ã‚‚ä¸€èˆ¬çš„ã«ä½¿ç”¨ã•ã‚Œã‚‹ã®ã¯ADV\_NONCONN\_INDã¨ADV\_INDã§ã™ã€‚ãƒ‡ãƒã‚¤ã‚¹ã¯ã€**æ¥ç¶šã‚’å—ã‘å…¥ã‚Œãªã„**å ´åˆã¯ADV\_NONCONN\_IND PDUã‚¿ã‚¤ãƒ—ã‚’ä½¿ç”¨ã—ã€ãƒ‡ãƒ¼ã‚¿ã‚’åºƒå‘Šãƒ‘ã‚±ãƒƒãƒˆã§ã®ã¿é€ä¿¡ã—ã¾ã™ã€‚ãƒ‡ãƒã‚¤ã‚¹ã¯ã€**æ¥ç¶šã‚’è¨±å¯ã—**ã€**æ¥ç¶š**ãŒ**ç¢ºç«‹**ã•ã‚Œã‚‹ã¨**åºƒå‘Š**ãƒ‘ã‚±ãƒƒãƒˆã®é€ä¿¡ã‚’**åœæ­¢**ã™ã‚‹å ´åˆã¯**ADV\_IND**ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

### GATT

**Generic Attribute Profile**ï¼ˆGATTï¼‰ã¯ã€**ãƒ‡ãƒã‚¤ã‚¹ãŒãƒ‡ãƒ¼ã‚¿ã‚’ã©ã®ã‚ˆã†ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã—ã¦è»¢é€ã™ã‚‹ã‹**ã‚’å®šç¾©ã—ã¾ã™ã€‚BLEãƒ‡ãƒã‚¤ã‚¹ã®æ”»æ’ƒå¯¾è±¡ã‚’åˆ†æã™ã‚‹éš›ã«ã¯ã€GATTï¼ˆã¾ãŸã¯GATTsï¼‰ã«æ³¨æ„ã‚’é›†ä¸­ã™ã‚‹ã“ã¨ãŒå¤šã„ã§ã™ã€‚ãªãœãªã‚‰ã€ã“ã‚ŒãŒ**ãƒ‡ãƒã‚¤ã‚¹æ©Ÿèƒ½ãŒãƒˆãƒªã‚¬ãƒ¼ã•ã‚Œã‚‹æ–¹æ³•**ã‚„ãƒ‡ãƒ¼ã‚¿ãŒæ ¼ç´ã€ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã€å¤‰æ›´ã•ã‚Œã‚‹æ–¹æ³•ã ã‹ã‚‰ã§ã™ã€‚GATTã¯ã€ãƒ‡ãƒã‚¤ã‚¹ã®ç‰¹æ€§ã€è¨˜è¿°å­ã€ãŠã‚ˆã³ã‚µãƒ¼ãƒ“ã‚¹ã‚’16ãƒ“ãƒƒãƒˆã¾ãŸã¯32ãƒ“ãƒƒãƒˆã®å€¤ã¨ã—ã¦è¡¨ã«ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚**ç‰¹æ€§**ã¯ã€ã‚»ãƒ³ãƒˆãƒ©ãƒ«ãƒ‡ãƒã‚¤ã‚¹ã¨ãƒšãƒªãƒ•ã‚§ãƒ©ãƒ«é–“ã§**é€ä¿¡ã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿**å€¤ã§ã™ã€‚ã“ã‚Œã‚‰ã®ç‰¹æ€§ã«ã¯ã€**ãã‚Œã«é–¢ã™ã‚‹è¿½åŠ æƒ…å ±ã‚’æä¾›ã™ã‚‹\*\*\*\*è¨˜è¿°å­**ãŒä»˜å±ã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚**ç‰¹æ€§**ã¯ã€ç‰¹å®šã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«é–¢é€£ã—ã¦ã„ã‚‹å ´åˆã€**ã‚µãƒ¼ãƒ“ã‚¹**ã«**ã‚°ãƒ«ãƒ¼ãƒ—åŒ–**ã•ã‚Œã‚‹ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã€‚

## åˆ—æŒ™

```bash
hciconfig #Check config, check if UP or DOWN
# If DOWN try:
sudo modprobe -c bluetooth
sudo hciconfig hci0 down && sudo hciconfig hci0 up

# Spoof MAC
spooftooph -i hci0 -a 11:22:33:44:55:66
```

### GATTool

**GATTool**ã¯ã€ä»–ã®ãƒ‡ãƒã‚¤ã‚¹ã¨ã®**æ¥ç¶š**ã‚’**ç¢ºç«‹**ã—ã€ãã®ãƒ‡ãƒã‚¤ã‚¹ã®**ç‰¹æ€§**ã‚’ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—ã—ã€ãã®å±æ€§ã‚’èª­ã¿æ›¸ãã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\
GATTToolã¯ã€`-I`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦å¯¾è©±å‹ã‚·ã‚§ãƒ«ã‚’èµ·å‹•ã§ãã¾ã™ï¼š

```bash
gatttool -i hci0 -I
[ ][LE]> connect 24:62:AB:B1:A8:3E Attempting to connect to A4:CF:12:6C:B3:76 Connection successful
[A4:CF:12:6C:B3:76][LE]> characteristics
handle: 0x0002, char properties: 0x20, char value handle:
0x0003, uuid: 00002a05-0000-1000-8000-00805f9b34fb
handle: 0x0015, char properties: 0x02, char value handle:
0x0016, uuid: 00002a00-0000-1000-8000-00805f9b34fb
[...]

# Write data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-write-req <characteristic handle> -n <value>
gatttool -b a4:cf:12:6c:b3:76 --char-write-req -a 0x002e -n $(echo -n "04dc54d9053b4307680a"|xxd -ps)

# Read data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-read -a 0x16

# Read connecting with an authenticated encrypted connection
gatttool --sec-level=high -b a4:cf:12:6c:b3:76 --char-read -a 0x002c
```

### Bettercap

### ãƒ™ã‚¿ãƒ¼ã‚­ãƒ£ãƒƒãƒ—

```bash
# Start listening for beacons
sudo bettercap --eval "ble.recon on"
# Wait some time
>> ble.show # Show discovered devices
>> ble.enum <mac addr> # This will show the service, characteristics and properties supported

# Write data in a characteristic
>> ble.write <MAC ADDR> <UUID> <HEX DATA>
>> ble.write <mac address of device> ff06 68656c6c6f # Write "hello" in ff06
```

<details>

<summary><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>ã‚’é€šã˜ã¦ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã¶</strong></a><strong>ï¼</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•ï¼š

* **HackTricksã§ä¼æ¥­ã‚’å®£ä¼ã—ãŸã„**ã¾ãŸã¯**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„**å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASSï¼†HackTricksã‚¹ãƒ¯ãƒƒã‚°**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã™ã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã€å½“ç¤¾ã®ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç™ºè¦‹ã™ã‚‹
* **ğŸ’¬** [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)**ã¾ãŸã¯**[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)**ã«å‚åŠ ã™ã‚‹ã‹ã€Twitter ğŸ¦** [**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã§**ãƒ•ã‚©ãƒ­ãƒ¼\*\*ã™ã‚‹ã€‚
* **ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«PRã‚’** [**HackTricks**](https://github.com/carlospolop/hacktricks) **ãŠã‚ˆã³** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«æå‡ºã™ã‚‹ã€‚**

</details>
