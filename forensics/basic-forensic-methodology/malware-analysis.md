<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- VocÃª trabalha em uma **empresa de seguranÃ§a cibernÃ©tica**? VocÃª quer ver sua **empresa anunciada no HackTricks**? ou vocÃª quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!

- Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)

- **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Compartilhe suas tÃ©cnicas de hacking enviando PRs para o [repositÃ³rio hacktricks](https://github.com/carlospolop/hacktricks) e [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


# Folhas de dicas de Forense

[https://www.jaiminton.com/cheatsheet/DFIR/#](https://www.jaiminton.com/cheatsheet/DFIR/#)

# ServiÃ§os Online

* [VirusTotal](https://www.virustotal.com/gui/home/upload)
* [HybridAnalysis](https://www.hybrid-analysis.com)
* [Koodous](https://koodous.com)
* [Intezer](https://analyze.intezer.com)

# Ferramentas Offline de AntivÃ­rus e DetecÃ§Ã£o

## Yara

### Instalar
```bash
sudo apt-get install -y yara
```
### Preparar regras

Use este script para baixar e mesclar todas as regras de malware yara do github: [https://gist.github.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9](https://gist.github.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9)\
Crie o diretÃ³rio _**rules**_ e execute-o. Isso criarÃ¡ um arquivo chamado _**malware\_rules.yar**_ que contÃ©m todas as regras yara para malware.
```bash
wget https://gist.githubusercontent.com/andreafortuna/29c6ea48adf3d45a979a78763cdc7ce9/raw/4ec711d37f1b428b63bed1f786b26a0654aa2f31/malware_yara_rules.py
mkdir rules
python malware_yara_rules.py
```
### VerificaÃ§Ã£o
```bash
yara -w malware_rules.yar image  #Scan 1 file
yara -w malware_rules.yar folder #Scan the whole folder
```
### YaraGen: Verificar malware e criar regras

VocÃª pode usar a ferramenta [**YaraGen**](https://github.com/Neo23x0/yarGen) para gerar regras yara a partir de um binÃ¡rio. Confira estes tutoriais: [**Parte 1**](https://www.nextron-systems.com/2015/02/16/write-simple-sound-yara-rules/), [**Parte 2**](https://www.nextron-systems.com/2015/10/17/how-to-write-simple-but-sound-yara-rules-part-2/), [**Parte 3**](https://www.nextron-systems.com/2016/04/15/how-to-write-simple-but-sound-yara-rules-part-3/)
```bash
 python3 yarGen.py --update
 python3.exe yarGen.py --excludegood -m  ../../mals/
```
## ClamAV

### InstalaÃ§Ã£o
```
sudo apt-get install -y clamav
```
### VerificaÃ§Ã£o
```bash
sudo freshclam      #Update rules
clamscan filepath   #Scan 1 file
clamscan folderpath #Scan the whole folder
```
## IOCs

IOC significa Indicador de Comprometimento. Um IOC Ã© um conjunto de **condiÃ§Ãµes que identificam** algum software potencialmente indesejado ou **malware** confirmado. As equipes de seguranÃ§a (Blue Teams) usam esse tipo de definiÃ§Ã£o para **procurar por esse tipo de arquivos maliciosos** em seus **sistemas** e **redes**.\
Compartilhar essas definiÃ§Ãµes Ã© muito Ãºtil, pois quando um malware Ã© identificado em um computador e um IOC para esse malware Ã© criado, outras equipes de seguranÃ§a podem usÃ¡-lo para identificar o malware mais rapidamente.

Uma ferramenta para criar ou modificar IOCs Ã© o [**IOC Editor**](https://www.fireeye.com/services/freeware/ioc-editor.html)**.**\
VocÃª pode usar ferramentas como o [**Redline**](https://www.fireeye.com/services/freeware/redline.html) para **procurar por IOCs definidos em um dispositivo**.

## Loki

[**Loki**](https://github.com/Neo23x0/Loki) Ã© um scanner para Indicadores Simples de Comprometimento.\
A detecÃ§Ã£o Ã© baseada em quatro mÃ©todos de detecÃ§Ã£o:
```
1. File Name IOC
   Regex match on full file path/name

2. Yara Rule Check
   Yara signature matches on file data and process memory

3. Hash Check
   Compares known malicious hashes (MD5, SHA1, SHA256) with scanned files
   
4. C2 Back Connect Check
   Compares process connection endpoints with C2 IOCs (new since version v.10)
```
## Linux Malware Detect

[**Linux Malware Detect (LMD)**](https://www.rfxn.com/projects/linux-malware-detect/) Ã© um scanner de malware para Linux lanÃ§ado sob a licenÃ§a GNU GPLv2, que Ã© projetado em torno das ameaÃ§as enfrentadas em ambientes hospedados compartilhados. Ele usa dados de ameaÃ§as de sistemas de detecÃ§Ã£o de intrusÃ£o de borda de rede para extrair malware que estÃ¡ sendo usado ativamente em ataques e gera assinaturas para detecÃ§Ã£o. AlÃ©m disso, os dados de ameaÃ§as tambÃ©m sÃ£o derivados de envios de usuÃ¡rios com o recurso de checkout LMD e recursos da comunidade de malware.

## rkhunter

Ferramentas como [**rkhunter**](http://rkhunter.sourceforge.net) podem ser usadas para verificar o sistema de arquivos em busca de possÃ­veis **rootkits** e malware.
```bash
sudo ./rkhunter --check -r / -l /tmp/rkhunter.log [--report-warnings-only] [--skip-keypress]
```
## PEpper

[PEpper](https://github.com/Th3Hurrican3/PEpper) verifica algumas coisas bÃ¡sicas dentro do executÃ¡vel (dados binÃ¡rios, entropia, URLs e IPs, algumas regras yara).

## NeoPI

[**NeoPI**](https://github.com/CiscoCXSecurity/NeoPI) Ã© um script Python que usa uma variedade de **mÃ©todos estatÃ­sticos** para detectar conteÃºdo **ofuscado** e **criptografado** dentro de arquivos de texto/script. O objetivo do NeoPI Ã© ajudar na **detecÃ§Ã£o de cÃ³digo de shell da web oculto**.

## **php-malware-finder**

[**PHP-malware-finder**](https://github.com/nbs-system/php-malware-finder) faz o seu melhor para detectar cÃ³digo **ofuscado**/**suspeito** e arquivos que usam funÃ§Ãµes **PHP** frequentemente usadas em **malwares**/shell da web.

## Assinaturas BinÃ¡rias da Apple

Ao verificar alguma **amostra de malware**, vocÃª sempre deve **verificar a assinatura** do binÃ¡rio, pois o **desenvolvedor** que o assinou pode jÃ¡ estar **relacionado** com **malware**.
```bash
#Get signer
codesign -vv -d /bin/ls 2>&1 | grep -E "Authority|TeamIdentifier"

#Check if the appâ€™s contents have been modified
codesign --verify --verbose /Applications/Safari.app

#Check if the signature is valid
spctl --assess --verbose /Applications/Safari.app
```
# TÃ©cnicas de DetecÃ§Ã£o

## Empilhamento de Arquivos

Se vocÃª sabe que uma pasta contendo os **arquivos** de um servidor web foi **atualizada pela Ãºltima vez em uma determinada data**. **Verifique** a **data** em que todos os **arquivos** do **servidor web foram criados e modificados** e se alguma data for **suspeita**, verifique esse arquivo.

## Baselines

Se os arquivos de uma pasta **nÃ£o deveriam ter sido modificados**, vocÃª pode calcular o **hash** dos **arquivos originais** da pasta e **comparÃ¡-los** com os **atuais**. Qualquer coisa modificada serÃ¡ **suspeita**.

## AnÃ¡lise EstatÃ­stica

Quando as informaÃ§Ãµes sÃ£o salvas em logs, vocÃª pode **verificar estatÃ­sticas como quantas vezes cada arquivo de um servidor web foi acessado, jÃ¡ que um web shell pode ser um dos mais**.
