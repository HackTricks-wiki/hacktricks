<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚

- [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚

- [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[hacktricksãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks)ã¨[hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks-cloud)ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>


# ã¯ã˜ã‚ã«

Bluetooth 4.0ã®ä»•æ§˜ã‹ã‚‰åˆ©ç”¨å¯èƒ½ãªBLEã¯ã€2400ã€œ2483.5 MHzã®ç¯„å›²ã§40ãƒãƒ£ãƒ³ãƒãƒ«ã®ã¿ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ä¸€æ–¹ã€å¾“æ¥ã®Bluetoothã¯åŒã˜ç¯„å›²ã§79ãƒãƒ£ãƒ³ãƒãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

BLEãƒ‡ãƒã‚¤ã‚¹ã¯ã€**åºƒå‘Šãƒ‘ã‚±ãƒƒãƒˆ**ï¼ˆ**ãƒ“ãƒ¼ã‚³ãƒ³**ï¼‰ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã§ã€ä»–ã®è¿‘ãã®ãƒ‡ãƒã‚¤ã‚¹ã«BLEãƒ‡ãƒã‚¤ã‚¹ã®å­˜åœ¨ã‚’ä¼ãˆã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ“ãƒ¼ã‚³ãƒ³ã¯ã€æ™‚ã«ã¯**ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡**ã™ã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚

ãƒªã‚¹ãƒ‹ãƒ³ã‚°ãƒ‡ãƒã‚¤ã‚¹ï¼ˆã¾ãŸã¯ã‚»ãƒ³ãƒˆãƒ©ãƒ«ãƒ‡ãƒã‚¤ã‚¹ï¼‰ã¯ã€åºƒå‘Šãƒ‘ã‚±ãƒƒãƒˆã«å¯¾ã—ã¦**ã‚¹ã‚­ãƒ£ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã§ã€åºƒå‘Šãƒ‡ãƒã‚¤ã‚¹ã«ç‰¹å®šã®ã‚¹ã‚­ãƒ£ãƒ³ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚ãã®ã‚¹ã‚­ãƒ£ãƒ³ã¸ã®**å¿œç­”**ã¯ã€åˆæœŸã®åºƒå‘Šãƒªã‚¯ã‚¨ã‚¹ãƒˆã«åã¾ã‚‰ãªã‹ã£ãŸè¿½åŠ æƒ…å ±ã‚’å«ã‚€ã€åŒã˜æ§‹é€ ã®**åºƒå‘Š**ãƒ‘ã‚±ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¾ã™ã€‚è¿½åŠ æƒ…å ±ã«ã¯ã€ãƒ‡ãƒã‚¤ã‚¹ã®å®Œå…¨ãªãƒ‡ãƒã‚¤ã‚¹åãªã©ãŒå«ã¾ã‚Œã¾ã™ã€‚

![](<../.gitbook/assets/image (201) (2) (1) (1).png>)

ãƒ—ãƒªã‚¢ãƒ³ãƒ–ãƒ«ãƒã‚¤ãƒˆã¯å‘¨æ³¢æ•°ã‚’åŒæœŸã•ã›ã€4ãƒã‚¤ãƒˆã®ã‚¢ã‚¯ã‚»ã‚¹ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯è¤‡æ•°ã®ãƒ‡ãƒã‚¤ã‚¹ãŒåŒã˜ãƒãƒ£ãƒ³ãƒãƒ«ã§æ¥ç¶šã‚’ç¢ºç«‹ã—ã‚ˆã†ã¨ã™ã‚‹ã‚·ãƒŠãƒªã‚ªã§ä½¿ç”¨ã•ã‚Œã‚‹**æ¥ç¶šè­˜åˆ¥å­**ã§ã™ã€‚æ¬¡ã«ã€ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ¦ãƒ‹ãƒƒãƒˆï¼ˆ**PDU**ï¼‰ã«ã¯**åºƒå‘Šãƒ‡ãƒ¼ã‚¿**ãŒå«ã¾ã‚Œã¾ã™ã€‚ã„ãã¤ã‹ã®ç¨®é¡ã®PDUãŒã‚ã‚Šã¾ã™ãŒã€æœ€ã‚‚ä¸€èˆ¬çš„ã«ä½¿ç”¨ã•ã‚Œã‚‹ã®ã¯ADV\_NONCONN\_INDã¨ADV\_INDã§ã™ã€‚ãƒ‡ãƒã‚¤ã‚¹ã¯ã€**æ¥ç¶šã‚’å—ã‘å…¥ã‚Œãªã„**å ´åˆã¯**ADV\_NONCONN\_IND** PDUã‚¿ã‚¤ãƒ—ã‚’ä½¿ç”¨ã—ã€ãƒ‡ãƒ¼ã‚¿ã‚’åºƒå‘Šãƒ‘ã‚±ãƒƒãƒˆã®ã¿ã§é€ä¿¡ã—ã¾ã™ã€‚ãƒ‡ãƒã‚¤ã‚¹ã¯ã€**æ¥ç¶šã‚’è¨±å¯**ã—ã€**æ¥ç¶š**ãŒ**ç¢ºç«‹**ã•ã‚Œã‚‹ã¨**åºƒå‘Š**ãƒ‘ã‚±ãƒƒãƒˆã®é€ä¿¡ã‚’åœæ­¢ã™ã‚‹å ´åˆã¯**ADV\_IND**ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

## GATT

**Generic Attribute Profile**ï¼ˆGATTï¼‰ã¯ã€**ãƒ‡ãƒã‚¤ã‚¹ãŒãƒ‡ãƒ¼ã‚¿ã‚’ã©ã®ã‚ˆã†ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã—ã€è»¢é€ã™ã‚‹ã‹**ã‚’å®šç¾©ã—ã¾ã™ã€‚BLEãƒ‡ãƒã‚¤ã‚¹ã®æ”»æ’ƒå¯¾è±¡ã‚’åˆ†æã™ã‚‹éš›ã«ã¯ã€GATTï¼ˆã¾ãŸã¯GATTsï¼‰ã«æ³¨ç›®ã™ã‚‹ã“ã¨ãŒå¤šã„ã§ã™ã€‚ãªãœãªã‚‰ã€ãƒ‡ãƒã‚¤ã‚¹ã®æ©Ÿèƒ½ãŒãƒˆãƒªã‚¬ãƒ¼ã•ã‚Œã€ãƒ‡ãƒ¼ã‚¿ãŒæ ¼ç´ã€ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã€å¤‰æ›´ã•ã‚Œã‚‹æ–¹æ³•ãŒGATTã«ã‚ˆã£ã¦æ±ºã¾ã‚‹ã‹ã‚‰ã§ã™ã€‚GATTã¯ã€ãƒ‡ãƒã‚¤ã‚¹ã®ç‰¹æ€§ã€ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ã€ãŠã‚ˆã³ã‚µãƒ¼ãƒ“ã‚¹ã‚’16ãƒ“ãƒƒãƒˆã¾ãŸã¯32ãƒ“ãƒƒãƒˆã®å€¤ã¨ã—ã¦è¡¨ã™ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã—ã¦ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—ã•ã‚Œã¾ã™ã€‚**ç‰¹æ€§**ã¯ã€ã‚»ãƒ³ãƒˆãƒ©ãƒ«ãƒ‡ãƒã‚¤ã‚¹ã¨ãƒšãƒªãƒ•ã‚§ãƒ©ãƒ«é–“ã§**é€ä¿¡**ã•ã‚Œã‚‹**ãƒ‡ãƒ¼ã‚¿å€¤**ã§ã™ã€‚ã“ã‚Œã‚‰ã®ç‰¹æ€§ã«ã¯ã€**ãã‚Œã«é–¢ã™ã‚‹è¿½åŠ æƒ…å ±ã‚’æä¾›ã™ã‚‹ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿**ãŒã‚ã‚Šã¾ã™ã€‚**ç‰¹æ€§**ã¯ã€ç‰¹å®šã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«é–¢é€£ã—ã¦ã„ã‚‹å ´åˆã€**ã‚µãƒ¼ãƒ“ã‚¹**ã«**ã‚°ãƒ«ãƒ¼ãƒ—åŒ–**ã•ã‚Œã‚‹ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã€‚

# åˆ—æŒ™åŒ–
```bash
hciconfig #Check config, check if UP or DOWN
# If DOWN try:
sudo modprobe -c bluetooth
sudo hciconfig hci0 down && sudo hciconfig hci0 up

# Spoof MAC
spooftooph -i hci0 -a 11:22:33:44:55:66
```
## GATTool

**GATTool**ã¯ã€ä»–ã®ãƒ‡ãƒã‚¤ã‚¹ã¨ã®**æ¥ç¶š**ã‚’**ç¢ºç«‹**ã—ã€ãã®ãƒ‡ãƒã‚¤ã‚¹ã®**ç‰¹æ€§**ã‚’ãƒªã‚¹ãƒˆã—ã€å±æ€§ã®èª­ã¿æ›¸ãã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚\
GATTToolã¯ã€`-I`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦å¯¾è©±å‹ã‚·ã‚§ãƒ«ã‚’èµ·å‹•ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
gatttool -i hci0 -I
[ ][LE]> connect 24:62:AB:B1:A8:3E Attempting to connect to A4:CF:12:6C:B3:76 Connection successful
[A4:CF:12:6C:B3:76][LE]> characteristics
handle: 0x0002, char properties: 0x20, char value handle:
0x0003, uuid: 00002a05-0000-1000-8000-00805f9b34fb
handle: 0x0015, char properties: 0x02, char value handle:
0x0016, uuid: 00002a00-0000-1000-8000-00805f9b34fb
[...]

# Write data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-write-req <characteristic handle> -n <value>
gatttool -b a4:cf:12:6c:b3:76 --char-write-req -a 0x002e -n $(echo -n "04dc54d9053b4307680a"|xxd -ps)

# Read data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-read -a 0x16

# Read connecting with an authenticated encrypted connection
gatttool --sec-level=high -b a4:cf:12:6c:b3:76 --char-read -a 0x002c
```
## Bettercap

Bettercapã¯ã€Bluetooth Low Energyï¼ˆBLEï¼‰ãƒ‡ãƒã‚¤ã‚¹ã®ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆã«ä½¿ç”¨ã•ã‚Œã‚‹å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ã€BLEãƒ‡ãƒã‚¤ã‚¹ã®ã‚¹ã‚­ãƒ£ãƒ³ã€ã‚¹ãƒ‹ãƒƒãƒ•ã‚£ãƒ³ã‚°ã€ã‚¹ãƒ—ãƒ¼ãƒ•ã‚£ãƒ³ã‚°ã€ãŠã‚ˆã³MITMï¼ˆMan-in-the-Middleï¼‰æ”»æ’ƒãªã©ã€ã•ã¾ã–ã¾ãªæ”»æ’ƒæ‰‹æ³•ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

Bettercapã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€BLEãƒ‡ãƒã‚¤ã‚¹ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã«é–¢ã™ã‚‹è„†å¼±æ€§ã‚’ç‰¹å®šã—ã€æ‚ªç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä¾‹ãˆã°ã€ãƒ‡ãƒã‚¤ã‚¹ã®MACã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã‚¹ãƒ—ãƒ¼ãƒ•ã‚£ãƒ³ã‚°ã—ã¦ã€ãƒ‡ãƒã‚¤ã‚¹ã¨ã®é€šä¿¡ã‚’å‚å—ã—ãŸã‚Šã€æ”¹ã–ã‚“ã—ãŸã‚Šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

Bettercapã¯ã€ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆCLIï¼‰ã‚’æä¾›ã—ã¦ãŠã‚Šã€ã‚·ãƒ³ãƒ—ãƒ«ã§ä½¿ã„ã‚„ã™ã„æ“ä½œæ€§ã‚’å‚™ãˆã¦ã„ã¾ã™ã€‚ã•ã‚‰ã«ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½¿ç”¨ã—ã¦ã€æ©Ÿèƒ½ã‚’æ‹¡å¼µã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

Bettercapã¯ã€BLEãƒ‡ãƒã‚¤ã‚¹ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è©•ä¾¡ã‚„ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆã«ãŠã„ã¦ã€éå¸¸ã«æœ‰ç”¨ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ãã®å¼·åŠ›ãªæ©Ÿèƒ½ã¨æŸ”è»Ÿæ€§ã«ã‚ˆã‚Šã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å°‚é–€å®¶ã‚„ãƒãƒƒã‚«ãƒ¼ã¯ã€BLEãƒ‡ãƒã‚¤ã‚¹ã®è„†å¼±æ€§ã‚’ç‰¹å®šã—ã€é©åˆ‡ãªå¯¾ç­–ã‚’è¬›ã˜ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
# Start listening for beacons
sudo bettercap --eval "ble.recon on"
# Wait some time
>> ble.show # Show discovered devices
>> ble.enum <mac addr> # This will show the service, characteristics and properties supported

# Write data in a characteristic
>> ble.write <MAC ADDR> <UUID> <HEX DATA>
>> ble.write <mac address of device> ff06 68656c6c6f # Write "hello" in ff06
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼šç¤¾**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚

- [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚

- [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§ç§ã‚’**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[hacktricksãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks)ã¨[hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks-cloud)**ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>
