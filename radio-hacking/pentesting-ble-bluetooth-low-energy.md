# IntroduÃ§Ã£o

DisponÃ­vel desde a especificaÃ§Ã£o Bluetooth 4.0, o BLE usa apenas 40 canais, cobrindo a faixa de 2400 a 2483,5 MHz. Em contraste, o Bluetooth tradicional usa 79 canais na mesma faixa.

Os dispositivos BLE se comunicam enviando **pacotes de publicidade** (**beacons**), esses pacotes transmitem a existÃªncia do dispositivo BLE para outros dispositivos prÃ³ximos. Esses beacons Ã s vezes **enviam dados** tambÃ©m.

O dispositivo receptor, tambÃ©m chamado de dispositivo central, pode responder a um pacote de publicidade com uma **solicitaÃ§Ã£o de varredura** (**SCAN request**) enviada especificamente para o dispositivo anunciante. A **resposta** a essa varredura usa a mesma estrutura que o **pacote de publicidade** com informaÃ§Ãµes adicionais que nÃ£o puderam ser incluÃ­das na solicitaÃ§Ã£o inicial de publicidade, como o nome completo do dispositivo.

![](<../.gitbook/assets/image (201) (2) (1) (1).png>)

O byte de preÃ¢mbulo sincroniza a frequÃªncia, enquanto o endereÃ§o de acesso de quatro bytes Ã© um **identificador de conexÃ£o**, que Ã© usado em cenÃ¡rios em que vÃ¡rios dispositivos estÃ£o tentando estabelecer conexÃµes nos mesmos canais. Em seguida, a Unidade de Dados do Protocolo (**PDU**) contÃ©m os **dados de publicidade**. Existem vÃ¡rios tipos de PDU; os mais comumente usados sÃ£o ADV\_NONCONN\_IND e ADV\_IND. Os dispositivos usam o tipo de PDU **ADV\_NONCONN\_IND** se eles **nÃ£o aceitam conexÃµes**, transmitindo dados apenas no pacote de publicidade. Os dispositivos usam **ADV\_IND** se eles **permitem conexÃµes** e **param de enviar pacotes de publicidade** assim que uma **conexÃ£o** Ã© **estabelecida**.

## GATT

O **Perfil GenÃ©rico de Atributos** (GATT) define como o **dispositivo deve formatar e transferir dados**. Ao analisar a superfÃ­cie de ataque de um dispositivo BLE, vocÃª geralmente concentra sua atenÃ§Ã£o no GATT (ou GATTs), porque Ã© assim que a **funcionalidade do dispositivo Ã© acionada** e como os dados sÃ£o armazenados, agrupados e modificados. O GATT lista as caracterÃ­sticas, descritores e serviÃ§os de um dispositivo em uma tabela como valores de 16 ou 32 bits. Uma **caracterÃ­stica** Ã© um valor de **dados** **enviado** entre o dispositivo central e o perifÃ©rico. Essas caracterÃ­sticas podem ter **descritores** que **fornecem informaÃ§Ãµes adicionais sobre elas**. **CaracterÃ­sticas** sÃ£o frequentemente **agrupadas** em **serviÃ§os** se estiverem relacionadas Ã  realizaÃ§Ã£o de uma aÃ§Ã£o especÃ­fica.

# EnumeraÃ§Ã£o
```bash
hciconfig #Check config, check if UP or DOWN
# If DOWN try:
sudo modprobe -c bluetooth
sudo hciconfig hci0 down && sudo hciconfig hci0 up

# Spoof MAC
spooftooph -i hci0 -a 11:22:33:44:55:66
```
## GATTool

**GATTool** permite **estabelecer** uma **conexÃ£o** com outro dispositivo, listar as **caracterÃ­sticas** desse dispositivo e ler e escrever seus atributos.\
O GATTTool pode iniciar um shell interativo com a opÃ§Ã£o `-I`:
```bash
gatttool -i hci0 -I
[ ][LE]> connect 24:62:AB:B1:A8:3E Attempting to connect to A4:CF:12:6C:B3:76 Connection successful
[A4:CF:12:6C:B3:76][LE]> characteristics
  handle: 0x0002, char properties: 0x20, char value handle:
  0x0003, uuid: 00002a05-0000-1000-8000-00805f9b34fb
  handle: 0x0015, char properties: 0x02, char value handle:
  0x0016, uuid: 00002a00-0000-1000-8000-00805f9b34fb
[...]

# Write data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-write-req <characteristic handle> -n <value>
gatttool -b a4:cf:12:6c:b3:76 --char-write-req -a 0x002e -n $(echo -n "04dc54d9053b4307680a"|xxd -ps)

# Read data
gatttool -i <Bluetooth adapter interface> -b <MAC address of device> --char-read -a 0x16

# Read connecting with an authenticated encrypted connection
gatttool --sec-level=high -b a4:cf:12:6c:b3:76 --char-read -a 0x002c
```
## Bettercap

Bettercap Ã© um framework de seguranÃ§a de rede que permite a realizaÃ§Ã£o de testes de penetraÃ§Ã£o em redes sem fio. Ele suporta a captura e decodificaÃ§Ã£o de pacotes BLE (Bluetooth Low Energy) e pode ser usado para realizar ataques de spoofing, sniffing e injeÃ§Ã£o de pacotes em dispositivos BLE. O Bettercap tambÃ©m possui recursos para interceptar e modificar o trÃ¡fego de rede, bem como para realizar ataques de phishing e MITM (Man-in-the-Middle).
```bash
# Start listening for beacons
sudo bettercap --eval "ble.recon on"
# Wait some time
>> ble.show # Show discovered devices
>> ble.enum <mac addr> # This will show the service, characteristics and properties supported

# Write data in a characteristic
>> ble.write <MAC ADDR> <UUID> <HEX DATA>
>> ble.write <mac address of device> ff06 68656c6c6f # Write "hello" in ff06
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- VocÃª trabalha em uma **empresa de seguranÃ§a cibernÃ©tica**? VocÃª quer ver sua **empresa anunciada no HackTricks**? ou vocÃª quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!

- Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)

- **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Compartilhe seus truques de hacking enviando PRs para o [repositÃ³rio hacktricks](https://github.com/carlospolop/hacktricks) e [repositÃ³rio hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
