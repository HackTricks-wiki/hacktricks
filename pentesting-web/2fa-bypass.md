# Bypass de 2FA/OTP

<details>

<summary><strong>Aprende hacking en AWS desde cero hasta experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Experto en Red Team de AWS de HackTricks)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** 隆Consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Obt茅n el [**swag oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆guenos** en **Twitter**  [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## WhiteIntel

<figure><img src=".gitbook/assets/image (1224).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) es un motor de b煤squeda alimentado por la **dark web** que ofrece funcionalidades **gratuitas** para verificar si una empresa o sus clientes han sido **comprometidos** por **malwares robadores**.

El objetivo principal de WhiteIntel es combatir los secuestros de cuentas y los ataques de ransomware resultantes de malwares que roban informaci贸n.

Puedes visitar su sitio web y probar su motor de b煤squeda de forma **gratuita** en:

{% embed url="https://whiteintel.io" %}

---

## **T茅cnicas Avanzadas de Bypass de Autenticaci贸n de Dos Factores**

### **Acceso Directo al Punto Final**

Para evitar el 2FA, accede directamente al punto final siguiente, siendo crucial conocer la ruta. Si no tienes 茅xito, modifica el **encabezado Referrer** para simular la navegaci贸n desde la p谩gina de verificaci贸n de 2FA.

### **Reutilizaci贸n de Tokens**

Reutilizar tokens previamente utilizados para la autenticaci贸n dentro de una cuenta puede ser efectivo.

### **Utilizaci贸n de Tokens no Utilizados**

Intentar extraer un token de tu propia cuenta para evitar el 2FA en otra cuenta.

### **Exposici贸n del Token**

Investiga si el token se revela en una respuesta de la aplicaci贸n web.

### **Explotaci贸n del Enlace de Verificaci贸n**

Usar el **enlace de verificaci贸n por correo electr贸nico enviado al crear la cuenta** puede permitir el acceso al perfil sin 2FA, como se destaca en un [post](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b) detallado.

### **Manipulaci贸n de Sesiones**

Iniciar sesiones tanto para la cuenta del usuario como para la de la v铆ctima, y completar el 2FA para la cuenta del usuario sin proceder, permite intentar acceder al siguiente paso en el flujo de la cuenta de la v铆ctima, explotando las limitaciones de gesti贸n de sesiones del backend.

### **Mecanismo de Restablecimiento de Contrase帽a**

Investigar la funci贸n de restablecimiento de contrase帽a, que inicia sesi贸n de un usuario en la aplicaci贸n despu茅s del restablecimiento, por su potencial para permitir m煤ltiples restablecimientos usando el mismo enlace es crucial. Iniciar sesi贸n con las credenciales reci茅n restablecidas podr铆a evitar el 2FA.

### **Compromiso de Plataforma OAuth**

Comprometer la cuenta de un usuario en una plataforma **OAuth** de confianza (por ejemplo, Google, Facebook) puede ofrecer una ruta para evitar el 2FA.

### **Ataques de Fuerza Bruta**

#### **Ausencia de L铆mite de Tasa**

La falta de un l铆mite en el n煤mero de intentos de c贸digo permite ataques de fuerza bruta, aunque se debe considerar la posible limitaci贸n silenciosa de la tasa.

#### **Fuerza Bruta Lenta**

Un ataque de fuerza bruta lento es viable donde existen l铆mites de velocidad de flujo sin un l铆mite general.

#### **Restablecimiento del L铆mite de Reenv铆o de C贸digo**

Reenviar el c贸digo restablece el l铆mite de tasa, facilitando intentos continuos de fuerza bruta.

#### **Circunvalaci贸n del L铆mite de Tasa del Lado del Cliente**

Un documento detalla t茅cnicas para evitar los l铆mites de tasa del lado del cliente.

#### **Acciones Internas sin L铆mite de Tasa**

Los l铆mites de tasa pueden proteger los intentos de inicio de sesi贸n pero no las acciones de cuenta internas.

#### **Costos de Reenv铆o de C贸digo SMS**

El reenv铆o excesivo de c贸digos a trav茅s de SMS incurre en costos para la empresa, aunque no evita el 2FA.

#### **Regeneraci贸n Infinita de OTP**

La generaci贸n infinita de OTP con c贸digos simples permite la fuerza bruta al volver a intentar un peque帽o conjunto de c贸digos.

### **Explotaci贸n de Condiciones de Carrera**

La explotaci贸n de condiciones de carrera para evitar el 2FA se puede encontrar en un documento espec铆fico.

### **Vulnerabilidades de CSRF/Clickjacking**

Explorar vulnerabilidades de CSRF o Clickjacking para deshabilitar el 2FA es una estrategia viable.

### **Explotaci贸n de la Funci贸n "Recu茅rdame"**

#### **Valores de Cookies Predecibles**

Adivinar el valor de la cookie "recu茅rdame" puede evitar restricciones.

#### **Suplantaci贸n de Direcciones IP**

Suplantar la direcci贸n IP de la v铆ctima a trav茅s del encabezado **X-Forwarded-For** puede evitar restricciones.

### **Utilizaci贸n de Versiones Antiguas**

#### **Subdominios**

Probar subdominios puede usar versiones desactualizadas sin soporte de 2FA o contener implementaciones de 2FA vulnerables.

#### **Puntos Finales de API**

Las versiones antiguas de API, indicadas por rutas de directorio /v\*, pueden ser vulnerables a m茅todos de bypass de 2FA.

### **Manejo de Sesiones Anteriores**

Terminar sesiones existentes al activar el 2FA asegura las cuentas contra accesos no autorizados desde sesiones comprometidas.

### **Fallos de Control de Acceso con C贸digos de Respaldo**

La generaci贸n inmediata y la posible recuperaci贸n no autorizada de c贸digos de respaldo al activar el 2FA, especialmente con misconfiguraciones de CORS/vulnerabilidades XSS, plantea un riesgo.

### **Divulgaci贸n de Informaci贸n en la P谩gina de 2FA**

La divulgaci贸n de informaci贸n sensible (por ejemplo, n煤mero de tel茅fono) en la p谩gina de verificaci贸n de 2FA es una preocupaci贸n.

### **Desactivaci贸n del Restablecimiento de Contrase帽a 2FA**

Un proceso que demuestra un posible m茅todo de bypass implica la creaci贸n de cuenta, activaci贸n de 2FA, restablecimiento de contrase帽a y posterior inicio de sesi贸n sin el requisito de 2FA.

### **Solicitudes Se帽uelo**

Utilizar solicitudes se帽uelo para oscurecer los intentos de fuerza bruta o enga帽ar a los mecanismos de limitaci贸n de velocidad agrega otra capa a las estrategias de bypass. Crear tales solicitudes requiere una comprensi贸n matizada de las medidas de seguridad de la aplicaci贸n y los comportamientos de limitaci贸n de velocidad.

## Referencias

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)
