<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- VocÃª trabalha em uma **empresa de seguranÃ§a cibernÃ©tica**? VocÃª quer ver sua **empresa anunciada no HackTricks**? ou vocÃª quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!

- Descubra [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)

- **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) **grupo do Discord** ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Compartilhe suas tÃ©cnicas de hacking enviando PRs para o [repositÃ³rio hacktricks](https://github.com/carlospolop/hacktricks) e [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


# **Burlando autenticaÃ§Ã£o de dois fatores (2FA)**

## **Burla direta**

Para burlar o 2FA, basta **tentar acessar diretamente o prÃ³ximo endpoint** (vocÃª precisa saber o caminho do prÃ³ximo endpoint). Se isso nÃ£o funcionar, tente alterar o **cabeÃ§alho Referrer** como se vocÃª tivesse vindo da pÃ¡gina 2FA.

## **ReutilizaÃ§Ã£o de token**

Talvez vocÃª possa reutilizar um token previamente usado dentro da conta para autenticar.

## Compartilhamento de tokens nÃ£o utilizados

Verifique se vocÃª pode obter o token da sua conta e tente usÃ¡-lo para burlar o 2FA em uma conta diferente.

## Token vazado

O token vazou em uma resposta da aplicaÃ§Ã£o web?

## PermissÃ£o de sessÃ£o

Usando a mesma sessÃ£o, inicie o fluxo usando sua conta e a conta da vÃ­tima. Quando chegar ao ponto 2FA em ambas as contas, conclua o 2FA com sua conta, mas nÃ£o acesse a prÃ³xima parte. Em vez disso, tente acessar a prÃ³xima etapa com o fluxo da conta da vÃ­tima. Se o back-end apenas definir um booleano dentro de suas sessÃµes dizendo que vocÃª passou com sucesso pelo 2FA, vocÃª poderÃ¡ burlar o 2FA da vÃ­tima.

## **FunÃ§Ã£o de redefiniÃ§Ã£o de senha**

Em quase todas as aplicaÃ§Ãµes web, a **funÃ§Ã£o de redefiniÃ§Ã£o de senha faz login automaticamente no usuÃ¡rio** apÃ³s o procedimento de redefiniÃ§Ã£o ser concluÃ­do. Verifique se um **e-mail** Ã© enviado com um **link** para **redefinir a senha** e se vocÃª pode **reutilizar** esse **link** para redefinir a senha **quantas vezes quiser** (mesmo que a vÃ­tima altere seu endereÃ§o de e-mail).

## OAuth

Se vocÃª puder comprometer a conta do usuÃ¡rio em uma plataforma de **OAuth** confiÃ¡vel (Google, Facebook...)

## ForÃ§a bruta

### Falta de limite de taxa

Existe algum limite no nÃºmero de cÃ³digos que vocÃª pode tentar, para que vocÃª possa simplesmente forÃ§ar a entrada? Tenha cuidado com um possÃ­vel limite de taxa "silencioso", sempre tente vÃ¡rios cÃ³digos e depois o real para confirmar a vulnerabilidade.

### Limite de fluxo, mas sem limite de taxa

Nesse caso, hÃ¡ um limite de fluxo (vocÃª tem que forÃ§ar a entrada muito devagar: 1 thread e algum tempo de espera antes de 2 tentativas), mas sem limite de taxa. EntÃ£o, com tempo suficiente, vocÃª pode ser capaz de encontrar o cÃ³digo vÃ¡lido.

### Reenviar cÃ³digo e redefinir o limite

Existe um limite de taxa, mas quando vocÃª "reenvia o cÃ³digo", o mesmo cÃ³digo Ã© enviado e o limite de taxa Ã© redefinido. EntÃ£o, vocÃª pode forÃ§ar a entrada do cÃ³digo enquanto o reenvia, para que o limite de taxa nunca seja atingido.

### Burla de limite de taxa do lado do cliente

{% content-ref url="rate-limit-bypass.md" %}
[rate-limit-bypass.md](rate-limit-bypass.md)
{% endcontent-ref %}

### Falta de limite de taxa na conta do usuÃ¡rio

Ã€s vezes, vocÃª pode configurar o 2FA para algumas aÃ§Ãµes dentro da sua conta (alterar e-mail, senha...). No entanto, mesmo nos casos em que hÃ¡ um limite de taxa quando vocÃª tentou fazer login, nÃ£o hÃ¡ nenhum limite de taxa para proteger as aÃ§Ãµes dentro da conta.

### Falta de limite de taxa ao reenviar o cÃ³digo via SMS

VocÃª nÃ£o poderÃ¡ burlar o 2FA, mas poderÃ¡ desperdiÃ§ar o dinheiro da empresa.

### RegeneraÃ§Ã£o infinita de OTP

Se vocÃª puder **gerar um novo OTP infinitas vezes**, o **OTP Ã© simples o suficiente** (4 nÃºmeros) e vocÃª pode tentar atÃ© 4 ou 5 tokens por OTP gerado, vocÃª pode simplesmente tentar os mesmos 4 ou 5 tokens todas as vezes e gerar OTPs atÃ© que corresponda aos que vocÃª estÃ¡ usando.

## CSRF/Clickjacking

Verifique se hÃ¡ uma vulnerabilidade de Cross Site Request Forgery (CSRF) ou Clickjacking para desativar o 2FA.

## Funcionalidade de lembrar-me

### Cookie adivinhÃ¡vel

Se a funcionalidade "lembrar-me" usa um novo cookie com um cÃ³digo adivinhÃ¡vel, tente adivinhÃ¡-lo.

### EndereÃ§o IP

Se a funcionalidade "lembrar-me" estiver vinculada ao seu endereÃ§o IP, vocÃª pode tentar descobrir o endereÃ§o IP da vÃ­tima e se passar por ela usando o cabeÃ§alho **X-Forwarded-For**.

## VersÃµes antigas

### SubdomÃ­nios

Se vocÃª puder encontrar alguns subdomÃ­nios de "teste" com a funcionalidade de login, eles podem estar usando versÃµes antigas que nÃ£o suportam 2FA (entÃ£o Ã© diretamente
