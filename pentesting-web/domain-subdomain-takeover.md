# Toma de control de Dominio/Subdominio

<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Utiliza [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir y **automatizar flujos de trabajo** f√°cilmente, potenciados por las herramientas comunitarias **m√°s avanzadas**.\
Obt√©n Acceso Hoy:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Toma de control de Dominio

Si descubres alg√∫n dominio (dominio.tld) que **est√° siendo utilizado por alg√∫n servicio dentro del alcance** pero la **empresa** ha p**e**rdido la **propiedad** de este, puedes intentar **registrarlo** (si es lo suficientemente barato) y hacerlo saber a la empresa. Si este dominio est√° recibiendo **informaci√≥n sensible** como una cookie de sesi√≥n a trav√©s del par√°metro **GET** o en el encabezado **Referer**, esto es definitivamente una **vulnerabilidad**.

### Toma de control de Subdominio

Un subdominio de la empresa apunta a un **servicio de terceros con un nombre no registrado**. Si puedes **crear** una **cuenta** en este **servicio de terceros** y **registrar** el **nombre** en uso, puedes realizar la toma de control del subdominio.

Hay varias herramientas con diccionarios para verificar posibles tomas de control:

* [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz)
* [https://github.com/blacklanternsecurity/bbot](https://github.com/blacklanternsecurity/bbot)
* [https://github.com/punk-security/dnsReaper](https://github.com/punk-security/dnsReaper)
* [https://github.com/haccer/subjack](https://github.com/haccer/subjack)
* [https://github.com/anshumanbh/tko-sub](https://github.com/anshumanbh/tko-subs)
* [https://github.com/ArifulProtik/sub-domain-takeover](https://github.com/ArifulProtik/sub-domain-takeover)
* [https://github.com/SaadAhmedx/Subdomain-Takeover](https://github.com/SaadAhmedx/Subdomain-Takeover)
* [https://github.com/Ice3man543/SubOver](https://github.com/Ice3man543/SubOver)
* [https://github.com/m4ll0k/takeover](https://github.com/m4ll0k/takeover)
* [https://github.com/antichown/subdomain-takeover](https://github.com/antichown/subdomain-takeover)
* [https://github.com/musana/mx-takeover](https://github.com/musana/mx-takeover)

#### Escaneo de Subdominios Apropiables con [BBOT](https://github.com/blacklanternsecurity/bbot):

Las verificaciones de toma de control de subdominios est√°n incluidas en la enumeraci√≥n de subdominios predeterminada de BBOT. Las firmas se obtienen directamente de [https://github.com/EdOverflow/can-i-take-over-xyz](https://github.com/EdOverflow/can-i-take-over-xyz).
```bash
bbot -t evilcorp.com -f subdomain-enum
```
### Generaci√≥n de Toma de Subdominio a trav√©s de DNS Wildcard

Cuando se utiliza un comod√≠n DNS en un dominio, cualquier subdominio solicitado de ese dominio que no tenga una direcci√≥n expl√≠citamente diferente se **resolver√° a la misma informaci√≥n**. Esto podr√≠a ser una direcci√≥n IP A, un CNAME...

Por ejemplo, si `*.testing.com` est√° comodinado a `1.1.1.1`. Entonces, `not-existent.testing.com` apuntar√° a `1.1.1.1`.

Sin embargo, si en lugar de apuntar a una direcci√≥n IP, el administrador del sistema lo apunta a un **servicio de terceros a trav√©s de CNAME**, como un **subdominio de github** por ejemplo (`sohomdatta1.github.io`). Un atacante podr√≠a **crear su propia p√°gina de terceros** (en Github en este caso) y decir que `something.testing.com` est√° apuntando all√≠. Debido a que el **CNAME comod√≠n** estar√° de acuerdo, el atacante podr√° **generar subdominios arbitrarios para el dominio de la v√≠ctima apuntando a sus p√°ginas**.

Puedes encontrar un ejemplo de esta vulnerabilidad en el write-up del CTF: [https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api](https://ctf.zeyu2001.com/2022/nitectf-2022/undocumented-js-api)

## Explotando una Toma de Subdominio

**Esta informaci√≥n fue copiada de** [**https://0xpatrik.com/subdomain-takeover/**](https://0xpatrik.com/subdomain-takeover/)

Recientemente, [escrib√≠](https://0xpatrik.com/subdomain-takeover-basics/) sobre los conceptos b√°sicos de la toma de subdominio. Aunque el concepto ahora es generalmente bien entendido, not√© que la gente suele tener dificultades para comprender los riesgos que la toma de subdominio conlleva. En este post, profundizo y cubro los riesgos m√°s notables de _toma de subdominio_ desde mi perspectiva.

_Nota: Algunos riesgos son mitigados impl√≠citamente por el proveedor de la nube. Por ejemplo, cuando la toma de subdominio es posible en Amazon CloudFront, no hay forma de configurar registros TXT para eludir las verificaciones de SPF. Por lo tanto, el post tiene como objetivo proporcionar riesgos sobre la toma general de subdominio. Sin embargo, la mayor√≠a de estos se aplican tambi√©n a los proveedores de la nube._

### Transparencia Para un Navegador <a href="#transparencytoabrowser" id="transparencytoabrowser"></a>

Para comenzar, veamos la resoluci√≥n de DNS donde se involucra CNAME:

![Resoluci√≥n de DNS](https://0xpatrik.com/content/images/2018/05/resolution-2.png)

Nota que el paso #7 solicita _sub.example.com_ en lugar de _anotherdomain.com_. Esto se debe a que el navegador web no es consciente de que _anotherdomain.com_ siquiera existe. Aunque se use un registro CNAME, la barra de URL en el navegador todav√≠a contiene _sub.example.com_. Esta es la **transparencia** para el navegador. Si piensas en eso, el navegador deposita toda su confianza en el resolver de DNS para proporcionar informaci√≥n precisa sobre el dominio. Simplificado, la toma de subdominio es un spoofing de DNS para un dominio particular en todo Internet. ¬øPor qu√©? Porque cualquier navegador que realice la resoluci√≥n de DNS en un dominio afectado recibe un registro A establecido por un atacante. El navegador entonces muestra felizmente lo que sea que reciba de este servidor (pensando que es leg√≠timo).

Un dominio as√≠ crea un escenario perfecto para el phishing. Los atacantes a menudo usan [_typosquatting_](https://en.wikipedia.org/wiki/Typosquatting) o los llamados [_Doppelganger domains_](https://en.wikipedia.org/wiki/Doppelg%C3%A4nger) para imitar el dominio/sitio web leg√≠timo con fines de phishing. Despu√©s de que un atacante toma control de alg√∫n nombre de dominio leg√≠timo, es casi imposible para un usuario regular decir si el contenido en el dominio es proporcionado por una parte leg√≠tima o un atacante. Tomemos por ejemplo un banco aleatorio. Si uno de los subdominios del banco es vulnerable a la toma de subdominio, un atacante puede crear un formulario HTML que imita el formulario de inicio de sesi√≥n al sistema de banca por internet del banco. Luego, un atacante puede ejecutar una campa√±a de phishing dirigido o masivo pidiendo a los usuarios que inicien sesi√≥n y cambien sus contrase√±as. En esta etapa, las contrase√±as son capturadas por un atacante que tiene el control del dominio en cuesti√≥n. La URL proporcionada en el correo electr√≥nico de phishing es un subdominio leg√≠timo de un banco. Por lo tanto, los usuarios no son conscientes de algo malicioso sucediendo. Los filtros de spam y otras medidas de seguridad tambi√©n son menos propensos a marcar el correo electr√≥nico como spam o malicioso porque contiene nombres de dominio con mayor confianza.

De hecho, el nombre de dominio en s√≠ juega un papel significativo en una campa√±a exitosa. Tener un subdominio de quinto nivel vulnerable a la toma de subdominio es mucho menos _"leg√≠timo"_ que tener un subdominio de segundo nivel con alg√∫n nombre de subdominio amigable. Vi varios ejemplos de subdominios perfectos para phishing, incluyendo:

* _purchases.SOMETHING.com_
* _www.SOMETHING.com_
* _online.SOMETHING.com_
* _shop.SOMETHING.com_

Todos ellos vulnerables a la toma de subdominio. Todos ellos eran grandes marcas. ¬øHablando de phishing perfecto?

Sin embargo, las campa√±as de phishing recientes alojan contenido en dominios con nombres de dominio largos que incluyen el nombre de la marca (ver [ejemplo de Apple](https://www.phishtank.com/target\_search.php?target\_id=183\&valid=y\&active=All\&Search=Search)). Teniendo un certificado SSL v√°lido (m√°s sobre eso a continuaci√≥n), una palabra clave en el nombre de dominio y un sitio web que imita el sitio web de la marca objetivo, la gente tiende a caer en estos ataques. Piensa en las posibilidades con un subdominio leg√≠timo de esta marca.

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Usa [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir y **automatizar flujos de trabajo** f√°cilmente, potenciados por las herramientas comunitarias **m√°s avanzadas** del mundo.\
Obt√©n Acceso Hoy:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

### Certificados SSL <a href="#sslcertificates" id="sslcertificates"></a>

El ataque anterior puede ser mejorado generando un certificado SSL v√°lido. Autoridades de certificaci√≥n como [_Let's Encrypt_](https://letsencrypt.org/) permiten la verificaci√≥n autom√°tica de la propiedad de un dominio mediante la verificaci√≥n de contenido:

![Flujo de Let's Encrypt](https://0xpatrik.com/content/images/2018/05/letsencrypt.png)

Es decir, si hay un contenido espec√≠fico colocado en una ruta de URL espec√≠fica, Let's Encrypt aprobar√° la emisi√≥n de un certificado para un dominio dado. Dado que un atacante tiene control total sobre el contenido del dominio que es vulnerable a la toma de subdominio, esta verificaci√≥n se puede realizar en cuesti√≥n de minutos. Por lo tanto, los atacantes tambi√©n son capaces de generar un certificado SSL para dicho dominio, lo que solo disminuye la sospecha de un ataque de phishing.

### Robo de Cookies <a href="#cookiestealing" id="cookiestealing"></a>

Esto va de la mano con la transparencia del navegador pero tiene consecuencias diferentes. El navegador web implementa muchas pol√≠ticas de seguridad para prevenir que sitios web maliciosos causen da√±o. Esto incluye cosas como la [Pol√≠tica del mismo origen](https://en.wikipedia.org/wiki/Same-origin\_policy). Una de las principales responsabilidades de seguridad de un navegador es asegurar las cookies guardadas. ¬øPor qu√©? Mientras que HTTP es un protocolo sin estado, las cookies se utilizan para rastrear sesiones. Por conveniencia, los usuarios a menudo guardan cookies por un per√≠odo extendido para evitar iniciar sesi√≥n cada vez. Estas cookies, por lo tanto, act√∫an como un token de inicio de sesi√≥n que se presenta al servidor web y el usuario es identificado. Ataques como el [_Secuestro de sesi√≥n_](https://en.wikipedia.org/wiki/Session\_hijacking) evolucionaron naturalmente de este concepto.

El navegador presenta autom√°ticamente las cookies almacenadas con cada solicitud al dominio que las emiti√≥. Hay una excepci√≥n a eso, tal que las cookies podr√≠an compartirse entre subdominios ([leer aqu√≠](https://tools.ietf.org/html/rfc6265#section-8.6), tambi√©n nota la secci√≥n 8.7). Esto suele ocurrir cuando el sitio web utiliza un sistema de [Inicio de sesi√≥n √∫nico](https://en.wikipedia.org/wiki/Single\_sign-on) (SSO) basado en cookies. Usando SSO, un usuario puede iniciar sesi√≥n usando un subdominio y compartir el mismo token de sesi√≥n en una amplia gama de subdominios. La sintaxis para establecer una cookie regular es la siguiente:
```
HTTP/1.1 200 OK
Set-Cookie: name=value
```
Si esta cookie es emitida por un servidor web que reside en _example.com_, solo este servidor puede acceder a esta cookie m√°s adelante. Sin embargo, la cookie puede ser emitida para un dominio comod√≠n (por las razones explicadas anteriormente) de la siguiente manera:
```
HTTP/1.1 200 OK
Set-Cookie: name=value; domain=example.com
```
La cookie se incluir√° en las solicitudes HTTP a _example.com_, pero tambi√©n a cualquier otro subdominio como _subdomain.example.com_. Este comportamiento crea una posibilidad de ataques de alta severidad utilizando la toma de control de subdominios. Supongamos que cierto dominio est√° utilizando cookies de sesi√≥n para un dominio comod√≠n. Si hay un subdominio vulnerable a la toma de control de subdominios, lo √∫nico necesario para obtener el token de sesi√≥n del usuario es enga√±arlo para que visite el subdominio vulnerable. La cookie de sesi√≥n se env√≠a autom√°ticamente con la solicitud HTTP.

El navegador tambi√©n implementa mecanismos de seguridad adicionales para las cookies:

* **Cookie HttpOnly** ‚Äî Por defecto, las cookies pueden ser accedidas por c√≥digo Javascript ejecut√°ndose en el contexto del sitio web que cre√≥ las cookies. Javascript puede leer, actualizar y eliminar las cookies. La bandera _HttpOnly_ de la cookie (establecida por el servidor web) indica que la cookie en particular no puede ser accedida por c√≥digo Javascript. La √∫nica forma de obtenerla es a trav√©s de las cabeceras de solicitud y respuesta HTTP.
* **Cookie Secure** ‚Äî Cuando la cookie tiene la bandera _Secure_ establecida por el servidor web, solo puede ser comunicada de vuelta al servidor web si se utiliza HTTPS.

Si el dominio es vulnerable a la toma de control de subdominios, un atacante puede recopilar cookies emitidas por ese dominio en el pasado simplemente enga√±ando a los usuarios para que visiten ese sitio web. Las banderas HttpOnly y Secure no ayudan ya que la cookie no se est√° accediendo mediante Javascript y se puede generar f√°cilmente un certificado SSL para el dominio tomado.

El robo de cookies utilizando la toma de control fue explicado en el [informe](https://hackerone.com/reports/172137) de recompensa por errores por Arne Swinnen. El informe explica el problema con uno de los subdominios de _Ubiquiti Networks_ (_ping.ubnt.com_). Este subdominio era vulnerable a la toma de control de subdominios, apuntando a una distribuci√≥n de AWS CloudFront no reclamada. Dado que Ubiquiti Networks est√° utilizando SSO con cookies de sesi√≥n de dominio comod√≠n, todos los usuarios que visiten _ping.ubnt.com_ podr√≠an tener sus cookies de sesi√≥n robadas. Aunque este dominio apunta a AWS CloudFront, la configuraci√≥n de distribuci√≥n de CloudFront permite registrar cookies con cada solicitud. Por lo tanto, el escenario de extracci√≥n de cookies de sesi√≥n es completamente posible incluso con subdominios que apuntan a AWS CloudFront. En 2017, Arne tambi√©n demostr√≥ un vector de ataque similar contra [el sistema SSO de Uber](https://www.arneswinnen.net/2017/06/authentication-bypass-on-ubers-sso-via-subdomain-takeover/).

El comportamiento explicado anteriormente no se limita a las cookies. Dado que los scripts de Javascript tienen control total sobre los sitios web en los que se ejecutan, tener la capacidad de reemplazar dichos scripts en el sitio web leg√≠timo podr√≠a llevar a consecuencias catastr√≥ficas. Supongamos que el sitio web est√° utilizando c√≥digo Javascript de un proveedor externo utilizando la etiqueta _script_ y el atributo _src_. Cuando el dominio del proveedor externo expira, el navegador falla silenciosamente, es decir, no activa ninguna alerta visible para los usuarios regulares. Si el c√≥digo externo no est√° haciendo nada importante (por ejemplo, solo se utiliza para seguimiento), dicho proveedor externo podr√≠a permanecer en el sitio web durante un per√≠odo prolongado. Un atacante puede tomar control de este dominio expirado, coincidir con la ruta URL del c√≥digo Javascript proporcionado y as√≠ ganar control sobre cada visitante que visite el sitio web original.

Sin embargo, hay una forma de proteger la integridad de los archivos Javascript en un navegador. _Subresource Integrity_ [fue propuesto](https://www.w3.org/TR/2016/REC-SRI-20160623/) como un mecanismo para incluir un hash criptogr√°fico como un atributo _integrity_ a la etiqueta _script_ en HTML5. Cuando el hash criptogr√°fico proporcionado no coincide con el archivo descargado, el navegador se niega a ejecutarlo.

### Correos electr√≥nicos <a href="#emails" id="emails"></a>

Cuando la toma de control de subdominios CNAME es posible, los registros MX tambi√©n pueden ser configurados por un atacante a un servidor web arbitrario. Esto permite recibir correos electr√≥nicos a un subdominio leg√≠timo de alguna marca, particularmente √∫til nuevamente en ataques de (spear) phishing donde es necesaria la interacci√≥n entre un atacante y una v√≠ctima. Los atacantes generalmente falsifican la cabecera `Return-Path` para recibir una respuesta al correo electr√≥nico. Con los registros MX correctos, este problema se evita.

Por otro lado, tambi√©n es posible enviar correos electr√≥nicos. Aunque es trivial falsificar la cabecera `From` para incluir cualquier direcci√≥n de correo electr√≥nico, los filtros SPF suelen comprobar la cabecera `Return-Path` y los hosts permitidos para el env√≠o de correos para el dominio. SPF almacena la configuraci√≥n en registros DNS TXT. Con la toma de control de subdominios, los registros TXT tambi√©n est√°n bajo el control del atacante, por lo que se pueden pasar f√°cilmente las comprobaciones de SPF.

_Como se√±al√© al principio, estas t√°cticas generalmente no funcionan con la mayor√≠a de los proveedores de la nube ya que no tienes control directo sobre la zona DNS._

### Riesgos de Orden Superior <a href="#higherorderrisks" id="higherorderrisks"></a>

El concepto de toma de control de subdominios puede extenderse naturalmente a los registros NS: Si el dominio base de al menos un registro NS est√° disponible para registro, el nombre de dominio fuente es vulnerable a la toma de control de subdominios.

Uno de los problemas en la toma de control de subdominios utilizando el registro NS es que el nombre de dominio fuente generalmente tiene m√∫ltiples registros NS. Se utilizan m√∫ltiples registros NS para redundancia y equilibrio de carga. El servidor de nombres se elige al azar antes de la resoluci√≥n DNS. Supongamos que el dominio _sub.example.com_ tiene dos registros NS: _ns.vulnerable.com_ y _ns.nonvulnerable.com_. Si un atacante toma control de _ns.vulnerable.com_, la situaci√≥n desde la perspectiva del usuario que consulta _sub.example.com_ es la siguiente:

1. Dado que hay dos servidores de nombres, se elige uno al azar. Esto significa que la probabilidad de consultar el servidor de nombres controlado por un atacante es del 50%.
2. Si el resolvedor DNS del usuario elige _ns.nonvulnerable.com_ (servidor de nombres leg√≠timo), se devuelve el resultado correcto y probablemente se almacena en cach√© en alg√∫n lugar entre 6 y 24 horas.
3. Si el resolvedor DNS del usuario elige _ns.vulnerable.com_ (servidor de nombres propiedad de un atacante), un atacante podr√≠a proporcionar un resultado falso que tambi√©n se almacenar√° en cach√©. Dado que un atacante est√° en control del servidor de nombres, ella puede establecer el TTL para este resultado particular, por ejemplo, una semana.

El proceso anterior se repite cada vez que expira la entrada de cach√©. Cuando un atacante elige usar un TTL con un valor alto, el resultado falso permanecer√° en la cach√© DNS durante ese per√≠odo. Durante este tiempo, todas las solicitudes a _sub.example.com_ utilizar√°n el resultado DNS falso almacenado en cach√© por un atacante. Esta idea se amplifica a√∫n m√°s cuando se utilizan resolutores DNS p√∫blicos (por ejemplo, Google DNS). En este caso, es probable que los resolutores p√∫blicos almacenen en cach√© los resultados falsos, lo que significa que todos los usuarios que utilicen el mismo resolvedor DNS obtendr√°n resultados falsos hasta que se revoque la cach√©.

Adem√°s del control sobre el nombre de dominio fuente, tambi√©n se obtiene control sobre todos los dominios de nivel superior del nombre de dominio fuente. Esto se debe a que poseer un nombre de dominio can√≥nico de un registro NS significa poseer la zona DNS completa del nombre de dominio fuente.

En 2016, Matthew Bryant [demostr√≥](https://thehackerblog.com/the-international-incident-gaining-control-of-a-int-domain-name-with-dns-trickery/index.html) una toma de control de subdominios utilizando el registro NS en _maris.int_. El dominio de nivel superior .INT es un TLD especial, y solo un pu√±ado de dominios lo est√°n utilizando. Bryant mostr√≥ que, aunque la registraci√≥n de tales nombres de dominio es aprobada exclusivamente por la IANA, los servidores de nombres pueden configurarse a dominios arbitrarios. Dado que uno de los servidores de nombres de _maris.int_ estaba disponible para registro (_cobalt.aliis.be_), la toma de control de subdominios fue posible incluso en este TLD restringido.

Matthew tambi√©n [demostr√≥](https://thehackerblog.com/the-io-error-taking-control-of-all-io-domains-with-a-targeted-registration/index.html) un ataque de a√∫n mayor severidad donde fue capaz de ganar control sobre el servidor de nombres del dominio de nivel superior .IO. Controlar .IO significa controlar las respuestas para todos los nombres de dominio .IO. En este caso, uno de los servidores de nombres de .IO era _ns-a1.io_, que estaba disponible para registro. Al registrar _ns-a1.io_, Bryant pudo recibir consultas DNS y controlar sus respuestas para todos los dominios .IO.

### Mitigaci√≥n <a href="#mitigation" id="mitigation"></a>

Las estrategias de mitigaci√≥n para nombres de dominio ya vulnerables a la toma de control de subdominios son bastante sencillas:

* **Eliminar el registro DNS afectado** ‚Äî La soluci√≥n m√°s simple es eliminar el registro afectado de la zona DNS. Este paso generalmente se utiliza si la organizaci√≥n concluye que el nombre de dominio fuente afectado ya no es necesario.
* **Reclamar el nombre de dominio** ‚Äî Esto significa registrar el recurso en un proveedor de la nube en particular o, en caso de un dominio de Internet regular, recomprar el dominio expirado.

Para prevenir la toma de control de subdominios en el futuro, las organizaciones deber√≠an cambiar el proceso de creaci√≥n y destrucci√≥n de recursos en su infraestructura. En el caso de la creaci√≥n de recursos, la creaci√≥n del registro DNS tiene que ser el _√∫ltimo paso_ de este proceso. Esta condici√≥n evita que el registro DNS apunte a un dominio inexistente en cualquier momento. Para la destrucci√≥n de recursos, lo contrario es cierto: el registro DNS necesita ser eliminado como el _primer paso_ en este proceso. Herramientas como [aquatone](https://github.com/michenriksen/aquatone) incluyen comprobaciones para la toma de control de subdominios. Las comprobaciones deben ser realizadas peri√≥dicamente por un equipo de seguridad de una organizaci√≥n para verificar que no hay dominios vulnerables. Los procesos para la recopilaci√≥n central de nombres de dominio expuestos a menudo no son eficientes dentro de las organizaciones (debido a equipos globales, etc.) y la monitorizaci√≥n externa suele ser la mejor opci√≥n.

La estrategia de mitigaci√≥n para los proveedores de la nube tambi√©n debe ser considerada. Los servicios en la nube no est√°n verificando la propiedad del dominio. La raz√≥n detr√°s de esto es principalmente la conveniencia. El proveedor de la nube no est√° introduciendo ninguna vulnerabilidad al no verificar la propiedad de un nombre de dominio fuente. Por lo tanto, depende del usuario monitorear sus registros DNS. Otra raz√≥n es que, cuando se elimina un recurso en la nube, el usuario generalmente ya no es cliente de ese servicio. La pregunta que entonces se hacen los proveedores de la nube es: ¬øPor qu√© deber√≠amos preocuparnos?

Proveedores como [GitLab](https://about.gitlab.com/2018/02/05/gitlab-pages-custom-domain-validation/) se dieron cuenta de que la toma de control de subdominios es un problema e implementaron un mecanismo de verificaci√≥n de dominio.

_Algunas partes de esta publicaci√≥n son extractos de mi_ [_Tesis de Maestr√≠a_](https://is.muni.cz/th/byrdn/Thesis.pdf).

¬°Hasta la pr√≥xima!

[Patrik](https://twitter.com/0xpatrik)

<figure><img src="../.gitbook/assets/image (3) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

\
Utiliza [**Trickest**](https://trickest.com/?utm_campaign=hacktrics\&utm_medium=banner\&utm_source=hacktricks) para construir y **automatizar flujos de trabajo** f√°cilmente, impulsados por las herramientas comunitarias **m√°s avanzadas**.\
Obt√©n Acceso Hoy:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF**, consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **√önete al** üí¨ [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶ [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) en github.

</details>
