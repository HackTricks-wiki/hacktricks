# ConfusÃ£o de DependÃªncia

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* VocÃª trabalha em uma **empresa de seguranÃ§a cibernÃ©tica**? VocÃª quer ver sua **empresa anunciada no HackTricks**? ou vocÃª quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) **grupo do Discord** ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live).
* **Compartilhe suas tÃ©cnicas de hacking enviando PRs para o [repositÃ³rio hacktricks](https://github.com/carlospolop/hacktricks) e [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

## InformaÃ§Ãµes BÃ¡sicas

Em resumo, uma vulnerabilidade de confusÃ£o de dependÃªncia ocorre quando um projeto estÃ¡ usando uma biblioteca com um nome **mal escrito**, **inexistente** ou com uma **versÃ£o nÃ£o especificada** e o repositÃ³rio de dependÃªncia usado permite **reunir versÃµes atualizadas de repositÃ³rios pÃºblicos**.

* **Mal escrito**: Importe **`reqests`** em vez de `requests`
* **Inexistente**: Importe `company-logging`, uma biblioteca interna que **nÃ£o existe mais**
* **VersÃ£o nÃ£o especificada**: Importe uma biblioteca interna **existente** `company-requests`, mas o repositÃ³rio verifica **repositÃ³rios pÃºblicos** para ver se hÃ¡ **versÃµes maiores**.

## ExploraÃ§Ã£o

{% hint style="warning" %}
Em todos os casos, o atacante sÃ³ precisa publicar um **pacote malicioso com o nome** das bibliotecas usadas pela empresa vÃ­tima.
{% endhint %}

### Mal Escrito & Inexistente

Se sua empresa estÃ¡ tentando **importar uma biblioteca que nÃ£o Ã© interna**, Ã© altamente provÃ¡vel que o repositÃ³rio de bibliotecas vÃ¡ procurÃ¡-la em **repositÃ³rios pÃºblicos**. Se um atacante a criou, seu cÃ³digo e mÃ¡quinas em execuÃ§Ã£o provavelmente serÃ£o comprometidos.

### VersÃ£o NÃ£o Especificada

Ã‰ muito comum que os desenvolvedores **nÃ£o especifiquem nenhuma versÃ£o** da biblioteca usada ou especifiquem apenas uma **versÃ£o principal**. EntÃ£o, o interpretador tentarÃ¡ baixar a **Ãºltima versÃ£o** que atenda a esses requisitos.\
Se a biblioteca for uma **biblioteca externa conhecida** (como o `requests` do Python), um **atacante nÃ£o pode fazer muito**, pois nÃ£o poderÃ¡ criar uma biblioteca chamada `requests` (a menos que seja o autor original).\
No entanto, se a biblioteca for **interna**, como `requests-company` neste exemplo, se o **repositÃ³rio da biblioteca** permitir **verificar novas versÃµes tambÃ©m externamente**, ele procurarÃ¡ por uma versÃ£o mais recente disponÃ­vel publicamente.\
EntÃ£o, se um **atacante souber** que a empresa estÃ¡ usando a biblioteca `requests-company` **versÃ£o 1.0.1** (permitir atualizaÃ§Ãµes menores). Ele pode **publicar** a biblioteca `requests-company` **versÃ£o 1.0.2** e a empresa irÃ¡ **usar essa biblioteca em vez** da interna.

## CorreÃ§Ã£o da AWS

Essa vulnerabilidade foi encontrada na AWS **CodeArtifact** (leia os [**detalhes neste post do blog**](https://zego.engineering/dependency-confusion-in-aws-codeartifact-86b9ff68963d)).\
A AWS corrigiu isso permitindo especificar se uma biblioteca Ã© interna ou externa, para evitar o download de dependÃªncias internas de repositÃ³rios externos.

## Encontrando Bibliotecas VulnerÃ¡veis

No [**post original sobre confusÃ£o de dependÃªncia**](https://medium.com/@alex.birsan/dependency-confusion-4a5d60fec610), o autor procurou por milhares de arquivos package.json expostos contendo as dependÃªncias de projetos JavaScript.

## ReferÃªncias

* [https://medium.com/@alex.birsan/dependency-confusion-4a5d60fec610](https://medium.com/@alex.birsan/dependency-confusion-4a5d60fec610)
* [https://zego.engineering/dependency-confusion-in-aws-codeartifact-86b9ff68963d](https://zego.engineering/dependency-confusion-in-aws-codeartifact-86b9ff68963d)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* VocÃª trabalha em uma **empresa de seguranÃ§a cibernÃ©tica**? VocÃª quer ver sua **empresa anunciada no HackTricks**? ou vocÃª quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) **grupo do Discord** ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live).
* **Compartilhe suas tÃ©cnicas de hacking enviando PRs para o [repositÃ³rio hacktricks](https://github.com/carlospolop/hacktricks) e [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
