# Bypass de Restablecimiento/Olvido de Contrase帽a

<details>

<summary><strong>Aprende hacking en AWS de cero a h茅roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Experto en Red Team de AWS de HackTricks)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** 隆Consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Obt茅n [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆guenos** en **Twitter**  [**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) en GitHub.

</details>

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

nete al servidor de [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) para comunicarte con hackers experimentados y cazadores de recompensas por errores.

**Informaci贸n sobre Hacking**\
Invol煤crate con contenido que explora la emoci贸n y los desaf铆os del hacking

**Noticias de Hacking en Tiempo Real**\
Mantente al d铆a con el mundo del hacking a trav茅s de noticias e informaci贸n en tiempo real

**ltimos Anuncios**\
Mantente informado sobre los nuevos programas de recompensas por errores que se lanzan y las actualizaciones cruciales de las plataformas

**nete a nosotros en** [**Discord**](https://discord.com/invite/N3FrSbmwdy) y comienza a colaborar con los mejores hackers hoy mismo!

## **Fuga de Token de Restablecimiento de Contrase帽a a trav茅s del Referente**

* El encabezado HTTP referer puede filtrar el token de restablecimiento de contrase帽a si se incluye en la URL. Esto puede ocurrir cuando un usuario hace clic en un enlace de un sitio web de terceros despu茅s de solicitar un restablecimiento de contrase帽a.
* **Impacto**: Posible toma de control de la cuenta a trav茅s de ataques de falsificaci贸n de solicitudes entre sitios (CSRF).
* **Referencias**:
* [Informe de HackerOne 342693](https://hackerone.com/reports/342693)
* [Informe de HackerOne 272379](https://hackerone.com/reports/272379)
* [Art铆culo sobre Fuga de Token de Restablecimiento de Contrase帽a](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Envenenamiento de Restablecimiento de Contrase帽a**

* Los atacantes pueden manipular el encabezado Host durante las solicitudes de restablecimiento de contrase帽a para dirigir el enlace de restablecimiento a un sitio malicioso.
* **Parche**: Utiliza `$_SERVER['SERVER_NAME']` para construir URLs de restablecimiento de contrase帽a en lugar de `$_SERVER['HTTP_HOST']`.
* **Impacto**: Conduce a una posible toma de control de la cuenta al filtrar tokens de restablecimiento a los atacantes.
* **Pasos de Mitigaci贸n**:
* Valida el encabezado Host frente a una lista blanca de dominios permitidos.
* Utiliza m茅todos seguros del lado del servidor para generar URLs absolutas.
* **Referencias**:
* [Art铆culo de Acunetix sobre Envenenamiento de Restablecimiento de Contrase帽a](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **Restablecimiento de Contrase帽a al Manipular el Par谩metro de Correo Electr贸nico**

* Los atacantes pueden manipular la solicitud de restablecimiento de contrase帽a agregando par谩metros de correo electr贸nico adicionales para desviar el enlace de restablecimiento.
* **Pasos de Mitigaci贸n**:
* Analiza y valida adecuadamente los par谩metros de correo electr贸nico del lado del servidor.
* Utiliza declaraciones preparadas o consultas parametrizadas para prevenir ataques de inyecci贸n.
* **Referencias**:
* [Toma de Control de Cuenta en Readme.com](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)

## **Cambio de Correo Electr贸nico y Contrase帽a de cualquier Usuario a trav茅s de Par谩metros de API**

* Los atacantes pueden modificar los par谩metros de correo electr贸nico y contrase帽a en las solicitudes de API para cambiar las credenciales de la cuenta.
* **Pasos de Mitigaci贸n**:
* Asegura una validaci贸n estricta de par谩metros y verificaciones de autenticaci贸n.
* Implementa un registro y monitoreo robustos para detectar y responder a actividades sospechosas.
* **Referencia**:
* [Toma de Control Total de Cuenta a trav茅s de la Manipulaci贸n de Par谩metros de API](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **Sin L铆mite de Tasa: Bombardeo de Correos Electr贸nicos**

* La falta de l铆mites de tasa en las solicitudes de restablecimiento de contrase帽a puede llevar a un bombardeo de correos electr贸nicos, abrumando al usuario con correos de restablecimiento.
* **Pasos de Mitigaci贸n**:
* Implementa l铆mites de tasa basados en la direcci贸n IP o la cuenta de usuario.
* Utiliza desaf铆os CAPTCHA para prevenir abusos automatizados.
* **Referencias**:
* [Informe de HackerOne 280534](https://hackerone.com/reports/280534)

## **Descubre C贸mo se Genera el Token de Restablecimiento de Contrase帽a**

* Comprender el patr贸n o m茅todo detr谩s de la generaci贸n de tokens puede llevar a predecir o realizar fuerza bruta en los tokens.
* **Pasos de Mitigaci贸n**:
* Utiliza m茅todos criptogr谩ficos s贸lidos para la generaci贸n de tokens.
* Asegura suficiente aleatoriedad y longitud para prevenir la predictibilidad.
* **Herramientas**: Utiliza Burp Sequencer para analizar la aleatoriedad de los tokens.

## **GUID Adivinable**

* Si los GUID (por ejemplo, versi贸n 1) son adivinables o predecibles, los atacantes pueden realizar fuerza bruta en ellos para generar tokens de restablecimiento v谩lidos.
* **Pasos de Mitigaci贸n**:
* Utiliza GUID versi贸n 4 para aleatoriedad o implementa medidas de seguridad adicionales para otras versiones.
* **Herramientas**: Utiliza [guidtool](https://github.com/intruder-io/guidtool) para analizar y generar GUIDs.

## **Manipulaci贸n de Respuesta: Reemplazar una Mala Respuesta por una Buena**

* Manipulaci贸n de respuestas HTTP para evadir mensajes de error o restricciones.
* **Pasos de Mitigaci贸n**:
* Implementa verificaciones del lado del servidor para garantizar la integridad de la respuesta.
* Utiliza canales de comunicaci贸n seguros como HTTPS para prevenir ataques de intermediarios.
* **Referencia**:
* [Error Cr铆tico en Evento de Recompensas por Errores en Vivo](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **Uso de Token Expirado**

* Probar si los tokens expirados a煤n pueden ser utilizados para el restablecimiento de contrase帽a.
* **Pasos de Mitigaci贸n**:
* Implementa pol铆ticas estrictas de expiraci贸n de tokens y valida la expiraci贸n del token del lado del servidor.

## **Fuerza Bruta en Token de Restablecimiento de Contrase帽a**

* Intentar realizar fuerza bruta en el token de restablecimiento utilizando herramientas como Burpsuite e IP-Rotator para evadir los l铆mites de tasa basados en IP.
* **Pasos de Mitigaci贸n**:
* Implementa mecanismos robustos de limitaci贸n de tasa y bloqueo de cuentas.
* Monitorea actividades sospechosas que indiquen ataques de fuerza bruta.

## **Intenta Usar tu Token**

* Probar si el token de restablecimiento de un atacante puede ser utilizado junto con el correo electr贸nico de la v铆ctima.
* **Pasos de Mitigaci贸n**:
* Asegura que los tokens est茅n vinculados a la sesi贸n del usuario u otros atributos espec铆ficos del usuario.

## **Invalidaci贸n de Sesi贸n en Cierre de Sesi贸n/Restablecimiento de Contrase帽a**

* Asegurarse de que las sesiones se invaliden cuando un usuario cierra sesi贸n o restablece su contrase帽a.
* **Pasos de Mitigaci贸n**:
* Implementa una gesti贸n adecuada de sesiones, asegurando que todas las sesiones se invaliden al cerrar sesi贸n o restablecer la contrase帽a.

## **Invalidaci贸n de Sesi贸n en Cierre de Sesi贸n/Restablecimiento de Contrase帽a**

* Los tokens de restablecimiento deben tener un tiempo de expiraci贸n despu茅s del cual se vuelven inv谩lidos.
* **Pasos de Mitigaci贸n**:
* Establece un tiempo de expiraci贸n razonable para los tokens de restablecimiento y apl铆calo estrictamente del lado del servidor.
## Referencias

* [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../.gitbook/assets/image (380).png" alt=""><figcaption></figcaption></figure>

nete al servidor de [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) para comunicarte con hackers experimentados y cazadores de recompensas por errores.

**Ideas de Hacking**\
Participa en contenido que explora la emoci贸n y los desaf铆os del hacking

**Noticias de Hacking en Tiempo Real**\
Mantente al d铆a con el mundo del hacking a trav茅s de noticias e informaci贸n en tiempo real

**ltimos Anuncios**\
Mantente informado sobre los nuevos programas de recompensas por errores y actualizaciones importantes de plataformas

**nete a nosotros en** [**Discord**](https://discord.com/invite/N3FrSbmwdy) 隆y comienza a colaborar con los mejores hackers hoy mismo!
