<details>

<summary><strong>ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§ã®AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

HackTricks ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

* **HackTricks ã§ä¼æ¥­ã‚’å®£ä¼ã—ãŸã„** ã¾ãŸã¯ **HackTricks ã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„å ´åˆ** ã¯ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASSï¼†HackTricksã‚¹ãƒ¯ãƒƒã‚°**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã™ã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã€å½“ç¤¾ã®ç‹¬å çš„ãª [**NFTs**](https://opensea.io/collection/the-peass-family) ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç™ºè¦‹ã™ã‚‹
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f) ã¾ãŸã¯ [**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass) ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live) ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹ã€‚
* **ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«** [**HackTricks**](https://github.com/carlospolop/hacktricks) ã¨ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã™ã‚‹ã€‚

</details>


ã“ã®POSTã§ã¯ã€`java.io.Serializable` ã‚’ä½¿ç”¨ã—ãŸä¾‹ãŒèª¬æ˜ã•ã‚Œã¾ã™ã€‚

# Serializable

Javaã® `Serializable` ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ (`java.io.Serializable`) ã¯ã€**ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º**ãŠã‚ˆã³**ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º**ã•ã‚Œã‚‹ã‚¯ãƒ©ã‚¹ãŒå®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ãƒãƒ¼ã‚«ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ã™ã€‚Javaã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºï¼ˆæ›¸ãè¾¼ã¿ï¼‰ã¯ [ObjectOutputStream](http://tutorials.jenkov.com/java-io/objectoutputstream.html) ã§è¡Œã‚ã‚Œã€ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºï¼ˆèª­ã¿è¾¼ã¿ï¼‰ã¯ [ObjectInputStream](http://tutorials.jenkov.com/java-io/objectinputstream.html) ã§è¡Œã‚ã‚Œã¾ã™ã€‚

**ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºå¯èƒ½ãª** **Personã‚¯ãƒ©ã‚¹**ã®ä¾‹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ã“ã®ã‚¯ãƒ©ã‚¹ã¯ **readObject** é–¢æ•°ã‚’ **ä¸Šæ›¸ã**ã—ã¦ãŠã‚Šã€ã“ã® **ã‚¯ãƒ©ã‚¹**ã® **ä»»æ„ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ**ãŒ **ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º**ã•ã‚Œã‚‹ã¨ã€ã“ã® **é–¢æ•°**ãŒ **å®Ÿè¡Œ**ã•ã‚Œã¾ã™ã€‚\
ã“ã®ä¾‹ã§ã¯ã€Personã‚¯ãƒ©ã‚¹ã® **readObject é–¢æ•°**ã¯ã€å½¼ã®ãƒšãƒƒãƒˆã® `eat()` é–¢æ•°ã¨ã€Dogã® `eat()` é–¢æ•°ï¼ˆä½•ã‚‰ã‹ã®ç†ç”±ã§ï¼‰ãŒ **calc.exe** ã‚’å‘¼ã³å‡ºã™ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚**ã“ã®è¨ˆç®—æ©Ÿã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«Personã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºãŠã‚ˆã³ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã™ã‚‹æ–¹æ³•ã‚’è¦‹ã¦ã„ãã¾ã™:**

**ä»¥ä¸‹ã®ä¾‹ã¯ [https://medium.com/@knownsec404team/java-deserialization-tool-gadgetinspector-first-glimpse-74e99e493649](https://medium.com/@knownsec404team/java-deserialization-tool-gadgetinspector-first-glimpse-74e99e493649) ã‹ã‚‰å–å¾—ã—ã¦ã„ã¾ã™**
```java
import java.io.Serializable;
import java.io.*;

public class TestDeserialization {
interface Animal {
public void eat();
}
//Class must implements Serializable to be serializable
public static class Cat implements Animal,Serializable {
@Override
public void eat() {
System.out.println("cat eat fish");
}
}
//Class must implements Serializable to be serializable
public static class Dog implements Animal,Serializable {
@Override
public void eat() {
try {
Runtime.getRuntime().exec("calc");
} catch (IOException e) {
e.printStackTrace();
}
System.out.println("dog eat bone");
}
}
//Class must implements Serializable to be serializable
public static class Person implements Serializable {
private Animal pet;
public Person(Animal pet){
this.pet = pet;
}
//readObject implementation, will call the readObject from ObjectInputStream  and then call pet.eat()
private void readObject(java.io.ObjectInputStream stream)
throws IOException, ClassNotFoundException {
pet = (Animal) stream.readObject();
pet.eat();
}
}
public static void GeneratePayload(Object instance, String file)
throws Exception {
//Serialize the constructed payload and write it to the file
File f = new File(file);
ObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(f));
out.writeObject(instance);
out.flush();
out.close();
}
public static void payloadTest(String file) throws Exception {
//Read the written payload and deserialize it
ObjectInputStream in = new ObjectInputStream(new FileInputStream(file));
Object obj = in.readObject();
System.out.println(obj);
in.close();
}
public static void main(String[] args) throws Exception {
// Example to call Person with a Dog
Animal animal = new Dog();
Person person = new Person(animal);
GeneratePayload(person,"test.ser");
payloadTest("test.ser");
// Example to call Person with a Cat
//Animal animal = new Cat();
//Person person = new Person(animal);
//GeneratePayload(person,"test.ser");
//payloadTest("test.ser");
}
}
```
## çµè«–

ã“ã®éå¸¸ã«åŸºæœ¬çš„ãªä¾‹ã§ã‚ã‹ã‚‹ã‚ˆã†ã«ã€ã“ã“ã§ã®ã€Œè„†å¼±æ€§ã€ã¯ã€**readObject** é–¢æ•°ãŒ**ä»–ã®è„†å¼±ãªé–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¦ã„ã‚‹**ãŸã‚ã«ç™ºç”Ÿã—ã¦ã„ã¾ã™ã€‚
