# ContaminaciÃ³n de ParÃ¡metros

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Â¿Trabajas en una **empresa de ciberseguridad**? Â¿Quieres ver tu **empresa anunciada en HackTricks**? Â¿O quieres tener acceso a la **Ãºltima versiÃ³n de PEASS o descargar HackTricks en PDF**? Â¡Consulta los [**PLANES DE SUSCRIPCIÃ“N**](https://github.com/sponsors/carlospolop)!
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecciÃ³n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* ObtÃ©n el [**swag oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* **Ãšnete al** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **sÃ­gueme** en **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

**Copiado de** [**https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654**](https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654)

**Resumen:**

La ContaminaciÃ³n de ParÃ¡metros HTTP (HPP, por sus siglas en inglÃ©s) significa contaminar los parÃ¡metros HTTP de una aplicaciÃ³n web para lograr una tarea maliciosa especÃ­fica. Se refiere a manipular cÃ³mo un sitio web trata los parÃ¡metros que recibe durante las solicitudes HTTP. Cambia el comportamiento de un sitio web de su intenciÃ³n original. La contaminaciÃ³n de parÃ¡metros HTTP es un tipo de ataque simple pero efectivo.

Cuando se contamina cualquier parÃ¡metro, el cÃ³digo se ejecuta solo en el lado del servidor, lo cual es invisible para nosotros, pero podemos ver los resultados en nuestra pantalla. El proceso intermedio es una caja negra.

Por ejemplo, hay una URL https://www.anybank.com/send que tiene tres parÃ¡metros:

1. from:
2. to:
3. amount:

**URL: https://www.anybank.com/send/?from=accountA\&to=accountB\&amount=10000**

Ahora esta es una URL normal que realizarÃ¡ una transacciÃ³n de 10000 desde la cuentaA a la cuentaB, pero Â¿quÃ© sucede si agregamos otro parÃ¡metro igual **"from:"**?

Entonces la URL serÃ­a como **https://www.anybank.com/send/?from=accountA\&to=accountB\&amount=10000\&from=accountC**

Cuando esta URL se procese, se deducirÃ¡n 10000 de la cuentaC en lugar de la cuentaA. AsÃ­ es como se manipulan los parÃ¡metros en el ataque de **ContaminaciÃ³n de ParÃ¡metros HTTP**. Aunque el alcance de esta vulnerabilidad no se limita solo a las solicitudes **GET**, tambiÃ©n se puede realizar este ataque en una solicitud basada en **POST**. Puedes probar esta vulnerabilidad en muchos lugares como cambio de contraseÃ±a, 2FA, comentarios, carga de foto de perfil, en un parÃ¡metro donde se pasa una clave de API, OTP, etc.

Cuando manipulas cualquier parÃ¡metro, su manipulaciÃ³n depende de cÃ³mo cada tecnologÃ­a web analiza sus parÃ¡metros. Puedes identificar tecnologÃ­as web usando "[Wappalyzer](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/)". A continuaciÃ³n se muestra una captura de pantalla de algunas tecnologÃ­as y su anÃ¡lisis de parÃ¡metros. TecnologÃ­as y su anÃ¡lisis de parÃ¡metros

![Imagen para el artÃ­culo](https://miro.medium.com/max/1760/1\*POs4sP0fQVlPvTH9vw1U-A.jpeg)

Me gustarÃ­a compartir uno de mis hallazgos de HPP donde pude tomar el control de una cuenta utilizando esta vulnerabilidad.

**Â¿CÃ³mo encontrÃ© esta vulnerabilidad?**

1. Fui a una pÃ¡gina de inicio de sesiÃ³n de ese programa, solicitaba un OTP para iniciar sesiÃ³n.

Enviar OTP

![Imagen para el artÃ­culo](https://miro.medium.com/max/600/1\*s-M09yWBylPVEhA6\_e0nSw.jpeg)

2. EscribÃ­ un correo electrÃ³nico y hice clic en "Enviar ContraseÃ±a de Un Solo Uso".

3. InterceptÃ© la solicitud usando Burp Suite y agreguÃ© otro correo electrÃ³nico usando el mismo parÃ¡metro (creÃ© dos correos electrÃ³nicos con fines de prueba). Solicitud de Burp

![Imagen para el artÃ­culo](https://miro.medium.com/max/1737/1\*z\_RpnZyKHLn6B4Lz4ONT3Q.png)

4. RecibÃ­ un OTP de shrey....@gmail.com en mi otra cuenta radhika....@gmail.com OTP

![Imagen para el artÃ­culo](https://miro.medium.com/max/784/1\*a671GrRtiMYfLUL7nURD8Q.png)

5. CopiÃ© el OTP y fui a shrey....@gmail.com en la pantalla de inicio de sesiÃ³n de ese programa, ingresÃ© este OTP y entrÃ© en la cuenta. Toma de Control de Cuenta

![Imagen para el artÃ­culo](https://miro.medium.com/max/1698/1\*Ux-ILfCr\_Mk\_xmzzsXwNnA.jpeg)

Entonces, lo que sucediÃ³ aquÃ­ es que la aplicaciÃ³n backend tomÃ³ el valor del primer parÃ¡metro "**email**" para generar un OTP y usÃ³ el valor del segundo parÃ¡metro "**email**" para suministrar el valor, lo que significa que se enviÃ³ un OTP de shrey....@gmail.com a radhika....@gmail.com.

**NOTA:** AquÃ­, en una imagen del cuarto paso donde recibÃ­ un OTP a radhika....@gmail.com, estaba confundido porque el mensaje decÃ­a "Hola Radhika", asÃ­ que pensÃ© que el parÃ¡metro no estaba contaminado y que el OTP era para radhika....@gmail.com, pero cuando probÃ© el OTP en shrey....@gmail.com, funcionÃ³.
## Flask y PHP

En [**este informe**](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution) puedes ver cÃ³mo una consulta HTTP como `a=1&a=2` serÃ¡ interpretada de manera diferente por Flask y PHP ejecutÃ¡ndose en un servidor Apache HTTP. En Flask, el parÃ¡metro serÃ¡ `1` (primera apariciÃ³n), mientras que en PHP serÃ¡ `2` (Ãºltima apariciÃ³n).

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Â¿Trabajas en una **empresa de ciberseguridad**? Â¿Quieres que tu **empresa sea anunciada en HackTricks**? Â¿O quieres tener acceso a la **Ãºltima versiÃ³n de PEASS o descargar HackTricks en PDF**? Â¡Consulta los [**PLANES DE SUSCRIPCIÃ“N**](https://github.com/sponsors/carlospolop)!
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecciÃ³n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* ObtÃ©n el [**merchandising oficial de PEASS y HackTricks**](https://peass.creator-spring.com)
* **Ãšnete al** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **sÃ­gueme** en **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
