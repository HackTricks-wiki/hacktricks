# PoluiÃ§Ã£o de ParÃ¢metros

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* VocÃª trabalha em uma **empresa de ciberseguranÃ§a**? VocÃª quer ver sua **empresa anunciada no HackTricks**? ou vocÃª quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o** [**repositÃ³rio hacktricks**](https://github.com/carlospolop/hacktricks) **e** [**repositÃ³rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

**Copiado de** [**https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654**](https://medium.com/@shahjerry33/http-parameter-pollution-its-contaminated-85edc0805654)

**Resumo:**

PoluiÃ§Ã£o de ParÃ¢metros HTTP (HPP) significa poluir os parÃ¢metros HTTP de um aplicativo da web para alcanÃ§ar uma tarefa maliciosa especÃ­fica. Refere-se Ã  manipulaÃ§Ã£o de como um site trata os parÃ¢metros que recebe durante as solicitaÃ§Ãµes HTTP. Isso altera o comportamento de um site de seu comportamento pretendido. A poluiÃ§Ã£o de parÃ¢metros HTTP Ã© um tipo simples de ataque, mas Ã© eficaz.

Quando vocÃª polui qualquer parÃ¢metro, o cÃ³digo Ã© executado apenas no lado do servidor, o que Ã© invisÃ­vel para nÃ³s, mas podemos ver os resultados em nossa tela. O processo intermediÃ¡rio Ã© uma caixa preta.

Por exemplo, hÃ¡ uma URL https://www.anybank.com/send que possui trÃªs parÃ¢metros:

1. from:
2. to:
3. amount:

**URL: https://www.anybank.com/send/?from=accountA\&to=accountB\&amount=10000**

Agora, esta Ã© uma URL normal que irÃ¡ realizar uma transaÃ§Ã£o de 10000 de accountA para accountB, mas e se adicionarmos outro parÃ¢metro igual **"from:"**

EntÃ£o, a URL ficarÃ¡ assim **https://www.anybank.com/send/?from=accountA\&to=accountB\&amount=10000\&from=accountC**

Quando esta URL for processada, uma transaÃ§Ã£o de 10000 serÃ¡ deduzida da contaC em vez da contaA. Ã‰ assim que vocÃª manipula os parÃ¢metros no ataque de **PoluiÃ§Ã£o de ParÃ¢metros HTTP**. Embora o escopo dessa vulnerabilidade nÃ£o esteja limitado apenas Ã  solicitaÃ§Ã£o **GET**, vocÃª tambÃ©m pode realizar esse ataque em uma solicitaÃ§Ã£o baseada em **POST**. VocÃª pode tentar essa vulnerabilidade em muitos lugares, como alteraÃ§Ã£o de senha, 2FA, comentÃ¡rios, upload de foto de perfil, em um parÃ¢metro onde a chave da API Ã© passada, OTP, etc.

Quando vocÃª manipula qualquer parÃ¢metro, sua manipulaÃ§Ã£o depende de como cada tecnologia da web estÃ¡ analisando seus parÃ¢metros. VocÃª pode identificar tecnologias da web usando o "[Wappalyzer](https://addons.mozilla.org/en-US/firefox/addon/wappalyzer/)". Abaixo estÃ¡ a captura de tela de algumas tecnologias e sua anÃ¡lise de parÃ¢metros. Tecnologias e sua anÃ¡lise de parÃ¢metros

![Imagem para postagem](https://miro.medium.com/max/1760/1\*POs4sP0fQVlPvTH9vw1U-A.jpeg)

Gostaria de compartilhar uma das minhas descobertas de HPP, onde consegui assumir uma conta usando essa vulnerabilidade.

**Como encontrei essa vulnerabilidade?**

1. Fui para uma pÃ¡gina de login desse programa, ele solicitou um OTP para fazer login

Enviar OTP

![Imagem para postagem](https://miro.medium.com/max/600/1\*s-M09yWBylPVEhA6\_e0nSw.jpeg)

2. Digitei um e-mail e cliquei em "Enviar senha Ãºnica"

3. Interrompi a solicitaÃ§Ã£o usando o burp suite e adicionei outro e-mail usando o mesmo parÃ¢metro (criei dois e-mails para fins de teste) SolicitaÃ§Ã£o do Burp

![Imagem para postagem](https://miro.medium.com/max/1737/1\*z\_RpnZyKHLn6B4Lz4ONT3Q.png)

4. Recebi um OTP de shrey....@gmail.com em minha outra conta radhika....@gmail.com OTP

![Imagem para postagem](https://miro.medium.com/max/784/1\*a671GrRtiMYfLUL7nURD8Q.png)

5. Copiei o OTP e fui para shrey....@gmail.com na tela de login do programa, inseri este OTP e entrei na conta. Assumir Conta

![Imagem para postagem](https://miro.medium.com/max/1698/1\*Ux-ILfCr\_Mk\_xmzzsXwNnA.jpeg)

EntÃ£o, o que aconteceu aqui Ã© que o aplicativo back-end pegou o valor do primeiro parÃ¢metro "**email**" para gerar um OTP e usou o valor do segundo parÃ¢metro "**email**" para fornecer o valor, o que significa que um OTP de shrey....@gmail.com foi enviado para radhika....@gmail.com.

**NOTA:** Aqui, em uma imagem na 4Âª etapa, onde recebi um OTP para radhika....@gmail.com, fiquei confuso porque a mensagem dizia OlÃ¡ Radhika, entÃ£o pensei que o parÃ¢metro nÃ£o estava poluÃ­do e o OTP era para radhika....@gmail.com, mas quando tentei o OTP em shrey....@gmail.com, funcionou.
## Flask & PHP

Neste [**documento**](https://github.com/google/google-ctf/tree/master/2023/web-under-construction/solution) vocÃª pode ver como uma consulta HTTP como `a=1&a=2` serÃ¡ interpretada de forma diferente pelo Flask e pelo PHP em execuÃ§Ã£o em um servidor Apache HTTP. No Flask, o parÃ¢metro serÃ¡ `1` (primeira ocorrÃªncia), enquanto no PHP serÃ¡ `2` (Ãºltima ocorrÃªncia).

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* VocÃª trabalha em uma **empresa de ciberseguranÃ§a**? VocÃª quer ver sua **empresa anunciada no HackTricks**? Ou vocÃª quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o** [**repositÃ³rio hacktricks**](https://github.com/carlospolop/hacktricks) **e** [**repositÃ³rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
