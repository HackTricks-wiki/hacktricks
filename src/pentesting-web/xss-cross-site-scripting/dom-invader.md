# DOM Invader

{{#include ../../banners/hacktricks-training.md}}

## DOM Invader

DOM Invader is 'n blaartoepassing wat in Burp se ingeboude blaarder geïnstalleer is. Dit help met **die opsporing van DOM XSS kwesbaarhede** deur verskeie bronne en sinke, insluitend webboodskappe en prototipe besoedeling. Die hulpmiddel is vooraf geïnstalleer as 'n uitbreiding.

DOM Invader integreer 'n oortjie binne die blaarder se DevTools-paneel wat die volgende moontlik maak:

1. **Identifikasie van beheerde sinke** op 'n webblad vir DOM XSS toetsing, wat konteks en sanitasiedetails verskaf.
2. **Teken, redigeer en stuur webboodskappe weer** wat via die `postMessage()` metode gestuur is vir DOM XSS toetsing. DOM Invader kan ook outomaties kwesbaarhede opspoor deur spesiaal saamgestelde webboodskappe te gebruik.
3. Opsporing van **klantkant prototipe besoedeling** bronne en skandering van beheerde gadgets wat na riskante sinke gestuur word.
4. Identifikasie van **DOM klobbering kwesbaarhede**.

### Aktiveer Dit

In Burp se ingeboude blaarder, gaan na die **Burp uitbreiding** en aktiveer dit:

<figure><img src="../../images/image (1129).png" alt=""><figcaption></figcaption></figure>

Nou verfris die bladsy en in die **Dev Tools** sal jy die **DOM Invader oortjie** vind:

<figure><img src="../../images/image (695).png" alt=""><figcaption></figcaption></figure>

### Injeksie van 'n Kanarie

In die vorige beeld kan jy 'n **random groep karakters sien, dit is die Kanarie**. Jy moet nou begin **injeksie** daarvan in verskillende dele van die web (params, vorms, url...) en elke keer op soek klik. DOM Invader sal kyk of die **kanarie in enige interessante sink geëindig het** wat uitgebuit kan word.

Boonop sal die opsies **Injek URL params** en **Injek vorms** outomaties 'n **nuwe oortjie** **injeksie** van die **kanarie** in elke **URL** param en **vorm** wat dit vind, oopmaak.

### Injeksie van 'n leë Kanarie

As jy net potensiële sinke wil vind wat die bladsy mag hê, selfs al is hulle nie uitbuitbaar nie, kan jy **soek na 'n leë kanarie**.

### Post Boodskappe

DOM Invader laat toetsing van DOM XSS toe deur webboodskappe met funksies soos:

1. **Teken webboodskappe** wat via `postMessage()` gestuur is, soortgelyk aan Burp Proxy se HTTP versoek/antwoord geskiedenis.
2. **Wysiging** en **heruitreiking** van webboodskappe om handmatig vir DOM XSS te toets, soortgelyk aan Burp Repeater se funksie.
3. **Outomatiese verandering** en sending van webboodskappe vir die ondersoek van DOM XSS.

#### Boodskap besonderhede

Gedetailleerde inligting kan oor elke boodskap gesien word deur daarop te klik, wat insluit of die klantkant JavaScript die `origin`, `data`, of `source` eienskappe van die boodskap benader.

- **`origin`** : As die **oorsprong inligting van die boodskap nie nagegaan word nie**, mag jy in staat wees om kruis-oorsprong boodskappe na die gebeurtenis handler **van 'n arbitrêre eksterne domein** te stuur. Maar as dit nagegaan word, kan dit steeds onveilig wees.
- **`data`**: Dit is waar die payload gestuur word. As hierdie data nie gebruik word nie, is die sink nutteloos.
- **`source`**: Evalueer of die bron eienskap, wat gewoonlik na 'n iframe verwys, gevalideer word in plaas van die oorsprong. Selfs as dit nagegaan word, verseker dit nie dat die validasie omseil kan word nie.

#### Antwoord 'n boodskap

1. Van die **Boodskappe** sien, klik op enige boodskap om die boodskap besonderhede dialoog te open.
2. Wysig die **Data** veld soos benodig.
3. Klik **Stuur**.

### Prototipe Besoedeling

DOM Invader kan ook soek na **Prototipe Besoedeling kwesbaarhede**. Eerstens, jy moet dit aktiveer:

<figure><img src="../../images/image (1026).png" alt=""><figcaption></figcaption></figure>

Dan, dit sal **soek na bronne** wat jou in staat stel om arbitrêre eienskappe aan die **`Object.prototype`** toe te voeg.

As iets gevind word, sal 'n **Toets** knoppie verskyn om **die gevonde bron te toets**. Klik daarop, 'n nuwe oortjie sal verskyn, skep 'n objek in die konsole en kyk of die `testproperty` bestaan:
```javascript
let b = {}
b.testproperty
```
Sodra jy 'n bron gevind het, kan jy **scan vir 'n gadget**:

1. 'n Nuwe oortjie word deur DOM Invader geopen wanneer die **Scan for gadgets** knoppie, wat langs enige geïdentifiseerde prototipe besoedeling bron in die **DOM**-weergave gevind kan word, geklik word. Die skandering vir geskikte gadgets begin dan.
2. Intussen, in dieselfde oortjie, moet die **DOM Invader** oortjie in die DevTools-paneel geopen wees. Nadat die skandering voltooi is, word enige sinke wat via die geïdentifiseerde gadgets toeganklik is, in die **DOM**-weergave vertoon. Byvoorbeeld, 'n gadget eienskap genaamd `html` wat aan die `innerHTML` sink oorgedra word, word in die onderstaande voorbeeld getoon.

## DOM klobbering

In die vorige beeld is dit moontlik om te sien dat die DOM klobbering skandering aangeskakel kan word. Sodra dit gedoen is, **sal DOM Invader begin soek na DOM klobbering kwesbaarhede**.

## Verwysings

- [https://portswigger.net/burp/documentation/desktop/tools/dom-invader](https://portswigger.net/burp/documentation/desktop/tools/dom-invader)
- [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling)
- [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-xss)
- [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/web-messages)
- [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution)
- [https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering](https://portswigger.net/burp/documentation/desktop/tools/dom-invader/dom-clobbering)

{{#include ../../banners/hacktricks-training.md}}
