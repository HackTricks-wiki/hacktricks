# Methodik für Web-Schwachstellen

{{#include ../banners/hacktricks-training.md}}


Bei jedem Web-Pentest gibt es **mehrere verborgene und offensichtliche Stellen, die verwundbar sein könnten**. Dieser Beitrag dient als Checkliste, um sicherzustellen, dass Sie an allen möglichen Stellen nach Schwachstellen gesucht haben.

## Proxies

> [!TIP]
> Heutzutage verwenden Web-Anwendungen meist eine Art Vermittler/Proxy; diese können (ab)genutzt werden, um Schwachstellen auszunutzen. Diese Schwachstellen setzen einen verwundbaren Proxy voraus, benötigen aber in der Regel auch eine zusätzliche Schwachstelle im Backend.

- [ ] [**Abusing hop-by-hop headers**](abusing-hop-by-hop-headers.md)
- [ ] [**Cache Poisoning/Cache Deception**](cache-deception/index.html)
- [ ] [**HTTP Connection Contamination**](http-connection-contamination.md)
- [ ] [**HTTP Connection Request Smuggling**](http-connection-request-smuggling.md)
- [ ] [**HTTP Request Smuggling**](http-request-smuggling/)
- [ ] [**HTTP Response Smuggling / Desync**](http-response-smuggling-desync.md)
- [ ] [**H2C Smuggling**](h2c-smuggling.md)
- [ ] [**Server Side Inclusion/Edge Side Inclusion**](server-side-inclusion-edge-side-inclusion-injection.md)
- [ ] [**Uncovering Cloudflare**](../network-services-pentesting/pentesting-web/uncovering-cloudflare.md)
- [ ] [**XSLT Server Side Injection**](xslt-server-side-injection-extensible-stylesheet-language-transformations.md)
- [ ] [**Proxy / WAF Protections Bypass**](proxy-waf-protections-bypass.md)

## **Benutzereingaben**

> [!TIP]
> Die meisten Web-Anwendungen werden **Benutzern erlauben, Daten einzugeben, die später verarbeitet werden.**\
> Abhängig von der Struktur der erwarteten Daten können einige Schwachstellen zutreffen oder nicht.

### **Reflected Values**

Wenn die eingegebenen Daten in irgendeiner Weise in der Antwort reflektiert werden können, könnte die Seite für mehrere Probleme anfällig sein.

- [ ] [**Client Side Path Traversal**](client-side-path-traversal.md)
- [ ] [**Client Side Template Injection**](client-side-template-injection-csti.md)
- [ ] [**Command Injection**](command-injection.md)
- [ ] [**CRLF**](crlf-0d-0a.md)
- [ ] [**Dangling Markup**](dangling-markup-html-scriptless-injection/index.html)
- [ ] [**File Inclusion/Path Traversal**](file-inclusion/index.html)
- [ ] [**Open Redirect**](open-redirect.md)
- [ ] [**Prototype Pollution to XSS**](deserialization/nodejs-proto-prototype-pollution/index.html#client-side-prototype-pollution-to-xss)
- [ ] [**Server Side Inclusion/Edge Side Inclusion**](server-side-inclusion-edge-side-inclusion-injection.md)
- [ ] [**Server Side Request Forgery**](ssrf-server-side-request-forgery/index.html)
- [ ] [**Server Side Template Injection**](ssti-server-side-template-injection/index.html)
- [ ] [**Reverse Tab Nabbing**](reverse-tab-nabbing.md)
- [ ] [**XSLT Server Side Injection**](xslt-server-side-injection-extensible-stylesheet-language-transformations.md)
- [ ] [**XSS**](xss-cross-site-scripting/index.html)
- [ ] [**XSSI**](xssi-cross-site-script-inclusion.md)
- [ ] [**XS-Search**](xs-search/index.html)

Einige der erwähnten Schwachstellen erfordern spezielle Bedingungen, andere benötigen nur, dass der Inhalt reflektiert wird. Sie finden einige interessante Polygloths zum schnellen Testen der Schwachstellen in:


{{#ref}}
pocs-and-polygloths-cheatsheet/
{{#endref}}

### **Search functionalities**

Wenn die Funktionalität dazu verwendet werden kann, im Backend nach bestimmten Daten zu suchen, können Sie sie möglicherweise (ab)nutzen, um beliebige Daten zu durchsuchen.

- [ ] [**File Inclusion/Path Traversal**](file-inclusion/index.html)
- [ ] [**NoSQL Injection**](nosql-injection.md)
- [ ] [**LDAP Injection**](ldap-injection.md)
- [ ] [**ReDoS**](regular-expression-denial-of-service-redos.md)
- [ ] [**SQL Injection**](sql-injection/index.html)
- [ ] [**ORM Injection**](orm-injection.md)
- [ ] [**RSQL Injection**](rsql-injection.md)
- [ ] [**XPATH Injection**](xpath-injection.md)

### **Forms, WebSockets and PostMsgs**

Wenn ein WebSocket eine Nachricht sendet oder ein Formular Nutzern erlaubt, Aktionen auszuführen, können Schwachstellen auftreten.

- [ ] [**Cross Site Request Forgery**](csrf-cross-site-request-forgery.md)
- [ ] [**Cross-site WebSocket hijacking (CSWSH)**](websocket-attacks.md)
- [ ] [**Phone Number Injections**](phone-number-injections.md)
- [ ] [**PostMessage Vulnerabilities**](postmessage-vulnerabilities/index.html)

#### Cross-site WebSocket hijacking & localhost abuse

WebSocket-Upgrades leiten Cookies automatisch weiter und blockieren `ws://127.0.0.1` nicht, sodass **jede Web-Origin Desktop-IPC-Endpunkte ansprechen kann**, die die `Origin`-Validierung umgehen. Wenn Sie einen Launcher entdecken, der über einen lokalen Agenten eine JSON-RPC-ähnliche API exponiert:

- Beobachten Sie die gesendeten Frames, um die erforderlichen `type`/`name`/`args`-Tupel jeder Methode zu klonen.
- Brute-forcen Sie den Listenport direkt aus dem Browser (Chromium verkraftet ~16k fehlgeschlagene Upgrades), bis eine Loopback-Socket-Antwort mit dem Protokoll-Banner kommt — Firefox neigt dazu, unter derselben Last schnell abzustürzen.
- Verketteten Sie ein Paar *create → privileged action*: z. B. rufen Sie eine `create*`-Methode auf, die eine GUID zurückgibt, und rufen Sie sofort die entsprechende `*Launch*`-Methode mit angreiferkontrollierten Payloads auf.

Wenn Sie beliebige JVM-Flags übergeben können (z. B. `AdditionalJavaArguments`), erzwingen Sie einen Fehler mit `-XX:MaxMetaspaceSize=<tiny>` und hängen `-XX:OnOutOfMemoryError="<cmd>"` an, um OS-Kommandos auszuführen, ohne die Anwendungslogik zu berühren. Siehe [WebSocket attacks](websocket-attacks.md#localhost-websocket-abuse--browser-port-discovery) für eine Schritt-für-Schritt-Anleitung.

### **HTTP Headers**

Je nach den vom Webserver gelieferten HTTP-Headern können einige Schwachstellen vorhanden sein.

- [ ] [**Clickjacking**](clickjacking.md)
- [ ] [**Iframe Traps / Click Isolation**](iframe-traps.md)
- [ ] [**Content Security Policy bypass**](content-security-policy-csp-bypass/index.html)
- [ ] [**Cookies Hacking**](hacking-with-cookies/index.html)
- [ ] [**CORS - Misconfigurations & Bypass**](cors-bypass.md)

### **Bypasses**

Es gibt mehrere spezifische Funktionalitäten, bei denen Workarounds nützlich sein können, um Schutzmechanismen zu umgehen

- [ ] [**2FA/OTP Bypass**](2fa-bypass.md)
- [ ] [**Bypass Payment Process**](bypass-payment-process.md)
- [ ] [**Captcha Bypass**](captcha-bypass.md)
- [ ] [**Account Takeover Playbooks**](account-takeover.md)
- [ ] [**Login Bypass**](login-bypass/index.html)
- [ ] [**Race Condition**](race-condition.md)
- [ ] [**Rate Limit Bypass**](rate-limit-bypass.md)
- [ ] [**Reset Forgotten Password Bypass**](reset-password.md)
- [ ] [**Registration Vulnerabilities**](registration-vulnerabilities.md)

### **Structured objects / Specific functionalities**

Einige Funktionalitäten erfordern, dass die **Daten in einem sehr spezifischen Format strukturiert sind** (z. B. ein sprachserialisiertes Objekt oder XML). Daher ist es einfacher zu erkennen, ob die Anwendung anfällig sein könnte, da sie genau diese Art von Daten verarbeiten muss.\
Einige **spezifische Funktionalitäten** können auch dann verwundbar sein, wenn ein **bestimmtes Eingabeformat** verwendet wird (z. B. Email Header Injections).

- [ ] [**Deserialization**](deserialization/index.html)
- [ ] [**Email Header Injection**](email-injections.md)
- [ ] [**JWT Vulnerabilities**](hacking-jwt-json-web-tokens.md)
- [ ] [**JSON / XML / YAML Hacking**](json-xml-yaml-hacking.md)
- [ ] [**XML External Entity**](xxe-xee-xml-external-entity.md)
- [ ] [**GraphQL Attacks**](../network-services-pentesting/pentesting-web/graphql.md)
- [ ] [**gRPC-Web Attacks**](grpc-web-pentest.md)
- [ ] [**SOAP/JAX-WS ThreadLocal Auth Bypass**](soap-jax-ws-threadlocal-auth-bypass.md)

### Files

Funktionalitäten, die das Hochladen von Dateien erlauben, können für mehrere Probleme anfällig sein.\
Funktionalitäten, die Dateien generieren, die Benutzereingaben enthalten, können unerwarteten Code ausführen.\
Benutzer, die von Nutzern hochgeladene oder automatisch generierte Dateien öffnen, die Benutzereingaben enthalten, können kompromittiert werden.

- [ ] [**File Upload**](file-upload/index.html)
- [ ] [**Formula Injection**](formula-csv-doc-latex-ghostscript-injection.md)
- [ ] [**PDF Injection**](xss-cross-site-scripting/pdf-injection.md)
- [ ] [**Server Side XSS**](xss-cross-site-scripting/server-side-xss-dynamic-pdf.md)

### **External Identity Management**

- [ ] [**OAUTH to Account takeover**](oauth-to-account-takeover.md)
- [ ] [**SAML Attacks**](saml-attacks/index.html)

### **Other Helpful Vulnerabilities**

Diese Schwachstellen können helfen, andere Schwachstellen auszunutzen.

- [ ] [**Domain/Subdomain takeover**](domain-subdomain-takeover.md)
- [ ] [**IDOR**](idor.md)
- [ ] [**Mass Assignment (CWE-915)**](mass-assignment-cwe-915.md)
- [ ] [**Parameter Pollution**](parameter-pollution.md)
- [ ] [**Unicode Normalization vulnerability**](unicode-injection/index.html)

### **Web Servers & Middleware**

Fehlkonfigurationen im Edge-Stack schalten oft wirkungsvollere Fehler in der Anwendungsschicht frei.

- [ ] [**Apache**](../network-services-pentesting/pentesting-web/apache.md)
- [ ] [**Nginx**](../network-services-pentesting/pentesting-web/nginx.md)
- [ ] [**IIS**](../network-services-pentesting/pentesting-web/iis-internet-information-services.md)
- [ ] [**Tomcat**](../network-services-pentesting/pentesting-web/tomcat/)
- [ ] [**Spring Actuators**](../network-services-pentesting/pentesting-web/spring-actuators.md)
- [ ] [**PUT Method / WebDAV**](../network-services-pentesting/pentesting-web/put-method-webdav.md)
- [ ] [**Special HTTP Headers**](../network-services-pentesting/pentesting-web/special-http-headers.md)
- [ ] [**WSGI Deployment**](../network-services-pentesting/pentesting-web/wsgi.md)
- [ ] [**Werkzeug Debug Exposure**](../network-services-pentesting/pentesting-web/werkzeug.md)

### **Application Frameworks & Stacks**

Framework-spezifische Primitive offenbaren häufig Gadgets, gefährliche Voreinstellungen oder vom Framework bereitgestellte Endpunkte.

- [ ] [**Django**](../network-services-pentesting/pentesting-web/django.md)
- [ ] [**Flask**](../network-services-pentesting/pentesting-web/flask.md)
- [ ] [**NodeJS / Express**](../network-services-pentesting/pentesting-web/nodejs-express.md)
- [ ] [**Angular**](../network-services-pentesting/pentesting-web/angular.md)
- [ ] [**Vue / Nuxt**](../network-services-pentesting/pentesting-web/vuejs.md)
- [ ] [**Next.js**](../network-services-pentesting/pentesting-web/nextjs.md)
- [ ] [**Laravel**](../network-services-pentesting/pentesting-web/laravel.md)
- [ ] [**Symfony**](../network-services-pentesting/pentesting-web/symphony.md)

### **CMS, SaaS & Managed Platforms**

Produkte mit großer Angriffsfläche enthalten oft bekannte Exploits, schwache Plugins oder privilegierte Admin-Endpunkte.

- [ ] [**WordPress**](../network-services-pentesting/pentesting-web/wordpress.md)
- [ ] [**Joomla**](../network-services-pentesting/pentesting-web/joomla.md)
- [ ] [**Drupal**](../network-services-pentesting/pentesting-web/drupal/)
- [ ] [**Moodle**](../network-services-pentesting/pentesting-web/moodle.md)
- [ ] [**Prestashop**](../network-services-pentesting/pentesting-web/prestashop.md)
- [ ] [**Atlassian Jira**](../network-services-pentesting/pentesting-web/jira.md)
- [ ] [**Grafana**](../network-services-pentesting/pentesting-web/grafana.md)
- [ ] [**Rocket.Chat**](../network-services-pentesting/pentesting-web/rocket-chat.md)
- [ ] [**Zabbix**](../network-services-pentesting/pentesting-web/zabbix.md)
- [ ] [**Microsoft SharePoint**](../network-services-pentesting/pentesting-web/microsoft-sharepoint.md)
- [ ] [**Sitecore**](../network-services-pentesting/pentesting-web/sitecore/)

### **APIs, Buckets & Integrations**

Serverseitige Helfer und Drittanbieter-Integrationen können Schwächen in der Dateiverarbeitung oder auf der Storage-Ebene offenlegen.

- [ ] [**Web API Pentesting**](../network-services-pentesting/pentesting-web/web-api-pentesting.md)
- [ ] [**Storage Buckets & Firebase**](../network-services-pentesting/pentesting-web/buckets/)
- [ ] [**Imagemagick Security**](../network-services-pentesting/pentesting-web/imagemagick-security.md)
- [ ] [**Artifactory & Package Registries**](../network-services-pentesting/pentesting-web/artifactory-hacking-guide.md)
- [ ] [**Code Review Tooling**](../network-services-pentesting/pentesting-web/code-review-tools.md)

### **Supply Chain & Identifier Abuse**

Angriffe, die Build-Pipelines oder vorhersagbare Identifikatoren anvisieren, können der erste Einstieg sein, bevor traditionelle Bugs ausgenutzt werden.

- [ ] [**Dependency Confusion**](dependency-confusion.md)
- [ ] [**Timing Attacks**](timing-attacks.md)
- [ ] [**UUID Insecurities**](uuid-insecurities.md)

### **Web3, Extensions & Tooling**

Moderne Anwendungen reichen in Browser, Wallets und Automatisierungspipelines hinein — berücksichtigen Sie diese Vektoren.

- [ ] [**dApps / Decentralized Applications**](dapps-DecentralizedApplications.md)
- [ ] [**Browser Extension Pentesting**](browser-extension-pentesting-methodology/)
- [ ] [**wfuzz Web Fuzzing**](web-tool-wfuzz.md)

## References

- [When WebSockets Lead to RCE in CurseForge](https://elliott.diy/blog/curseforge/)

{{#include ../banners/hacktricks-training.md}}
