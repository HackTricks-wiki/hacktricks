# Metodologia Web Vulnerabilities

{{#include ../banners/hacktricks-training.md}}


W każdym Web Pentest istnieje **kilka ukrytych i oczywistych miejsc, które mogą być podatne**. Ten wpis ma służyć jako lista kontrolna, aby potwierdzić, że przeszukałeś wszystkie możliwe miejsca pod kątem podatności.

## Proxies

> [!TIP]
> Obecnie **web applications** zwykle **używają** jakiegoś rodzaju **pośrednich** **proxies**, które mogą być (ab)użyte do wykorzystania podatności. Te podatności wymagają istnienia podatnego proxy, ale zazwyczaj potrzebują też dodatkowej podatności w backendzie.

- [ ] [**Abusing hop-by-hop headers**](abusing-hop-by-hop-headers.md)
- [ ] [**Cache Poisoning/Cache Deception**](cache-deception/index.html)
- [ ] [**HTTP Connection Contamination**](http-connection-contamination.md)
- [ ] [**HTTP Connection Request Smuggling**](http-connection-request-smuggling.md)
- [ ] [**HTTP Request Smuggling**](http-request-smuggling/)
- [ ] [**HTTP Response Smuggling / Desync**](http-response-smuggling-desync.md)
- [ ] [**H2C Smuggling**](h2c-smuggling.md)
- [ ] [**Server Side Inclusion/Edge Side Inclusion**](server-side-inclusion-edge-side-inclusion-injection.md)
- [ ] [**Uncovering Cloudflare**](../network-services-pentesting/pentesting-web/uncovering-cloudflare.md)
- [ ] [**XSLT Server Side Injection**](xslt-server-side-injection-extensible-stylesheet-language-transformations.md)
- [ ] [**Proxy / WAF Protections Bypass**](proxy-waf-protections-bypass.md)

## **Wejście użytkownika**

> [!TIP]
> Większość web applications pozwoli użytkownikom **wprowadzić dane, które będą przetworzone później.**\
> W zależności od struktury danych, której oczekuje serwer, niektóre podatności mogą mieć zastosowanie, a inne nie.

### **Wartości odzwierciedlane**

Jeśli wprowadzone dane mogą w jakiś sposób zostać odzwierciedlone w odpowiedzi, strona może być podatna na różne problemy.

- [ ] [**Client Side Path Traversal**](client-side-path-traversal.md)
- [ ] [**Client Side Template Injection**](client-side-template-injection-csti.md)
- [ ] [**Command Injection**](command-injection.md)
- [ ] [**CRLF**](crlf-0d-0a.md)
- [ ] [**Dangling Markup**](dangling-markup-html-scriptless-injection/index.html)
- [ ] [**File Inclusion/Path Traversal**](file-inclusion/index.html)
- [ ] [**Open Redirect**](open-redirect.md)
- [ ] [**Prototype Pollution to XSS**](deserialization/nodejs-proto-prototype-pollution/index.html#client-side-prototype-pollution-to-xss)
- [ ] [**Server Side Inclusion/Edge Side Inclusion**](server-side-inclusion-edge-side-inclusion-injection.md)
- [ ] [**Server Side Request Forgery**](ssrf-server-side-request-forgery/index.html)
- [ ] [**Server Side Template Injection**](ssti-server-side-template-injection/index.html)
- [ ] [**Reverse Tab Nabbing**](reverse-tab-nabbing.md)
- [ ] [**XSLT Server Side Injection**](xslt-server-side-injection-extensible-stylesheet-language-transformations.md)
- [ ] [**XSS**](xss-cross-site-scripting/index.html)
- [ ] [**XSSI**](xssi-cross-site-script-inclusion.md)
- [ ] [**XS-Search**](xs-search/index.html)

Niektóre z wymienionych podatności wymagają specjalnych warunków, inne jedynie odzwierciedlenia treści. Możesz znaleźć kilka ciekawych polygloths do szybkiego testowania podatności w:


{{#ref}}
pocs-and-polygloths-cheatsheet/
{{#endref}}

### **Funkcje wyszukiwania**

Jeśli funkcjonalność służy do wyszukiwania danych w backendzie, być może można ją (ab)użyć do wyszukiwania dowolnych danych.

- [ ] [**File Inclusion/Path Traversal**](file-inclusion/index.html)
- [ ] [**NoSQL Injection**](nosql-injection.md)
- [ ] [**LDAP Injection**](ldap-injection.md)
- [ ] [**ReDoS**](regular-expression-denial-of-service-redos.md)
- [ ] [**SQL Injection**](sql-injection/index.html)
- [ ] [**ORM Injection**](orm-injection.md)
- [ ] [**RSQL Injection**](rsql-injection.md)
- [ ] [**XPATH Injection**](xpath-injection.md)

### **Formularze, WebSockets i PostMsgs**

Gdy websocket wysyła wiadomość lub formularz pozwala użytkownikom wykonywać akcje, mogą pojawić się podatności.

- [ ] [**Cross Site Request Forgery**](csrf-cross-site-request-forgery.md)
- [ ] [**Cross-site WebSocket hijacking (CSWSH)**](websocket-attacks.md)
- [ ] [**Phone Number Injections**](phone-number-injections.md)
- [ ] [**PostMessage Vulnerabilities**](postmessage-vulnerabilities/index.html)

#### Cross-site WebSocket hijacking & localhost abuse

WebSocket upgrades automatycznie przekazują cookies i nie blokują `ws://127.0.0.1`, więc **każdy origin web może sterować desktopowymi endpointami IPC**, które pomijają walidację `Origin`. Kiedy zauważysz launcher wystawiający API podobne do JSON-RPC przez lokalnego agenta:

- Obserwuj wysyłane ramki, aby sklonować krotki `type`/`name`/`args` wymagane przez każdą metodę.
- Bruteforce'uj port nasłuchu bezpośrednio z przeglądarki (Chromium poradzi sobie z około ~16k nieudanych upgrade'ów) aż gniazdo loopback odpowie banerem protokołu — Firefox zwykle szybko się zawiesi przy takim obciążeniu.
- Złącz parę *create → privileged action*: np. wywołaj metodę `create*`, która zwróci GUID, a następnie natychmiast wywołaj odpowiadającą metodę `*Launch*` z payloadami kontrolowanymi przez atakującego.

Jeśli możesz przekazać dowolne flagi JVM (np. `AdditionalJavaArguments`), wymuś błąd z `-XX:MaxMetaspaceSize=<tiny>` i dołącz `-XX:OnOutOfMemoryError="<cmd>"`, aby uruchomić polecenia systemowe bez ingerowania w logikę aplikacji. Zobacz [WebSocket attacks](websocket-attacks.md#localhost-websocket-abuse--browser-port-discovery) dla przewodnika krok po kroku.

### **Nagłówki HTTP**

W zależności od nagłówków HTTP zwracanych przez serwer web mogą występować różne podatności.

- [ ] [**Clickjacking**](clickjacking.md)
- [ ] [**Iframe Traps / Click Isolation**](iframe-traps.md)
- [ ] [**Content Security Policy bypass**](content-security-policy-csp-bypass/index.html)
- [ ] [**Cookies Hacking**](hacking-with-cookies/index.html)
- [ ] [**CORS - Misconfigurations & Bypass**](cors-bypass.md)

### **Omijania**

Istnieje kilka specyficznych funkcjonalności, gdzie przydatne mogą być różne obejścia.

- [ ] [**2FA/OTP Bypass**](2fa-bypass.md)
- [ ] [**Bypass Payment Process**](bypass-payment-process.md)
- [ ] [**Captcha Bypass**](captcha-bypass.md)
- [ ] [**Account Takeover Playbooks**](account-takeover.md)
- [ ] [**Login Bypass**](login-bypass/index.html)
- [ ] [**Race Condition**](race-condition.md)
- [ ] [**Rate Limit Bypass**](rate-limit-bypass.md)
- [ ] [**Reset Forgotten Password Bypass**](reset-password.md)
- [ ] [**Registration Vulnerabilities**](registration-vulnerabilities.md)

### **Sformatowane obiekty / Specyficzne funkcjonalności**

Niektóre funkcjonalności będą wymagać, aby dane były sformatowane w bardzo specyficzny sposób (np. zserializowany obiekt języka lub XML). Łatwiej więc zidentyfikować podatność, gdy aplikacja przetwarza tego rodzaju dane.\
Niektóre **specyficzne funkcjonalności** mogą być również podatne, jeśli użyty zostanie **konkretny format wejścia** (np. Email Header Injections).

- [ ] [**Deserialization**](deserialization/index.html)
- [ ] [**Email Header Injection**](email-injections.md)
- [ ] [**JWT Vulnerabilities**](hacking-jwt-json-web-tokens.md)
- [ ] [**JSON / XML / YAML Hacking**](json-xml-yaml-hacking.md)
- [ ] [**XML External Entity**](xxe-xee-xml-external-entity.md)
- [ ] [**GraphQL Attacks**](../network-services-pentesting/pentesting-web/graphql.md)
- [ ] [**gRPC-Web Attacks**](grpc-web-pentest.md)
- [ ] [**SOAP/JAX-WS ThreadLocal Auth Bypass**](soap-jax-ws-threadlocal-auth-bypass.md)

### Pliki

Funkcjonalności pozwalające na upload plików mogą być podatne na różne problemy.\
Funkcjonalności generujące pliki zawierające dane użytkownika mogą uruchomić nieoczekiwany kod.\
Użytkownicy otwierający pliki przesłane przez innych użytkowników lub automatycznie generowane z zawartością użytkownika mogą zostać skompromitowani.

- [ ] [**File Upload**](file-upload/index.html)
- [ ] [**Formula Injection**](formula-csv-doc-latex-ghostscript-injection.md)
- [ ] [**PDF Injection**](xss-cross-site-scripting/pdf-injection.md)
- [ ] [**Server Side XSS**](xss-cross-site-scripting/server-side-xss-dynamic-pdf.md)

### **External Identity Management**

- [ ] [**OAUTH to Account takeover**](oauth-to-account-takeover.md)
- [ ] [**SAML Attacks**](saml-attacks/index.html)

### **Inne przydatne podatności**

Te podatności mogą pomóc w eksploatacji innych podatności.

- [ ] [**Domain/Subdomain takeover**](domain-subdomain-takeover.md)
- [ ] [**IDOR**](idor.md)
- [ ] [**Mass Assignment (CWE-915)**](mass-assignment-cwe-915.md)
- [ ] [**Parameter Pollution**](parameter-pollution.md)
- [ ] [**Unicode Normalization vulnerability**](unicode-injection/index.html)

### **Serwery Web & Middleware**

Błędne konfiguracje na warstwie edge często odsłaniają bardziej wpływowe błędy w warstwie aplikacji.

- [ ] [**Apache**](../network-services-pentesting/pentesting-web/apache.md)
- [ ] [**Nginx**](../network-services-pentesting/pentesting-web/nginx.md)
- [ ] [**IIS**](../network-services-pentesting/pentesting-web/iis-internet-information-services.md)
- [ ] [**Tomcat**](../network-services-pentesting/pentesting-web/tomcat/)
- [ ] [**Spring Actuators**](../network-services-pentesting/pentesting-web/spring-actuators.md)
- [ ] [**PUT Method / WebDAV**](../network-services-pentesting/pentesting-web/put-method-webdav.md)
- [ ] [**Special HTTP Headers**](../network-services-pentesting/pentesting-web/special-http-headers.md)
- [ ] [**WSGI Deployment**](../network-services-pentesting/pentesting-web/wsgi.md)
- [ ] [**Werkzeug Debug Exposure**](../network-services-pentesting/pentesting-web/werkzeug.md)

### **Frameworki aplikacyjne & Stosy**

Elementy specyficzne dla frameworków często odsłaniają gadgety, niebezpieczne domyślne ustawienia lub endpointy należące do frameworka.

- [ ] [**Django**](../network-services-pentesting/pentesting-web/django.md)
- [ ] [**Flask**](../network-services-pentesting/pentesting-web/flask.md)
- [ ] [**NodeJS / Express**](../network-services-pentesting/pentesting-web/nodejs-express.md)
- [ ] [**Angular**](../network-services-pentesting/pentesting-web/angular.md)
- [ ] [**Vue / Nuxt**](../network-services-pentesting/pentesting-web/vuejs.md)
- [ ] [**Next.js**](../network-services-pentesting/pentesting-web/nextjs.md)
- [ ] [**Laravel**](../network-services-pentesting/pentesting-web/laravel.md)
- [ ] [**Symfony**](../network-services-pentesting/pentesting-web/symphony.md)

### **CMS, SaaS & Platformy zarządzane**

Produkty o szerokiej powierzchni często zawierają znane exploity, słabe wtyczki lub uprzywilejowane endpointy administratora.

- [ ] [**WordPress**](../network-services-pentesting/pentesting-web/wordpress.md)
- [ ] [**Joomla**](../network-services-pentesting/pentesting-web/joomla.md)
- [ ] [**Drupal**](../network-services-pentesting/pentesting-web/drupal/)
- [ ] [**Moodle**](../network-services-pentesting/pentesting-web/moodle.md)
- [ ] [**Prestashop**](../network-services-pentesting/pentesting-web/prestashop.md)
- [ ] [**Atlassian Jira**](../network-services-pentesting/pentesting-web/jira.md)
- [ ] [**Grafana**](../network-services-pentesting/pentesting-web/grafana.md)
- [ ] [**Rocket.Chat**](../network-services-pentesting/pentesting-web/rocket-chat.md)
- [ ] [**Zabbix**](../network-services-pentesting/pentesting-web/zabbix.md)
- [ ] [**Microsoft SharePoint**](../network-services-pentesting/pentesting-web/microsoft-sharepoint.md)
- [ ] [**Sitecore**](../network-services-pentesting/pentesting-web/sitecore/)

### **APIs, Buckets & Integrations**

Pomocnicy po stronie serwera i integracje z zewnętrznymi usługami mogą ujawnić słabości parsowania plików lub warstwy magazynowania.

- [ ] [**Web API Pentesting**](../network-services-pentesting/pentesting-web/web-api-pentesting.md)
- [ ] [**Storage Buckets & Firebase**](../network-services-pentesting/pentesting-web/buckets/)
- [ ] [**Imagemagick Security**](../network-services-pentesting/pentesting-web/imagemagick-security.md)
- [ ] [**Artifactory & Package Registries**](../network-services-pentesting/pentesting-web/artifactory-hacking-guide.md)
- [ ] [**Code Review Tooling**](../network-services-pentesting/pentesting-web/code-review-tools.md)

### **Łańcuch dostaw & Nadużycie identyfikatorów**

Ataki wymierzone w pipeline'y budowania lub przewidywalne identyfikatory mogą dać punkt zaczepienia przed wykorzystaniem tradycyjnych błędów.

- [ ] [**Dependency Confusion**](dependency-confusion.md)
- [ ] [**Timing Attacks**](timing-attacks.md)
- [ ] [**UUID Insecurities**](uuid-insecurities.md)

### **Web3, Extensions & Tooling**

Nowoczesne aplikacje rozszerzają się na przeglądarki, portfele i pipeline'y automatyzacji — miej te wektory w zakresie testów.

- [ ] [**dApps / Decentralized Applications**](dapps-DecentralizedApplications.md)
- [ ] [**Browser Extension Pentesting**](browser-extension-pentesting-methodology/)
- [ ] [**wfuzz Web Fuzzing**](web-tool-wfuzz.md)

## Bibliografia

- [When WebSockets Lead to RCE in CurseForge](https://elliott.diy/blog/curseforge/)

{{#include ../banners/hacktricks-training.md}}
