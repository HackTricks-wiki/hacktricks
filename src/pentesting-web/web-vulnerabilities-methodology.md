# Web 脆弱性の方法論

{{#include ../banners/hacktricks-training.md}}


In every Web Pentest, there are **several hidden and obvious places that might be vulnerable**. This post is meant to be a checklist to confirm that you have searched for vulnerabilities in all the possible places.

## プロキシ

> [!TIP]
> 現在、**web** **applications** は通常何らかの **intermediary** **proxies** を利用しており、これらは脆弱性を悪用するために(悪)用される可能性があります。これらの脆弱性が成立するには脆弱な proxy が存在することが必要ですが、通常はバックエンド側の追加の脆弱性も必要になります。

- [ ] [**Abusing hop-by-hop headers**](abusing-hop-by-hop-headers.md)
- [ ] [**Cache Poisoning/Cache Deception**](cache-deception/index.html)
- [ ] [**HTTP Connection Contamination**](http-connection-contamination.md)
- [ ] [**HTTP Connection Request Smuggling**](http-connection-request-smuggling.md)
- [ ] [**HTTP Request Smuggling**](http-request-smuggling/)
- [ ] [**HTTP Response Smuggling / Desync**](http-response-smuggling-desync.md)
- [ ] [**H2C Smuggling**](h2c-smuggling.md)
- [ ] [**Server Side Inclusion/Edge Side Inclusion**](server-side-inclusion-edge-side-inclusion-injection.md)
- [ ] [**Uncovering Cloudflare**](../network-services-pentesting/pentesting-web/uncovering-cloudflare.md)
- [ ] [**XSLT Server Side Injection**](xslt-server-side-injection-extensible-stylesheet-language-transformations.md)
- [ ] [**Proxy / WAF Protections Bypass**](proxy-waf-protections-bypass.md)

## **ユーザー入力**

> [!TIP]
> ほとんどの **web** **applications** は後で処理されるデータの入力をユーザに許可します。サーバが期待するデータ構造によって、適用される脆弱性が変わる場合があります。

### **反映された値**

入力したデータが何らかの形でレスポンスに反映される場合、そのページはいくつかの脆弱性の影響を受ける可能性があります。

- [ ] [**Client Side Path Traversal**](client-side-path-traversal.md)
- [ ] [**Client Side Template Injection**](client-side-template-injection-csti.md)
- [ ] [**Command Injection**](command-injection.md)
- [ ] [**CRLF**](crlf-0d-0a.md)
- [ ] [**Dangling Markup**](dangling-markup-html-scriptless-injection/index.html)
- [ ] [**File Inclusion/Path Traversal**](file-inclusion/index.html)
- [ ] [**Open Redirect**](open-redirect.md)
- [ ] [**Prototype Pollution to XSS**](deserialization/nodejs-proto-prototype-pollution/index.html#client-side-prototype-pollution-to-xss)
- [ ] [**Server Side Inclusion/Edge Side Inclusion**](server-side-inclusion-edge-side-inclusion-injection.md)
- [ ] [**Server Side Request Forgery**](ssrf-server-side-request-forgery/index.html)
- [ ] [**Server Side Template Injection**](ssti-server-side-template-injection/index.html)
- [ ] [**Reverse Tab Nabbing**](reverse-tab-nabbing.md)
- [ ] [**XSLT Server Side Injection**](xslt-server-side-injection-extensible-stylesheet-language-transformations.md)
- [ ] [**XSS**](xss-cross-site-scripting/index.html)
- [ ] [**XSSI**](xssi-cross-site-script-inclusion.md)
- [ ] [**XS-Search**](xs-search/index.html)

上記の脆弱性の中には特別な条件が必要なものもあれば、単にコンテンツが反映されるだけで成立するものもあります。脆弱性を素早くテストするための興味深い polygloths は次で見つけられます:


{{#ref}}
pocs-and-polygloths-cheatsheet/
{{#endref}}

### **検索機能**

その機能がバックエンド内のデータを検索するために使われる場合、任意のデータを検索するために(悪)用できる可能性があります。

- [ ] [**File Inclusion/Path Traversal**](file-inclusion/index.html)
- [ ] [**NoSQL Injection**](nosql-injection.md)
- [ ] [**LDAP Injection**](ldap-injection.md)
- [ ] [**ReDoS**](regular-expression-denial-of-service-redos.md)
- [ ] [**SQL Injection**](sql-injection/index.html)
- [ ] [**ORM Injection**](orm-injection.md)
- [ ] [**RSQL Injection**](rsql-injection.md)
- [ ] [**XPATH Injection**](xpath-injection.md)

### **フォーム、WebSockets、PostMsgs**

WebSocket がメッセージを送信したり、ユーザにアクションを実行させるフォームがあると脆弱性が発生することがあります。

- [ ] [**Cross Site Request Forgery**](csrf-cross-site-request-forgery.md)
- [ ] [**Cross-site WebSocket hijacking (CSWSH)**](websocket-attacks.md)
- [ ] [**Phone Number Injections**](phone-number-injections.md)
- [ ] [**PostMessage Vulnerabilities**](postmessage-vulnerabilities/index.html)

#### Cross-site WebSocket hijacking & localhost abuse

WebSocket のアップグレードはクッキーを自動的に転送し、`ws://127.0.0.1` をブロックしないため、任意の web origin が `Origin` 検証をスキップするデスクトップ IPC エンドポイントを操作できる場合があります。ローカルエージェントを通じて JSON-RPC ライクな API を公開しているランチャーを見つけたら:

- 送出されるフレームを観察して、各メソッドに必要な `type`/`name`/`args` タプルを複製します。
- ブラウザから直接リッスンポートを総当たりし（Chromium は約16k の失敗したアップグレードを処理できます）、ループバックソケットがプロトコルバナーで応答するまで試行します — 同じ負荷では Firefox はすぐにクラッシュする傾向があります。
- *create → privileged action* のペアを連鎖させます。例：GUID を返す `create*` メソッドを呼び出し、直ちに対応する `*Launch*` メソッドを攻撃者制御のペイロードで呼び出します。

任意の JVM フラグ（例えば `AdditionalJavaArguments`）を渡せる場合、`-XX:MaxMetaspaceSize=<tiny>` でエラーを強制し、`-XX:OnOutOfMemoryError="<cmd>"` を付けることでアプリケーションロジックに触れることなく OS コマンドを実行できます。手順は [WebSocket attacks](websocket-attacks.md#localhost-websocket-abuse--browser-port-discovery) を参照してください。

### **HTTP ヘッダ**

Web サーバが返す HTTP ヘッダによっては、いくつかの脆弱性が存在する場合があります。

- [ ] [**Clickjacking**](clickjacking.md)
- [ ] [**Iframe Traps / Click Isolation**](iframe-traps.md)
- [ ] [**Content Security Policy bypass**](content-security-policy-csp-bypass/index.html)
- [ ] [**Cookies Hacking**](hacking-with-cookies/index.html)
- [ ] [**CORS - Misconfigurations & Bypass**](cors-bypass.md)

### **バイパス**

特定の機能では回避策が有用な場合があります。

- [ ] [**2FA/OTP Bypass**](2fa-bypass.md)
- [ ] [**Bypass Payment Process**](bypass-payment-process.md)
- [ ] [**Captcha Bypass**](captcha-bypass.md)
- [ ] [**Account Takeover Playbooks**](account-takeover.md)
- [ ] [**Login Bypass**](login-bypass/index.html)
- [ ] [**Race Condition**](race-condition.md)
- [ ] [**Rate Limit Bypass**](rate-limit-bypass.md)
- [ ] [**Reset Forgotten Password Bypass**](reset-password.md)
- [ ] [**Registration Vulnerabilities**](registration-vulnerabilities.md)

### **構造化オブジェクト / 特定の機能**

一部の機能は（言語のシリアライズオブジェクトや XML のように）データを非常に特定のフォーマットで構造化することを要求します。そのため、その種のデータを処理しているかどうかでアプリケーションが脆弱かどうかを判断しやすくなります。特定の機能は、入力が特定のフォーマットである場合にも脆弱になることがあります（例：Email Header Injections）。

- [ ] [**Deserialization**](deserialization/index.html)
- [ ] [**Email Header Injection**](email-injections.md)
- [ ] [**JWT Vulnerabilities**](hacking-jwt-json-web-tokens.md)
- [ ] [**JSON / XML / YAML Hacking**](json-xml-yaml-hacking.md)
- [ ] [**XML External Entity**](xxe-xee-xml-external-entity.md)
- [ ] [**GraphQL Attacks**](../network-services-pentesting/pentesting-web/graphql.md)
- [ ] [**gRPC-Web Attacks**](grpc-web-pentest.md)
- [ ] [**SOAP/JAX-WS ThreadLocal Auth Bypass**](soap-jax-ws-threadlocal-auth-bypass.md)

### ファイル

ファイルをアップロードできる機能は複数の問題に対して脆弱な可能性があります。ユーザ入力を含むファイルを生成する機能は、予期しないコードを実行することがあります。ユーザがユーザによってアップロードされた、またはユーザ入力を含む自動生成されたファイルを開くと、危害を受ける可能性があります。

- [ ] [**File Upload**](file-upload/index.html)
- [ ] [**Formula Injection**](formula-csv-doc-latex-ghostscript-injection.md)
- [ ] [**PDF Injection**](xss-cross-site-scripting/pdf-injection.md)
- [ ] [**Server Side XSS**](xss-cross-site-scripting/server-side-xss-dynamic-pdf.md)

### **外部アイデンティティ管理**

- [ ] [**OAUTH to Account takeover**](oauth-to-account-takeover.md)
- [ ] [**SAML Attacks**](saml-attacks/index.html)

### **その他の有用な脆弱性**

これらの脆弱性は他の脆弱性を悪用するうえで役立つことがあります。

- [ ] [**Domain/Subdomain takeover**](domain-subdomain-takeover.md)
- [ ] [**IDOR**](idor.md)
- [ ] [**Mass Assignment (CWE-915)**](mass-assignment-cwe-915.md)
- [ ] [**Parameter Pollution**](parameter-pollution.md)
- [ ] [**Unicode Normalization vulnerability**](unicode-injection/index.html)

### **Web サーバ & ミドルウェア**

エッジスタックのミスコンフィグレーションは、アプリケーション層でより重大なバグの引き金になることがよくあります。

- [ ] [**Apache**](../network-services-pentesting/pentesting-web/apache.md)
- [ ] [**Nginx**](../network-services-pentesting/pentesting-web/nginx.md)
- [ ] [**IIS**](../network-services-pentesting/pentesting-web/iis-internet-information-services.md)
- [ ] [**Tomcat**](../network-services-pentesting/pentesting-web/tomcat/)
- [ ] [**Spring Actuators**](../network-services-pentesting/pentesting-web/spring-actuators.md)
- [ ] [**PUT Method / WebDAV**](../network-services-pentesting/pentesting-web/put-method-webdav.md)
- [ ] [**Special HTTP Headers**](../network-services-pentesting/pentesting-web/special-http-headers.md)
- [ ] [**WSGI Deployment**](../network-services-pentesting/pentesting-web/wsgi.md)
- [ ] [**Werkzeug Debug Exposure**](../network-services-pentesting/pentesting-web/werkzeug.md)

### **アプリケーションフレームワーク & スタック**

フレームワーク固有のプリミティブは、しばしばガジェット、危険なデフォルト設定、あるいはフレームワークが所有するエンドポイントを露出させます。

- [ ] [**Django**](../network-services-pentesting/pentesting-web/django.md)
- [ ] [**Flask**](../network-services-pentesting/pentesting-web/flask.md)
- [ ] [**NodeJS / Express**](../network-services-pentesting/pentesting-web/nodejs-express.md)
- [ ] [**Angular**](../network-services-pentesting/pentesting-web/angular.md)
- [ ] [**Vue / Nuxt**](../network-services-pentesting/pentesting-web/vuejs.md)
- [ ] [**Next.js**](../network-services-pentesting/pentesting-web/nextjs.md)
- [ ] [**Laravel**](../network-services-pentesting/pentesting-web/laravel.md)
- [ ] [**Symfony**](../network-services-pentesting/pentesting-web/symphony.md)

### **CMS、SaaS & マネージドプラットフォーム**

攻撃対象面が大きい製品は、既知のエクスプロイト、脆弱なプラグイン、あるいは特権的な管理者エンドポイントを同梱していることがよくあります。

- [ ] [**WordPress**](../network-services-pentesting/pentesting-web/wordpress.md)
- [ ] [**Joomla**](../network-services-pentesting/pentesting-web/joomla.md)
- [ ] [**Drupal**](../network-services-pentesting/pentesting-web/drupal/)
- [ ] [**Moodle**](../network-services-pentesting/pentesting-web/moodle.md)
- [ ] [**Prestashop**](../network-services-pentesting/pentesting-web/prestashop.md)
- [ ] [**Atlassian Jira**](../network-services-pentesting/pentesting-web/jira.md)
- [ ] [**Grafana**](../network-services-pentesting/pentesting-web/grafana.md)
- [ ] [**Rocket.Chat**](../network-services-pentesting/pentesting-web/rocket-chat.md)
- [ ] [**Zabbix**](../network-services-pentesting/pentesting-web/zabbix.md)
- [ ] [**Microsoft SharePoint**](../network-services-pentesting/pentesting-web/microsoft-sharepoint.md)
- [ ] [**Sitecore**](../network-services-pentesting/pentesting-web/sitecore/)

### **API、バケット & 統合**

サーバサイドのヘルパーやサードパーティ統合は、ファイル解析やストレージ層の弱点を露出させることがあります。

- [ ] [**Web API Pentesting**](../network-services-pentesting/pentesting-web/web-api-pentesting.md)
- [ ] [**Storage Buckets & Firebase**](../network-services-pentesting/pentesting-web/buckets/)
- [ ] [**Imagemagick Security**](../network-services-pentesting/pentesting-web/imagemagick-security.md)
- [ ] [**Artifactory & Package Registries**](../network-services-pentesting/pentesting-web/artifactory-hacking-guide.md)
- [ ] [**Code Review Tooling**](../network-services-pentesting/pentesting-web/code-review-tools.md)

### **サプライチェーン & 識別子の悪用**

ビルドパイプラインや予測可能な識別子を狙う攻撃は、従来のバグを悪用する前の初期足がかりとなることがあります。

- [ ] [**Dependency Confusion**](dependency-confusion.md)
- [ ] [**Timing Attacks**](timing-attacks.md)
- [ ] [**UUID Insecurities**](uuid-insecurities.md)

### **Web3、拡張機能 & ツール**

現代のアプリケーションはブラウザ、ウォレット、オートメーションパイプラインに拡張されているため、これらのベクタも対象に含めてください。

- [ ] [**dApps / Decentralized Applications**](dapps-DecentralizedApplications.md)
- [ ] [**Browser Extension Pentesting**](browser-extension-pentesting-methodology/)
- [ ] [**wfuzz Web Fuzzing**](web-tool-wfuzz.md)

## 参考文献

- [When WebSockets Lead to RCE in CurseForge](https://elliott.diy/blog/curseforge/)

{{#include ../banners/hacktricks-training.md}}
