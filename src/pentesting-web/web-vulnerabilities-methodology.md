# Web Vulnerabilities Methodology

{{#include ../banners/hacktricks-training.md}}


In every Web Pentest, there are **several hidden and obvious places that might be vulnerable**. This post is meant to be a checklist to confirm that you have searched for vulnerabilities in all the possible places.

## Proxies

> [!TIP]
> Nowadays **web** **applications** usually **uses** some kind of **intermediary** **proxies**, those may be (ab)used to exploit vulnerabilities. These vulnerabilities need a vulnerable proxy to be in place, but they usually also need some extra vulnerability in the backend.

- [ ] [**Abusing hop-by-hop headers**](abusing-hop-by-hop-headers.md)
- [ ] [**Cache Poisoning/Cache Deception**](cache-deception/index.html)
- [ ] [**HTTP Request Smuggling**](http-request-smuggling/)
- [ ] [**H2C Smuggling**](h2c-smuggling.md)
- [ ] [**Server Side Inclusion/Edge Side Inclusion**](server-side-inclusion-edge-side-inclusion-injection.md)
- [ ] [**Uncovering Cloudflare**](../network-services-pentesting/pentesting-web/uncovering-cloudflare.md)
- [ ] [**XSLT Server Side Injection**](xslt-server-side-injection-extensible-stylesheet-language-transformations.md)
- [ ] [**Proxy / WAF Protections Bypass**](proxy-waf-protections-bypass.md)

## **User input**

> [!TIP]
> Most of the web applications will **allow users to input some data that will be processed later.**\
> Depending on the structure of the data the server is expecting some vulnerabilities may or may not apply.

### **Reflected Values**

If the introduced data may somehow be reflected in the response, the page might be vulnerable to several issues.

- [ ] [**Client Side Template Injection**](client-side-template-injection-csti.md)
- [ ] [**Command Injection**](command-injection.md)
- [ ] [**CRLF**](crlf-0d-0a.md)
- [ ] [**Dangling Markup**](dangling-markup-html-scriptless-injection/index.html)
- [ ] [**File Inclusion/Path Traversal**](file-inclusion/index.html)
- [ ] [**Open Redirect**](open-redirect.md)
- [ ] [**Prototype Pollution to XSS**](deserialization/nodejs-proto-prototype-pollution/index.html#client-side-prototype-pollution-to-xss)
- [ ] [**Server Side Inclusion/Edge Side Inclusion**](server-side-inclusion-edge-side-inclusion-injection.md)
- [ ] [**Server Side Request Forgery**](ssrf-server-side-request-forgery/index.html)
- [ ] [**Server Side Template Injection**](ssti-server-side-template-injection/index.html)
- [ ] [**Reverse Tab Nabbing**](reverse-tab-nabbing.md)
- [ ] [**XSLT Server Side Injection**](xslt-server-side-injection-extensible-stylesheet-language-transformations.md)
- [ ] [**XSS**](xss-cross-site-scripting/index.html)
- [ ] [**XSSI**](xssi-cross-site-script-inclusion.md)
- [ ] [**XS-Search**](xs-search/index.html)

Some of the mentioned vulnerabilities require special conditions, others just require the content to be reflected. You can find some interesting polygloths to test quickly the vulnerabilities in:


{{#ref}}
pocs-and-polygloths-cheatsheet/
{{#endref}}

### **Search functionalities**

If the functionality may be used to search some kind of data inside the backend, maybe you can (ab)use it to search arbitrary data.

- [ ] [**File Inclusion/Path Traversal**](file-inclusion/index.html)
- [ ] [**NoSQL Injection**](nosql-injection.md)
- [ ] [**LDAP Injection**](ldap-injection.md)
- [ ] [**ReDoS**](regular-expression-denial-of-service-redos.md)
- [ ] [**SQL Injection**](sql-injection/index.html)
- [ ] [**XPATH Injection**](xpath-injection.md)

### **Forms, WebSockets and PostMsgs**

When a websocket posts a message or a form allowing users to perform actions vulnerabilities may arise.

- [ ] [**Cross Site Request Forgery**](csrf-cross-site-request-forgery.md)
- [ ] [**Cross-site WebSocket hijacking (CSWSH)**](websocket-attacks.md)
- [ ] [**PostMessage Vulnerabilities**](postmessage-vulnerabilities/index.html)

### **HTTP Headers**

Depending on the HTTP headers given by the web server some vulnerabilities might be present.

- [ ] [**Clickjacking**](clickjacking.md)
- [ ] [**Content Security Policy bypass**](content-security-policy-csp-bypass/index.html)
- [ ] [**Cookies Hacking**](hacking-with-cookies/index.html)
- [ ] [**CORS - Misconfigurations & Bypass**](cors-bypass.md)

### **Bypasses**

There are several specific functionalities where some workarounds might be useful to bypass them

- [ ] [**2FA/OTP Bypass**](2fa-bypass.md)
- [ ] [**Bypass Payment Process**](bypass-payment-process.md)
- [ ] [**Captcha Bypass**](captcha-bypass.md)
- [ ] [**Login Bypass**](login-bypass/index.html)
- [ ] [**Race Condition**](race-condition.md)
- [ ] [**Rate Limit Bypass**](rate-limit-bypass.md)
- [ ] [**Reset Forgotten Password Bypass**](reset-password.md)
- [ ] [**Registration Vulnerabilities**](registration-vulnerabilities.md)

### **Structured objects / Specific functionalities**

Some functionalities will require the **data to be structured in a very specific format** (like a language serialized object or XML). Therefore, it's easier to identify if the application might be vulnerable as it needs to be processing that kind of data.\
Some **specific functionalities** may be also vulnerable if a **specific format of the input is used** (like Email Header Injections).

- [ ] [**Deserialization**](deserialization/index.html)
- [ ] [**Email Header Injection**](email-injections.md)
- [ ] [**JWT Vulnerabilities**](hacking-jwt-json-web-tokens.md)
- [ ] [**XML External Entity**](xxe-xee-xml-external-entity.md)
- [ ] [**GraphQL Attacks**](../network-services-pentesting/pentesting-web/graphql.md)
- [ ] [**gRPC-Web Attacks**](grpc-web-pentest.md)

### Files

Functionalities that allow uploading files might be vulnerable to several issues.\
Functionalities that generate files including user input might execute unexpected code.\
Users that open files uploaded by users or automatically generated including user input might be compromised.

- [ ] [**File Upload**](file-upload/index.html)
- [ ] [**Formula Injection**](formula-csv-doc-latex-ghostscript-injection.md)
- [ ] [**PDF Injection**](xss-cross-site-scripting/pdf-injection.md)
- [ ] [**Server Side XSS**](xss-cross-site-scripting/server-side-xss-dynamic-pdf.md)

### **External Identity Management**

- [ ] [**OAUTH to Account takeover**](oauth-to-account-takeover.md)
- [ ] [**SAML Attacks**](saml-attacks/index.html)

### **Other Helpful Vulnerabilities**

These vulnerabilities might help to exploit other vulnerabilities.

- [ ] [**Domain/Subdomain takeover**](domain-subdomain-takeover.md)
- [ ] [**IDOR**](idor.md)
- [ ] [**Mass Assignment (CWE-915)**](mass-assignment-cwe-915.md)
- [ ] [**Parameter Pollution**](parameter-pollution.md)
- [ ] [**Unicode Normalization vulnerability**](unicode-injection/index.html)

## Reversing & Researching Web CVEs: Patch Diffing and Runtime Debugging

When advisories are vague, reproducible research starts by cloning the affected stack, watching requests reach the insecure sink, and validating the vulnerable primitive through the patch diff. A repeatable workflow greatly accelerates PoC and detection authoring.

### Reconstructing the target stack

- Mirror the exact vulnerable release (version, build ID, feature flags, optional modules). For closed products harvest vendor changelogs, support docs, forum exports, or MSP mirrors to recover installers and default deployments (edge-facing vs internal).
- Replicate production topology: same app server (Tomcat, IIS, node CLI, PHP-FPM), SSL offloading, reverse proxies, tenant modes, and external dependencies. Minor differences (e.g. extra module, hotfix rollup) often eliminate the vulnerable code path.
- Document bootstrap steps, credentials, and dataset so the environment is easily rebuilt when you later diff, debug, or validate mitigation.

### Runtime debugging playbooks

- **Java / JVM**: start Tomcat or standalone launch scripts with `-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:5005` and restart. In IntelliJ IDEA, import every product JAR via *Project Structure → Libraries*, create a *Remote JVM Debug* profile (host/port matching the JDWP listener), and set breakpoints in controllers, filters, deserializers, and template renderers. Use *Evaluate Expression* on suspended requests to inspect headers, cookies, and body parsers as payloads traverse toward dangerous sinks.
- **.NET (Framework/Core)**: load assemblies into ILSpy, dotPeek, or dnSpyEx to recover readable C#, search namespaces referenced in release notes, and attach their inbuilt debuggers to the IIS Express/Kestrel worker. Break on controllers, middleware, or helper classes referenced by the patch and watch how unsanitized input reaches file, process, or auth routines.
- **Node.js**: instrument the service with `node --inspect` (or `--inspect-brk` to halt on entry) and attach VS Code’s Node debugger. Break on Express/Koa route handlers, middleware, or templating hooks to confirm which query/header/body fields reach sinks such as `child_process.exec`, `fs.readFile`, or ORM helpers.
- **PHP**: enable Xdebug, point VS Code or PHPStorm to the listener, and break at the front controller, router, parameter normalizers, and file/system call sites. Stepping through legacy superglobal handling exposes traversal, include, or SQL injection primitives hidden behind convoluted glue code.

### Patch diff workflow

- When vendor patches are not published, decompile both vulnerable and fixed builds (e.g. `jadx` for JARs, `ilspycmd` for .NET, `unzip` + diff for PHP) and compare them with Git to spotlight the security fix:

```bash
mkdir -p /tmp/cve-reverse && cd /tmp/cve-reverse
jadx -d vulnerable-src /path/to/vulnerable.jar
jadx -d patched-src /path/to/patched.jar
cp -r vulnerable-src repo && cd repo && git init
git add . && git commit -m "vulnerable version"
rsync -a --delete ../patched-src/ .
git add -A && git commit -m "patched version"
git --no-pager diff HEAD~1 HEAD > ../patch.diff
```

- Focus review on freshly added guards (auth checks, header normalizers, path canonicalizers), new helper functions, or altered call arguments. Each change usually reveals the missing precondition that an attacker can violate.

### CVE triage & primitive extraction

- Prioritize advisories exposing pre-auth network surfaces, default configurations, or low-complexity triggers—especially where vendor notes mention header trust, serialization, templating, or path normalization mistakes.
- Small, surgical diffs (single conditional, newly wrapped sink, swapped validator) normally indicate a stable exploit primitive and are ideal hunting grounds for variants across the same product family.
- Use debugger traces plus diff context to express the primitive precisely: *“unvalidated `X-Proxy` header is parsed before auth and later passed into YAML deserialization.”*

### Safe PoCs & detection templates

- Derive the smallest reproducible HTTP interaction that reaches the vulnerable branch (distinct body field, crafted header, traversal path). Keep it side-effect free: target read-only endpoints, reversible writes, or time-based markers.
- Version-pin PoCs and always replay them against at least one fixed build as a negative control to prove the indicator disappears post-patch.
- Convert the trigger into a [Nuclei](https://github.com/projectdiscovery/nuclei) template with raw HTTP requests, explicit status/body matchers, optional `dsl` duration checks for timing primitives, `stop-at-first-match: true`, bounded redirects, and method-specific timeouts. Split templates when OS-specific normalization (Windows vs Linux paths) or tenancy modes require separate payloads.

### Knowledge management for repeatability

- Maintain a per-CVE folder structure under VCS (Git + Git LFS for large artifacts):
  - `lab-notes.md` for chronological hypotheses, payloads, dead ends, and environment quirks.
  - `lab/` for Docker/compose manifests and debugger configs.
  - `requests/` for Burp exports or raw HTTP reproductions.
  - `diffs/` for decompiled source trees and `patch.diff` files.
  - `detections/` for PoCs, Nuclei templates, and validation logs.
- Log even partial primitives (odd normalization, limited info leaks, timing anomalies). Revisiting these “quirks” later often enables chaining into full pre-auth RCE once a compatible sink or gadget is found.

## References

- [ProjectDiscovery - How to Research & Reverse Web Vulnerabilities 101](https://projectdiscovery.io/blog/how-to-research-web-vulnerabilities)

{{#include ../banners/hacktricks-training.md}}
