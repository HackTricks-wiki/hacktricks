# Методологія вразливостей Web

{{#include ../banners/hacktricks-training.md}}


У кожному Web Pentest існує **кілька прихованих та очевидних місць, які можуть бути вразливими**. Ця сторінка призначена як чекліст, щоб переконатися, що ви перевірили на наявність уразливостей усі можливі місця.

## Проксі

> [!TIP]
> Наразі **web applications** зазвичай використовують певні проміжні **proxies**, які можуть бути (з)ловживані для експлуатації уразливостей. Ці вразливості вимагають наявності вразливого проксі, але зазвичай також потребують додаткової уразливості в бекенді.

- [ ] [**Abusing hop-by-hop headers**](abusing-hop-by-hop-headers.md)
- [ ] [**Cache Poisoning/Cache Deception**](cache-deception/index.html)
- [ ] [**HTTP Connection Contamination**](http-connection-contamination.md)
- [ ] [**HTTP Connection Request Smuggling**](http-connection-request-smuggling.md)
- [ ] [**HTTP Request Smuggling**](http-request-smuggling/)
- [ ] [**HTTP Response Smuggling / Desync**](http-response-smuggling-desync.md)
- [ ] [**H2C Smuggling**](h2c-smuggling.md)
- [ ] [**Server Side Inclusion/Edge Side Inclusion**](server-side-inclusion-edge-side-inclusion-injection.md)
- [ ] [**Uncovering Cloudflare**](../network-services-pentesting/pentesting-web/uncovering-cloudflare.md)
- [ ] [**XSLT Server Side Injection**](xslt-server-side-injection-extensible-stylesheet-language-transformations.md)
- [ ] [**Proxy / WAF Protections Bypass**](proxy-waf-protections-bypass.md)

## **User input**

> [!TIP]
> Більшість **web applications** дозволяють користувачам вводити деякі дані, які будуть оброблені пізніше.\
> Залежно від структури даних, яку очікує сервер, деякі вразливості можуть застосовуватися, а деякі — ні.

### **Reflected Values**

Якщо введені дані якимось чином можуть бути відображені в відповіді, сторінка може бути вразливою до кількох проблем.

- [ ] [**Client Side Path Traversal**](client-side-path-traversal.md)
- [ ] [**Client Side Template Injection**](client-side-template-injection-csti.md)
- [ ] [**Command Injection**](command-injection.md)
- [ ] [**CRLF**](crlf-0d-0a.md)
- [ ] [**Dangling Markup**](dangling-markup-html-scriptless-injection/index.html)
- [ ] [**File Inclusion/Path Traversal**](file-inclusion/index.html)
- [ ] [**Open Redirect**](open-redirect.md)
- [ ] [**Prototype Pollution to XSS**](deserialization/nodejs-proto-prototype-pollution/index.html#client-side-prototype-pollution-to-xss)
- [ ] [**Server Side Inclusion/Edge Side Inclusion**](server-side-inclusion-edge-side-inclusion-injection.md)
- [ ] [**Server Side Request Forgery**](ssrf-server-side-request-forgery/index.html)
- [ ] [**Server Side Template Injection**](ssti-server-side-template-injection/index.html)
- [ ] [**Reverse Tab Nabbing**](reverse-tab-nabbing.md)
- [ ] [**XSLT Server Side Injection**](xslt-server-side-injection-extensible-stylesheet-language-transformations.md)
- [ ] [**XSS**](xss-cross-site-scripting/index.html)
- [ ] [**XSSI**](xssi-cross-site-script-inclusion.md)
- [ ] [**XS-Search**](xs-search/index.html)

Деякі з перелічених вразливостей вимагають спеціальних умов, інші — лише відображення контенту. Ви можете знайти кілька цікавих polygloths для швидкого тестування вразливостей у:

{{#ref}}
pocs-and-polygloths-cheatsheet/
{{#endref}}

### **Search functionalities**

Якщо функціонал може використовуватися для пошуку якихось даних в бекенді, можливо, його можна (з)ловживати для пошуку довільних даних.

- [ ] [**File Inclusion/Path Traversal**](file-inclusion/index.html)
- [ ] [**NoSQL Injection**](nosql-injection.md)
- [ ] [**LDAP Injection**](ldap-injection.md)
- [ ] [**ReDoS**](regular-expression-denial-of-service-redos.md)
- [ ] [**SQL Injection**](sql-injection/index.html)
- [ ] [**ORM Injection**](orm-injection.md)
- [ ] [**RSQL Injection**](rsql-injection.md)
- [ ] [**XPATH Injection**](xpath-injection.md)

### **Forms, WebSockets and PostMsgs**

Коли websocket надсилає повідомлення або форма дозволяє користувачам виконувати дії, можуть виникнути вразливості.

- [ ] [**Cross Site Request Forgery**](csrf-cross-site-request-forgery.md)
- [ ] [**Cross-site WebSocket hijacking (CSWSH)**](websocket-attacks.md)
- [ ] [**Phone Number Injections**](phone-number-injections.md)
- [ ] [**PostMessage Vulnerabilities**](postmessage-vulnerabilities/index.html)

#### Cross-site WebSocket hijacking & localhost abuse

WebSocket upgrade автоматично пересилає cookies і не блокує `ws://127.0.0.1`, тому **будь-який web origin може керувати десктопними IPC endpoint'ами**, які пропускають перевірку `Origin`. Коли ви помічаєте launcher, що експонує API типу JSON-RPC через локального агента:

- Спостерігайте за emitted frames, щоб клонувати кортежі `type`/`name`/`args`, необхідні для кожного методу.
- Bruteforce порт прослуховування безпосередньо з браузера (Chromium витримає ~16k невдалих upgrade’ів), поки loopback socket не відповість banner'ом протоколу — Firefox під тією ж навантаженням зазвичай швидко падає.
- Зв’яжіть пару *create → privileged action*: напр., викличте метод `create*`, який повертає GUID, і відразу викличте відповідний метод `*Launch*` з payload'ом, який контролює атакуючий.

Якщо ви можете передати довільні JVM flags (наприклад `AdditionalJavaArguments`), примусьте помилку з `-XX:MaxMetaspaceSize=<tiny>` і додайте `-XX:OnOutOfMemoryError="<cmd>"`, щоб виконати OS-команди без зміни логіки застосунку. Див. [WebSocket attacks](websocket-attacks.md#localhost-websocket-abuse--browser-port-discovery) для покрокового опису.

### **HTTP Headers**

Залежно від HTTP заголовків, які повертає вебсервер, можуть бути присутні певні вразливості.

- [ ] [**Clickjacking**](clickjacking.md)
- [ ] [**Iframe Traps / Click Isolation**](iframe-traps.md)
- [ ] [**Content Security Policy bypass**](content-security-policy-csp-bypass/index.html)
- [ ] [**Cookies Hacking**](hacking-with-cookies/index.html)
- [ ] [**CORS - Misconfigurations & Bypass**](cors-bypass.md)

### **Bypasses**

Є кілька специфічних функціональностей, де деякі обхідні шляхи можуть бути корисними для їх подолання

- [ ] [**2FA/OTP Bypass**](2fa-bypass.md)
- [ ] [**Bypass Payment Process**](bypass-payment-process.md)
- [ ] [**Captcha Bypass**](captcha-bypass.md)
- [ ] [**Account Takeover Playbooks**](account-takeover.md)
- [ ] [**Login Bypass**](login-bypass/index.html)
- [ ] [**Race Condition**](race-condition.md)
- [ ] [**Rate Limit Bypass**](rate-limit-bypass.md)
- [ ] [**Reset Forgotten Password Bypass**](reset-password.md)
- [ ] [**Registration Vulnerabilities**](registration-vulnerabilities.md)

### **Structured objects / Specific functionalities**

Деякі функціональності вимагатимуть, щоб **дані мали дуже специфічний формат** (наприклад, об’єкт у конкретній мові чи XML). Тому легше визначити, чи може застосунок бути вразливим, оскільки він має обробляти такі дані.\
Деякі **специфічні функціональності** також можуть бути вразливими, якщо використати **конкретний формат вводу** (наприклад, Email Header Injections).

- [ ] [**Deserialization**](deserialization/index.html)
- [ ] [**Email Header Injection**](email-injections.md)
- [ ] [**JWT Vulnerabilities**](hacking-jwt-json-web-tokens.md)
- [ ] [**JSON / XML / YAML Hacking**](json-xml-yaml-hacking.md)
- [ ] [**XML External Entity**](xxe-xee-xml-external-entity.md)
- [ ] [**GraphQL Attacks**](../network-services-pentesting/pentesting-web/graphql.md)
- [ ] [**gRPC-Web Attacks**](grpc-web-pentest.md)
- [ ] [**SOAP/JAX-WS ThreadLocal Auth Bypass**](soap-jax-ws-threadlocal-auth-bypass.md)

### Files

Функціонали, що дозволяють завантажувати файли, можуть бути вразливими до кількох проблем.\
Функціонали, що генерують файли, включаючи введені користувачами дані, можуть виконувати непередбачений код.\
Користувачі, які відкривають файли, завантажені іншими користувачами або автоматично згенеровані з введенням користувача, можуть бути скомпрометовані.

- [ ] [**File Upload**](file-upload/index.html)
- [ ] [**Formula Injection**](formula-csv-doc-latex-ghostscript-injection.md)
- [ ] [**PDF Injection**](xss-cross-site-scripting/pdf-injection.md)
- [ ] [**Server Side XSS**](xss-cross-site-scripting/server-side-xss-dynamic-pdf.md)

### **External Identity Management**

- [ ] [**OAUTH to Account takeover**](oauth-to-account-takeover.md)
- [ ] [**SAML Attacks**](saml-attacks/index.html)

### **Other Helpful Vulnerabilities**

Ці вразливості можуть допомогти експлуатувати інші уразливості.

- [ ] [**Domain/Subdomain takeover**](domain-subdomain-takeover.md)
- [ ] [**IDOR**](idor.md)
- [ ] [**Mass Assignment (CWE-915)**](mass-assignment-cwe-915.md)
- [ ] [**Parameter Pollution**](parameter-pollution.md)
- [ ] [**Unicode Normalization vulnerability**](unicode-injection/index.html)

### **Web Servers & Middleware**

Неправильні налаштування в edge stack часто відкривають більш серйозні баги на рівні застосунку.

- [ ] [**Apache**](../network-services-pentesting/pentesting-web/apache.md)
- [ ] [**Nginx**](../network-services-pentesting/pentesting-web/nginx.md)
- [ ] [**IIS**](../network-services-pentesting/pentesting-web/iis-internet-information-services.md)
- [ ] [**Tomcat**](../network-services-pentesting/pentesting-web/tomcat/)
- [ ] [**Spring Actuators**](../network-services-pentesting/pentesting-web/spring-actuators.md)
- [ ] [**PUT Method / WebDAV**](../network-services-pentesting/pentesting-web/put-method-webdav.md)
- [ ] [**Special HTTP Headers**](../network-services-pentesting/pentesting-web/special-http-headers.md)
- [ ] [**WSGI Deployment**](../network-services-pentesting/pentesting-web/wsgi.md)
- [ ] [**Werkzeug Debug Exposure**](../network-services-pentesting/pentesting-web/werkzeug.md)

### **Application Frameworks & Stacks**

Примітиви, специфічні для фреймворків, часто відкривають гаджети, небезпечні установки за замовчуванням або ендпоїнти, якими володіє фреймворк.

- [ ] [**Django**](../network-services-pentesting/pentesting-web/django.md)
- [ ] [**Flask**](../network-services-pentesting/pentesting-web/flask.md)
- [ ] [**NodeJS / Express**](../network-services-pentesting/pentesting-web/nodejs-express.md)
- [ ] [**Angular**](../network-services-pentesting/pentesting-web/angular.md)
- [ ] [**Vue / Nuxt**](../network-services-pentesting/pentesting-web/vuejs.md)
- [ ] [**Next.js**](../network-services-pentesting/pentesting-web/nextjs.md)
- [ ] [**Laravel**](../network-services-pentesting/pentesting-web/laravel.md)
- [ ] [**Symfony**](../network-services-pentesting/pentesting-web/symphony.md)

### **CMS, SaaS & Managed Platforms**

Продукти з великою поверхнею атаки часто постачаються з відомими експлоїтами, слабкими плагінами або привілейованими адміністративними ендпоїнтами.

- [ ] [**WordPress**](../network-services-pentesting/pentesting-web/wordpress.md)
- [ ] [**Joomla**](../network-services-pentesting/pentesting-web/joomla.md)
- [ ] [**Drupal**](../network-services-pentesting/pentesting-web/drupal/)
- [ ] [**Moodle**](../network-services-pentesting/pentesting-web/moodle.md)
- [ ] [**Prestashop**](../network-services-pentesting/pentesting-web/prestashop.md)
- [ ] [**Atlassian Jira**](../network-services-pentesting/pentesting-web/jira.md)
- [ ] [**Grafana**](../network-services-pentesting/pentesting-web/grafana.md)
- [ ] [**Rocket.Chat**](../network-services-pentesting/pentesting-web/rocket-chat.md)
- [ ] [**Zabbix**](../network-services-pentesting/pentesting-web/zabbix.md)
- [ ] [**Microsoft SharePoint**](../network-services-pentesting/pentesting-web/microsoft-sharepoint.md)
- [ ] [**Sitecore**](../network-services-pentesting/pentesting-web/sitecore/)

### **APIs, Buckets & Integrations**

Server-side helpers та сторонні інтеграції можуть відкривати слабкості при парсингу файлів або в шарі зберігання.

- [ ] [**Web API Pentesting**](../network-services-pentesting/pentesting-web/web-api-pentesting.md)
- [ ] [**Storage Buckets & Firebase**](../network-services-pentesting/pentesting-web/buckets/)
- [ ] [**Imagemagick Security**](../network-services-pentesting/pentesting-web/imagemagick-security.md)
- [ ] [**Artifactory & Package Registries**](../network-services-pentesting/pentesting-web/artifactory-hacking-guide.md)
- [ ] [**Code Review Tooling**](../network-services-pentesting/pentesting-web/code-review-tools.md)

### **Supply Chain & Identifier Abuse**

Атаки, що націлені на build pipelines або передбачувані ідентифікатори, можуть стати початковою точкою опори перед використанням традиційних багів.

- [ ] [**Dependency Confusion**](dependency-confusion.md)
- [ ] [**Timing Attacks**](timing-attacks.md)
- [ ] [**UUID Insecurities**](uuid-insecurities.md)

### **Web3, Extensions & Tooling**

Сучасні застосунки розширюються в браузери, wallets та автоматизаційні пайплайни — тримайте ці вектори в полі зору.

- [ ] [**dApps / Decentralized Applications**](dapps-DecentralizedApplications.md)
- [ ] [**Browser Extension Pentesting**](browser-extension-pentesting-methodology/)
- [ ] [**wfuzz Web Fuzzing**](web-tool-wfuzz.md)

## References

- [When WebSockets Lead to RCE in CurseForge](https://elliott.diy/blog/curseforge/)

{{#include ../banners/hacktricks-training.md}}
