# Metodología de Vulnerabilidades Web

{{#include ../banners/hacktricks-training.md}}

<figure><img src="/images/pentest-tools.svg" alt=""><figcaption></figcaption></figure>

**Obtén la perspectiva de un hacker sobre tus aplicaciones web, red y nube**

**Encuentra e informa sobre vulnerabilidades críticas y explotables con un impacto real en el negocio.** Utiliza nuestras más de 20 herramientas personalizadas para mapear la superficie de ataque, encontrar problemas de seguridad que te permitan escalar privilegios y usar exploits automatizados para recopilar evidencia esencial, convirtiendo tu arduo trabajo en informes persuasivos.

{% embed url="https://pentest-tools.com/?utm_term=jul2024&utm_medium=link&utm_source=hacktricks&utm_campaign=spons" %}

En cada Pentest Web, hay **varios lugares ocultos y obvios que podrían ser vulnerables**. Esta publicación está destinada a ser una lista de verificación para confirmar que has buscado vulnerabilidades en todos los lugares posibles.

## Proxies

> [!NOTE]
> Hoy en día, las **aplicaciones** **web** suelen **utilizar** algún tipo de **proxies** **intermediarios**, que pueden ser (mal) utilizados para explotar vulnerabilidades. Estas vulnerabilidades necesitan que haya un proxy vulnerable en su lugar, pero generalmente también requieren alguna vulnerabilidad adicional en el backend.

- [ ] [**Abuso de encabezados hop-by-hop**](abusing-hop-by-hop-headers.md)
- [ ] [**Envenenamiento de caché/Decepción de caché**](cache-deception/)
- [ ] [**Smuggling de solicitudes HTTP**](http-request-smuggling/)
- [ ] [**Smuggling H2C**](h2c-smuggling.md)
- [ ] [**Inclusión del lado del servidor/Inyección del lado de la frontera**](server-side-inclusion-edge-side-inclusion-injection.md)
- [ ] [**Descubriendo Cloudflare**](../network-services-pentesting/pentesting-web/uncovering-cloudflare.md)
- [ ] [**Inyección del lado del servidor XSLT**](xslt-server-side-injection-extensible-stylesheet-language-transformations.md)
- [ ] [**Bypass de protecciones Proxy/WAF**](proxy-waf-protections-bypass.md)

## **Entrada del usuario**

> [!NOTE]
> La mayoría de las aplicaciones web **permitirán a los usuarios ingresar algunos datos que serán procesados más tarde.**\
> Dependiendo de la estructura de los datos que el servidor espera, algunas vulnerabilidades pueden o no aplicarse.

### **Valores reflejados**

Si los datos introducidos pueden reflejarse de alguna manera en la respuesta, la página podría ser vulnerable a varios problemas.

- [ ] [**Inyección de plantillas del lado del cliente**](client-side-template-injection-csti.md)
- [ ] [**Inyección de comandos**](command-injection.md)
- [ ] [**CRLF**](crlf-0d-0a.md)
- [ ] [**Markup colgante**](dangling-markup-html-scriptless-injection/)
- [ ] [**Inclusión de archivos/Recorrido de rutas**](file-inclusion/)
- [ ] [**Redirección abierta**](open-redirect.md)
- [ ] [**Contaminación de prototipos a XSS**](deserialization/nodejs-proto-prototype-pollution/#client-side-prototype-pollution-to-xss)
- [ ] [**Inclusión del lado del servidor/Inyección del lado de la frontera**](server-side-inclusion-edge-side-inclusion-injection.md)
- [ ] [**Falsificación de solicitudes del lado del servidor**](ssrf-server-side-request-forgery/)
- [ ] [**Inyección de plantillas del lado del servidor**](ssti-server-side-template-injection/)
- [ ] [**Nabbing de pestañas inverso**](reverse-tab-nabbing.md)
- [ ] [**Inyección del lado del servidor XSLT**](xslt-server-side-injection-extensible-stylesheet-language-transformations.md)
- [ ] [**XSS**](xss-cross-site-scripting/)
- [ ] [**XSSI**](xssi-cross-site-script-inclusion.md)
- [ ] [**XS-Search**](xs-search/)

Algunas de las vulnerabilidades mencionadas requieren condiciones especiales, otras solo requieren que el contenido sea reflejado. Puedes encontrar algunos poliglotas interesantes para probar rápidamente las vulnerabilidades en:

{{#ref}}
pocs-and-polygloths-cheatsheet/
{{#endref}}

### **Funcionalidades de búsqueda**

Si la funcionalidad puede ser utilizada para buscar algún tipo de datos dentro del backend, tal vez puedas (mal) utilizarla para buscar datos arbitrarios.

- [ ] [**Inclusión de archivos/Recorrido de rutas**](file-inclusion/)
- [ ] [**Inyección NoSQL**](nosql-injection.md)
- [ ] [**Inyección LDAP**](ldap-injection.md)
- [ ] [**ReDoS**](regular-expression-denial-of-service-redos.md)
- [ ] [**Inyección SQL**](sql-injection/)
- [ ] [**Inyección XPATH**](xpath-injection.md)

### **Formularios, WebSockets y PostMsgs**

Cuando un websocket publica un mensaje o un formulario que permite a los usuarios realizar acciones, pueden surgir vulnerabilidades.

- [ ] [**Falsificación de solicitudes entre sitios**](csrf-cross-site-request-forgery.md)
- [ ] [**Secuestro de WebSocket entre sitios (CSWSH)**](websocket-attacks.md)
- [ ] [**Vulnerabilidades de PostMessage**](postmessage-vulnerabilities/)

### **Encabezados HTTP**

Dependiendo de los encabezados HTTP proporcionados por el servidor web, algunas vulnerabilidades podrían estar presentes.

- [ ] [**Clickjacking**](clickjacking.md)
- [ ] [**Bypass de Política de Seguridad de Contenidos**](content-security-policy-csp-bypass/)
- [ ] [**Hacking de Cookies**](hacking-with-cookies/)
- [ ] [**CORS - Configuraciones incorrectas y Bypass**](cors-bypass.md)

### **Bypasses**

Hay varias funcionalidades específicas donde algunos métodos alternativos podrían ser útiles para eludirlas.

- [ ] [**Bypass de 2FA/OTP**](2fa-bypass.md)
- [ ] [**Bypass del proceso de pago**](bypass-payment-process.md)
- [ ] [**Bypass de Captcha**](captcha-bypass.md)
- [ ] [**Bypass de inicio de sesión**](login-bypass/)
- [ ] [**Condición de carrera**](race-condition.md)
- [ ] [**Bypass de límite de tasa**](rate-limit-bypass.md)
- [ ] [**Bypass de restablecimiento de contraseña olvidada**](reset-password.md)
- [ ] [**Vulnerabilidades de registro**](registration-vulnerabilities.md)

### **Objetos estructurados / Funcionalidades específicas**

Algunas funcionalidades requerirán que los **datos estén estructurados en un formato muy específico** (como un objeto serializado en lenguaje o XML). Por lo tanto, es más fácil identificar si la aplicación podría ser vulnerable, ya que necesita procesar ese tipo de datos.\
Algunas **funcionalidades específicas** también pueden ser vulnerables si se utiliza un **formato específico de entrada** (como Inyecciones de Encabezados de Correo Electrónico).

- [ ] [**Deserialización**](deserialization/)
- [ ] [**Inyección de Encabezados de Correo Electrónico**](email-injections.md)
- [ ] [**Vulnerabilidades de JWT**](hacking-jwt-json-web-tokens.md)
- [ ] [**Entidad Externa XML**](xxe-xee-xml-external-entity.md)

### Archivos

Las funcionalidades que permiten subir archivos podrían ser vulnerables a varios problemas.\
Las funcionalidades que generan archivos incluyendo la entrada del usuario podrían ejecutar código inesperado.\
Los usuarios que abren archivos subidos por otros usuarios o generados automáticamente que incluyen la entrada del usuario podrían verse comprometidos.

- [ ] [**Subida de Archivos**](file-upload/)
- [ ] [**Inyección de Fórmulas**](formula-csv-doc-latex-ghostscript-injection.md)
- [ ] [**Inyección de PDF**](xss-cross-site-scripting/pdf-injection.md)
- [ ] [**XSS del lado del servidor**](xss-cross-site-scripting/server-side-xss-dynamic-pdf.md)

### **Gestión de Identidad Externa**

- [ ] [**OAUTH para toma de cuentas**](oauth-to-account-takeover.md)
- [ ] [**Ataques SAML**](saml-attacks/)

### **Otras Vulnerabilidades Útiles**

Estas vulnerabilidades podrían ayudar a explotar otras vulnerabilidades.

- [ ] [**Toma de dominio/subdominio**](domain-subdomain-takeover.md)
- [ ] [**IDOR**](idor.md)
- [ ] [**Contaminación de Parámetros**](parameter-pollution.md)
- [ ] [**Vulnerabilidad de Normalización Unicode**](unicode-injection/)

<figure><img src="/images/pentest-tools.svg" alt=""><figcaption></figcaption></figure>

**Obtén la perspectiva de un hacker sobre tus aplicaciones web, red y nube**

**Encuentra e informa sobre vulnerabilidades críticas y explotables con un impacto real en el negocio.** Utiliza nuestras más de 20 herramientas personalizadas para mapear la superficie de ataque, encontrar problemas de seguridad que te permitan escalar privilegios y usar exploits automatizados para recopilar evidencia esencial, convirtiendo tu arduo trabajo en informes persuasivos.

{% embed url="https://pentest-tools.com/?utm_term=jul2024&utm_medium=link&utm_source=hacktricks&utm_campaign=spons" %}

{{#include ../banners/hacktricks-training.md}}
