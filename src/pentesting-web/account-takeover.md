# Account Takeover

{{#include ../banners/hacktricks-training.md}}

## **Authorization Issue**

किसी खाते का ईमेल बदलने का प्रयास किया जाना चाहिए, और पुष्टि प्रक्रिया **ज़रूर जाँची जानी चाहिए**। यदि यह **कमजोर** पाई जाए तो ईमेल को लक्षित पीड़ित के ईमेल पर बदलकर पुष्टि किया जाना चाहिए।

## **Unicode Normalization Issue**

1. लक्षित पीड़ित का खाता `victim@gmail.com`
2. Unicode का उपयोग करके एक खाता बनाया जाना चाहिए।  
उदाहरण के लिए: `vićtim@gmail.com`

जैसा कि [**this talk**](https://www.youtube.com/watch?v=CiIyaZ3x49c) में समझाया गया है, उपर्युक्त हमला third party identity providers का दुरुपयोग करके भी किया जा सकता है:

- third party identity में victim के समान email के साथ कुछ unicode character का उपयोग कर एक account बनाएं (`vićtim@company.com`).
- third party provider को email verify नहीं करना चाहिए
- अगर identity provider email verify करता है, तो आप domain हिस्से पर हमला कर सकते हैं, जैसे: `victim@ćompany.com` और उस domain को register कर लें और आशा करें कि identity provider domain का ascii version बना देगा जबकि victim platform domain name को normalize करेगा।
- इस identity provider के जरिए victim platform में login करें, जो unicode character को normalize करके आपको victim account तक पहुँचने की अनुमति दे सकता है।

For further details, refer to the document on Unicode Normalization:


{{#ref}}
unicode-injection/unicode-normalization.md
{{#endref}}

## **Reusing Reset Token**

यदि target सिस्टम को **reset link to be reused** की अनुमति देता है, तो gau, wayback, या scan.io जैसे टूल्स का उपयोग करके और **reset links** खोजने के प्रयास किए जाने चाहिए।

## **Pre Account Takeover**

1. लक्षित पीड़ित के ईमेल का उपयोग प्लेटफ़ॉर्म पर sign up करने के लिए किया जाना चाहिए, और पासवर्ड सेट किया जाना चाहिए (पुष्टि का प्रयास किया जाना चाहिए, हालांकि victim के ईमेल तक पहुँच न होने से यह असंभव हो सकता है)।
2. तब तक प्रतीक्षा करनी चाहिए जब तक victim OAuth का उपयोग करके sign up न कर ले और account को confirm न करे।
3. उम्मीद की जाती है कि सामान्य signup confirm हो जाएगा, जिससे victim के account तक पहुँच संभव होगी।

## **CORS Misconfiguration to Account Takeover**

यदि पेज में **CORS misconfigurations** हैं, तो आप उपयोगकर्ता से संवेदनशील जानकारी चुरा सकते हैं ताकि आप उसके account को takeover कर सकें या उसी उद्देश्य के लिए वह authentication जानकारी बदलवा सकें:


{{#ref}}
cors-bypass.md
{{#endref}}

## **Csrf to Account Takeover**

यदि पेज CSRF के लिए vulnerable है, तो आप उपयोगकर्ता से उसका **password**, **email** या authentication बदलवा सकते हैं ताकि आप बाद में उसमें पहुँच सकें:


{{#ref}}
csrf-cross-site-request-forgery.md
{{#endref}}

## **XSS to Account Takeover**

यदि आप application में XSS पाते हैं, तो आप cookies, local storage, या वेब पेज की जानकारी चुरा सकते हैं जो आपको account takeover करने में सक्षम बना सकती है:


{{#ref}}
xss-cross-site-scripting/
{{#endref}}

- Attribute-only reflected payloads on login pages `document.onkeypress` को hook कर सकते हैं, `new Image().src` के माध्यम से keystrokes exfiltrate कर सकते हैं, और form submit किए बिना credentials चुरा सकते हैं। व्यावहारिक workflow के लिए [Attribute-only login XSS behind WAFs](xss-cross-site-scripting/README.md#attribute-only-login-xss-behind-wafs) देखें।

## **Same Origin + Cookies**

यदि आप किसी सीमित XSS या subdomain take over पाते हैं, तो आप cookies के साथ (उदाहरण के लिए उन्हें fixating करके) प्रयोग कर सकते हैं ताकि victim account compromise करने का प्रयास किया जा सके:


{{#ref}}
hacking-with-cookies/
{{#endref}}

## **Attacking Password Reset Mechanism**


{{#ref}}
reset-password.md
{{#endref}}

## Security-question resets that trust client-supplied usernames
If an "update security questions" flow takes a `username` parameter even though the caller is already authenticated, you can overwrite any account's recovery data (including admins) because the backend typically runs `UPDATE ... WHERE user_name = ?` with your untrusted value. The pattern is:

1. एक throwaway user के साथ login करें और session cookie capture करें।
2. reset form के माध्यम से victim `username` और नए answers submit करें।
3. आपने जो answers inject किए थे उनका उपयोग करके security-question login endpoint के माध्यम से तुरंत authenticate करें ताकि आप victim के privileges inherit कर सकें।
```http
POST /reset.php HTTP/1.1
Host: file.era.htb
Cookie: PHPSESSID=<low-priv>
Content-Type: application/x-www-form-urlencoded

username=admin_ef01cab31aa&new_answer1=A&new_answer2=B&new_answer3=C
```
Anything gated by the victim's `$_SESSION` context (admin dashboards, dangerous stream-wrapper features, etc.) अब असली जवाबों को छुए बिना एक्सपोज़ हो जाता है।

Enumerated usernames को फिर ऊपर दिए गए overwrite technique के जरिए target किया जा सकता है या ancillary services (FTP/SSH password spraying) के खिलाफ reuse किया जा सकता है।

## **Response Manipulation**

यदि authentication response को **एक साधारण boolean तक reduce किया जा सके तो बस false को true में बदलकर देखें** और देखें क्या आपको कोई access मिलती है।

## OAuth to Account takeover


{{#ref}}
oauth-to-account-takeover.md
{{#endref}}

## Host Header Injection

1. password reset request initiate करने के बाद Host header modify किया जाता है।
2. `X-Forwarded-For` proxy header को `attacker.com` में बदल दिया जाता है।
3. Host, Referrer, और Origin headers को एक साथ `attacker.com` में बदल दिया जाता है।
4. password reset initiate करने के बाद mail पुनः भेजने का विकल्प चुनते समय ऊपर बताई गई तीनों विधियों का उपयोग किया जाता है।

## Response Manipulation

1. **Code Manipulation**: status code को `200 OK` में बदल दिया जाता है।
2. **Code and Body Manipulation**:
- status code को `200 OK` में बदल दिया जाता है।
- response body को `{"success":true}` या एक empty object `{}` में modify किया जाता है।

ये manipulation techniques उन स्थितियों में प्रभावी हैं जहाँ JSON डेटा ट्रांसमिशन और प्राप्ति के लिए उपयोग किया जाता है।

## Change email of current session

From [this report](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea):

- Attacker नया ईमेल देकर अपना ईमेल बदलने का request करता है
- Attacker को ईमेल बदलने की पुष्टि करने के लिए एक link मिलता है
- Attacker उस link को victim को भेजता है ताकि वह उस पर क्लिक कर दे
- victim का ईमेल attacker द्वारा बताये गए ईमेल में बदल जाता है
- इस तरीके से attack पासवर्ड recover कर के account takeover कर सकता है

This also happened in [**this report**](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea).


### Bypass email verification for Account Takeover
- Attacker attacker@test.com से login करता है और signup के समय ईमेल verify कर लेता है।
- Attacker verified ईमेल को victim@test.com में बदल देता है (email change पर कोई secondary verification नहीं)
- अब वेबसाइट victim@test.com को login करने की अनुमति देती है और हमने victim user के email verification को bypass कर लिया है।

### Old Cookies

जैसा कि [**in this post**](https://medium.com/@niraj1mahajan/uncovering-the-hidden-vulnerability-how-i-found-an-authentication-bypass-on-shopifys-exchange-cc2729ea31a9) में बताया गया है, यह possible था कि एक account में login करके, cookies को एक authenticated user के रूप में save किया जाए, logout किया जाए, और फिर फिर से login किया जाए.\
नए login के साथ, भले ही अलग cookies generate हों, पुराने ones फिर से काम करने लगे।

## References

- [https://blog.hackcommander.com/posts/2025/12/28/turning-a-harmless-xss-behind-a-waf-into-a-realistic-phishing-vector/](https://blog.hackcommander.com/posts/2025/12/28/turning-a-harmless-xss-behind-a-waf-into-a-realistic-phishing-vector/)
- [https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050](https://infosecwriteups.com/firing-8-account-takeover-methods-77e892099050)
- [https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea](https://dynnyd20.medium.com/one-click-account-take-over-e500929656ea)
- [0xdf – HTB Era: security-question IDOR & username oracle](https://0xdf.gitlab.io/2025/11/29/htb-era.html)
{{#include ../banners/hacktricks-training.md}}
