# Reset/Forgotten Password Bypass

{{#include ../banners/hacktricks-training.md}}

<figure><img src="../images/image (3).png" alt=""><figcaption></figcaption></figure>

Sluit aan by [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) bediener om met ervare hackers en bug bounty jagters te kommunikeer!

**Hacking Insights**\
Betrek met inhoud wat die opwinding en uitdagings van hacking ondersoek

**Real-Time Hack News**\
Bly op hoogte van die vinnig bewegende hacking wêreld deur middel van real-time nuus en insigte

**Latest Announcements**\
Bly ingelig oor die nuutste bug bounties wat bekendgestel word en belangrike platform opdaterings

**Join us on** [**Discord**](https://discord.com/invite/N3FrSbmwdy) en begin vandag saamwerk met top hackers!

## **Password Reset Token Leak Via Referrer**

- Die HTTP referer header mag die wagwoord reset token lek as dit in die URL ingesluit is. Dit kan gebeur wanneer 'n gebruiker op 'n derdeparty webwerf skakel na 'n wagwoord reset versoek.
- **Impact**: Potensiële rekening oorname via Cross-Site Request Forgery (CSRF) aanvalle.
- **Exploitation**: Om te kontroleer of 'n wagwoord reset token in die referer header lek, **versoek 'n wagwoord reset** na jou e-pos adres en **klik die reset skakel** wat gegee is. **Moet nie jou wagwoord** onmiddellik verander nie. In plaas daarvan, **navigeer na 'n derdeparty webwerf** (soos Facebook of Twitter) terwyl jy **die versoeke met Burp Suite onderskep**. Ondersoek die versoeke om te sien of die **referer header die wagwoord reset token bevat**, aangesien dit sensitiewe inligting aan derde partye kan blootstel.
- **References**:
- [HackerOne Report 342693](https://hackerone.com/reports/342693)
- [HackerOne Report 272379](https://hackerone.com/reports/272379)
- [Password Reset Token Leak Article](https://medium.com/@rubiojhayz1234/toyotas-password-reset-token-and-email-address-leak-via-referer-header-b0ede6507c6a)

## **Password Reset Poisoning**

- Aanvallers mag die Host header manipuleer tydens wagwoord reset versoeke om die reset skakel na 'n kwaadwillige webwerf te wys.
- **Impact**: Lei tot potensiële rekening oorname deur reset tokens aan aanvallers te lek.
- **Mitigation Steps**:
- Valideer die Host header teen 'n witlys van toegelate domeine.
- Gebruik veilige, bediener-kant metodes om absolute URL's te genereer.
- **Patch**: Gebruik `$_SERVER['SERVER_NAME']` om wagwoord reset URL's te konstrueer in plaas van `$_SERVER['HTTP_HOST']`.
- **References**:
- [Acunetix Article on Password Reset Poisoning](https://www.acunetix.com/blog/articles/password-reset-poisoning/)

## **Password Reset By Manipulating Email Parameter**

Aanvallers kan die wagwoord reset versoek manipuleer deur addisionele e-pos parameters by te voeg om die reset skakel te omlei.

- Voeg aanvaller e-pos as tweede parameter by met &
```php
POST /resetPassword
[...]
email=victim@email.com&email=attacker@email.com
```
- Voeg aanvaller e-pos as tweede parameter by gebruik van %20
```php
POST /resetPassword
[...]
email=victim@email.com%20email=attacker@email.com
```
- Voeg aanvaller e-pos as tweede parameter by gebruik van |
```php
POST /resetPassword
[...]
email=victim@email.com|email=attacker@email.com
```
- Voeg aanvaller se e-pos as tweede parameter by gebruik van cc
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dcc:attacker@mail.tld"
```
- Voeg aanvaller e-pos as tweede parameter by gebruik van bcc
```php
POST /resetPassword
[...]
email="victim@mail.tld%0a%0dbcc:attacker@mail.tld"
```
- Voeg aanvaller e-pos as tweede parameter by gebruik van ,
```php
POST /resetPassword
[...]
email="victim@mail.tld",email="attacker@mail.tld"
```
- Voeg aanvaller e-pos as tweede parameter in json-array by.
```php
POST /resetPassword
[...]
{"email":["victim@mail.tld","atracker@mail.tld"]}
```
- **Versagingsstappe**:
- Parse en valideer e-posparameters behoorlik aan die bediener-kant.
- Gebruik voorbereide verklarings of geparametriseerde navrae om inspuitaanvalle te voorkom.
- **Verwysings**:
- [https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be](https://medium.com/@0xankush/readme-com-account-takeover-bugbounty-fulldisclosure-a36ddbe915be)
- [https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/](https://ninadmathpati.com/2019/08/17/how-i-was-able-to-earn-1000-with-just-10-minutes-of-bug-bounty/)
- [https://twitter.com/HusseiN98D/status/1254888748216655872](https://twitter.com/HusseiN98D/status/1254888748216655872)

## **Verandering van E-pos en Wagwoord van enige Gebruiker deur API Parameters**

- Aanvallers kan e-pos en wagwoordparameters in API-versoeke wysig om rekeningbesonderhede te verander.
```php
POST /api/changepass
[...]
("form": {"email":"victim@email.tld","password":"12345678"})
```
- **Mitigering Stappe**:
- Verseker strikte parameter validasie en outentikasie kontroles.
- Implementeer robuuste logging en monitering om verdagte aktiwiteite te ontdek en daarop te reageer.
- **Verwysing**:
- [Volledige Rekening Oorname via API Parameter Manipulasie](https://medium.com/@adeshkolte/full-account-takeover-changing-email-and-password-of-any-user-through-api-parameters-3d527ab27240)

## **Geen Tarief Beperking: E-pos Bombardering**

- Gebrek aan tarief beperking op wagwoord herstel versoeke kan lei tot e-pos bombardering, wat die gebruiker oorweldig met herstel e-posse.
- **Mitigering Stappe**:
- Implementeer tarief beperking gebaseer op IP adres of gebruikersrekening.
- Gebruik CAPTCHA uitdagings om geoutomatiseerde misbruik te voorkom.
- **Verwysings**:
- [HackerOne Verslag 280534](https://hackerone.com/reports/280534)

## **Vind uit Hoe Wagwoord Herstel Token Geproduseer Word**

- Om die patroon of metode agter token generasie te verstaan, kan lei tot die voorspel of brute-forcing van tokens. Sommige opsies:
- Gebaseer op Tydstempel
- Gebaseer op die GebruikerID
- Gebaseer op e-pos van Gebruiker
- Gebaseer op Voornaam en Van
- Gebaseer op Geboortedatum
- Gebaseer op Kriptografie
- **Mitigering Stappe**:
- Gebruik sterk, kriptografiese metodes vir token generasie.
- Verseker voldoende ewekansigheid en lengte om voorspelbaarheid te voorkom.
- **Gereedskap**: Gebruik Burp Sequencer om die ewekansigheid van tokens te analiseer.

## **Raadbare UUID**

- As UUID's (weergawe 1) raadsbaar of voorspelbaar is, kan aanvallers dit brute-force om geldige herstel tokens te genereer. Kontroleer:

{{#ref}}
uuid-insecurities.md
{{#endref}}

- **Mitigering Stappe**:
- Gebruik GUID weergawe 4 vir ewekansigheid of implementeer addisionele sekuriteitsmaatreëls vir ander weergawes.
- **Gereedskap**: Gebruik [guidtool](https://github.com/intruder-io/guidtool) vir die analise en generasie van GUIDs.

## **Antwoord Manipulasie: Vervang Slegte Antwoord Met Goeie Een**

- Manipuleer HTTP-antwoorde om foutboodskappe of beperkings te omseil.
- **Mitigering Stappe**:
- Implementeer bediener-kant kontroles om antwoord integriteit te verseker.
- Gebruik veilige kommunikasiekanale soos HTTPS om man-in-the-middle aanvalle te voorkom.
- **Verwysing**:
- [Kritieke Fout in Lewende Bug Bounty Gebeurtenis](https://medium.com/@innocenthacker/how-i-found-the-most-critical-bug-in-live-bug-bounty-event-7a88b3aa97b3)

## **Gebruik van Verloop Token**

- Toets of verlopen tokens steeds gebruik kan word vir wagwoord herstel.
- **Mitigering Stappe**:
- Implementeer strikte token verloopbeleide en valideer token vervaldatum bediener-kant.

## **Brute Force Wagwoord Herstel Token**

- Poging om die herstel token te brute-force met gereedskap soos Burpsuite en IP-Rotator om IP-gebaseerde tarief beperkings te omseil.
- **Mitigering Stappe**:
- Implementeer robuuste tarief-beperking en rekening sluiting meganismes.
- Moniteer vir verdagte aktiwiteite wat dui op brute-force aanvalle.

## **Probeer Jou Token Gebruik**

- Toets of 'n aanvaller se herstel token gebruik kan word saam met die slagoffer se e-pos.
- **Mitigering Stappe**:
- Verseker dat tokens aan die gebruikersessie of ander gebruikers-spesifieke eienskappe gebind is.

## **Sessie Ongeldigmaking by Afmelding/Wagwoord Herstel**

- Verseker dat sessies ongeldig gemaak word wanneer 'n gebruiker afmeld of sy wagwoord herstel.
- **Mitigering Stappe**:
- Implementeer behoorlike sessie bestuur, wat verseker dat alle sessies ongeldig gemaak word by afmelding of wagwoord herstel.

## **Sessie Ongeldigmaking by Afmelding/Wagwoord Herstel**

- Herstel tokens moet 'n vervaldatum hê waarna hulle ongeldig word.
- **Mitigering Stappe**:
- Stel 'n redelike vervaldatum vir herstel tokens in en handhaaf dit streng bediener-kant.

## Verwysings

- [https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token](https://anugrahsr.github.io/posts/10-Password-reset-flaws/#10-try-using-your-token)

<figure><img src="../images/image (3).png" alt=""><figcaption></figcaption></figure>

Sluit aan by [**HackenProof Discord**](https://discord.com/invite/N3FrSbmwdy) bediener om met ervare hackers en bug bounty jagters te kommunikeer!

**Hacking Inligting**\
Betrek met inhoud wat die opwinding en uitdagings van hacking ondersoek

**Regstydse Hack Nuus**\
Bly op hoogte van die vinnig bewegende hacking wêreld deur regstydse nuus en insigte

**Laaste Aankondigings**\
Bly ingelig oor die nuutste bug bounties wat bekendgestel word en belangrike platform opdaterings

**Sluit by ons aan op** [**Discord**](https://discord.com/invite/N3FrSbmwdy) en begin saamwerk met top hackers vandag!

{{#include ../banners/hacktricks-training.md}}
