# Unicode Injection

{{#include ../../banners/hacktricks-training.md}}

## Introduction

рдЗрд╕ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреЗ рд╣реБрдП рдХрд┐ рдмреИрдХ-рдПрдВрдб/рдлреНрд░рдВрдЯ-рдПрдВрдб **рдЕрдЬреАрдм unicode рд╡рд░реНрдгреЛрдВ** рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдкрд░ рдХреИрд╕реЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рддрд╛ рд╣реИ, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ **рд╕реБрд░рдХреНрд╖рд╛рдУрдВ рдХреЛ рдмрд╛рдпрдкрд╛рд╕** рдХрд░рдиреЗ рдФрд░ **рдордирдорд╛рдиреЗ рд╡рд░реНрдгреЛрдВ рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ** рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рдиреНрд╣реЗрдВ **рдЗрдВрдЬреЗрдХреНрд╢рди рдХрдордЬреЛрд░рд┐рдпреЛрдВ** рдЬреИрд╕реЗ XSS рдпрд╛ SQLi рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

## Unicode Normalization

Unicode рд╕рд╛рдорд╛рдиреНрдпреАрдХрд░рдг рддрдм рд╣реЛрддрд╛ рд╣реИ рдЬрдм **unicode рд╡рд░реНрдгреЛрдВ рдХреЛ ascii рд╡рд░реНрдгреЛрдВ рдореЗрдВ рд╕рд╛рдорд╛рдиреНрдпреАрдХреГрдд** рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреА рдХрдордЬреЛрд░реА рдХрд╛ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдкрд░рд┐рджреГрд╢реНрдп рддрдм рд╣реЛрддрд╛ рд╣реИ рдЬрдм рд╕рд┐рд╕реНрдЯрдо **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЗрдирдкреБрдЯ рдХреЛ** рдХрд┐рд╕реА рди рдХрд┐рд╕реА рддрд░рд╣ **рд╕рдВрд╢реЛрдзрд┐рдд** рдХрд░рддрд╛ рд╣реИ **рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж**ред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдХреБрдЫ рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ **рдЗрдирдкреБрдЯ рдХреЛ рдЕрдкрд░рдХреЗрд╕ рдпрд╛ рд▓реЛрдЕрд░рдХреЗрд╕** рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдХреЙрд▓ рджрд┐рдП рдЧрдП рдЗрдирдкреБрдЯ рдХреЛ рд╕рд╛рдорд╛рдиреНрдпреАрдХреГрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ **unicode ASCII рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд** рд╣реЛ рдЬрд╛рдПрдЧрд╛, рдЬрд┐рд╕рд╕реЗ рдирдП рд╡рд░реНрдг рдЙрддреНрдкрдиреНрди рд╣реЛрдВрдЧреЗред\
рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ:

{{#ref}}
unicode-normalization.md
{{#endref}}

## `\u` to `%`

Unicode рд╡рд░реНрдг рдЖрдорддреМрд░ рдкрд░ **`\u` рдЙрдкрд╕рд░реНрдЧ** рдХреЗ рд╕рд╛рде рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрддреЗ рд╣реИрдВред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╡рд░реНрдг `у▒Л` рд╣реИ `\u3c4b`([check it here](https://unicode-explorer.com/c/3c4B)). рдпрджрд┐ рдПрдХ рдмреИрдХрдПрдВрдб **`\u` рдЙрдкрд╕рд░реНрдЧ рдХреЛ `%` рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд** рдХрд░рддрд╛ рд╣реИ, рддреЛ рдкрд░рд┐рдгрд╛рдореА рд╕реНрдЯреНрд░рд┐рдВрдЧ `%3c4b` рд╣реЛрдЧреА, рдЬрд┐рд╕реЗ URL рдбрд┐рдХреЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: **`<4b`**ред рдФрд░, рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдПрдХ **`<` рд╡рд░реНрдг рдЗрдВрдЬреЗрдХреНрдЯ** рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред\
рдпрджрд┐ рдмреИрдХрдПрдВрдб рдХрдордЬреЛрд░ рд╣реИ рддреЛ рдЖрдк рдЗрд╕ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ **рдХрд┐рд╕реА рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ рд╡рд░реНрдг рдХреЛ рдЗрдВрдЬреЗрдХреНрдЯ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред\
рдЖрдкрдХреЛ рдЖрд╡рд╢реНрдпрдХ рд╡рд░реНрдг рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП [https://unicode-explorer.com/](https://unicode-explorer.com/) рджреЗрдЦреЗрдВред

рдпрд╣ рдХрдордЬреЛрд░реА рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдПрдХ рд╢реЛрдзрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдкрд╛рдИ рдЧрдИ рдПрдХ рдХрдордЬреЛрд░реА рд╕реЗ рдЖрддреА рд╣реИ, рдЕрдзрд┐рдХ рдЧрд╣рди рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреЗ рд▓рд┐рдП рджреЗрдЦреЗрдВ [https://www.youtube.com/watch?v=aUsAHb0E7Cg](https://www.youtube.com/watch?v=aUsAHb0E7Cg)

## Emoji Injection

рдмреИрдХ-рдПрдВрдб рдХреБрдЫ рдЕрдЬреАрдм рддрд░реАрдХреЗ рд╕реЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рддреЗ рд╣реИрдВ рдЬрдм рд╡реЗ **рдЗрдореЛрдЬреА рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ**ред рдпрд╣реА [**рдЗрд╕ рд▓реЗрдЦ**](https://medium.com/@fpatrik/how-i-found-an-xss-vulnerability-via-using-emojis-7ad72de49209) рдореЗрдВ рд╣реБрдЖ, рдЬрд╣рд╛рдВ рд╢реЛрдзрдХрд░реНрддрд╛ рдиреЗ рдПрдХ рдкреЗрд▓реЛрдб рдХреЗ рд╕рд╛рде XSS рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдлрд▓рддрд╛ рдкрд╛рдИ: `ЁЯТЛimg src=x onerror=alert(document.domain)//ЁЯТЫ`

рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рддреНрд░реБрдЯрд┐ рдпрд╣ рдереА рдХрд┐ рд╕рд░реНрд╡рд░ рдиреЗ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рд╡рд░реНрдгреЛрдВ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рдмрд╛рдж **Windows-1252 рд╕реЗ UTF-8 рдореЗрдВ UTF-8 рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЛ рдкрд░рд┐рд╡рд░реНрддрд┐рдд** рдХрд┐рдпрд╛ (рдмреБрдирд┐рдпрд╛рджреА рд░реВрдк рд╕реЗ рдЗрдирдкреБрдЯ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рдФрд░ рдПрдиреНрдХреЛрдбрд┐рдВрдЧ рд░реВрдкрд╛рдВрддрд░рдг рдЕрд╕рдВрдЧрдд рдереЗ)ред рдлрд┐рд░ рдпрд╣ рдПрдХ рдЙрдЪрд┐рдд < рдирд╣реАрдВ рджреЗрддрд╛, рдХреЗрд╡рд▓ рдПрдХ рдЕрдЬреАрдм unicode: `тА╣`\
``рддреЛ рдЙрдиреНрд╣реЛрдВрдиреЗ рдЗрд╕ рдЖрдЙрдЯрдкреБрдЯ рдХреЛ рд▓рд┐рдпрд╛ рдФрд░ **рдЕрдм UTF-8 рд╕реЗ ASCII рдореЗрдВ рдлрд┐рд░ рд╕реЗ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд┐рдпрд╛**ред рдЗрд╕рдиреЗ `тА╣` рдХреЛ ` < ` рдореЗрдВ **рд╕рд╛рдорд╛рдиреНрдпреАрдХреГрдд** рдХрд┐рдпрд╛, рдпрд╣реА рдХрд╛рд░рдг рд╣реИ рдХрд┐ рдпрд╣ рдкреНрд░рдгрд╛рд▓реА рдкрд░ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдХрд╛рдо рдХрд░ рд╕рдХрд╛ред\
рдпрд╣ рдХреНрдпрд╛ рд╣реБрдЖ:
```php
<?php

$str = isset($_GET["str"]) ? htmlspecialchars($_GET["str"]) : "";

$str = iconv("Windows-1252", "UTF-8", $str);
$str = iconv("UTF-8", "ASCII//TRANSLIT", $str);

echo "String: " . $str;
```
Emoji lists:

- [https://github.com/iorch/jakaton_feminicidios/blob/master/data/emojis.csv](https://github.com/iorch/jakaton_feminicidios/blob/master/data/emojis.csv)
- [https://unicode.org/emoji/charts-14.0/full-emoji-list.html](https://unicode.org/emoji/charts-14.0/full-emoji-list.html)

## Windows Best-Fit/Worst-fit

рдЬреИрд╕рд╛ рдХрд┐ **[рдЗрд╕ рд╢рд╛рдирджрд╛рд░ рдкреЛрд╕реНрдЯ](https://blog.orange.tw/posts/2025-01-worstfit-unveiling-hidden-transformers-in-windows-ansi/)** рдореЗрдВ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, Windows рдореЗрдВ рдПрдХ рдлреАрдЪрд░ рд╣реИ рдЬрд┐рд╕реЗ **Best-Fit** рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ **unicode рд╡рд░реНрдгреЛрдВ** рдХреЛ ASCII рдореЛрдб рдореЗрдВ рдкреНрд░рджрд░реНрд╢рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЙрд╕реЗ рдПрдХ рд╕рдорд╛рди рд╡рд░реНрдг рд╕реЗ рдмрджрд▓ рджреЗрддрд╛ рд╣реИред рдЗрд╕рд╕реЗ **рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░** рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЬрдм рдмреИрдХрдПрдВрдб **рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╡рд░реНрдг** рдХреА рдЕрдкреЗрдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдЙрд╕реЗ рдПрдХ рдЕрд▓рдЧ рд╡рд░реНрдг рдорд┐рд▓рддрд╛ рд╣реИред

**[https://worst.fit/mapping/](https://worst.fit/mapping/)** рдореЗрдВ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫреЗ рдлрд┐рдЯ рд╡рд░реНрдгреЛрдВ рдХреЛ рдвреВрдВрдврдирд╛ рд╕рдВрднрд╡ рд╣реИред

рдЪреВрдВрдХрд┐ Windows рдЖрдорддреМрд░ рдкрд░ unicode рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдХреЛ ASCII рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдЕрдВрддрд┐рдо рднрд╛рдЧреЛрдВ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддрд╛ рд╣реИ (рдЖрдорддреМрд░ рдкрд░ "W" рдЙрдкрд╕рд░реНрдЧ рд╡рд╛рд▓реЗ API рд╕реЗ "A" рдЙрдкрд╕рд░реНрдЧ рд╡рд╛рд▓реЗ API рдореЗрдВ рдЬреИрд╕реЗ `GetEnvironmentVariableA` рдФрд░ `GetEnvironmentVariableW`), рдЗрд╕рд╕реЗ рд╣рдорд▓рд╛рд╡рд░реЛрдВ рдХреЛ рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИ, unicode рд╡рд░реНрдг рднреЗрдЬрдХрд░ рдЬреЛ рдЕрдВрддрддрдГ ASCII рд╡рд░реНрдгреЛрдВ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рд╣реЛ рдЬрд╛рдПрдВрдЧреЗ рдЬреЛ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдХреНрд░рд┐рдпрд╛рдПрдБ рдХрд░реЗрдВрдЧреЗред

рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ рдореЗрдВ **рдХрд╛рд▓реЗ рд╕реВрдЪреА рдХреЗ рд╡рд░реНрдгреЛрдВ** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рд╡рд┐рдзрд┐рдпрд╛рдБ рд╣реИрдВ, [тАЬ/тАЬ (0x2F) рдХреЗ рд▓рд┐рдП рдореИрдк рдХрд┐рдП рдЧрдП рд╡рд░реНрдгреЛрдВ](https://worst.fit/mapping/#to%3A0x2f) рдФрд░ [тАЬ\тАЬ (0x5C) рдХреЗ рд▓рд┐рдП рдореИрдк рдХрд┐рдП рдЧрдП рд╡рд░реНрдгреЛрдВ](https://worst.fit/mapping/#to%3A0x5c) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ **рдкрде рдпрд╛рддреНрд░рд╛** рдХрд╛ рд╢реЛрд╖рдг рдХрд░рдирд╛ рдпрд╛ PHP рдХреЗ `escapeshellarg` рдпрд╛ Python рдХреЗ `subprocess.run` рдЬреИрд╕реЗ рд╢реЗрд▓ рдПрд╕реНрдХреЗрдк рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдирд╛, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП **рдлреБрд▓рд╡рд╛рдЗрдб рдбрдмрд▓ рдХреЛрдЯреНрд╕ (U+FF02)** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рддрд╛рдХрд┐ рдЕрдВрдд рдореЗрдВ рдЬреЛ 1 рддрд░реНрдХ рдЬреИрд╕рд╛ рджрд┐рдЦрддрд╛ рдерд╛ рд╡рд╣ 2 рддрд░реНрдХреЛрдВ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рд╣реЛ рдЧрдпрд╛ред

**рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдХрд┐рд╕реА рдРрдк рдХреЛ рдХрдордЬреЛрд░ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП "W" Windows APIs рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рд▓реЗрдХрд┐рди рдЕрдВрддрддрдГ "A" Windows API рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рддрд╛рдХрд┐ unicode рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХрд╛ "Best-fit" рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХреЗред**

**рдХрдИ рдЦреЛрдЬреА рдЧрдИ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреЛ рдареАрдХ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдХреНрдпреЛрдВрдХрд┐ рд▓реЛрдЧ рдЗрд╕ рдореБрджреНрджреЗ рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╣рдордд рдирд╣реАрдВ рд╣реИрдВред**

{{#include ../../banners/hacktricks-training.md}}
