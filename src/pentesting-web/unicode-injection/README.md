# Unicode Injection

{{#include ../../banners/hacktricks-training.md}}

## Introduction

–í –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ —Ç–æ–≥–æ, —è–∫ –±–µ–∫–µ–Ω–¥/—Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ —Ä–µ–∞–≥—É—î, –∫–æ–ª–∏ –≤—ñ–Ω **–æ—Ç—Ä–∏–º—É—î –¥–∏–≤–Ω—ñ —é–Ω—ñ–∫–æ–¥–Ω—ñ —Å–∏–º–≤–æ–ª–∏**, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –±—É—Ç–∏ –≤ –∑–º–æ–∑—ñ **–æ–±—ñ–π—Ç–∏ –∑–∞—Ö–∏—Å—Ç —ñ –≤–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω—ñ —Å–∏–º–≤–æ–ª–∏**, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è **–∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—è–º–∏ —ñ–Ω'—î–∫—Ü—ñ–π**, —Ç–∞–∫–∏–º–∏ —è–∫ XSS –∞–±–æ SQLi.

## Unicode Normalization

–ù–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è —é–Ω—ñ–∫–æ–¥—É –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è, –∫–æ–ª–∏ **—é–Ω—ñ–∫–æ–¥–Ω—ñ —Å–∏–º–≤–æ–ª–∏ –Ω–æ—Ä–º–∞–ª—ñ–∑—É—é—Ç—å—Å—è –¥–æ ASCII —Å–∏–º–≤–æ–ª—ñ–≤**.

–û–¥–∏–Ω –∑ –ø–æ—à–∏—Ä–µ–Ω–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤ —Ü—ñ—î—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ –≤–∏–Ω–∏–∫–∞—î, –∫–æ–ª–∏ —Å–∏—Å—Ç–µ–º–∞ **–º–æ–¥–∏—Ñ—ñ–∫—É—î** —è–∫–∏–º–æ—Å—å —á–∏–Ω–æ–º **–≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ **–ø—ñ—Å–ª—è —ó—Ö –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏**. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –≤ –¥–µ—è–∫–∏—Ö –º–æ–≤–∞—Ö –ø—Ä–æ—Å—Ç–∏–π –≤–∏–∫–ª–∏–∫ –¥–ª—è –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è **–≤—Ö–æ–¥—É –Ω–∞ –≤–µ–ª–∏–∫–∏–π –∞–±–æ –º–∞–ª–∏–π —Ä–µ–≥—ñ—Å—Ç—Ä** –º–æ–∂–µ –Ω–æ—Ä–º–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ, —ñ **—é–Ω—ñ–∫–æ–¥ –±—É–¥–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–æ –Ω–∞ ASCII**, –≥–µ–Ω–µ—Ä—É—é—á–∏ –Ω–æ–≤—ñ —Å–∏–º–≤–æ–ª–∏.\
–î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ:

{{#ref}}
unicode-normalization.md
{{#endref}}

## `\u` to `%`

–Æ–Ω—ñ–∫–æ–¥–Ω—ñ —Å–∏–º–≤–æ–ª–∏ –∑–∞–∑–≤–∏—á–∞–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ñ –∑ **–ø—Ä–µ—Ñ—ñ–∫—Å–æ–º `\u`**. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —Å–∏–º–≤–æ–ª `„±ã` —î `\u3c4b`([–ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ç—É—Ç](https://unicode-explorer.com/c/3c4B)). –Ø–∫—â–æ –±–µ–∫–µ–Ω–¥ **–ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î** –ø—Ä–µ—Ñ—ñ–∫—Å **`\u` –Ω–∞ `%`**, –æ—Ç—Ä–∏–º–∞–Ω–∏–π —Ä—è–¥–æ–∫ –±—É–¥–µ `%3c4b`, —â–æ –ø—Ä–∏ –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—ñ URL —î: **`<4b`**. –Ü, —è–∫ –≤–∏ –º–æ–∂–µ—Ç–µ –±–∞—á–∏—Ç–∏, **—Å–∏–º–≤–æ–ª `<` —ñ–Ω'—î–∫–æ–≤–∞–Ω–æ**.\
–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü—é —Ç–µ—Ö–Ω—ñ–∫—É –¥–ª—è **–≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –±—É–¥—å-—è–∫–æ–≥–æ —Å–∏–º–≤–æ–ª—É**, —è–∫—â–æ –±–µ–∫–µ–Ω–¥ –≤—Ä–∞–∑–ª–∏–≤–∏–π.\
–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ [https://unicode-explorer.com/](https://unicode-explorer.com/), —â–æ–± –∑–Ω–∞–π—Ç–∏ –ø–æ—Ç—Ä—ñ–±–Ω—ñ —Å–∏–º–≤–æ–ª–∏.

–¶—è –≤—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –Ω–∞—Å–ø—Ä–∞–≤–¥—ñ –≤–∏–Ω–∏–∫–∞—î –∑ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ, —è–∫—É –≤–∏—è–≤–∏–≤ –¥–æ—Å–ª—ñ–¥–Ω–∏–∫, –¥–ª—è –±—ñ–ª—å—à –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø–æ—è—Å–Ω–µ–Ω–Ω—è –ø–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ [https://www.youtube.com/watch?v=aUsAHb0E7Cg](https://www.youtube.com/watch?v=aUsAHb0E7Cg)

## Emoji Injection

–ë–µ–∫–µ–Ω–¥–∏ –ø–æ–≤–æ–¥—è—Ç—å—Å—è –¥–∏–≤–Ω–æ, –∫–æ–ª–∏ –≤–æ–Ω–∏ **–æ—Ç—Ä–∏–º—É—é—Ç—å –µ–º–æ–¥–∑—ñ**. –°–∞–º–µ —Ü–µ —Å—Ç–∞–ª–æ—Å—è –≤ [**—Ü—å–æ–º—É –∑–≤—ñ—Ç—ñ**](https://medium.com/@fpatrik/how-i-found-an-xss-vulnerability-via-using-emojis-7ad72de49209), –¥–µ –¥–æ—Å–ª—ñ–¥–Ω–∏–∫ –∑–º—ñ–≥ –¥–æ—Å—è–≥—Ç–∏ XSS –∑ –∫–æ—Ä–∏—Å–Ω–∏–º –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º, —Ç–∞–∫–∏–º —è–∫: `üíãimg src=x onerror=alert(document.domain)//üíõ`

–£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –ø–æ–º–∏–ª–∫–∞ –ø–æ–ª—è–≥–∞–ª–∞ –≤ —Ç–æ–º—É, —â–æ —Å–µ—Ä–≤–µ—Ä –ø—ñ—Å–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è —à–∫—ñ–¥–ª–∏–≤–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤ **–ø–µ—Ä–µ—Ç–≤–æ—Ä–∏–≤ UTF-8 —Ä—è–¥–æ–∫ –∑ Windows-1252 –Ω–∞ UTF-8** (–≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –∫–æ–¥—É–≤–∞–Ω–Ω—è –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö —ñ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–¥—É–≤–∞–Ω–Ω—è –Ω–µ –∑–±—ñ–≥–∞–ª–∏—Å—è). –¢–æ–¥—ñ —Ü–µ –Ω–µ –¥–∞—î –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ <, –∞ –ª–∏—à–µ –¥–∏–≤–Ω–∏–π —é–Ω—ñ–∫–æ–¥–Ω–∏–π: `‚Äπ`\
``–û—Ç–∂–µ, –≤–æ–Ω–∏ –≤–∑—è–ª–∏ —Ü–µ–π –≤–∏—Ö—ñ–¥ —ñ **–∑–Ω–æ–≤—É –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏–ª–∏ –∑ UTF-8 –Ω–∞ ASCII**. –¶–µ **–Ω–æ—Ä–º–∞–ª—ñ–∑—É–≤–∞–ª–æ** `‚Äπ` –¥–æ `<`, —Ç–∞–∫ –ø—Ä–∞—Ü—é–≤–∞–≤ –µ–∫—Å–ø–ª–æ–π—Ç –Ω–∞ —Ü—ñ–π —Å–∏—Å—Ç–µ–º—ñ.\
–û—Å—å —â–æ —Å—Ç–∞–ª–æ—Å—è:
```php
<?php

$str = isset($_GET["str"]) ? htmlspecialchars($_GET["str"]) : "";

$str = iconv("Windows-1252", "UTF-8", $str);
$str = iconv("UTF-8", "ASCII//TRANSLIT", $str);

echo "String: " . $str;
```
–°–ø–∏—Å–∫–∏ –µ–º–æ–¥–∑—ñ:

- [https://github.com/iorch/jakaton_feminicidios/blob/master/data/emojis.csv](https://github.com/iorch/jakaton_feminicidios/blob/master/data/emojis.csv)
- [https://unicode.org/emoji/charts-14.0/full-emoji-list.html](https://unicode.org/emoji/charts-14.0/full-emoji-list.html)

## Windows Best-Fit/Worst-fit

–Ø–∫ –ø–æ—è—Å–Ω—é—î—Ç—å—Å—è –≤ **[—Ü—å–æ–º—É —á—É–¥–æ–≤–æ–º—É –ø–æ—Å—Ç—ñ](https://blog.orange.tw/posts/2025-01-worstfit-unveiling-hidden-transformers-in-windows-ansi/)**, Windows –º–∞—î —Ñ—É–Ω–∫—Ü—ñ—é –ø—ñ–¥ –Ω–∞–∑–≤–æ—é **Best-Fit**, —è–∫–∞ **–∑–∞–º—ñ–Ω—é—î —é–Ω—ñ–∫–æ–¥–Ω—ñ —Å–∏–º–≤–æ–ª–∏**, —è–∫—ñ –Ω–µ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω—ñ –≤ ASCII-—Ä–µ–∂–∏–º—ñ, –Ω–∞ –ø–æ–¥—ñ–±–Ω—ñ. –¶–µ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ **–Ω–µ–æ—á—ñ–∫—É–≤–∞–Ω–æ—ó –ø–æ–≤–µ–¥—ñ–Ω–∫–∏**, –∫–æ–ª–∏ –±–µ–∫–µ–Ω–¥ **–æ—á—ñ–∫—É—î –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π —Å–∏–º–≤–æ–ª**, –∞–ª–µ –æ—Ç—Ä–∏–º—É—î —ñ–Ω—à–∏–π.

–ú–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ —Å–∏–º–≤–æ–ª–∏ best-fit —É **[https://worst.fit/mapping/](https://worst.fit/mapping/)**.

–û—Å–∫—ñ–ª—å–∫–∏ Windows –∑–∞–∑–≤–∏—á–∞–π –∫–æ–Ω–≤–µ—Ä—Ç—É—î —é–Ω—ñ–∫–æ–¥–Ω—ñ —Ä—è–¥–∫–∏ –≤ ASCII-—Ä—è–¥–∫–∏ –Ω–∞ –æ–¥–Ω–æ–º—É –∑ –æ—Å—Ç–∞–Ω–Ω—ñ—Ö –µ—Ç–∞–ø—ñ–≤ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è (–∑–∞–∑–≤–∏—á–∞–π –ø–µ—Ä–µ—Ö–æ–¥—è—á–∏ –∑ API –∑ —Å—É—Ñ—ñ–∫—Å–æ–º "W" –Ω–∞ API –∑ —Å—É—Ñ—ñ–∫—Å–æ–º "A", —Ç–∞–∫—ñ —è–∫ `GetEnvironmentVariableA` —ñ `GetEnvironmentVariableW`), —Ü–µ –¥–æ–∑–≤–æ–ª—è—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞–º –æ–±—Ö–æ–¥–∏—Ç–∏ –∑–∞—Ö–∏—Å—Ç, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ —é–Ω—ñ–∫–æ–¥–Ω—ñ —Å–∏–º–≤–æ–ª–∏, —è–∫—ñ –≤ –∫—ñ–Ω—Ü—ñ –±—É–¥—É—Ç—å –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω—ñ –≤ ASCII-—Å–∏–º–≤–æ–ª–∏, —â–æ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏–º—É—Ç—å –Ω–µ–æ—á—ñ–∫—É–≤–∞–Ω—ñ –¥—ñ—ó.

–£ –±–ª–æ–∑—ñ –ø—Ä–æ–ø–æ–Ω—É—é—Ç—å—Å—è –º–µ—Ç–æ–¥–∏ –æ–±—Ö–æ–¥—É –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π, –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–∏—Ö –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **—á–æ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫—É —Å–∏–º–≤–æ–ª—ñ–≤**, –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è **–ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω—å —à–ª—è—Ö—ñ–≤** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é [—Å–∏–º–≤–æ–ª—ñ–≤, –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–∏—Ö –Ω–∞ ‚Äú/‚Äú (0x2F)](https://worst.fit/mapping/#to%3A0x2f) —Ç–∞ [—Å–∏–º–≤–æ–ª—ñ–≤, –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–∏—Ö –Ω–∞ ‚Äú\‚Äú (0x5C)](https://worst.fit/mapping/#to%3A0x5c) –∞–±–æ –Ω–∞–≤—ñ—Ç—å –æ–±—Ö–æ–¥—É –∑–∞—Ö–∏—Å—Ç—É –æ–±–æ–ª–æ–Ω–∫–∏, —Ç–∞–∫–æ–≥–æ —è–∫ `escapeshellarg` —É PHP –∞–±–æ `subprocess.run` —É Python, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Å–ø–∏—Å–æ–∫. –¶–µ –±—É–ª–æ –∑—Ä–æ–±–ª–µ–Ω–æ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ **–ø–æ–≤–Ω–æ—à–∏—Ä–æ–∫—ñ –ø–æ–¥–≤—ñ–π–Ω—ñ –ª–∞–ø–∫–∏ (U+FF02)** –∑–∞–º—ñ—Å—Ç—å –ø–æ–¥–≤—ñ–π–Ω–∏—Ö –ª–∞–ø–æ–∫, —Ç–∞–∫ —â–æ –≤ –∫—ñ–Ω—Ü—ñ —Ç–µ, —â–æ –≤–∏–≥–ª—è–¥–∞–ª–æ —è–∫ 1 –∞—Ä–≥—É–º–µ–Ω—Ç, –±—É–ª–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–æ –Ω–∞ 2 –∞—Ä–≥—É–º–µ–Ω—Ç–∏.

**–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –¥–ª—è —Ç–æ–≥–æ, —â–æ–± –¥–æ–¥–∞—Ç–æ–∫ –±—É–≤ –≤—Ä–∞–∑–ª–∏–≤–∏–º, –≤—ñ–Ω –ø–æ–≤–∏–Ω–µ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ "W" Windows API, –∞–ª–µ –≤ –∫—ñ–Ω—Ü—ñ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ "A" Windows API, —â–æ–± –±—É–ª–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ "Best-fit" —é–Ω—ñ–∫–æ–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞.**

**–ö—ñ–ª—å–∫–∞ –≤–∏—è–≤–ª–µ–Ω–∏—Ö –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π –Ω–µ –±—É–¥—É—Ç—å –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—ñ, –æ—Å–∫—ñ–ª—å–∫–∏ –ª—é–¥–∏ –Ω–µ –ø–æ–≥–æ–¥–∂—É—é—Ç—å—Å—è, —Ö—Ç–æ –º–∞—î –≤–∏–ø—Ä–∞–≤–∏—Ç–∏ —Ü—é –ø—Ä–æ–±–ª–µ–º—É.**

{{#include ../../banners/hacktricks-training.md}}
