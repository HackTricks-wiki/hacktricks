# Bağımlılık Karışıklığı

{{#include ../banners/hacktricks-training.md}}


## Temel Bilgiler

Özetle, bir bağımlılık karışıklığı açığı, bir projenin **yanlış yazılmış**, **mevcut olmayan** veya **belirtilmemiş bir sürüm** ile bir kütüphane kullanması ve kullanılan bağımlılık deposunun **güncellenmiş sürümleri kamuya açık** depolardan **toplamasına** izin vermesi durumunda meydana gelir.

- **Yanlış yazılmış**: **`reqests`** yerine `requests` içe aktarımı
- **Mevcut olmayan**: **artık mevcut olmayan** bir iç kütüphane olan `company-logging` içe aktarımı
- **Belirtilmemiş sürüm**: **mevcut** bir **iç** `company-requests` kütüphanesini içe aktarmak, ancak repo **kamuya açık repos** kontrol ederek **daha büyük sürümler** olup olmadığını kontrol eder.

## Sömürü

> [!WARNING]
> Tüm durumlarda, saldırganın sadece mağdur şirketin kullandığı kütüphanelerin **adıyla kötü niyetli bir paket yayınlaması** yeterlidir.

### Yanlış Yazılmış & Mevcut Olmayan

Eğer şirketiniz **iç kütüphane olmayan** bir kütüphaneyi **içe aktarmaya çalışıyorsa**, kütüphaneler deposunun **kamuya açık depolarda** arama yapması oldukça olasıdır. Eğer bir saldırgan bunu oluşturmuşsa, kodunuz ve çalışan makinelerinizin büyük olasılıkla tehlikeye girecektir.

### Belirtilmemiş Sürüm

Geliştiricilerin kullandıkları kütüphanenin **herhangi bir sürümünü belirtmemesi** veya sadece bir **ana sürüm** belirtmesi çok yaygındır. Bu durumda, yorumlayıcı bu gereksinimlere uyan **en son sürümü** indirmeye çalışacaktır.\
Eğer kütüphane **bilinen bir dış kütüphane** ise (örneğin python `requests`), bir **saldırganın yapabileceği pek bir şey yoktur**, çünkü `requests` adında bir kütüphane oluşturamayacaktır (eğer orijinal yazar değilse).\
Ancak, eğer kütüphane **içsel** ise, bu örnekteki gibi `requests-company`, eğer **kütüphane deposu** **yeni sürümleri dışarıdan kontrol etmeye** izin veriyorsa, kamuya açık olarak mevcut olan daha yeni bir sürümü arayacaktır.\
Yani eğer bir **saldırgan** şirketin `requests-company` kütüphanesinin **sürüm 1.0.1** (küçük güncellemeleri kabul eder) kullandığını biliyorsa, `requests-company` **sürüm 1.0.2** kütüphanesini **yayınlayabilir** ve şirket bu kütüphaneyi **iç kütüphanesi yerine kullanacaktır**.

## AWS Düzeltmesi

Bu açık AWS **CodeArtifact**'ta bulundu (bu [**blog yazısındaki detayları okuyun**](https://zego.engineering/dependency-confusion-in-aws-codeartifact-86b9ff68963d)).\
AWS, bir kütüphanenin içsel veya dışsal olup olmadığını belirtmeye izin vererek, iç bağımlılıkların dışarıdan depolardan indirilmesini önleyerek bunu düzeltti.

## Açık Kütüphaneleri Bulma

[**bağımlılık karışıklığı hakkında orijinal yazıda**](https://medium.com/@alex.birsan/dependency-confusion-4a5d60fec610) yazar, javascript projelerinin bağımlılıklarını içeren binlerce ifşa edilmiş package.json dosyasını aradı.

## Referanslar

- [https://medium.com/@alex.birsan/dependency-confusion-4a5d60fec610](https://medium.com/@alex.birsan/dependency-confusion-4a5d60fec610)
- [https://zego.engineering/dependency-confusion-in-aws-codeartifact-86b9ff68963d](https://zego.engineering/dependency-confusion-in-aws-codeartifact-86b9ff68963d)


{{#include ../banners/hacktricks-training.md}}
