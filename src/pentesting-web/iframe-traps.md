# Iframe-Traps

{{#include ../banners/hacktricks-training.md}}

## Grundinformationen

Diese Form des Missbrauchs von XSS über Iframes, um Informationen von Benutzern zu stehlen, die sich auf der Webseite bewegen, wurde ursprünglich in diesen 2 Beiträgen von trustedsec.com veröffentlicht: [**hier**](https://trustedsec.com/blog/persisting-xss-with-iframe-traps) **und** [**hier**](https://trustedsec.com/blog/js-tap-weaponizing-javascript-for-red-teams).

Der Angriff beginnt auf einer Seite, die anfällig für XSS ist, wo es möglich ist, die **Opfer daran zu hindern, die XSS zu verlassen**, indem man sie **innerhalb eines Iframes navigieren lässt**, der die gesamte Webanwendung einnimmt.

Der XSS-Angriff lädt im Grunde die Webseite in einem Iframe, der 100% des Bildschirms einnimmt. Daher wird das Opfer **nicht bemerken, dass es sich in einem Iframe befindet**. Wenn das Opfer dann auf der Seite navigiert, indem es Links innerhalb des Iframes (innerhalb des Webs) anklickt, wird es **innerhalb des Iframes navigieren**, während das willkürliche JS Informationen aus dieser Navigation stiehlt.

Darüber hinaus ist es möglich, einige **Listener** zu verwenden, um zu überprüfen, wann ein Iframe die Position der Seite ändert, und die URL des Browsers mit diesen Positionen zu aktualisieren, sodass der Benutzer denkt, er bewegt sich mit dem Browser zwischen den Seiten.

<figure><img src="../images/image (1248).png" alt=""><figcaption><p><a href="https://www.trustedsec.com/wp-content/uploads/2022/04/regEvents.png">https://www.trustedsec.com/wp-content/uploads/2022/04/regEvents.png</a></p></figcaption></figure>

<figure><img src="../images/image (1249).png" alt=""><figcaption><p><a href="https://www.trustedsec.com/wp-content/uploads/2022/04/fakeAddress-1.png">https://www.trustedsec.com/wp-content/uploads/2022/04/fakeAddress-1.png</a></p></figcaption></figure>

Darüber hinaus ist es möglich, Listener zu verwenden, um sensible Informationen zu stehlen, nicht nur die anderen Seiten, die das Opfer besucht, sondern auch die Daten, die zum **Ausfüllen von Formularen** verwendet werden, und sie zu senden (Anmeldeinformationen?) oder um **den lokalen Speicher zu stehlen**...

Natürlich sind die Hauptbeschränkungen, dass ein **Opfer den Tab schließt oder eine andere URL im Browser eingibt, wodurch es dem Iframe entkommt**. Eine andere Möglichkeit, dies zu tun, wäre, die **Seite zu aktualisieren**, jedoch könnte dies teilweise **verhindert** werden, indem das Kontextmenü mit der rechten Maustaste jedes Mal deaktiviert wird, wenn eine neue Seite im Iframe geladen wird, oder indem festgestellt wird, wenn die Maus des Benutzers den Iframe verlässt, möglicherweise um die Schaltfläche "Aktualisieren" des Browsers zu klicken, und in diesem Fall wird die URL des Browsers mit der ursprünglichen URL, die anfällig für XSS ist, aktualisiert, sodass, wenn der Benutzer sie aktualisiert, sie erneut vergiftet wird (beachten Sie, dass dies nicht sehr heimlich ist).

{{#include ../banners/hacktricks-training.md}}
