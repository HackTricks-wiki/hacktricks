# Iframe Traps

{{#include ../banners/hacktricks-training.md}}

## Basic Information

Αυτή η μορφή κατάχρησης XSS μέσω iframes για την κλοπή πληροφοριών από τον χρήστη που περιηγείται στη σελίδα δημοσιεύθηκε αρχικά σε αυτές τις 2 αναρτήσεις από το trustedsec.com: [**εδώ**](https://trustedsec.com/blog/persisting-xss-with-iframe-traps) **και** [**εδώ**](https://trustedsec.com/blog/js-tap-weaponizing-javascript-for-red-teams).

Η επίθεση ξεκινά σε μια σελίδα ευάλωτη σε XSS όπου είναι δυνατόν να γίνει ο **θύμα να μην φύγει από το XSS** κάνοντάς τους **να περιηγούνται μέσα σε ένα iframe** που καταλαμβάνει όλη την εφαρμογή ιστού.

Η επίθεση XSS θα φορτώσει βασικά τη σελίδα σε ένα iframe στο 100% της οθόνης. Επομένως, το θύμα **δεν θα παρατηρήσει ότι είναι μέσα σε ένα iframe**. Στη συνέχεια, αν το θύμα περιηγηθεί στη σελίδα κάνοντας κλικ σε συνδέσμους μέσα στο iframe (μέσα στο διαδίκτυο), θα **περιηγείται μέσα στο iframe** με το αυθαίρετο JS που φορτώνεται κλέβοντας πληροφορίες από αυτή την περιήγηση.

Επιπλέον, για να γίνει πιο ρεαλιστικό, είναι δυνατόν να χρησιμοποιηθούν κάποιοι **listeners** για να ελέγχουν πότε ένα iframe αλλάζει την τοποθεσία της σελίδας και να ενημερώνουν το URL του προγράμματος περιήγησης με αυτές τις τοποθεσίες που νομίζει ο χρήστης ότι μετακινείται σε σελίδες χρησιμοποιώντας το πρόγραμμα περιήγησης.

<figure><img src="../images/image (1248).png" alt=""><figcaption><p><a href="https://www.trustedsec.com/wp-content/uploads/2022/04/regEvents.png">https://www.trustedsec.com/wp-content/uploads/2022/04/regEvents.png</a></p></figcaption></figure>

<figure><img src="../images/image (1249).png" alt=""><figcaption><p><a href="https://www.trustedsec.com/wp-content/uploads/2022/04/fakeAddress-1.png">https://www.trustedsec.com/wp-content/uploads/2022/04/fakeAddress-1.png</a></p></figcaption></figure>

Επιπλέον, είναι δυνατόν να χρησιμοποιηθούν listeners για να κλέψουν ευαίσθητες πληροφορίες, όχι μόνο τις άλλες σελίδες που επισκέπτεται το θύμα, αλλά και τα δεδομένα που χρησιμοποιούνται για **συμπλήρωση φορμών** και αποστολή τους (διαπιστευτήρια;) ή για **κλοπή της τοπικής αποθήκευσης**...

Φυσικά, οι κύριοι περιορισμοί είναι ότι ένα **θύμα που κλείνει την καρτέλα ή βάζει άλλη διεύθυνση URL στο πρόγραμμα περιήγησης θα ξεφύγει από το iframe**. Ένας άλλος τρόπος για να γίνει αυτό θα ήταν να **ανανεωθεί η σελίδα**, ωστόσο, αυτό θα μπορούσε να αποτραπεί εν μέρει **απενεργοποιώντας** το μενού περιβάλλοντος του δεξιού κλικ κάθε φορά που φορτώνεται μια νέα σελίδα μέσα στο iframe ή παρατηρώντας πότε το ποντίκι του χρήστη φεύγει από το iframe, πιθανώς για να κάνει κλικ στο κουμπί ανανέωσης του προγράμματος περιήγησης και σε αυτή την περίπτωση το URL του προγράμματος περιήγησης ενημερώνεται με το αρχικό URL που είναι ευάλωτο σε XSS, οπότε αν ο χρήστης το ανανεώσει, θα μολυνθεί ξανά (σημειώστε ότι αυτό δεν είναι πολύ διακριτικό).

{{#include ../banners/hacktricks-training.md}}
