# Iframe Traps

{{#include ../banners/hacktricks-training.md}}

## Basic Information

Ця форма зловживання XSS через iframe для крадіжки інформації у користувача, який переміщується по веб-сторінці, була спочатку опублікована в цих 2 постах з trustedsec.com: [**тут**](https://trustedsec.com/blog/persisting-xss-with-iframe-traps) **та** [**тут**](https://trustedsec.com/blog/js-tap-weaponizing-javascript-for-red-teams).

Атака починається на сторінці, вразливій до XSS, де можливо змусити **жертв не залишати XSS**, змушуючи їх **переміщатися в iframe**, який займає всю веб-застосунок.

Атака XSS в основному завантажить веб-сторінку в iframe на 100% екрану. Тому жертва **не помітить, що вона всередині iframe**. Потім, якщо жертва переміщається по сторінці, натискаючи на посилання всередині iframe (всередині вебу), вона буде **переміщатися всередині iframe** з довільним JS, що краде інформацію з цього переміщення.

Більше того, щоб зробити це більш реалістичним, можливо використовувати деякі **слухачі**, щоб перевірити, коли iframe змінює місцезнаходження сторінки, і оновити URL браузера з тими місцезнаходженнями, які користувач вважає, що він переміщується по сторінках, використовуючи браузер.

<figure><img src="../images/image (1248).png" alt=""><figcaption><p><a href="https://www.trustedsec.com/wp-content/uploads/2022/04/regEvents.png">https://www.trustedsec.com/wp-content/uploads/2022/04/regEvents.png</a></p></figcaption></figure>

<figure><img src="../images/image (1249).png" alt=""><figcaption><p><a href="https://www.trustedsec.com/wp-content/uploads/2022/04/fakeAddress-1.png">https://www.trustedsec.com/wp-content/uploads/2022/04/fakeAddress-1.png</a></p></figcaption></figure>

Більше того, можливо використовувати слухачів для крадіжки чутливої інформації, не лише інших сторінок, які відвідує жертва, але й даних, що використовуються для **заповнення форм** і їх відправки (облікові дані?) або для **крадіжки локального сховища**...

Звичайно, основні обмеження полягають у тому, що **жертва закриває вкладку або вводить іншу URL-адресу в браузері, що дозволяє вийти з iframe**. Інший спосіб зробити це - **оновити сторінку**, однак це може бути частково **запобігти** шляхом відключення контекстного меню правої кнопки миші щоразу, коли нова сторінка завантажується всередині iframe, або помічаючи, коли миша користувача виходить з iframe, потенційно щоб натиснути кнопку перезавантаження браузера, і в цьому випадку URL браузера оновлюється з оригінальною URL-адресою, вразливою до XSS, тому якщо користувач перезавантажить її, вона знову отримає отруєння (зауважте, що це не дуже непомітно).

{{#include ../banners/hacktricks-training.md}}
