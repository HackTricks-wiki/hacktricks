# CAPTCHA Bypass

{{#include /banners/hacktricks-training.md}}

This page covers techniques, tools, and research for bypassing CAPTCHAs (Completely Automated Public Turing tests to tell Computers and Humans Apart). CAPTCHAs are widely used to prevent automated abuse, but attackers have developed numerous methods to bypass or defeat them.

## Table of Contents

- [Introduction](#introduction)
- [Types of CAPTCHAs](#types-of-captchas)
- [Manual / Human-in-the-loop Solving](#manual--human-in-the-loop-solving)
- [OCR and Rule-based Solving](#ocr-and-rule-based-solving)
- [Machine Learning and AI-based Solving](#machine-learning-and-ai-based-solving)
- [Audio CAPTCHA Solving](#audio-captcha-solving)
- [Third-party CAPTCHA Solving Services](#third-party-captcha-solving-services)
- [Bypassing Invisible and Behavioral CAPTCHAs](#bypassing-invisible-and-behavioral-captchas)
- [Headless Browser and Automation Detection Evasion](#headless-browser-and-automation-detection-evasion)
- [Implementation Vulnerabilities](#implementation-vulnerabilities)
- [Tools](#tools)
- [Example Workflow](#example-workflow)
- [Defensive Measures](#defensive-measures)
- [References](#references)

---

## Introduction

CAPTCHAs are challenge–response tests designed to differentiate human users from automated bots. While effective against naive scripts, CAPTCHAs can be bypassed through various offensive techniques. This guide surveys modern bypass approaches, focusing on recent research (2022–2025) and updated tools.

## Types of CAPTCHAs

- Text-based (distorted characters)
- Image-based (select all images matching a pattern)
- Audio-based (spoken words or numbers)
- Invisible / Behavioral (e.g., reCAPTCHA v3 score)
- Logical puzzles (e.g., click all moving objects)

## Manual / Human-in-the-loop Solving

When automation fails, CAPTCHAs can be forwarded to human solvers. Attackers automate submission and scraping of images then post to platforms like Mechanical Turk or specialized APIs:

```bash
# Example using 2Captcha API
CAPTCHA_FILE="captcha.jpg"
API_KEY="YOUR_2CAPTCHA_KEY"
# Send
curl -F method=post -F key=$API_KEY -F file=@$CAPTCHA_FILE https://2captcha.com/in.php
# Poll for result
curl "http://2captcha.com/res.php?key=$API_KEY&action=get&id=CAPTCHA_ID"
```  

Modern services support hCaptcha, reCAPTCHA v2/v3, FunCaptcha, and bespoke variants.

## OCR and Rule-based Solving

Early bypass tools rely on image preprocessing (thresholding, erosion, dilation) and Tesseract OCR:

```bash
# Preprocess with ImageMagick
docker run --rm -v $(pwd):/data wagnerb/imagemagick convert captcha.png -colorspace Gray -blur 1x1 -threshold 50% proc.png
tesseract proc.png stdout --psm 7
```

Rule-based heuristics parse known distortions and fonts. Effective only against weak, static CAPTCHAs.

## Machine Learning and AI-based Solving

Recent advances leverage convolutional neural networks (CNNs) and transformer models for high-accuracy solving.

- **CAPTCHA Breaker (2023)**: Uses a ResNet50 backbone to achieve >90% accuracy on common text CAPTCHAs. Trained with synthetic data and GAN-augmented noise patterns.
- **FlowSpell (2024)**: Applies flow-based generative models to reconstruct distorted characters before recognition.
- **Vision Transformers (ViT) for Image CAPTCHA**: Fine-tuned ViT models classify multi-part puzzles (e.g., “select all traffic lights”) with 85–92% accuracy.

GitHub projects:

- github.com/0xingress/captcha-breaking
- github.com/anshuman23/CAPTCHA-Breaker-V2

## Audio CAPTCHA Solving

Audio CAPTCHAs can be transcribed via deep speech models:

```python
from deepspeech import Model
model = Model('deepspeech.pbmm')
print(model.stt(open('captcha_audio.wav','rb').read()))
```  

Preprocessing may include band-pass filtering and noise reduction.

## Third-party CAPTCHA Solving Services

Automated services offer API-based solving for high-volume attacks:

- 2Captcha / rucaptcha
- Anti-Captcha
- CapSolver
- CapMonster

They support asynchronous polling, proxies, and callback hooks. Typical success rates are 70–95% depending on complexity.

## Bypassing Invisible and Behavioral CAPTCHAs

**reCAPTCHA v3** assigns risk scores based on user interaction. Attackers mimic human-like behaviors:

- **Burpsuite Plugin**: Randomized mouse movements and timing delays to simulate human interaction.  
- **Session Riding**: Reusing valid tokens by capturing `g-recaptcha-response` and replaying on different forms before expiry (90s window).  

Adversarial ML research shows generating synthetic user events (scroll, click) yields v3 scores >0.5 consistently (USENIX '23) citeturn3search5.

**Honeypot Fields**: Hidden form fields expected empty. Bots filling them reveal automation. Attackers omit or selectively omit known honeypots.

## Headless Browser and Automation Detection Evasion

Sites detect headless browsers via JS fingerprinting (navigator.webdriver, Chrome webdriver flags). Evade using:

- **Puppeteer Stealth**: Puppeteer-extra-plugin-stealth hides headless indicators.  
- **Selenium Stealth**: Python package monkey-patches Selenium to remove `navigator.webdriver`.  

Example:

```python
from selenium import webdriver
from selenium_stealth import stealth
options = webdriver.ChromeOptions()
options.add_argument('--disable-blink-features=AutomationControlled')
driver = webdriver.Chrome(options=options)
stealth(driver,
    languages=['en-US','en'],
    vendor='Google Inc.',
    platform='Win32',
    webgl_vendor='Intel Inc.',
    renderer='Intel Iris OpenGL Engine')
```  

## Implementation Vulnerabilities

Common mistakes allow bypass:

- **Client-side Verification**: CAPTCHA validation only in JavaScript; attackers disable or modify check.  
- **Predictable Tokens**: Using non-cryptographic PRNG for token generation (e.g., `Math.random()`).  
- **Short Expiry Windows**: Tokens valid for long durations enable replay attacks.  

## Tools

- **2Captcha API clients** (Python, Node.js, Go)
- **captcha-solver** (CLI for local OCR solving)  
- **captcha-breaker** (ML-based frameworks)
- **Puppeteer-extra-plugin-stealth**  
- **Selenium Stealth**  

## Example Workflow

1. **Fingerprint Analysis**: Identify CAPTCHA type (reCAPTCHA v2, hCaptcha, etc.).  
2. **Automation Setup**: Launch headless browser with stealth plugins.  
3. **Capture Challenge**: Intercept image/audio challenge.  
4. **Solve**: Use local ML model or third-party service.  
5. **Submit**: Inject solved token into form payload.  
6. **Verify**: Confirm bypass by accessing protected resources.

## Defensive Measures

- **Server-side Validation**: Validate tokens on server using secret key.  
- **Bind Tokens**: Associate CAPTCHA tokens with session or user, IP address, and User-Agent.  
- **Short Lifetimes**: Tokens expire in <2 minutes; enforce single use.  
- **Behavioral Analytics**: Supplement CAPTCHA with anomaly detection.  
- **Fingerprint Consistency**: Verify consistency in browser fingerprint between token issuance and submission.

## References

- USENIX Security '23, “Adversarial User Event Generation for reCAPTCHA v3 Bypass” citeturn3search5
- HackerOne blog, “Breaking Invisible CAPTCHAs 2024” 
- PortSwigger Labs, “Evolving CAPTCHA DoS and Bypass Techniques” (2025)
- 0xingress, CAPTCHA Breaking Toolkit (2024) on GitHub
{{#include /banners/hacktricks-training.md}}
