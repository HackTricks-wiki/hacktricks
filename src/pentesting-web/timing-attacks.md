# Χρονικές Επιθέσεις

{{#include ../banners/hacktricks-training.md}}

> [!WARNING]
> Για να αποκτήσετε μια βαθιά κατανόηση αυτής της τεχνικής, ελέγξτε την αρχική αναφορά από [https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work](https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work)

## Βασικές Πληροφορίες

Ο βασικός στόχος μιας χρονικής επίθεσης είναι ουσιαστικά να είναι σε θέση να απαντήσει σε περίπλοκες ερωτήσεις ή να ανιχνεύσει κρυφές λειτουργίες απλά **ελέγχοντας τις χρονικές διαφορές στις απαντήσεις από παρόμοια αιτήματα**.

Παραδοσιακά, αυτό ήταν πολύ περίπλοκο λόγω της καθυστέρησης και της τζιτερ που εισάγονται τόσο από το δίκτυο όσο και από τον διακομιστή. Ωστόσο, από την ανακάλυψη και τη βελτίωση της [**Επίθεσης Race Condition Single Packet**](race-condition.md#http-2-single-packet-attack-vs.-http-1.1-last-byte-synchronization), είναι δυνατό να χρησιμοποιηθεί αυτή η τεχνική για να αφαιρεθούν όλες οι καθυστερήσεις του δικτύου από την εξίσωση.\
Αφήνοντας μόνο τις **καθυστερήσεις του διακομιστή** καθιστά την χρονική επίθεση πιο εύκολη στην ανακάλυψη και την εκμετάλλευση.

## Ανακαλύψεις

### Κρυφή Επιφάνεια Επίθεσης

Στην ανάρτηση του blog σχολιάζεται πώς χρησιμοποιώντας αυτή την τεχνική ήταν δυνατό να βρεθούν κρυφές παράμετροι και ακόμη και κεφαλίδες απλά ελέγχοντας ότι όποτε η παράμετρος ή η κεφαλίδα ήταν παρούσα στο αίτημα υπήρχε μια **χρονική διαφορά περίπου 5ms**. Στην πραγματικότητα, αυτή η τεχνική ανακάλυψης έχει προστεθεί στο **Param Miner** στο Burp Suite.

Αυτές οι χρονικές διαφορές μπορεί να οφείλονται σε μια **αίτηση DNS**, σε κάποιο **καταγραφή** που έγινε λόγω μη έγκυρης εισόδου ή επειδή γίνονται κάποιοι **έλεγχοι** όταν μια παράμετρος είναι παρούσα στο αίτημα.

Κάτι που πρέπει να θυμάστε όταν εκτελείτε αυτού του είδους τις επιθέσεις είναι ότι λόγω της κρυφής φύσης της επιφάνειας, μπορεί να μην γνωρίζετε ποια είναι η πραγματική αιτία των χρονικών διαφορών.

### Λάθη Ρύθμισης Αντίστροφου Διακομιστή

Στην ίδια έρευνα, μοιράστηκε ότι η τεχνική χρονισμού ήταν εξαιρετική για την ανακάλυψη "scoped SSRFs" (οι οποίες είναι SSRFs που μπορούν να έχουν πρόσβαση μόνο σε επιτρεπόμενες IP/domains). Απλά **ελέγχοντας τη χρονική διαφορά όταν έχει οριστεί μια επιτρεπόμενη τοποθεσία** σε σύγκριση με όταν έχει οριστεί μια μη επιτρεπόμενη τοποθεσία βοηθά στην ανακάλυψη ανοιχτών διακομιστών ακόμη και αν η απάντηση είναι η ίδια.

Μόλις ανακαλυφθεί ένας scoped open proxy, ήταν δυνατό να βρεθούν έγκυροι στόχοι αναλύοντας γνωστές υποτοποθεσίες του στόχου και αυτό επέτρεψε:

- **Παράκαμψη τειχών προστασίας** αποκτώντας πρόσβαση σε περιορισμένες υποτοποθεσίες μέσω του **ανοιχτού διακομιστή** αντί μέσω του διαδικτύου
- Επιπλέον, η εκμετάλλευση ενός **ανοιχτού διακομιστή** καθιστά επίσης δυνατό να **ανακαλυφθούν νέες υποτοποθεσίες που είναι προσβάσιμες μόνο εσωτερικά.**
- **Επιθέσεις μίμησης Front-End**: Οι διακομιστές front-end συνήθως προσθέτουν κεφαλίδες για το backend όπως `X-Forwarded-For` ή `X-Real-IP`. Οι ανοιχτοί διακομιστές που λαμβάνουν αυτές τις κεφαλίδες θα τις προσθέσουν στο ζητούμενο endpoint, επομένως, ένας επιτιθέμενος θα μπορούσε να έχει πρόσβαση σε ακόμη περισσότερες εσωτερικές τοποθεσίες προσθέτοντας αυτές τις κεφαλίδες με τιμές που έχουν εγκριθεί.

## Αναφορές

- [https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work](https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work)

{{#include ../banners/hacktricks-training.md}}
