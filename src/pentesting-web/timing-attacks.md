# Timing Attacks

{{#include ../banners/hacktricks-training.md}}

> [!WARNING]
> इस तकनीक की गहरी समझ प्राप्त करने के लिए [https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work](https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work) से मूल रिपोर्ट देखें

## Basic Information

Timing attack का मूल लक्ष्य जटिल प्रश्नों का उत्तर देने या छिपी हुई कार्यक्षमताओं का पता लगाने के लिए केवल **समान अनुरोधों से प्रतिक्रियाओं में समय के अंतर की जांच करना** है।

पारंपरिक रूप से, यह बहुत जटिल रहा है क्योंकि नेटवर्क और सर्वर द्वारा उत्पन्न लेटेंसी और जिटर। हालाँकि, [**Race Condition Single Packet attack**](race-condition.md#http-2-single-packet-attack-vs.-http-1.1-last-byte-synchronization) की खोज और सुधार के बाद, इस तकनीक का उपयोग सभी नेटवर्क देरी को समीकरण से हटाने के लिए किया जा सकता है।\
केवल **सर्वर की देरी** छोड़ने से timing attack को खोजने और दुरुपयोग करने में आसानी होती है।

## Discoveries

### Hidden Attack Surface

ब्लॉग पोस्ट में इस तकनीक का उपयोग करके छिपे हुए पैरामीटर और यहां तक कि हेडर खोजने के बारे में चर्चा की गई है, बस यह जांचते हुए कि जब भी पैरामीटर या हेडर अनुरोध में मौजूद होता है, तो **लगभग 5ms का समय का अंतर** होता है। वास्तव में, इस खोज तकनीक को Burp Suite में **Param Miner** में जोड़ा गया है।

ये समय के अंतर इस कारण हो सकते हैं कि एक **DNS अनुरोध** किया गया था, कुछ **लॉग लिखा गया** था क्योंकि एक अमान्य इनपुट था या क्योंकि कुछ **जांच की जाती हैं** जब अनुरोध में एक पैरामीटर मौजूद होता है।

जब इस प्रकार के हमले किए जा रहे हों, तो आपको याद रखने की आवश्यकता है कि सतह की छिपी हुई प्रकृति के कारण, आप समय के अंतर के वास्तविक कारण को नहीं जान सकते।

### Reverse Proxy Misconfigurations

उसी शोध में, यह साझा किया गया था कि timing तकनीक "scoped SSRFs" का पता लगाने के लिए महान थी (जो SSRFs हैं जो केवल अनुमत IP/डोमेन तक पहुंच सकते हैं)। केवल **अनुमत डोमेन सेट करने पर समय के अंतर की जांच करना** बनाम जब एक गैर-अनुमत डोमेन सेट किया जाता है, खुली प्रॉक्सी का पता लगाने में मदद करता है, भले ही प्रतिक्रिया समान हो।

एक scoped open proxy का पता लगाने के बाद, यह ज्ञात उपडोमेन को पार्स करके वैध लक्ष्यों को खोजने में संभव था और इससे:

- **फायरवॉल को बायपास करें** द्वारा प्रतिबंधित उपडोमेन तक **खुली प्रॉक्सी** के माध्यम से पहुंचकर इंटरनेट के माध्यम से नहीं
- इसके अलावा, एक **खुली प्रॉक्सी** का दुरुपयोग करके **नए उपडोमेन का पता लगाना भी संभव है जो केवल आंतरिक रूप से सुलभ हैं।**
- **फ्रंट-एंड अनुकरण हमले**: फ्रंट-एंड सर्वर सामान्यतः बैकएंड के लिए हेडर जोड़ते हैं जैसे `X-Forwarded-For` या `X-Real-IP`। खुली प्रॉक्सी जो इन हेडरों को प्राप्त करती हैं, उन्हें अनुरोधित एंडपॉइंट में जोड़ देंगी, इसलिए, एक हमलावर इन हेडरों को व्हाइटलिस्टेड मानों के साथ जोड़कर और अधिक आंतरिक डोमेन तक पहुंच प्राप्त कर सकता है।

## References

- [https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work](https://portswigger.net/research/listen-to-the-whispers-web-timing-attacks-that-actually-work)

{{#include ../banners/hacktricks-training.md}}
