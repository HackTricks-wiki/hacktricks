# JSON, XML & Yaml Hacking & Issues

{{#include ../banners/hacktricks-training.md}}

## Go JSON Decoder

–ù–∞—Å—Ç—É–ø–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏ –±—É–ª–∏ –≤–∏—è–≤–ª–µ–Ω—ñ –≤ Go JSON, —Ö–æ—á–∞ –≤–æ–Ω–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –ø—Ä–∏—Å—É—Ç–Ω—ñ–º–∏ —ñ –≤ —ñ–Ω—à–∏—Ö –º–æ–≤–∞—Ö. –¶—ñ –ø—Ä–æ–±–ª–µ–º–∏ –±—É–ª–∏ –æ–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω—ñ –≤ [**—Ü—å–æ–º—É –±–ª–æ–∑—ñ**](https://blog.trailofbits.com/2025/06/17/unexpected-security-footguns-in-gos-parsers/).

JSON, XML —Ç–∞ YAML –ø–∞—Ä—Å–µ—Ä–∏ Go –º–∞—é—Ç—å –¥–æ–≤–≥–∏–π —Å–ø–∏—Å–æ–∫ –Ω–µ—Å—É–º—ñ—Å–Ω–æ—Å—Ç–µ–π —Ç–∞ –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏—Ö –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è **–æ–±—Ö–æ–¥—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó**, **–µ—Å–∫–∞–ª–∞—Ü—ñ—ó –ø—Ä–∏–≤—ñ–ª–µ—ó–≤** –∞–±–æ **–µ–∫—Å—Ç—Ä–∞–∫—Ü—ñ—ó —á—É—Ç–ª–∏–≤–∏—Ö –¥–∞–Ω–∏—Ö**.

### (Un)Marshaling Unexpected Data

–ú–µ—Ç–∞ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ–± –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏, —è–∫—ñ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É —á–∏—Ç–∞—Ç–∏/–∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ —á—É—Ç–ª–∏–≤—ñ –ø–æ–ª—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `IsAdmin`, `Password`).

- –ü—Ä–∏–∫–ª–∞–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏:
```go
type User struct {
Username string `json:"username,omitempty"`
Password string `json:"password,omitempty"`
IsAdmin  bool   `json:"-"`
}
```
- –ó–∞–≥–∞–ª—å–Ω—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ

1. **–í—ñ–¥—Å—É—Ç–Ω—ñ–π —Ç–µ–≥** (–Ω–µ–º–∞—î —Ç–µ–≥—É = –ø–æ–ª–µ –≤—Å–µ —â–µ –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º):
```go
type User struct {
Username string
}
```
–ü–µ–π–ª–æ–∞–¥:
```json
{"Username": "admin"}
```
2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `-`**:
```go
type User struct {
IsAdmin bool `json:"-,omitempty"` // ‚ùå wrong
}
```
–ü–µ–π–ª–æ–∞–¥:
```json
{"-": true}
```
‚úîÔ∏è –ü—Ä–∞–≤–∏–ª—å–Ω–∏–π —Å–ø–æ—Å—ñ–± –∑–∞–±–ª–æ–∫—É–≤–∞—Ç–∏ –ø–æ–ª–µ –≤—ñ–¥ (–¥–µ)–º–∞—Ä—à–∞–ª—ñ–Ω–≥—É:
```go
type User struct {
IsAdmin bool `json:"-"`
}
```
### Parser Differentials

–ú–µ—Ç–∞ –ø–æ–ª—è–≥–∞—î –≤ –æ–±—Ö–æ–¥—ñ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó —à–ª—è—Ö–æ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç–æ–≥–æ, —è–∫ —Ä—ñ–∑–Ω—ñ –ø–∞—Ä—Å–µ—Ä–∏ –ø–æ-—Ä—ñ–∑–Ω–æ–º—É —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—é—Ç—å –æ–¥–∏–Ω —ñ —Ç–æ–π –∂–µ payload, —è–∫ —É:
- CVE-2017-12635: –æ–±—Ö–æ–¥–∂–µ–Ω–Ω—è Apache CouchDB —á–µ—Ä–µ–∑ –¥—É–±–ª—ñ–∫–∞—Ç–∏ –∫–ª—é—á—ñ–≤
- 2022: Zoom 0-click RCE —á–µ—Ä–µ–∑ –Ω–µ–ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å XML –ø–∞—Ä—Å–µ—Ä–∞
- GitLab 2025 –æ–±—Ö–æ–¥–∂–µ–Ω–Ω—è SAML —á–µ—Ä–µ–∑ –æ—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ XML

**1. –î—É–±–ª—ñ–∫–∞—Ç–∏ –ø–æ–ª—ñ–≤:**
Go's `encoding/json` –±–µ—Ä–µ **–æ—Å—Ç–∞–Ω–Ω—î** –ø–æ–ª–µ.
```go
json.Unmarshal([]byte(`{"action":"UserAction", "action":"AdminAction"}`), &req)
fmt.Println(req.Action) // AdminAction
```
–Ü–Ω—à—ñ –ø–∞—Ä—Å–µ—Ä–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Jackson –≤—ñ–¥ Java) –º–æ–∂—É—Ç—å –≤–∑—è—Ç–∏ **–ø–µ—Ä—à–∏–π**.

**2. –ù–µ—á—É—Ç–ª–∏–≤—ñ—Å—Ç—å –¥–æ —Ä–µ–≥—ñ—Å—Ç—Ä—É:**
Go –Ω–µ—á—É—Ç–ª–∏–≤–∏–π –¥–æ —Ä–µ–≥—ñ—Å—Ç—Ä—É:
```go
json.Unmarshal([]byte(`{"AcTiOn":"AdminAction"}`), &req)
// matches `Action` field
```
–ù–∞–≤—ñ—Ç—å —Ç—Ä—é–∫–∏ –∑ Unicode –ø—Ä–∞—Ü—é—é—Ç—å:
```go
json.Unmarshal([]byte(`{"a‚Ñ™tion≈ø": "bypass"}`), &req)
```
**3. –ù–µ–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å –º—ñ–∂ —Å–µ—Ä–≤—ñ—Å–∞–º–∏:**
–£—è–≤—ñ—Ç—å:
- –ü—Ä–æ–∫—Å—ñ, –Ω–∞–ø–∏—Å–∞–Ω–∏–π –Ω–∞ Go
- –°–ª—É–∂–±–∞ AuthZ, –Ω–∞–ø–∏—Å–∞–Ω–∞ –Ω–∞ Python

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –Ω–∞–¥—Å–∏–ª–∞—î:
```json
{
"action": "UserAction",
"AcTiOn": "AdminAction"
}
```
- Python –±–∞—á–∏—Ç—å `UserAction`, –¥–æ–∑–≤–æ–ª—è—î –π–æ–≥–æ
- Go –±–∞—á–∏—Ç—å `AdminAction`, –≤–∏–∫–æ–Ω—É—î –π–æ–≥–æ


### –ü–ª—É—Ç–∞–Ω–∏–Ω–∞ —Ñ–æ—Ä–º–∞—Ç—É –¥–∞–Ω–∏—Ö (–ü–æ–ª—ñ–≥–ª–æ—Ç–∏)

–ú–µ—Ç–∞ –ø–æ–ª—è–≥–∞—î –≤ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó —Å–∏—Å—Ç–µ–º, —è–∫—ñ –∑–º—ñ—à—É—é—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏ (JSON/XML/YAML) –∞–±–æ –Ω–µ –∑–∞–∫—Ä–∏–≤–∞—é—Ç—å—Å—è –ø—Ä–∏ –ø–æ–º–∏–ª–∫–∞—Ö –ø–∞—Ä—Å–µ—Ä–∞, —Ç–∞–∫—ñ —è–∫:
- **CVE-2020-16250**: HashiCorp Vault —Ä–æ–∑–ø–∞—Ä—Å–∏–≤ JSON –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é XML –ø–∞—Ä—Å–µ—Ä–∞ –ø—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ STS –ø–æ–≤–µ—Ä–Ω—É–≤ JSON –∑–∞–º—ñ—Å—Ç—å XML.

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –∫–æ–Ω—Ç—Ä–æ–ª—é—î:
- –ó–∞–≥–æ–ª–æ–≤–æ–∫ `Accept: application/json`
- –ß–∞—Å—Ç–∫–æ–≤–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Ç—ñ–ª–æ–º JSON

XML –ø–∞—Ä—Å–µ—Ä Go —Ä–æ–∑–ø–∞—Ä—Å–∏–≤ –π–æ–≥–æ **–≤—Å–µ –æ–¥–Ω–æ** —ñ –¥–æ–≤—ñ—Ä—è–≤ —ñ–Ω'—î–∫–æ–≤–∞–Ω—ñ–π —ñ–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—ñ.

- –°—Ñ–æ—Ä–º–æ–≤–∞–Ω–∏–π payload:
```json
{
"action": "Action_1",
"AcTiOn": "Action_2",
"ignored": "<?xml version=\"1.0\"?><Action>Action_3</Action>"
}
```
–†–µ–∑—É–ª—å—Ç–∞—Ç:
- **Go JSON** –ø–∞—Ä—Å–µ—Ä: `Action_2` (–Ω–µ—á—É—Ç–ª–∏–≤–∏–π –¥–æ —Ä–µ–≥—ñ—Å—Ç—Ä—É + –æ—Å—Ç–∞–Ω–Ω—ñ–π –≤–∏–≥—Ä–∞—î)
- **YAML** –ø–∞—Ä—Å–µ—Ä: `Action_1` (—á—É—Ç–ª–∏–≤–∏–π –¥–æ —Ä–µ–≥—ñ—Å—Ç—Ä—É)
- **XML** –ø–∞—Ä—Å–µ—Ä: –ø–∞—Ä—Å–∏—Ç—å `"Action_3"` –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ä—è–¥–∫–∞


### üîê –ó–∞—Ö–æ–¥–∏ –ø–æ–º'—è–∫—à–µ–Ω–Ω—è

| –†–∏–∑–∏–∫                       | –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è                           |
|-----------------------------|---------------------------------------|
| –ù–µ–≤—ñ–¥–æ–º—ñ –ø–æ–ª—è               | `decoder.DisallowUnknownFields()`     |
| –î—É–±–ª—ñ–∫–∞—Ç–∏ –ø–æ–ª—ñ–≤ (JSON)     | ‚ùå –ù–µ–º–∞—î –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –≤ stdlib         |
| –ù–µ—á—É—Ç–ª–∏–≤–µ —Å–ø—ñ–≤–ø–∞–¥—ñ–Ω–Ω—è      | ‚ùå –ù–µ–º–∞—î –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –≤ stdlib         |
| XML —Å–º—ñ—Ç—Ç—î–≤—ñ –¥–∞–Ω—ñ          | ‚ùå –ù–µ–º–∞—î –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –≤ stdlib         |
| YAML: –Ω–µ–≤—ñ–¥–æ–º—ñ –∫–ª—é—á—ñ       | `yaml.KnownFields(true)`              |


{{#include ../banners/hacktricks-training.md}}
