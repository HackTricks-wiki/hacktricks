# Contamination de la connexion HTTP

{{#include ../banners/hacktricks-training.md}}

**Ceci est un résumé du post : [https://portswigger.net/research/http-3-connection-contamination](https://portswigger.net/research/http-3-connection-contamination)**. Consultez-le pour plus de détails !

Les navigateurs web peuvent réutiliser une seule connexion HTTP/2+ pour différents sites web grâce à [la coalescence de connexion HTTP](https://daniel.haxx.se/blog/2016/08/18/http2-connection-coalescing), à condition d'avoir des adresses IP partagées et un certificat TLS commun. Cependant, cela peut entrer en conflit avec le **routage de première requête** dans les reverse-proxies, où les requêtes suivantes sont dirigées vers le back-end déterminé par la première requête. Ce mauvais routage peut entraîner des vulnérabilités de sécurité, en particulier lorsqu'il est combiné avec des certificats TLS wildcard et des domaines comme `*.example.com`.

Par exemple, si `wordpress.example.com` et `secure.example.com` sont tous deux servis par le même reverse proxy et ont un certificat wildcard commun, la coalescence de connexion d'un navigateur pourrait amener les requêtes vers `secure.example.com` à être mal traitées par le back-end WordPress, exploitant des vulnérabilités telles que XSS.

Pour observer la coalescence de connexion, l'onglet Réseau de Chrome ou des outils comme Wireshark peuvent être utilisés. Voici un extrait pour tester :
```javascript
fetch("//sub1.hackxor.net/", { mode: "no-cors", credentials: "include" }).then(
() => {
fetch("//sub2.hackxor.net/", { mode: "no-cors", credentials: "include" })
}
)
```
La menace est actuellement limitée en raison de la rareté du routage de première demande et de la complexité de HTTP/2. Cependant, les changements proposés dans HTTP/3, qui assouplissent l'exigence de correspondance d'adresse IP, pourraient élargir la surface d'attaque, rendant les serveurs avec un certificat wildcard plus vulnérables sans nécessiter une attaque MITM.

Les meilleures pratiques incluent l'évitement du routage de première demande dans les proxies inverses et la prudence avec les certificats TLS wildcard, surtout avec l'avènement de HTTP/3. Des tests réguliers et une sensibilisation à ces vulnérabilités complexes et interconnectées sont cruciaux pour maintenir la sécurité web.

{{#include ../banners/hacktricks-training.md}}
