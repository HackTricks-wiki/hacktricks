# HTTP Connection Contamination

{{#include ../banners/hacktricks-training.md}}

**Αυτή είναι μια περίληψη της ανάρτησης: [https://portswigger.net/research/http-3-connection-contamination](https://portswigger.net/research/http-3-connection-contamination)**. Ελέγξτε το για περισσότερες λεπτομέρειες!

Οι φυλλομετρητές ιστού μπορούν να επαναχρησιμοποιούν μια μόνο σύνδεση HTTP/2+ για διαφορετικές ιστοσελίδες μέσω [HTTP connection coalescing](https://daniel.haxx.se/blog/2016/08/18/http2-connection-coalescing), δεδομένων κοινών διευθύνσεων IP και ενός κοινού πιστοποιητικού TLS. Ωστόσο, αυτό μπορεί να συγκρούεται με **first-request routing** σε αντίστροφους διακομιστές, όπου οι επόμενες αιτήσεις κατευθύνονται στο back-end που καθορίζεται από την πρώτη αίτηση. Αυτή η λανθασμένη δρομολόγηση μπορεί να οδηγήσει σε ευπάθειες ασφαλείας, ιδιαίτερα όταν συνδυάζεται με πιστοποιητικά TLS wildcard και τομείς όπως το `*.example.com`.

Για παράδειγμα, αν το `wordpress.example.com` και το `secure.example.com` εξυπηρετούνται και από τον ίδιο αντίστροφο διακομιστή και έχουν ένα κοινό πιστοποιητικό wildcard, η δρομολόγηση σύνδεσης ενός φυλλομετρητή θα μπορούσε να οδηγήσει τις αιτήσεις προς το `secure.example.com` να επεξεργάζονται λανθασμένα από το back-end του WordPress, εκμεταλλευόμενη ευπάθειες όπως το XSS.

Για να παρατηρήσετε τη δρομολόγηση σύνδεσης, μπορείτε να χρησιμοποιήσετε την καρτέλα Δικτύου του Chrome ή εργαλεία όπως το Wireshark. Ακολουθεί ένα απόσπασμα για δοκιμή:
```javascript
fetch("//sub1.hackxor.net/", { mode: "no-cors", credentials: "include" }).then(
() => {
fetch("//sub2.hackxor.net/", { mode: "no-cors", credentials: "include" })
}
)
```
Η απειλή είναι αυτή τη στιγμή περιορισμένη λόγω της σπανιότητας της δρομολόγησης πρώτης αίτησης και της πολυπλοκότητας του HTTP/2. Ωστόσο, οι προτεινόμενες αλλαγές στο HTTP/3, οι οποίες χαλαρώνουν την απαίτηση αντιστοίχισης διεύθυνσης IP, θα μπορούσαν να διευρύνουν την επιφάνεια επίθεσης, καθιστώντας τους διακομιστές με πιστοποιητικό wildcard πιο ευάλωτους χωρίς να απαιτείται επίθεση MITM.

Οι καλύτερες πρακτικές περιλαμβάνουν την αποφυγή δρομολόγησης πρώτης αίτησης σε αντίστροφους διακομιστές μεσολάβησης και την προσοχή με τα πιστοποιητικά TLS wildcard, ειδικά με την έλευση του HTTP/3. Η τακτική δοκιμή και η επίγνωση αυτών των πολύπλοκων, διασυνδεδεμένων ευπαθειών είναι κρίσιμη για τη διατήρηση της ασφάλειας του ιστού.

{{#include ../banners/hacktricks-training.md}}
