# HTTP Connection Contamination

{{#include ../banners/hacktricks-training.md}}

**이 포스트의 요약입니다: [https://portswigger.net/research/http-3-connection-contamination](https://portswigger.net/research/http-3-connection-contamination)**. 자세한 내용은 확인하세요!

웹 브라우저는 공유 IP 주소와 공통 TLS 인증서를 통해 서로 다른 웹사이트에 대해 단일 HTTP/2+ 연결을 재사용할 수 있습니다 [HTTP connection coalescing](https://daniel.haxx.se/blog/2016/08/18/http2-connection-coalescing). 그러나 이는 **첫 요청 라우팅**과 충돌할 수 있으며, 여기서 후속 요청은 첫 요청에 의해 결정된 백엔드로 전송됩니다. 이러한 잘못된 라우팅은 보안 취약점을 초래할 수 있으며, 특히 와일드카드 TLS 인증서와 `*.example.com`과 같은 도메인과 결합될 때 더욱 그렇습니다.

예를 들어, `wordpress.example.com`과 `secure.example.com`이 동일한 리버스 프록시에서 제공되고 공통 와일드카드 인증서를 가지고 있다면, 브라우저의 연결 집합이 `secure.example.com`에 대한 요청이 잘못 처리되어 WordPress 백엔드로 전송될 수 있으며, 이로 인해 XSS와 같은 취약점이 악용될 수 있습니다.

연결 집합을 관찰하기 위해 Chrome의 네트워크 탭이나 Wireshark와 같은 도구를 사용할 수 있습니다. 테스트를 위한 코드 조각은 다음과 같습니다:
```javascript
fetch("//sub1.hackxor.net/", { mode: "no-cors", credentials: "include" }).then(
() => {
fetch("//sub2.hackxor.net/", { mode: "no-cors", credentials: "include" })
}
)
```
위협은 현재 첫 번째 요청 라우팅의 희귀성과 HTTP/2의 복잡성으로 인해 제한적입니다. 그러나 IP 주소 일치 요구 사항을 완화하는 HTTP/3의 제안된 변경 사항은 공격 표면을 넓힐 수 있으며, MITM 공격 없이도 와일드카드 인증서가 있는 서버를 더 취약하게 만들 수 있습니다.

모범 사례에는 리버스 프록시에서 첫 번째 요청 라우팅을 피하고, 특히 HTTP/3의 출현과 함께 와일드카드 TLS 인증서에 주의하는 것이 포함됩니다. 이러한 복잡하고 상호 연결된 취약성에 대한 정기적인 테스트와 인식은 웹 보안을 유지하는 데 중요합니다.

{{#include ../banners/hacktricks-training.md}}
