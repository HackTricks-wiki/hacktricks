# Contournement de la Limite de Taux

{{#include ../banners/hacktricks-training.md}}

## Techniques de contournement de la limite de taux

### Exploration des Points de Terminaison Similaires

Des tentatives devraient être faites pour effectuer des attaques par force brute sur des variations du point de terminaison ciblé, comme `/api/v3/sign-up`, y compris des alternatives comme `/Sing-up`, `/SignUp`, `/singup`, `/api/v1/sign-up`, `/api/sign-up`, etc.

### Incorporation de Caractères Vides dans le Code ou les Paramètres

L'insertion de bytes vides comme `%00`, `%0d%0a`, `%0d`, `%0a`, `%09`, `%0C`, `%20` dans le code ou les paramètres peut être une stratégie utile. Par exemple, ajuster un paramètre à `code=1234%0a` permet d'étendre les tentatives à travers des variations d'entrée, comme l'ajout de caractères de nouvelle ligne à une adresse e-mail pour contourner les limitations de tentatives.

### Manipulation de l'Origine IP via les En-têtes

Modifier les en-têtes pour altérer l'origine IP perçue peut aider à échapper à la limitation de taux basée sur l'IP. Des en-têtes tels que `X-Originating-IP`, `X-Forwarded-For`, `X-Remote-IP`, `X-Remote-Addr`, `X-Client-IP`, `X-Host`, `X-Forwared-Host`, y compris l'utilisation de plusieurs instances de `X-Forwarded-For`, peuvent être ajustés pour simuler des requêtes provenant de différentes IP.
```bash
X-Originating-IP: 127.0.0.1
X-Forwarded-For: 127.0.0.1
X-Remote-IP: 127.0.0.1
X-Remote-Addr: 127.0.0.1
X-Client-IP: 127.0.0.1
X-Host: 127.0.0.1
X-Forwared-Host: 127.0.0.1

# Double X-Forwarded-For header example
X-Forwarded-For:
X-Forwarded-For: 127.0.0.1
```
### Changer d'autres en-têtes

Il est recommandé de modifier d'autres en-têtes de requête tels que l'agent utilisateur et les cookies, car ceux-ci peuvent également être utilisés pour identifier et suivre les modèles de requêtes. Changer ces en-têtes peut empêcher la reconnaissance et le suivi des activités du demandeur.

### Tirer parti du comportement de la passerelle API

Certaines passerelles API sont configurées pour appliquer des limites de taux en fonction de la combinaison de l'endpoint et des paramètres. En variant les valeurs des paramètres ou en ajoutant des paramètres non significatifs à la requête, il est possible de contourner la logique de limitation de taux de la passerelle, rendant chaque requête unique. Par exemple `/resetpwd?someparam=1`.

### Se connecter à votre compte avant chaque tentative

Se connecter à un compte avant chaque tentative, ou chaque ensemble de tentatives, peut réinitialiser le compteur de limite de taux. Cela est particulièrement utile lors des tests de fonctionnalités de connexion. Utiliser une attaque Pitchfork dans des outils comme Burp Suite, pour faire tourner les identifiants toutes les quelques tentatives et s'assurer que les redirections sont marquées, peut efficacement redémarrer les compteurs de limite de taux.

### Utiliser des réseaux de proxy

Déployer un réseau de proxies pour distribuer les requêtes sur plusieurs adresses IP peut efficacement contourner les limites de taux basées sur l'IP. En acheminant le trafic à travers divers proxies, chaque requête semble provenir d'une source différente, diluant ainsi l'efficacité de la limite de taux.

### Répartir l'attaque sur différents comptes ou sessions

Si le système cible applique des limites de taux sur une base par compte ou par session, répartir l'attaque ou le test sur plusieurs comptes ou sessions peut aider à éviter la détection. Cette approche nécessite de gérer plusieurs identités ou jetons de session, mais peut efficacement répartir la charge pour rester dans les limites autorisées.

### Continuez à essayer

Notez que même si une limite de taux est en place, vous devriez essayer de voir si la réponse est différente lorsque le OTP valide est envoyé. Dans [**ce post**](https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732), le chasseur de bugs a découvert que même si une limite de taux est déclenchée après 20 tentatives infructueuses en répondant avec 401, si le valide était envoyé, une réponse 200 était reçue.

{{#include ../banners/hacktricks-training.md}}
