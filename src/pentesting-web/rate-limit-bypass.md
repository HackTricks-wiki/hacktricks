# Rate Limit Bypass

{{#include ../banners/hacktricks-training.md}}

## Rate limit bypass techniques

### Exploring Similar Endpoints

‡§≤‡§ï‡•ç‡§∑‡§ø‡§§ endpoint ‡§ï‡•á ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® ‡§µ‡•á‡§∞‡§ø‡§è‡§Ç‡§ü‡•ç‡§∏ ‡§™‡§∞ brute force attacks ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è, ‡§ú‡•à‡§∏‡•á `/api/v3/sign-up`, ‡§î‡§∞ ‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï ‡§∞‡•Ç‡§™‡•ã‡§Ç ‡§ú‡•à‡§∏‡•á `/Sing-up`, `/SignUp`, `/singup`, `/api/v1/sign-up`, `/api/sign-up` ‡§Ü‡§¶‡§ø‡•§

### Incorporating Blank Characters in Code or Parameters

‡§ï‡•ã‡§° ‡§Ø‡§æ ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§Æ‡•á‡§Ç `%00`, `%0d%0a`, `%0d`, `%0a`, `%09`, `%0C`, `%20` ‡§ú‡•à‡§∏‡•á blank bytes ‡§∏‡§Æ‡•ç‡§Æ‡§ø‡§≤‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ ‡§è‡§ï ‡§â‡§™‡§Ø‡•ã‡§ó‡•Ä ‡§∞‡§£‡§®‡•Ä‡§§‡§ø ‡§π‡•ã ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡•§ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§™‡•à‡§∞‡§æ‡§Æ‡•Ä‡§ü‡§∞ ‡§ï‡•ã `code=1234%0a` ‡§Æ‡•á‡§Ç ‡§¨‡§¶‡§≤‡§®‡•á ‡§∏‡•á ‡§á‡§®‡§™‡•Å‡§ü ‡§µ‡•á‡§∞‡§ø‡§è‡§∂‡§®‡•ã‡§Ç ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§î‡§∞ ‡§Ö‡§ß‡§ø‡§ï ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§ø‡§è ‡§ú‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç ‚Äî ‡§ú‡•à‡§∏‡•á ‡§à‡§Æ‡•á‡§≤ ‡§™‡§§‡•á ‡§Æ‡•á‡§Ç newline characters ‡§ú‡•ã‡§°‡§º‡§ï‡§∞ ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§∏‡•Ä‡§Æ‡§æ‡§ì‡§Ç ‡§ï‡•ã ‡§¨‡§æ‡§à‡§™‡§æ‡§∏ ‡§ï‡§∞‡§®‡§æ‡•§

### Manipulating IP Origin via Headers

Headers ‡§ï‡•ã ‡§¨‡§¶‡§≤‡§ï‡§∞ perceived IP origin ‡§ï‡•ã ‡§¨‡§¶‡§≤‡§®‡§æ IP-based rate limiting ‡§∏‡•á ‡§¨‡§ö‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ `X-Originating-IP`, `X-Forwarded-For`, `X-Remote-IP`, `X-Remote-Addr`, `X-Client-IP`, `X-Host`, `X-Forwared-Host` ‡§ú‡•à‡§∏‡•á headers, ‡§î‡§∞ `X-Forwarded-For` ‡§ï‡•á ‡§ï‡§à instances ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á, ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó IPs ‡§∏‡•á ‡§Ü‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß‡•ã‡§Ç ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§ï‡§∞‡§£ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§
```bash
X-Originating-IP: 127.0.0.1
X-Forwarded-For: 127.0.0.1
X-Remote-IP: 127.0.0.1
X-Remote-Addr: 127.0.0.1
X-Client-IP: 127.0.0.1
X-Host: 127.0.0.1
X-Forwared-Host: 127.0.0.1

# Double X-Forwarded-For header example
X-Forwarded-For:
X-Forwarded-For: 127.0.0.1
```
### Changing Other Headers

user-agent ‡§î‡§∞ cookies ‡§ú‡•à‡§∏‡•á ‡§Ö‡§®‡•ç‡§Ø request headers ‡§ï‡•ã ‡§¨‡§¶‡§≤‡§®‡§æ ‡§∏‡•Å‡§ù‡§æ‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à, ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§á‡§®‡•ç‡§π‡•á‡§Ç ‡§≠‡•Ä ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§™‡•à‡§ü‡§∞‡•ç‡§® ‡§ï‡•Ä ‡§™‡§π‡§ö‡§æ‡§® ‡§î‡§∞ ‡§ü‡•ç‡§∞‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§á‡§® ‡§π‡•á‡§°‡§∞‡•ã‡§Ç ‡§ï‡•ã ‡§¨‡§¶‡§≤‡§®‡•á ‡§∏‡•á ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•Ä ‡§ó‡§§‡§ø‡§µ‡§ø‡§ß‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•Ä ‡§™‡§π‡§ö‡§æ‡§® ‡§î‡§∞ ‡§ü‡•ç‡§∞‡•à‡§ï‡§ø‡§Ç‡§ó ‡§∞‡•ã‡§ï‡•Ä ‡§ú‡§æ ‡§∏‡§ï‡§§‡•Ä ‡§π‡•à‡•§

### Leveraging API Gateway Behavior

‡§ï‡•Å‡§õ API gateways ‡§á‡§∏ ‡§§‡§∞‡§π ‡§ï‡•â‡§®‡•ç‡§´‡§º‡§ø‡§ó‡§∞ ‡§ï‡§ø‡§è ‡§ú‡§æ‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø ‡§µ‡•á endpoint ‡§î‡§∞ parameters ‡§ï‡•á ‡§∏‡§Ç‡§Ø‡•ã‡§ú‡§® ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ rate limiting ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§ parameter values ‡§ï‡•ã ‡§¨‡§¶‡§≤‡§ï‡§∞ ‡§Ø‡§æ request ‡§Æ‡•á‡§Ç ‡§ó‡•à‡§∞-‡§™‡•ç‡§∞‡§≠‡§æ‡§µ‡•Ä parameters ‡§ú‡•ã‡§°‡§º‡§ï‡§∞ gateway ‡§ï‡•Ä rate-limiting ‡§≤‡•â‡§ú‡§ø‡§ï ‡§ï‡•ã ‡§¶‡§∞‡§ï‡§ø‡§®‡§æ‡§∞ ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à, ‡§ú‡§ø‡§∏‡§∏‡•á ‡§π‡§∞ request ‡§Ö‡§®‡•Ç‡§†‡§æ ‡§¶‡§ø‡§ñ‡§æ‡§à ‡§¶‡•á‡•§ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è `/resetpwd?someparam=1`‡•§

### Logging into Your Account Before Each Attempt

‡§π‡§∞ ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§∏‡•á ‡§™‡§π‡§≤‡•á, ‡§Ø‡§æ ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§∏‡•á‡§ü ‡§∏‡•á ‡§™‡§π‡§≤‡•á, account ‡§Æ‡•á‡§Ç ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡§®‡•á ‡§∏‡•á rate limit counter ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§π‡•ã ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§∞‡•Ç‡§™ ‡§∏‡•á login ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡•ç‡§∑‡§Æ‡§§‡§æ‡§ì‡§Ç ‡§ï‡§æ ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§£ ‡§ï‡§∞‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§â‡§™‡§Ø‡•ã‡§ó‡•Ä ‡§π‡•à‡•§ Burp Suite ‡§ú‡•à‡§∏‡•á ‡§ü‡•Ç‡§≤‡•ç‡§∏ ‡§Æ‡•á‡§Ç Pitchfork attack ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á ‡§π‡§∞ ‡§ï‡•Å‡§õ ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏‡•ã‡§Ç ‡§™‡§∞ credentials ‡§ï‡•ã rotate ‡§ï‡§∞‡§®‡§æ ‡§î‡§∞ ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡§®‡§æ ‡§ï‡§ø follow redirects ‡§Æ‡§æ‡§∞‡•ç‡§ï ‡§ï‡§ø‡§è ‡§ó‡§è ‡§π‡•ã‡§Ç, rate limit counters ‡§ï‡•ã ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ‡•Ä ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§∞‡•Ä‡§∏‡•ç‡§ü‡§æ‡§∞‡•ç‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

### Utilizing Proxy Networks

requests ‡§ï‡•ã ‡§ï‡§à IP addresses ‡§™‡§∞ ‡§µ‡§ø‡§§‡§∞‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è proxies ‡§ï‡•á ‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï ‡§ï‡•ã ‡§§‡•à‡§®‡§æ‡§§ ‡§ï‡§∞‡§®‡•á ‡§∏‡•á IP-based rate limits ‡§ï‡•ã ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ‡•Ä ‡§¢‡§Ç‡§ó ‡§∏‡•á ‡§¨‡§æ‡§Ø‡§™‡§æ‡§∏ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§ü‡•ç‡§∞‡•à‡§´‡§º‡§ø‡§ï ‡§ï‡•ã ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® proxies ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§∞‡•Ç‡§ü ‡§ï‡§∞‡§ï‡•á, ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï request ‡§è‡§ï ‡§Ö‡§≤‡§ó ‡§∏‡•ç‡§∞‡•ã‡§§ ‡§∏‡•á ‡§Ü‡§à ‡§π‡•Å‡§à ‡§™‡•ç‡§∞‡§§‡•Ä‡§§ ‡§π‡•ã‡§§‡•Ä ‡§π‡•à, ‡§ú‡§ø‡§∏‡§∏‡•á rate limit ‡§ï‡•Ä ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ‡§∂‡•Ä‡§≤‡§§‡§æ ‡§ï‡§Æ ‡§π‡•ã ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à‡•§

### Splitting the Attack Across Different Accounts or Sessions

‡§Ø‡§¶‡§ø target system per-account ‡§Ø‡§æ per-session ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ rate limits ‡§≤‡§æ‡§ó‡•Ç ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§π‡§Æ‡§≤‡•á ‡§Ø‡§æ ‡§ü‡•á‡§∏‡•ç‡§ü ‡§ï‡•ã ‡§ï‡§à accounts ‡§Ø‡§æ sessions ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§§‡§∞‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§∏‡•á ‡§™‡§§‡§æ ‡§≤‡§ó‡§æ‡§®‡•á ‡§∏‡•á ‡§¨‡§ö‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§á‡§∏ ‡§µ‡§ø‡§ß‡§ø ‡§Æ‡•á‡§Ç ‡§ï‡§à identities ‡§Ø‡§æ session tokens ‡§ï‡§æ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§® ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•ã‡§§‡§æ ‡§π‡•à, ‡§≤‡•á‡§ï‡§ø‡§® ‡§Ø‡§π ‡§≤‡•ã‡§° ‡§ï‡•ã ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ‡•Ä ‡§§‡§∞‡•Ä‡§ï‡•á ‡§∏‡•á ‡§µ‡§ø‡§§‡§∞‡§ø‡§§ ‡§ï‡§∞‡§ï‡•á ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§Ø‡•ã‡§ó‡•ç‡§Ø ‡§∏‡•Ä‡§Æ‡§æ‡§ì‡§Ç ‡§ï‡•á ‡§≠‡•Ä‡§§‡§∞ ‡§¨‡§®‡•á ‡§∞‡§π‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

### Keep Trying

‡§ß‡•ç‡§Ø‡§æ‡§® ‡§¶‡•á‡§Ç ‡§ï‡§ø ‡§≠‡§≤‡•á ‡§π‡•Ä rate limit ‡§≤‡§æ‡§ó‡•Ç ‡§π‡•ã, ‡§Ü‡§™‡§ï‡•ã ‡§Ø‡§π ‡§¶‡•á‡§ñ‡§®‡•á ‡§ï‡•Ä ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è ‡§ï‡§ø ‡§ú‡§¨ ‡§µ‡•à‡§ß OTP ‡§≠‡•á‡§ú‡§æ ‡§ú‡§æ‡§è ‡§§‡•ã response ‡§Ö‡§≤‡§ó ‡§π‡•ã‡§§‡§æ ‡§π‡•à ‡§Ø‡§æ ‡§®‡§π‡•Ä‡§Ç‡•§ In [**this post**](https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732), the bug hunter discovered that even if a rate limit is triggered after 20 unsuccessful attempts by responding with 401, if the valid one was sent a 200 response was received.

---

### Abusing HTTP/2 multiplexing & request pipelining (2023-2025)

‡§Ü‡§ß‡•Å‡§®‡§ø‡§ï rate‚Äìlimiter implementations ‡§Ö‡§ï‡•ç‡§∏‡§∞ **TCP connections** (or even individual HTTP/1.1 requests) ‡§ï‡•ã ‡§ó‡§ø‡§®‡§§‡•á ‡§π‡•à‡§Ç ‡§¨‡§ú‡§æ‡§Ø *number of HTTP/2 streams* ‡§ú‡•ã ‡§è‡§ï connection ‡§Æ‡•á‡§Ç ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§ú‡§¨ ‡§µ‡§π‡•Ä TLS connection ‡§™‡•Å‡§®: ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§è‡§ï attacker ‡§∏‡•à‡§ï‡§°‡§º‡•ã‡§Ç parallel streams ‡§ñ‡•ã‡§≤ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à, ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‡§Ö‡§≤‡§ó request ‡§≤‡•á ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•ã‡§§‡§æ ‡§π‡•à, ‡§ú‡§¨‡§ï‡§ø gateway ‡§ï‡•á‡§µ‡§≤ *one* request ‡§ï‡•ã quota ‡§∏‡•á ‡§ò‡§ü‡§æ‡§§‡§æ ‡§π‡•à‡•§
```bash
# Send 100 POST requests in a single HTTP/2 connection with curl
seq 1 100 | xargs -I@ -P0 curl -k --http2-prior-knowledge -X POST \
-H "Content-Type: application/json" \
-d '{"code":"@"}' https://target/api/v2/verify &>/dev/null
```
‡§Ø‡§¶‡§ø limiter ‡§ï‡•á‡§µ‡§≤ `/verify` ‡§ï‡•Ä ‡§π‡•Ä ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§≤‡•á‡§ï‡§ø‡§® `/api/v2/verify` ‡§ï‡•Ä ‡§®‡§π‡•Ä‡§Ç, ‡§§‡•ã ‡§Ü‡§™ **path confusion** ‡§ï‡•ã HTTP/2 multiplexing ‡§ï‡•á ‡§∏‡§æ‡§• ‡§Æ‡§ø‡§≤‡§æ‡§ï‡§∞ *‡§¨‡•á‡§π‡§¶* ‡§π‡§æ‡§à-‡§∏‡•ç‡§™‡•Ä‡§° OTP ‡§Ø‡§æ credential brute-forcing ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§

> üêæ  **Tip:** PortSwigger‚Äôs [Turbo Intruder](https://portswigger.net/research/turbo-intruder) HTTP/2 ‡§ï‡•ã ‡§∏‡§™‡•ã‡§∞‡•ç‡§ü ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§î‡§∞ `maxConcurrentConnections` ‡§î‡§∞ `requestsPerConnection` ‡§ï‡•ã fine-tune ‡§ï‡§∞‡§®‡•á ‡§¶‡•á‡§§‡§æ ‡§π‡•à ‡§§‡§æ‡§ï‡§ø ‡§Ü‡§™ ‡§á‡§∏ attack ‡§ï‡•ã automate ‡§ï‡§∞ ‡§∏‡§ï‡•á‡§Ç‡•§

### GraphQL aliases & batched operations

GraphQL ‡§ï‡•ç‡§≤‡§æ‡§á‡§Ç‡§ü ‡§ï‡•ã ‡§è‡§ï single request ‡§Æ‡•á‡§Ç *aliases* ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§ï‡•á **‡§ï‡§à ‡§§‡§æ‡§∞‡•ç‡§ï‡§ø‡§ï ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§∏‡•ç‡§µ‡§§‡§Ç‡§§‡•ç‡§∞ queries ‡§Ø‡§æ mutations ‡§≠‡•á‡§ú‡§®‡•á** ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à‡•§ ‡§ö‡•Ç‡§Ç‡§ï‡§ø ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§π‡§∞ alias ‡§ï‡•ã execute ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§≤‡•á‡§ï‡§ø‡§® rate-limiter ‡§Ö‡§ï‡•ç‡§∏‡§∞ ‡§ï‡•á‡§µ‡§≤ *‡§è‡§ï* request ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§ó‡§ø‡§®‡§§‡§æ ‡§π‡•à, ‡§Ø‡§π login ‡§Ø‡§æ password-reset throttling ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§≠‡§∞‡•ã‡§∏‡•á‡§Æ‡§Ç‡§¶ bypass ‡§π‡•à‡•§
```graphql
mutation bruteForceOTP {
a: verify(code:"111111") { token }
b: verify(code:"222222") { token }
c: verify(code:"333333") { token }
# ‚Ä¶ add up to dozens of aliases ‚Ä¶
}
```
‡§™‡•ç‡§∞‡§§‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•ã ‡§¶‡•á‡§ñ‡•á‡§Ç: ‡§¨‡§ø‡§≤‡•ç‡§ï‡•Å‡§≤ ‡§è‡§ï alias ‡§π‡•Ä 200 OK ‡§≤‡•å‡§ü‡§æ‡§è‡§ó‡§æ ‡§ú‡§¨ ‡§∏‡§π‡•Ä ‡§ï‡•ã‡§° ‡§Æ‡§æ‡§∞‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ, ‡§ú‡§¨‡§ï‡§ø ‡§¨‡§æ‡§ï‡•Ä rate-limited ‡§π‡•ã‡§Ç‡§ó‡•á‡•§

The technique was popularised by PortSwigger‚Äôs research on ‚ÄúGraphQL batching & aliases‚Äù in 2023 and has been responsible for many recent bug-bounty payouts‡•§

### Abuse of *batch* or *bulk* REST endpoints

‡§ï‡•Å‡§õ APIs ‡§ê‡§∏‡•á helper endpoints expose ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç ‡§ú‡•à‡§∏‡•á `/v2/batch` ‡§Ø‡§æ request body ‡§Æ‡•á‡§Ç **array of objects** ‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§Ö‡§ó‡§∞ limiter ‡§ï‡•á‡§µ‡§≤ *legacy* endpoints ‡§ï‡•á ‡§∏‡§æ‡§Æ‡§®‡•á ‡§∞‡§ñ‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à, ‡§§‡•ã ‡§è‡§ï ‡§π‡•Ä bulk request ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ ‡§ï‡§à operations ‡§ï‡•ã ‡§∞‡•à‡§™ ‡§ï‡§∞‡§®‡•á ‡§∏‡•á protection ‡§ï‡•ã ‡§™‡•Ç‡§∞‡•Ä ‡§§‡§∞‡§π sidestep ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§
```json
[
{"path": "/login", "method": "POST", "body": {"user":"bob","pass":"123"}},
{"path": "/login", "method": "POST", "body": {"user":"bob","pass":"456"}}
]
```
### sliding-window ‡§ï‡§æ ‡§∏‡§Æ‡§Ø ‡§®‡§ø‡§∞‡•ç‡§ß‡§æ‡§∞‡§£

‡§è‡§ï classic token-bucket ‡§Ø‡§æ leaky-bucket limiter ‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§∏‡§Æ‡§Ø ‡§∏‡•Ä‡§Æ‡§æ ‡§™‡§∞ *resets* ‡§π‡•ã‡§§‡§æ ‡§π‡•à (‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§π‡§∞ ‡§Æ‡§ø‡§®‡§ü)‡•§ ‡§Ø‡§¶‡§ø ‡§µ‡§ø‡§Ç‡§°‡•ã ‡§ú‡•ç‡§û‡§æ‡§§ ‡§π‡•à (‡§â‡§¶‡§æ. `X-RateLimit-Reset: 27` ‡§ú‡•à‡§∏‡•á error messages ‡§∏‡•á), ‡§§‡•ã ‡§¨‡§ï‡•á‡§ü ‡§∞‡§ø‡§∏‡•á‡§ü ‡§π‡•ã‡§®‡•á ‡§∏‡•á ‡§†‡•Ä‡§ï ‡§™‡§π‡§≤‡•á ‡§Ö‡§ß‡§ø‡§ï‡§§‡§Æ ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•Ä ‡§ó‡§à requests ‡§≠‡•á‡§ú‡•á‡§Ç, ‡§î‡§∞ ‡§§‡•Å‡§∞‡§Ç‡§§ ‡§è‡§ï ‡§î‡§∞ ‡§™‡•Ç‡§∞‡§æ burst ‡§≠‡•á‡§ú‡•á‡§Ç‡•§
```
|<-- 60 s window ‚Äë->|<-- 60 s window ‚Äë->|
######                 ######
```
‡§Ø‡§π ‡§∏‡§∞‡§≤ optimisation ‡§Ü‡§™‡§ï‡•Ä ‡§•‡•ç‡§∞‡•Ç‡§™‡•Å‡§ü ‡§ï‡•ã ‡§¨‡§ø‡§®‡§æ ‡§ï‡§ø‡§∏‡•Ä ‡§Ö‡§®‡•ç‡§Ø bypass technique ‡§ï‡•ã ‡§õ‡•Å‡§è ‡§¶‡•ã‡§ó‡•Å‡§®‡§æ ‡§∏‡•á ‡§≠‡•Ä ‡§Ö‡§ß‡§ø‡§ï ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

### ‡§π‡•à‡§Ç‡§°‡§∂‡•á‡§ï ‡§ï‡•á ‡§¨‡§æ‡§¶ WebSockets / gRPC streaming ‡§Æ‡•á‡§Ç ‡§Ö‡§™‡§ó‡•ç‡§∞‡•á‡§° ‡§ï‡§∞‡§®‡§æ

‡§ï‡§à edge rate-limiters ‡§ï‡•á‡§µ‡§≤ **initial HTTP request** ‡§ï‡•Ä ‡§π‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§è‡§ï ‡§¨‡§æ‡§∞ ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® WebSocket (HTTP 101) ‡§Ø‡§æ gRPC bidirectional streaming ‡§Æ‡•á‡§Ç ‡§Ö‡§™‡§ó‡•ç‡§∞‡•á‡§° ‡§π‡•ã ‡§ú‡§æ‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶, ‡§¨‡§æ‡§¶ ‡§ï‡•á ‡§∏‡§Ç‡§¶‡•á‡§∂ ‡§Ö‡§ï‡•ç‡§∏‡§∞ request-per-second ‡§ï‡§æ‡§â‡§Ç‡§ü‡§∞‡•ã‡§Ç ‡§ï‡•ã bypass ‡§ï‡§∞ ‡§¶‡•á‡§§‡•á ‡§π‡•à‡§Ç, ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§µ‡•á ‡§Ö‡§¨ ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó HTTP requests ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§§‡•á‡•§ Cloudflare ‡§ï‡•á ‡§Ö‡§™‡§®‡•á docs ‡§Æ‡•á‡§Ç ‡§â‡§≤‡•ç‡§≤‡•á‡§ñ ‡§π‡•à ‡§ï‡§ø ‡§ï‡•á‡§µ‡§≤ initial upgrade request ‡§π‡•Ä WAF/rate-limiting ‡§®‡§ø‡§Ø‡§Æ‡•ã‡§Ç ‡§ï‡•á ‡§Ö‡§Ç‡§§‡§∞‡•ç‡§ó‡§§ ‡§Ü‡§§‡§æ ‡§π‡•à; ‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç ‡§≠‡•á‡§ú‡•á ‡§ó‡§è frames ‡§Ö‡§∏‡•ç‡§™‡§∑‡•ç‡§ü ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç‡•§

‡§µ‡•ç‡§Ø‡§æ‡§µ‡§π‡§æ‡§∞‡§ø‡§ï workflow:
```bash
# Flood 1,000 OTP guesses through a single WebSocket connection
seq -w 000000 000999 | websocat -n ws://target.tld/api/verify-ws

# gRPC streaming: send multiple Verify requests in one stream
grpcurl -d @ -plaintext target.tld:50051 service.VerifyOTP/Stream <<'EOF'
{ "code": "111111" }
{ "code": "222222" }
{ "code": "333333" }
EOF
```
‡§Ø‡§¶‡§ø login/OTP endpoint ‡§¶‡•ã‡§®‡•ã‡§Ç HTTP ‡§î‡§∞ WebSocket/gRPC variants ‡§è‡§ï‡•ç‡§∏‡§™‡•ã‡§ú‡§º ‡§ï‡§∞‡§§‡§æ ‡§π‡•à, ‡§§‡•ã ‡§™‡§π‡§≤‡•á upgraded channel ‡§∏‡•ç‡§•‡§æ‡§™‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§´‡§ø‡§∞ ‡§â‡§∏‡•Ä single connection ‡§ï‡•á ‡§≠‡•Ä‡§§‡§∞ codes ‡§∏‡•ç‡§™‡•ç‡§∞‡•á ‡§ï‡§∞‡•á‡§Ç ‡§§‡§æ‡§ï‡§ø per-request throttles ‡§∏‡•á ‡§¨‡§ö‡§æ ‡§ú‡§æ ‡§∏‡§ï‡•á‡•§

### CDN PoP‚Äësharded counters ‡§ï‡§æ ‡§∂‡•ã‡§∑‡§£

‡§ï‡•Å‡§õ CDN rate-limit counters **per data center/PoP instead of globally** shard ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç‡•§ Cloudflare ‡§∏‡•ç‡§™‡§∑‡•ç‡§ü ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§¨‡§§‡§æ‡§§‡§æ ‡§π‡•à ‡§ï‡§ø counters data centers ‡§ï‡•á ‡§¨‡•Ä‡§ö share ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã‡§§‡•á‡•§ ‡§ï‡§à regions ‡§Æ‡•á‡§Ç ‡§Æ‡•å‡§ú‡•Ç‡§¶ egress nodes (residential proxy pools, anycast VPNs, or cloud VMs pinned to different continents) ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á requests route ‡§ï‡§∞‡§ï‡•á ‡§Ü‡§™ allowed throughput ‡§ï‡•ã ‡§ó‡•Å‡§£‡§æ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç: ‡§π‡§∞ PoP ‡§â‡§∏‡•Ä key ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§∏‡•ç‡§µ‡§§‡§Ç‡§§‡•ç‡§∞ bucket ‡§∞‡§ñ‡§§‡§æ ‡§π‡•à‡•§

Quick and dirty layout using open proxies (example with `proxychains` + a country‚Äërotating list):
```bash
for p in $(cat proxies.txt); do
HTTPS_PROXY=$p curl -s -X POST https://target/api/login -d @payload.json &
done
wait
```
‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§ï‡§ø limiter key per-account ‡§® ‡§π‡•ã; ‡§Ö‡§®‡•ç‡§Ø‡§•‡§æ user IDs / session tokens ‡§≠‡•Ä rotate ‡§ï‡§∞‡•á‡§Ç‡•§

---

## ‡§â‡§™‡§ï‡§∞‡§£

- [**https://github.com/Hashtag-AMIN/hashtag-fuzz**](https://github.com/Hashtag-AMIN/hashtag-fuzz): ‡§è‡§ï Fuzzing tool ‡§ú‡•ã header randomisation, chunked word-lists ‡§î‡§∞ round-robin proxy rotation ‡§ï‡•ã ‡§∏‡§™‡•ã‡§∞‡•ç‡§ü ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§
- [**https://github.com/ustayready/fireprox**](https://github.com/ustayready/fireprox): ‡§∏‡•ç‡§µ‡§ö‡§æ‡§≤‡§ø‡§§ ‡§∞‡•Ç‡§™ ‡§∏‡•á disposable AWS API Gateway endpoints ‡§¨‡§®‡§æ‡§§‡§æ ‡§π‡•à ‡§§‡§æ‡§ï‡§ø ‡§π‡§∞ request ‡§Ö‡§≤‡§ó IP address ‡§∏‡•á ‡§â‡§§‡•ç‡§™‡§®‡•ç‡§® ‡§π‡•ã ‚Äì IP-based throttling ‡§ï‡•ã ‡§π‡§∞‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§â‡§™‡§Ø‡•Å‡§ï‡•ç‡§§‡•§
- **Burp Suite ‚Äì IPRotate + extension**: SOCKS/HTTP proxies (‡§Ø‡§æ AWS API Gateway) ‡§ï‡•á ‡§è‡§ï ‡§™‡•Ç‡§≤ ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§§‡§æ‡§ï‡§ø source IP ‡§™‡§æ‡§∞‡§¶‡§∞‡•ç‡§∂‡•Ä ‡§∞‡•Ç‡§™ ‡§∏‡•á rotate ‡§π‡•ã ‡§∏‡§ï‡•á *Intruder* ‡§î‡§∞ *Turbo Intruder* ‡§π‡§Æ‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§¶‡•å‡§∞‡§æ‡§®‡•§
- **Turbo Intruder (BApp)**: High-performance attack engine ‡§ú‡•ã HTTP/2 multiplexing ‡§ï‡•ã ‡§∏‡§™‡•ã‡§∞‡•ç‡§ü ‡§ï‡§∞‡§§‡§æ ‡§π‡•à; `requestsPerConnection` ‡§ï‡•ã 100-1000 ‡§™‡§∞ ‡§∏‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç ‡§§‡§æ‡§ï‡§ø ‡§∏‡•à‡§ï‡§°‡§º‡•ã‡§Ç requests ‡§è‡§ï single connection ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§æ ‡§ú‡§æ‡§è‡§Å‡•§

## ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠

- [PortSwigger Research ‚Äì ‚ÄúBypassing rate limits with GraphQL aliasing‚Äù (2023)](https://portswigger.net/research/graphql-authorization-bypass)
- [PortSwigger Research ‚Äì ‚ÄúHTTP/2: The Sequel is Always Worse‚Äù (connection-based throttling) (2024)](https://portswigger.net/research/http2)
- [Cloudflare Docs ‚Äì WebSockets & WAF applicability (2025)](https://developers.cloudflare.com/network/websockets/)
- [Cloudflare Docs ‚Äì Request rate calculation and PoP-local counters (2025)](https://developers.cloudflare.com/waf/rate-limiting-rules/request-rate/)

{{#include ../banners/hacktricks-training.md}}
