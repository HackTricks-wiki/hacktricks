# Rate Limit Bypass

{{#include ../banners/hacktricks-training.md}}

## Rate limit bypass techniques

### Exploring Similar Endpoints

Hedeflenen uÃ§ noktanÄ±n varyasyonlarÄ±na, Ã¶rneÄŸin `/api/v3/sign-up`, `/Sing-up`, `/SignUp`, `/singup`, `/api/v1/sign-up`, `/api/sign-up` gibi alternatiflere karÅŸÄ± brute force saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirmek iÃ§in denemeler yapÄ±lmalÄ±dÄ±r.

### Incorporating Blank Characters in Code or Parameters

Kod veya parametrelere `%00`, `%0d%0a`, `%0d`, `%0a`, `%09`, `%0C`, `%20` gibi boÅŸ baytlar eklemek faydalÄ± bir strateji olabilir. Ã–rneÄŸin, bir parametreyi `code=1234%0a` olarak ayarlamak, giriÅŸteki varyasyonlar aracÄ±lÄ±ÄŸÄ±yla deneme sÃ¼resini uzatmaya olanak tanÄ±r; bu, bir e-posta adresine yeni satÄ±r karakterleri ekleyerek deneme sÄ±nÄ±rlamalarÄ±nÄ± aÅŸmayÄ± saÄŸlar.

### Manipulating IP Origin via Headers

AlgÄ±lanan IP kÃ¶kenini deÄŸiÅŸtirmek iÃ§in baÅŸlÄ±klarÄ± deÄŸiÅŸtirmek, IP tabanlÄ± hÄ±z sÄ±nÄ±rlamasÄ±ndan kaÃ§Ä±nmaya yardÄ±mcÄ± olabilir. `X-Originating-IP`, `X-Forwarded-For`, `X-Remote-IP`, `X-Remote-Addr`, `X-Client-IP`, `X-Host`, `X-Forwared-Host` gibi baÅŸlÄ±klar, farklÄ± IP'lerden gelen istekleri simÃ¼le etmek iÃ§in birden fazla `X-Forwarded-For` Ã¶rneÄŸi kullanarak ayarlanabilir.
```bash
X-Originating-IP: 127.0.0.1
X-Forwarded-For: 127.0.0.1
X-Remote-IP: 127.0.0.1
X-Remote-Addr: 127.0.0.1
X-Client-IP: 127.0.0.1
X-Host: 127.0.0.1
X-Forwared-Host: 127.0.0.1

# Double X-Forwarded-For header example
X-Forwarded-For:
X-Forwarded-For: 127.0.0.1
```
### DiÄŸer BaÅŸlÄ±klarÄ± DeÄŸiÅŸtirme

KullanÄ±cÄ± ajanÄ± ve Ã§erezler gibi diÄŸer istek baÅŸlÄ±klarÄ±nÄ± deÄŸiÅŸtirmek Ã¶nerilir, Ã§Ã¼nkÃ¼ bunlar da istek kalÄ±plarÄ±nÄ± tanÄ±mlamak ve takip etmek iÃ§in kullanÄ±labilir. Bu baÅŸlÄ±klarÄ±n deÄŸiÅŸtirilmesi, talep edenin faaliyetlerinin tanÄ±nmasÄ±nÄ± ve izlenmesini Ã¶nleyebilir.

### API Gateway DavranÄ±ÅŸÄ±nÄ± Kullanma

BazÄ± API geÃ§itleri, uÃ§ nokta ve parametrelerin kombinasyonuna dayalÄ± olarak oran sÄ±nÄ±rlamasÄ± uygulamak iÃ§in yapÄ±landÄ±rÄ±lmÄ±ÅŸtÄ±r. Parametre deÄŸerlerini deÄŸiÅŸtirerek veya isteÄŸe Ã¶nemsiz parametreler ekleyerek, geÃ§idin oran sÄ±nÄ±rlama mantÄ±ÄŸÄ±nÄ± aÅŸmak mÃ¼mkÃ¼n olabilir, bÃ¶ylece her istek benzersiz gÃ¶rÃ¼nÃ¼r. Ã–rneÄŸin `/resetpwd?someparam=1`.

### Her Denemeden Ã–nce HesabÄ±nÄ±za GiriÅŸ Yapma

Her denemeden veya her deneme setinden Ã¶nce bir hesaba giriÅŸ yapmak, oran sÄ±nÄ±rlama sayacÄ±nÄ± sÄ±fÄ±rlayabilir. Bu, Ã¶zellikle giriÅŸ iÅŸlevselliklerini test ederken faydalÄ±dÄ±r. Burp Suite gibi araÃ§larda, her birkaÃ§ denemeden sonra kimlik bilgilerini dÃ¶ndÃ¼rmek ve yÃ¶nlendirmelerin iÅŸaretlendiÄŸinden emin olmak iÃ§in bir Pitchfork saldÄ±rÄ±sÄ± kullanmak, oran sÄ±nÄ±rlama sayaÃ§larÄ±nÄ± etkili bir ÅŸekilde yeniden baÅŸlatabilir.

### Proxy AÄŸlarÄ±nÄ± Kullanma

Ä°stekleri birden fazla IP adresi arasÄ±nda daÄŸÄ±tmak iÃ§in bir proxy aÄŸÄ± daÄŸÄ±tmak, IP tabanlÄ± oran sÄ±nÄ±rlamalarÄ±nÄ± etkili bir ÅŸekilde aÅŸabilir. TrafiÄŸi Ã§eÅŸitli proxyler aracÄ±lÄ±ÄŸÄ±yla yÃ¶nlendirerek, her istek farklÄ± bir kaynaktan geliyormuÅŸ gibi gÃ¶rÃ¼nÃ¼r, bu da oran sÄ±nÄ±rlamasÄ±nÄ±n etkinliÄŸini azaltÄ±r.

### SaldÄ±rÄ±yÄ± FarklÄ± Hesaplar veya Oturumlar ArasÄ±nda BÃ¶lme

Hedef sistem, oran sÄ±nÄ±rlamalarÄ±nÄ± hesap baÅŸÄ±na veya oturum baÅŸÄ±na uyguluyorsa, saldÄ±rÄ±yÄ± veya testi birden fazla hesap veya oturum arasÄ±nda daÄŸÄ±tmak, tespiti Ã¶nlemeye yardÄ±mcÄ± olabilir. Bu yaklaÅŸÄ±m, birden fazla kimlik veya oturum belirteci yÃ¶netmeyi gerektirir, ancak yÃ¼kÃ¼ izin verilen sÄ±nÄ±rlar iÃ§inde daÄŸÄ±tmak iÃ§in etkili olabilir.

### Denemeye Devam Edin

Bir oran sÄ±nÄ±rlamasÄ± olsa bile, geÃ§erli OTP gÃ¶nderildiÄŸinde yanÄ±tÄ±n farklÄ± olup olmadÄ±ÄŸÄ±nÄ± gÃ¶rmek iÃ§in denemeye devam etmelisiniz. [**bu yazÄ±da**](https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732), hata avcÄ±sÄ±, 20 baÅŸarÄ±sÄ±z denemeden sonra 401 ile yanÄ±t verildiÄŸinde bir oran sÄ±nÄ±rlamasÄ±nÄ±n tetiklendiÄŸini keÅŸfetti, ancak geÃ§erli olan gÃ¶nderildiÄŸinde 200 yanÄ±tÄ± alÄ±ndÄ±.

---

### HTTP/2 Ã§oklama ve istek boru hattÄ± istismar etme (2023-2025)

Modern oran sÄ±nÄ±rlayÄ±cÄ± uygulamalarÄ± genellikle **TCP baÄŸlantÄ±larÄ±nÄ±** (veya hatta bireysel HTTP/1.1 isteklerini) sayar, bir baÄŸlantÄ±nÄ±n iÃ§erdiÄŸi *HTTP/2 akÄ±ÅŸlarÄ±nÄ±n sayÄ±sÄ±* yerine. AynÄ± TLS baÄŸlantÄ±sÄ± yeniden kullanÄ±ldÄ±ÄŸÄ±nda, bir saldÄ±rgan yÃ¼zlerce paralel akÄ±ÅŸ aÃ§abilir, her biri ayrÄ± bir isteÄŸi taÅŸÄ±rken, geÃ§it yalnÄ±zca *bir* isteÄŸi kotalardan dÃ¼ÅŸer.
```bash
# Send 100 POST requests in a single HTTP/2 connection with curl
seq 1 100 | xargs -I@ -P0 curl -k --http2-prior-knowledge -X POST \
-H "Content-Type: application/json" \
-d '{"code":"@"}' https://target/api/v2/verify &>/dev/null
```
EÄŸer sÄ±nÄ±rlayÄ±cÄ± yalnÄ±zca `/verify`'yi koruyorsa ancak `/api/v2/verify`'yi korumuyorsa, **path confusion**'Ä± HTTP/2 Ã§oklama ile birleÅŸtirerek *son derece* yÃ¼ksek hÄ±zlÄ± OTP veya kimlik bilgisi brute-forcing yapabilirsiniz.

> ğŸ¾  **Ä°pucu:** PortSwiggerâ€™in [Turbo Intruder](https://portswigger.net/research/turbo-intruder) HTTP/2'yi destekler ve bu saldÄ±rÄ±yÄ± otomatikleÅŸtirmek iÃ§in `maxConcurrentConnections` ve `requestsPerConnection` deÄŸerlerini ince ayar yapmanÄ±za olanak tanÄ±r.

### GraphQL takma adlarÄ± ve toplu iÅŸlemler

GraphQL, istemcinin **bir istekte birden fazla mantÄ±ksal olarak baÄŸÄ±msÄ±z sorgu veya mutasyon gÃ¶ndermesine** olanak tanÄ±r; bunlarÄ± *takma adlar* ile Ã¶ne alarak. Sunucu her takma adÄ± yÃ¼rÃ¼tse de, sÄ±nÄ±rlayÄ±cÄ± genellikle yalnÄ±zca *bir* isteÄŸi saydÄ±ÄŸÄ±ndan, bu, giriÅŸ veya ÅŸifre sÄ±fÄ±rlama kÄ±sÄ±tlamasÄ± iÃ§in gÃ¼venilir bir geÃ§iÅŸtir.
```graphql
mutation bruteForceOTP {
a: verify(code:"111111") { token }
b: verify(code:"222222") { token }
c: verify(code:"333333") { token }
# â€¦ add up to dozens of aliases â€¦
}
```
BakÄ±n, doÄŸru kod gÃ¶nderildiÄŸinde tam olarak bir takma ad 200 OK dÃ¶necek, diÄŸerleri ise hÄ±z sÄ±nÄ±rlÄ± olacak.

Bu teknik, 2023'te PortSwigger'Ä±n â€œGraphQL batching & aliasesâ€ konusundaki araÅŸtÄ±rmasÄ±yla popÃ¼ler hale geldi ve birÃ§ok son zamanlardaki bug-bounty Ã¶demelerinin sorumlusu oldu.

### *Batch* veya *bulk* REST uÃ§ noktalarÄ±nÄ±n kÃ¶tÃ¼ye kullanÄ±mÄ±

BazÄ± API'ler, `/v2/batch` gibi yardÄ±mcÄ± uÃ§ noktalarÄ± aÃ§ar veya istek gÃ¶vdesinde bir **nesne dizisi** kabul eder. EÄŸer sÄ±nÄ±rlayÄ±cÄ± yalnÄ±zca *legacy* uÃ§ noktalarÄ±nÄ±n Ã¶nÃ¼nde yer alÄ±yorsa, birden fazla iÅŸlemi tek bir toplu isteÄŸin iÃ§ine sarmak korumayÄ± tamamen atlayabilir.
```json
[
{"path": "/login", "method": "POST", "body": {"user":"bob","pass":"123"}},
{"path": "/login", "method": "POST", "body": {"user":"bob","pass":"456"}}
]
```
### KaydÄ±rmalÄ± Pencereyi Zamanlama

Klasik bir token-bucket veya sÄ±zÄ±ntÄ±lÄ±-bucket sÄ±nÄ±rlayÄ±cÄ±, sabit bir zaman sÄ±nÄ±rÄ±nda *sÄ±fÄ±rlanÄ±r* (Ã¶rneÄŸin, her dakika). Pencere biliniyorsa (Ã¶rneÄŸin, `X-RateLimit-Reset: 27` gibi hata mesajlarÄ± aracÄ±lÄ±ÄŸÄ±yla), bucket sÄ±fÄ±rlanmadan **hemen Ã¶nce** izin verilen maksimum sayÄ±da isteÄŸi gÃ¶nderin, ardÄ±ndan hemen baÅŸka bir tam patlama yapÄ±n.
```
|<-- 60 s window â€‘->|<-- 60 s window â€‘->|
######                 ######
```
Bu basit optimizasyon, baÅŸka herhangi bir bypass tekniÄŸine dokunmadan, verimliliÄŸinizi iki katÄ±ndan fazla artÄ±rabilir.

---

## AraÃ§lar

- [**https://github.com/Hashtag-AMIN/hashtag-fuzz**](https://github.com/Hashtag-AMIN/hashtag-fuzz): BaÅŸlÄ±k rastgeleleÅŸtirmeyi, parÃ§alÄ± kelime listelerini ve yuvarlak-rota proxy dÃ¶ngÃ¼sÃ¼nÃ¼ destekleyen fuzzing aracÄ±.
- [**https://github.com/ustayready/fireprox**](https://github.com/ustayready/fireprox): Her isteÄŸin farklÄ± bir IP adresinden gelmesini saÄŸlamak iÃ§in otomatik olarak harcanabilir AWS API Gateway uÃ§ noktalarÄ± oluÅŸturur â€“ IP tabanlÄ± kÄ±sÄ±tlamalarÄ± aÅŸmak iÃ§in mÃ¼kemmel.
- **Burp Suite â€“ IPRotate + uzantÄ±**: *Intruder* ve *Turbo Intruder* saldÄ±rÄ±larÄ± sÄ±rasÄ±nda kaynak IP'yi ÅŸeffaf bir ÅŸekilde dÃ¶ndÃ¼rmek iÃ§in bir SOCKS/HTTP proxy havuzu (veya AWS API Gateway) kullanÄ±r.
- **Turbo Intruder (BApp)**: HTTP/2 Ã§oklama desteÄŸi olan yÃ¼ksek performanslÄ± saldÄ±rÄ± motoru; yÃ¼zlerce isteÄŸi tek bir baÄŸlantÄ±da birleÅŸtirmek iÃ§in `requestsPerConnection` deÄŸerini 100-1000 olarak ayarlayÄ±n.

## Referanslar

- PortSwigger Research â€“ â€œGraphQL aliasing ile rate limit aÅŸmaâ€ (2023)  <https://portswigger.net/research/graphql-authorization-bypass>
- PortSwigger Research â€“ â€œHTTP/2: DevamÄ± Her Zaman Daha KÃ¶tÃ¼dÃ¼râ€ (bÃ¶lÃ¼m *BaÄŸlantÄ± tabanlÄ± kÄ±sÄ±tlama*) (2024)  <https://portswigger.net/research/http2>

{{#include ../banners/hacktricks-training.md}}
