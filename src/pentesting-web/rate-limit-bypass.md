# Rate Limit Bypass

{{#include ../banners/hacktricks-training.md}}

## Rate limit bypass techniques

### Exploring Similar Endpoints

Hedeflenen endpoint'in varyasyonlarÄ±na karÅŸÄ± brute force saldÄ±rÄ±larÄ± gerÃ§ekleÅŸtirmeye Ã§alÄ±ÅŸÄ±lmalÄ±dÄ±r; Ã¶rneÄŸin `/api/v3/sign-up` gibi, ayrÄ±ca `/Sing-up`, `/SignUp`, `/singup`, `/api/v1/sign-up`, `/api/sign-up` gibi alternatifler denenmelidir.

### Incorporating Blank Characters in Code or Parameters

Code veya parametrelere `%00`, `%0d%0a`, `%0d`, `%0a`, `%09`, `%0C`, `%20` gibi boÅŸ byte'lar eklemek faydalÄ± bir strateji olabilir. Ã–rneÄŸin, bir parametreyi `code=1234%0a` olarak ayarlamak, e-posta adresine newline karakterleri ekleyerek deneme sÄ±nÄ±rlamalarÄ±nÄ± aÅŸmak gibi giriÅŸ varyasyonlarÄ±yla denemeleri uzatmaya imkan tanÄ±r.

### Manipulating IP Origin via Headers

AlgÄ±lanan IP kaynaÄŸÄ±nÄ± deÄŸiÅŸtirmek iÃ§in header'larÄ± deÄŸiÅŸtirmek, IP tabanlÄ± rate limiting'ten kaÃ§maya yardÄ±mcÄ± olabilir. `X-Originating-IP`, `X-Forwarded-For`, `X-Remote-IP`, `X-Remote-Addr`, `X-Client-IP`, `X-Host`, `X-Forwared-Host` gibi header'lar ve birden fazla `X-Forwarded-For` Ã¶rneÄŸi kullanmak, farklÄ± IP'lerden gelen istekleri simÃ¼le etmek iÃ§in ayarlanabilir.
```bash
X-Originating-IP: 127.0.0.1
X-Forwarded-For: 127.0.0.1
X-Remote-IP: 127.0.0.1
X-Remote-Addr: 127.0.0.1
X-Client-IP: 127.0.0.1
X-Host: 127.0.0.1
X-Forwared-Host: 127.0.0.1

# Double X-Forwarded-For header example
X-Forwarded-For:
X-Forwarded-For: 127.0.0.1
```
### Changing Other Headers

user-agent ve cookies gibi diÄŸer istek header'larÄ±nÄ± deÄŸiÅŸtirmek Ã¶nerilir; Ã§Ã¼nkÃ¼ bunlar istek desenlerini tanÄ±mlamak ve izlemek iÃ§in kullanÄ±labilir. Bu header'larÄ± deÄŸiÅŸtirmek, isteÄŸi yapan kiÅŸinin faaliyetlerinin tanÄ±nmasÄ±nÄ± ve izlenmesini engelleyebilir.

### Leveraging API Gateway Behavior

BazÄ± API gateway'leri, rate limiting'i endpoint ve parametre kombinasyonuna gÃ¶re uygulayacak ÅŸekilde yapÄ±landÄ±rÄ±lmÄ±ÅŸtÄ±r. Parametre deÄŸerlerini deÄŸiÅŸtirerek veya isteÄŸe anlamsÄ±z parametreler ekleyerek gateway'in rate-limiting mantÄ±ÄŸÄ±nÄ± aÅŸmak ve her isteÄŸi benzersiz gÃ¶stermek mÃ¼mkÃ¼ndÃ¼r. Ã–rneÄŸin `/resetpwd?someparam=1`.

### Logging into Your Account Before Each Attempt

Her denemeden veya deneme setinden Ã¶nce bir hesaba giriÅŸ yapmak, rate limit sayacÄ±nÄ± sÄ±fÄ±rlayabilir. Bu, Ã¶zellikle login fonksiyonlarÄ±nÄ± test ederken faydalÄ±dÄ±r. Burp Suite gibi araÃ§larda Pitchfork attack kullanarak kimlik bilgilerini birkaÃ§ denemede bir dÃ¶ndÃ¼rmek ve follow redirects iÅŸaretli olduÄŸundan emin olmak, rate limit sayaÃ§larÄ±nÄ± etkili ÅŸekilde yeniden baÅŸlatabilir.

### Utilizing Proxy Networks

Ä°stekleri birden fazla IP adresine daÄŸÄ±tmak iÃ§in bir proxy aÄŸÄ± kullanmak, IP tabanlÄ± rate limitlerini etkili ÅŸekilde atlatabilir. TrafiÄŸi Ã§eÅŸitli proxy'ler Ã¼zerinden yÃ¶nlendirerek, her istek farklÄ± bir kaynaktan geliyormuÅŸ gibi gÃ¶rÃ¼nÃ¼r ve rate limitin etkinliÄŸi azalÄ±r.

### Splitting the Attack Across Different Accounts or Sessions

Hedef sistem hesap baÅŸÄ±na veya oturum baÅŸÄ±na rate limit uyguluyorsa, saldÄ±rÄ±yÄ± veya testi birden fazla hesap ya da oturum arasÄ±nda daÄŸÄ±tmak tespitten kaÃ§Ä±nmaya yardÄ±mcÄ± olabilir. Bu yaklaÅŸÄ±m birden fazla kimlik veya oturum token'Ä± yÃ¶netmeyi gerektirir, ancak yÃ¼kÃ¼ izin verilen sÄ±nÄ±rlar iÃ§inde etkin ÅŸekilde daÄŸÄ±tabilir.

### Keep Trying

Not: rate limit olsa bile geÃ§erli OTP gÃ¶nderildiÄŸinde yanÄ±tÄ±n farklÄ± olup olmadÄ±ÄŸÄ±nÄ± denemelisiniz. [**this post**](https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732) iÃ§inde bug hunter, 20 baÅŸarÄ±sÄ±z denemeden sonra 401 dÃ¶ndÃ¼rÃ¼lerek rate limit tetiklense bile, geÃ§erli gÃ¶nderildiÄŸinde 200 yanÄ±tÄ± alÄ±ndÄ±ÄŸÄ±nÄ± keÅŸfetti.

---

### Abusing HTTP/2 multiplexing & request pipelining (2023-2025)

Modern rateâ€“limiter implementasyonlarÄ± sÄ±klÄ±kla **TCP connections** (or even individual HTTP/1.1 requests) sayar, bir baÄŸlantÄ±nÄ±n iÃ§erdiÄŸi *number of HTTP/2 streams* yerine. AynÄ± TLS baÄŸlantÄ±sÄ± yeniden kullanÄ±ldÄ±ÄŸÄ±nda, bir saldÄ±rgan her biri ayrÄ± bir istek taÅŸÄ±yan yÃ¼zlerce paralel stream aÃ§abilir; gateway ise kotadan yalnÄ±zca *one* request dÃ¼ÅŸer.
```bash
# Send 100 POST requests in a single HTTP/2 connection with curl
seq 1 100 | xargs -I@ -P0 curl -k --http2-prior-knowledge -X POST \
-H "Content-Type: application/json" \
-d '{"code":"@"}' https://target/api/v2/verify &>/dev/null
```
EÄŸer limiter sadece `/verify`'Ä± koruyup `/api/v2/verify`'Ä± korumuyorsa, **path confusion** ile HTTP/2 multiplexing'i birleÅŸtirerek *son derece* yÃ¼ksek hÄ±zlÄ± OTP veya credential brute-forcing yapabilirsiniz.

> ğŸ¾  **Ä°pucu:** PortSwiggerâ€™Ä±n [Turbo Intruder](https://portswigger.net/research/turbo-intruder) HTTP/2'yi destekler ve bu saldÄ±rÄ±yÄ± otomatikleÅŸtirmek iÃ§in `maxConcurrentConnections` ve `requestsPerConnection` deÄŸerlerini ince ayar yapmanÄ±za olanak tanÄ±r.

### GraphQL aliases & batched operations

GraphQL, istemcinin *aliases* ile Ã¶nekleyerek tek bir istekte **birden fazla mantÄ±ksal olarak baÄŸÄ±msÄ±z query veya mutation** gÃ¶ndermesine izin verir. Sunucu her alias'Ä± Ã§alÄ±ÅŸtÄ±rdÄ±ÄŸÄ± halde rate-limiter genellikle sadece *bir* isteÄŸi saydÄ±ÄŸÄ± iÃ§in, bu login veya password-reset throttling iÃ§in gÃ¼venilir bir bypass'tÄ±r.
```graphql
mutation bruteForceOTP {
a: verify(code:"111111") { token }
b: verify(code:"222222") { token }
c: verify(code:"333333") { token }
# â€¦ add up to dozens of aliases â€¦
}
```
Look at the response: doÄŸru kod hedeflendiÄŸinde tam olarak bir alias 200 OK dÃ¶ndÃ¼recek, diÄŸerleri ise rate-limited olacak.

The technique was popularised by PortSwiggerâ€™s research on â€œGraphQL batching & aliasesâ€ in 2023 and has been responsible for many recent bug-bounty payouts.

### *batch* veya *bulk* REST endpoint'larÄ±nÄ±n kÃ¶tÃ¼ye kullanÄ±mÄ±

BazÄ± API'ler `/v2/batch` gibi yardÄ±mcÄ± endpoint'lar saÄŸlar veya istek gÃ¶vdesinde **nesneler dizisi** kabul eder. EÄŸer limiter sadece *legacy* endpoint'larÄ±n Ã¶nÃ¼ne yerleÅŸtirilmiÅŸse, birden fazla iÅŸlemi tek bir toplu istek iÃ§ine sarmak korumayÄ± tamamen atlatabilir.
```json
[
{"path": "/login", "method": "POST", "body": {"user":"bob","pass":"123"}},
{"path": "/login", "method": "POST", "body": {"user":"bob","pass":"456"}}
]
```
### sliding-window zamanlamasÄ±

Klasik token-bucket veya leaky-bucket limiter sabit bir zaman sÄ±nÄ±rÄ±nda *sÄ±fÄ±rlanÄ±r* (Ã¶rneÄŸin, her dakika). EÄŸer pencere biliniyorsa (Ã¶r. hata mesajlarÄ± aracÄ±lÄ±ÄŸÄ±yla `X-RateLimit-Reset: 27`), izin verilen maksimum sayÄ±da isteÄŸi bucket **hemen Ã¶nce** gÃ¶nderin, sonra hemen baÅŸka bir tam patlama daha gÃ¶nderin.
```
|<-- 60 s window â€‘->|<-- 60 s window â€‘->|
######                 ######
```
Bu basit optimizasyon, baÅŸka herhangi bir bypass technique'e dokunmadan throughput'unuzu iki kattan fazla artÄ±rabilir.

### Handshake'ten sonra WebSockets / gRPC streaming'e yÃ¼kseltme

Ã‡oÄŸu edge rate-limiter sadece **ilk HTTP isteÄŸini** inceler. BaÄŸlantÄ± WebSocket (HTTP 101) veya gRPC bidirectional streaming'e yÃ¼kseltildiÄŸinde, sonraki mesajlar genellikle ayrÄ± HTTP istekleri olmadÄ±klarÄ± iÃ§in request-per-second counters'larÄ± atlar. Cloudflareâ€™Ä±n kendi dokÃ¼manlarÄ±, yalnÄ±zca ilk yÃ¼kseltme isteÄŸinin WAF/rate-limiting kurallarÄ±na tabi olduÄŸunu; sonrasÄ±nda gÃ¶nderilen frames'lerin opak olduÄŸunu not eder.

Pratik iÅŸ akÄ±ÅŸÄ±:
```bash
# Flood 1,000 OTP guesses through a single WebSocket connection
seq -w 000000 000999 | websocat -n ws://target.tld/api/verify-ws

# gRPC streaming: send multiple Verify requests in one stream
grpcurl -d @ -plaintext target.tld:50051 service.VerifyOTP/Stream <<'EOF'
{ "code": "111111" }
{ "code": "222222" }
{ "code": "333333" }
EOF
```
EÄŸer login/OTP endpoint'i hem HTTP hem de WebSocket/gRPC varyantlarÄ±nÄ± sunuyorsa, Ã¶nce yÃ¼kseltilmiÅŸ kanalÄ± kurun ve ardÄ±ndan tek bir baÄŸlantÄ± iÃ§inde kodlarÄ± seri olarak gÃ¶ndererek istek baÅŸÄ±na uygulanan sÄ±nÄ±rlamalardan kaÃ§Ä±nÄ±n.

### CDN PoPâ€‘sharded sayaÃ§larÄ±nÄ±n istismarÄ±

BazÄ± CDN'ler rate-limit sayaÃ§larÄ±nÄ± **kÃ¼resel olarak paylaÅŸmak yerine veri merkezi/PoP bazÄ±nda shard'lar**. Cloudflare aÃ§Ä±kÃ§a sayaÃ§larÄ±n veri merkezleri arasÄ±nda paylaÅŸÄ±lmadÄ±ÄŸÄ±nÄ± belirtir. Talepleri birÃ§ok bÃ¶lgede bulunan egress node'lar (residential proxy pools, anycast VPNs veya farklÄ± kÄ±talara sabitlenmiÅŸ cloud VMs) Ã¼zerinden yÃ¶nlendirerek izin verilen throughput'u katlarsÄ±nÄ±z: her PoP aynÄ± anahtar iÃ§in baÄŸÄ±msÄ±z bir bucket tutar.

AÃ§Ä±k proxy'ler kullanarak hÄ±zlÄ± ve basit dÃ¼zen (Ã¶rnek `proxychains` + Ã¼lke rotasyonlu liste):
```bash
for p in $(cat proxies.txt); do
HTTPS_PROXY=$p curl -s -X POST https://target/api/login -d @payload.json &
done
wait
```
Make sure the limiter key is not per-account; otherwise also rotate user IDs / session tokens.

---

## AraÃ§lar

- [**https://github.com/Hashtag-AMIN/hashtag-fuzz**](https://github.com/Hashtag-AMIN/hashtag-fuzz): Fuzzing aracÄ±; header randomisation, chunked word-lists ve round-robin proxy rotation'Ä± destekler.
- [**https://github.com/ustayready/fireprox**](https://github.com/ustayready/fireprox): Her isteÄŸin farklÄ± bir IP adresinden kaynaklanmasÄ±nÄ± saÄŸlamak iÃ§in disposable AWS API Gateway endpoints oluÅŸturur â€” IP-based throttling'i yenmek iÃ§in ideal.
- **Burp Suite â€“ IPRotate + extension**: Kaynak IP'yi *Intruder* ve *Turbo Intruder* saldÄ±rÄ±larÄ± sÄ±rasÄ±nda ÅŸeffaf ÅŸekilde dÃ¶ndÃ¼rmek iÃ§in SOCKS/HTTP proxies (veya AWS API Gateway) havuzu kullanÄ±r.
- **Turbo Intruder (BApp)**: HTTP/2 multiplexing'i destekleyen yÃ¼ksek performanslÄ± saldÄ±rÄ± motoru; yÃ¼zlerce isteÄŸi tek bir baÄŸlantÄ±ya sÄ±kÄ±ÅŸtÄ±rmak iÃ§in `requestsPerConnection` deÄŸerini 100-1000 aralÄ±ÄŸÄ±na ayarlayÄ±n.

## Referanslar

- [PortSwigger Research â€“ â€œBypassing rate limits with GraphQL aliasingâ€ (2023)](https://portswigger.net/research/graphql-authorization-bypass)
- [PortSwigger Research â€“ â€œHTTP/2: The Sequel is Always Worseâ€ (connection-based throttling) (2024)](https://portswigger.net/research/http2)
- [Cloudflare Docs â€“ WebSockets & WAF applicability (2025)](https://developers.cloudflare.com/network/websockets/)
- [Cloudflare Docs â€“ Request rate calculation and PoP-local counters (2025)](https://developers.cloudflare.com/waf/rate-limiting-rules/request-rate/)

{{#include ../banners/hacktricks-training.md}}
