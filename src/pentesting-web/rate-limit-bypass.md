# Rate Limit Bypass

{{#include ../banners/hacktricks-training.md}}

## Rate limit bypass techniques

### Exploring Similar Endpoints

Treba pokuÅ¡ati izvesti brute force napade na varijacije ciljanog endpointa, kao Å¡to je `/api/v3/sign-up`, ukljuÄujuÄ‡i alternative kao `/Sing-up`, `/SignUp`, `/singup`, `/api/v1/sign-up`, `/api/sign-up` itd.

### Incorporating Blank Characters in Code or Parameters

Umetanje blank bajtova kao Å¡to su `%00`, `%0d%0a`, `%0d`, `%0a`, `%09`, `%0C`, `%20` u code ili parameters moÅ¾e biti korisna strategija. Na primer, podeÅ¡avanje parametra na `code=1234%0a` omoguÄ‡ava produÅ¾enje pokuÅ¡aja kroz varijacije unosa, kao Å¡to je dodavanje newline karaktera u email adresu kako bi se zaobiÅ¡la ograniÄenja pokuÅ¡aja.

### Manipulating IP Origin via Headers

Modifikovanje headera da bi se promenio percipirani IP origin moÅ¾e pomoÄ‡i u izbegavanju IP-based rate limiting. Headeri kao Å¡to su `X-Originating-IP`, `X-Forwarded-For`, `X-Remote-IP`, `X-Remote-Addr`, `X-Client-IP`, `X-Host`, `X-Forwared-Host`, ukljuÄujuÄ‡i koriÅ¡Ä‡enje viÅ¡e instanci `X-Forwarded-For`, mogu se menjati da bi se simulirali zahtevi sa razliÄitih IP adresa.
```bash
X-Originating-IP: 127.0.0.1
X-Forwarded-For: 127.0.0.1
X-Remote-IP: 127.0.0.1
X-Remote-Addr: 127.0.0.1
X-Client-IP: 127.0.0.1
X-Host: 127.0.0.1
X-Forwared-Host: 127.0.0.1

# Double X-Forwarded-For header example
X-Forwarded-For:
X-Forwarded-For: 127.0.0.1
```
### Promena ostalih header-a

PreporuÄuje se izmena ostalih request header-a kao Å¡to su user-agent i cookies, jer se oni takoÄ‘e mogu koristiti za identifikaciju i praÄ‡enje obrazaca zahteva. Promena ovih header-a moÅ¾e spreÄiti prepoznavanje i praÄ‡enje aktivnosti zahtevaoca.

### IskoriÅ¡Ä‡avanje ponaÅ¡anja API gateway-a

Neki API gateway-i su podeÅ¡eni da primenjuju rate limiting na osnovu kombinacije endpointa i parametara. Variranjem vrednosti parametara ili dodavanjem nesignificantnih parametara u zahtev moguÄ‡e je zaobiÄ‡i logiku rate-limitinga gateway-a, tako da svaki zahtev izgleda jedinstveno. Na primer `/resetpwd?someparam=1`.

### Prijavljivanje na nalog pre svakog pokuÅ¡aja

Prijavljivanje na nalog pre svakog pokuÅ¡aja, ili pre svake grupe pokuÅ¡aja, moÅ¾e resetovati brojaÄ rate limita. Ovo je posebno korisno pri testiranju login funkcionalnosti. KoriÅ¡Ä‡enje Pitchfork attack-a u alatima poput Burp Suite, za rotiranje credentials na svakih nekoliko pokuÅ¡aja i obezbeÄ‘ivanje da je opcija follow redirects oznaÄena, moÅ¾e efikasno restartovati brojaÄe rate limita.

### KoriÅ¡Ä‡enje proxy mreÅ¾a

RasporeÄ‘ivanje mreÅ¾e proxy-ja da bi se zahtevi raspodelili preko viÅ¡e IP adresa moÅ¾e efikasno zaobiÄ‡i IP-based rate limits. Usmeravanjem saobraÄ‡aja kroz razliÄite proxy-je, svaki zahtev izgleda kao da potiÄe iz drugog izvora, Å¡to razvodnjava efikasnost rate limita.

### Raspodela napada preko razliÄitih naloga ili sesija

Ako ciljni sistem primenjuje rate limite po nalogu ili po sesiji, raspodela napada ili testa preko viÅ¡e naloga ili sesija moÅ¾e pomoÄ‡i da se izbegne detekcija. Ovaj pristup zahteva upravljanje viÅ¡e identiteta ili session token-a, ali moÅ¾e efikasno raspodeliti optereÄ‡enje da ostane unutar dozvoljenih limita.

### Ne odustaj

Imajte na umu da Äak i ako postoji rate limit, treba pokuÅ¡ati da proverite da li je odgovor drugaÄiji kada se poÅ¡alje validan OTP. U [**this post**](https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732), bug hunter je otkrio da Äak i ako se rate limit aktivira nakon 20 neuspeÅ¡nih pokuÅ¡aja vraÄ‡ajuÄ‡i 401, ako je poslat validan dobio se 200 odgovor.

---

### Zloupotreba HTTP/2 multiplexing & request pipelining (2023-2025)

Moderne rateâ€“limiter implementacije Äesto broje **TCP connections** (ili Äak pojedinaÄne HTTP/1.1 requests) umesto *broja HTTP/2 streams* koje konekcija sadrÅ¾i. Kada se ista TLS konekcija ponovo koristi, attacker moÅ¾e otvoriti stotine paralelnih stream-ova, svaki sa posebnim zahtevom, dok gateway skida samo *jedan* zahtev iz kvote.
```bash
# Send 100 POST requests in a single HTTP/2 connection with curl
seq 1 100 | xargs -I@ -P0 curl -k --http2-prior-knowledge -X POST \
-H "Content-Type: application/json" \
-d '{"code":"@"}' https://target/api/v2/verify &>/dev/null
```
Ako limiter Å¡titi samo `/verify`, ali ne i `/api/v2/verify`, moÅ¾ete kombinovati **path confusion** sa HTTP/2 multiplexingom za *izuzetno* brzo OTP ili credential brute-forcing.

> ğŸ¾  **Savet:** PortSwiggerâ€™s [Turbo Intruder](https://portswigger.net/research/turbo-intruder) podrÅ¾ava HTTP/2 i omoguÄ‡ava fino podeÅ¡avanje `maxConcurrentConnections` i `requestsPerConnection` da biste automatizovali ovaj napad.

### GraphQL aliases & batched operations

GraphQL omoguÄ‡ava klijentu da poÅ¡alje **viÅ¡e logiÄki nezavisnih queries ili mutations u jednom requestu** tako Å¡to ih prefiksira *aliases*. PoÅ¡to server izvrÅ¡ava svaki alias, a rate-limiter Äesto raÄuna samo *jedan* request, ovo je pouzdan naÄin za zaobilaÅ¾enje throttlinga pri loginu ili password-resetu.
```graphql
mutation bruteForceOTP {
a: verify(code:"111111") { token }
b: verify(code:"222222") { token }
c: verify(code:"333333") { token }
# â€¦ add up to dozens of aliases â€¦
}
```
Pogledajte odgovor: taÄno jedan alias Ä‡e vratiti 200 OK kada se pogodi ispravan kod, dok su ostali rate-limited.

Tehnika je popularizovana PortSwigger-ovim istraÅ¾ivanjem o â€œGraphQL batching & aliasesâ€ iz 2023. i odgovorna je za mnoge nedavne bug-bounty payouts.

### Zloupotreba *batch* ili *bulk* REST endpoints

Neki API-ji izlaÅ¾u pomoÄ‡ne endpoints kao Å¡to su `/v2/batch` ili prihvataju **niz objekata** u telu zahteva. Ako je limiter postavljen samo ispred *nasleÄ‘enih* endpoints, pakovanje viÅ¡e operacija unutar jednog bulk request moÅ¾e potpuno zaobiÄ‡i zaÅ¡titu.
```json
[
{"path": "/login", "method": "POST", "body": {"user":"bob","pass":"123"}},
{"path": "/login", "method": "POST", "body": {"user":"bob","pass":"456"}}
]
```
### Timing the sliding-window

KlasiÄan token-bucket ili leaky-bucket limiter *se resetuje* na fiksnoj vremenskoj granici (na primer, svake minute). Ako je window poznat (npr. putem poruka o greÅ¡ci kao `X-RateLimit-Reset: 27`), poÅ¡aljite maksimalan dozvoljeni broj zahteva **upravo pre** nego Å¡to se bucket resetuje, zatim odmah poÅ¡aljite joÅ¡ jedan puni nalet.
```
|<-- 60 s window â€‘->|<-- 60 s window â€‘->|
######                 ######
```
This simple optimisation can more than double your throughput without touching any other bypass technique.

### Upgrading to WebSockets / gRPC streaming after the handshake

Mnogi edge rate-limiters proveravaju samo **initial HTTP request**. Kada se konekcija nadogradi na WebSocket (HTTP 101) ili gRPC bidirectional streaming, naredne poruke Äesto zaobilaze request-per-second counters zato Å¡to viÅ¡e nisu zasebni HTTP zahtevi. Cloudflare-ova dokumentacija navodi da je samo initial upgrade request podloÅ¾an WAF/rate-limiting pravilima; frames poslati nakon toga su neÄitljivi.

PraktiÄan workflow:
```bash
# Flood 1,000 OTP guesses through a single WebSocket connection
seq -w 000000 000999 | websocat -n ws://target.tld/api/verify-ws

# gRPC streaming: send multiple Verify requests in one stream
grpcurl -d @ -plaintext target.tld:50051 service.VerifyOTP/Stream <<'EOF'
{ "code": "111111" }
{ "code": "222222" }
{ "code": "333333" }
EOF
```
Ako login/OTP endpoint izlaÅ¾e i HTTP i WebSocket/gRPC varijante, prvo uspostavite upgraded kanal, pa zatim spray kodove unutar te jedne konekcije da biste izbegli per-request throttles.

### IskoriÅ¡Ä‡avanje CDN PoPâ€‘sharded counters

Neki CDNs sharduju rate-limit counters po data center/PoP umesto globalno. Cloudflare eksplicitno navodi da se counters ne dele across data centers. Preusmeravanjem zahteva kroz egress nodes u viÅ¡e regiona (residential proxy pools, anycast VPNs, or cloud VMs pinned to different continents), mnoÅ¾ite dozvoljeni throughput: svaki PoP odrÅ¾ava nezavisan bucket za isti key.

Quick and dirty layout using open proxies (example with `proxychains` + a countryâ€‘rotating list):
```bash
for p in $(cat proxies.txt); do
HTTPS_PROXY=$p curl -s -X POST https://target/api/login -d @payload.json &
done
wait
```
Pobrinite se da limiter key nije per-account; u suprotnom, rotirajte i user IDs / session tokens.

---

## Alati

- [**https://github.com/Hashtag-AMIN/hashtag-fuzz**](https://github.com/Hashtag-AMIN/hashtag-fuzz): Fuzzing alat koji podrÅ¾ava header randomisation, chunked word-lists i round-robin proxy rotation.
- [**https://github.com/ustayready/fireprox**](https://github.com/ustayready/fireprox): Automatski kreira disposable AWS API Gateway endpoints tako da svaki request potiÄe sa razliÄite IP adrese â€“ idealno za zaobilaÅ¾enje IP-based throttling.
- **Burp Suite â€“ IPRotate + extension**: Koristi pool SOCKS/HTTP proxies (ili AWS API Gateway) za rotaciju source IP-a transparentno tokom *Intruder* i *Turbo Intruder* napada.
- **Turbo Intruder (BApp)**: High-performance attack engine koji podrÅ¾ava HTTP/2 multiplexing; podesite `requestsPerConnection` na 100-1000 da objedinite stotine requests u jednu konekciju.

## Reference

- [PortSwigger Research â€“ â€œBypassing rate limits with GraphQL aliasingâ€ (2023)](https://portswigger.net/research/graphql-authorization-bypass)
- [PortSwigger Research â€“ â€œHTTP/2: The Sequel is Always Worseâ€ (connection-based throttling) (2024)](https://portswigger.net/research/http2)
- [Cloudflare Docs â€“ WebSockets & WAF applicability (2025)](https://developers.cloudflare.com/network/websockets/)
- [Cloudflare Docs â€“ Request rate calculation and PoP-local counters (2025)](https://developers.cloudflare.com/waf/rate-limiting-rules/request-rate/)

{{#include ../banners/hacktricks-training.md}}
