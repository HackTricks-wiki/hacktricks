# Rate Limit Bypass

{{#include ../banners/hacktricks-training.md}}

## Rate limit bypass techniques

### Exploring Similar Endpoints

рд▓рдХреНрд╖рд┐рдд рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рд░реВрдкреЛрдВ рдкрд░ рдмреНрд░реВрдЯ рдлреЛрд░реНрд╕ рд╣рдорд▓реЛрдВ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬреИрд╕реЗ рдХрд┐ `/api/v3/sign-up`, рдЬрд┐рд╕рдореЗрдВ рд╡рд┐рдХрд▓реНрдк рдЬреИрд╕реЗ `/Sing-up`, `/SignUp`, `/singup`, `/api/v1/sign-up`, `/api/sign-up` рдЖрджрд┐ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред

### Incorporating Blank Characters in Code or Parameters

рдХреЛрдб рдпрд╛ рдкреИрд░рд╛рдореАрдЯрд░ рдореЗрдВ `%00`, `%0d%0a`, `%0d`, `%0a`, `%09`, `%0C`, `%20` рдЬреИрд╕реЗ рдЦрд╛рд▓реА рдмрд╛рдЗрдЯреНрд╕ рдбрд╛рд▓рдирд╛ рдПрдХ рдЙрдкрдпреЛрдЧреА рд░рдгрдиреАрддрд┐ рд╣реЛ рд╕рдХрддреА рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ `code=1234%0a` рдореЗрдВ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рдирд╛ рдЗрдирдкреБрдЯ рдореЗрдВ рднрд┐рдиреНрдирддрд╛рдУрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рдпрд╛рд╕реЛрдВ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдИрдореЗрд▓ рдкрддреЗ рдореЗрдВ рдирдИ рдкрдВрдХреНрддрд┐ рдХреЗ рдЕрдХреНрд╖рд░ рдЬреЛрдбрд╝рдирд╛ рддрд╛рдХрд┐ рдкреНрд░рдпрд╛рд╕ рд╕реАрдорд╛рдУрдВ рдХреЛ рдкрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред

### Manipulating IP Origin via Headers

рд╣реЗрдбрд░ рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдирд╛ рддрд╛рдХрд┐ рдзрд╛рд░рд┐рдд IP рдореВрд▓ рдХреЛ рдмрджрд▓рд╛ рдЬрд╛ рд╕рдХреЗ, IP-рдЖрдзрд╛рд░рд┐рдд рджрд░ рд╕реАрдорд╛рдУрдВ рд╕реЗ рдмрдЪрдиреЗ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддрд╛ рд╣реИред рд╣реЗрдбрд░ рдЬреИрд╕реЗ `X-Originating-IP`, `X-Forwarded-For`, `X-Remote-IP`, `X-Remote-Addr`, `X-Client-IP`, `X-Host`, `X-Forwared-Host`, рдЬрд┐рд╕рдореЗрдВ `X-Forwarded-For` рдХреЗ рдХрдИ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ, рд╡рд┐рднрд┐рдиреНрди IPs рд╕реЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
```bash
X-Originating-IP: 127.0.0.1
X-Forwarded-For: 127.0.0.1
X-Remote-IP: 127.0.0.1
X-Remote-Addr: 127.0.0.1
X-Client-IP: 127.0.0.1
X-Host: 127.0.0.1
X-Forwared-Host: 127.0.0.1

# Double X-Forwarded-For header example
X-Forwarded-For:
X-Forwarded-For: 127.0.0.1
```
### рдЕрдиреНрдп рд╣реЗрдбрд░ рдмрджрд▓рдирд╛

рдЕрдиреНрдп рдЕрдиреБрд░реЛрдз рд╣реЗрдбрд░ рдЬреИрд╕реЗ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рдПрдЬреЗрдВрдЯ рдФрд░ рдХреБрдХреАрдЬрд╝ рдХреЛ рдмрджрд▓рдирд╛ рдЕрдиреБрд╢рдВрд╕рд┐рдд рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЗрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдиреБрд░реЛрдз рдкреИрдЯрд░реНрди рдХреА рдкрд╣рдЪрд╛рди рдФрд░ рдЯреНрд░реИрдХрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЗрди рд╣реЗрдбрд░реНрд╕ рдХреЛ рдмрджрд▓рдиреЗ рд╕реЗ рдЕрдиреБрд░реЛрдзрдХрд░реНрддрд╛ рдХреА рдЧрддрд┐рд╡рд┐рдзрд┐рдпреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдФрд░ рдЯреНрд░реИрдХрд┐рдВрдЧ рдХреЛ рд░реЛрдХрдиреЗ рдореЗрдВ рдорджрдж рдорд┐рд▓ рд╕рдХрддреА рд╣реИред

### API рдЧреЗрдЯрд╡реЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд╛ рд▓рд╛рдн рдЙрдард╛рдирд╛

рдХреБрдЫ API рдЧреЗрдЯрд╡реЗ рдХреЛ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдФрд░ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рдВрдпреЛрдЬрди рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рджрд░ рд╕реАрдорд╛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдкреИрд░рд╛рдореАрдЯрд░ рдорд╛рдиреЛрдВ рдХреЛ рдмрджрд▓рдХрд░ рдпрд╛ рдЕрдиреБрд░реЛрдз рдореЗрдВ рдЧреИрд░-рдкреНрд░рдореБрдЦ рдкреИрд░рд╛рдореАрдЯрд░ рдЬреЛрдбрд╝рдХрд░, рдЧреЗрдЯрд╡реЗ рдХреА рджрд░-рд╕реАрдорд┐рдд рд▓реЙрдЬрд┐рдХ рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрд░реЛрдз рдЕрджреНрд╡рд┐рддреАрдп рдкреНрд░рддреАрдд рд╣реЛрддрд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП `/resetpwd?someparam=1`ред

### рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рдпрд╛рд╕ рд╕реЗ рдкрд╣рд▓реЗ рдЕрдкрдиреЗ рдЦрд╛рддреЗ рдореЗрдВ рд▓реЙрдЧ рдЗрди рдХрд░рдирд╛

рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рдпрд╛рд╕ рд╕реЗ рдкрд╣рд▓реЗ рдпрд╛ рдкреНрд░рдпрд╛рд╕реЛрдВ рдХреЗ рд╣рд░ рд╕реЗрдЯ рд╕реЗ рдкрд╣рд▓реЗ рдПрдХ рдЦрд╛рддреЗ рдореЗрдВ рд▓реЙрдЧ рдЗрди рдХрд░рдирд╛ рджрд░ рд╕реАрдорд╛ рдХрд╛рдЙрдВрдЯрд░ рдХреЛ рд░реАрд╕реЗрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рд▓реЙрдЧрд┐рди рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛рдУрдВ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рддреЗ рд╕рдордп рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧреА рд╣реИред Burp Suite рдЬреИрд╕реЗ рдЙрдкрдХрд░рдгреЛрдВ рдореЗрдВ рдПрдХ рдкрд┐рдЪрдлреЛрд░реНрдХ рд╣рдорд▓реЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рд╣рд░ рдХреБрдЫ рдкреНрд░рдпрд╛рд╕реЛрдВ рдореЗрдВ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕ рдХреЛ рдШреБрдорд╛рдирд╛ рдФрд░ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рдХрд┐ рдлреЙрд▓реЛ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯреНрд╕ рдХреЛ рдЪрд┐рд╣реНрдирд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рджрд░ рд╕реАрдорд╛ рдХрд╛рдЙрдВрдЯрд░ рдХреЛ рдкреНрд░рднрд╛рд╡реА рдврдВрдЧ рд╕реЗ рдкреБрдирдГ рдкреНрд░рд╛рд░рдВрдн рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### рдкреНрд░реЙрдХреНрд╕реА рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛

рдХрдИ IP рдкрддреЛрдВ рдХреЗ рдмреАрдЪ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рд╡рд┐рддрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЙрдХреНрд╕реА рдХрд╛ рдПрдХ рдиреЗрдЯрд╡рд░реНрдХ рддреИрдирд╛рдд рдХрд░рдирд╛ IP-рдЖрдзрд╛рд░рд┐рдд рджрд░ рд╕реАрдорд╛рдУрдВ рдХреЛ рдкреНрд░рднрд╛рд╡реА рдврдВрдЧ рд╕реЗ рдмрд╛рдпрдкрд╛рд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИред рд╡рд┐рднрд┐рдиреНрди рдкреНрд░реЙрдХреНрд╕рд┐рдпреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЯреНрд░реИрдлрд╝рд┐рдХ рдХреЛ рд░реВрдЯ рдХрд░рдХреЗ, рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрд░реЛрдз рдПрдХ рдЕрд▓рдЧ рд╕реНрд░реЛрдд рд╕реЗ рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реБрдЖ рдкреНрд░рддреАрдд рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рджрд░ рд╕реАрдорд╛ рдХреА рдкреНрд░рднрд╛рд╡рд╢реАрд▓рддрд╛ рдХрдо рд╣реЛ рдЬрд╛рддреА рд╣реИред

### рд╡рд┐рднрд┐рдиреНрди рдЦрд╛рддреЛрдВ рдпрд╛ рд╕рддреНрд░реЛрдВ рдХреЗ рдмреАрдЪ рд╣рдорд▓реЗ рдХреЛ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░рдирд╛

рдпрджрд┐ рд▓рдХреНрд╖рд┐рдд рдкреНрд░рдгрд╛рд▓реА рдкреНрд░рддрд┐-рдЦрд╛рддрд╛ рдпрд╛ рдкреНрд░рддрд┐-рд╕рддреНрд░ рдЖрдзрд╛рд░ рдкрд░ рджрд░ рд╕реАрдорд╛рдПрдБ рд▓рд╛рдЧреВ рдХрд░рддреА рд╣реИ, рддреЛ рдХрдИ рдЦрд╛рддреЛрдВ рдпрд╛ рд╕рддреНрд░реЛрдВ рдХреЗ рдмреАрдЪ рд╣рдорд▓реЗ рдпрд╛ рдкрд░реАрдХреНрд╖рдг рдХреЛ рд╡рд┐рддрд░рд┐рдд рдХрд░рдирд╛ рдкрд╣рдЪрд╛рди рд╕реЗ рдмрдЪрдиреЗ рдореЗрдВ рдорджрдж рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЗ рд▓рд┐рдП рдХрдИ рдкрд╣рдЪрд╛рди рдпрд╛ рд╕рддреНрд░ рдЯреЛрдХрди рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдЕрдиреБрдореЗрдп рд╕реАрдорд╛рдУрдВ рдХреЗ рднреАрддрд░ рд░рд╣рдиреЗ рдХреЗ рд▓рд┐рдП рд▓реЛрдб рдХреЛ рдкреНрд░рднрд╛рд╡реА рдврдВрдЧ рд╕реЗ рд╡рд┐рддрд░рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

### рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд░рд╣рдирд╛

рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рднрд▓реЗ рд╣реА рджрд░ рд╕реАрдорд╛ рд▓рд╛рдЧреВ рд╣реЛ, рдЖрдкрдХреЛ рдпрд╣ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рдпрд╛рд╕ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдХреНрдпрд╛ рдЬрдм рдорд╛рдиреНрдп OTP рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЕрд▓рдЧ рд╣реЛрддреА рд╣реИред [**рдЗрд╕ рдкреЛрд╕реНрдЯ**](https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732) рдореЗрдВ, рдмрдЧ рд╢рд┐рдХрд╛рд░реА рдиреЗ рдЦреЛрдЬрд╛ рдХрд┐ рднрд▓реЗ рд╣реА 20 рдЕрд╕рдлрд▓ рдкреНрд░рдпрд╛рд╕реЛрдВ рдХреЗ рдмрд╛рдж рджрд░ рд╕реАрдорд╛ рд╕рдХреНрд░рд┐рдп рд╣реЛ рдЬрд╛рддреА рд╣реИ рдФрд░ 401 рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдорд┐рд▓рддреА рд╣реИ, рдпрджрд┐ рдорд╛рдиреНрдп OTP рднреЗрдЬрд╛ рдЧрдпрд╛ рддреЛ 200 рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддреА рд╣реИред

---

### HTTP/2 рдорд▓реНрдЯреАрдкреНрд▓реЗрдХреНрд╕рд┐рдВрдЧ рдФрд░ рдЕрдиреБрд░реЛрдз рдкрд╛рдЗрдкрд▓рд╛рдЗрдирд┐рдВрдЧ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ (2023-2025)

рдЖрдзреБрдирд┐рдХ рджрд░-рд╕реАрдорд┐рдд рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдЕрдХреНрд╕рд░ **TCP рдХрдиреЗрдХреНрд╢рдиреЛрдВ** (рдпрд╛ рдпрд╣рд╛рдВ рддрдХ рдХрд┐ рд╡реНрдпрдХреНрддрд┐рдЧрдд HTTP/1.1 рдЕрдиреБрд░реЛрдзреЛрдВ) рдХреА рдЧрд┐рдирддреА рдХрд░рддреЗ рд╣реИрдВ, рдмрдЬрд╛рдп рдЗрд╕рдХреЗ рдХрд┐ рдПрдХ рдХрдиреЗрдХреНрд╢рди рдореЗрдВ *HTTP/2 рд╕реНрдЯреНрд░реАрдо рдХреА рд╕рдВрдЦреНрдпрд╛* рдХрд┐рддрдиреА рд╣реИред рдЬрдм рд╡рд╣реА TLS рдХрдиреЗрдХреНрд╢рди рдкреБрди: рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рд╕реИрдХрдбрд╝реЛрдВ рд╕рдорд╛рдирд╛рдВрддрд░ рд╕реНрдЯреНрд░реАрдо рдЦреЛрд▓ рд╕рдХрддрд╛ рд╣реИ, рдкреНрд░рддреНрдпреЗрдХ рдПрдХ рдЕрд▓рдЧ рдЕрдиреБрд░реЛрдз рд▓реЗ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рдЬрдмрдХрд┐ рдЧреЗрдЯрд╡реЗ рдХреЗрд╡рд▓ *рдПрдХ* рдЕрдиреБрд░реЛрдз рдХреЛ рдХреЛрдЯрд╛ рд╕реЗ рдШрдЯрд╛рддрд╛ рд╣реИред
```bash
# Send 100 POST requests in a single HTTP/2 connection with curl
seq 1 100 | xargs -I@ -P0 curl -k --http2-prior-knowledge -X POST \
-H "Content-Type: application/json" \
-d '{"code":"@"}' https://target/api/v2/verify &>/dev/null
```
рдпрджрд┐ рд▓рд┐рдорд┐рдЯрд░ рдХреЗрд╡рд▓ `/verify` рдХреА рд░рдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди `/api/v2/verify` рдХреА рдирд╣реАрдВ, рддреЛ рдЖрдк **рдкрде рднреНрд░рдо** рдХреЛ HTTP/2 рдорд▓реНрдЯреАрдкреНрд▓реЗрдХреНрд╕рд┐рдВрдЧ рдХреЗ рд╕рд╛рде *рдЕрддреНрдпрдзрд┐рдХ* рдЙрдЪреНрдЪ рдЧрддрд┐ OTP рдпрд╛ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓ рдмреНрд░реВрдЯ-рдлреЛрд░реНрд╕рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рд╕рдВрдпреЛрдЬрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред

> ЁЯР╛  **рдЯрд┐рдк:** PortSwigger рдХрд╛ [Turbo Intruder](https://portswigger.net/research/turbo-intruder) HTTP/2 рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЖрдкрдХреЛ рдЗрд╕ рд╣рдорд▓реЗ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП `maxConcurrentConnections` рдФрд░ `requestsPerConnection` рдХреЛ рдареАрдХ рд╕реЗ рд╕рдорд╛рдпреЛрдЬрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

### GraphQL рдЙрдкрдирд╛рдо рдФрд░ рдмреИрдЪ рдСрдкрд░реЗрд╢рдВрд╕

GraphQL рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ **рдПрдХрд▓ рдЕрдиреБрд░реЛрдз рдореЗрдВ рдХрдИ рддрд╛рд░реНрдХрд┐рдХ рд░реВрдк рд╕реЗ рд╕реНрд╡рддрдВрддреНрд░ рдкреНрд░рд╢реНрди рдпрд╛ рдореНрдпреВрдЯреЗрд╢рди рднреЗрдЬрдиреЗ** рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рдиреНрд╣реЗрдВ *рдЙрдкрдирд╛рдо* рдХреЗ рд╕рд╛рде рдкреВрд░реНрд╡рд╡рд░реНрддреА рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдХреНрдпреЛрдВрдХрд┐ рд╕рд░реНрд╡рд░ рд╣рд░ рдЙрдкрдирд╛рдо рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рд░реЗрдЯ-рд▓рд┐рдорд┐рдЯрд░ рдЕрдХреНрд╕рд░ рдХреЗрд╡рд▓ *рдПрдХ* рдЕрдиреБрд░реЛрдз рдХреА рдЧрд┐рдирддреА рдХрд░рддрд╛ рд╣реИ, рдпрд╣ рд▓реЙрдЧрд┐рди рдпрд╛ рдкрд╛рд╕рд╡рд░реНрдб-рд░реАрд╕реЗрдЯ рдереНрд░реЙрдЯрд▓рд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдмрд╛рдИрдкрд╛рд╕ рд╣реИред
```graphql
mutation bruteForceOTP {
a: verify(code:"111111") { token }
b: verify(code:"222222") { token }
c: verify(code:"333333") { token }
# тАж add up to dozens of aliases тАж
}
```
рджреЗрдЦреЗрдВ, рдЬрдм рд╕рд╣реА рдХреЛрдб рд╣рд┐рдЯ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдареАрдХ рдПрдХ рдЙрдкрдирд╛рдо 200 OK рд▓реМрдЯрд╛рдПрдЧрд╛, рдЬрдмрдХрд┐ рдЕрдиреНрдп рдХреЛ рджрд░-рд╕реАрдорд╛ рдореЗрдВ рд░рдЦрд╛ рдЧрдпрд╛ рд╣реИред

рдпрд╣ рддрдХрдиреАрдХ 2023 рдореЗрдВ PortSwigger рдХреЗ "GraphQL batching & aliases" рдкрд░ рд╢реЛрдз рджреНрд╡рд╛рд░рд╛ рд▓реЛрдХрдкреНрд░рд┐рдп рд╣реБрдИ рдФрд░ рд╣рд╛рд▓ рдХреЗ рдХрдИ рдмрдЧ-рдмрд╛рдЙрдВрдЯреА рднреБрдЧрддрд╛рди рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд░рд╣реА рд╣реИред

### *batch* рдпрд╛ *bulk* REST рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ

рдХреБрдЫ APIs рд╕рд╣рд╛рдпрдХ рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдЬреИрд╕реЗ `/v2/batch` рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рддреЗ рд╣реИрдВ рдпрд╛ рдЕрдиреБрд░реЛрдз рд╢рд░реАрд░ рдореЗрдВ **рд╡рд╕реНрддреБрдУрдВ рдХреА рдПрдХ рд╕рд░рдгреА** рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддреЗ рд╣реИрдВред рдпрджрд┐ рд╕реАрдорд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдХреЗрд╡рд▓ *legacy* рдПрдВрдбрдкреЙрдЗрдВрдЯреНрд╕ рдХреЗ рд╕рд╛рдордиреЗ рд░рдЦрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдПрдХрд▓ рдмрд▓реНрдХ рдЕрдиреБрд░реЛрдз рдХреЗ рдЕрдВрджрд░ рдХрдИ рд╕рдВрдЪрд╛рд▓рди рдХреЛ рд▓рдкреЗрдЯрдирд╛ рд╕реБрд░рдХреНрд╖рд╛ рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рджрд░рдХрд┐рдирд╛рд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИред
```json
[
{"path": "/login", "method": "POST", "body": {"user":"bob","pass":"123"}},
{"path": "/login", "method": "POST", "body": {"user":"bob","pass":"456"}}
]
```
### Timing the sliding-window

рдПрдХ рдХреНрд▓рд╛рд╕рд┐рдХ рдЯреЛрдХрди-рдмрдХреЗрдЯ рдпрд╛ рд▓реАрдХ-рдмрдХреЗрдЯ рд▓рд┐рдорд┐рдЯрд░ *рд░реАрд╕реЗрдЯ* рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рд╕рдордп рд╕реАрдорд╛ рдкрд░ рд╣реЛрддрд╛ рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╣рд░ рдорд┐рдирдЯ)ред рдпрджрд┐ рд╡рд┐рдВрдбреЛ рдЬреНрдЮрд╛рдд рд╣реИ (рдЬреИрд╕реЗ рдХрд┐ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢реЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬреИрд╕реЗ `X-RateLimit-Reset: 27`), рддреЛ рдмрдХреЗрдЯ рд░реАрд╕реЗрдЯ рд╣реЛрдиреЗ рд╕реЗ **рдкрд╣рд▓реЗ** рдЕрдзрд┐рдХрддрдо рдЕрдиреБрдорддрд┐ рдкреНрд░рд╛рдкреНрдд рдЕрдиреБрд░реЛрдзреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдлрд╛рдпрд░ рдХрд░реЗрдВ, рдлрд┐рд░ рддреБрд░рдВрдд рдПрдХ рдФрд░ рдкреВрд░реНрдг рдмрд░реНрд╕реНрдЯ рдлрд╛рдпрд░ рдХрд░реЗрдВред
```
|<-- 60 s window тАС->|<-- 60 s window тАС->|
######                 ######
```
рдпрд╣ рд╕рд░рд▓ рдСрдкреНрдЯрд┐рдорд╛рдЗрдЬреЗрд╢рди рдЖрдкрдХреЗ рдереНрд░реВрдкреБрдЯ рдХреЛ рдЕрдиреНрдп рдмрд╛рдпрдкрд╛рд╕ рддрдХрдиреАрдХ рдХреЛ рдЫреБрдП рдмрд┐рдирд╛ рджреЛрдЧреБрдирд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

---

## Tools

- [**https://github.com/Hashtag-AMIN/hashtag-fuzz**](https://github.com/Hashtag-AMIN/hashtag-fuzz): рдлрдЬрд╝рд┐рдВрдЧ рдЯреВрд▓ рдЬреЛ рд╣реЗрдбрд░ рд░реИрдВрдбрдорд╛рдЗрдЬреЗрд╢рди, рдЪрдВрдХреНрдб рд╡рд░реНрдб-рд▓рд┐рд╕реНрдЯ рдФрд░ рд░рд╛рдЙрдВрдб-рд░реЙрдмрд┐рди рдкреНрд░реЙрдХреНрд╕реА рд░реЛрдЯреЗрд╢рди рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред
- [**https://github.com/ustayready/fireprox**](https://github.com/ustayready/fireprox): рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдбрд┐рд╕реНрдкреЛрдЬреЗрдмрд▓ AWS API рдЧреЗрдЯрд╡реЗ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдмрдирд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рд╣рд░ рдЕрдиреБрд░реЛрдз рдПрдХ рдЕрд▓рдЧ IP рдкрддреЗ рд╕реЗ рдЙрддреНрдкрдиреНрди рд╣реЛ тАУ IP-рдЖрдзрд╛рд░рд┐рдд рдереНрд░реЙрдЯрд▓рд┐рдВрдЧ рдХреЛ рд╣рд░рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХрджрдо рд╕рд╣реАред
- **Burp Suite тАУ IPRotate + extension**: *Intruder* рдФрд░ *Turbo Intruder* рд╣рдорд▓реЛрдВ рдХреЗ рджреМрд░рд╛рди рд╕реНрд░реЛрдд IP рдХреЛ рдкрд╛рд░рджрд░реНрд╢реА рд░реВрдк рд╕реЗ рдШреБрдорд╛рдиреЗ рдХреЗ рд▓рд┐рдП SOCKS/HTTP рдкреНрд░реЙрдХреНрд╕рд┐рдпреЛрдВ (рдпрд╛ AWS API рдЧреЗрдЯрд╡реЗ) рдХрд╛ рдПрдХ рдкреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред
- **Turbo Intruder (BApp)**: HTTP/2 рдорд▓реНрдЯреАрдкреНрд▓реЗрдХреНрд╕рд┐рдВрдЧ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдЙрдЪреНрдЪ-рдкреНрд░рджрд░реНрд╢рди рд╣рдорд▓рд╛ рдЗрдВрдЬрди; рд╕реИрдХрдбрд╝реЛрдВ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдПрдХрд▓ рдХрдиреЗрдХреНрд╢рди рдореЗрдВ рд╕рдореЗрдЯрдиреЗ рдХреЗ рд▓рд┐рдП `requestsPerConnection` рдХреЛ 100-1000 рдкрд░ рдЯреНрдпреВрди рдХрд░реЗрдВред

## References

- PortSwigger Research тАУ тАЬBypassing rate limits with GraphQL aliasingтАЭ  (2023)  <https://portswigger.net/research/graphql-authorization-bypass>
- PortSwigger Research тАУ тАЬHTTP/2: The Sequel is Always WorseтАЭ (section *Connection-based throttling*) (2024)  <https://portswigger.net/research/http2>

{{#include ../banners/hacktricks-training.md}}
