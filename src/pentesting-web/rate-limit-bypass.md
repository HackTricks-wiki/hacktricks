# Î Î±ÏÎ¬ÎºÎ±Î¼ÏˆÎ· Rate Limit

{{#include ../banners/hacktricks-training.md}}

## Î¤ÎµÏ‡Î½Î¹ÎºÎ­Ï‚ Ï€Î±ÏÎ¬ÎºÎ±Î¼ÏˆÎ·Ï‚ Rate limit

### Î•Î¾ÎµÏÎµÏÎ½Î·ÏƒÎ· Ï€Î±ÏÏŒÎ¼Î¿Î¹Ï‰Î½ Endpoints

Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Î³Î¯Î½Î¿Ï…Î½ Ï€ÏÎ¿ÏƒÏ€Î¬Î¸ÎµÎ¹ÎµÏ‚ Î³Î¹Î± Ï„Î·Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ· brute force attacks ÏƒÎµ Ï€Î±ÏÎ±Î»Î»Î±Î³Î­Ï‚ Ï„Î¿Ï… ÏƒÏ„Î¿Ï‡ÎµÏ…Î¼Î­Î½Î¿Ï… endpoint, ÏŒÏ€Ï‰Ï‚ `/api/v3/sign-up`, ÏƒÏ…Î¼Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î±Î½Î¿Î¼Î­Î½Ï‰Î½ ÎµÎ½Î±Î»Î»Î±ÎºÏ„Î¹ÎºÏÎ½ ÏŒÏ€Ï‰Ï‚ `/Sing-up`, `/SignUp`, `/singup`, `/api/v1/sign-up`, `/api/sign-up` Îº.Î»Ï€.

### Î•Î½ÏƒÏ‰Î¼Î¬Ï„Ï‰ÏƒÎ· ÎºÎµÎ½ÏÎ½ Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÏ‰Î½ ÏƒÎµ Code Î® Parameters

Î— ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® ÎºÎµÎ½ÏÎ½ bytes ÏŒÏ€Ï‰Ï‚ `%00`, `%0d%0a`, `%0d`, `%0a`, `%09`, `%0C`, `%20` ÏƒÎµ code Î® parameters Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Ï‡ÏÎ®ÏƒÎ¹Î¼Î· ÏƒÏ„ÏÎ±Ï„Î·Î³Î¹ÎºÎ®. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±, Î· ÏÏÎ¸Î¼Î¹ÏƒÎ· ÎµÎ½ÏŒÏ‚ parameter ÏƒÎµ `code=1234%0a` ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î· Î´Î¹ÎµÏÏÏ…Î½ÏƒÎ· Ï„Ï‰Î½ Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¹ÏÎ½ Î¼Î­ÏƒÏ‰ Ï€Î±ÏÎ±Î»Î»Î±Î³ÏÎ½ ÏƒÏ„Î·Î½ ÎµÎ¯ÏƒÎ¿Î´Î¿, ÏŒÏ€Ï‰Ï‚ Î· Ï€ÏÎ¿ÏƒÎ¸Î®ÎºÎ· newline Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÏ‰Î½ ÏƒÎµ Î­Î½Î± email Î³Î¹Î± Î½Î± Ï€Î±ÏÎ±ÎºÎ±Î¼Ï†Î¸Î¿ÏÎ½ Î¿Î¹ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÎ¼Î¿Î¯ Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¹ÏÎ½.

### Î Î±ÏÎ±Ï€Î¿Î¯Î·ÏƒÎ· Ï€ÏÎ¿Î­Î»ÎµÏ…ÏƒÎ·Ï‚ IP Î¼Î­ÏƒÏ‰ Headers

Î— Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¯Î·ÏƒÎ· Ï„Ï‰Î½ headers Î³Î¹Î± Î½Î± Î±Î»Î»Î¬Î¾ÎµÎ¹ Î· Î±Î½Ï„Î¹Î»Î·Ï€Ï„Î® Ï€ÏÎ¿Î­Î»ÎµÏ…ÏƒÎ· IP Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î²Î¿Î·Î¸Î®ÏƒÎµÎ¹ ÏƒÏ„Î·Î½ Î±Ï€Î¿Ï†Ï…Î³Î® IP-based rate limiting. Headers ÏŒÏ€Ï‰Ï‚ `X-Originating-IP`, `X-Forwarded-For`, `X-Remote-IP`, `X-Remote-Addr`, `X-Client-IP`, `X-Host`, `X-Forwared-Host`, ÎºÎ±Î¸ÏÏ‚ ÎºÎ±Î¹ Î· Ï‡ÏÎ®ÏƒÎ· Ï€Î¿Î»Î»Î±Ï€Î»ÏÎ½ ÎµÎ¼Ï†Î±Î½Î¯ÏƒÎµÏ‰Î½ Ï„Î¿Ï… `X-Forwarded-For`, Î¼Ï€Î¿ÏÎ¿ÏÎ½ Î½Î± Ï€ÏÎ¿ÏƒÎ±ÏÎ¼Î¿ÏƒÏ„Î¿ÏÎ½ Î³Î¹Î± Î½Î± Ï€ÏÎ¿ÏƒÎ¿Î¼Î¿Î¹ÏÏƒÎ¿Ï…Î½ Î±Î¹Ï„Î®ÏƒÎµÎ¹Ï‚ Î±Ï€ÏŒ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¬ IPs.
```bash
X-Originating-IP: 127.0.0.1
X-Forwarded-For: 127.0.0.1
X-Remote-IP: 127.0.0.1
X-Remote-Addr: 127.0.0.1
X-Client-IP: 127.0.0.1
X-Host: 127.0.0.1
X-Forwared-Host: 127.0.0.1

# Double X-Forwarded-For header example
X-Forwarded-For:
X-Forwarded-For: 127.0.0.1
```
### Î‘Î»Î»Î±Î³Î® Î¬Î»Î»Ï‰Î½ ÎºÎµÏ†Î±Î»Î¯Î´Ï‰Î½

Î£Ï…Î½Î¹ÏƒÏ„Î¬Ï„Î±Î¹ Î· Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î¬Î»Î»Ï‰Î½ request headers ÏŒÏ€Ï‰Ï‚ Ï„Î¿ user-agent ÎºÎ±Î¹ Ï„Î± cookies, ÎºÎ±Î¸ÏÏ‚ Î±Ï…Ï„Î¬ Î¼Ï€Î¿ÏÎ¿ÏÎ½ ÎµÏ€Î¯ÏƒÎ·Ï‚ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸Î¿ÏÎ½ Î³Î¹Î± Ï„Î¿Î½ Ï€ÏÎ¿ÏƒÎ´Î¹Î¿ÏÎ¹ÏƒÎ¼ÏŒ ÎºÎ±Î¹ Ï„Î·Î½ Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ· Ï„Ï‰Î½ Ï€ÏÎ¿Ï„ÏÏ€Ï‰Î½ Î±Î¹Ï„Î®ÏƒÎµÏ‰Î½. Î— Î±Î»Î»Î±Î³Î® Î±Ï…Ï„ÏÎ½ Ï„Ï‰Î½ ÎºÎµÏ†Î±Î»Î¯Î´Ï‰Î½ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Ï€Î¿Ï„ÏÎ­ÏˆÎµÎ¹ Ï„Î·Î½ Î±Î½Î±Î³Î½ÏÏÎ¹ÏƒÎ· ÎºÎ±Î¹ Ï„Î·Î½ Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ· Ï„Ï‰Î½ Î´ÏÎ±ÏƒÏ„Î·ÏÎ¹Î¿Ï„Î®Ï„Ï‰Î½ Ï„Î¿Ï… Î±Î¹Ï„Î¿ÏÎ½Ï„Î¿Ï‚.

### Î•ÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· Ï„Î·Ï‚ ÏƒÏ…Î¼Ï€ÎµÏÎ¹Ï†Î¿ÏÎ¬Ï‚ Ï„Ï‰Î½ API gateways

ÎŸÏÎ¹ÏƒÎ¼Î­Î½Î± API gateways Î­Ï‡Î¿Ï…Î½ ÏÏ…Î¸Î¼Î¹ÏƒÏ„ÎµÎ¯ ÏÏƒÏ„Îµ Î½Î± ÎµÏ†Î±ÏÎ¼ÏŒÎ¶Î¿Ï…Î½ rate limiting Î¼Îµ Î²Î¬ÏƒÎ· Ï„Î¿Î½ ÏƒÏ…Î½Î´Ï…Î±ÏƒÎ¼ÏŒ Ï„Î¿Ï… endpoint ÎºÎ±Î¹ Ï„Ï‰Î½ parameters. ÎœÎµ Ï„Î¿ Î½Î± Î¼ÎµÏ„Î±Î²Î¬Î»Î»ÎµÏ„Îµ Ï„Î¹Ï‚ Ï„Î¹Î¼Î­Ï‚ Ï„Ï‰Î½ Ï€Î±ÏÎ±Î¼Î­Ï„ÏÏ‰Î½ Î® Î½Î± Ï€ÏÎ¿ÏƒÎ¸Î­Ï„ÎµÏ„Îµ Î¼Î·-ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÎ­Ï‚ Ï€Î±ÏÎ±Î¼Î­Ï„ÏÎ¿Ï…Ï‚ ÏƒÏ„Î¿ request, ÎµÎ¯Î½Î±Î¹ Î´Ï…Î½Î±Ï„ÏŒ Î½Î± Ï€Î±ÏÎ±ÎºÎ±Î¼Ï†Î¸ÎµÎ¯ Î· Î»Î¿Î³Î¹ÎºÎ® rate-limiting Ï„Î¿Ï… gateway, ÎºÎ¬Î½Î¿Î½Ï„Î±Ï‚ ÎºÎ¬Î¸Îµ Î±Î¯Ï„Î·ÏƒÎ· Î½Î± Ï†Î±Î¯Î½ÎµÏ„Î±Î¹ Î¼Î¿Î½Î±Î´Î¹ÎºÎ®. Î“Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± `/resetpwd?someparam=1`.

### Î£ÏÎ½Î´ÎµÏƒÎ· ÏƒÏ„Î¿Î½ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒ ÏƒÎ±Ï‚ Ï€ÏÎ¹Î½ Î±Ï€ÏŒ ÎºÎ¬Î¸Îµ Ï€ÏÎ¿ÏƒÏ€Î¬Î¸ÎµÎ¹Î±

Î— ÏƒÏÎ½Î´ÎµÏƒÎ· ÏƒÎµ Î­Î½Î±Î½ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒ Ï€ÏÎ¹Î½ Î±Ï€ÏŒ ÎºÎ¬Î¸Îµ Ï€ÏÎ¿ÏƒÏ€Î¬Î¸ÎµÎ¹Î±, Î® Ï€ÏÎ¹Î½ Î±Ï€ÏŒ ÎºÎ¬Î¸Îµ ÏƒÎµÏ„ Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¹ÏÎ½, Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÏ€Î±Î½Î±Ï†Î­ÏÎµÎ¹ Ï„Î¿Î½ Î¼ÎµÏ„ÏÎ·Ï„Î® rate limit. Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Î¹Î´Î¹Î±Î¯Ï„ÎµÏÎ± Ï‡ÏÎ®ÏƒÎ¹Î¼Î¿ ÏŒÏ„Î±Î½ Î´Î¿ÎºÎ¹Î¼Î¬Î¶ÎµÏ„Îµ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚ login. Î— Ï‡ÏÎ®ÏƒÎ· ÎµÎ½ÏŒÏ‚ Pitchfork attack Î¼Îµ ÎµÏÎ³Î±Î»ÎµÎ¯Î± ÏŒÏ€Ï‰Ï‚ Ï„Î¿ Burp Suite, Î³Î¹Î± Ï€ÎµÏÎ¹ÏƒÏ„ÏÎ¿Ï†Î® credentials ÎºÎ¬Î¸Îµ Î»Î¯Î³ÎµÏ‚ Ï€ÏÎ¿ÏƒÏ€Î¬Î¸ÎµÎ¹ÎµÏ‚ ÎºÎ±Î¹ Î¼Îµ ÏƒÎ®Î¼Î±Î½ÏƒÎ· Ï„Î¿Ï… follow redirects, Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÏ€Î±Î½ÎµÎºÎºÎ¹Î½Î®ÏƒÎµÎ¹ Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î±Ï„Î¹ÎºÎ¬ Ï„Î¿Ï…Ï‚ Î¼ÎµÏ„ÏÎ·Ï„Î­Ï‚ rate limit.

### Î§ÏÎ®ÏƒÎ· Î´Î¹ÎºÏ„ÏÏ‰Î½ Proxy

Î— Î±Î½Î¬Ï€Ï„Ï…Î¾Î· Î´Î¹ÎºÏ„ÏÎ¿Ï… proxies Î³Î¹Î± ÎºÎ±Ï„Î±Î½Î¿Î¼Î® Ï„Ï‰Î½ requests ÏƒÎµ Ï€Î¿Î»Î»Î±Ï€Î»Î­Ï‚ IP Î´Î¹ÎµÏ…Î¸ÏÎ½ÏƒÎµÎ¹Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÎ¹ Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î±Ï„Î¹ÎºÎ¬ Ï„Î± IP-based rate limits. Î”ÏÎ¿Î¼Î¿Î»Î¿Î³ÏÎ½Ï„Î±Ï‚ Ï„Î·Î½ ÎºÎ¯Î½Î·ÏƒÎ· Î¼Î­ÏƒÏ‰ Î´Î¹Î¬Ï†Î¿ÏÏ‰Î½ proxies, ÎºÎ¬Î¸Îµ Î±Î¯Ï„Î·ÏƒÎ· Ï†Î±Î¯Î½ÎµÏ„Î±Î¹ Î½Î± Ï€ÏÎ¿Î­ÏÏ‡ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ® Ï€Î·Î³Î®, Î¼ÎµÎ¹ÏÎ½Î¿Î½Ï„Î±Ï‚ Ï„Î·Î½ Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î±Ï„Î¹ÎºÏŒÏ„Î·Ï„Î± Ï„Î¿Ï… rate limit.

### Î”Î¹Î¬ÏƒÏ€Î±ÏƒÎ· Ï„Î·Ï‚ ÎµÏ€Î¯Î¸ÎµÏƒÎ·Ï‚ ÏƒÎµ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¿ÏÏ‚ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼Î¿ÏÏ‚ Î® sessions

Î•Î¬Î½ Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î±-ÏƒÏ„ÏŒÏ‡Î¿Ï‚ ÎµÏ†Î±ÏÎ¼ÏŒÎ¶ÎµÎ¹ rate limits Î±Î½Î¬ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼ÏŒ Î® Î±Î½Î¬ session, Î· ÎºÎ±Ï„Î±Î½Î¿Î¼Î® Ï„Î·Ï‚ ÎµÏ€Î¯Î¸ÎµÏƒÎ·Ï‚ Î® Ï„Î¿Ï… Ï„ÎµÏƒÏ„ ÏƒÎµ Ï€Î¿Î»Î»Î±Ï€Î»Î¿ÏÏ‚ Î»Î¿Î³Î±ÏÎ¹Î±ÏƒÎ¼Î¿ÏÏ‚ Î® sessions Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î²Î¿Î·Î¸Î®ÏƒÎµÎ¹ ÏƒÏ„Î·Î½ Î±Ï€Î¿Ï†Ï…Î³Î® Î±Î½Î¯Ï‡Î½ÎµÏ…ÏƒÎ·Ï‚. Î‘Ï…Ï„Î® Î· Ï€ÏÎ¿ÏƒÎ­Î³Î³Î¹ÏƒÎ· Î±Ï€Î±Î¹Ï„ÎµÎ¯ Î´Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Ï€Î¿Î»Î»Î±Ï€Î»ÏÎ½ Ï„Î±Ï…Ï„Î¿Ï„Î®Ï„Ï‰Î½ Î® session tokens, Î±Î»Î»Î¬ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎºÎ±Ï„Î±Î½ÎµÎ¼Î·ÌÏƒÎµÎ¹ Î±Ï€Î¿Ï„ÎµÎ»ÎµÏƒÎ¼Î±Ï„Î¹ÎºÎ¬ Ï„Î¿ Ï†Î¿ÏÏ„Î¯Î¿ ÏÏƒÏ„Îµ Î½Î± Ï€Î±ÏÎ±Î¼ÎµÎ¯Î½ÎµÏ„Îµ ÎµÎ½Ï„ÏŒÏ‚ Ï„Ï‰Î½ ÎµÏ€Î¹Ï„ÏÎµÏ€Ï„ÏÎ½ Î¿ÏÎ¯Ï‰Î½.

### Î£Ï…Î½ÎµÏ‡Î¯ÏƒÏ„Îµ Ï„Î¹Ï‚ Ï€ÏÎ¿ÏƒÏ€Î¬Î¸ÎµÎ¹ÎµÏ‚

Î£Î·Î¼ÎµÎ¹ÏÏƒÏ„Îµ ÏŒÏ„Î¹ Î±ÎºÏŒÎ¼Î± ÎºÎ±Î¹ Î±Î½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ rate limit, Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± Î´Î¿ÎºÎ¹Î¼Î¬ÏƒÎµÏ„Îµ Î±Î½ Î· Î±Ï€Î¬Î½Ï„Î·ÏƒÎ· Î´Î¹Î±Ï†Î­ÏÎµÎ¹ ÏŒÏ„Î±Î½ Î±Ï€Î¿ÏƒÏ„Î±Î»ÎµÎ¯ Ï„Î¿ ÏƒÏ‰ÏƒÏ„ÏŒ OTP. Î£Ï„Î¿ [**Î±Ï…Ï„ÏŒ Ï„Î¿ Î¬ÏÎ¸ÏÎ¿**](https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732), Î¿ bug hunter Î±Î½Î±ÎºÎ¬Î»Ï…ÏˆÎµ ÏŒÏ„Î¹ Î±ÎºÏŒÎ¼Î± ÎºÎ¹ Î±Î½ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ rate limit Î¼ÎµÏ„Î¬ Î±Ï€ÏŒ 20 Î±Ï€Î¿Ï„Ï…Ï‡Î·Î¼Î­Î½ÎµÏ‚ Ï€ÏÎ¿ÏƒÏ€Î¬Î¸ÎµÎ¹ÎµÏ‚ Î¼Îµ Î±Ï€Î¬Î½Ï„Î·ÏƒÎ· 401, Î±Î½ ÏƒÏ„Î¬Î»Î¸Î·ÎºÎµ Î· Î­Î³ÎºÏ…ÏÎ· Ï€ÏÎ¿ÏƒÏ€Î¬Î¸ÎµÎ¹Î± Ï„ÏŒÏ„Îµ Î»Î®Ï†Î¸Î·ÎºÎµ Î±Ï€Î¬Î½Ï„Î·ÏƒÎ· 200.

---

### ÎšÎ±Ï„Î¬Ï‡ÏÎ·ÏƒÎ· HTTP/2 multiplexing & request pipelining (2023-2025)

ÎŸÎ¹ ÏƒÏÎ³Ï‡ÏÎ¿Î½ÎµÏ‚ Ï…Î»Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹Ï‚ rateâ€“limiter ÏƒÏ…Ï‡Î½Î¬ Î¼ÎµÏ„ÏÎ¿ÏÎ½ Ï„Î¹Ï‚ **TCP connections** (Î® Î±ÎºÏŒÎ¼Î· ÎºÎ±Î¹ Î¼ÎµÎ¼Î¿Î½Ï‰Î¼Î­Î½Î± HTTP/1.1 requests) Î±Î½Ï„Î¯ Ï„Î¿Ï… *Î±ÏÎ¹Î¸Î¼Î¿Ï Ï„Ï‰Î½ HTTP/2 streams* Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ Î¼Î¯Î± ÏƒÏÎ½Î´ÎµÏƒÎ·. ÎŒÏ„Î±Î½ Î· Î¯Î´Î¹Î± TLS ÏƒÏÎ½Î´ÎµÏƒÎ· ÎµÏ€Î±Î½Î±Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹, Î­Î½Î±Ï‚ attacker Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Î½Î¿Î¯Î¾ÎµÎ¹ ÎµÎºÎ±Ï„Î¿Î½Ï„Î¬Î´ÎµÏ‚ Ï€Î±ÏÎ¬Î»Î»Î·Î»Î± streams, Ï„Î¿ ÎºÎ±Î¸Î­Î½Î± Î¼ÎµÏ„Î±Ï†Î­ÏÎ¿Î½Ï„Î±Ï‚ Î­Î½Î± Î¾ÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„ÏŒ request, ÎµÎ½Ï Ï„Î¿ gateway Î±Ï†Î±Î¹ÏÎµÎ¯ Î¼ÏŒÎ½Î¿ *Î¼Î¯Î±* Î±Î¯Ï„Î·ÏƒÎ· Î±Ï€ÏŒ Ï„Î¿ quota.
```bash
# Send 100 POST requests in a single HTTP/2 connection with curl
seq 1 100 | xargs -I@ -P0 curl -k --http2-prior-knowledge -X POST \
-H "Content-Type: application/json" \
-d '{"code":"@"}' https://target/api/v2/verify &>/dev/null
```
If the limiter protects only `/verify` but not `/api/v2/verify`, you can also combine **path confusion** with HTTP/2 multiplexing for *extremely* high-speed OTP or credential brute-forcing.

> ğŸ¾  **Tip:** PortSwiggerâ€™s [Turbo Intruder](https://portswigger.net/research/turbo-intruder) supports HTTP/2 and lets you fine-tune `maxConcurrentConnections` and `requestsPerConnection` to automate this attack.

### GraphQL ÏˆÎµÏ…Î´ÏÎ½Ï…Î¼Î± & Î¿Î¼Î±Î´Î¿Ï€Î¿Î¹Î·Î¼Î­Î½ÎµÏ‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯ÎµÏ‚

Î¤Î¿ GraphQL ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î¿Î½ client Î½Î± ÏƒÏ„ÎµÎ¯Î»ÎµÎ¹ **Ï€Î¿Î»Î»Î­Ï‚ Î»Î¿Î³Î¹ÎºÎ¬ Î±Î½ÎµÎ¾Î¬ÏÏ„Î·Ï„ÎµÏ‚ queries Î® mutations ÏƒÎµ Î­Î½Î± ÎµÎ½Î¹Î±Î¯Î¿ request** Ï€ÏÎ¿Î¸Î­Ï„Î¿Î½Ï„Î¬Ï‚ Ï„ÎµÏ‚ Î¼Îµ *ÏˆÎµÏ…Î´ÏÎ½Ï…Î¼Î±*. Î•Ï€ÎµÎ¹Î´Î® Î¿ server ÎµÎºÏ„ÎµÎ»ÎµÎ¯ ÎºÎ¬Î¸Îµ ÏˆÎµÏ…Î´ÏÎ½Ï…Î¼Î¿ Î±Î»Î»Î¬ Î¿ rate-limiter ÏƒÏ…Ï‡Î½Î¬ Î¼ÎµÏ„ÏÎ¬ÎµÎ¹ Î¼ÏŒÎ½Î¿ *Î­Î½Î±* request, Î±Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Î±Î¾Î¹ÏŒÏ€Î¹ÏƒÏ„Î· Ï€Î±ÏÎ¬ÎºÎ±Î¼ÏˆÎ· Î³Î¹Î± throttling Ï„Î¿Ï… login Î® Ï„Î¿Ï… password-reset.
```graphql
mutation bruteForceOTP {
a: verify(code:"111111") { token }
b: verify(code:"222222") { token }
c: verify(code:"333333") { token }
# â€¦ add up to dozens of aliases â€¦
}
```
Î”ÎµÎ¯Ï„Îµ Ï„Î·Î½ Î±Ï€Î¬Î½Ï„Î·ÏƒÎ·: Î±ÎºÏÎ¹Î²ÏÏ‚ Î­Î½Î± alias Î¸Î± ÎµÏ€Î¹ÏƒÏ„ÏÎ­ÏˆÎµÎ¹ 200 OK ÏŒÏ„Î±Î½ Î¿ ÏƒÏ‰ÏƒÏ„ÏŒÏ‚ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚ Ï‡Ï„Ï…Ï€Î·Î¸ÎµÎ¯, ÎµÎ½Ï Ï„Î± Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î± ÎµÎ¯Î½Î±Î¹ rate-limited.

Î— Ï„ÎµÏ‡Î½Î¹ÎºÎ® Î­Î³Î¹Î½Îµ Î´Î·Î¼Î¿Ï†Î¹Î»Î®Ï‚ Î±Ï€ÏŒ Ï„Î·Î½ Î­ÏÎµÏ…Î½Î± Ï„Î¿Ï… PortSwigger Î³Î¹Î± â€œGraphQL batching & aliasesâ€ Ï„Î¿ 2023 ÎºÎ±Î¹ Î­Ï‡ÎµÎ¹ Î¿Î´Î·Î³Î®ÏƒÎµÎ¹ ÏƒÎµ Ï€Î¿Î»Î»Î­Ï‚ Ï€ÏÏŒÏƒÏ†Î±Ï„ÎµÏ‚ bug-bounty payouts.

### Abuse of *batch* or *bulk* REST endpoints

ÎŸÏÎ¹ÏƒÎ¼Î­Î½Î± APIs ÎµÎºÎ¸Î­Ï„Î¿Ï…Î½ Î²Î¿Î·Î¸Î·Ï„Î¹ÎºÎ¬ endpoints ÏŒÏ€Ï‰Ï‚ Ï„Î¿ `/v2/batch` Î® Î´Î­Ï‡Î¿Î½Ï„Î±Î¹ Î­Î½Î± **array of objects** ÏƒÏ„Î¿ ÏƒÏÎ¼Î± Ï„Î¿Ï… Î±Î¹Ï„Î®Î¼Î±Ï„Î¿Ï‚. Î‘Î½ Î¿ limiter Ï„Î¿Ï€Î¿Î¸ÎµÏ„Î·Î¸ÎµÎ¯ Î¼Ï€ÏÎ¿ÏƒÏ„Î¬ Î¼ÏŒÎ½Î¿ ÏƒÏ„Î± *legacy* endpoints, Î· ÏƒÏ…Î¼Ï€ÎµÏÎ¯Î»Î·ÏˆÎ· Ï€Î¿Î»Î»Î±Ï€Î»ÏÎ½ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÏÎ½ Î¼Î­ÏƒÎ± ÏƒÎµ Î­Î½Î± ÎµÎ½Î¹Î±Î¯Î¿ bulk request Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÎ¹ ÎµÎ½Ï„ÎµÎ»ÏÏ‚ Ï„Î·Î½ Ï€ÏÎ¿ÏƒÏ„Î±ÏƒÎ¯Î±.
```json
[
{"path": "/login", "method": "POST", "body": {"user":"bob","pass":"123"}},
{"path": "/login", "method": "POST", "body": {"user":"bob","pass":"456"}}
]
```
### Î§ÏÎ¿Î½Î¹ÏƒÎ¼ÏŒÏ‚ Ï„Î¿Ï… sliding-window

ÎˆÎ½Î±Ï‚ ÎºÎ»Î±ÏƒÎ¹ÎºÏŒÏ‚ Ï€ÎµÏÎ¹Î¿ÏÎ¹ÏƒÏ„Î®Ï‚ token-bucket Î® leaky-bucket *ÎµÏ€Î±Î½Î±Ï†Î­ÏÎµÏ„Î±Î¹* ÏƒÎµ Î­Î½Î± ÏƒÏ„Î±Î¸ÎµÏÏŒ Ï‡ÏÎ¿Î½Î¹ÎºÏŒ ÏŒÏÎ¹Î¿ (Ï€.Ï‡. ÎºÎ¬Î¸Îµ Î»ÎµÏ€Ï„ÏŒ). Î•Î¬Î½ Ï„Î¿ Ï€Î±ÏÎ¬Î¸Ï…ÏÎ¿ ÎµÎ¯Î½Î±Î¹ Î³Î½Ï‰ÏƒÏ„ÏŒ (Ï€.Ï‡. Î¼Î­ÏƒÏ‰ Î¼Î·Î½Ï…Î¼Î¬Ï„Ï‰Î½ ÏƒÏ†Î¬Î»Î¼Î±Ï„Î¿Ï‚ ÏŒÏ€Ï‰Ï‚ `X-RateLimit-Reset: 27`), ÏƒÏ„ÎµÎ¯Î»Ï„Îµ Ï„Î¿Î½ Î¼Î­Î³Î¹ÏƒÏ„Î¿ ÎµÏ€Î¹Ï„ÏÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ Î±ÏÎ¹Î¸Î¼ÏŒ Î±Î¹Ï„Î®ÏƒÎµÏ‰Î½ **Î»Î¯Î³Î¿ Ï€ÏÎ¹Î½** Î¿ bucket ÎµÏ€Î±Î½Î±Ï†ÎµÏÎ¸ÎµÎ¯, ÎºÎ±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± ÏƒÏ„ÎµÎ¯Î»Ï„Îµ Î±Î¼Î­ÏƒÏ‰Ï‚ Î­Î½Î± Î±ÎºÏŒÎ¼Î· Ï€Î»Î®ÏÎµÏ‚ burst.
```
|<-- 60 s window â€‘->|<-- 60 s window â€‘->|
######                 ######
```
Î‘Ï…Ï„Î® Î· Î±Ï€Î»Î® Î²ÎµÎ»Ï„Î¹ÏƒÏ„Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Ï…Î¾Î®ÏƒÎµÎ¹ Ï„Î¿ throughput ÏƒÎ±Ï‚ Ï€Î¬Î½Ï‰ Î±Ï€ÏŒ Î´ÏÎ¿ Ï†Î¿ÏÎ­Ï‚ Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± ÎµÏ€Î·ÏÎµÎ¬ÏƒÎµÎ¹ ÎºÎ±Î¼Î¯Î± Î¬Î»Î»Î· bypass technique.

### Î‘Î½Î±Î²Î¬Î¸Î¼Î¹ÏƒÎ· ÏƒÎµ WebSockets / gRPC streaming Î¼ÎµÏ„Î¬ Ï„Î¿ handshake

Î Î¿Î»Î»Î¿Î¯ edge rate-limiters ÎµÎ»Î­Î³Ï‡Î¿Ï…Î½ Î¼ÏŒÎ½Î¿ Ï„Î¿ **initial HTTP request**. ÎœÏŒÎ»Î¹Ï‚ Î· ÏƒÏÎ½Î´ÎµÏƒÎ· Î±Î½Î±Î²Î±Î¸Î¼Î¹ÏƒÏ„ÎµÎ¯ ÏƒÎµ WebSocket (HTTP 101) Î® ÏƒÎµ gRPC bidirectional streaming, Ï„Î± ÎµÏ€ÏŒÎ¼ÎµÎ½Î± Î¼Î·Î½ÏÎ¼Î±Ï„Î± ÏƒÏ…Ï‡Î½Î¬ Ï€Î±ÏÎ±ÎºÎ¬Î¼Ï€Ï„Î¿Ï…Î½ Ï„Î¿Ï…Ï‚ request-per-second counters ÎµÏ€ÎµÎ¹Î´Î® Î´ÎµÎ½ Î±Ï€Î¿Ï„ÎµÎ»Î¿ÏÎ½ Ï€Î»Î­Î¿Î½ Î¾ÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„Î¬ HTTP requests. Î— Ï„ÎµÎºÎ¼Î·ÏÎ¯Ï‰ÏƒÎ· Ï„Î·Ï‚ Cloudflare ÏƒÎ·Î¼ÎµÎ¹ÏÎ½ÎµÎ¹ ÏŒÏ„Î¹ Î¼ÏŒÎ½Î¿ Ï„Î¿ initial upgrade request Ï…Ï€ÏŒÎºÎµÎ¹Ï„Î±Î¹ ÏƒÎµ WAF/rate-limiting ÎºÎ±Î½ÏŒÎ½ÎµÏ‚Â· Ï„Î± frames Ï€Î¿Ï… Î±Ï€Î¿ÏƒÏ„Î­Î»Î»Î¿Î½Ï„Î±Î¹ Î¼ÎµÏ„Î¬ ÎµÎ¯Î½Î±Î¹ Î±Î´Î¹Î±Ï†Î±Î½Î®.

Practical workflow:
```bash
# Flood 1,000 OTP guesses through a single WebSocket connection
seq -w 000000 000999 | websocat -n ws://target.tld/api/verify-ws

# gRPC streaming: send multiple Verify requests in one stream
grpcurl -d @ -plaintext target.tld:50051 service.VerifyOTP/Stream <<'EOF'
{ "code": "111111" }
{ "code": "222222" }
{ "code": "333333" }
EOF
```
Î‘Î½ Ï„Î¿ login/OTP endpoint ÎµÎºÎ¸Î­Ï„ÎµÎ¹ ÎºÎ±Î¹ HTTP ÎºÎ±Î¹ WebSocket/gRPC Ï€Î±ÏÎ±Î»Î»Î±Î³Î­Ï‚, ÏƒÏ„Î®ÏƒÏ„Îµ Ï€ÏÏÏ„Î± Ï„Î¿ Î±Î½Î±Î²Î±Î¸Î¼Î¹ÏƒÎ¼Î­Î½Î¿ ÎºÎ±Î½Î¬Î»Î¹ ÎºÎ±Î¹ ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î± ÎºÎ¬Î½Ï„Îµ spray Ï„Î¿Ï…Ï‚ ÎºÏ‰Î´Î¹ÎºÎ¿ÏÏ‚ Î¼Î­ÏƒÎ± ÏƒÎµ Î±Ï…Ï„Î® Ï„Î· Î¼Î¿Î½Î±Î´Î¹ÎºÎ® ÏƒÏÎ½Î´ÎµÏƒÎ· Î³Î¹Î± Î½Î± Î±Ï€Î¿Ï†ÏÎ³ÎµÏ„Îµ Ï„Î± per-request throttles.

### Î•ÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· CDN PoPâ€‘sharded counters

ÎœÎµÏÎ¹ÎºÎ¬ CDN shard-Î¬ÏÎ¿Ï…Î½ Ï„Î¿Ï…Ï‚ rate-limit counters **Î±Î½Î¬ data center/PoP Î±Î½Ï„Î¯ Î³Î¹Î± global**. Î— Cloudflare Î´Î·Î»ÏÎ½ÎµÎ¹ ÏÎ·Ï„Î¬ ÏŒÏ„Î¹ Î¿Î¹ counters Î´ÎµÎ½ Î¼Î¿Î¹ÏÎ¬Î¶Î¿Î½Ï„Î±Î¹ Î¼ÎµÏ„Î±Î¾Ï data centers. Î”ÏÎ¿Î¼Î¿Î»Î¿Î³ÏÎ½Ï„Î±Ï‚ requests Î¼Î­ÏƒÏ‰ egress nodes ÏƒÎµ Ï€Î¿Î»Î»Î­Ï‚ Ï€ÎµÏÎ¹Î¿Ï‡Î­Ï‚ (residential proxy pools, anycast VPNs, Î® cloud VMs pinned ÏƒÎµ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ­Ï‚ Î·Ï€ÎµÎ¯ÏÎ¿Ï…Ï‚), Ï€Î¿Î»Î»Î±Ï€Î»Î±ÏƒÎ¹Î¬Î¶ÎµÏ„Îµ Ï„Î¿ allowed throughput: ÎºÎ¬Î¸Îµ PoP Î´Î¹Î±Ï„Î·ÏÎµÎ¯ Î­Î½Î± independent bucket Î³Î¹Î± Ï„Î¿ Î¯Î´Î¹Î¿ key.

Quick and dirty layout using open proxies (example with `proxychains` + a countryâ€‘rotating list):
```bash
for p in $(cat proxies.txt); do
HTTPS_PROXY=$p curl -s -X POST https://target/api/login -d @payload.json &
done
wait
```
Î’ÎµÎ²Î±Î¹Ï‰Î¸ÎµÎ¯Ï„Îµ ÏŒÏ„Î¹ Ï„Î¿ limiter key Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ per-account â€” Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ¬ Ï€ÎµÏÎ¹ÏƒÏ„ÏÎ­ÏˆÏ„Îµ ÎºÎ±Î¹ user IDs / session tokens.

---

## Î•ÏÎ³Î±Î»ÎµÎ¯Î±

- [**https://github.com/Hashtag-AMIN/hashtag-fuzz**](https://github.com/Hashtag-AMIN/hashtag-fuzz): Fuzzing tool Ï€Î¿Ï… Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ header randomisation, chunked word-lists ÎºÎ±Î¹ round-robin proxy rotation.
- [**https://github.com/ustayready/fireprox**](https://github.com/ustayready/fireprox): Î”Î·Î¼Î¹Î¿Ï…ÏÎ³ÎµÎ¯ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î± disposable AWS API Gateway endpoints ÏÏƒÏ„Îµ ÎºÎ¬Î¸Îµ Î±Î¯Ï„Î·Î¼Î± Î½Î± Ï€ÏÎ¿Î­ÏÏ‡ÎµÏ„Î±Î¹ Î±Ï€ÏŒ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ® Î´Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· IP â€” Î¹Î´Î±Î½Î¹ÎºÏŒ Î³Î¹Î± Ï„Î·Î½ Ï€Î±ÏÎ¬ÎºÎ±Î¼ÏˆÎ· Ï„Î¿Ï… IP-based throttling.
- **Burp Suite â€“ IPRotate + extension**: Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯ Î­Î½Î± pool Î±Ï€ÏŒ SOCKS/HTTP proxies (Î® AWS API Gateway) Î³Î¹Î± Î½Î± Ï€ÎµÏÎ¹ÏƒÏ„ÏÎ­ÏˆÎµÎ¹ Ï„Î·Î½ source IP Î´Î¹Î±Ï†Î±Î½ÏÏ‚ ÎºÎ±Ï„Î¬ Ï„Î¹Ï‚ ÎµÏ€Î¹Î¸Î­ÏƒÎµÎ¹Ï‚ *Intruder* ÎºÎ±Î¹ *Turbo Intruder*.
- **Turbo Intruder (BApp)**: Î¥ÏˆÎ·Î»Î®Ï‚ Î±Ï€ÏŒÎ´Î¿ÏƒÎ·Ï‚ engine ÎµÏ€Î¹Î¸Î­ÏƒÎµÏ‰Î½ Ï€Î¿Ï… Ï…Ï€Î¿ÏƒÏ„Î·ÏÎ¯Î¶ÎµÎ¹ HTTP/2 multiplexingÂ· ÏÏ…Î¸Î¼Î¯ÏƒÏ„Îµ Ï„Î¿ `requestsPerConnection` ÏƒÎµ 100-1000 Î³Î¹Î± Î½Î± ÏƒÏ…Î¼Ï€Ï„ÏÎ¾ÎµÏ„Îµ ÎµÎºÎ±Ï„Î¿Î½Ï„Î¬Î´ÎµÏ‚ requests ÏƒÎµ Î¼Î¯Î± ÏƒÏÎ½Î´ÎµÏƒÎ·.

## Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

- [PortSwigger Research â€“ â€œBypassing rate limits with GraphQL aliasingâ€ (2023)](https://portswigger.net/research/graphql-authorization-bypass)
- [PortSwigger Research â€“ â€œHTTP/2: The Sequel is Always Worseâ€ (connection-based throttling) (2024)](https://portswigger.net/research/http2)
- [Cloudflare Docs â€“ WebSockets & WAF applicability (2025)](https://developers.cloudflare.com/network/websockets/)
- [Cloudflare Docs â€“ Request rate calculation and PoP-local counters (2025)](https://developers.cloudflare.com/waf/rate-limiting-rules/request-rate/)

{{#include ../banners/hacktricks-training.md}}
