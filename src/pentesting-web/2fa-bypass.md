# 2FA/MFA/OTP Bypass

{{#include ../banners/hacktricks-training.md}}

## **Napredne tehnike za zaobilaženja 2FA**

### **Direct Endpoint Access**

Za zaobilaženje 2FA, pristupite sledećem endpointu direktno — ključno je znati putanju. Ako ne uspe, izmenite **Referrer header** da imitira navigaciju sa stranice za verifikaciju 2FA.

### **Token Reuse**

Ponovna upotreba ranije korišćenih tokena za autentifikaciju u okviru naloga može biti efikasna.

### **Utilization of Unused Tokens**

Moguće je pokušati ekstraktovati token iz sopstvenog naloga da bi se zaobišla 2FA na drugom nalogu.

### **Exposure of Token**

Proverite da li je token izložen u odgovoru web aplikacije.

### **Verification Link Exploitation**

Korišćenje **email verification link**‑a poslatog prilikom kreiranja naloga može omogućiti pristup profilu bez 2FA, kao što je objašnjeno u detaljnom [postu](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b).

### **Session Manipulation**

Pokretanjem sesija za sopstveni i žrtvin nalog i dovršavanjem 2FA za sopstveni nalog bez nastavka, može se pokušati pristupiti sledećem koraku u toku žrtvinog naloga, iskorišćavajući ograničenja upravljanja sesijama na backendu.

### **Password Reset Mechanism**

Istražite funkciju resetovanja lozinke koja prijavljuje korisnika u aplikaciju posle resetovanja i proverite da li je moguće više resetovanja koristeći isti link. Prijava sa novopostavljenim kredencijalima može zaobići 2FA.

### **OAuth Platform Compromise**

Kompromisovanje korisničkog naloga na poverenom **OAuth** servisu (npr. Google, Facebook) može otvoriti put za zaobilaženje 2FA.

### **Brute Force Attacks**

#### **Rate Limit Absence**

Nedostatak ograničenja broja pokušaja unosa koda omogućava brute force napade, iako treba uzeti u obzir mogućnost tihog rate limiting‑a.

Note that even if a rate limit is in place you should try to see if the response is different when the valid OTP is sent. In [**this post**](https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732), the bug hunter discovered that even if a rate limit is triggered after 20 unsuccessful attempts by responding with 401, if the valid one was sent a 200 response was received.

#### **Slow Brute Force**

Polagani brute force napad je izvodljiv tamo gde postoje flow rate limits bez opšteg rate limita.

#### **Code Resend Limit Reset**

Ponovno slanje koda resetuje rate limit, što olakšava nastavak brute force pokušaja.

#### **Client-Side Rate Limit Circumvention**

Postoji dokument koji opisuje tehnike zaobilaženja client-side rate limiting‑a.

#### **Internal Actions Lack Rate Limit**

Rate limit‑i mogu štititi login pokušaje, ali ne i unutrašnje akcije naloga.

#### **SMS Code Resend Costs**

Prekomerno ponovno slanje kodova via SMS stvara troškove kompaniji, iako ne zaobilazi 2FA.

#### **Infinite OTP Regeneration**

Beskonačna regeneracija OTP‑a sa jednostavnim kodovima omogućava brute force pokušaje ponavljanjem malog skupa kodova.

### **Race Condition Exploitation**

Iskorišćavanje race condition za 2FA bypass može biti opisano u specifičnom dokumentu.

### **CSRF/Clickjacking Vulnerabilities**

Istraživanje CSRF ili Clickjacking ranjivosti radi onemogućavanja 2FA je izvodljiva strategija.

### **"Remember Me" Feature Exploits**

#### **Predictable Cookie Values**

Pogađanje vrednosti "remember me" cookie‑ja može zaobići ograničenja.

#### **IP Address Impersonation**

Imitiranje IP adrese žrtve preko **X-Forwarded-For** header‑a može zaobići ograničenja.

### **Utilizing Older Versions**

#### **Subdomains**

Testiranje subdomena može otkriti zastarele verzije koje ne podržavaju 2FA ili sadrže ranjive 2FA implementacije.

#### **API Endpoints**

Starije API verzije, označene putem /v\*/ direktorijuma, mogu biti ranjive na 2FA bypass metode.

### **Handling of Previous Sessions**

Terminiranje postojećih sesija pri aktivaciji 2FA obezbeđuje naloge od neovlašćenog pristupa iz kompromitovanih sesija.

### **Access Control Flaws with Backup Codes**

Momentalna generacija i potencijalno neovlašćeno pribavljanje backup kodova pri aktivaciji 2FA, naročito uz CORS misconfigurations/XSS ranjivosti, predstavlja rizik.

### **Information Disclosure on 2FA Page**

Otkriće osetljivih informacija (npr. broj telefona) na 2FA verifikacionoj stranici predstavlja bezbednosni problem.

### **Password Reset Disabling 2FA**

Proces koji demonstrira potencijalnu metodu zaobilaženja uključuje kreiranje naloga, aktivaciju 2FA, resetovanje lozinke i naknadno prijavljivanje bez zahteva za 2FA.

### **Decoy Requests**

Korišćenje decoy requests za zamagljivanje brute force pokušaja ili obmanjivanje rate limiting mehanizama dodaje još jedan sloj strategija za zaobilaženje. Kreiranje takvih zahteva zahteva nijansirano razumevanje bezbednosnih mera aplikacije i ponašanja rate limiting‑a.

### OTP Construction errors

Ako je OTP kreiran na osnovu podataka koje korisnik već poseduje ili koji se šalju pre kreiranja OTP‑a, moguće je da sam korisnik generiše taj OTP i zaobiđe verifikaciju.

## References

- [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://medium.com/@ISecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35)
- [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)
- [https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce](https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce)

P

{{#include ../banners/hacktricks-training.md}}
