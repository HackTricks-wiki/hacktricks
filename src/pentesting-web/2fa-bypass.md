# 2FA/MFA/OTP Omseiling

{{#include ../banners/hacktricks-training.md}}

## **Verbeterde Twee-faktor-verifikasie Omseiltegnieke**

### **Direkte endpoint-toegang**

Om 2FA te omseil, kry direk toegang tot die volgende endpoint; dit is noodsaaklik om die pad te ken. As dit misluk, verander die **Referrer header** om navigasie vanaf die 2FA verifikasiebladsy na te boots.

### **Token-hergebruik**

Herbruik van voorheen gebruikte tokens vir verifikasie binne 'n rekening kan effektief wees.

### **Gebruik van onbruikte tokens**

Dit kan probeer word om 'n token uit jou eie rekening te haal om 2FA in 'n ander rekening te omseil.

### **Blootstelling van token**

Kontroleer of die token geopenbaar word in 'n response van die webtoepassing.

### **Misbruik van verifikasielink**

Deur die **email verification link sent upon account creation** te gebruik, kan jy toegang tot 'n profiel kry sonder 2FA, soos uitgelig in 'n gedetailleerde [post](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b).

### **Sessie-manipulasie**

Deur sessies te begin vir beide die gebruiker se en 'n slagoffer se rekening, en 2FA vir die gebruiker se rekening te voltooi sonder om voort te gaan, kan 'n poging aangewend word om toegang tot die volgende stap in die slagoffer se rekeningvloei te kry, wat backend-sessiebestuurbeperkings uitbuit.

### **Wagwoordherstel-meganisme**

Dit is belangrik om die wagwoordherstelfunksie na te gaan wat 'n gebruiker na die reset in die toepassing aanmeld, om te sien of dit moontlik is om dieselfde skakel vir meervoudige resete te gebruik. Aanmelding met die nuut geresette kredensiële kan 2FA omseil.

### **OAuth-platform-kompromittering**

Om 'n gebruiker se rekening op 'n betroubare **OAuth** platform (bv. Google, Facebook) te kompromitteer, kan 'n pad bied om 2FA te omseil.

### **Brute force-aanvalle**

#### **Ontbreken van rate limit**

Die gebrek aan 'n limiet op die aantal kodepogings maak brute force-aanvalle moontlik, alhoewel stil rate limiting in ag geneem moet word.

Let daarop dat jy, selfs as 'n rate limit ingestel is, moet kyk of die response anders is wanneer die geldige OTP gestuur word. In [**this post**](https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732) het die bug hunter ontdek dat selfs as 'n rate limit na 20 onsuksesvolle pogings geaktiveer word deur met 401 te antwoord, 'n geldige kode 'n 200 response gegee het.

#### **Langsame brute force**

'n Stadige brute force-aanval is haalbaar waar daar flow rate limits bestaan sonder 'n oorhoofse rate limit.

#### **Herversending stel limiet terug**

Herversending van die kode stel die rate limit terug, wat voortgesette brute force-pogings fasiliteer.

#### **Omseiling van client-side rate limiting**

Daar is dokumente wat tegnieke beskryf om client-side rate limiting te omseil.

#### **Interne aksies sonder rate limit**

Rate limits mag aanmeldpogings beskerm, maar nie noodwendig interne rekeningaksies nie.

#### **Koste van SMS-kode hervestuur**

Oormatige herstuur van kodes via SMS veroorsaak koste vir die maatskappy, alhoewel dit nie 2FA omseil nie.

#### **Oneindige OTP-generering**

Oneindige OTP-generering met eenvoudige kodes maak brute force moontlik deur 'n klein stel kodes te probeer.

### **Uitbuiting van race conditions**

Uitbuiting van race conditions vir 2FA-omseiling word in 'n spesifieke dokument uiteengesit.

### **CSRF/Clickjacking-kwesbaarhede**

Die ondersoek na CSRF of Clickjacking-kwesbaarhede om 2FA te deaktiveer is 'n uitvoerbare strategie.

### **"Remember Me" Funksie-uitbuitings**

#### **Voorspelbare koekie-waardes**

Om die "remember me" cookie-waarde te raai kan beperkings omseil.

#### **IP-adres-nabootsing**

Die nabootsing van die slagoffer se IP-adres via die **X-Forwarded-For** header kan beperkings omseil.

### **Gebruik van ouer weergawes**

#### **Subdomeine**

Die toets van subdomeine kan ouer weergawes gebruik wat geen 2FA-ondersteuning het nie, of kwesbare 2FA-implementasies bevat.

#### **API-endpunte**

Ouer API-weergawes, aangedui deur /v\*/ directory paths, kan kwesbaar wees vir 2FA-omseilmetodes.

### **Hanering van vorige sessies**

Die beëindiging van bestaande sessies wanneer 2FA geaktiveer word, beveilig rekeninge teen ongemagtigde toegang vanaf gekompromitteerde sessies.

### **Toegangsbeheer-foute met backup-kodes**

Die onmiddellike generering en moontlike ongemagtigde verkryging van backup-kodes by 2FA-aktivering, veral met CORS-konfigurasiefoute/XSS-kwesbaarhede, skep 'n risiko.

### **Inligtingsopenbaring op 2FA-bladsy**

Die openbaarmaking van sensitiewe inligting (bv. telefoonnommer) op die 2FA-verifikasiebladsy is 'n bekommernis.

### **Wagwoordherstel wat 2FA deaktiveer**

'n Proses wat 'n potensiële omseilmetode demonstreer, behels rekeningopstelling, 2FA-aktivering, wagwoordherstel en daarna aanmelding sonder die 2FA-vereiste.

### **Lokversoeke**

Die gebruik van lokversoeke om brute force-pogings te verberg of rate limiting-meganismes mislei, voeg nog 'n laag by omseilstrategieë. Om sulke versoeke te ontwerp verg 'n fyn begrip van die toepassing se sekuriteitsmaatreëls en rate limiting-gedrag.

### **OTP-konstruksie-foute**

Indien die OTP geskep word gebaseer op data wat die gebruiker reeds het of wat vooraf gestuur word om die OTP te genereer, is dit moontlik dat die gebruiker dit self kan genereer en so die OTP kan omseil.

## Verwysings

- [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://medium.com/@ISecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35)
- [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)
- [https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce](https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce)

P

{{#include ../banners/hacktricks-training.md}}
