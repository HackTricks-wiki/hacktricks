# 2FA/MFA/OTP Bypass

{{#include ../banners/hacktricks-training.md}}

## **Gelişmiş İki Faktörlü Kimlik Doğrulama Bypass Teknikleri**

### **Direct Endpoint Access**

2FA'yı atlamak için sonraki endpoint'e doğrudan erişin; yolunu bilmek kritik önemdedir. Başarısız olursa, Referrer header'ı 2FA doğrulama sayfasından geliyormuş gibi değiştirin.

### **Token Reuse**

Hesap içinde daha önce kullanılmış token'ların kimlik doğrulamada yeniden kullanılması etkili olabilir.

### **Utilization of Unused Tokens**

Kendi hesabınızdan bir token çıkarıp başka bir hesaptaki 2FA'yı atlamak için kullanmayı deneyebilirsiniz.

### **Exposure of Token**

Token'ın web uygulamasının yanıtında ifşa edilip edilmediğini araştırın.

### **Verification Link Exploitation**

Hesap oluşturulduğunda gönderilen e-posta doğrulama linkini kullanmak, ayrıntılı [post](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b)da belirtildiği gibi 2FA olmadan profile erişim sağlayabilir.

### **Session Manipulation**

Kullanıcının ve kurbanın hesabı için oturum başlatmak ve kullanıcının hesabında 2FA'yı tamamlayıp ilerlememek, backend oturum yönetimi kısıtlarını istismar ederek kurban hesabının sonraki adımına erişmeyi mümkün kılabilir.

### **Password Reset Mechanism**

Şifre sıfırlama işlevini inceleyin: reset sonrası kullanıcıyı uygulamaya otomatik olarak oturtuyorsa ve aynı linkle birden fazla reset yapılmasına izin veriyorsa bu kritik. Yeni sıfırlanmış kimlik bilgileriyle giriş yapmak 2FA'yı atlatabilir.

### **OAuth Platform Compromise**

Güvenilir bir OAuth platformundaki (ör. Google, Facebook) bir kullanıcının hesabının ele geçirilmesi 2FA'yı atlamak için bir yol sağlayabilir.

### **Brute Force Attacks**

#### **Rate Limit Absence**

Kod deneme sayısına sınır olmaması brute force saldırılarına izin verir, ancak potansiyel sessiz rate limiting dikkate alınmalıdır.

Note that even if a rate limit is in place you should try to see if the response is different when the valid OTP is sent. In [**this post**](https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732), the bug hunter discovered that even if a rate limit is triggered after 20 unsuccessful attempts by responding with 401, if the valid one was sent a 200 response was received.

#### **Slow Brute Force**

Genel bir rate limit olmadan akış (flow) rate limitleri mevcutsa, yavaş brute force saldırısı uygulanabilir.

#### **Code Resend Limit Reset**

Kodu yeniden gönderme rate limit'i sıfırlayarak brute force denemelerinin devamını kolaylaştırır.

#### **Client-Side Rate Limit Circumvention**

Bir doküman, client-side rate limiting'i atlatma tekniklerini detaylandırır.

#### **Internal Actions Lack Rate Limit**

Rate limit'ler giriş denemelerini korurken, iç hesap işlemlerini korumayabilir.

#### **SMS Code Resend Costs**

Kodun SMS ile aşırı yeniden gönderilmesi şirkete maliyet yükler, ancak 2FA'yı atlatmaz.

#### **Infinite OTP Regeneration**

Basit kodlarla sonsuz OTP üretimi, küçük bir kod kümesini yeniden deneyerek brute force'a izin verir.

### **Race Condition Exploitation**

2FA atlatmak için race condition'ların istismar edilmesi belirli bir dokümanda bulunabilir.

### **CSRF/Clickjacking Vulnerabilities**

2FA'yı devre dışı bırakmak için CSRF veya Clickjacking zafiyetlerini araştırmak geçerli bir stratejidir.

### **"Remember Me" Feature Exploits**

#### **Predictable Cookie Values**

“remember me” cookie değerini tahmin etmek kısıtlamaları atlatabilir.

#### **IP Address Impersonation**

Kurbanın IP adresini **X-Forwarded-For** header'ı yoluyla taklit etmek kısıtlamaları atlatabilir.

### **Utilizing Older Versions**

#### **Subdomains**

Alt alan adlarını test etmek, 2FA desteği olmayan eski sürümleri kullanıyor veya zayıf 2FA uygulamaları içerebilir.

#### **API Endpoints**

/v*/ dizin yolları ile belirtilen eski API sürümleri 2FA atlatma yöntemlerine karşı savunmasız olabilir.

### **Handling of Previous Sessions**

2FA etkinleştirildiğinde mevcut oturumların sonlandırılması, ele geçirilmiş oturumlardan gelen yetkisiz erişime karşı hesapları güvence altına alır.

### **Access Control Flaws with Backup Codes**

2FA etkinleştirildiğinde yedek kodların hemen oluşturulması ve özellikle CORS yanlış yapılandırmaları/XSS zafiyetleri varsa yetkisiz şekilde elde edilebilmesi bir risktir.

### **Information Disclosure on 2FA Page**

2FA doğrulama sayfasında hassas bilgi ifşası (ör. telefon numarası) bir endişe kaynağıdır.

### **Password Reset Disabling 2FA**

Potansiyel bir atlatma yöntemini gösteren süreç, hesap oluşturma, 2FA etkinleştirme, şifre sıfırlama ve ardından 2FA gerekmeksizin giriş yapmayı içerir.

### **Decoy Requests**

Kandırma amacıyla decoy istekleri kullanmak, brute force denemelerini gizlemek veya rate limiting mekanizmalarını yanıltmak, atlatma stratejilerine ek bir katman ekler. Bu tür isteklerin hazırlanması, uygulamanın güvenlik önlemleri ve rate limiting davranışları hakkında nüanslı bir anlayış gerektirir.

### OTP Construction errors

OTP, kullanıcının zaten sahip olduğu verilere dayalı olarak veya OTP oluşturulmadan önce gönderilen verilere göre yaratılıyorsa, kullanıcı da aynı şekilde OTP'yi oluşturabilir ve atlayabilir.

## References

- [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://medium.com/@ISecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35)
- [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)
- [https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce](https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce)

P

{{#include ../banners/hacktricks-training.md}}
