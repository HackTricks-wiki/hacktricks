# 2FA/MFA/OTP Παράκαμψη

{{#include ../banners/hacktricks-training.md}}

## **Προηγμένες τεχνικές παράκαμψης Two-Factor Authentication**

### **Direct Endpoint Access**

Για να παρακάμψετε την 2FA, αποκτήστε πρόσβαση στο επόμενο endpoint απευθείας — η γνώση του path είναι κρίσιμη. Εάν αποτύχει, αλλάξτε το **Referrer header** για να μιμηθείτε την πλοήγηση από τη σελίδα επαλήθευσης 2FA.

### **Token Reuse**

Η επαναχρησιμοποίηση προηγουμένως χρησιμοποιημένων tokens για authentication εντός ενός account μπορεί να είναι αποτελεσματική.

### **Utilization of Unused Tokens**

Μπορεί να επιχειρηθεί η εξαγωγή ενός token από τον δικό σας λογαριασμό για να παρακαμφθεί η 2FA σε άλλον λογαριασμό.

### **Exposure of Token**

Ελέγξτε αν το token αποκαλύπτεται σε κάποια απάντηση από την web εφαρμογή.

### **Verification Link Exploitation**

Η χρήση του **email verification link που αποστέλλεται κατά τη δημιουργία λογαριασμού** μπορεί να επιτρέψει πρόσβαση στο προφίλ χωρίς 2FA, όπως επισημαίνεται σε μια λεπτομερή [post](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b).

### **Session Manipulation**

Η έναρξη sessions τόσο για τον δικό σας όσο και για τον λογαριασμό του θύματος, και η ολοκλήρωση της 2FA για τον δικό σας λογαριασμό χωρίς συνέχεια, επιτρέπει μια προσπάθεια πρόσβασης στο επόμενο βήμα της ροής του θύματος, εκμεταλλευόμενη περιορισμούς στη διαχείριση sessions από το backend.

### **Password Reset Mechanism**

Εξετάστε τη λειτουργία reset password, ειδικά αν κάνει login τον χρήστη μετά το reset, και αν είναι δυνατόν να επιτραπούν πολλαπλά resets με τον ίδιο σύνδεσμο. Το login με τα πρόσφατα reset credentials μπορεί να παρακάμψει την 2FA.

### **OAuth Platform Compromise**

Ο συμβιβασμός του λογαριασμού ενός χρήστη σε μια αξιόπιστη πλατφόρμα **OAuth** (π.χ. Google, Facebook) μπορεί να προσφέρει διαδρομή για παράκαμψη της 2FA.

### **Brute Force Attacks**

#### **Rate Limit Absence**

Η απουσία ορίου στον αριθμό αποπειρών κωδικών επιτρέπει brute force επιθέσεις, αν και θα πρέπει να ληφθεί υπόψη πιθανό σιωπηλό rate limiting.

Σημειώστε ότι ακόμη και αν υπάρχει rate limit, δοκιμάστε να δείτε αν η απάντηση διαφέρει όταν σταλεί το έγκυρο OTP. Σε [**this post**](https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732), ο bug hunter ανακάλυψε ότι ακόμα κι αν ενεργοποιείται rate limit μετά από 20 αποτυχημένες προσπάθειες και απαντά με 401, όταν στάλθηκε ο έγκυρος κωδικός η απάντηση ήταν 200.

#### **Slow Brute Force**

Μια αργή brute force επίθεση είναι ρεαλιστική όπου υπάρχουν περιορισμοί ροής χωρίς γενικό rate limit.

#### **Code Resend Limit Reset**

Η επανέκδοση του κωδικού επαναφέρει το rate limit, διευκολύνοντας την συνέχεια των brute force προσπαθειών.

#### **Client-Side Rate Limit Circumvention**

Υπάρχει documentation με τεχνικές παράκαμψης client-side rate limiting.

#### **Internal Actions Lack Rate Limit**

Τα rate limits μπορεί να προστατεύουν τα login attempts αλλά όχι εσωτερικές ενέργειες λογαριασμού.

#### **SMS Code Resend Costs**

Η υπερβολική επανέκδοση κωδικών μέσω SMS επιβαρύνει οικονομικά την εταιρεία, αλλά δεν παρακάμπτει την 2FA.

#### **Infinite OTP Regeneration**

Η ατέρμονη δημιουργία OTP με απλούς κωδικούς επιτρέπει brute force με επαναλαμβανόμενη δοκιμή μικρού συνόλου κωδικών.

### **Race Condition Exploitation**

Η εκμετάλλευση race conditions για παράκαμψη 2FA περιγράφεται σε ειδικό document.

### **CSRF/Clickjacking Vulnerabilities**

Η αναζήτηση CSRF ή Clickjacking ευπαθειών για απενεργοποίηση της 2FA είναι βιώσιμη στρατηγική.

### **"Remember Me" Feature Exploits**

#### **Predictable Cookie Values**

Η εικασία της τιμής του "remember me" cookie μπορεί να παρακάμψει περιορισμούς.

#### **IP Address Impersonation**

Η μίμηση της IP του θύματος μέσω της κεφαλίδας **X-Forwarded-For** μπορεί να παρακάμψει περιορισμούς.

### **Utilizing Older Versions**

#### **Subdomains**

Ο έλεγχος subdomains μπορεί να αποκαλύψει παλαιότερες εκδόσεις χωρίς υποστήριξη 2FA ή με ευάλωτες υλοποιήσεις 2FA.

#### **API Endpoints**

Παλιότερες εκδόσεις API, υποδεικνυόμενες από paths /v\*/, μπορεί να είναι ευάλωτες σε μεθόδους παράκαμψης 2FA.

### **Handling of Previous Sessions**

Ο τερματισμός υπαρχουσών sessions κατά την ενεργοποίηση της 2FA ασφαλίζει τους λογαριασμούς από μη εξουσιοδοτημένη πρόσβαση μέσω συμβιβασμένων sessions.

### **Access Control Flaws with Backup Codes**

Η άμεση δημιουργία και πιθανή μη εξουσιοδοτημένη ανάκτηση των backup codes κατά την ενεργοποίηση 2FA, ειδικά με misconfigurations CORS ή ευπάθειες XSS, αποτελεί κίνδυνο.

### **Information Disclosure on 2FA Page**

Η αποκάλυψη ευαίσθητων πληροφοριών (π.χ. αριθμός τηλεφώνου) στη σελίδα επαλήθευσης 2FA είναι προβληματική.

### **Password Reset Disabling 2FA**

Μια διαδικασία που δείχνει πιθανή μέθοδο παράκαμψης περιλαμβάνει δημιουργία account, ενεργοποίηση 2FA, password reset και επακόλουθο login χωρίς απαίτηση 2FA.

### **Decoy Requests**

Η χρήση decoy requests για να συγκαλύψετε brute force προσπάθειες ή να παραπλανήσετε μηχανισμούς rate limiting προσθέτει ένα επίπεδο στις στρατηγικές παράκαμψης. Η δημιουργία τέτοιων requests απαιτεί λεπτή κατανόηση των μέτρων ασφαλείας της εφαρμογής και των συμπεριφορών rate limiting.

### OTP Construction errors

Σε περίπτωση που το OTP δημιουργείται με βάση δεδομένα που ο χρήστης ήδη κατέχει ή που αποστέλλονται προηγουμένως για τη δημιουργία του OTP, είναι πιθανό ο χρήστης να το δημιουργήσει ο ίδιος και να το παρακάμψει.

## References

- [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://medium.com/@ISecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35)
- [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)
- [https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce](https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce)

P

{{#include ../banners/hacktricks-training.md}}
