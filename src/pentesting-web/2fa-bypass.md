# 2FA/MFA/OTP Bypass

{{#include ../banners/hacktricks-training.md}}

## **Enhanced Two-Factor Authentication Bypass Techniques**

### **Direct Endpoint Access**

Um 2FA zu umgehen, direkt auf den nachfolgenden Endpoint zugreifen — der Pfad muss bekannt sein. Falls das nicht funktioniert, den **Referrer header** ändern, um die Navigation von der 2FA-Verify-Seite vorzutäuschen.

### **Token Reuse**

Wiederverwendung zuvor genutzter Tokens zur Authentifizierung innerhalb eines Accounts kann effektiv sein.

### **Utilization of Unused Tokens**

Versuchen, ein Token aus dem eigenen Account zu extrahieren, um damit 2FA in einem anderen Account zu umgehen.

### **Exposure of Token**

Prüfen, ob das Token in einer Antwort der Webanwendung offengelegt wird.

### **Verification Link Exploitation**

Die Verwendung des bei der Account-Erstellung gesendeten **email verification link** kann Profilzugriff ohne 2FA ermöglichen, wie in einem detaillierten [post](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b) beschrieben.

### **Session Manipulation**

Sitzungen sowohl für den eigenen als auch für das Opferkonto initiieren und 2FA für das eigene Konto abschließen, ohne weiterzugehen. Dann versuchen, den nächsten Schritt im Flow des Opferkontos aufzurufen — dabei werden Backend-Session-Management-Einschränkungen ausgenutzt.

### **Password Reset Mechanism**

Untersuchen, ob die Password-Reset-Funktion den Nutzer nach dem Zurücksetzen automatisch in die Anwendung einloggt und ob derselbe Link mehrfach verwendet werden kann. Ein Login mit den neu gesetzten Zugangsdaten könnte 2FA umgehen.

### **OAuth Platform Compromise**

Kompromittierung eines Benutzerkontos auf einer vertrauenswürdigen **OAuth**-Plattform (z. B. Google, Facebook) kann einen Weg bieten, 2FA zu umgehen.

### **Brute Force Attacks**

#### **Rate Limit Absence**

Fehlende Begrenzung der Anzahl von Code-Versuchen ermöglicht Brute-Force-Angriffe; es kann jedoch eine stille Rate-Limiting-Implementierung geben, die berücksichtigt werden sollte.

Beachte, dass du selbst bei aktivem Rate Limit prüfen solltest, ob die Antwort unterschiedlich ist, wenn der gültige OTP gesendet wird. In [**this post**](https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732) stellte ein Bug-Hunter fest, dass selbst wenn nach 20 fehlgeschlagenen Versuchen ein Rate Limit greift und mit 401 geantwortet wird, bei Einsendung des gültigen Codes eine 200-Antwort zurückkam.

#### **Slow Brute Force**

Ein langsamer Brute-Force-Angriff ist möglich, wenn Flow-Rate-Limits existieren, aber kein globales Limit vorhanden ist.

#### **Code Resend Limit Reset**

Das Erneut-Senden des Codes setzt das Rate Limit zurück und ermöglicht so fortgesetzte Brute-Force-Versuche.

#### **Client-Side Rate Limit Circumvention**

Es gibt Dokumente mit Techniken zum Umgehen clientseitiger Rate-Limits.

#### **Internal Actions Lack Rate Limit**

Rate-Limits können Login-Versuche schützen, aber interne Account-Aktionen unbegrenzt lassen.

#### **SMS Code Resend Costs**

Exzessives erneutes Versenden von Codes per SMS verursacht Kosten für das Unternehmen, auch wenn es 2FA nicht direkt umgeht.

#### **Infinite OTP Regeneration**

Endlose OTP-Generierung mit einfachen Codes erlaubt Brute-Force durch wiederholtes Ausprobieren einer kleinen Menge an Codes.

### **Race Condition Exploitation**

Das Ausnutzen von Race Conditions zur 2FA-Umgehung wird in einem spezifischen Dokument beschrieben.

### **CSRF/Clickjacking Vulnerabilities**

Das Ausnutzen von CSRF- oder Clickjacking-Schwachstellen, um 2FA zu deaktivieren, ist eine mögliche Strategie.

### **"Remember Me" Feature Exploits**

#### **Predictable Cookie Values**

Das Raten des "remember me"-Cookie-Werts kann Einschränkungen umgehen.

#### **IP Address Impersonation**

Das Vorspiegeln der IP-Adresse des Opfers über den **X-Forwarded-For**-Header kann Beschränkungen umgehen.

### **Utilizing Older Versions**

#### **Subdomains**

Subdomains testen — dort könnten veraltete Versionen ohne 2FA-Unterstützung oder verwundbare 2FA-Implementierungen laufen.

#### **API Endpoints**

Ältere API-Versionen, erkennbar an /v\*/-Verzeichnispfaden, können für 2FA-Bypass-Methoden anfällig sein.

### **Handling of Previous Sessions**

Das Beenden vorhandener Sessions bei Aktivierung von 2FA sichert Accounts gegen unbefugten Zugriff aus kompromittierten Sessions.

### **Access Control Flaws with Backup Codes**

Sofortige Generierung und potenziell unautorisierter Abruf von Backup-Codes nach Aktivierung von 2FA, insbesondere bei CORS-Misconfigurations/XSS, stellen ein Risiko dar.

### **Information Disclosure on 2FA Page**

Die Offenlegung sensibler Informationen (z. B. Telefonnummer) auf der 2FA-Verify-Seite ist problematisch.

### **Password Reset Disabling 2FA**

Ein Ablauf, der als potenzieller Bypass dient: Account erstellen → 2FA aktivieren → Passwort zurücksetzen → anschließendes Einloggen ohne 2FA-Anforderung.

### **Decoy Requests**

Decoy-Requests nutzen, um Brute-Force-Versuche zu verschleiern oder Rate-Limiting-Mechanismen in die Irre zu führen. Solche Requests zu konstruieren erfordert ein feines Verständnis der Sicherheitsmaßnahmen und des Rate-Limit-Verhaltens der Anwendung.

### OTP Construction errors

Falls das OTP auf bereits vom Benutzer bekannten Daten basiert oder aus zuvor gesendeten Informationen erzeugt wird, kann der Benutzer es ebenfalls generieren und so 2FA umgehen.

## References

- [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://medium.com/@ISecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35)
- [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)
- [https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce](https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce)

P

{{#include ../banners/hacktricks-training.md}}
