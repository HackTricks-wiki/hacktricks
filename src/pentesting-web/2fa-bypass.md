# 2FA/MFA/OTP Bypass

{{#include ../banners/hacktricks-training.md}}

## **Verbeterde Twee-Faktor Verifikasie Bypass Tegnieke**

### **Direkte Eindpunt Toegang**

Om 2FA te omseil, toegang die daaropvolgende eindpunt direk, dit is belangrik om die pad te ken. As dit nie suksesvol is nie, verander die **Referrer header** om navigasie vanaf die 2FA verifikasiebladsy na te boots.

### **Token Hergebruik**

Herbruik van voorheen gebruikte tokens vir verifikasie binne 'n rekening kan effektief wees.

### **Benutting van Ongebruikte Tokens**

Om 'n token uit jou eie rekening te onttrek om 2FA in 'n ander rekening te omseil kan probeer word.

### **Blootstelling van Token**

Ondersoek of die token bekend gemaak word in 'n antwoord van die webtoepassing.

### **Verifikasielink Exploit**

Die gebruik van die **e-pos verifikasielink wat tydens rekening skep gestuur is** kan profieltoegang sonder 2FA toelaat, soos beklemtoon in 'n gedetailleerde [plasing](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b).

### **Sessie Manipulasie**

Begin sessies vir beide die gebruiker se en 'n slagoffer se rekening, en voltooi 2FA vir die gebruiker se rekening sonder om voort te gaan, laat 'n poging toe om toegang te verkry tot die volgende stap in die slagoffer se rekeningvloei, wat agtergrond sessiebestuur beperkings benut.

### **Wagwoord Herstel Meganisme**

Om die wagwoord herstel funksie te ondersoek, wat 'n gebruiker in die toepassing aanmeld na herstel, vir die potensiaal om verskeie herstel met dieselfde skakel toe te laat, is belangrik. Aanmeld met die nuut herstel geloofsbriewe mag 2FA omseil.

### **OAuth Platform Kompromie**

Die kompromie van 'n gebruiker se rekening op 'n vertroude **OAuth** platform (bv. Google, Facebook) kan 'n roete bied om 2FA te omseil.

### **Brute Force Aanvalle**

#### **Tarief Limiet Afwesigheid**

Die gebrek aan 'n limiet op die aantal kode pogings laat brute force aanvalle toe, alhoewel potensiële stil tarief beperking oorweeg moet word.

Let daarop dat selfs as 'n tarief limiet in plek is, jy moet probeer om te sien of die antwoord verskil wanneer die geldige OTP gestuur word. In [**hierdie plasing**](https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732), het die foutjagter ontdek dat selfs as 'n tarief limiet geaktiveer word na 20 onsuksesvolle pogings deur met 401 te antwoord, as die geldige een gestuur is, 'n 200 antwoord ontvang is.

#### **Langsame Brute Force**

'n Langsame brute force aanval is lewensvatbaar waar vloei tarief limiete bestaan sonder 'n oorgrypende tarief limiet.

#### **Kode Herstuur Limiet Reset**

Herstuur van die kode reset die tarief limiet, wat voortgesette brute force pogings vergemaklik.

#### **Kliënt-Kant Tarief Limiet Omseiling**

'n Dokument beskryf tegnieke om kliënt-kant tarief beperking te omseil.

#### **Interne Aksies Ontbreek Tarief Limiet**

Tarief limiete mag aanmeldpogings beskerm, maar nie interne rekening aksies nie.

#### **SMS Kode Herstuur Koste**

Oormatige herstuur van kodes via SMS bring koste vir die maatskappy mee, alhoewel dit nie 2FA omseil nie.

#### **Oneindige OTP Generasie**

Oneindige OTP generasie met eenvoudige kodes laat brute force toe deur 'n klein stel kodes te herprobeer.

### **Ras Toestand Exploit**

Die benutting van ras toestande vir 2FA omseiling kan in 'n spesifieke dokument gevind word.

### **CSRF/Clickjacking Kw vulnerabilities**

Die verkenning van CSRF of Clickjacking kwesbaarhede om 2FA te deaktiveer is 'n lewensvatbare strategie.

### **"Onthou My" Kenmerk Exploits**

#### **Voorspelbare Koekie Waardes**

Om die "onthou my" koekie waarde te raai kan beperkings omseil.

#### **IP Adres Vervalsing**

Die vervalsing van die slagoffer se IP adres deur die **X-Forwarded-For** header kan beperkings omseil.

### **Benutting van Ouers Weergawes**

#### **Subdomeine**

Toets subdomeine mag verouderde weergawes gebruik wat 2FA ondersteuning ontbreek of kwesbare 2FA implementasies bevat.

#### **API Eindpunte**

Ou API weergawes, aangedui deur /v\*/ gidspade, mag kwesbaar wees vir 2FA omseiling metodes.

### **Hantering van Vorige Sessies**

Die beëindiging van bestaande sessies tydens 2FA aktivering beveilig rekeninge teen ongemagtigde toegang vanaf gecompromitteerde sessies.

### **Toegangsbeheer Foute met Rugsteunkodes**

Onmiddellike generasie en potensiële ongemagtigde onttrekking van rugsteunkodes tydens 2FA aktivering, veral met CORS miskonfigurasies/XSS kwesbaarhede, stel 'n risiko voor.

### **Inligting Blootstelling op 2FA Bladsy**

Sensitiewe inligting blootstelling (bv. telefoonnommer) op die 2FA verifikasiebladsy is 'n bekommernis.

### **Wagwoord Herstel Deaktiveer 2FA**

'n Proses wat 'n potensiële omseil metode demonstreer behels rekening skep, 2FA aktivering, wagwoord herstel, en daaropvolgende aanmelding sonder die 2FA vereiste.

### **Afleidingsversoeke**

Die benutting van afleidingsversoeke om brute force pogings te verdoesel of tarief beperking meganismes te mislei voeg 'n ander laag by omseil strategieë. Om sulke versoeke te skep vereis 'n fyn begrip van die toepassing se sekuriteitsmaatreëls en tarief beperking gedrag.

### OTP Konstruksiefoute

In die geval dat die OTP geskep word op grond van data wat die gebruiker reeds het of wat voorheen gestuur word om die OTP te skep, is dit moontlik vir die gebruiker om dit ook te genereer en dit te omseil.

## References

- [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
- [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)
- [https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce](https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce)

P

{{#include ../banners/hacktricks-training.md}}
