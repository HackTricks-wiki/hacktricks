# 2FA/MFA/OTP Bypass

{{#include ../banners/hacktricks-training.md}}

## **Enhanced Two-Factor Authentication Bypass Techniques**

### **Direct Endpoint Access**

2FA बायपास करने के लिए अगले endpoint तक सीधे पहुँचें — path का पता होना आवश्यक है। सफल न होने पर **Referrer header** बदलकर 2FA verification पेज से नेविगेट करने का नाटक करें।

### **Token Reuse**

खाते के अंदर पहले से इस्तेमाल किए गए token को पुन: उपयोग करके authentication बायपास करना प्रभावी हो सकता है।

### **Utilization of Unused Tokens**

अपने खुद के account से निकालें गया token दूसरे account में 2FA बायपास करने के लिए प्रयुक्त किया जा सकता है।

### **Exposure of Token**

जाँच करें कि क्या token web application की response में disclose हो रहा है।

### **Verification Link Exploitation**

Account बनाते वक्त भेजे गए email verification link का उपयोग करके 2FA के बिना profile तक पहुँच बनाई जा सकती है, जैसा कि एक विस्तृत [post](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b) में बताया गया है।

### **Session Manipulation**

यूज़र और victim दोनों के लिए sessions आरंभ करके, अपने यूज़र के लिए 2FA पूरा करें पर आगे न बढ़ें — फिर victim के account फ्लो के अगले स्टेप को एक्सेस करने का प्रयास करें। यह backend session management की सीमाओं का फायदा उठा सकता है।

### **Password Reset Mechanism**

Password reset फ़ंक्शन की जांच करें — कई implementations reset के बाद उपयोगकर्ता को application में लॉग इन कर देते हैं। यह देखना जरूरी है कि क्या एक ही link से multiple resets संभव हैं और reset किए गए क्रेडेंशियल्स से लॉगिन करने पर 2FA बायपास होता है।

### **OAuth Platform Compromise**

किसी भरोसेमंद OAuth प्लेटफॉर्म (जैसे Google, Facebook) पर यूज़र का account compromise करने से 2FA बायपास का रास्ता मिल सकता है।

### **Brute Force Attacks**

#### **Rate Limit Absence**

यदि कोड के प्रयासों की संख्या पर कोई limit नहीं है तो brute force attacks संभव हैं, हालांकि silent rate limiting होना आवश्यक ध्यान में रखें।

ध्यान दें कि भले ही rate limit मौजूद हो, यह देखना चाहिए कि valid OTP भेजने पर response अलग होता है या नहीं। [**this post**](https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732) में बग हंटर ने पाया कि अगर 20 असफल प्रयासों के बाद rate limit trigger होने पर 401 रिटर्न होता है, valid OTP भेजने पर 200 response मिल सकता है।

#### **Slow Brute Force**

वो स्थान जहाँ flow rate limits हैं पर समग्र rate limit नहीं है, वहां slow brute force हमला व्यवहार्य है।

#### **Code Resend Limit Reset**

कोड को resend करने से rate limit reset हो सकता है, जिससे brute force प्रयास जारी रखने में आसानी होती है।

#### **Client-Side Rate Limit Circumvention**

एक दस्तावेज client-side rate limiting bypass करने की तकनीकों का वर्णन करता है।

#### **Internal Actions Lack Rate Limit**

Rate limits लॉगिन प्रयासों को तो cover कर सकती हैं पर internal account actions पर लागू न हो सकती हैं।

#### **SMS Code Resend Costs**

SMS के माध्यम से कोड को बार-बार resend करना कंपनी के लिए खर्च बढ़ा देता है, हालांकि यह 2FA को सीधे बायपास नहीं करता।

#### **Infinite OTP Regeneration**

यदि बार-बार नए, सरल codes जनरेट होते हैं तो छोटे सेट के कोडों को retry करके brute force संभव हो जाता है।

### **Race Condition Exploitation**

2FA बायपास के लिए race conditions का उपयोग करने के तरीके एक विशेष दस्तावेज में मिलते हैं।

### **CSRF/Clickjacking Vulnerabilities**

2FA को disable करने के लिए CSRF या Clickjacking कमजोरियों का पता लगाना एक वैध रणनीति है।

### **"Remember Me" Feature Exploits**

#### **Predictable Cookie Values**

"Remember Me" cookie के मान का अनुमान लगाकर प्रतिबंधों को बायपास किया जा सकता है।

#### **IP Address Impersonation**

पीड़ित के IP address का impersonation करके, जैसे **X-Forwarded-For** header के माध्यम से, प्रतिबंधों को बायपास किया जा सकता है।

### **Utilizing Older Versions**

#### **Subdomains**

Subdomains की जाँच करें — वे पुराने versions चला सकते हैं जिनमें 2FA का समर्थन नहीं है या कमजोर 2FA implementations मौजूद हो सकती हैं।

#### **API Endpoints**

पुराने API versions, जो /v\*/ जैसे directory paths से संकेतित होते हैं, 2FA बायपास तरीकों के लिए कमजोर हो सकते हैं।

### **Handling of Previous Sessions**

2FA सक्रिय करने पर मौजूदा sessions को terminate करने से compromised sessions से unauthorized access से खाते सुरक्षित रहते हैं।

### **Access Control Flaws with Backup Codes**

2FA सक्रिय करते ही तुरंत backup codes जनरेट होना और संभवतः unauthorized तरीके से प्राप्त होना, खासकर CORS misconfigurations या XSS कमजोरियों के साथ, जोखिम पैदा करता है।

### **Information Disclosure on 2FA Page**

2FA verification पेज पर संवेदनशील जानकारी (जैसे phone number) का disclosure एक चिंता का विषय है।

### **Password Reset Disabling 2FA**

एक संभावित bypass तरीका यह दर्शाता है कि account बनाना, 2FA एक्टिवेट करना, password reset करना और फिर बिना 2FA के लॉगिन होना संभव हो सकता है — यह फ़्लो सत्यापित किया जाना चाहिए।

### **Decoy Requests**

Brute force प्रयासों को छुपाने या rate limiting को धोखा देने के लिए decoy requests का उपयोग एक और रणनीति है। ऐसे requests तैयार करने के लिए application की security measures और rate limiting व्यवहार की बारीक समझ आवश्यक होती है।

### OTP Construction errors

यदि OTP उस डेटा के आधार पर बन रहा है जो उपयोगकर्ता के पास पहले से मौजूद है या जिसे OTP बनाने से पहले भेजा गया था, तो उपयोगकर्ता भी उसे जनरेट कर सकता है और 2FA बायपास कर सकता है।

## References

- [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://medium.com/@ISecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35)
- [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)
- [https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce](https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce)

P

{{#include ../banners/hacktricks-training.md}}
