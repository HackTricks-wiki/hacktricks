# 2FA/MFA/OTP Bypass

{{#include ../banners/hacktricks-training.md}}

## **Τεχνικές Παράκαμψης Ενισχυμένης Δύο-Παραγοντικής Αυθεντικοποίησης**

### **Άμεση Πρόσβαση σε Τερματικό Σημείο**

Για να παρακάμψετε το 2FA, αποκτήστε άμεση πρόσβαση στο επόμενο τερματικό σημείο, γνωρίζοντας ότι η διαδρομή είναι κρίσιμη. Αν δεν είναι επιτυχές, αλλάξτε την **κεφαλίδα Referrer** για να μιμηθείτε την πλοήγηση από τη σελίδα επαλήθευσης 2FA.

### **Επαναχρησιμοποίηση Κωδικών**

Η επαναχρησιμοποίηση προηγουμένως χρησιμοποιημένων κωδικών για αυθεντικοποίηση εντός ενός λογαριασμού μπορεί να είναι αποτελεσματική.

### **Χρήση Μη Χρησιμοποιημένων Κωδικών**

Η εξαγωγή ενός κωδικού από τον δικό σας λογαριασμό για να παρακάμψετε το 2FA σε άλλο λογαριασμό μπορεί να επιχειρηθεί.

### **Έκθεση Κωδικού**

Εξετάστε αν ο κωδικός αποκαλύπτεται σε μια απάντηση από την εφαρμογή ιστού.

### **Εκμετάλλευση Συνδέσμου Επαλήθευσης**

Η χρήση του **συνδέσμου επαλήθευσης email που αποστέλλεται κατά τη δημιουργία λογαριασμού** μπορεί να επιτρέψει την πρόσβαση στο προφίλ χωρίς 2FA, όπως επισημαίνεται σε μια λεπτομερή [δημοσίευση](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b).

### **Manipulation of Session**

Η έναρξη συνεδριών τόσο για τον λογαριασμό του χρήστη όσο και για τον λογαριασμό ενός θύματος, και η ολοκλήρωση του 2FA για τον λογαριασμό του χρήστη χωρίς να προχωρήσετε, επιτρέπει μια προσπάθεια πρόσβασης στο επόμενο βήμα της ροής του λογαριασμού του θύματος, εκμεταλλευόμενη τους περιορισμούς διαχείρισης συνεδριών backend.

### **Μηχανισμός Επαναφοράς Κωδικού**

Η διερεύνηση της λειτουργίας επαναφοράς κωδικού, η οποία συνδέει έναν χρήστη στην εφαρμογή μετά την επαναφορά, για την πιθανότητά της να επιτρέπει πολλές επαναφορές χρησιμοποιώντας τον ίδιο σύνδεσμο είναι κρίσιμη. Η σύνδεση με τα νέα διαπιστευτήρια που επαναφέρθηκαν μπορεί να παρακάμψει το 2FA.

### **Εκμετάλλευση Πλατφόρμας OAuth**

Η εκμετάλλευση ενός λογαριασμού χρήστη σε μια αξιόπιστη **OAuth** πλατφόρμα (π.χ., Google, Facebook) μπορεί να προσφέρει μια διαδρομή για να παρακάμψετε το 2FA.

### **Επιθέσεις Brute Force**

#### **Απουσία Περιορισμού Ρυθμού**

Η έλλειψη περιορισμού στον αριθμό των προσπαθειών κωδικού επιτρέπει επιθέσεις brute force, αν και θα πρέπει να εξεταστεί η πιθανή σιωπηλή περιοριστική ρύθμιση.

Σημειώστε ότι ακόμη και αν υπάρχει περιορισμός ρυθμού, θα πρέπει να προσπαθήσετε να δείτε αν η απάντηση είναι διαφορετική όταν αποστέλλεται το έγκυρο OTP. Σε [**αυτή τη δημοσίευση**](https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732), ο κυνηγός σφαλμάτων ανακάλυψε ότι ακόμη και αν ενεργοποιηθεί περιορισμός ρυθμού μετά από 20 αποτυχημένες προσπάθειες με απάντηση 401, αν αποσταλεί το έγκυρο, ελήφθη απάντηση 200.

#### **Αργή Επιθέσεις Brute Force**

Μια αργή επίθεση brute force είναι βιώσιμη όπου υπάρχουν περιορισμοί ροής χωρίς έναν γενικό περιορισμό ρυθμού.

#### **Επαναφορά Περιορισμού Επαναποστολής Κωδικού**

Η επαναποστολή του κωδικού επαναφέρει τον περιορισμό ρυθμού, διευκολύνοντας τις συνεχείς προσπάθειες brute force.

#### **Παράκαμψη Περιορισμού Ρυθμού Client-Side**

Ένα έγγραφο περιγράφει τεχνικές για την παράκαμψη του περιορισμού ρυθμού client-side.

#### **Απουσία Περιορισμού Ρυθμού σε Εσωτερικές Ενέργειες**

Οι περιορισμοί ρυθμού μπορεί να προστατεύουν τις προσπάθειες σύνδεσης αλλά όχι τις εσωτερικές ενέργειες λογαριασμού.

#### **Κόστη Επαναποστολής Κωδικών SMS**

Η υπερβολική επαναποστολή κωδικών μέσω SMS επιφέρει κόστη στην εταιρεία, αν και δεν παρακάμπτει το 2FA.

#### **Ατελείωτη Αναγέννηση OTP**

Η ατελείωτη αναγέννηση OTP με απλούς κωδικούς επιτρέπει brute force δοκιμάζοντας ένα μικρό σύνολο κωδικών.

### **Εκμετάλλευση Συνθηκών Αγώνα**

Η εκμετάλλευση συνθηκών αγώνα για την παράκαμψη του 2FA μπορεί να βρεθεί σε ένα συγκεκριμένο έγγραφο.

### **Ευπάθειες CSRF/Clickjacking**

Η εξερεύνηση ευπαθειών CSRF ή Clickjacking για την απενεργοποίηση του 2FA είναι μια βιώσιμη στρατηγική.

### **Εκμεταλλεύσεις Λειτουργίας "Θυμήσου με"**

#### **Προβλέψιμες Τιμές Cookie**

Η μαντεψιά της τιμής cookie "θυμήσου με" μπορεί να παρακάμψει περιορισμούς.

#### **Μίμηση Διεύθυνσης IP**

Η μίμηση της διεύθυνσης IP του θύματος μέσω της κεφαλίδας **X-Forwarded-For** μπορεί να παρακάμψει περιορισμούς.

### **Χρήση Παλαιότερων Εκδόσεων**

#### **Υποτομείς**

Η δοκιμή υποτομέων μπορεί να χρησιμοποιεί παλιές εκδόσεις που δεν υποστηρίζουν 2FA ή να περιέχουν ευάλωτες υλοποιήσεις 2FA.

#### **API Endpoints**

Παλαιότερες εκδόσεις API, που υποδεικνύονται από διαδρομές καταλόγου /v\*/, μπορεί να είναι ευάλωτες σε μεθόδους παράκαμψης 2FA.

### **Διαχείριση Προηγούμενων Συνεδριών**

Η τερματισμός υφιστάμενων συνεδριών κατά την ενεργοποίηση του 2FA ασφαλίζει τους λογαριασμούς από μη εξουσιοδοτημένη πρόσβαση από παραβιασμένες συνεδρίες.

### **Ελαττώματα Ελέγχου Πρόσβασης με Κωδικούς Αντίγραφου**

Η άμεση δημιουργία και η πιθανή μη εξουσιοδοτημένη ανάκτηση κωδικών αντίγραφου κατά την ενεργοποίηση του 2FA, ειδικά με κακές ρυθμίσεις CORS/ευπάθειες XSS, θέτει σε κίνδυνο.

### **Αποκάλυψη Πληροφοριών στη Σελίδα 2FA**

Η αποκάλυψη ευαίσθητων πληροφοριών (π.χ., αριθμός τηλεφώνου) στη σελίδα επαλήθευσης 2FA είναι ανησυχητική.

### **Επαναφορά Κωδικού Απενεργοποιώντας το 2FA**

Μια διαδικασία που δείχνει μια πιθανή μέθοδο παράκαμψης περιλαμβάνει τη δημιουργία λογαριασμού, την ενεργοποίηση 2FA, την επαναφορά κωδικού και την επακόλουθη σύνδεση χωρίς την απαίτηση 2FA.

### **Αποσπασματικές Αιτήσεις**

Η χρήση αποσπασματικών αιτήσεων για την απόκρυψη προσπαθειών brute force ή την παραπλάνηση μηχανισμών περιορισμού ρυθμού προσθέτει ένα επιπλέον επίπεδο στις στρατηγικές παράκαμψης. Η δημιουργία τέτοιων αιτήσεων απαιτεί μια λεπτομερή κατανόηση των μέτρων ασφαλείας της εφαρμογής και των συμπεριφορών περιορισμού ρυθμού.

### Σφάλματα Κατασκευής OTP

Σε περίπτωση που το OTP δημιουργείται με βάση δεδομένα που ο χρήστης ήδη έχει ή που αποστέλλονται προηγουμένως για τη δημιουργία του OTP, είναι πιθανό ο χρήστης να το δημιουργήσει επίσης και να το παρακάμψει.

## Αναφορές

- [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
- [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)
- [https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce](https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce)

P

{{#include ../banners/hacktricks-training.md}}
