# 2FA/MFA/OTP Bypass

{{#include ../banners/hacktricks-training.md}}

## **Gelişmiş İki Aşamalı Kimlik Doğrulama Bypass Teknikleri**

### **Doğrudan Uç Nokta Erişimi**

2FA'yı atlamak için, sonraki uç noktaya doğrudan erişim sağlamak, yolun bilinmesi kritik öneme sahiptir. Başarısız olursa, **Referrer başlığını** 2FA doğrulama sayfasından gezinmeyi taklit edecek şekilde değiştirin.

### **Token Yeniden Kullanımı**

Bir hesap içindeki kimlik doğrulama için daha önce kullanılan token'ları yeniden kullanmak etkili olabilir.

### **Kullanılmayan Token'ların Kullanımı**

Kendi hesabınızdan bir token çıkararak başka bir hesapta 2FA'yı atlamayı deneyebilirsiniz.

### **Token'ın Açığa Çıkması**

Token'ın web uygulamasından gelen bir yanıtta ifşa edilip edilmediğini araştırın.

### **Doğrulama Bağlantısı İstismarı**

**Hesap oluşturulduğunda gönderilen e-posta doğrulama bağlantısını** kullanmak, 2FA olmadan profil erişimi sağlayabilir; bu, detaylı bir [yazıda](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b) vurgulanmıştır.

### **Oturum Manipülasyonu**

Kullanıcının ve bir mağdurun hesabı için oturum başlatmak ve kullanıcının hesabı için 2FA'yı tamamlamadan devam etmek, mağdurun hesap akışındaki bir sonraki adıma erişim sağlama girişiminde bulunmayı sağlar; bu, arka uç oturum yönetimi sınırlamalarını istismar eder.

### **Şifre Sıfırlama Mekanizması**

Şifre sıfırlama işlevini araştırmak, kullanıcının uygulamaya sıfırlama sonrası giriş yapmasını sağlamak için aynı bağlantıyı kullanarak birden fazla sıfırlama yapılmasına olanak tanıyabilir. Yeniden sıfırlanan kimlik bilgileriyle giriş yapmak 2FA'yı atlayabilir.

### **OAuth Platformu İhlali**

Güvenilir bir **OAuth** platformundaki (örneğin, Google, Facebook) bir kullanıcının hesabını ihlal etmek, 2FA'yı atlamak için bir yol sunabilir.

### **Kaba Kuvvet Saldırıları**

#### **Hız Sınırı Yokluğu**

Kod denemeleri için bir sınır olmaması, kaba kuvvet saldırılarına olanak tanır; ancak potansiyel sessiz hız sınırlaması dikkate alınmalıdır.

Hız sınırı mevcut olsa bile, geçerli OTP gönderildiğinde yanıtın farklı olup olmadığını kontrol etmeye çalışmalısınız. [**Bu yazıda**](https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732), hata avcısı, 20 başarısız denemeden sonra hız sınırı tetiklendiğinde 401 yanıtı verildiğini, ancak geçerli olan gönderildiğinde 200 yanıtı alındığını keşfetti.

#### **Yavaş Kaba Kuvvet**

Bir yavaş kaba kuvvet saldırısı, akış hızı sınırlamaları mevcut olduğunda geçerlidir, ancak genel bir hız sınırı yoktur.

#### **Kod Yeniden Gönderme Sınırının Sıfırlanması**

Kodun yeniden gönderilmesi hız sınırını sıfırlar ve devam eden kaba kuvvet denemelerini kolaylaştırır.

#### **İstemci Tarafı Hız Sınırı Aşma**

İstemci tarafı hız sınırlamasını aşma tekniklerini detaylandıran bir belge mevcuttur.

#### **İçsel Eylemlerde Hız Sınırı Yokluğu**

Hız sınırlamaları giriş denemelerini koruyabilir, ancak iç hesap eylemlerini korumaz.

#### **SMS Kodu Yeniden Gönderme Maliyetleri**

SMS ile kodların aşırı yeniden gönderilmesi, şirkete maliyet yükler, ancak 2FA'yı atlamaz.

#### **Sonsuz OTP Yeniden Üretimi**

Basit kodlarla sonsuz OTP üretimi, küçük bir kod setini yeniden deneyerek kaba kuvvet saldırısına olanak tanır.

### **Yarış Durumu İstismarı**

2FA bypass'ı için yarış durumlarını istismar etme, belirli bir belgede bulunabilir.

### **CSRF/Clickjacking Açıkları**

2FA'yı devre dışı bırakmak için CSRF veya Clickjacking açıklarını araştırmak geçerli bir stratejidir.

### **"Beni Hatırla" Özelliği İstismarı**

#### **Tahmin Edilebilir Çerez Değerleri**

"Beni hatırla" çerez değerini tahmin etmek kısıtlamaları atlayabilir.

#### **IP Adresi Taklidi**

**X-Forwarded-For** başlığı aracılığıyla mağdurun IP adresini taklit etmek kısıtlamaları atlayabilir.

### **Eski Sürümlerin Kullanımı**

#### **Alt Alan Adları**

Alt alan adlarını test etmek, 2FA desteği olmayan eski sürümleri kullanabilir veya savunmasız 2FA uygulamaları içerebilir.

#### **API Uç Noktaları**

/v\*/ dizin yollarıyla gösterilen eski API sürümleri, 2FA bypass yöntemlerine karşı savunmasız olabilir.

### **Önceki Oturumların Yönetimi**

2FA etkinleştirildiğinde mevcut oturumların sonlandırılması, hesapları ihlal edilmiş oturumlardan yetkisiz erişime karşı korur.

### **Yedek Kodlarla Erişim Kontrol Hataları**

2FA etkinleştirildiğinde yedek kodların hemen üretilmesi ve potansiyel yetkisiz erişimi, özellikle CORS yanlış yapılandırmaları/XSS açıkları ile birlikte bir risk oluşturur.

### **2FA Sayfasında Bilgi Açığa Çıkması**

2FA doğrulama sayfasında hassas bilgilerin (örneğin, telefon numarası) ifşa edilmesi bir endişe kaynağıdır.

### **Şifre Sıfırlamanın 2FA'yı Devre Dışı Bırakması**

Bir hesap oluşturma, 2FA etkinleştirme, şifre sıfırlama ve ardından 2FA gereksinimi olmadan giriş yapma sürecini gösteren bir yöntem, potansiyel bir bypass yöntemi olarak değerlendirilebilir.

### **Aldatıcı İstekler**

Kaba kuvvet denemelerini gizlemek veya hız sınırlama mekanizmalarını yanıltmak için aldatıcı istekler kullanmak, bypass stratejilerine bir katman daha ekler. Bu tür istekleri oluşturmak, uygulamanın güvenlik önlemleri ve hız sınırlama davranışları hakkında ince bir anlayış gerektirir.

### OTP Yapılandırma Hataları

Eğer OTP, kullanıcının zaten sahip olduğu verilere veya OTP'yi oluşturmak için gönderilen verilere dayanarak oluşturulursa, kullanıcının da bunu oluşturması ve atlaması mümkündür.

## References

- [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
- [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)
- [https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce](https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce)

P

{{#include ../banners/hacktricks-training.md}}
