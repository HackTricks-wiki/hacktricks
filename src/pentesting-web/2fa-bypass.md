# 2FA/MFA/OTP Bypass

{{#include ../banners/hacktricks-training.md}}

## **Mbinu Zilizoboreshwa za Two-Factor Authentication Bypass**

### **Direct Endpoint Access**

Ili bypass 2FA, fungua endpoint ifuatayo moja kwa moja; kujua path ni muhimu. Ikiwa haifanyi kazi, badilisha header ya **Referrer** ili kuiga navigation kutoka kwenye ukurasa wa 2FA verification.

### **Token Reuse**

Kutumia tena tokens zilizotumika hapo awali kuingia ndani ya account kunaweza kuwa na ufanisi.

### **Utilization of Unused Tokens**

Kuchoma token kutoka kwenye account yako mwenyewe ili bypass 2FA kwenye account nyingine kunaweza kujaribu.

### **Exposure of Token**

Chunguza kama token inafichuka katika response kutoka kwa web application.

### **Verification Link Exploitation**

Kutumia **email verification link** iliyotumwa wakati wa uundaji wa account kunaweza kuruhusu kufikia profile bila 2FA, kama ilivyoelezwa katika [post](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b).

### **Session Manipulation**

Anzisha sessions za account yako na account ya victim, ukamaliza 2FA kwa account yako bila kuendelea, kisha jaribu kufikia hatua inayofuata kwenye flow ya account ya victim, ukitumia mapungufu ya backend session management.

### **Password Reset Mechanism**

Chunguza mekanism ya password reset, ambayo inaweza kumweka mtumiaji ndani ya application baada ya reset, kwa uwezekano wa kuruhusu multiple resets kwa link ile ile. Kuingia kwa credentials zilizoreset inaweza bypass 2FA.

### **OAuth Platform Compromise**

Kuvamia account ya mtumiaji kwenye trusted **OAuth** platform (mfano Google, Facebook) kunaweza kutoa njia ya bypass 2FA.

### **Brute Force Attacks**

#### **Rate Limit Absence**

Ukosefu wa limit ya idadi ya jaribio la codes huruhusu brute force, ingawa kunaweza kuwa na rate limiting ya kimya. 

Kumbuka kwamba hata kama kuna rate limit jaribu kuona kama response inatofautiana wakati OTP sahihi imetumwa. Katika [**post hii**](https://mokhansec.medium.com/the-2-200-ato-most-bug-hunters-overlooked-by-closing-intruder-too-soon-505f21d56732), bug hunter aligundua kwamba hata kama rate limit ilichomwa baada ya jaribio 20 bila mafanikio kwa kuonyesha 401, ikiwa ile sahihi ilitumwa jibu ulikuwa 200.

#### **Slow Brute Force**

Slow brute force inaweza kutumika pale kuna flow rate limits bila limit ya jumla.

#### **Code Resend Limit Reset**

Kutuma tena code kunaweza kupunguza au kureset rate limit, kuruhusu kuendelea na jaribio la brute force.

#### **Client-Side Rate Limit Circumvention**

Nyaraka zinaelezea mbinu za kupita client-side rate limiting.

#### **Internal Actions Lack Rate Limit**

Rate limits zinaweza kulinda login attempts lakini sio internal account actions.

#### **SMS Code Resend Costs**

Kurepeated kutuma codes kwa SMS kunaleta gharama kwa kampuni, ingawa hakutowei bypass ya 2FA.

#### **Infinite OTP Regeneration**

Kuendelea kwa generation ya OTP zenye simple codes kunaruhusu brute force kwa kurudia set ndogo ya codes.

### **Race Condition Exploitation**

Kuendeleza race conditions kwa 2FA bypass kumeandikwa kwenye nyaraka maalum.

### **CSRF/Clickjacking Vulnerabilities**

Kuchunguza CSRF au Clickjacking vulnerabilities ili kuzima 2FA ni mbinu yenye umuhimu.

### **"Remember Me" Feature Exploits**

#### **Predictable Cookie Values**

Kukisia value ya cookie ya "remember me" kunaweza bypass restrictions.

#### **IP Address Impersonation**

Kuiga IP ya victim kupitia header ya **X-Forwarded-For** kunaweza bypass restrictions.

### **Utilizing Older Versions**

#### **Subdomains**

Kujaribu subdomains kunaweza kufunua versions za zamani bila support ya 2FA au zina implementations hatarishi za 2FA.

#### **API Endpoints**

Tazamisha API versions za zamani, zilizoonyeshwa kwa /v*/ directory paths, ambazo zinaweza kuwa hatarishi kwa mbinu za 2FA bypass.

### **Handling of Previous Sessions**

Kumaliza sessions zilizopo wakati wa kuanzishwa kwa 2FA kunalinda accounts dhidi ya ufikiaji usioidhinishwa kutoka kwa sessions zilizo compromise.

### **Access Control Flaws with Backup Codes**

Kujitokeza papo hapo kwa generation na upokeaji wa backup codes wakati wa kuwasha 2FA, hasa pale kuna CORS misconfigurations/XSS vulnerabilities, kunaleta hatari.

### **Information Disclosure on 2FA Page**

Kufichua taarifa nyeti (mfano namba ya simu) kwenye ukurasa wa 2FA verification ni tatizo.

### **Password Reset Disabling 2FA**

Mchakato unaoonyesha njia ya bypass unaelezea uundaji wa account, kuanzisha 2FA, password reset, kisha kuingia bila hitaji la 2FA.

### **Decoy Requests**

Kutumia decoy requests kuficha jaribio la brute force au kudanganya rate limiting kunaongeza tabaka katika mbinu za bypass. Kuunda requests za aina hiyo kunahitaji uelewa mzuri wa security ya application na tabia za rate limiting.

### OTP Construction errors

Iwapo OTP inaundwa kwa kutumia data mtumiaji tayari anayo au data inayotumwa kabla ya kuunda OTP, mtumiaji pia anaweza kuitengeneza na kuitokomeza.

## References

- [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://medium.com/@ISecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35)
- [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)
- [https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce](https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116_1d0f6ce59992222b0812b7cab19a4bce)

P

{{#include ../banners/hacktricks-training.md}}
