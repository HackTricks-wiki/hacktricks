# AW2Exec - GOT/PLT

{{#include ../../../banners/hacktricks-training.md}}

## **Osnovne informacije**

### **GOT: Global Offset Table**

**Global Offset Table (GOT)** je mehanizam koji se koristi u dinamički povezanim binarnim datotekama za upravljanje **adresama spoljašnjih funkcija**. Pošto su te **adrese nepoznate do vremena izvršavanja** (zbog dinamičkog povezivanja), GOT pruža način da se **dinamički ažuriraju adrese ovih spoljašnjih simbola** kada se jednom reše.

Svaki unos u GOT odgovara simbolu u spoljnim bibliotekama koje binarna datoteka može pozvati. Kada se **funkcija prvi put pozove, njena stvarna adresa se rešava putem dinamičkog linker-a i čuva u GOT-u**. Naknadni pozivi iste funkcije koriste adresu koja je sačuvana u GOT-u, čime se izbegava preopterećenje ponovnog rešavanja adrese.

### **PLT: Procedure Linkage Table**

**Procedure Linkage Table (PLT)** blisko sarađuje sa GOT-om i služi kao trampolin za upravljanje pozivima spoljašnjim funkcijama. Kada binarna datoteka **prvi put pozove spoljašnju funkciju, kontrola se prenosi na unos u PLT-u povezan sa tom funkcijom**. Ovaj PLT unos je odgovoran za pozivanje dinamičkog linker-a da reši adresu funkcije ako već nije rešena. Nakon što se adresa reši, ona se čuva u GOT-u.

**Dakle,** GOT unosi se koriste direktno kada se adresa spoljašnje funkcije ili promenljive reši. **PLT unosi se koriste za olakšavanje inicijalnog rešavanja** ovih adresa putem dinamičkog linker-a.

## Dobijanje izvršenja

### Proverite GOT

Dobijte adresu GOT tabele sa: **`objdump -s -j .got ./exec`**

![](<../../../images/image (619).png>)

Posmatrajte kako nakon **učitavanja** **izvršne datoteke** u GEF možete **videti** **funkcije** koje se nalaze u **GOT-u**: `gef➤ x/20x 0xADDR_GOT`

![](<../../../images/image (620) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (5).png>)

Koristeći GEF možete **početi** sesiju **debugovanja** i izvršiti **`got`** da vidite got tabelu:

![](<../../../images/image (621).png>)

### GOT2Exec

U binarnoj datoteci GOT ima **adrese funkcija ili** do **PLT** sekcije koja će učitati adresu funkcije. Cilj ovog proizvoljnog pisanja je da **prepiše GOT unos** funkcije koja će biti izvršena kasnije **sa** **adresom** PLT-a **`system`** **funkcije** na primer.

Idealan scenario je da **prepišete** **GOT** funkcije koja će **biti pozvana sa parametrima koje kontrolišete** (tako da ćete moći da kontrolišete parametre poslati sistemskoj funkciji).

Ako **`system`** **nije korišćen** od strane skripte, sistemska funkcija **neće** imati unos u PLT-u. U ovom scenariju, prvo ćete **morati da iscurite adresu** funkcije `system` a zatim prepisati GOT da pokazuje na ovu adresu.

Možete videti PLT adrese sa **`objdump -j .plt -d ./vuln_binary`**

## **Jedan Gadget**

{{#ref}}
../one-gadget.md
{{#endref}}

## **Zaštite**

Zaštita **Full RELRO** je namenjena zaštiti od ove vrste tehnike rešavanjem svih adresa funkcija kada se binarna datoteka pokrene i čineći **GOT tabelu samo za čitanje** nakon toga:

{{#ref}}
../common-binary-protections-and-bypasses/relro.md
{{#endref}}

## Reference

- [https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite](https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite)
- [https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook](https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook)

{{#include ../../../banners/hacktricks-training.md}}
