# AW2Exec - GOT/PLT

{{#include ../../../banners/hacktricks-training.md}}

## **Taarifa za Msingi**

### **GOT: Meza ya Uhamisho wa Kimataifa**

**Meza ya Uhamisho wa Kimataifa (GOT)** ni mekanizma inayotumika katika binaries zilizounganishwa kwa njia ya kidinamikia ili kudhibiti **anwani za kazi za nje**. Kwa kuwa **anwani hizi hazijulikani hadi wakati wa utekelezaji** (kwa sababu ya uunganishaji wa kidinamikia), GOT inatoa njia ya **kudumisha anwani za alama hizi za nje** mara tu zinapokuwa zimepatiwa.

Kila kipengele katika GOT kinahusiana na alama katika maktaba za nje ambazo binary inaweza kuita. Wakati **kazi inapoitwa kwa mara ya kwanza, anwani yake halisi inapatikana na linker ya kidinamikia na kuhifadhiwa katika GOT**. Kuitwa kwa kazi hiyo tena hutumia anwani iliyohifadhiwa katika GOT, hivyo kuepusha mzigo wa kutafuta anwani hiyo tena.

### **PLT: Meza ya Uunganishaji wa Taratibu**

**Meza ya Uunganishaji wa Taratibu (PLT)** inafanya kazi kwa karibu na GOT na inatumika kama trampoline kushughulikia simu za kazi za nje. Wakati binary **inapoiita kazi ya nje kwa mara ya kwanza, udhibiti unapelekwa kwenye kipengele katika PLT kinachohusiana na kazi hiyo**. Kipengele hiki cha PLT kinawajibika kwa kuita linker ya kidinamikia ili kutafuta anwani ya kazi hiyo ikiwa haijapatikana tayari. Baada ya anwani kupatikana, inahifadhiwa katika GOT.

**Hivyo,** vipengele vya GOT vinatumika moja kwa moja mara tu anwani ya kazi au variable ya nje inapokuwa imepatiwa. **Vipengele vya PLT vinatumika kuwezesha kutafuta awali** za anwani hizi kupitia linker ya kidinamikia.

## Pata Utekelezaji

### Angalia GOT

Pata anwani ya meza ya GOT kwa: **`objdump -s -j .got ./exec`**

![](<../../../images/image (619).png>)

Tazama jinsi baada ya **kupakia** **executable** katika GEF unaweza **kuona** **kazi** ambazo ziko katika **GOT**: `gefâž¤ x/20x 0xADDR_GOT`

![](<../../../images/image (620) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (5).png>)

Kwa kutumia GEF unaweza **kuanza** kikao cha **debugging** na kutekeleza **`got`** ili kuona meza ya got:

![](<../../../images/image (621).png>)

### GOT2Exec

Katika binary, GOT ina **anwani za kazi au** kwa **sehemu ya PLT** ambayo itapakia anwani ya kazi. Lengo la kuandika hii bila mpangilio ni **kufuta kipengele cha GOT** cha kazi ambayo itatekelezwa baadaye **kwa** **anwani** ya PLT ya **`system`** **kazi** kwa mfano.

Kwa njia bora, utakuwa **unafuta** **GOT** ya **kazi** ambayo **itaitwa kwa vigezo vinavyodhibitiwa na wewe** (hivyo utaweza kudhibiti vigezo vinavyotumwa kwa kazi ya mfumo).

Ikiwa **`system`** **haitumiki** na script, kazi ya mfumo **haitakuwa** na kipengele katika PLT. Katika hali hii, utahitaji **kuvuja kwanza anwani** ya kazi ya `system` na kisha kufuta GOT ili kuelekeza kwenye anwani hii.

Unaweza kuona anwani za PLT kwa **`objdump -j .plt -d ./vuln_binary`**

## **One Gadget**

{{#ref}}
../one-gadget.md
{{#endref}}

## **Ulinzi**

Ulinzi wa **Full RELRO** unakusudia kulinda dhidi ya aina hii ya mbinu kwa kutafuta anwani zote za kazi wakati binary inaanza na kufanya meza ya **GOT iwe ya kusoma tu** baada ya hapo:

{{#ref}}
../common-binary-protections-and-bypasses/relro.md
{{#endref}}

## Marejeleo

- [https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite](https://ir0nstone.gitbook.io/notes/types/stack/got-overwrite/exploiting-a-got-overwrite)
- [https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook](https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook)

{{#include ../../../banners/hacktricks-training.md}}
