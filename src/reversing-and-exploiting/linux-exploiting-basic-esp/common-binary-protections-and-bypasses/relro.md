# Relro

{{#include ../../../banners/hacktricks-training.md}}

## Relro

**RELRO**は**Relocation Read-Only**の略で、**GOT (Global Offset Table)**の上書きに関連するリスクを軽減するためにバイナリで使用されるセキュリティ機能です。この概念を明確にするために、2つの異なるタイプに分けて説明します: **Partial RELRO**と**Full RELRO**。

### **Partial RELRO**

**Partial RELRO**は、バイナリのパフォーマンスに大きな影響を与えずにセキュリティを強化するためのよりシンプルなアプローチを取ります。**GOTをプログラムの変数の上に配置することにより、Partial RELROはバッファオーバーフローがGOTに到達して破損するのを防ぐことを目的としています**。&#x20;

これは**任意の書き込み**の脆弱性からGOTが悪用されるのを防ぐものではありません。

### **Full RELRO**

**Full RELRO**は、**GOTを完全に読み取り専用にすることによって保護を強化します。** バイナリが起動すると、すべての関数アドレスが解決されてGOTにロードされ、その後、GOTは読み取り専用としてマークされ、実行時にそれに対する変更を効果的に防ぎます。

しかし、Full RELROのトレードオフはパフォーマンスと起動時間に関するものです。GOTを読み取り専用としてマークする前にすべての動的シンボルを起動時に解決する必要があるため、**Full RELROが有効なバイナリは読み込み時間が長くなる可能性があります**。この追加の起動オーバーヘッドが、Full RELROがすべてのバイナリでデフォルトで有効になっていない理由です。

バイナリでFull RELROが有効かどうかを確認することができます:
```bash
readelf -l /proc/ID_PROC/exe | grep BIND_NOW
```
## バイパス

フル RELRO が有効な場合、バイパスする唯一の方法は、任意の実行を得るために GOT テーブルに書き込む必要のない別の方法を見つけることです。

LIBC の GOT は通常パーシャル RELRO であるため、任意の書き込みで変更できます。詳細は [Targetting libc GOT entries](https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md#1---targetting-libc-got-entries) を参照してください。

{{#include ../../../banners/hacktricks-training.md}}
