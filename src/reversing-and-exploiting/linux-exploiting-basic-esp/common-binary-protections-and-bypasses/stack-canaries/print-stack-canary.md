# Print Stack Canary

{{#include ../../../../banners/hacktricks-training.md}}

## Enlarge printed stack

एक ऐसी स्थिति की कल्पना करें जहां एक **program vulnerable** स्टैक ओवरफ्लो को **puts** फ़ंक्शन **pointing** कर सकता है **part** of the **stack overflow**. हमलावर जानता है कि **canary का पहला बाइट एक null byte** है (`\x00`) और बाकी का canary **random** बाइट्स हैं। फिर, हमलावर एक ओवरफ्लो बना सकता है जो **stack को ओवरराइट करता है जब तक कि केवल canary का पहला बाइट** न रह जाए।

फिर, हमलावर **payload** के मध्य में puts फ़ंक्शन को **call** करता है जो **सभी canary को प्रिंट करेगा** (पहले null byte को छोड़कर)।

इस जानकारी के साथ, हमलावर **canary को जानकर एक नया हमला तैयार और भेज सकता है** (उसी प्रोग्राम सत्र में)।

स्पष्ट रूप से, यह रणनीति बहुत **restricted** है क्योंकि हमलावर को अपने **payload** की **content** को **print** करने में सक्षम होना चाहिए ताकि **canary** को **exfiltrate** कर सके और फिर एक नया payload (उसी **program session** में) बना सके और **real buffer overflow** को **send** कर सके।

**CTF examples:**&#x20;

- [**https://guyinatuxedo.github.io/08-bof_dynamic/csawquals17_svc/index.html**](https://guyinatuxedo.github.io/08-bof_dynamic/csawquals17_svc/index.html)
- 64 bit, ASLR सक्षम लेकिन कोई PIE नहीं, पहला कदम एक ओवरफ्लो को भरना है जब तक कि canary का byte 0x00 न हो जाए ताकि फिर puts को कॉल किया जा सके और इसे लीक किया जा सके। canary के साथ एक ROP gadget बनाया जाता है जो puts को कॉल करता है ताकि GOT से puts का पता लीक किया जा सके और फिर एक ROP gadget जो `system('/bin/sh')` को कॉल करता है।

## Arbitrary Read

एक मनमाने पढ़ने के साथ जैसे कि फॉर्मेट **strings** द्वारा प्रदान किया गया, canary को लीक करना संभव हो सकता है। इस उदाहरण को देखें: [**https://ir0nstone.gitbook.io/notes/types/stack/canaries**](https://ir0nstone.gitbook.io/notes/types/stack/canaries) और आप पढ़ सकते हैं कि फॉर्मेट स्ट्रिंग्स का दुरुपयोग करके मनमाने मेमोरी पते को कैसे पढ़ा जाए:

{{#ref}}
../../format-strings/
{{#endref}}

{{#include ../../../../banners/hacktricks-training.md}}
