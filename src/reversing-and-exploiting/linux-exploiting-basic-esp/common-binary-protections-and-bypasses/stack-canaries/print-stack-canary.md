# Print Stack Canary

{{#include ../../../../banners/hacktricks-training.md}}

## Enlarge printed stack

एक ऐसी स्थिति की कल्पना करें जहाँ एक **program vulnerable** to stack overflow एक **puts** फ़ंक्शन को **pointing** कर सकता है **part** of the **stack overflow**. हमलावर जानता है कि **canary का पहला बाइट एक null byte** है (`\x00`) और बाकी का canary **random** बाइट्स हैं। फिर, हमलावर एक overflow बना सकता है जो **stack को overwrite करता है जब तक कि canary का पहला बाइट** न हो।

फिर, हमलावर **payload** के मध्य में puts फ़ंक्शन को **call** करता है जो **सभी canary को print करेगा** (पहले null byte को छोड़कर)।

इस जानकारी के साथ हमलावर **एक नया हमला तैयार और भेज सकता है** जानकर कि canary (उसी program session में)।

स्पष्ट रूप से, यह रणनीति बहुत **restricted** है क्योंकि हमलावर को **print** करने में सक्षम होना चाहिए **content** अपने **payload** का ताकि **canary** को **exfiltrate** कर सके और फिर एक नया payload बना सके (उसी **program session** में) और **send** कर सके **real buffer overflow**।

**CTF examples:**

- [**https://guyinatuxedo.github.io/08-bof_dynamic/csawquals17_svc/index.html**](https://guyinatuxedo.github.io/08-bof_dynamic/csawquals17_svc/index.html)
- 64 bit, ASLR सक्षम लेकिन कोई PIE नहीं, पहला कदम एक overflow को भरना है जब तक कि canary का byte 0x00 न हो ताकि फिर puts को call किया जा सके और इसे leak किया जा सके। canary के साथ एक ROP gadget बनाया जाता है जो puts को leak करने के लिए GOT से puts का पता कॉल करता है और फिर एक ROP gadget जो `system('/bin/sh')` को कॉल करता है।

## Arbitrary Read

एक arbitrary read के साथ जैसे कि format **strings** द्वारा प्रदान किया गया, यह canary को leak करना संभव हो सकता है। इस उदाहरण को देखें: [**https://ir0nstone.gitbook.io/notes/types/stack/canaries**](https://ir0nstone.gitbook.io/notes/types/stack/canaries) और आप पढ़ सकते हैं कि format strings का दुरुपयोग करके arbitrary memory addresses को पढ़ने के बारे में:

{{#ref}}
../../format-strings/
{{#endref}}

{{#include ../../../../banners/hacktricks-training.md}}
