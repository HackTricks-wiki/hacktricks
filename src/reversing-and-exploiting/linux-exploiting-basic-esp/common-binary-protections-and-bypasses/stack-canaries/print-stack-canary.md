# Print Stack Canary

{{#include ../../../../banners/hacktricks-training.md}}

## Büyütülmüş yazdırılmış yığın

Yığın taşmasına **duyarlı** bir **programın** **stack overflow**'un **bir kısmına** **işaret eden** bir **puts** fonksiyonunu çalıştırabildiği bir durumu hayal edin. Saldırgan, **kanaryanın ilk baytının bir null bayt olduğunu** (`\x00`) ve kanaryanın geri kalanının **rastgele** baytlar olduğunu bilir. Ardından, saldırgan **kanaryanın ilk baytına kadar yığını** **aşan** bir taşma oluşturabilir.

Sonra, saldırgan **payload'un ortasında puts fonksiyonunu** **çağırır** ve bu, **kanaryayı** (ilk null bayt hariç) **yazdırır**.

Bu bilgiyle saldırgan, kanaryayı (aynı program oturumunda) bilerek **yeni bir saldırı oluşturup gönderebilir**.

Açıkça, bu taktik çok **kısıtlıdır** çünkü saldırgan, **kanaryayı** **sızdırmak** için **payload'unun içeriğini** **yazdırabilmelidir** ve ardından **yeni bir payload** oluşturup (aynı program oturumunda) **gerçek buffer overflow'u** **gönderebilmelidir**.

**CTF örnekleri:**&#x20;

- [**https://guyinatuxedo.github.io/08-bof_dynamic/csawquals17_svc/index.html**](https://guyinatuxedo.github.io/08-bof_dynamic/csawquals17_svc/index.html)
- 64 bit, ASLR etkin ama PIE yok, ilk adım kanaryanın 0x00 baytına kadar bir taşma doldurmak ve ardından puts'u çağırarak sızdırmaktır. Kanarya ile bir ROP gadget'ı oluşturulur, puts'u çağırarak GOT'tan puts'un adresini sızdırır ve ardından `system('/bin/sh')` çağırmak için bir ROP gadget'ı oluşturur.

## Keyfi Okuma

Format **string'leri** tarafından sağlanan keyfi bir okuma ile kanaryayı sızdırmak mümkün olabilir. Bu örneğe bakın: [**https://ir0nstone.gitbook.io/notes/types/stack/canaries**](https://ir0nstone.gitbook.io/notes/types/stack/canaries) ve keyfi bellek adreslerini okumak için format string'lerini kötüye kullanma hakkında okuyabilirsiniz:

{{#ref}}
../../format-strings/
{{#endref}}

{{#include ../../../../banners/hacktricks-training.md}}
