# Print Stack Canary

{{#include ../../../../banners/hacktricks-training.md}}

## Enlarge printed stack

Zamislite situaciju u kojoj **program koji je ranjiv** na stack overflow može da izvrši **puts** funkciju **koja pokazuje** na **deo** **stack overflow**. Napadač zna da je **prvi bajt kanarija null bajt** (`\x00`) i da su ostali bajtovi kanarija **nasumični**. Tada, napadač može da napravi overflow koji **prepisuje stack sve do prvog bajta kanarija**.

Zatim, napadač **poziva puts funkcionalnost** u sredini payload-a koja će **odštampati ceo kanarij** (osim prvog null bajta).

Sa ovom informacijom, napadač može da **pripremi i pošalje novi napad** znajući kanarij (u istoj sesiji programa).

Očigledno, ova taktika je veoma **ograničena** jer napadač mora da bude u mogućnosti da **odštampa** **sadržaj** svog **payload-a** da bi **ekstrahovao** **kanarij** i zatim da može da kreira novi payload (u **istoј sesiji programa**) i **pošalje** **pravi buffer overflow**.

**CTF primeri:**

- [**https://guyinatuxedo.github.io/08-bof_dynamic/csawquals17_svc/index.html**](https://guyinatuxedo.github.io/08-bof_dynamic/csawquals17_svc/index.html)
- 64 bita, ASLR omogućen ali bez PIE, prvi korak je da se popuni overflow do bajta 0x00 kanarija da bi se zatim pozvao puts i iscurio. Sa kanarijem se kreira ROP gadget za pozivanje puts da bi se iscurila adresa puts iz GOT-a i ROP gadget za pozivanje `system('/bin/sh')`

## Arbitrary Read

Sa proizvoljnim čitanjem poput onog koji pružaju format **stringovi** može biti moguće iscuriti kanarij. Proverite ovaj primer: [**https://ir0nstone.gitbook.io/notes/types/stack/canaries**](https://ir0nstone.gitbook.io/notes/types/stack/canaries) i možete pročitati o zloupotrebi format stringova za čitanje proizvoljnih memorijskih adresa u:

{{#ref}}
../../format-strings/
{{#endref}}

{{#include ../../../../banners/hacktricks-training.md}}
