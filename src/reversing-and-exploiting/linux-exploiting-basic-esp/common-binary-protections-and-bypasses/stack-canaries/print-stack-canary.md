# Print Stack Canary

{{#include ../../../../banners/hacktricks-training.md}}

## Uvećaj štampanu stog

Zamislite situaciju u kojoj **program koji je ranjiv** na prelivanje stoga može izvršiti **puts** funkciju **koja pokazuje** na **deo** **prelivanja stoga**. Napadač zna da je **prvi bajt kanarija null bajt** (`\x00`) i da su ostali bajtovi kanarija **nasumični**. Tada napadač može kreirati preliv koji **prepisuje stog sve do prvog bajta kanarija**.

Zatim, napadač **poziva puts funkcionalnost** na sredini payload-a koja će **štampati sve kanarije** (osim prvog null bajta).

Sa ovom informacijom napadač može **izraditi i poslati novi napad** znajući kanarija (u istoj sesiji programa).

Očigledno, ova taktika je veoma **ograničena** jer napadač mora biti u mogućnosti da **štampa** **sadržaj** svog **payload-a** da bi **ekstrahovao** **kanarija** i zatim biti u mogućnosti da kreira novi payload (u **istoј sesiji programa**) i **pošalje** **pravi buffer overflow**.

**CTF primeri:**&#x20;

- [**https://guyinatuxedo.github.io/08-bof_dynamic/csawquals17_svc/index.html**](https://guyinatuxedo.github.io/08-bof_dynamic/csawquals17_svc/index.html)
- 64 bita, ASLR omogućeno, ali bez PIE, prvi korak je popuniti preliv do bajta 0x00 kanarija da bi se zatim pozvao puts i otkrio ga. Sa kanarijem se kreira ROP gadget za pozivanje puts da bi se otkrila adresa puts iz GOT-a i ROP gadget za pozivanje `system('/bin/sh')`

## Arbitrarni Čitanje

Sa arbitrarnim čitanjem poput onog koji pružaju format **stringovi** može biti moguće otkriti kanarija. Proverite ovaj primer: [**https://ir0nstone.gitbook.io/notes/types/stack/canaries**](https://ir0nstone.gitbook.io/notes/types/stack/canaries) i možete pročitati o zloupotrebi format stringova za čitanje arbitrarnim memorijskim adresama u:

{{#ref}}
../../format-strings/
{{#endref}}

{{#include ../../../../banners/hacktricks-training.md}}
