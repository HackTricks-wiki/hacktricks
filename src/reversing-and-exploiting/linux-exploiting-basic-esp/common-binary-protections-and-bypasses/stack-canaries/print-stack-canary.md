# Druk Stap Canarie

{{#include ../../../../banners/hacktricks-training.md}}

## Vergroot gedrukte stap

Stel jou 'n situasie voor waar 'n **program wat kwesbaar is** vir stap oorgang 'n **puts** funksie kan uitvoer wat **wys** na **gedeelte** van die **stap oorgang**. Die aanvaller weet dat die **eerste byte van die canarie 'n null byte is** (`\x00`) en die res van die canarie is **ewekansige** bytes. Dan kan die aanvaller 'n oorgang skep wat die **stap oorskryf tot net die eerste byte van die canarie**.

Dan **roep die aanvaller die puts funksionaliteit** in die middel van die payload wat **alle canarie** sal **druk** (behalwe vir die eerste null byte).

Met hierdie inligting kan die aanvaller 'n **nuwe aanval saamstel en stuur** terwyl hy die canarie ken (in dieselfde program sessie).

Dit is duidelik dat hierdie taktiek baie **beperk** is aangesien die aanvaller in staat moet wees om die **inhoud** van sy **payload** te **druk** om die **canarie** te **exfiltreer** en dan in staat te wees om 'n nuwe payload te skep (in die **dieselfde program sessie**) en die **werklike buffer oorgang** te **stuur**.

**CTF voorbeelde:**&#x20;

- [**https://guyinatuxedo.github.io/08-bof_dynamic/csawquals17_svc/index.html**](https://guyinatuxedo.github.io/08-bof_dynamic/csawquals17_svc/index.html)
- 64 bit, ASLR geaktiveer maar geen PIE, die eerste stap is om 'n oorgang te vul tot die byte 0x00 van die canarie om dan puts te roep en dit te lek. Met die canarie word 'n ROP gadget geskep om puts te roep om die adres van puts van die GOT te lek en dan 'n ROP gadget om `system('/bin/sh')` te roep.

## Arbitraire Lees

Met 'n arbitraire lees soos die een wat deur formaat **strings** verskaf word, mag dit moontlik wees om die canarie te lek. Kyk na hierdie voorbeeld: [**https://ir0nstone.gitbook.io/notes/types/stack/canaries**](https://ir0nstone.gitbook.io/notes/types/stack/canaries) en jy kan lees oor die misbruik van formaat strings om arbitraire geheue adresse te lees in:

{{#ref}}
../../format-strings/
{{#endref}}

{{#include ../../../../banners/hacktricks-training.md}}
