# ポインタリダイレクティング

{{#include ../../../banners/hacktricks-training.md}}

## 文字列ポインタ

関数呼び出しがスタックにある文字列のアドレスを使用する場合、バッファオーバーフローを悪用して**このアドレスを上書きし**、**バイナリ内の別の文字列のアドレスを置く**ことが可能です。

例えば、**`system`** 関数呼び出しが**コマンドを実行するために文字列のアドレスを使用する**場合、攻撃者は**スタックに別の文字列のアドレスを置くことができ**、**`export PATH=.:$PATH`** とし、現在のディレクトリに**新しい文字列の最初の文字の名前のスクリプトを作成する**ことができます。これにより、バイナリによって実行されます。

以下にこの例を示します：

- [https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/strptr.c](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/strptr.c)
- [https://guyinatuxedo.github.io/04-bof_variable/tw17_justdoit/index.html](https://guyinatuxedo.github.io/04-bof_variable/tw17_justdoit/index.html)
- 32ビット、スタック内のフラグ文字列のアドレスを変更して`puts`で印刷されるようにします。

## 関数ポインタ

文字列ポインタと同様ですが、関数に適用されます。**スタックに呼び出される関数のアドレスが含まれている**場合、**それを変更する**ことが可能です（例：**`system`**を呼び出すために）。

以下にこの例を示します：

- [https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/funcptr.c](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/funcptr.c)

## 参考文献

- [https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/NOTES.md#pointer-redirecting](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/NOTES.md#pointer-redirecting)

{{#include ../../../banners/hacktricks-training.md}}
