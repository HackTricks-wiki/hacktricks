# One Gadget

{{#include ../../banners/hacktricks-training.md}}

## 基本信息

[**One Gadget**](https://github.com/david942j/one_gadget) 允许获取一个 shell，而不是使用 **system** 和 **"/bin/sh"**。**One Gadget** 将在 libc 库中找到一些方法来获取一个 shell (`execve("/bin/sh")`)，只需一个 **地址**。\
然而，通常会有一些限制，最常见且容易避免的限制是 `[rsp+0x30] == NULL`。由于你控制 **RSP** 内部的值，你只需发送一些额外的 NULL 值，以避免这个限制。

![](<../../images/image (615).png>)
```python
ONE_GADGET = libc.address + 0x4526a
rop2 = base + p64(ONE_GADGET) + "\x00"*100
```
要到达 One Gadget 指定的地址，您需要 **添加 `libc` 加载的基地址**。

> [!TIP]
> One Gadget 对于 **任意写入 2 执行技术** 是一个 **很大的帮助**，并且可能 **简化 ROP 链**，因为您只需调用一个地址（并满足要求）。

{{#include ../../banners/hacktricks-training.md}}
