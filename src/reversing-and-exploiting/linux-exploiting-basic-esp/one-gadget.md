# One Gadget

{{#include ../../banners/hacktricks-training.md}}

## Grundinformationen

[**One Gadget**](https://github.com/david942j/one_gadget) ermöglicht es, eine Shell zu erhalten, anstatt **system** und **"/bin/sh"** zu verwenden. **One Gadget** findet in der libc-Bibliothek eine Möglichkeit, eine Shell zu erhalten (`execve("/bin/sh")`), indem es nur eine **Adresse** verwendet.\
Normalerweise gibt es jedoch einige Einschränkungen, die häufigsten und am einfachsten zu vermeidenden sind wie `[rsp+0x30] == NULL`. Da Sie die Werte im **RSP** kontrollieren, müssen Sie nur einige weitere NULL-Werte senden, damit die Einschränkung umgangen wird.

![](<../../images/image (615).png>)
```python
ONE_GADGET = libc.address + 0x4526a
rop2 = base + p64(ONE_GADGET) + "\x00"*100
```
Um die von One Gadget angegebene Adresse zu erreichen, müssen Sie **die Basisadresse hinzufügen, an der `libc`** geladen ist.

> [!TIP]
> One Gadget ist eine **große Hilfe für Arbitrary Write 2 Exec-Techniken** und kann **ROP-Ketten vereinfachen**, da Sie nur eine Adresse aufrufen müssen (und die Anforderungen erfüllen müssen).

{{#include ../../banners/hacktricks-training.md}}
