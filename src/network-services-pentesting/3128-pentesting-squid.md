# 3128/tcp - Pentesting Squid

{{#include ../banners/hacktricks-training.md}}

## बुनियादी जानकारी

स्रोत: [Wikipedia](<https://en.wikipedia.org/wiki/Squid_(software)>):

> **Squid** एक कैशिंग और फॉरवर्डिंग HTTP वेब प्रॉक्सी है। इसके कई उपयोग हैं, जिनमें बार-बार आने वाली रिक्वेस्ट्स को कैश करके वेब सर्वर को तेज़ करना, नेटवर्क संसाधन साझा करने वाले लोगों के समूह के लिए वेब, DNS और अन्य कंप्यूटर नेटवर्क लुकअप्स को कैश करना, और ट्रैफ़िक फ़िल्टर करके सुरक्षा में मदद करना शामिल है। हालांकि मुख्यतः HTTP और FTP के लिए उपयोग किया जाता है, Squid में Internet Gopher, SSL, TLS और HTTPS सहित कई अन्य प्रोटोकॉल के लिए सीमित समर्थन शामिल है। Squid SOCKS प्रोटोकॉल का समर्थन नहीं करता, इसके विपरीत Privoxy, जिसके साथ Squid का उपयोग SOCKS समर्थन प्रदान करने के लिए किया जा सकता है।

**डिफ़ॉल्ट पोर्ट:** 3128
```
PORT     STATE  SERVICE      VERSION
3128/tcp open   http-proxy   Squid http proxy 4.11
```
## Enumeration

### Web Proxy

आप अपने ब्राउज़र में इस खोजी गई service को proxy के रूप में सेट करने की कोशिश कर सकते हैं। हालाँकि, यदि यह HTTP authentication के साथ कॉन्फ़िगर किया गया है तो आपसे username और password मांगे जाएंगे।
```bash
# Try to proxify curl
curl --proxy http://10.10.11.131:3128 http://10.10.11.131
```
### Nmap proxified

आप proxy का दुरुपयोग करके भी **scan internal ports proxifying nmap** की कोशिश कर सकते हैं।\
Configure proxychains to use the squid proxy adding he following line at the end of the proxichains.conf file: `http 10.10.10.10 3128`  
For proxies requiring authentication, append credentials to the configuration by including the username and password at the end: `http 10.10.10.10 3128 username passw0rd`.

Then run nmap with proxychains to **scan the host from local**: `proxychains nmap -sT -n -p- localhost`

### SPOSE Scanner

वैकल्पिक रूप से, Squid Pivoting Open Port Scanner ([spose.py](https://github.com/aancw/spose)) का उपयोग किया जा सकता है।
```bash
python spose.py --proxy http://10.10.11.131:3128 --target 10.10.11.131
```
### Pivot & tooling कॉन्फ़िगरेशन

*CLI और browser tools के लिए Squid को एक discovery pivot और एक transparent upstream hop के रूप में उपयोग करें.*

- **Scan “from” the proxy:** Squid के माध्यम से SPOSE चलाकर proxy host/loopback से पहुँचने योग्य पोर्ट्स सूचीबद्ध करें। [uv](https://github.com/astral-sh/uv) के साथ आप deps इंस्टॉल कर सकते हैं और सीधे सभी TCP पोर्ट स्कैन कर सकते हैं:
```bash
uv add --script spose.py -r requirements.txt
uv run spose.py --proxy http://SQUID_IP:3128 --target localhost --allports
```
- **Proxychains for HTTP interaction:** `/etc/proxychains.conf` के नीचे एक सख्त HTTP एंट्री जोड़ें:
```ini
[ProxyList]
http    SQUID_IP   3128
```
फिर internal listeners (उदा., 127.0.0.1 पर बाइंड किया गया web UI) के साथ Squid के माध्यम से पारदर्शी रूप से इंटरैक्ट करें:
```bash
proxychains curl http://127.0.0.1:9191 -v
```
- **Chaining Burp/Browser → Squid:** Burp *Proxy → Settings → Network → Connections → Upstream proxy servers* को `http://SQUID_IP:3128` की ओर पॉइंट करने के लिए कॉन्फ़िगर करें। `http://127.0.0.1:9191` जैसे internal hosts के अनुरोध Browser → Burp → Squid → target के माध्यम से जाएंगे, जिससे बाहरी रूप से पहुँच न होने वाली सेवाओं का पूरा interception संभव हो जाएगा।

## संदर्भ

- [SPOSE – Squid Pivoting Open Port Scanner](https://github.com/aancw/spose)
- [HTB Bamboo walkthrough (Squid pivoting example)](https://0xdf.gitlab.io/2026/02/03/htb-bamboo.html)

{{#include ../banners/hacktricks-training.md}}
