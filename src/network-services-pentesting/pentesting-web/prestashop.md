# PrestaShop

{{#include ../../banners/hacktricks-training.md}}

## Od XSS do RCE

- [**PrestaXSRF**](https://github.com/nowak0x01/PrestaXSRF): PrestaShop Exploitation Script that elevate **XSS to RCE or Others Critical Vulnerabilities.** For more info check [**this post**](https://nowak0x01.github.io/papers/76bc0832a8f682a7e0ed921627f85d1d.html). It provides **support for PrestaShop Versions 8.X.X and 1.7.X.X, and allows to:**
- _**(RCE) PSUploadModule(); - Upload a custom Module:**_ Otpremi Persistent Module (backdoor) u PrestaShop.

## ps_checkout ExpressCheckout silent login account takeover (CVE-2025-61922)

> Nedostatak validacije identiteta u `ps_checkout` modulu `< 5.0.5` omogućava neautentifikovanom napadaču da **prebaci sesiju na bilo kog kupca tako što će dostaviti njihov email**.

- **Endpoint (unauth):** `POST /module/ps_checkout/ExpressCheckout`.
- **Tok:** `ExpressCheckout.php` prihvata attacker JSON, proverava samo `orderID`, gradi `ExpressCheckoutRequest` i poziva `ExpressCheckoutAction::execute()`.
- **Greška u autentifikaciji:** U ranjivim verzijama `ExpressCheckoutAction` poziva `CustomerAuthenticationAction::execute()` kada nijedan korisnik nije prijavljen. Ta metoda jednostavno radi `customerExists(<payer_email>)` i `context->updateCustomer(new Customer($id))`, tako da **postojanje email-a == prijava** (bez provere lozinke/tokena).
- **Polje e-maila pod kontrolom napadača:** `order.payer.email_address` unutar JSON payload-a se čita pomoću `ExpressCheckoutRequest::getPayerEmail()`.

### Koraci eksploatacije

1. Prikupite bilo koji registrovani email kupca (admin je odvojen i nije pogođen ovim tokom).
2. Pošaljite neautentifikovani POST na kontroler sa `orderID` i email-om žrtve u `order.payer.email_address`.
3. Čak i ako endpoint vrati `500`, odgovor će sadržati kolačiće za kontekst kupca žrtve (sesija je već promenjena), omogućavajući pristup PII ili kupovinu sa sačuvanim karticama.
```http
POST /module/ps_checkout/ExpressCheckout HTTP/1.1
Host: `<target>`
Content-Type: application/json
Content-Length: 72

{"orderID":"1","order":{"payer":{"email_address":"victim@example.com"}}}
```
## Referencije

- [CVE-2025-61922: Zero-Click Account Takeover on Prestashop (blog)](https://dhakal-ananda.com.np/blogs/cve-2025-61922-analysis/)
- [GitHub Advisory GHSA-54hq-mf6h-48xh](https://github.com/PrestaShopCorp/ps_checkout/security/advisories/GHSA-54hq-mf6h-48xh)

{{#include ../../banners/hacktricks-training.md}}
