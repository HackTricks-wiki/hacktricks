# PrestaShop

{{#include ../../banners/hacktricks-training.md}}

## From XSS to RCE

- [**PrestaXSRF**](https://github.com/nowak0x01/PrestaXSRF): PrestaShop Exploitation Script ambayo inainua **XSS hadi RCE au Other Critical Vulnerabilities.** Kwa taarifa za ziada angalia [**this post**](https://nowak0x01.github.io/papers/76bc0832a8f682a7e0ed921627f85d1d.html). Inatoa **support kwa PrestaShop Versions 8.X.X na 1.7.X.X, na inaruhusu:**
- _**(RCE) PSUploadModule(); - Upload a custom Module:**_ Pakia Persistent Module (backdoor) kwa PrestaShop.

## ps_checkout ExpressCheckout silent login account takeover (CVE-2025-61922)

> Missing identity validation in the `ps_checkout` module `< 5.0.5` inamruhusu mshambuliaji asiyeidhinishwa **kubadilisha session kwa mteja yeyote kwa kutoa email yao**.

- **Endpoint (unauth):** `POST /module/ps_checkout/ExpressCheckout`.
- **Flow:** `ExpressCheckout.php` inapokea JSON ya mshambuliaji, inachunguza tu `orderID`, inajenga `ExpressCheckoutRequest` na inaita `ExpressCheckoutAction::execute()`.
- **Auth bug:** Katika versions zilizo na vunjifu `ExpressCheckoutAction` inaita `CustomerAuthenticationAction::execute()` wakati hakuna user ameloga. Mbinu hiyo inafanya tu `customerExists(<payer_email>)` na `context->updateCustomer(new Customer($id))`, hivyo **uwepo wa email == login** (hakuna ukaguzi wa password/token).
- **Attacker-controlled email field:** `order.payer.email_address` ndani ya JSON payload inasomwa na `ExpressCheckoutRequest::getPayerEmail()`.

### Exploitation steps

1. Kusanya email yoyote ya mteja iliyosajiliwa (admin ni tofauti na haathiriwi na flow hii).
2. Tuma POST isiyoidhinishwa kwa controller na `orderID` pamoja na email ya mhanga kwenye `order.payer.email_address`.
3. Hata kama endpoint inarudisha `500`, response itajumuisha cookies za context ya mteja wa mhanga (session tayari imesimbuliwa), ikiruhusu upatikanaji wa PII au kununua kwa kutumia saved cards.
```http
POST /module/ps_checkout/ExpressCheckout HTTP/1.1
Host: `<target>`
Content-Type: application/json
Content-Length: 72

{"orderID":"1","order":{"payer":{"email_address":"victim@example.com"}}}
```
## Marejeo

- [CVE-2025-61922: Zero-Click Account Takeover on Prestashop (blogu)](https://dhakal-ananda.com.np/blogs/cve-2025-61922-analysis/)
- [GitHub Advisory GHSA-54hq-mf6h-48xh](https://github.com/PrestaShopCorp/ps_checkout/security/advisories/GHSA-54hq-mf6h-48xh)

{{#include ../../banners/hacktricks-training.md}}
