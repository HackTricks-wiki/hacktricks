# PrestaShop

{{#include ../../banners/hacktricks-training.md}}

## XSS'ten RCE'ye

- [**PrestaXSRF**](https://github.com/nowak0x01/PrestaXSRF): PrestaShop Exploitation Script, **XSS'i RCE'ye veya diğer kritik zafiyetlere yükseltir.** Daha fazla bilgi için [**this post**](https://nowak0x01.github.io/papers/76bc0832a8f682a7e0ed921627f85d1d.html) adresine bakın. Ayrıca **PrestaShop Sürümleri 8.X.X ve 1.7.X.X için destek sağlar ve şunlara izin verir:**
- _**(RCE) PSUploadModule(); - Upload a custom Module:**_ PrestaShop'a Persistent Module (backdoor) yükler.

## ps_checkout ExpressCheckout sessiz oturum açma hesap ele geçirme (CVE-2025-61922)

> `ps_checkout` modülünde `< 5.0.5` kimlik doğrulaması eksikliği, kimliği doğrulanmamış bir saldırganın **oturumu herhangi bir müşteriye e‑posta sağlayarak değiştirmesine** izin verir.

- **Endpoint (unauth):** `POST /module/ps_checkout/ExpressCheckout`.
- **Akış:** `ExpressCheckout.php` saldırganın JSON'unu kabul eder, sadece `orderID`'yi kontrol eder, `ExpressCheckoutRequest` oluşturur ve `ExpressCheckoutAction::execute()` çağırır.
- **Auth bug:** Zaafiyetli sürümlerde `ExpressCheckoutAction`, hiçbir kullanıcı oturum açmadığında `CustomerAuthenticationAction::execute()` çağırır. O metod basitçe `customerExists(<payer_email>)` yapar ve `context->updateCustomer(new Customer($id))` çalıştırır; yani **e‑posta varlığı == giriş** (parola/token kontrolü yok).
- **Saldırgan kontrollü e‑posta alanı:** JSON yükündeki `order.payer.email_address`, `ExpressCheckoutRequest::getPayerEmail()` tarafından okunur.

### İstismar adımları

1. Herhangi bir kayıtlı müşteri e‑postasını toplayın (admin ayrı ve bu akıştan etkilenmez).
2. Controller'a kimliksız bir POST gönderin; `orderID` ile birlikte kurbanın e‑postasını `order.payer.email_address` içine koyun.
3. Uç nokta `500` dönse bile, yanıt kurbanın müşteri bağlamına ait çerezleri içerecektir (oturum zaten değiştirilmiş), bu da PII erişimine veya kayıtlı kartlarla satın alma yapılmasına olanak verir.
```http
POST /module/ps_checkout/ExpressCheckout HTTP/1.1
Host: `<target>`
Content-Type: application/json
Content-Length: 72

{"orderID":"1","order":{"payer":{"email_address":"victim@example.com"}}}
```
## Referanslar

- [CVE-2025-61922: Zero-Click Account Takeover on Prestashop (blog)](https://dhakal-ananda.com.np/blogs/cve-2025-61922-analysis/)
- [GitHub Advisory GHSA-54hq-mf6h-48xh](https://github.com/PrestaShopCorp/ps_checkout/security/advisories/GHSA-54hq-mf6h-48xh)

{{#include ../../banners/hacktricks-training.md}}
