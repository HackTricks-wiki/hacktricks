# PrestaShop

{{#include ../../banners/hacktricks-training.md}}

## Van XSS na RCE

- [**PrestaXSRF**](https://github.com/nowak0x01/PrestaXSRF): PrestaShop Exploitation Script wat **XSS to RCE or Others Critical Vulnerabilities.** Vir meer info check [**this post**](https://nowak0x01.github.io/papers/76bc0832a8f682a7e0ed921627f85d1d.html). Dit bied ondersteuning vir PrestaShop Versions 8.X.X and 1.7.X.X, en laat toe om:
- _**(RCE) PSUploadModule(); - Upload a custom Module:**_ Laai 'n Persistent Module (backdoor) op na PrestaShop.

## ps_checkout ExpressCheckout stil aanmelding rekeningoorname (CVE-2025-61922)

> Ontbrekende identiteitsvalidasie in die `ps_checkout` module `< 5.0.5` laat 'n unauthenticated attacker toe om **die sessie na enige klant oor te skakel deur hul e-pos te verskaf**.

- **Eindpunt (unauth):** `POST /module/ps_checkout/ExpressCheckout`.
- **Flow:** `ExpressCheckout.php` aanvaar attacker JSON, kontroleer slegs `orderID`, bou `ExpressCheckoutRequest` en roep `ExpressCheckoutAction::execute()`.
- **Auth bug:** In kwesbare weergawes roep `ExpressCheckoutAction` `CustomerAuthenticationAction::execute()` wanneer geen gebruiker ingeteken is nie. Daardie metode doen eenvoudig `customerExists(<payer_email>)` en `context->updateCustomer(new Customer($id))`, so **email existence == login** (no password/token check).
- **Attacker-controlled email field:** `order.payer.email_address` binne die JSON payload word gelees deur `ExpressCheckoutRequest::getPayerEmail()`.

### Exploitation steps

1. Versamel enige geregistreerde klant se e-pos (admin is afsonderlik en nie geraak deur hierdie vloei nie).
2. Stuur 'n unauthenticated POST na die controller met `orderID` plus die slagoffer se e-pos in `order.payer.email_address`.
3. Selfs as die eindpunt `500` teruggee, sal die response cookies insluit vir die slagoffer se customer context (sessie reeds geskuif), wat PII-toegang of aankope met saved cards moontlik maak.
```http
POST /module/ps_checkout/ExpressCheckout HTTP/1.1
Host: `<target>`
Content-Type: application/json
Content-Length: 72

{"orderID":"1","order":{"payer":{"email_address":"victim@example.com"}}}
```
## Verwysings

- [CVE-2025-61922: Zero-Click Account Takeover on Prestashop (blog)](https://dhakal-ananda.com.np/blogs/cve-2025-61922-analysis/)
- [GitHub Advisory GHSA-54hq-mf6h-48xh](https://github.com/PrestaShopCorp/ps_checkout/security/advisories/GHSA-54hq-mf6h-48xh)

{{#include ../../banners/hacktricks-training.md}}
