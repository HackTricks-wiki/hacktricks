# DotNetNuke (DNN)

{{#include ../../banners/hacktricks-training.md}}

## DotNetNuke (DNN)

DNNに**管理者**としてログインすると、RCEを取得するのが簡単です。

## RCE

### SQL経由

**`Settings`**ページの下にSQLコンソールがアクセス可能で、**`xp_cmdshell`**を有効にして**オペレーティングシステムコマンドを実行**できます。

**`xp_cmdshell`**を有効にするには、これらの行を使用します:
```sql
EXEC sp_configure 'show advanced options', '1'
RECONFIGURE
EXEC sp_configure 'xp_cmdshell', '1'
RECONFIGURE
```
そして、**"Run Script"**を押して、そのSQL文を実行します。

次に、次のようなものを使用してOSコマンドを実行します：
```sql
xp_cmdshell 'whoami'
```
### ASPウェブシェルを介して

`Settings -> Security -> More -> More Security Settings` で、`Allowable File Extensions` の下に **新しい許可された拡張子** を **追加** し、次に `Save` ボタンをクリックします。

**`asp`** または **`aspx`** を追加し、次に **`/admin/file-management`** で **`shell.asp`** という **aspウェブシェル** をアップロードします。

その後、**`/Portals/0/shell.asp`** にアクセスしてウェブシェルにアクセスします。

### 権限昇格

例えば、**Potatoes** または **PrintSpoofer** を使用して **権限を昇格** させることができます。&#x20;

{{#include ../../banners/hacktricks-training.md}}
