# ImageMagick सुरक्षा

{{#include ../../banners/hacktricks-training.md}}

अधिक जानकारी के लिए देखें [**https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html**](https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html)

ImageMagick, एक बहुपरकारी छवि प्रसंस्करण पुस्तकालय, अपनी सुरक्षा नीति को कॉन्फ़िगर करने में चुनौती प्रस्तुत करता है क्योंकि इसके पास व्यापक विकल्प हैं और विस्तृत ऑनलाइन दस्तावेज़ की कमी है। उपयोगकर्ता अक्सर इंटरनेट के टुकड़ों पर आधारित नीतियाँ बनाते हैं, जिससे संभावित गलत कॉन्फ़िगरेशन हो सकते हैं। यह पुस्तकालय 100 से अधिक छवि प्रारूपों की एक विशाल श्रृंखला का समर्थन करता है, जो इसकी जटिलता और कमजोरियों की प्रोफ़ाइल में योगदान करता है, जैसा कि ऐतिहासिक सुरक्षा घटनाओं से प्रदर्शित होता है।

## सुरक्षित नीतियों की ओर

इन चुनौतियों का समाधान करने के लिए, एक [उपकरण विकसित किया गया है](https://imagemagick-secevaluator.doyensec.com/) जो ImageMagick की सुरक्षा नीतियों को डिजाइन और ऑडिट करने में मदद करता है। यह उपकरण व्यापक अनुसंधान पर आधारित है और यह सुनिश्चित करने का लक्ष्य रखता है कि नीतियाँ न केवल मजबूत हों बल्कि उन छिद्रों से भी मुक्त हों जिन्हें शोषित किया जा सकता है।

## अनुमति सूची बनाम निषेध सूची दृष्टिकोण

ऐतिहासिक रूप से, ImageMagick नीतियाँ एक निषेध सूची दृष्टिकोण पर निर्भर करती थीं, जहाँ विशिष्ट कोडर्स को पहुँच से वंचित किया गया था। हालाँकि, ImageMagick 6.9.7-7 में परिवर्तनों ने इस पैरेडाइम को बदल दिया, जिससे अनुमति सूची दृष्टिकोण को सक्षम किया गया। यह दृष्टिकोण पहले सभी कोडर्स को अस्वीकार करता है और फिर चयनात्मक रूप से विश्वसनीय कोडर्स को पहुँच प्रदान करता है, जिससे सुरक्षा स्थिति में सुधार होता है।
```xml
...
<policy domain="coder" rights="none" pattern="*" />
<policy domain="coder" rights="read | write" pattern="{GIF,JPEG,PNG,WEBP}" />
...
```
## नीतियों में केस संवेदनशीलता

यह ध्यान रखना महत्वपूर्ण है कि ImageMagick में नीति पैटर्न केस संवेदनशील होते हैं। इसलिए, नीतियों में कोडर्स और मॉड्यूल को सही तरीके से अपर-कैस्ड करना अनिवार्य है ताकि अनपेक्षित अनुमतियों से बचा जा सके।

## संसाधन सीमाएँ

यदि सही तरीके से कॉन्फ़िगर नहीं किया गया तो ImageMagick सेवा से इनकार के हमलों के प्रति संवेदनशील है। ऐसी कमजोरियों से बचने के लिए नीति में स्पष्ट संसाधन सीमाएँ निर्धारित करना आवश्यक है।

## नीति विखंडन

नीतियाँ विभिन्न ImageMagick इंस्टॉलेशन में विखंडित हो सकती हैं, जिससे संभावित संघर्ष या ओवरराइड हो सकते हैं। सक्रिय नीति फ़ाइलों को खोजने और सत्यापित करने के लिए कमांड का उपयोग करने की सिफारिश की जाती है:
```shell
$ find / -iname policy.xml
```
## एक प्रारंभिक, प्रतिबंधात्मक नीति

एक प्रतिबंधात्मक नीति टेम्पलेट प्रस्तावित किया गया है, जो सख्त संसाधन सीमाओं और पहुंच नियंत्रणों पर केंद्रित है। यह टेम्पलेट विशिष्ट अनुप्रयोग आवश्यकताओं के साथ संरेखित अनुकूलित नीतियों के विकास के लिए एक आधार के रूप में कार्य करता है।

एक सुरक्षा नीति की प्रभावशीलता को ImageMagick में `identify -list policy` कमांड का उपयोग करके पुष्टि की जा सकती है। इसके अतिरिक्त, पहले उल्लेखित [evaluator tool](https://imagemagick-secevaluator.doyensec.com/) का उपयोग व्यक्तिगत आवश्यकताओं के आधार पर नीति को परिष्कृत करने के लिए किया जा सकता है।

## संदर्भ

- [https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html\*\*](https://blog.doyensec.com/2023/01/10/imagemagick-security-policy-evaluator.html)

{{#include ../../banners/hacktricks-training.md}}
