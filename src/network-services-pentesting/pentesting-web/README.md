# 80,443 - Pentesting Web Methodology

{{#include ../../banners/hacktricks-training.md}}

## बुनियादी जानकारी

Web service सबसे अधिक **सामान्य और व्यापक सेवा** है और कई **विभिन्न प्रकार की vulnerabilities** मौजूद हैं।

**डिफ़ॉल्ट पोर्ट:** 80 (HTTP), 443(HTTPS)
```bash
PORT    STATE SERVICE
80/tcp  open  http
443/tcp open  ssl/https
```

```bash
nc -v domain.com 80 # GET / HTTP/1.0
openssl s_client -connect domain.com:443 # GET / HTTP/1.0
```
### वेब API मार्गदर्शन


{{#ref}}
web-api-pentesting.md
{{#endref}}

## मेथोडोलॉजी सारांश

> इस मेथोडोलॉजी में हम मानकर चलेंगे कि आप केवल एक डोमेन (या सबडोमेन) पर हमला कर रहे हैं। इसलिए, आपको इस मेथोडोलॉजी को दायरे में पाए गए हर डोमेन, सबडोमेन या अनिर्धारित web server वाले IP पर लागू करना चाहिए।

- [ ] शुरू करें **पहचानने** से कि web server किस **प्रौद्योगिकी** का उपयोग कर रहा है। यदि आप तकनीक की पहचान कर पाते हैं तो परीक्षण के दौरान ध्यान में रखने के लिए **ट्रिक्स** खोजें।
- [ ] क्या उस प्रौद्योगिकी के संस्करण के लिए कोई **known vulnerability** है?
- [ ] क्या कोई **well known tech** उपयोग हो रही है? क्या और जानकारी निकालने के लिए कोई **useful trick** है?
- [ ] क्या चलाने के लिए कोई **specialised scanner** है (जैसे wpscan)?
- [ ] **general purposes scanners** चलाएँ। आप नहीं जानते वे कुछ पाएंगे या किसी दिलचस्प जानकारी को उजागर करेंगे।
- [ ] शुरू करें **initial checks** से: **robots**, **sitemap**, **404** error और **SSL/TLS scan** (यदि HTTPS)।
- [ ] वेब पेज पर **spidering** शुरू करें: यह समय है सभी संभावित **files, folders** और उपयोग में आने वाले **parameters** को **find** करने का। साथ ही **special findings** की भी जाँच करें।
- [ ] _ध्यान दें कि जब भी brute-forcing या spidering के दौरान कोई नया directory मिलता है, उसे spider किया जाना चाहिए।_
- [ ] **Directory Brute-Forcing**: खोजे गए सभी folders पर brute force करके नए **files** और **directories** ढूंढें।
- [ ] _ध्यान दें कि जब भी brute-forcing या spidering के दौरान कोई नया directory मिलता है, उसे Brute-Forced किया जाना चाहिए।_
- [ ] **Backups checking**: सामान्य backup extensions जोड़कर खोजे गए **files** के **backups** मिलते हैं या नहीं यह परीक्षण करें।
- [ ] **Brute-Force parameters**: छिपे हुए parameters **find** करने की कोशिश करें।
- [ ] एक बार जब आपने सभी संभावित **endpoints** जो **user input** स्वीकार करते हैं, की **identified** कर ली, तो उनसे संबंधित सभी प्रकार की **vulnerabilities** की जाँच करें।
- [ ] [Follow this checklist](../../pentesting-web/web-vulnerabilities-methodology.md)

## Server Version (Vulnerable?)

### Identify

Check if there are **known vulnerabilities** for the server **version** that is running.\
The **HTTP headers and cookies of the response** could be very useful to **identify** the **technologies** and/or **version** being used. **Nmap scan** can identify the server version, but it could also be useful the tools [**whatweb**](https://github.com/urbanadventurer/WhatWeb)**,** [**webtech** ](https://github.com/ShielderSec/webtech)or [**https://builtwith.com/**](https://builtwith.com)**:**
```bash
whatweb -a 1 <URL> #Stealthy
whatweb -a 3 <URL> #Aggresive
webtech -u <URL>
webanalyze -host https://google.com -crawl 2
```
Search के लिए [**वेब एप्लिकेशन के वर्जन की कमजोरियाँ**](../../generic-hacking/search-exploits.md)

### **जांचें कि कोई WAF है या नहीं**

- [**https://github.com/EnableSecurity/wafw00f**](https://github.com/EnableSecurity/wafw00f)
- [**https://github.com/Ekultek/WhatWaf.git**](https://github.com/Ekultek/WhatWaf.git)
- [**https://nmap.org/nsedoc/scripts/http-waf-detect.html**](https://nmap.org/nsedoc/scripts/http-waf-detect.html)

### वेब टेक ट्रिक्स

किसी प्रयुक्त प्रसिद्ध तकनीक में कमजोरियाँ खोजने के लिए कुछ ट्रिक्स:

- [**AEM - Adobe Experience Cloud**](aem-adobe-experience-cloud.md)
- [**Apache**](apache.md)
- [**Artifactory**](artifactory-hacking-guide.md)
- [**Buckets**](buckets/index.html)
- [**CGI**](cgi.md)
- [**Drupal**](drupal/index.html)
- [**Flask**](flask.md)
- [**Fortinet FortiWeb**](fortinet-fortiweb.md)
- [**Git**](git.md)
- [**Golang**](golang.md)
- [**GraphQL**](graphql.md)
- [**H2 - Java SQL database**](h2-java-sql-database.md)
- [**ISPConfig**](ispconfig.md)
- [**IIS tricks**](iis-internet-information-services.md)
- [**Microsoft SharePoint**](microsoft-sharepoint.md)
- [**JBOSS**](jboss.md)
- [**Jenkins**](https://github.com/HackTricks-wiki/hacktricks-cloud/tree/master/pentesting-ci-cd/jenkins-security)
- [**Jira**](jira.md)
- [**Joomla**](joomla.md)
- [**JSP**](jsp.md)
- [**Laravel**](laravel.md)
- [**Moodle**](moodle.md)
- [**Nginx**](nginx.md)
- [**PHP (php has a lot of interesting tricks that could be exploited)**](php-tricks-esp/index.html)
- [**Python**](python.md)
- [**Roundcube**](roundcube.md)
- [**Spring Actuators**](spring-actuators.md)
- [**Symphony**](symphony.md)
- [**Tomcat**](tomcat/index.html)
- [**VMWare**](vmware-esx-vcenter....md)
- [**Web API Pentesting**](web-api-pentesting.md)
- [**WebDav**](put-method-webdav.md)
- [**Werkzeug**](werkzeug.md)
- [**Wordpress**](wordpress.md)
- [**Electron Desktop (XSS to RCE)**](electron-desktop-apps/index.html)
- [**Sitecore**](sitecore/index.html)
- [**Zabbix**](zabbix.md)

_ध्यान रखें कि एक ही **डोमेन** विभिन्न **पोर्ट्स**, **फ़ोल्डर्स** और **सबडोमेन्स** में भिन्न **तकनीकें** उपयोग कर सकता है._\
यदि वेब एप्लिकेशन किसी पहले सूचीबद्ध या किसी अन्य प्रसिद्ध टेक/प्लेटफ़ॉर्म का उपयोग कर रहा है, तो इंटरनेट पर नए ट्रिक्स खोजना न भूलें (और मुझे बताएं!).

### Source Code Review

यदि एप्लिकेशन का **source code** **github** पर उपलब्ध है, तो अपने द्वारा **एक White box test** करने के अलावा ऐसी **कुछ जानकारी** हो सकती है जो वर्तमान **Black-Box testing** के लिए **उपयोगी** हो:

- क्या कोई **Change-log or Readme or Version** फ़ाइल या कुछ है जिसमें **version info accessible** वेब के माध्यम से उपलब्ध हो?
- क्रेडेंशियल्स कैसे और कहाँ सहेजे जाते हैं? क्या कोई (सुलभ?) **file** है जिसमें **credentials** (usernames या passwords) हों?
- क्या **passwords** **plain text** में हैं, **encrypted** हैं या कौन सा **hashing algorithm** उपयोग हो रहा है?
- क्या किसी चीज़ को encrypt करने के लिए कोई **master key** इस्तेमाल हो रही है? कौन सा **algorithm** उपयोग किया जा रहा है?
- क्या आप किसी vulnerability का फायदा उठाकर इनमें से किसी फ़ाइल तक पहुँच सकते हैं?
- क्या **github** में कोई रोचक जानकारी है (solved और not solved) **issues** में? या **commit history** में (शायद किसी पुराने commit में कोई **password** शामिल हो गया हो)?


{{#ref}}
code-review-tools.md
{{#endref}}

### Automatic scanners

#### General purpose automatic scanners
```bash
nikto -h <URL>
whatweb -a 4 <URL>
wapiti -u <URL>
W3af
zaproxy #You can use an API
nuclei -ut && nuclei -target <URL>

# https://github.com/ignis-sec/puff (client side vulns fuzzer)
node puff.js -w ./wordlist-examples/xss.txt -u "http://www.xssgame.com/f/m4KKGHi2rVUN/?query=FUZZ"
```
#### CMS स्कैनर

यदि कोई CMS उपयोग में है तो **run a scanner** करना न भूलें, शायद कुछ दिलचस्प मिल जाए:

[**Clusterd**](https://github.com/hatRiot/clusterd)**:** [**JBoss**](jboss.md)**, ColdFusion, WebLogic,** [**Tomcat**](tomcat/index.html)**, Railo, Axis2, Glassfish**\
[**CMSScan**](https://github.com/ajinabraham/CMSScan): [**WordPress**](wordpress.md), [**Drupal**](drupal/index.html), **Joomla**, **vBulletin** वेबसाइटों में सुरक्षा मुद्दों की जाँच के लिए। (GUI)\
[**VulnX**](https://github.com/anouarbensaad/vulnx)**:** [**Joomla**](joomla.md)**,** [**Wordpress**](wordpress.md)**,** [**Drupal**](drupal/index.html)**, PrestaShop, Opencart**\
**CMSMap**: [**(W)ordpress**](wordpress.md)**,** [**(J)oomla**](joomla.md)**,** [**(D)rupal**](drupal/index.html) **या** [**(M)oodle**](moodle.md)\
[**droopscan**](https://github.com/droope/droopescan)**:** [**Drupal**](drupal/index.html)**,** [**Joomla**](joomla.md)**,** [**Moodle**](moodle.md)**, Silverstripe,** [**Wordpress**](wordpress.md)
```bash
cmsmap [-f W] -F -d <URL>
wpscan --force update -e --url <URL>
joomscan --ec -u <URL>
joomlavs.rb #https://github.com/rastating/joomlavs
```
> इस चरण तक आपके पास क्लाइंट द्वारा उपयोग किए जा रहे वेब सर्वर की कुछ जानकारी होनी चाहिए (यदि कोई डेटा दिया गया हो) और टेस्ट के दौरान ध्यान में रखने के लिए कुछ तरकीबें। अगर आप भाग्यशाली हैं तो आपने एक CMS भी ढूंढ लिया होगा और कोई scanner चला लिया होगा।

## चरण-दर-चरण वेब एप्लिकेशन डिस्कवरी

> इस बिंदु से हम वेब एप्लिकेशन के साथ इंटरैक्ट करना शुरू करने वाले हैं।

### प्रारंभिक जाँच

**डिफ़ॉल्ट पेज जहाँ दिलचस्प जानकारी मिल सकती है:**

- /robots.txt
- /sitemap.xml
- /crossdomain.xml
- /clientaccesspolicy.xml
- /.well-known/
- मुख्य और सहायक पृष्ठों में comments भी जांचें।

**त्रुटियाँ उत्पन्न करना**

वेब सर्वर जब अजीब डेटा भेजा जाता है तो **अपेक्षित व्यवहार नहीं** कर सकते हैं। इससे **vulnerabilities** खुल सकती हैं या संवेदनशील जानकारी का खुलासा हो सकता है।

- एक्सेस करें **fake pages** जैसे /whatever_fake.php (.aspx,.html,.etc)
- त्रुटियाँ उत्पन्न करने के लिए **"[]", "]]", और "[["** को **cookie values** और **parameter values** में जोड़ें
- URL के **end** पर इनपुट के रूप में **`/~randomthing/%s`** देकर त्रुटि उत्पन्न करें
- विभिन्न **HTTP Verbs** आजमाएँ जैसे PATCH, DEBUG या गलत जैसे FAKE

#### **जाँचें कि क्या आप फ़ाइलें अपलोड कर सकते हैं (**[**PUT verb, WebDav**](put-method-webdav.md)**)**

यदि आप पाते हैं कि **WebDav** **enabled** है लेकिन आपको root फ़ोल्डर में **uploading files** के लिए पर्याप्त **permissions** नहीं हैं तो कोशिश करें:

- **Brute Force** credentials
- WebDav के माध्यम से **upload files** करें वेब पेज के भीतर पाए गए अन्य **found folders** में। हो सकता है आपके पास अन्य फोल्डरों में फ़ाइलें अपलोड करने की **permissions** हों।

### **SSL/TLS कमजोरियाँ**

- यदि एप्लिकेशन किसी भी हिस्से में उपयोगकर्ता को HTTPS उपयोग करने के लिए बाध्य नहीं कर रही है, तो यह **vulnerable to MitM** है।
- यदि एप्लिकेशन संवेदनशील डेटा (passwords) को HTTP के माध्यम से भेज रही है, तो यह एक उच्च **vulnerability** है।

Use [**testssl.sh**](https://github.com/drwetter/testssl.sh) to checks for **vulnerabilities** (In Bug Bounty programs probably these kind of vulnerabilities won't be accepted) and use [**a2sv** ](https://github.com/hahwul/a2sv)to recheck the vulnerabilities:
```bash
./testssl.sh [--htmlfile] 10.10.10.10:443
#Use the --htmlfile to save the output inside an htmlfile also

# You can also use other tools, by testssl.sh at this momment is the best one (I think)
sslscan <host:port>
sslyze --regular <ip:port>
```
Information about SSL/TLS vulnerabilities:
- [https://www.gracefulsecurity.com/tls-ssl-vulnerabilities/](https://www.gracefulsecurity.com/tls-ssl-vulnerabilities/)
- [https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/](https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/)

### Spidering

वेब पर किसी प्रकार का **spider** लॉन्च करें। spider का उद्देश्य परीक्षण किए जा रहे एप्लिकेशन से संभवतः जितने भी पाथ्स हो सकें उन्हें ढूँढ़ना है। इसलिए वैध पाथ्स खोजने के लिए web crawling और external sources का उपयोग किया जाना चाहिए।

- [**gospider**](https://github.com/jaeles-project/gospider) (go): HTML spider, LinkFinder in JS files and external sources (Archive.org, CommonCrawl.org, VirusTotal.com).
- [**hakrawler**](https://github.com/hakluke/hakrawler) (go): HML spider, with LinkFider for JS files and Archive.org as external source.
- [**dirhunt**](https://github.com/Nekmo/dirhunt) (python): HTML spider, also indicates "juicy files".
- [**evine** ](https://github.com/saeeddhqan/evine)(go): Interactive CLI HTML spider. It also searches in Archive.org
- [**meg**](https://github.com/tomnomnom/meg) (go): This tool isn't a spider but it can be useful. You can just indicate a file with hosts and a file with paths and meg will fetch each path on each host and save the response.
- [**urlgrab**](https://github.com/IAmStoxe/urlgrab) (go): HTML spider with JS rendering capabilities. However, it looks like it's unmaintained, the precompiled version is old and the current code doesn't compile
- [**gau**](https://github.com/lc/gau) (go): HTML spider that uses external providers (wayback, otx, commoncrawl)
- [**ParamSpider**](https://github.com/devanshbatham/ParamSpider): This script will find URLs with parameter and will list them.
- [**galer**](https://github.com/dwisiswant0/galer) (go): HTML spider with JS rendering capabilities.
- [**LinkFinder**](https://github.com/GerbenJavado/LinkFinder) (python): HTML spider, with JS beautify capabilities capable of search new paths in JS files. It could be worth it also take a look to [JSScanner](https://github.com/dark-warlord14/JSScanner), which is a wrapper of LinkFinder.
- [**goLinkFinder**](https://github.com/0xsha/GoLinkFinder) (go): To extract endpoints in both HTML source and embedded javascript files. Useful for bug hunters, red teamers, infosec ninjas.
- [**JSParser**](https://github.com/nahamsec/JSParser) (python2.7): A python 2.7 script using Tornado and JSBeautifier to parse relative URLs from JavaScript files. Useful for easily discovering AJAX requests. Looks like unmaintained.
- [**relative-url-extractor**](https://github.com/jobertabma/relative-url-extractor) (ruby): Given a file (HTML) it will extract URLs from it using nifty regular expression to find and extract the relative URLs from ugly (minify) files.
- [**JSFScan**](https://github.com/KathanP19/JSFScan.sh) (bash, several tools): Gather interesting information from JS files using several tools.
- [**subjs**](https://github.com/lc/subjs) (go): Find JS files.
- [**page-fetch**](https://github.com/detectify/page-fetch) (go): Load a page in a headless browser and print out all the urls loaded to load the page.
- [**Feroxbuster**](https://github.com/epi052/feroxbuster) (rust): Content discovery tool mixing several options of the previous tools
- [**Javascript Parsing**](https://github.com/xnl-h4ck3r/burp-extensions): A Burp extension to find path and params in JS files.
- [**Sourcemapper**](https://github.com/denandz/sourcemapper): A tool that given the .js.map URL will get you the beatified JS code
- [**xnLinkFinder**](https://github.com/xnl-h4ck3r/xnLinkFinder): This is a tool used to discover endpoints for a given target.
- [**waymore**](https://github.com/xnl-h4ck3r/waymore)**:** Discover links from the wayback machine (also downloading the responses in the wayback and looking for more links)
- [**HTTPLoot**](https://github.com/redhuntlabs/HTTPLoot) (go): Crawl (even by filling forms) and also find sensitive info using specific regexes.
- [**SpiderSuite**](https://github.com/3nock/SpiderSuite): Spider Suite is an advance multi-feature GUI web security Crawler/Spider designed for cyber security professionals.
- [**jsluice**](https://github.com/BishopFox/jsluice) (go): It's a Go package and [command-line tool](https://github.com/BishopFox/jsluice/blob/main/cmd/jsluice) for extracting URLs, paths, secrets, and other interesting data from JavaScript source code.
- [**ParaForge**](https://github.com/Anof-cyber/ParaForge): ParaForge is a simple **Burp Suite extension** to **extract the paramters and endpoints** from the request to create custom wordlist for fuzzing and enumeration.
- [**katana**](https://github.com/projectdiscovery/katana) (go): Awesome tool for this.
- [**Crawley**](https://github.com/s0rg/crawley) (go): Print every link it's able to find.

### Brute Force directories and files

रूट फ़ोल्डर से **brute-forcing** शुरू करें और सुनिश्चित करें कि इस **method** और **Spidering** द्वारा खोजे गए सभी directories को भी brute-force किया जाए (आप इसे recursively करके कर सकते हैं और उपयोग किए जा रहे wordlist के शुरुआत में मिले हुए directory के नाम जोड़ सकते हैं).\
Tools:

- **Dirb** / **Dirbuster** - Included in Kali, **old** (and **slow**) but functional. Allow auto-signed certificates and recursive search. Too slow compared with th other options.
- [**Dirsearch**](https://github.com/maurosoria/dirsearch) (python)**: It doesn't allow auto-signed certificates but** allows recursive search.
- [**Gobuster**](https://github.com/OJ/gobuster) (go): It allows auto-signed certificates, it **doesn't** have **recursive** search.
- [**Feroxbuster**](https://github.com/epi052/feroxbuster) **- Fast, supports recursive search.**
- [**wfuzz**](https://github.com/xmendez/wfuzz) `wfuzz -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt https://domain.com/api/FUZZ`
- [**ffuf** ](https://github.com/ffuf/ffuf)- Fast: `ffuf -c -w /usr/share/wordlists/dirb/big.txt -u http://10.10.10.10/FUZZ`
- [**uro**](https://github.com/s0md3v/uro) (python): This isn't a spider but a tool that given the list of found URLs will to delete "duplicated" URLs.
- [**Scavenger**](https://github.com/0xDexter0us/Scavenger): Burp Extension to create a list of directories from the burp history of different pages
- [**TrashCompactor**](https://github.com/michael1026/trashcompactor): Remove URLs with duplicated functionalities (based on js imports)
- [**Chamaleon**](https://github.com/iustin24/chameleon): It uses wapalyzer to detect used technologies and select the wordlists to use.

**Recommended dictionaries:**

- [https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/bf_directories.txt](https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/bf_directories.txt)
- [**Dirsearch** included dictionary](https://github.com/maurosoria/dirsearch/blob/master/db/dicc.txt)
- [http://gist.github.com/jhaddix/b80ea67d85c13206125806f0828f4d10](http://gist.github.com/jhaddix/b80ea67d85c13206125806f0828f4d10)
- [Assetnote wordlists](https://wordlists.assetnote.io)
- [https://github.com/danielmiessler/SecLists/tree/master/Discovery/Web-Content](https://github.com/danielmiessler/SecLists/tree/master/Discovery/Web-Content)
- raft-large-directories-lowercase.txt
- directory-list-2.3-medium.txt
- RobotsDisallowed/top10000.txt
- [https://github.com/random-robbie/bruteforce-lists](https://github.com/random-robbie/bruteforce-lists)
- [https://github.com/google/fuzzing/tree/master/dictionaries](https://github.com/google/fuzzing/tree/master/dictionaries)
- [https://github.com/six2dez/OneListForAll](https://github.com/six2dez/OneListForAll)
- [https://github.com/random-robbie/bruteforce-lists](https://github.com/random-robbie/bruteforce-lists)
- [https://github.com/ayoubfathi/leaky-paths](https://github.com/ayoubfathi/leaky-paths)
- _/usr/share/wordlists/dirb/common.txt_
- _/usr/share/wordlists/dirb/big.txt_
- _/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt_

_ध्यान रखें कि जब भी कोई नया directory brute-forcing या spidering के दौरान खोजा जाता है, उसे Brute-Force किया जाना चाहिए._

### What to check on each file found

- [**Broken link checker**](https://github.com/stevenvachon/broken-link-checker): HTML में broken links खोजें जो takeover के लिए प्रवण हो सकते हैं
- **File Backups**: एक बार जब आप सभी फ़ाइलें ढूँढ़ लें, तो executable फ़ाइलों के बैकअप ढूँढ़ें ("_.php_", "_.aspx_"...)। बैकअप नामकरण के सामान्य रूप: _file.ext\~, #file.ext#, \~file.ext, file.ext.bak, file.ext.tmp, file.ext.old, file.bak, file.tmp and file.old._ आप टूल [**bfac**](https://github.com/mazen160/bfac) **या** [**backup-gen**](https://github.com/Nishantbhagat57/backup-gen)** का उपयोग भी कर सकते हैं। 
- **Discover new parameters**: आप hidden parameters खोजने के लिए [**Arjun**](https://github.com/s0md3v/Arjun)**,** [**parameth**](https://github.com/maK-/parameth)**,** [**x8**](https://github.com/sh1yo/x8) **और** [**Param Miner**](https://github.com/PortSwigger/param-miner) जैसे टूल्स का उपयोग कर सकते हैं। यदि संभव हो तो प्रत्येक executable web फाइल पर hidden parameters खोजने की कोशिश करें।
- _Arjun all default wordlists:_ [https://github.com/s0md3v/Arjun/tree/master/arjun/db](https://github.com/s0md3v/Arjun/tree/master/arjun/db)
- _Param-miner “params” :_ [https://github.com/PortSwigger/param-miner/blob/master/resources/params](https://github.com/PortSwigger/param-miner/blob/master/resources/params)
- _Assetnote “parameters_top_1m”:_ [https://wordlists.assetnote.io/](https://wordlists.assetnote.io)
- _nullenc0de “params.txt”:_ [https://gist.github.com/nullenc0de/9cb36260207924f8e1787279a05eb773](https://gist.github.com/nullenc0de/9cb36260207924f8e1787279a05eb773)
- **Comments:** सभी फ़ाइलों की comments जाँचें, आप वहां **credentials** या **hidden functionality** पा सकते हैं।
- यदि आप **CTF** खेल रहे हैं, तो एक सामान्य ट्रिक यह है कि पेज के दाईं ओर comments में कई spaces या नई लाइनों के माध्यम से जानकारी छुपा दी जाए ताकि ब्राउज़र में सोर्स खोलने पर दिखे नहीं। एक और संभावना है पेज के नीचे comment में जानकारी छुपाना।
- **API keys**: यदि आप कोई API key पाते हैं तो अलग-अलग प्लेटफार्मों की API keys उपयोग करने के बारे में मार्गदर्शिका है: [**keyhacks**](https://github.com/streaak/keyhacks)**,** [**zile**](https://github.com/xyele/zile.git)**,** [**truffleHog**](https://github.com/trufflesecurity/truffleHog)**,** [**SecretFinder**](https://github.com/m4ll0k/SecretFinder)**,** [**RegHex**](https://github.com/l4yton/RegHex)**,** [**DumpsterDive**](https://github.com/securing/DumpsterDiver)**,** [**EarlyBird**](https://github.com/americanexpress/earlybird)
- Google API keys: यदि आपको कोई API key मिलती है जो **AIza** से शुरू होती दिखती है तो आप यह जाँचने के लिए [**gmapapiscanner**](https://github.com/ozguralp/gmapsapiscanner) का उपयोग कर सकते हैं कि वह key किन APIs तक पहुँच सकती है।
- **S3 Buckets**: spidering करते समय देखें कि कोई subdomain या लिंक किसी S3 bucket से जुड़ा है या नहीं। ऐसे मामले में, [**check** the **permissions** of the bucket](buckets/index.html).

### Special findings

**Spidering** और **brute-forcing** करते समय आपको कुछ **interesting** चीजें मिल सकती हैं जिनका ध्यान रखना आवश्यक है।

**Interesting files**

- CSS फ़ाइलों में अन्य फ़ाइलों के लिए **links** देखें।
- [If you find a _**.git**_ file some information can be extracted](git.md)
- यदि आपको _**.env**_ फाइल मिलती है तो उसमें api keys, db passwords और अन्य जानकारी मिल सकती है।
- यदि आपको **API endpoints** मिलते हैं तो [आपको उन्हें भी टेस्ट करना चाहिए](web-api-pentesting.md). ये फाइलें नहीं हैं, लेकिन अक्सर फाइल जैसी दिखेंगी।
- **JS files**: spidering सेक्शन में कई टूल्स का ज़िक्र है जो JS फाइलों से पाथ निकाल सकते हैं। इसके अलावा, यह उपयोगी होगा कि आप प्रत्येक JS फ़ाइल की निगरानी करें, क्योंकि कुछ मामलों में कोई बदलाव यह संकेत दे सकता है कि कोड में संभावित vulnerability आई है। उदाहरण के लिए आप [**JSMon**](https://github.com/robre/jsmon)** का उपयोग कर सकते हैं।**
- खोजी गई JS फाइलों को [**RetireJS**](https://github.com/retirejs/retire.js/) या [**JSHole**](https://github.com/callforpapers-source/jshole) के साथ भी जांचें कि क्या वे vulnerable हैं।
- **Javascript Deobfuscator and Unpacker:** [https://lelinhtinh.github.io/de4js/](https://lelinhtinh.github.io/de4js/), [https://www.dcode.fr/javascript-unobfuscator](https://www.dcode.fr/javascript-unobfuscator)
- **Javascript Beautifier:** [http://jsbeautifier.org/](https://beautifier.io), [http://jsnice.org/](http://jsnice.org)
- **JsFuck deobfuscation** (javascript with chars:"\[]!+" [https://enkhee-osiris.github.io/Decoder-JSFuck/](https://enkhee-osiris.github.io/Decoder-JSFuck/))
- [**TrainFuck**](https://github.com/taco-c/trainfuck)**:** `+72.+29.+7..+3.-67.-12.+55.+24.+3.-6.-8.-67.-23.`
- कई बार आपको उपयोग किए गए regular expressions को समझने की ज़रूरत पड़ेगी। यह उपयोगी होगा: [https://regex101.com/](https://regex101.com) या [https://pythonium.net/regex](https://pythonium.net/regex)
- आप उन फ़ाइलों की भी निगरानी कर सकते हैं जहाँ forms पाए गए थे, क्योंकि किसी parameter में बदलाव या नए form के आने से नई संभावित vulnerable functionality का संकेत मिल सकता है।

**403 Forbidden/Basic Authentication/401 Unauthorized (bypass)**

{{#ref}}
403-and-401-bypasses.md
{{#endref}}

**502 Proxy Error**

यदि किसी पेज का response उस कोड के साथ आता है, तो संभवतः proxy गलत तरीके से configured है। यदि आप ऐसा HTTP request भेजते हैं: `GET https://google.com HTTP/1.1` (host header और अन्य सामान्य headers के साथ), तो proxy _google.com_ तक पहुँचने की कोशिश करेगा और आप एक SSRF पा सकते हैं।

**NTLM Authentication - Info disclosure**

यदि सर्वर जो authentication मांग रहा है वह **Windows** है या आप ऐसे login पाते हैं जो आपके **credentials** (और domain name) मांगता है, तो आप information disclosure करवा सकते हैं।\
`“Authorization: NTLM TlRMTVNTUAABAAAAB4IIAAAAAAAAAAAAAAAAAAAAAAA=”` header भेजें और NTLM authentication के काम करने के तरीके के कारण सर्वर header "WWW-Authenticate" के अंदर internal जानकारी (IIS version, Windows version...) भेजेगा।\
आप इसे automate करने के लिए **nmap** plugin "_http-ntlm-info.nse_" का उपयोग कर सकते हैं।

**HTTP Redirect (CTF)**

Redirection के अंदर content रखना संभव है। यह content उपयोगकर्ता को दिखाई नहीं देगा (क्योंकि browser redirection execute करेगा) पर वहां कुछ छुपा हुआ हो सकता है।

### Web Vulnerabilities Checking

अब जब web application का समग्र enumeration किया जा चुका है, तो कई संभावित vulnerabilities की जाँच करने का समय है। आप checklist यहाँ पा सकते हैं:

{{#ref}}
../../pentesting-web/web-vulnerabilities-methodology.md
{{#endref}}

वेब vulnerabilities के बारे में और जानकारी के लिए देखें:

- [https://six2dez.gitbook.io/pentest-book/others/web-checklist](https://six2dez.gitbook.io/pentest-book/others/web-checklist)
- [https://kennel209.gitbooks.io/owasp-testing-guide-v4/content/en/web_application_security_testing/configuration_and_deployment_management_testing.html](https://kennel209.gitbooks.io/owasp-testing-guide-v4/content/en/web_application_security_testing/configuration_and_deployment_management_testing.html)
- [https://owasp-skf.gitbook.io/asvs-write-ups/kbid-111-client-side-template-injection](https://owasp-skf.gitbook.io/asvs-write-ups/kbid-111-client-side-template-injection)

### Monitor Pages for changes

आप pages में होने वाले बदलावों की निगरानी के लिए जैसे टूल्स का उपयोग कर सकते हैं: [https://github.com/dgtlmoon/changedetection.io](https://github.com/dgtlmoon/changedetection.io) ताकि modifications जो vulnerabilities डाल सकते हैं, उन्हें पकड़ा जा सके।

### HackTricks Automatic Commands

<details>
<summary>HackTricks Automatic Commands</summary>
```yaml
Protocol_Name: Web    #Protocol Abbreviation if there is one.
Port_Number:  80,443     #Comma separated if there is more than one.
Protocol_Description: Web         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for Web
Note: |
https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-web/index.html

Entry_2:
Name: Quick Web Scan
Description: Nikto and GoBuster
Command: nikto -host {Web_Proto}://{IP}:{Web_Port} &&&& gobuster dir -w {Small_Dirlist} -u {Web_Proto}://{IP}:{Web_Port} && gobuster dir -w {Big_Dirlist} -u {Web_Proto}://{IP}:{Web_Port}

Entry_3:
Name: Nikto
Description: Basic Site Info via Nikto
Command: nikto -host {Web_Proto}://{IP}:{Web_Port}

Entry_4:
Name: WhatWeb
Description: General purpose auto scanner
Command: whatweb -a 4 {IP}

Entry_5:
Name: Directory Brute Force Non-Recursive
Description:  Non-Recursive Directory Brute Force
Command: gobuster dir -w {Big_Dirlist} -u {Web_Proto}://{IP}:{Web_Port}

Entry_6:
Name: Directory Brute Force Recursive
Description: Recursive Directory Brute Force
Command: python3 {Tool_Dir}dirsearch/dirsearch.py -w {Small_Dirlist} -e php,exe,sh,py,html,pl -f -t 20 -u {Web_Proto}://{IP}:{Web_Port} -r 10

Entry_7:
Name: Directory Brute Force CGI
Description: Common Gateway Interface Brute Force
Command: gobuster dir -u {Web_Proto}://{IP}:{Web_Port}/ -w /usr/share/seclists/Discovery/Web-Content/CGIs.txt -s 200

Entry_8:
Name: Nmap Web Vuln Scan
Description: Tailored Nmap Scan for web Vulnerabilities
Command: nmap -vv --reason -Pn -sV -p {Web_Port} --script=`banner,(http* or ssl*) and not (brute or broadcast or dos or external or http-slowloris* or fuzzer)` {IP}

Entry_9:
Name: Drupal
Description: Drupal Enumeration Notes
Note: |
git clone https://github.com/immunIT/drupwn.git for low hanging fruit and git clone https://github.com/droope/droopescan.git for deeper enumeration

Entry_10:
Name: WordPress
Description: WordPress Enumeration with WPScan
Command: |
?What is the location of the wp-login.php? Example: /Yeet/cannon/wp-login.php
wpscan --url {Web_Proto}://{IP}{1} --enumerate ap,at,cb,dbe && wpscan --url {Web_Proto}://{IP}{1} --enumerate u,tt,t,vp --passwords {Big_Passwordlist} -e

Entry_11:
Name: WordPress Hydra Brute Force
Description: Need User (admin is default)
Command: hydra -l admin -P {Big_Passwordlist} {IP} -V http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:S=Location'

Entry_12:
Name: Ffuf Vhost
Description: Simple Scan with Ffuf for discovering additional vhosts
Command: ffuf -w {Subdomain_List}:FUZZ -u {Web_Proto}://{Domain_Name} -H "Host:FUZZ.{Domain_Name}" -c -mc all {Ffuf_Filters}
```
</details>

{{#include ../../banners/hacktricks-training.md}}
