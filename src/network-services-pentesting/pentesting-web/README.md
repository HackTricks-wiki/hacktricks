# 80,443 - Pentesting Web Methodology

{{#include ../../banners/hacktricks-training.md}}

## Basic Info

web 服务是最 **常见且范围广泛的服务**，并且存在许多 **不同类型的漏洞**。

**默认端口：** 80 (HTTP), 443(HTTPS)
```bash
PORT    STATE SERVICE
80/tcp  open  http
443/tcp open  ssl/https
```

```bash
nc -v domain.com 80 # GET / HTTP/1.0
openssl s_client -connect domain.com:443 # GET / HTTP/1.0
```
### Web API 指南


{{#ref}}
web-api-pentesting.md
{{#endref}}

## 方法概述

> 在此方法论中，我们假定你将攻击一个域名（或子域名），仅限该目标。因此，你应将此方法应用到每个已发现的域名、子域名或范围内的未确定 web 服务器的 IP。

- [ ] 首先 **识别** web 服务器使用的 **technologies**。如果能成功识别技术，寻找在后续测试中需要注意的 **tricks**。
- [ ] 该技术 **version** 是否有任何 **已知漏洞**？
- [ ] 是否使用任何 **well known tech**？有没有可以提取更多信息的 **useful trick**？
- [ ] 是否有需要运行的 **specialised scanner**（例如 wpscan）？
- [ ] 运行 **general purposes scanners**。你永远不知道它们是否会发现什么或是否会发现一些有趣的信息。
- [ ] 从 **initial checks** 开始：**robots**、**sitemap**、**404** error 和 **SSL/TLS scan**（如果 **HTTPS**）。
- [ ] 开始 **spidering** 网页：现在是时候 **find** 所有可能的 **files, folders** 和 **parameters being used.** 同时，检查是否有 **special findings**。
- [ ] _注意：在 brute-forcing 或 spidering 过程中，只要发现新目录，就应对其进行 spidering。_
- [ ] **Directory Brute-Forcing**：尝试对所有已发现的目录进行 brute force，搜索新的 **files** 和 **directories**。
- [ ] _注意：在 brute-forcing 或 spidering 过程中，只要发现新目录，就应对其进行 Brute-Forced。_
- [ ] **Backups checking**：尝试通过追加常见备份扩展名来查找 **已发现文件** 的备份。
- [ ] **Brute-Force parameters**：尝试 **find hidden parameters**。
- [ ] 一旦你 **identified** 出所有可能接受 **user input** 的 **endpoints**，检查所有与之相关的各种 **vulnerabilities**。
- [ ] [Follow this checklist](../../pentesting-web/web-vulnerabilities-methodology.md)

## 服务器版本（是否易受攻击？）

### 识别

检查运行的服务器 **版本** 是否存在 **已知漏洞**。\
响应的 **HTTP headers and cookies of the response** 对 **识别** 使用的 **technologies** 和/或 **版本** 非常有用。**Nmap scan** 可以识别服务器版本，但下列工具也可能有用：[**whatweb**](https://github.com/urbanadventurer/WhatWeb)**,** [**webtech**](https://github.com/ShielderSec/webtech) 或 [**https://builtwith.com/**](https://builtwith.com)**:**
```bash
whatweb -a 1 <URL> #Stealthy
whatweb -a 3 <URL> #Aggresive
webtech -u <URL>
webanalyze -host https://google.com -crawl 2
```
搜索 **关于** [**vulnerabilities of the web application** **version**](../../generic-hacking/search-exploits.md)

### **检查是否存在 WAF**

- [**https://github.com/EnableSecurity/wafw00f**](https://github.com/EnableSecurity/wafw00f)
- [**https://github.com/Ekultek/WhatWaf.git**](https://github.com/Ekultek/WhatWaf.git)
- [**https://nmap.org/nsedoc/scripts/http-waf-detect.html**](https://nmap.org/nsedoc/scripts/http-waf-detect.html)

### Web 技术技巧

一些 **技巧**，用于在不同知名 **技术** 中 **发现漏洞**：

- [**AEM - Adobe Experience Cloud**](aem-adobe-experience-cloud.md)
- [**Apache**](apache.md)
- [**Artifactory**](artifactory-hacking-guide.md)
- [**Buckets**](buckets/index.html)
- [**CGI**](cgi.md)
- [**Drupal**](drupal/index.html)
- [**Flask**](flask.md)
- [**Git**](git.md)
- [**Golang**](golang.md)
- [**GraphQL**](graphql.md)
- [**H2 - Java SQL database**](h2-java-sql-database.md)
- [**ISPConfig**](ispconfig.md)
- [**IIS tricks**](iis-internet-information-services.md)
- [**Microsoft SharePoint**](microsoft-sharepoint.md)
- [**JBOSS**](jboss.md)
- [**Jenkins**](<[https:/github.com/carlospolop/hacktricks/blob/master/network-services-pentesting/pentesting-web/broken-reference/README.md](https:/github.com/HackTricks-wiki/hacktricks-cloud/tree/master/pentesting-ci-cd/jenkins-security)/>)
- [**Jira**](jira.md)
- [**Joomla**](joomla.md)
- [**JSP**](jsp.md)
- [**Laravel**](laravel.md)
- [**Moodle**](moodle.md)
- [**Nginx**](nginx.md)
- [**PHP (php has a lot of interesting tricks that could be exploited)**](php-tricks-esp/index.html)
- [**Python**](python.md)
- [**Roundcube**](roundcube.md)
- [**Spring Actuators**](spring-actuators.md)
- [**Symphony**](symphony.md)
- [**Tomcat**](tomcat/index.html)
- [**VMWare**](vmware-esx-vcenter....md)
- [**Web API Pentesting**](web-api-pentesting.md)
- [**WebDav**](put-method-webdav.md)
- [**Werkzeug**](werkzeug.md)
- [**Wordpress**](wordpress.md)
- [**Electron Desktop (XSS to RCE)**](electron-desktop-apps/index.html)
- [**Sitecore**](sitecore/index.html)
- [**Zabbix**](zabbix.md)

_Take into account that the **same domain** can be using **different technologies** in different **ports**, **folders** and **subdomains**._\
如果该 Web 应用使用任何之前列出的知名 **技术/平台** 或 **其他**，不要忘记在互联网上搜索新的 **技巧**（并告知我！）。

### 源代码审计

如果该应用的 **source code** 在 **github** 上可用，除了由你自行对应用执行 **White box test** 外，还有一些信息可能对当前的 **Black-Box testing** 有用：

- 是否存在 **Change-log 或 Readme 或 Version** 文件，或任何通过 Web 可访问的 **version info**？
- 凭据（**credentials**）是如何以及在哪里保存的？是否存在任何（可访问的？）包含凭据（用户名或密码）的文件？
- 密码是以 **plain text**、**encrypted** 存储，还是使用了哪种 **hashing algorithm**？
- 是否使用任何用于加密的 **master key**？使用了哪种 **algorithm**？
- 你能否通过利用某些漏洞 **访问这些文件中的任何一个**？
- 在 github 的 **issues**（已解决或未解决）中有没有任何有趣的信息？或者在 **commit history** 中（可能某个旧的 commit 中引入过密码）？

{{#ref}}
code-review-tools.md
{{#endref}}

### 自动化扫描器

#### 通用自动化扫描器
```bash
nikto -h <URL>
whatweb -a 4 <URL>
wapiti -u <URL>
W3af
zaproxy #You can use an API
nuclei -ut && nuclei -target <URL>

# https://github.com/ignis-sec/puff (client side vulns fuzzer)
node puff.js -w ./wordlist-examples/xss.txt -u "http://www.xssgame.com/f/m4KKGHi2rVUN/?query=FUZZ"
```
#### CMS 扫描器

If a CMS is used don't forget to **run a scanner**, maybe something juicy is found:

[**Clusterd**](https://github.com/hatRiot/clusterd)**:** [**JBoss**](jboss.md)**, ColdFusion, WebLogic,** [**Tomcat**](tomcat/index.html)**, Railo, Axis2, Glassfish**\
[**CMSScan**](https://github.com/ajinabraham/CMSScan): [**WordPress**](wordpress.md), [**Drupal**](drupal/index.html), **Joomla**, **vBulletin** 网站用于检测安全问题。 (GUI)\
[**VulnX**](https://github.com/anouarbensaad/vulnx)**:** [**Joomla**](joomla.md)**,** [**Wordpress**](wordpress.md)**,** [**Drupal**](drupal/index.html)**, PrestaShop, Opencart**\
**CMSMap**: [**(W)ordpress**](wordpress.md)**,** [**(J)oomla**](joomla.md)**,** [**(D)rupal**](drupal/index.html) **或** [**(M)oodle**](moodle.md)\
[**droopscan**](https://github.com/droope/droopescan)**:** [**Drupal**](drupal/index.html)**,** [**Joomla**](joomla.md)**,** [**Moodle**](moodle.md)**, Silverstripe,** [**Wordpress**](wordpress.md)
```bash
cmsmap [-f W] -F -d <URL>
wpscan --force update -e --url <URL>
joomscan --ec -u <URL>
joomlavs.rb #https://github.com/rastating/joomlavs
```
> At this point you should already have some information of the web server being used by the client (if any data is given) and some tricks to keep in mind during the test. If you are lucky you have even found a CMS and run some scanner.

## Step-by-step Web Application Discovery

> From this point we are going to start interacting with the web application.

### Initial checks

**Default pages with interesting info:**

- /robots.txt
- /sitemap.xml
- /crossdomain.xml
- /clientaccesspolicy.xml
- /.well-known/
- Check also comments in the main and secondary pages.

**Forcing errors**

Web servers may **behave unexpectedly** when weird data is sent to them. This may open **vulnerabilities** or **disclosure sensitive information**.

- 访问 **假页面**，例如 /whatever_fake.php (.aspx,.html,.etc)
- 在 **cookie 值** 和 **参数 值** 中加入 **"[]", "]]", 和 "[["** 以触发错误
- 在 **URL 末尾** 以 **`/~randomthing/%s`** 的输入来生成错误
- 尝试 **不同的 HTTP Verbs**，例如 PATCH、DEBUG，或使用错误的 FAKE

#### **检查是否可以上传文件 (**[**PUT verb, WebDav**](put-method-webdav.md)**)**

如果发现 **WebDav** 被 **启用**，但你没有足够权限在根目录上传文件，尝试：

- **Brute Force** 凭证
- 通过 WebDav 将 **文件上传** 到页面内找到的其它 **文件夹**。你可能对其他文件夹有上传权限。

### **SSL/TLS vulnerabilites**

- 如果应用在任何部分 **没有强制使用 HTTPS**，则容易受到 **MitM** 攻击
- 如果应用 **通过 HTTP 发送敏感数据（如密码）**，则这是一个高危漏洞

使用 [**testssl.sh**](https://github.com/drwetter/testssl.sh) 检查 **漏洞**（在 Bug Bounty programs 中，这类漏洞通常可能不会被接受），并使用 [**a2sv** ](https://github.com/hahwul/a2sv) 重新验证这些漏洞：
```bash
./testssl.sh [--htmlfile] 10.10.10.10:443
#Use the --htmlfile to save the output inside an htmlfile also

# You can also use other tools, by testssl.sh at this momment is the best one (I think)
sslscan <host:port>
sslyze --regular <ip:port>
```
Information about SSL/TLS vulnerabilities:

- [https://www.gracefulsecurity.com/tls-ssl-vulnerabilities/](https://www.gracefulsecurity.com/tls-ssl-vulnerabilities/)
- [https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/](https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/)

### Spidering

在目标 web 上启动某种 **spider**。spider 的目标是 **尽可能多地发现路径** 来自被测试的应用。因此，应使用 web 爬取和外部来源来尽可能发现更多有效路径。

- [**gospider**](https://github.com/jaeles-project/gospider) (go): HTML spider，在 JS 文件中使用 LinkFinder，并查询外部来源 (Archive.org, CommonCrawl.org, VirusTotal.com)。
- [**hakrawler**](https://github.com/hakluke/hakrawler) (go): HML spider，带有用于 JS 文件的 LinkFinder，并使用 Archive.org 作为外部来源。
- [**dirhunt**](https://github.com/Nekmo/dirhunt) (python): HTML spider，也会指出“juicy files”。
- [**evine** ](https://github.com/saeeddhqan/evine)(go): 交互式 CLI HTML spider。它也会在 Archive.org 中搜索。
- [**meg**](https://github.com/tomnomnom/meg) (go): 该工具不是 spider，但很有用。你可以指定一个 hosts 文件和一个 paths 文件，meg 会对每个 host 的每个 path 发起请求并保存响应。
- [**urlgrab**](https://github.com/IAmStoxe/urlgrab) (go): 具有 JS 渲染能力的 HTML spider。但看起来已经不维护，预编译版本较旧且当前代码无法编译。
- [**gau**](https://github.com/lc/gau) (go): 使用外部提供者（wayback, otx, commoncrawl）的 HTML spider。
- [**ParamSpider**](https://github.com/devanshbatham/ParamSpider): 该脚本会找到带参数的 URLs 并列出它们。
- [**galer**](https://github.com/dwisiswant0/galer) (go): 具有 JS 渲染能力的 HTML spider。
- [**LinkFinder**](https://github.com/GerbenJavado/LinkFinder) (python): HTML spider，带有 JS 美化能力，能够在 JS 文件中搜索新路径。也可以看看 [JSScanner](https://github.com/dark-warlord14/JSScanner)，它是 LinkFinder 的一个包装器。
- [**goLinkFinder**](https://github.com/0xsha/GoLinkFinder) (go): 用于从 HTML 源和嵌入的 javascript 文件中提取 endpoints。对 bug 猎人、red teamers、infosec ninjas 很有用。
- [**JSParser**](https://github.com/nahamsec/JSParser) (python2.7): 一个使用 Tornado 和 JSBeautifier 的 python 2.7 脚本，用于从 JavaScript 文件解析相对 URL。对于轻松发现 AJAX 请求很有用。看起来未维护。
- [**relative-url-extractor**](https://github.com/jobertabma/relative-url-extractor) (ruby): 给定一个文件（HTML），它会使用巧妙的正则表达式从难看的（minify）文件中查找并提取相对 URL。
- [**JSFScan**](https://github.com/KathanP19/JSFScan.sh) (bash, several tools): 使用多个工具从 JS 文件中收集有趣的信息。
- [**subjs**](https://github.com/lc/subjs) (go): 查找 JS 文件。
- [**page-fetch**](https://github.com/detectify/page-fetch) (go): 在 headless 浏览器中加载页面并打印出为加载该页面而加载的所有 urls。
- [**Feroxbuster**](https://github.com/epi052/feroxbuster) (rust): 一款内容发现工具，融合了前面几个工具的多个选项。
- [**Javascript Parsing**](https://github.com/xnl-h4ck3r/burp-extensions): 一个 Burp extension，用于在 JS 文件中查找路径和参数。
- [**Sourcemapper**](https://github.com/denandz/sourcemapper): 给定 .js.map URL 后，该工具会为你获取美化后的 JS 代码。
- [**xnLinkFinder**](https://github.com/xnl-h4ck3r/xnLinkFinder): 用于为给定目标发现 endpoints 的工具。
- [**waymore**](https://github.com/xnl-h4ck3r/waymore)**:** 从 wayback machine 发现链接（也会下载 wayback 中的响应并查找更多链接）。
- [**HTTPLoot**](https://github.com/redhuntlabs/HTTPLoot) (go): 爬取（甚至通过填写表单）并使用特定的 regexes 查找敏感信息。
- [**SpiderSuite**](https://github.com/3nock/SpiderSuite): Spider Suite 是为网络安全专业人员设计的高级多功能 GUI web security Crawler/Spider。
- [**jsluice**](https://github.com/BishopFox/jsluice) (go): 一个 Go 包和 [command-line tool](https://github.com/BishopFox/jsluice/blob/main/cmd/jsluice)，用于从 JavaScript 源代码中提取 URLs、paths、secrets 和其他有趣的数据。
- [**ParaForge**](https://github.com/Anof-cyber/ParaForge): ParaForge 是一个简单的 **Burp Suite extension**，用于 **提取请求中的参数和 endpoints**，以创建用于 fuzzing 和 enumeration 的自定义字典。
- [**katana**](https://github.com/projectdiscovery/katana) (go): 处理此类任务的优秀工具。
- [**Crawley**](https://github.com/s0rg/crawley) (go): 打印它能找到的每一个链接。

### Brute Force directories and files

从根目录开始进行 **brute-forcing**，并确保使用 **this method** 对发现的**所有** **directories** 进行 brute-force，同时也对通过 **Spidering** 发现的所有目录进行 brute-force（你可以递归地进行 brute-forcing，并将已发现目录的名称添加到所用 wordlist 的开头）。\
Tools:

- **Dirb** / **Dirbuster** - 包含在 Kali 中，**old**（且 **slow**）但可用。允许 auto-signed certificates 和 recursive search。与其他选项相比太慢。
- [**Dirsearch**](https://github.com/maurosoria/dirsearch) (python)**: 它不允许 auto-signed certificates，但**允许 recursive search。
- [**Gobuster**](https://github.com/OJ/gobuster) (go): 支持 auto-signed certificates，但**不**支持 recursive search。
- [**Feroxbuster**](https://github.com/epi052/feroxbuster) **- Fast, supports recursive search.**
- [**wfuzz**](https://github.com/xmendez/wfuzz) `wfuzz -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt https://domain.com/api/FUZZ`
- [**ffuf** ](https://github.com/ffuf/ffuf)- Fast: `ffuf -c -w /usr/share/wordlists/dirb/big.txt -u http://10.10.10.10/FUZZ`
- [**uro**](https://github.com/s0md3v/uro) (python): 这不是 spider，但给定已发现的 URL 列表后，它会删除“重复”的 URLs。
- [**Scavenger**](https://github.com/0xDexter0us/Scavenger): Burp Extension，从不同页面的 burp 历史中创建目录列表。
- [**TrashCompactor**](https://github.com/michael1026/trashcompactor): 基于 js imports 删除具有重复功能的 URLs。
- [**Chamaleon**](https://github.com/iustin24/chameleon): 使用 wapalyzer 检测所用技术并选择要使用的 wordlists。

**Recommended dictionaries:**

- [https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/bf_directories.txt](https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/bf_directories.txt)
- [**Dirsearch** included dictionary](https://github.com/maurosoria/dirsearch/blob/master/db/dicc.txt)
- [http://gist.github.com/jhaddix/b80ea67d85c13206125806f0828f4d10](http://gist.github.com/jhaddix/b80ea67d85c13206125806f0828f4d10)
- [Assetnote wordlists](https://wordlists.assetnote.io)
- [https://github.com/danielmiessler/SecLists/tree/master/Discovery/Web-Content](https://github.com/danielmiessler/SecLists/tree/master/Discovery/Web-Content)
- raft-large-directories-lowercase.txt
- directory-list-2.3-medium.txt
- RobotsDisallowed/top10000.txt
- [https://github.com/random-robbie/bruteforce-lists](https://github.com/random-robbie/bruteforce-lists)
- [https://github.com/google/fuzzing/tree/master/dictionaries](https://github.com/google/fuzzing/tree/master/dictionaries)
- [https://github.com/six2dez/OneListForAll](https://github.com/six2dez/OneListForAll)
- [https://github.com/random-robbie/bruteforce-lists](https://github.com/random-robbie/bruteforce-lists)
- [https://github.com/ayoubfathi/leaky-paths](https://github.com/ayoubfathi/leaky-paths)
- _/usr/share/wordlists/dirb/common.txt_
- _/usr/share/wordlists/dirb/big.txt_
- _/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt_

_注意：每当在 brute-forcing 或 spidering 期间发现新目录时，应对其进行 Brute-Force。_

### What to check on each file found

- [**Broken link checker**](https://github.com/stevenvachon/broken-link-checker): 在 HTML 中查找可能导致 takeover 的 broken links。
- **File Backups**: 一旦你找到了所有文件，查找所有可执行文件的备份（"_.php_", "_.aspx_"...）。备份命名的常见变体有： _file.ext\~, #file.ext#, \~file.ext, file.ext.bak, file.ext.tmp, file.ext.old, file.bak, file.tmp and file.old._ 你也可以使用工具 [**bfac**](https://github.com/mazen160/bfac) **或** [**backup-gen**](https://github.com/Nishantbhagat57/backup-gen)**。**
- **Discover new parameters**: 你可以使用诸如 [**Arjun**](https://github.com/s0md3v/Arjun)**,** [**parameth**](https://github.com/maK-/parameth)**,** [**x8**](https://github.com/sh1yo/x8) **和** [**Param Miner**](https://github.com/PortSwigger/param-miner) **来发现隐藏参数。如果可能，应尝试在每个可执行的 web 文件中搜索隐藏参数。**
- _Arjun all default wordlists:_ [https://github.com/s0md3v/Arjun/tree/master/arjun/db](https://github.com/s0md3v/Arjun/tree/master/arjun/db)
- _Param-miner “params” :_ [https://github.com/PortSwigger/param-miner/blob/master/resources/params](https://github.com/PortSwigger/param-miner/blob/master/resources/params)
- _Assetnote “parameters_top_1m”:_ [https://wordlists.assetnote.io/](https://wordlists.assetnote.io)
- _nullenc0de “params.txt”:_ [https://gist.github.com/nullenc0de/9cb36260207924f8e1787279a05eb773](https://gist.github.com/nullenc0de/9cb36260207924f8e1787279a05eb773)
- **Comments:** 检查所有文件的注释，你可能会在其中发现 **credentials** 或 **隐藏功能**。
- 如果你在玩 **CTF**，一个“常见”的技巧是将 **信息** 隐藏在页面右侧的注释中（使用数百个空格，这样如果用浏览器打开源代码你看不到数据）。另一种可能是使用多个换行并在网页底部的注释中隐藏信息。
- **API keys**: 如果你发现任何 API key，有一些项目指导如何使用不同平台的 API keys： [**keyhacks**](https://github.com/streaak/keyhacks)**,** [**zile**](https://github.com/xyele/zile.git)**,** [**truffleHog**](https://github.com/trufflesecurity/truffleHog)**,** [**SecretFinder**](https://github.com/m4ll0k/SecretFinder)**,** [**RegHex**](<https://github.com/l4yton/RegHex)/>)**,** [**DumpsterDive**](https://github.com/securing/DumpsterDiver)**,** [**EarlyBird**](https://github.com/americanexpress/earlybird)
- Google API keys: 如果你发现任何看起来像 **AIza**SyA-qLheq6xjDiEIRisP_ujUseYLQCHUjik 的 API key，可以使用项目 [**gmapapiscanner**](https://github.com/ozguralp/gmapsapiscanner) 检查该 key 可以访问哪些 apis。
- **S3 Buckets**: 在 spidering 期间查看是否有任何子域或链接与某个 S3 bucket 相关。在这种情况下，去 [**检查** the **permissions** of the bucket](buckets/index.html)。

### Special findings

在执行 **spidering** 和 **brute-forcing** 时，你可能会发现一些需要注意的**有趣** **项目**。

**Interesting files**

- 在 CSS 文件中查找指向其他文件的 **links**。
- [If you find a _**.git**_ file some information can be extracted](git.md)
- 如果你发现一个 _**.env**_，可能会找到诸如 api keys、dbs passwords 等信息。
- 如果你发现 **API endpoints**，你 [should also test them](web-api-pentesting.md)。这些不是文件，但很可能“看起来像”文件。
- **JS files**: 在 spidering 部分提到过几种能从 JS 文件中提取路径的工具。此外，监控每个发现的 JS 文件也很重要，因为在某些情况下文件的变更可能表明代码中引入了潜在漏洞。你可以例如使用 [**JSMon**](https://github.com/robre/jsmon)**。**
- 你还应该用 [**RetireJS**](https://github.com/retirejs/retire.js/) 或 [**JSHole**](https://github.com/callforpapers-source/jshole) 检查发现的 JS 文件以判断其是否存在已知漏洞。
- **Javascript Deobfuscator and Unpacker:** [https://lelinhtinh.github.io/de4js/](https://lelinhtinh.github.io/de4js/), [https://www.dcode.fr/javascript-unobfuscator](https://www.dcode.fr/javascript-unobfuscator)
- **Javascript Beautifier:** [http://jsbeautifier.org/](https://beautifier.io), [http://jsnice.org/](http://jsnice.org)
- **JsFuck deobfuscation** (javascript with chars:"\[]!+" [https://enkhee-osiris.github.io/Decoder-JSFuck/](https://enkhee-osiris.github.io/Decoder-JSFuck/))
- **TrainFuck**](https://github.com/taco-c/trainfuck)**:** `+72.+29.+7..+3.-67.-12.+55.+24.+3.-6.-8.-67.-23.`
- 在许多情况下，你需要理解所用的正则表达式，这会很有用: [https://regex101.com/](https://regex101.com) 或 [https://pythonium.net/regex](https://pythonium.net/regex)
- 你也可以监控那些检测到表单的文件，因为参数的变化或新表单的出现可能表明出现了新的潜在易受攻击的功能。

**403 Forbidden/Basic Authentication/401 Unauthorized (bypass)**


{{#ref}}
403-and-401-bypasses.md
{{#endref}}

**502 Proxy Error**

如果任何页面以该 **code** 响应，很可能是代理配置不当。**如果你发送一个 HTTP 请求比如: `GET https://google.com HTTP/1.1`**（带上 host header 和其他常见头），**代理** 会尝试访问 _**google.com**_，这样你就可能发现一个 **SSRF**。

**NTLM Authentication - Info disclosure**

如果要求认证的运行服务器是 **Windows**，或者你发现一个要求输入 **credentials**（并要求 **domain** 名称）的登录，你可以诱发信息泄露。\
发送头：`“Authorization: NTLM TlRMTVNTUAABAAAAB4IIAAAAAAAAAAAAAAAAAAAAAAA=”`，由于 **NTLM authentication** 的工作方式，服务器会在 "WWW-Authenticate" 头中返回内部信息（IIS 版本、Windows 版本等）。\
你可以使用 nmap 的插件 "_http-ntlm-info.nse_" 自动化此操作。

**HTTP Redirect (CTF)**

可以在重定向中放入内容。该内容不会显示给用户（因为浏览器会执行重定向），但可能在其中隐藏信息。

### Web Vulnerabilities Checking

在对 web 应用进行全面枚举之后，就该检查大量可能的漏洞了。你可以在下面的清单中找到检查项：


{{#ref}}
../../pentesting-web/web-vulnerabilities-methodology.md
{{#endref}}

Find more info about web vulns in:

- [https://six2dez.gitbook.io/pentest-book/others/web-checklist](https://six2dez.gitbook.io/pentest-book/others/web-checklist)
- [https://kennel209.gitbooks.io/owasp-testing-guide-v4/content/en/web_application_security_testing/configuration_and_deployment_management_testing.html](https://kennel209.gitbooks.io/owasp-testing-guide-v4/content/en/web_application_security_testing/configuration_and_deployment_management_testing.html)
- [https://owasp-skf.gitbook.io/asvs-write-ups/kbid-111-client-side-template-injection](https://owasp-skf.gitbook.io/asvs-write-ups/kbid-111-client-side-template-injection)

### Monitor Pages for changes

你可以使用诸如 [https://github.com/dgtlmoon/changedetection.io](https://github.com/dgtlmoon/changedetection.io) 的工具来监控页面是否被修改，因为修改可能引入漏洞。

### HackTricks Automatic Commands
```
Protocol_Name: Web    #Protocol Abbreviation if there is one.
Port_Number:  80,443     #Comma separated if there is more than one.
Protocol_Description: Web         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for Web
Note: |
https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-web/index.html

Entry_2:
Name: Quick Web Scan
Description: Nikto and GoBuster
Command: nikto -host {Web_Proto}://{IP}:{Web_Port} &&&& gobuster dir -w {Small_Dirlist} -u {Web_Proto}://{IP}:{Web_Port} && gobuster dir -w {Big_Dirlist} -u {Web_Proto}://{IP}:{Web_Port}

Entry_3:
Name: Nikto
Description: Basic Site Info via Nikto
Command: nikto -host {Web_Proto}://{IP}:{Web_Port}

Entry_4:
Name: WhatWeb
Description: General purpose auto scanner
Command: whatweb -a 4 {IP}

Entry_5:
Name: Directory Brute Force Non-Recursive
Description:  Non-Recursive Directory Brute Force
Command: gobuster dir -w {Big_Dirlist} -u {Web_Proto}://{IP}:{Web_Port}

Entry_6:
Name: Directory Brute Force Recursive
Description: Recursive Directory Brute Force
Command: python3 {Tool_Dir}dirsearch/dirsearch.py -w {Small_Dirlist} -e php,exe,sh,py,html,pl -f -t 20 -u {Web_Proto}://{IP}:{Web_Port} -r 10

Entry_7:
Name: Directory Brute Force CGI
Description: Common Gateway Interface Brute Force
Command: gobuster dir -u {Web_Proto}://{IP}:{Web_Port}/ -w /usr/share/seclists/Discovery/Web-Content/CGIs.txt -s 200

Entry_8:
Name: Nmap Web Vuln Scan
Description: Tailored Nmap Scan for web Vulnerabilities
Command: nmap -vv --reason -Pn -sV -p {Web_Port} --script=`banner,(http* or ssl*) and not (brute or broadcast or dos or external or http-slowloris* or fuzzer)` {IP}

Entry_9:
Name: Drupal
Description: Drupal Enumeration Notes
Note: |
git clone https://github.com/immunIT/drupwn.git for low hanging fruit and git clone https://github.com/droope/droopescan.git for deeper enumeration

Entry_10:
Name: WordPress
Description: WordPress Enumeration with WPScan
Command: |
?What is the location of the wp-login.php? Example: /Yeet/cannon/wp-login.php
wpscan --url {Web_Proto}://{IP}{1} --enumerate ap,at,cb,dbe && wpscan --url {Web_Proto}://{IP}{1} --enumerate u,tt,t,vp --passwords {Big_Passwordlist} -e

Entry_11:
Name: WordPress Hydra Brute Force
Description: Need User (admin is default)
Command: hydra -l admin -P {Big_Passwordlist} {IP} -V http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:S=Location'

Entry_12:
Name: Ffuf Vhost
Description: Simple Scan with Ffuf for discovering additional vhosts
Command: ffuf -w {Subdomain_List}:FUZZ -u {Web_Proto}://{Domain_Name} -H "Host:FUZZ.{Domain_Name}" -c -mc all {Ffuf_Filters}
```
{{#include ../../banners/hacktricks-training.md}}
