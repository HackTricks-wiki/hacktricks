# 80,443 - Pentesting Web Metodologie

{{#include ../../banners/hacktricks-training.md}}

## Basiese Inligting

Die webdiens is die mees **algemene en omvattende diens** en daar bestaan baie **verskillende tipes kwesbaarhede**.

**Standaardpoort:** 80 (HTTP), 443 (HTTPS)
```bash
PORT    STATE SERVICE
80/tcp  open  http
443/tcp open  ssl/https
```

```bash
nc -v domain.com 80 # GET / HTTP/1.0
openssl s_client -connect domain.com:443 # GET / HTTP/1.0
```
### Web API Riglyne


{{#ref}}
web-api-pentesting.md
{{#endref}}

## Metodologie opsomming

> In hierdie metodologie gaan ons aanneem dat jy 'n aanval op 'n domein (of subdomein) gaan uitvoer en slegs daardie een. Dus, moet jy hierdie metodologie toepas op elke ontdekte domein, subdomein of IP met 'n onbepaalde web server binne die scope.

- [ ] Begin deur **identifying** die **technologies** wat deur die web server gebruik word. Soek vir **tricks** om gedurende die res van die toets in gedagte te hou as jy die tech suksesvol kan identify.
- [ ] Enige **known vulnerability** van die weergawe van die technology?
- [ ] Gebruik enige **well known tech**? Enige **useful trick** om meer inligting te onttrek?
- [ ] Enige **specialised scanner** om uit te voer (soos wpscan)?
- [ ] Voer **general purposes scanners** uit — jy weet nooit of hulle iets of interessante inligting sal vind nie.
- [ ] Begin met die **initial checks**: **robots**, **sitemap**, **404** error en **SSL/TLS scan** (as dit HTTPS is).
- [ ] Begin **spidering** die webblad: Dit is tyd om alle moontlike **files, folders** en **parameters being used.** ook te **find**. Kyk ook na **special findings**.
- [ ] _Let wel dat wanneer ook al 'n nuwe directory ontdek word tydens brute-forcing of spidering, dit spidered moet word._
- [ ] **Directory Brute-Forcing**: Probeer om alle ontdekte vouers te brute force op soek na nuwe **files** en **directories**.
- [ ] _Let wel dat wanneer ook al 'n nuwe directory ontdek word tydens brute-forcing of spidering, dit Brute-Forced moet word._
- [ ] **Backups checking**: Toets of jy **backups** van **discovered files** kan vind deur algemene backup-extensies aan te heg.
- [ ] **Brute-Force parameters**: Probeer om **find hidden parameters**.
- [ ] Sodra jy al die moontlike **endpoints** wat **user input** aanvaar **identified** het, toets vir alle tipes verwante **vulnerabilities**.
- [ ] [Volg hierdie checklist](../../pentesting-web/web-vulnerabilities-methodology.md)

## Bedienerweergawe (Kwetsbaar?)

### Identifiseer

Kontroleer of daar **known vulnerabilities** vir die server **version** wat loop is.\
Die **HTTP headers and cookies of the response** kan baie nuttig wees om die **technologies** en/of **version** te **identify** wat gebruik word. **Nmap scan** kan die server version identifiseer, maar ook die gereedskap [**whatweb**](https://github.com/urbanadventurer/WhatWeb)**,** [**webtech** ](https://github.com/ShielderSec/webtech)or [**https://builtwith.com/**](https://builtwith.com)**:**
```bash
whatweb -a 1 <URL> #Stealthy
whatweb -a 3 <URL> #Aggresive
webtech -u <URL>
webanalyze -host https://google.com -crawl 2
```
Soek **for** [**vulnerabilities of the web application** **version**](../../generic-hacking/search-exploits.md)

### **Kontroleer of daar 'n WAF is**

- [**https://github.com/EnableSecurity/wafw00f**](https://github.com/EnableSecurity/wafw00f)
- [**https://github.com/Ekultek/WhatWaf.git**](https://github.com/Ekultek/WhatWaf.git)
- [**https://nmap.org/nsedoc/scripts/http-waf-detect.html**](https://nmap.org/nsedoc/scripts/http-waf-detect.html)

### Web tech wenke

Sommige **wenke** om **vulnerabilities** te vind in verskillende goed bekende **technologies** wat gebruik word:

- [**AEM - Adobe Experience Cloud**](aem-adobe-experience-cloud.md)
- [**Apache**](apache.md)
- [**Artifactory**](artifactory-hacking-guide.md)
- [**Buckets**](buckets/index.html)
- [**CGI**](cgi.md)
- [**Drupal**](drupal/index.html)
- [**Flask**](flask.md)
- [**Git**](git.md)
- [**Golang**](golang.md)
- [**GraphQL**](graphql.md)
- [**H2 - Java SQL database**](h2-java-sql-database.md)
- [**ISPConfig**](ispconfig.md)
- [**IIS tricks**](iis-internet-information-services.md)
- [**Microsoft SharePoint**](microsoft-sharepoint.md)
- [**JBOSS**](jboss.md)
- [**Jenkins**](<[https:/github.com/carlospolop/hacktricks/blob/master/network-services-pentesting/pentesting-web/broken-reference/README.md](https:/github.com/HackTricks-wiki/hacktricks-cloud/tree/master/pentesting-ci-cd/jenkins-security)/>)
- [**Jira**](jira.md)
- [**Joomla**](joomla.md)
- [**JSP**](jsp.md)
- [**Laravel**](laravel.md)
- [**Moodle**](moodle.md)
- [**Nginx**](nginx.md)
- [**PHP (php has a lot of interesting tricks that could be exploited)**](php-tricks-esp/index.html)
- [**Python**](python.md)
- [**Roundcube**](roundcube.md)
- [**Spring Actuators**](spring-actuators.md)
- [**Symphony**](symphony.md)
- [**Tomcat**](tomcat/index.html)
- [**VMWare**](vmware-esx-vcenter....md)
- [**Web API Pentesting**](web-api-pentesting.md)
- [**WebDav**](put-method-webdav.md)
- [**Werkzeug**](werkzeug.md)
- [**Wordpress**](wordpress.md)
- [**Electron Desktop (XSS to RCE)**](electron-desktop-apps/index.html)
- [**Sitecore**](sitecore/index.html)
- [**Zabbix**](zabbix.md)

_Neem in ag dat die **selfde domein** verskillende **tegnologieë** op verskillende **poorte**, **vouers** en **subdomeine** kan gebruik._\
As die webtoepassing enige goed bekende **tech/platform** soos hierbo gelys of **any other** gebruik, moenie vergeet om **op die Internet** na nuwe wenke te soek (en laat weet my!).

### Bronkode Oorsig

As die **source code** van die toepassing op **github** beskikbaar is, benewens om self 'n **White box** test van die toepassing uit te voer, is daar **sommige inligting** wat nuttig kan wees vir die huidige **Black-Box testing**:

- Is daar 'n **Change-log** of **Readme** of **Version file** of enigiets met **version info** toeganklik via die web?
- Hoe en waar word die **credentials** gestoor? Is daar enige (toeganklike?) **file** met **credentials** (usernames of passwords)?
- Is daar **passwords** in **plain text**, **encrypted**, of watter **hashing algorithm** word gebruik?
- Word daar enige **master key** gebruik om iets te enkripteer? Watter **algorithm** word gebruik?
- Kan jy toegang tot enige van hierdie **files** kry deur 'n **vulnerability** uit te buit?
- Is daar enige interessante inligting in die **github** (opgelos en nie-opgelos) **issues**? Of in die **commit history** (miskien 'n **password** ingevoer in 'n ou commit)?


{{#ref}}
code-review-tools.md
{{#endref}}

### Outomatiese skandeerders

#### Algemene doeleinde outomatiese skandeerders
```bash
nikto -h <URL>
whatweb -a 4 <URL>
wapiti -u <URL>
W3af
zaproxy #You can use an API
nuclei -ut && nuclei -target <URL>

# https://github.com/ignis-sec/puff (client side vulns fuzzer)
node puff.js -w ./wordlist-examples/xss.txt -u "http://www.xssgame.com/f/m4KKGHi2rVUN/?query=FUZZ"
```
#### CMS skandeerders

As 'n CMS gebruik word, moenie vergeet om **'n skandeerder te laat loop** nie; dalk word iets waardevols gevind:

[**Clusterd**](https://github.com/hatRiot/clusterd)**:** [**JBoss**](jboss.md)**, ColdFusion, WebLogic,** [**Tomcat**](tomcat/index.html)**, Railo, Axis2, Glassfish**\
[**CMSScan**](https://github.com/ajinabraham/CMSScan): [**WordPress**](wordpress.md), [**Drupal**](drupal/index.html), **Joomla**, **vBulletin** webwerwe vir sekuriteitskwessies. (GUI)\
[**VulnX**](https://github.com/anouarbensaad/vulnx)**:** [**Joomla**](joomla.md)**,** [**Wordpress**](wordpress.md)**,** [**Drupal**](drupal/index.html)**, PrestaShop, Opencart**\
**CMSMap**: [**(W)ordpress**](wordpress.md)**,** [**(J)oomla**](joomla.md)**,** [**(D)rupal**](drupal/index.html) **of** [**(M)oodle**](moodle.md)\
[**droopscan**](https://github.com/droope/droopescan)**:** [**Drupal**](drupal/index.html)**,** [**Joomla**](joomla.md)**,** [**Moodle**](moodle.md)**, Silverstripe,** [**Wordpress**](wordpress.md)
```bash
cmsmap [-f W] -F -d <URL>
wpscan --force update -e --url <URL>
joomscan --ec -u <URL>
joomlavs.rb #https://github.com/rastating/joomlavs
```
> Op hierdie stadium behoort jy reeds 'n paar inligting te hê oor die webbediener wat deur die kliënt gebruik word (indien enige data gegee is) en 'n paar truuks om in gedagte te hou tydens die toets. As jy gelukkig is het jy selfs 'n CMS gevind en 'n skandeerder laat loop.

## Stapsgewyse Webtoepassing-ontdekking

> Vanaf hierdie punt gaan ons begin om met die webtoepassing te interakteer.

### Aanvanklike kontrole

**Standaard bladsye met interessante inligting:**

- /robots.txt
- /sitemap.xml
- /crossdomain.xml
- /clientaccesspolicy.xml
- /.well-known/
- Kyk ook na kommentaar op die hoof- en sekondêre bladsye.

**Foute afdwing**

Webbedieners kan **onvoorspelbaar optree** wanneer vreemde data aan hulle gestuur word. Dit kan **kwesbaarhede** of die **onthulling van sensitiewe inligting** tot gevolg hê.

- Gaan toegang tot **valse bladsye** soos /whatever_fake.php (.aspx,.html,.etc)
- **Voeg "[]", "]]", en "[["** in **cookie values** en **parameter** waardes om foute te skep
- Genereer 'n fout deur insette te gee as **`/~randomthing/%s`** aan die **einde** van die **URL**
- Probeer **verskillende HTTP Verbs** soos PATCH, DEBUG of verkeerde soos FAKE

#### **Kyk of jy lêers kan oplaai (**[**PUT verb, WebDav**](put-method-webdav.md)**)**

As jy vind dat **WebDav** aangeskakel is maar jy het nie genoeg toestemming om **lêers op te laai** in die wortelgids nie, probeer om:

- **Brute Force** credentials
- **Upload files** via WebDav na die **res** van die **gevonde gidse** binne die webblad. Jy mag toestemming hê om lêers in ander gidse op te laai.

### **SSL/TLS kwesbaarhede**

- As die toepassing **nie die gebruik van HTTPS afdwing** in enige deel nie, dan is dit **vatbaar vir MitM**
- As die toepassing **sensitiewe data (wagwoorde) stuur via HTTP**. Dit is dan 'n hoë kwesbaarheid.

Gebruik [**testssl.sh**](https://github.com/drwetter/testssl.sh) om vir **kwesbaarhede** te kontroleer (in Bug Bounty-programme sal hierdie soort kwesbaarhede waarskynlik nie aanvaar word nie) en gebruik [**a2sv** ](https://github.com/hahwul/a2sv) om die kwesbaarhede te herkontroleer:
```bash
./testssl.sh [--htmlfile] 10.10.10.10:443
#Use the --htmlfile to save the output inside an htmlfile also

# You can also use other tools, by testssl.sh at this momment is the best one (I think)
sslscan <host:port>
sslyze --regular <ip:port>
```
Inligting oor SSL/TLS kwetsbaarhede:

- [https://www.gracefulsecurity.com/tls-ssl-vulnerabilities/](https://www.gracefulsecurity.com/tls-ssl-vulnerabilities/)
- [https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/](https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/)

### Spidering

Begin 'n soort **spider** op die web. Die doel van die spider is om **soveel paths as moontlik** van die getoetste toepassing te vind. Daarom moet web crawling en eksterne bronne gebruik word om soveel geldige paths as moontlik te ontdek.

- [**gospider**](https://github.com/jaeles-project/gospider) (go): HTML spider, LinkFinder in JS-lêers en eksterne bronne (Archive.org, CommonCrawl.org, VirusTotal.com).
- [**hakrawler**](https://github.com/hakluke/hakrawler) (go): HTML spider, met LinkFinder vir JS-lêers en Archive.org as eksterne bron.
- [**dirhunt**](https://github.com/Nekmo/dirhunt) (python): HTML spider, gee ook aan "juicy files".
- [**evine** ](https://github.com/saeeddhqan/evine)(go): Interaktiewe CLI HTML spider. Dit soek ook in Archive.org
- [**meg**](https://github.com/tomnomnom/meg) (go): Hierdie hulpmiddel is nie 'n spider nie maar kan handig wees. Jy kan eenvoudig 'n lêer met hosts en 'n lêer met paths aandui en meg sal elke path op elke host ophaal en die response stoor.
- [**urlgrab**](https://github.com/IAmStoxe/urlgrab) (go): HTML spider met JS-rendering vermoëns. Dit lyk egter ononderhou, die vooraf-gekompileerde weergawe is oud en die huidige kode kompileer nie.
- [**gau**](https://github.com/lc/gau) (go): HTML spider wat eksterne providers gebruik (wayback, otx, commoncrawl).
- [**ParamSpider**](https://github.com/devanshbatham/ParamSpider): Hierdie script sal URLs met parameters vind en dit opsom.
- [**galer**](https://github.com/dwisiswant0/galer) (go): HTML spider met JS-rendering vermoëns.
- [**LinkFinder**](https://github.com/GerbenJavado/LinkFinder) (python): HTML spider, met JS beautify vermoëns wat nuwe paths in JS-lêers kan soek. Dit kan ook die moeite werd wees om [JSScanner](https://github.com/dark-warlord14/JSScanner) te bekyk, wat 'n wrapper van LinkFinder is.
- [**goLinkFinder**](https://github.com/0xsha/GoLinkFinder) (go): Om endpoints te onttrek uit beide HTML-bron en ingeslote javascript-lêers. Nuttig vir bug hunters, red teamers, infosec ninjas.
- [**JSParser**](https://github.com/nahamsec/JSParser) (python2.7): 'n python 2.7 script wat Tornado en JSBeautifier gebruik om relatiewe URLs uit JavaScript-lêers te parseer. Nuttig om AJAX-versoeke maklik te ontdek. Lyk ononderhou.
- [**relative-url-extractor**](https://github.com/jobertabma/relative-url-extractor) (ruby): Gegee 'n lêer (HTML) sal dit URLs daaruit onttrek met 'n netjiese regular expression om relatiewe URLs uit geminifiseerde lêers te kry.
- [**JSFScan**](https://github.com/KathanP19/JSFScan.sh) (bash, verskeie gereedskap): Versamel interessante inligting uit JS-lêers deur gebruik te maak van verskeie gereedskap.
- [**subjs**](https://github.com/lc/subjs) (go): Vind JS-lêers.
- [**page-fetch**](https://github.com/detectify/page-fetch) (go): Laai 'n bladsy in 'n headless browser en druk al die urls wat gelaai word om die bladsy te laai.
- [**Feroxbuster**](https://github.com/epi052/feroxbuster) (rust): Content discovery tool wat verskeie opsies van die vorige gereedskap meng.
- [**Javascript Parsing**](https://github.com/xnl-h4ck3r/burp-extensions): 'n Burp extension om paths en params in JS-lêers te vind.
- [**Sourcemapper**](https://github.com/denandz/sourcemapper): 'n hulpmiddel wat gegewe die .js.map URL die mooi gemaakde JS-kode sal kry.
- [**xnLinkFinder**](https://github.com/xnl-h4ck3r/xnLinkFinder): Hierdie is 'n hulpmiddel wat gebruik word om endpoints vir 'n gegewe teiken te ontdek.
- [**waymore**](https://github.com/xnl-h4ck3r/waymore)**:** Ontdek links van die wayback machine (laai ook die responses in die wayback af en soek daarna meer links).
- [**HTTPLoot**](https://github.com/redhuntlabs/HTTPLoot) (go): Crawl (selfs deur vorms in te vul) en vind ook sensitiewe inligting met spesifieke regexes.
- [**SpiderSuite**](https://github.com/3nock/SpiderSuite): Spider Suite is 'n gevorderde multi-funksie GUI web security Crawler/Spider ontwerp vir kuberveiligheidsprofessie s.
- [**jsluice**](https://github.com/BishopFox/jsluice) (go): Dit is 'n Go pakket en [command-line tool](https://github.com/BishopFox/jsluice/blob/main/cmd/jsluice) vir die onttrekking van URLs, paths, secrets, en ander interessante data uit JavaScript bronkode.
- [**ParaForge**](https://github.com/Anof-cyber/ParaForge): ParaForge is 'n eenvoudige **Burp Suite extension** om **die parameters en endpoints te onttrek** uit versoeke om 'n pasgemaakte wordlist vir fuzzing en enumerasie te skep.
- [**katana**](https://github.com/projectdiscovery/katana) (go): Fantastiese hulpmiddel hiervoor.
- [**Crawley**](https://github.com/s0rg/crawley) (go): Print elke link wat dit kan vind.

### Brute Force directories and files

Begin **brute-forcing** vanaf die wortel-gids en maak seker om **alle** die gevonde **directories** te brute-force met **hierdie metode** en al die directories wat deur die **Spidering** ontdek is (jy kan dit **recursively** doen en die name van die gevonde directories aan die begin van die gebruikte wordlist voeg).\
Gereedskap:

- **Dirb** / **Dirbuster** - Ingesluit in Kali, **oud** (en **stadig**) maar funksioneel. Laat auto-signed certificates en recursive search toe. Te stadig in vergelyking met ander opsies.
- [**Dirsearch**](https://github.com/maurosoria/dirsearch) (python)**: Dit laat nie auto-signed certificates toe nie maar** ondersteun recursive search.
- [**Gobuster**](https://github.com/OJ/gobuster) (go): Dit ondersteun auto-signed certificates, maar dit **het nie** **recursive** search nie.
- [**Feroxbuster**](https://github.com/epi052/feroxbuster) **- Fast, supports recursive search.**
- [**wfuzz**](https://github.com/xmendez/wfuzz) `wfuzz -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt https://domain.com/api/FUZZ`
- [**ffuf** ](https://github.com/ffuf/ffuf)- Fast: `ffuf -c -w /usr/share/wordlists/dirb/big.txt -u http://10.10.10.10/FUZZ`
- [**uro**](https://github.com/s0md3v/uro) (python): Dit is nie 'n spider nie maar 'n hulpmiddel wat gegewe 'n lys van gevonde URLs "gedupliseerde" URLs sal verwyder.
- [**Scavenger**](https://github.com/0xDexter0us/Scavenger): Burp Extension om 'n lys directories te skep van die burp geskiedenis van verskillende bladsye.
- [**TrashCompactor**](https://github.com/michael1026/trashcompactor): Verwyder URLs met gedupliseerde funksionaliteite (gebaseer op js imports).
- [**Chamaleon**](https://github.com/iustin24/chameleon): Dit gebruik wapalyzer om gebruikte tegnologieë te identifiseer en kies die woordlyste om te gebruik.

**Aanbevole woordelysse:**

- [https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/bf_directories.txt](https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/bf_directories.txt)
- [**Dirsearch** included dictionary](https://github.com/maurosoria/dirsearch/blob/master/db/dicc.txt)
- [http://gist.github.com/jhaddix/b80ea67d85c13206125806f0828f4d10](http://gist.github.com/jhaddix/b80ea67d85c13206125806f0828f4d10)
- [Assetnote wordlists](https://wordlists.assetnote.io)
- [https://github.com/danielmiessler/SecLists/tree/master/Discovery/Web-Content](https://github.com/danielmiessler/SecLists/tree/master/Discovery/Web-Content)
- raft-large-directories-lowercase.txt
- directory-list-2.3-medium.txt
- RobotsDisallowed/top10000.txt
- [https://github.com/random-robbie/bruteforce-lists](https://github.com/random-robbie/bruteforce-lists)
- [https://github.com/google/fuzzing/tree/master/dictionaries](https://github.com/google/fuzzing/tree/master/dictionaries)
- [https://github.com/six2dez/OneListForAll](https://github.com/six2dez/OneListForAll)
- [https://github.com/random-robbie/bruteforce-lists](https://github.com/random-robbie/bruteforce-lists)
- [https://github.com/ayoubfathi/leaky-paths](https://github.com/ayoubfathi/leaky-paths)
- _/usr/share/wordlists/dirb/common.txt_
- _/usr/share/wordlists/dirb/big.txt_
- _/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt_

_Kenmerk dat elke keer as 'n nuwe directory tydens brute-forcing of spidering ontdek word, dit weer Brute-Forced moet word._

### What to check on each file found

- [**Broken link checker**](https://github.com/stevenvachon/broken-link-checker): Vind gebroke links binne HTML's wat vatbaar kan wees vir takeovers
- **File Backups**: Sodra jy al die lêers gevind het, soek vir backups van al die uitvoerbare lêers ("_.php_", "_.aspx_"...). Algemene variasies vir die benoeming van 'n backup is: _file.ext\~, #file.ext#, \~file.ext, file.ext.bak, file.ext.tmp, file.ext.old, file.bak, file.tmp and file.old._ Jy kan ook die hulpmiddel [**bfac**](https://github.com/mazen160/bfac) **of** [**backup-gen**](https://github.com/Nishantbhagat57/backup-gen)** gebruik.**
- **Discover new parameters**: Jy kan gereedskap soos [**Arjun**](https://github.com/s0md3v/Arjun)**,** [**parameth**](https://github.com/maK-/parameth)**,** [**x8**](https://github.com/sh1yo/x8) **en** [**Param Miner**](https://github.com/PortSwigger/param-miner) **gebruik om versteekte parameters te ontdek. Indien moontlik, probeer om versteekte parameters op elke uitvoerbare web-lêer te soek.**
- _Arjun all default wordlists:_ [https://github.com/s0md3v/Arjun/tree/master/arjun/db](https://github.com/s0md3v/Arjun/tree/master/arjun/db)
- _Param-miner “params” :_ [https://github.com/PortSwigger/param-miner/blob/master/resources/params](https://github.com/PortSwigger/param-miner/blob/master/resources/params)
- _Assetnote “parameters_top_1m”:_ [https://wordlists.assetnote.io/](https://wordlists.assetnote.io)
- _nullenc0de “params.txt”:_ [https://gist.github.com/nullenc0de/9cb36260207924f8e1787279a05eb773](https://gist.github.com/nullenc0de/9cb36260207924f8e1787279a05eb773)
- **Comments:** Kontroleer die kommentaar van al die lêers; jy kan **credentials** of **verborgen funksionaliteit** vind.
- As jy in 'n **CTF** speel, is 'n "gewone" truuk om **inligting** in kommentaar regs van die bladsy te **versteek** (gebruik honderde spasies sodat jy die data nie sien as jy die bronkode in die blaaier oopmaak nie). 'n Ander moontlikheid is om meerdere nuwe lyne te gebruik en inligting in 'n kommentaar onder in die webblad te verberg.
- **API keys**: As jy enige API key vind, is daar gidse wat aandui hoe om API keys van verskeie platforms te gebruik: [**keyhacks**](https://github.com/streaak/keyhacks)**,** [**zile**](https://github.com/xyele/zile.git)**,** [**truffleHog**](https://github.com/trufflesecurity/truffleHog)**,** [**SecretFinder**](https://github.com/m4ll0k/SecretFinder)**,** [**RegHex**](<https://github.com/l4yton/RegHex)/>)**,** [**DumpsterDive**](https://github.com/securing/DumpsterDiver)**,** [**EarlyBird**](https://github.com/americanexpress/earlybird)
- Google API keys: As jy enige API key vind wat lyk soos **AIza**SyA-qLheq6xjDiEIRisP_ujUseYLQCHUjik kan jy die projek [**gmapapiscanner**](https://github.com/ozguralp/gmapsapiscanner) gebruik om te kyk watter APIs die sleutel kan toegang gee.
- **S3 Buckets**: Terwyl jy spider, kyk of enige **subdomain** of enige **link** verwant is aan 'n **S3 bucket**. In daardie geval, [**check** the **permissions** of the bucket](buckets/index.html).

### Special findings

**Terwyl** jy die **spidering** en **brute-forcing** uitvoer, kan jy **interessante** **vondste** ontdek wat jy moet **merk**.

- **Interessante lêers**
  - Soek na **links** na ander lêers binne die **CSS**-lêers.
  - [If you find a _**.git**_ file some information can be extracted](git.md)
  - As jy 'n _**.env**_ vind, kan inligting soos api keys, db-wachtwoorde en ander inligting gevind word.
  - As jy **API endpoints** vind, [should also test them](web-api-pentesting.md). Hierdie is nie lêers nie, maar hulle sal waarskynlik "soos" lêers lyk.
  - **JS files**: In die spidering afdeling is verskeie gereedskap genoem wat paths uit JS-lêers kan onttrek. Dit sal ook interessant wees om elke gevonde JS-lêer te monitor, aangesien 'n verandering soms daarop kan dui dat 'n potensiële kwesbaarheid in die kode ingebring is. Jy kan byvoorbeeld [**JSMon**](https://github.com/robre/jsmon)** gebruik.**
  - Jy moet ook ontdekte JS-lêers nagaan met [**RetireJS**](https://github.com/retirejs/retire.js/) of [**JSHole**](https://github.com/callforpapers-source/jshole) om te sien of dit kwesbaar is.
  - **Javascript Deobfuscator and Unpacker:** [https://lelinhtinh.github.io/de4js/](https://lelinhtinh.github.io/de4js/), [https://www.dcode.fr/javascript-unobfuscator](https://www.dcode.fr/javascript-unobfuscator)
  - **Javascript Beautifier:** [http://jsbeautifier.org/](https://beautifier.io), [http://jsnice.org/](http://jsnice.org)
  - **JsFuck deobfuscation** (javascript with chars:"\[]!+" [https://enkhee-osiris.github.io/Decoder-JSFuck/](https://enkhee-osiris.github.io/Decoder-JSFuck/))
  - **TrainFuck**](https://github.com/taco-c/trainfuck)**:** `+72.+29.+7..+3.-67.-12.+55.+24.+3.-6.-8.-67.-23.`
  - In baie gevalle sal jy die regular expressions moet verstaan wat gebruik word. Dit sal nuttig wees: [https://regex101.com/](https://regex101.com) of [https://pythonium.net/regex](https://pythonium.net/regex)
  - Jy kan ook die lêers monitor waar vorms gedetecteer is, aangesien 'n verandering in die parameter of die verskyning van 'n nuwe vorm kan dui op 'n potensiële nuwe kwesbare funksionaliteit.

**403 Forbidden/Basic Authentication/401 Unauthorized (bypass)**


{{#ref}}
403-and-401-bypasses.md
{{#endref}}

**502 Proxy Error**

As enige bladsy met daardie kode antwoord, is dit waarskynlik 'n sleg gekonfigureerde proxy. **As jy 'n HTTP versoek stuur soos: `GET https://google.com HTTP/1.1`** (met die host header en ander algemene headers), sal die **proxy** probeer om toegang tot _**google.com**_ te kry en jy het 'n SSRF gevind.

**NTLM Authentication - Info disclosure**

As die hardloopbediener wat vir authentication vra 'n **Windows** is of jy vind 'n login wat jou **credentials** vra (en vra vir **domain** **name**), kan jy 'n **information disclosure** veroorsaak.\
**Stuur** die **header**: `“Authorization: NTLM TlRMTVNTUAABAAAAB4IIAAAAAAAAAAAAAAAAAAAAAAA=”` en weens hoe **NTLM authentication** werk, sal die bediener met interne inligting (IIS version, Windows version...) in die header "WWW-Authenticate" antwoord.\
Jy kan dit outomatiseer met die **nmap plugin** "_http-ntlm-info.nse_".

**HTTP Redirect (CTF)**

Dit is moontlik om **inhoud** binne 'n **Redirection** te plaas. Hierdie inhoud **sal nie aan die gebruiker getoon word nie** (aangesien die blaaier die redirection uitvoer) maar iets kan daarin **weggesteek** wees.

### Web Vulnerabilities Checking

Nou dat 'n omvattende enumerasie van die web toepassing uitgevoer is, is dit tyd om vir baie moontlike kwesbaarhede te toets. Jy kan die checklist hier vind:


{{#ref}}
../../pentesting-web/web-vulnerabilities-methodology.md
{{#endref}}

Vind meer inligting oor web vulns in:

- [https://six2dez.gitbook.io/pentest-book/others/web-checklist](https://six2dez.gitbook.io/pentest-book/others/web-checklist)
- [https://kennel209.gitbooks.io/owasp-testing-guide-v4/content/en/web_application_security_testing/configuration_and_deployment_management_testing.html](https://kennel209.gitbooks.io/owasp-testing-guide-v4/content/en/web_application_security_testing/configuration_and_deployment_management_testing.html)
- [https://owasp-skf.gitbook.io/asvs-write-ups/kbid-111-client-side-template-injection](https://owasp-skf.gitbook.io/asvs-write-ups/kbid-111-client-side-template-injection)

### Monitor Pages for changes

Jy kan gereedskap soos [https://github.com/dgtlmoon/changedetection.io](https://github.com/dgtlmoon/changedetection.io) gebruik om bladsye te monitor vir wysigings wat kwesbaarhede kan inbring.

### HackTricks Automatic Commands
```
Protocol_Name: Web    #Protocol Abbreviation if there is one.
Port_Number:  80,443     #Comma separated if there is more than one.
Protocol_Description: Web         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for Web
Note: |
https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-web/index.html

Entry_2:
Name: Quick Web Scan
Description: Nikto and GoBuster
Command: nikto -host {Web_Proto}://{IP}:{Web_Port} &&&& gobuster dir -w {Small_Dirlist} -u {Web_Proto}://{IP}:{Web_Port} && gobuster dir -w {Big_Dirlist} -u {Web_Proto}://{IP}:{Web_Port}

Entry_3:
Name: Nikto
Description: Basic Site Info via Nikto
Command: nikto -host {Web_Proto}://{IP}:{Web_Port}

Entry_4:
Name: WhatWeb
Description: General purpose auto scanner
Command: whatweb -a 4 {IP}

Entry_5:
Name: Directory Brute Force Non-Recursive
Description:  Non-Recursive Directory Brute Force
Command: gobuster dir -w {Big_Dirlist} -u {Web_Proto}://{IP}:{Web_Port}

Entry_6:
Name: Directory Brute Force Recursive
Description: Recursive Directory Brute Force
Command: python3 {Tool_Dir}dirsearch/dirsearch.py -w {Small_Dirlist} -e php,exe,sh,py,html,pl -f -t 20 -u {Web_Proto}://{IP}:{Web_Port} -r 10

Entry_7:
Name: Directory Brute Force CGI
Description: Common Gateway Interface Brute Force
Command: gobuster dir -u {Web_Proto}://{IP}:{Web_Port}/ -w /usr/share/seclists/Discovery/Web-Content/CGIs.txt -s 200

Entry_8:
Name: Nmap Web Vuln Scan
Description: Tailored Nmap Scan for web Vulnerabilities
Command: nmap -vv --reason -Pn -sV -p {Web_Port} --script=`banner,(http* or ssl*) and not (brute or broadcast or dos or external or http-slowloris* or fuzzer)` {IP}

Entry_9:
Name: Drupal
Description: Drupal Enumeration Notes
Note: |
git clone https://github.com/immunIT/drupwn.git for low hanging fruit and git clone https://github.com/droope/droopescan.git for deeper enumeration

Entry_10:
Name: WordPress
Description: WordPress Enumeration with WPScan
Command: |
?What is the location of the wp-login.php? Example: /Yeet/cannon/wp-login.php
wpscan --url {Web_Proto}://{IP}{1} --enumerate ap,at,cb,dbe && wpscan --url {Web_Proto}://{IP}{1} --enumerate u,tt,t,vp --passwords {Big_Passwordlist} -e

Entry_11:
Name: WordPress Hydra Brute Force
Description: Need User (admin is default)
Command: hydra -l admin -P {Big_Passwordlist} {IP} -V http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:S=Location'

Entry_12:
Name: Ffuf Vhost
Description: Simple Scan with Ffuf for discovering additional vhosts
Command: ffuf -w {Subdomain_List}:FUZZ -u {Web_Proto}://{Domain_Name} -H "Host:FUZZ.{Domain_Name}" -c -mc all {Ffuf_Filters}
```
{{#include ../../banners/hacktricks-training.md}}
