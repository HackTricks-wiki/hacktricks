# 80,443 - Pentesting Mbinu za Wavuti

{{#include ../../banners/hacktricks-training.md}}

## Taarifa za Msingi

Huduma ya wavuti ni huduma ya **kawaida zaidi na yenye wigo mpana**, na kuna aina nyingi tofauti za **udhaifu**.

**Bandari chaguo-msingi:** 80 (HTTP), 443 (HTTPS)
```bash
PORT    STATE SERVICE
80/tcp  open  http
443/tcp open  ssl/https
```

```bash
nc -v domain.com 80 # GET / HTTP/1.0
openssl s_client -connect domain.com:443 # GET / HTTP/1.0
```
### Mwongozo wa Web API


{{#ref}}
web-api-pentesting.md
{{#endref}}

## Muhtasari wa Mbinu

> Katika mbinu hii tuta dhani kwamba unakusudia kushambulia domain (au subdomain) na hiyo tu. Kwa hivyo, unapaswa kutumia mbinu hii kwa kila domain, subdomain au IP iliyogunduliwa ambayo ina web server isiyotambuliwa ndani ya wigo.

- [ ] Anza kwa **kutambua** **teknolojia** zinazotumiwa na web server. Tafuta **tricks** za kuzingatia kwa wakati wa mtihani ikiwa utaweza kutambua tech kwa ufanisi.
- [ ] Je, kuna **known vulnerability** kwa toleo la teknolojia?
- [ ] Unatumia tech inayojulikana? Kuna **useful trick** ya kutoa taarifa zaidi?
- [ ] Je, kuna **specialised scanner** ya kuendesha (kama wpscan)?
- [ ] Endesha **general purposes scanners**. Hujui kama zitapunguza kitu au zitapata taarifa za kuvutia.
- [ ] Anza na **initial checks**: **robots**, **sitemap**, hitilafu **404** na **SSL/TLS scan** (ikiwa ni **HTTPS**).
- [ ] Anza **spidering** ukurasa wa wavuti: Ni wakati wa **kutafuta** faili zote, folda na **parameters being used.** Pia, angalia **special findings**.
- [ ] _Kumbuka kwamba kila mara dirisha jipya linapogunduliwa wakati wa brute-forcing au spidering, linapaswa kuspider._
- [ ] **Directory Brute-Forcing**: Jaribu brute force folda zote zilizogunduliwa ukitafuta **files** na **directories** mpya.
- [ ] _Kumbuka kwamba kila mara dirisha jipya linapogunduliwa wakati wa brute-forcing au spidering, linapaswa ku-funge kwa Brute-Force._
- [ ] **Backups checking**: Jaribu kama unaweza kupata **backups** za **discovered files** kwa kuambatanisha extensions za kawaida za backup.
- [ ] **Brute-Force parameters**: Jaribu **kutafuta hidden parameters**.
- [ ] Mara tu utakapo **tambuza** endpoints zote zinazowezekana zinazopokea **user input**, angalia aina zote za **vulnerabilities** zinazohusiana nazo.
- [ ] [Follow this checklist](../../pentesting-web/web-vulnerabilities-methodology.md)

## Toleo la Server (Ina udhaifu?)

### Tambua

Angalia kama kuna **known vulnerabilities** kwa toleo la server linalokimbia.\
**HTTP headers and cookies of the response** zinaweza kuwa muhimu sana **kutambua** **teknolojia** na/au **toleo** linalotumika. **Nmap scan** inaweza kutambua toleo la server, lakini pia inaweza kuwa muhimu zana [**whatweb**](https://github.com/urbanadventurer/WhatWeb)**,** [**webtech** ](https://github.com/ShielderSec/webtech)au [**https://builtwith.com/**](https://builtwith.com)**:**
```bash
whatweb -a 1 <URL> #Stealthy
whatweb -a 3 <URL> #Aggresive
webtech -u <URL>
webanalyze -host https://google.com -crawl 2
```
Tafuta **kwa** [**udhaifu wa toleo la programu-tumizi ya wavuti**](../../generic-hacking/search-exploits.md)

### **Angalia kama kuna WAF**

- [**https://github.com/EnableSecurity/wafw00f**](https://github.com/EnableSecurity/wafw00f)
- [**https://github.com/Ekultek/WhatWaf.git**](https://github.com/Ekultek/WhatWaf.git)
- [**https://nmap.org/nsedoc/scripts/http-waf-detect.html**](https://nmap.org/nsedoc/scripts/http-waf-detect.html)

### Mbinu za teknolojia za wavuti

Baadhi ya **mbinu** za **kugundua udhaifu** katika **teknolojia** mbalimbali maarufu zinazotumika:

- [**AEM - Adobe Experience Cloud**](aem-adobe-experience-cloud.md)
- [**Apache**](apache.md)
- [**Artifactory**](artifactory-hacking-guide.md)
- [**Buckets**](buckets/index.html)
- [**CGI**](cgi.md)
- [**Drupal**](drupal/index.html)
- [**Flask**](flask.md)
- [**Git**](git.md)
- [**Golang**](golang.md)
- [**GraphQL**](graphql.md)
- [**H2 - Java SQL database**](h2-java-sql-database.md)
- [**ISPConfig**](ispconfig.md)
- [**IIS tricks**](iis-internet-information-services.md)
- [**Microsoft SharePoint**](microsoft-sharepoint.md)
- [**JBOSS**](jboss.md)
- [**Jenkins**](<[https:/github.com/carlospolop/hacktricks/blob/master/network-services-pentesting/pentesting-web/broken-reference/README.md](https:/github.com/HackTricks-wiki/hacktricks-cloud/tree/master/pentesting-ci-cd/jenkins-security)/>)
- [**Jira**](jira.md)
- [**Joomla**](joomla.md)
- [**JSP**](jsp.md)
- [**Laravel**](laravel.md)
- [**Moodle**](moodle.md)
- [**Nginx**](nginx.md)
- [**PHP (php has a lot of interesting tricks that could be exploited)**](php-tricks-esp/index.html)
- [**Python**](python.md)
- [**Spring Actuators**](spring-actuators.md)
- [**Symphony**](symphony.md)
- [**Tomcat**](tomcat/index.html)
- [**VMWare**](vmware-esx-vcenter....md)
- [**Web API Pentesting**](web-api-pentesting.md)
- [**WebDav**](put-method-webdav.md)
- [**Werkzeug**](werkzeug.md)
- [**Wordpress**](wordpress.md)
- [**Electron Desktop (XSS to RCE)**](electron-desktop-apps/index.html)
- [**Sitecore**](sitecore/index.html)
- [**Zabbix**](zabbix.md)

_Chukua kwa kuzingatia kwamba **domaini ile ile** inaweza kutumia **teknolojia tofauti** katika **ports**, **folders** na **subdomains** tofauti._\
Ikiwa web application inatumia teknolojia/platform maarufu yoyote iliyoorodheshwa hapo juu au nyingine yoyote, usisahau kutafuta mtandaoni mbinu mpya (na nijulishe!).

### Mapitio ya source code

Ikiwa **source code** ya application inapatikana kwenye **github**, mbali na kufanya kwa mwenyewe **White box test** ya application kuna **taarifa fulani** ambazo zinaweza kuwa **zinafaa** kwa **Black-Box testing** ya sasa:

- Je, kuna **Change-log au Readme au Version** file au kitu chochote chenye **taarifa za toleo zinazopatikana** kupitia wavuti?
- Je, vipi na wapi **credentials** zinasajiliwa? Je, kuna faili (inayoweza kupatikana?) yenye credentials (majina ya watumiaji au passwords)?
- Je, **passwords** ziko kwa **plain text**, **encrypted** au ni algoriti gani ya **hashing** inayotumika?
- Je, inatumia **master key** kwa ku-encrypt kitu chochote? Ni **algorithm** gani inayotumika?
- Je, unaweza **kupata faili zozote** kwa kutumia udhaifu fulani?
- Je, kuna taarifa yoyote ya kuvutia kwenye **github** (issues zilizosuluhishwa na zisizotatuliwa)? Au kwenye **commit history** (labda password ililetwa ndani ya commit ya zamani)?

{{#ref}}
code-review-tools.md
{{#endref}}

### Skana za moja kwa moja

#### Skana za moja kwa moja za matumizi ya jumla
```bash
nikto -h <URL>
whatweb -a 4 <URL>
wapiti -u <URL>
W3af
zaproxy #You can use an API
nuclei -ut && nuclei -target <URL>

# https://github.com/ignis-sec/puff (client side vulns fuzzer)
node puff.js -w ./wordlist-examples/xss.txt -u "http://www.xssgame.com/f/m4KKGHi2rVUN/?query=FUZZ"
```
#### Skana za CMS

Ikiwa CMS inatumiwa usisahau **run a scanner**, labda utapata kitu cha kuvutia:

[**Clusterd**](https://github.com/hatRiot/clusterd)**:** [**JBoss**](jboss.md)**, ColdFusion, WebLogic,** [**Tomcat**](tomcat/index.html)**, Railo, Axis2, Glassfish**\
[**CMSScan**](https://github.com/ajinabraham/CMSScan): [**WordPress**](wordpress.md), [**Drupal**](drupal/index.html), **Joomla**, **vBulletin** tovuti kwa masuala ya Security. (GUI)\
[**VulnX**](https://github.com/anouarbensaad/vulnx)**:** [**Joomla**](joomla.md)**,** [**Wordpress**](wordpress.md)**,** [**Drupal**](drupal/index.html)**, PrestaShop, Opencart**\
**CMSMap**: [**(W)ordpress**](wordpress.md)**,** [**(J)oomla**](joomla.md)**,** [**(D)rupal**](drupal/index.html) **or** [**(M)oodle**](moodle.md)\
[**droopscan**](https://github.com/droope/droopescan)**:** [**Drupal**](drupal/index.html)**,** [**Joomla**](joomla.md)**,** [**Moodle**](moodle.md)**, Silverstripe,** [**Wordpress**](wordpress.md)
```bash
cmsmap [-f W] -F -d <URL>
wpscan --force update -e --url <URL>
joomscan --ec -u <URL>
joomlavs.rb #https://github.com/rastating/joomlavs
```
> Kwa hatua hii unapaswa tayari kuwa na baadhi ya habari kuhusu web server inayotumika na mteja (ikiwa data yoyote imetolewa) na mbinu za kuzingatia wakati wa mtihani. Ikiwa una bahati umepata hata CMS na umeendesha scanner.

## Ugunduzi wa Web Application hatua kwa hatua

> Kuanzia hapa tutaanza kuingiliana na web application.

### Ukaguzi wa awali

**Kurasa za default zenye taarifa za kuvutia:**

- /robots.txt
- /sitemap.xml
- /crossdomain.xml
- /clientaccesspolicy.xml
- /.well-known/
- Angalia pia comments katika main na secondary pages.

**Kulazimisha makosa**

Web servers zinaweza **kutenda kwa njia isiyotegemewa** wakati data za ajabu zinapotumwa kwao. Hii inaweza kufungua **udhaifu** au **kufichua taarifa nyeti**.

- Access **fake pages** like /whatever_fake.php (.aspx,.html,.etc)
- **Add "[]", "]]", and "[["** in **cookie values** and **parameter** values to create errors
- Generate error by giving input as **`/~randomthing/%s`** at the **end** of **URL**
- Try **different HTTP Verbs** like PATCH, DEBUG or wrong like FAKE

#### **Angalia kama unaweza kupakia files (**[**PUT verb, WebDav**](put-method-webdav.md)**)**

If you find that **WebDav** is **enabled** but you don't have enough permissions for **uploading files** in the root folder try to:

- **Brute Force** credentials
- **Upload files** via WebDav to the **rest** of **found folders** inside the web page. You may have permissions to upload files in other folders.

### **SSL/TLS udhaifu**

- Ikiwa application haisuluhishi kulazimisha matumizi ya HTTPS sehemu yoyote, basi inaweza kuwa hatarini kwa MitM
- Ikiwa application inatuma data nyeti (passwords) kwa kutumia HTTP. Basi ni udhaifu mkubwa.

Use [**testssl.sh**](https://github.com/drwetter/testssl.sh) to checks for **vulnerabilities** (In Bug Bounty programs probably these kind of vulnerabilities won't be accepted) and use [**a2sv** ](https://github.com/hahwul/a2sv)to recheck the vulnerabilities:
```bash
./testssl.sh [--htmlfile] 10.10.10.10:443
#Use the --htmlfile to save the output inside an htmlfile also

# You can also use other tools, by testssl.sh at this momment is the best one (I think)
sslscan <host:port>
sslyze --regular <ip:port>
```
Information kuhusu SSL/TLS vulnerabilities:

- [https://www.gracefulsecurity.com/tls-ssl-vulnerabilities/](https://www.gracefulsecurity.com/tls-ssl-vulnerabilities/)
- [https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/](https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/)

### Spidering

Anzisha aina fulani ya **spider** ndani ya wavuti. Lengo la **spider** ni kupata njia nyingi iwezekanavyo kutoka kwenye application inayojaribiwa. Kwa hivyo, crawling ya wavuti na vyanzo vya nje vinapaswa kutumika ili kupata njia sahihi nyingi iwezekanavyo.

- [**gospider**](https://github.com/jaeles-project/gospider) (go): HTML spider, LinkFinder katika JS files na external sources (Archive.org, CommonCrawl.org, VirusTotal.com).
- [**hakrawler**](https://github.com/hakluke/hakrawler) (go): HML spider, na LinkFider kwa JS files na Archive.org kama chanzo cha nje.
- [**dirhunt**](https://github.com/Nekmo/dirhunt) (python): HTML spider, pia inaonyesha "juicy files".
- [**evine** ](https://github.com/saeeddhqan/evine)(go): Interactive CLI HTML spider. Pia inatafuta katika Archive.org
- [**meg**](https://github.com/tomnomnom/meg) (go): Tool hii si **spider** lakini inaweza kuwa muhimu. Unaweza kutoa faili lenye hosts na faili lenye paths na meg itafetch kila path kwa kila host na kuhifadhi response.
- [**urlgrab**](https://github.com/IAmStoxe/urlgrab) (go): HTML spider yenye JS rendering capabilities. Hata hivyo, inaonekana haijatumika mara kwa mara, precompiled version ni ya zamani na code ya sasa haisomi.
- [**gau**](https://github.com/lc/gau) (go): HTML spider inayotumia external providers (wayback, otx, commoncrawl)
- [**ParamSpider**](https://github.com/devanshbatham/ParamSpider): Script hii itapata URLs zenye parameter na kuziweka katika orodha.
- [**galer**](https://github.com/dwisiswant0/galer) (go): HTML spider yenye JS rendering capabilities.
- [**LinkFinder**](https://github.com/GerbenJavado/LinkFinder) (python): HTML spider, na JS beautify capabilities inayoweza kutafuta njia mpya katika JS files. Inaweza kuwa muhimu pia kuangalia [JSScanner](https://github.com/dark-warlord14/JSScanner), ambayo ni wrapper ya LinkFinder.
- [**goLinkFinder**](https://github.com/0xsha/GoLinkFinder) (go): Kutoka ku-extract endpoints katika HTML source na embedded javascript files. Inafaa kwa bug hunters, red teamers, infosec ninjas.
- [**JSParser**](https://github.com/nahamsec/JSParser) (python2.7): Script ya python 2.7 inayotumia Tornado na JSBeautifier kuchambua relative URLs kutoka JavaScript files. Inasaidia kugundua AJAX requests kwa urahisi. Inaonekana haijasasishwa.
- [**relative-url-extractor**](https://github.com/jobertabma/relative-url-extractor) (ruby): Ikitolewa file (HTML) itatoa URLs kutoka kwake kwa kutumia regular expression za kupendeza kupata na kutoa relative URLs kutoka kwa minified files.
- [**JSFScan**](https://github.com/KathanP19/JSFScan.sh) (bash, several tools): Kukusanya taarifa za kuvutia kutoka JS files kwa kutumia zana kadhaa.
- [**subjs**](https://github.com/lc/subjs) (go): Tafuta JS files.
- [**page-fetch**](https://github.com/detectify/page-fetch) (go): Pakia page katika headless browser na chapa URLs zote zilizo load ili kuonyesha page.
- [**Feroxbuster**](https://github.com/epi052/feroxbuster) (rust): Content discovery tool inayochanganya chaguo kadhaa za tools zilizotajwa hapo juu
- [**Javascript Parsing**](https://github.com/xnl-h4ck3r/burp-extensions): Burp extension ya kutafuta path na params katika JS files.
- [**Sourcemapper**](https://github.com/denandz/sourcemapper): Tool ambayo ikitolewa .js.map URL itakuletea code ya JS iliyobebwa (beautified)
- [**xnLinkFinder**](https://github.com/xnl-h4ck3r/xnLinkFinder): Tool hii inatumika kugundua endpoints kwa target fulani.
- [**waymore**](https://github.com/xnl-h4ck3r/waymore)**:** Gunduwa links kutoka wayback machine (pia download responses katika wayback na kutafuta links zaidi)
- [**HTTPLoot**](https://github.com/redhuntlabs/HTTPLoot) (go): Crawl (hata kwa kujaza forms) na pia pata taarifa nyeti kwa kutumia regex maalum.
- [**SpiderSuite**](https://github.com/3nock/SpiderSuite): Spider Suite ni GUI web security Crawler/Spider yenye sifa nyingi iliyoundwa kwa wataalamu wa usalama wa mtandao.
- [**jsluice**](https://github.com/BishopFox/jsluice) (go): Ni Go package na [command-line tool](https://github.com/BishopFox/jsluice/blob/main/cmd/jsluice) ya ku-extract URLs, paths, secrets, na data nyingine ya kuvutia kutoka JavaScript source code.
- [**ParaForge**](https://github.com/Anof-cyber/ParaForge): ParaForge ni **Burp Suite extension** rahisi ya **ku-extract the paramters and endpoints** kutoka request ili kuunda custom wordlist kwa fuzzing na enumeration.
- [**katana**](https://github.com/projectdiscovery/katana) (go): Tool nzuri kwa hili.
- [**Crawley**](https://github.com/s0rg/crawley) (go): Chapisha kila link inayoweza kupatikana.

### Brute Force directories and files

Anza **brute-forcing** kutoka folda ya root na hakikisha una brute-force **all** the **directories found** kwa kutumia **this method** na wote directories **discovered** na **Spidering** (unaweza kufanya brute-forcing hii **recursively** na kuongeza mwanzoni mwa wordlist iliyotumika majina ya directories yaliyopatikana).\
Tools:

- **Dirb** / **Dirbuster** - Imejumuishwa katika Kali, **old** (na **slow**) lakini inafanya kazi. Inaruhusu auto-signed certificates na recursive search. Ndiyo maana ni polepole ikilinganishwa na chaguo nyingine.
- [**Dirsearch**](https://github.com/maurosoria/dirsearch) (python)**: Haikubali auto-signed certificates lakini** inaruhusu recursive search.
- [**Gobuster**](https://github.com/OJ/gobuster) (go): Inaruhusu auto-signed certificates, hauna **recursive** search.
- [**Feroxbuster**](https://github.com/epi052/feroxbuster) **- Fast, supports recursive search.**
- [**wfuzz**](https://github.com/xmendez/wfuzz) `wfuzz -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt https://domain.com/api/FUZZ`
- [**ffuf** ](https://github.com/ffuf/ffuf)- Fast: `ffuf -c -w /usr/share/wordlists/dirb/big.txt -u http://10.10.10.10/FUZZ`
- [**uro**](https://github.com/s0md3v/uro) (python): Hii si spider lakini ni tool ambayo ikipewa list ya URLs zilizopatikana itafuta na kuondoa URLs "duplicated".
- [**Scavenger**](https://github.com/0xDexter0us/Scavenger): Burp Extension ya kutengeneza orodha ya directories kutoka burp history ya kurasa mbalimbali
- [**TrashCompactor**](https://github.com/michael1026/trashcompactor): Ondoa URLs zenye functionalities zinazojirudia (kulingana na js imports)
- [**Chamaleon**](https://github.com/iustin24/chameleon): Inatumia wapalyzer kutambua teknolojia zinazotumika na kuchagua wordlists za kutumia.

Recommended dictionaries:

- [https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/bf_directories.txt](https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/bf_directories.txt)
- [**Dirsearch** included dictionary](https://github.com/maurosoria/dirsearch/blob/master/db/dicc.txt)
- [http://gist.github.com/jhaddix/b80ea67d85c13206125806f0828f4d10](http://gist.github.com/jhaddix/b80ea67d85c13206125806f0828f4d10)
- [Assetnote wordlists](https://wordlists.assetnote.io)
- [https://github.com/danielmiessler/SecLists/tree/master/Discovery/Web-Content](https://github.com/danielmiessler/SecLists/tree/master/Discovery/Web-Content)
- raft-large-directories-lowercase.txt
- directory-list-2.3-medium.txt
- RobotsDisallowed/top10000.txt
- [https://github.com/random-robbie/bruteforce-lists](https://github.com/random-robbie/bruteforce-lists)
- [https://github.com/google/fuzzing/tree/master/dictionaries](https://github.com/google/fuzzing/tree/master/dictionaries)
- [https://github.com/six2dez/OneListForAll](https://github.com/six2dez/OneListForAll)
- [https://github.com/random-robbie/bruteforce-lists](https://github.com/random-robbie/bruteforce-lists)
- [https://github.com/ayoubfathi/leaky-paths](https://github.com/ayoubfathi/leaky-paths)
- _/usr/share/wordlists/dirb/common.txt_
- _/usr/share/wordlists/dirb/big.txt_
- _/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt_

_Kumbuka kwamba kila mara folda mpya inapopatikana wakati wa brute-forcing au spidering, inapaswa kufanyiwa Brute-Force._

### What to check on each file found

- [**Broken link checker**](https://github.com/stevenvachon/broken-link-checker): Pata broken links ndani ya HTML ambazo zinaweza kuwa hatarini kwa takeover
- **File Backups**: Mara baada ya kupata files zote, angalia backups za executable files zote ("_.php_", "_.aspx_"...). Mifano ya kawaida ya majina ya backup ni: _file.ext\~, #file.ext#, \~file.ext, file.ext.bak, file.ext.tmp, file.ext.old, file.bak, file.tmp and file.old._ Unaweza pia kutumia tool [**bfac**](https://github.com/mazen160/bfac) **au** [**backup-gen**](https://github.com/Nishantbhagat57/backup-gen)**.**
- **Discover new parameters**: Unaweza kutumia zana kama [**Arjun**](https://github.com/s0md3v/Arjun)**,** [**parameth**](https://github.com/maK-/parameth)**,** [**x8**](https://github.com/sh1yo/x8) **na** [**Param Miner**](https://github.com/PortSwigger/param-miner) **kutafuta parameters zilizofichwa. Iwapo inawezekana, jaribu kutafuta** hidden parameters kwenye kila executable web file.
- _Arjun all default wordlists:_ [https://github.com/s0md3v/Arjun/tree/master/arjun/db](https://github.com/s0md3v/Arjun/tree/master/arjun/db)
- _Param-miner “params” :_ [https://github.com/PortSwigger/param-miner/blob/master/resources/params](https://github.com/PortSwigger/param-miner/blob/master/resources/params)
- _Assetnote “parameters_top_1m”:_ [https://wordlists.assetnote.io/](https://wordlists.assetnote.io)
- _nullenc0de “params.txt”:_ [https://gist.github.com/nullenc0de/9cb36260207924f8e1787279a05eb773](https://gist.github.com/nullenc0de/9cb36260207924f8e1787279a05eb773)
- **Comments:** Angalia comments za files zote, unaweza kupata **credentials** au **hidden functionality**.
- Ikiwa unacheza **CTF**, trick ya kawaida ni **kuficha** **taarifa** ndani ya comments upande wa **kulia** wa **page** (kwa kutumia **maelfu** ya **spaces** ili usione data ikiwa utafungua source code kwa browser). Jambo lingine ni kutumia **newline** nyingi na **kuficha taarifa** kwenye comment chini ya ukurasa wa wavuti.
- **API keys**: Ikiwa utapata API key yoyote kuna miongozo inayoelezea jinsi ya kutumia API keys za platform tofauti: [**keyhacks**](https://github.com/streaak/keyhacks)**,** [**zile**](https://github.com/xyele/zile.git)**,** [**truffleHog**](https://github.com/trufflesecurity/truffleHog)**,** [**SecretFinder**](https://github.com/m4ll0k/SecretFinder)**,** [**RegHex**](<https://github.com/l4yton/RegHex)/>)**,** [**DumpsterDive**](https://github.com/securing/DumpsterDiver)**,** [**EarlyBird**](https://github.com/americanexpress/earlybird)
- Google API keys: Ikiwa utapata API key inayofanana na **AIza**SyA-qLheq6xjDiEIRisP_ujUseYLQCHUjik unaweza kutumia project [**gmapapiscanner**](https://github.com/ozguralp/gmapsapiscanner) kuangalia ni APIs gani key inaweza kufikia.
- **S3 Buckets**: Wakati wa spidering angalia kama subdomain yoyote au link yoyote inahusiana na S3 bucket. Katika hali hiyo, [**check** the **permissions** of the bucket](buckets/index.html).

### Special findings

Wakati wa kufanya **spidering** na **brute-forcing** unaweza kupata vitu vinavyovutia ambavyo unapaswa kuyazingatia.

**Interesting files**

- Angalia **links** za faili nyingine ndani ya **CSS** files.
- [If you find a _**.git**_ file some information can be extracted](git.md)
- Ikiwa utapata _**.env**_ taarifa kama api keys, dbs passwords na taarifa nyingine zinaweza kupatikana.
- Ikiwa utapata **API endpoints** unapaswa [also test them](web-api-pentesting.md). Hizi si files, lakini kwa kawaida "zinaweza kuonekana" kama files.
- **JS files**: Katika sehemu ya spidering zilitajwa zana kadhaa ambazo zinaweza ku-extract path kutoka JS files. Pia, itakuwa vyema **kufuatilia kila JS file iliyopatikana**, kwani kwa baadhi ya matukio, mabadiliko yanaweza kuonyesha kuwa kwetsio mpya imeingizwa katika code. Unaweza kutumia kwa mfano [**JSMon**](https://github.com/robre/jsmon)**.**
- Pia unapaswa kuangalia JS files zilizogunduliwa na [**RetireJS**](https://github.com/retirejs/retire.js/) au [**JSHole**](https://github.com/callforpapers-source/jshole) kuona ikiwa zinazo vunikeleo.
- **Javascript Deobfuscator and Unpacker:** [https://lelinhtinh.github.io/de4js/](https://lelinhtinh.github.io/de4js/), [https://www.dcode.fr/javascript-unobfuscator](https://www.dcode.fr/javascript-unobfuscator)
- **Javascript Beautifier:** [http://jsbeautifier.org/](https://beautifier.io), [http://jsnice.org/](http://jsnice.org)
- **JsFuck deobfuscation** (javascript with chars:"\[]!+" [https://enkhee-osiris.github.io/Decoder-JSFuck/](https://enkhee-osiris.github.io/Decoder-JSFuck/))
- **TrainFuck**](https://github.com/taco-cy/trainfuck)**:** `+72.+29.+7..+3.-67.-12.+55.+24.+3.-6.-8.-67.-23.`
- Katika matukio kadhaa, utahitaji **kuelewa regular expressions** zinazotumika. Hii itakuwa ya msaada: [https://regex101.com/](https://regex101.com) au [https://pythonium.net/regex](https://pythonium.net/regex)
- Unaweza pia **kufuatilia files ambazo forms zilipatikana**, kwani mabadiliko katika parameter au kuonekana kwa form mpya inaweza kuonyesha functionality mpya inayoweza kuwa na udhaifu.

**403 Forbidden/Basic Authentication/401 Unauthorized (bypass)**


{{#ref}}
403-and-401-bypasses.md
{{#endref}}

**502 Proxy Error**

Ikiwa ukurasa wowote unajibu kwa code hiyo, kuna uwezekano kuna proxy iliyopangwa vibaya. **Ikiwa utatuma HTTP request kama: `GET https://google.com HTTP/1.1`** (kwa host header na headers nyingine za kawaida), **proxy** itajaribu kufikia _**google.com**_ na utakuwa umepata SSRF.

**NTLM Authentication - Info disclosure**

Ikiwa server inayotoa ombi la authentication ni **Windows** au ukiona login inayokuuliza **credentials** zako (na kuomba **domain** **name**), unaweza kusababisha **information disclosure**.\
**Tuma** header: `“Authorization: NTLM TlRMTVNTUAABAAAAB4IIAAAAAAAAAAAAAAAAAAAAAAA=”` na kutokana na jinsi **NTLM authentication** inavyofanya kazi, server itajibu na info za ndani (version ya IIS, version ya Windows...) ndani ya header "WWW-Authenticate".\
Unaweza **automate** hii kwa kutumia **nmap plugin** "_http-ntlm-info.nse_".

**HTTP Redirect (CTF)**

Inawezekana kuweka content ndani ya **Redirection**. Content hii **haitaonekana kwa mtumiaji** (kwani browser itatekeleza redirection) lakini kitu kinaweza **kufichwa** ndani yake.

### Web Vulnerabilities Checking

Sasa baada ya enumeration kamili ya web application, ni wakati wa kuangalia kwa zaid ya udhaifu zinazowezekana. Unaweza kupata checklist hapa:

{{#ref}}
../../pentesting-web/web-vulnerabilities-methodology.md
{{#endref}}

Pata taarifa zaidi kuhusu web vulns katika:

- [https://six2dez.gitbook.io/pentest-book/others/web-checklist](https://six2dez.gitbook.io/pentest-book/others/web-checklist)
- [https://kennel209.gitbooks.io/owasp-testing-guide-v4/content/en/web_application_security_testing/configuration_and_deployment_management_testing.html](https://kennel209.gitbooks.io/owasp-testing-guide-v4/content/en/web_application_security_testing/configuration_and_deployment_management_testing.html)
- [https://owasp-skf.gitbook.io/asvs-write-ups/kbid-111-client-side-template-injection](https://owasp-skf.gitbook.io/asvs-write-ups/kbid-111-client-side-template-injection)

### Monitor Pages for changes

Unaweza kutumia zana kama [https://github.com/dgtlmoon/changedetection.io](https://github.com/dgtlmoon/changedetection.io) kufuatilia pages kwa mabadiliko ambayo yanaweza kuingiza vulnerabilities.

### HackTricks Automatic Commands
```
Protocol_Name: Web    #Protocol Abbreviation if there is one.
Port_Number:  80,443     #Comma separated if there is more than one.
Protocol_Description: Web         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for Web
Note: |
https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-web/index.html

Entry_2:
Name: Quick Web Scan
Description: Nikto and GoBuster
Command: nikto -host {Web_Proto}://{IP}:{Web_Port} &&&& gobuster dir -w {Small_Dirlist} -u {Web_Proto}://{IP}:{Web_Port} && gobuster dir -w {Big_Dirlist} -u {Web_Proto}://{IP}:{Web_Port}

Entry_3:
Name: Nikto
Description: Basic Site Info via Nikto
Command: nikto -host {Web_Proto}://{IP}:{Web_Port}

Entry_4:
Name: WhatWeb
Description: General purpose auto scanner
Command: whatweb -a 4 {IP}

Entry_5:
Name: Directory Brute Force Non-Recursive
Description:  Non-Recursive Directory Brute Force
Command: gobuster dir -w {Big_Dirlist} -u {Web_Proto}://{IP}:{Web_Port}

Entry_6:
Name: Directory Brute Force Recursive
Description: Recursive Directory Brute Force
Command: python3 {Tool_Dir}dirsearch/dirsearch.py -w {Small_Dirlist} -e php,exe,sh,py,html,pl -f -t 20 -u {Web_Proto}://{IP}:{Web_Port} -r 10

Entry_7:
Name: Directory Brute Force CGI
Description: Common Gateway Interface Brute Force
Command: gobuster dir -u {Web_Proto}://{IP}:{Web_Port}/ -w /usr/share/seclists/Discovery/Web-Content/CGIs.txt -s 200

Entry_8:
Name: Nmap Web Vuln Scan
Description: Tailored Nmap Scan for web Vulnerabilities
Command: nmap -vv --reason -Pn -sV -p {Web_Port} --script=`banner,(http* or ssl*) and not (brute or broadcast or dos or external or http-slowloris* or fuzzer)` {IP}

Entry_9:
Name: Drupal
Description: Drupal Enumeration Notes
Note: |
git clone https://github.com/immunIT/drupwn.git for low hanging fruit and git clone https://github.com/droope/droopescan.git for deeper enumeration

Entry_10:
Name: WordPress
Description: WordPress Enumeration with WPScan
Command: |
?What is the location of the wp-login.php? Example: /Yeet/cannon/wp-login.php
wpscan --url {Web_Proto}://{IP}{1} --enumerate ap,at,cb,dbe && wpscan --url {Web_Proto}://{IP}{1} --enumerate u,tt,t,vp --passwords {Big_Passwordlist} -e

Entry_11:
Name: WordPress Hydra Brute Force
Description: Need User (admin is default)
Command: hydra -l admin -P {Big_Passwordlist} {IP} -V http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:S=Location'

Entry_12:
Name: Ffuf Vhost
Description: Simple Scan with Ffuf for discovering additional vhosts
Command: ffuf -w {Subdomain_List}:FUZZ -u {Web_Proto}://{Domain_Name} -H "Host:FUZZ.{Domain_Name}" -c -mc all {Ffuf_Filters}
```
{{#include ../../banners/hacktricks-training.md}}
