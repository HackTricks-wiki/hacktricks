# 80,443 - Pentesting Web Methodology

{{#include ../../banners/hacktricks-training.md}}

## Basic Info

Huduma ya web ni huduma ya **kawaida na pana**, na kuna aina nyingi tofauti za **vulnerabilities**.

**Bandari ya chaguo-msingi:** 80 (HTTP), 443(HTTPS)
```bash
PORT    STATE SERVICE
80/tcp  open  http
443/tcp open  ssl/https
```

```bash
nc -v domain.com 80 # GET / HTTP/1.0
openssl s_client -connect domain.com:443 # GET / HTTP/1.0
```
### Mwongozo wa Web API


{{#ref}}
web-api-pentesting.md
{{#endref}}

## Muhtasari wa metodolojia

> Katika metodolojia hii tutadhani kwamba unalenga kuattaqa domaini (au subdomain) na hiyo tu. Kwa hivyo, unatakiwa kutumia metodolojia hii kwa kila domaini, subdomain au IP iliyogunduliwa ambayo ina web server isiyojulikana ndani ya wigo.

- [ ] Anza kwa **kutambua** **technologies** zinazotumika na web server. Tafuta **tricks** za kuzipa kipaumbele wakati wa mtihani wa baadaye ikiwa utaweza kutambua tech.
- [ ] Je, kuna **known vulnerability** ya version ya technology inayotumiwa?
- [ ] Inatumia **well known tech** yoyote? Kuna **useful trick** ya kupata taarifa zaidi?
- [ ] Kuna **specialised scanner** la kuendesha (kama wpscan)?
- [ ] Endesha **general purposes scanners**. Huwezi kujua kama zitapata kitu au zitapata taarifa zinazovutia.
- [ ] Anza na **initial checks**: **robots**, **sitemap**, **404** error na **SSL/TLS scan** (ikiwa HTTPS).
- [ ] Anza **spidering** tovuti: Ni wakati wa **kutafuta** faili zote, folders na **parameters inayotumika.** Pia, angalia kwa **special findings**.
- [ ] _Kumbuka kuwa kila mara directory mpya inapogunduliwa wakati wa brute-forcing au spidering, inapaswa kuspiderea._
- [ ] **Directory Brute-Forcing**: Jaribu kuforce directories zote zilizogunduliwa ukitafuta **files** na **directories** mpya.
- [ ] _Kumbuka kuwa kila mara directory mpya inapogunduliwa wakati wa brute-forcing au spidering, inapaswa kuBrute-Forced._
- [ ] **Backups checking**: Jaribu kuona kama unaweza kupata **backups** za **discovered files** kwa kuongeza extensions za kawaida za backup.
- [ ] **Brute-Force parameters**: Jaribu **kutafuta hidden parameters**.
- [ ] Mara utaweka **kutambua** endpoints zote zinazopokea **user input**, angalia kwa aina zote za **vulnerabilities** zinazohusiana nazo.
- [ ] [Follow this checklist](../../pentesting-web/web-vulnerabilities-methodology.md)

## Server Version (Vulnerable?)

### Tambua

Angalia kama kuna **known vulnerabilities** kwa server **version** inayooendeshwa.\
**HTTP headers and cookies of the response** zinaweza kuwa muhimu sana kwa **kutambua** **technologies** na/au **version** zinazotumika. **Nmap scan** inaweza kutambua server version, lakini inaweza pia kuwa muhimu kutumia zana [**whatweb**](https://github.com/urbanadventurer/WhatWeb)**,** [**webtech** ](https://github.com/ShielderSec/webtech)or [**https://builtwith.com/**](https://builtwith.com)**:**
```bash
whatweb -a 1 <URL> #Stealthy
whatweb -a 3 <URL> #Aggresive
webtech -u <URL>
webanalyze -host https://google.com -crawl 2
```
Tafuta **kwa** [**vulnerabilities of the web application** **version**](../../generic-hacking/search-exploits.md)

### **Angalia kama kuna WAF**

- [**https://github.com/EnableSecurity/wafw00f**](https://github.com/EnableSecurity/wafw00f)
- [**https://github.com/Ekultek/WhatWaf.git**](https://github.com/Ekultek/WhatWaf.git)
- [**https://nmap.org/nsedoc/scripts/http-waf-detect.html**](https://nmap.org/nsedoc/scripts/http-waf-detect.html)

### Mbinu za teknolojia za wavuti

Hapa kuna baadhi ya **tricks** za **finding vulnerabilities** katika teknolojia mbalimbali zilizo maarufu zinazotumika:

- [**AEM - Adobe Experience Cloud**](aem-adobe-experience-cloud.md)
- [**Apache**](apache.md)
- [**Artifactory**](artifactory-hacking-guide.md)
- [**Buckets**](buckets/index.html)
- [**CGI**](cgi.md)
- [**Dotnet SOAP WSDL client exploitation**](dotnet-soap-wsdl-client-exploitation.md)
- [**Drupal**](drupal/index.html)
- [**Flask**](flask.md)
- [**Fortinet FortiWeb**](fortinet-fortiweb.md)
- [**Git**](git.md)
- [**Golang**](golang.md)
- [**GraphQL**](graphql.md)
- [**H2 - Java SQL database**](h2-java-sql-database.md)
- [**ISPConfig**](ispconfig.md)
- [**IIS tricks**](iis-internet-information-services.md)
- [**Microsoft SharePoint**](microsoft-sharepoint.md)
- [**JBOSS**](jboss.md)
- [**Jenkins**](https://github.com/HackTricks-wiki/hacktricks-cloud/tree/master/pentesting-ci-cd/jenkins-security)
- [**Jira**](jira.md)
- [**Joomla**](joomla.md)
- [**JSP**](jsp.md)
- [**Laravel**](laravel.md)
- [**Moodle**](moodle.md)
- [**Nginx**](nginx.md)
- [**PHP (php has a lot of interesting tricks that could be exploited)**](php-tricks-esp/index.html)
- [**Python**](python.md)
- [**Roundcube**](roundcube.md)
- [**Spring Actuators**](spring-actuators.md)
- [**Symphony**](symphony.md)
- [**Tomcat**](tomcat/index.html)
- [**VMWare**](vmware-esx-vcenter....md)
- [**Web API Pentesting**](web-api-pentesting.md)
- [**WebDav**](put-method-webdav.md)
- [**Werkzeug**](werkzeug.md)
- [**Wordpress**](wordpress.md)
- [**Electron Desktop (XSS to RCE)**](electron-desktop-apps/index.html)
- [**Sitecore**](sitecore/index.html)
- [**Zabbix**](zabbix.md)

_Chukua kwa kuzingatia kwamba **domaini moja** inaweza kutumia **teknolojia tofauti** katika **ports**, **folda** na **subdomains**._\
Ikiwa programu ya wavuti inatumia teknolojia/jukwaa lolote lililotajwa hapo juu au lingine lolote, usisahau **kutafuta kwenye Internet** mbinu mpya (na nijulishe!).

### Ukaguzi wa Source Code

Ikiwa **source code** ya application inapatikana kwenye **github**, mbali na kufanya kwa **wewe mwenyewe a White box test** ya application kuna **taarifa** ambazo zinaweza kuwa **za manufaa** kwa **Black-Box testing** ya sasa:

- Je, kuna **Change-log or Readme or Version** file au kitu chochote chenye **version info accessible** kupitia web?
- Je, vipi na wapi zimehifadhiwa **credentials**? Je, kuna **file** yoyote (inayopatikana?) yenye credentials (usernames au passwords)?
- Je, **passwords** ziko katika **plain text**, **encrypted** au ni algorithm gani ya **hashing algorithm** inatumiwa?
- Je, inatumia **master key** yoyote kwa ku-encrypt kitu? Ni **algorithm** gani inatumiwa?
- Je, unaweza **access any of these files** ukitumia udhaifu fulani?
- Je, kuna taarifa yoyote yenye kuvutia katika **github** (solved and not solved) **issues**? Au katika **commit history** (labda **password introduced inside an old commit**)?


{{#ref}}
code-review-tools.md
{{#endref}}

### Automatic scanners

#### General purpose automatic scanners
```bash
nikto -h <URL>
whatweb -a 4 <URL>
wapiti -u <URL>
W3af
zaproxy #You can use an API
nuclei -ut && nuclei -target <URL>

# https://github.com/ignis-sec/puff (client side vulns fuzzer)
node puff.js -w ./wordlist-examples/xss.txt -u "http://www.xssgame.com/f/m4KKGHi2rVUN/?query=FUZZ"
```
#### Skana za CMS

Iwapo CMS inatumiwa, usisahau **kuendesha scanner**, labda utapata kitu cha kuvutia:

[**Clusterd**](https://github.com/hatRiot/clusterd)**:** [**JBoss**](jboss.md)**, ColdFusion, WebLogic,** [**Tomcat**](tomcat/index.html)**, Railo, Axis2, Glassfish**\
[**CMSScan**](https://github.com/ajinabraham/CMSScan): [**WordPress**](wordpress.md), [**Drupal**](drupal/index.html), **Joomla**, **vBulletin** tovuti kwa masuala ya usalama. (GUI)\
[**VulnX**](https://github.com/anouarbensaad/vulnx)**:** [**Joomla**](joomla.md)**,** [**Wordpress**](wordpress.md)**,** [**Drupal**](drupal/index.html)**, PrestaShop, Opencart**\
**CMSMap**: [**(W)ordpress**](wordpress.md)**,** [**(J)oomla**](joomla.md)**,** [**(D)rupal**](drupal/index.html) **au** [**(M)oodle**](moodle.md)\
[**droopscan**](https://github.com/droope/droopescan)**:** [**Drupal**](drupal/index.html)**,** [**Joomla**](joomla.md)**,** [**Moodle**](moodle.md)**, Silverstripe,** [**Wordpress**](wordpress.md)
```bash
cmsmap [-f W] -F -d <URL>
wpscan --force update -e --url <URL>
joomscan --ec -u <URL>
joomlavs.rb #https://github.com/rastating/joomlavs
```
> Kwa hatua hii unapaswa tayari kuwa na baadhi ya taarifa kuhusu web server inayotumika na mteja (ikiwa data zozote zimetolewa) na baadhi ya tricks za kuzingatia wakati wa mtihani. Ikiwa uko na bahati umepata hata CMS na umeendesha scanner.

## Hatua kwa hatua: Uchunguzi wa Programu ya Wavuti

> Kuanzia hapa tutaanza kuingiliana na programu ya wavuti.

### Ukaguzi wa awali

**Kurasa za default zenye taarifa za kuvutia:**

- /robots.txt
- /sitemap.xml
- /crossdomain.xml
- /clientaccesspolicy.xml
- /.well-known/
- Kagua pia comments katika kurasa kuu na za pili.

**Kulazimisha makosa**

Web servers zinaweza **kuonyesha tabia isiyotegemewa** wakati data za ajabu zinapotumwa kwao. Hii inaweza kufungua **vulnerabilities** au kusababisha **kutolewa kwa taarifa nyeti**.

- Fikia **fake pages** kama /whatever_fake.php (.aspx,.html,.etc)
- **Ongeza "[]", "]]", na "[["** katika **cookie values** na **parameter** values ili kuunda makosa
- Sababisha kosa kwa kutoa input kama **`/~randomthing/%s`** mwishoni mwa **URL**
- Jaribu **different HTTP Verbs** kama PATCH, DEBUG au potofu kama FAKE

#### **Angalia ikiwa unaweza kupakia faili (**[**PUT verb, WebDav**](put-method-webdav.md)**)**

Ikiwa unagundua kuwa **WebDav** ni **enabled** lakini huna ruhusa za kutosha za **uploading files** kwenye root folder jaribu:

- **Brute Force** credentials
- **Upload files** via WebDav kwenye **rest** ya **found folders** ndani ya ukurasa wa wavuti. Inawezekana una ruhusa za kupakia faili kwenye folda nyingine.

### **SSL/TLS vulnerabilites**

- Ikiwa application **isn't forcing the user of HTTPS** sehemu yoyote, basi iko **vulnerable to MitM**
- Ikiwa application inatumia **sending sensitive data (passwords) using HTTP**. Hii ni high vulnerability.

Tumia [**testssl.sh**](https://github.com/drwetter/testssl.sh) kukagua **vulnerabilities** (Katika Bug Bounty programs labda aina hizi za vulnerabilities hazitakubaliwa) na tumia [**a2sv** ](https://github.com/hahwul/a2sv) kukagua vulnerabilities tena:
```bash
./testssl.sh [--htmlfile] 10.10.10.10:443
#Use the --htmlfile to save the output inside an htmlfile also

# You can also use other tools, by testssl.sh at this momment is the best one (I think)
sslscan <host:port>
sslyze --regular <ip:port>
```
Taarifa kuhusu udhaifu za SSL/TLS:

- [https://www.gracefulsecurity.com/tls-ssl-vulnerabilities/](https://www.gracefulsecurity.com/tls-ssl-vulnerabilities/)
- [https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/](https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/)

### Spidering

Anzisha aina fulani ya **spider** ndani ya tovuti. Lengo la spider ni ku**pata njia nyingi iwezekanavyo** kutoka kwa application iliyochunguzwa. Kwa hiyo, web crawling na vyanzo vya nje vinapaswa kutumika ili kupata njia sahihi nyingi kadiri iwezekanavyo.

- [**gospider**](https://github.com/jaeles-project/gospider) (go): HTML spider, LinkFinder katika JS files na vyanzo vya nje (Archive.org, CommonCrawl.org, VirusTotal.com).
- [**hakrawler**](https://github.com/hakluke/hakrawler) (go): HML spider, na LinkFider kwa JS files na Archive.org kama chanzo cha nje.
- [**dirhunt**](https://github.com/Nekmo/dirhunt) (python): HTML spider, pia inaonyesha "juicy files".
- [**evine** ](https://github.com/saeeddhqan/evine)(go): Interactive CLI HTML spider. Pia inatafuta kwenye Archive.org
- [**meg**](https://github.com/tomnomnom/meg) (go): Zana hii si spider lakini inaweza kuwa ya msaada. Unaweza kuonyesha faili yenye hosts na faili yenye paths na meg itapakia kila path kwenye kila host na kuhifadhi response.
- [**urlgrab**](https://github.com/IAmStoxe/urlgrab) (go): HTML spider yenye uwezo wa JS rendering. Hata hivyo, inaonekana haisongelei, version zilizotengenezwa tayari ni za zamani na code ya sasa haijakusanya.
- [**gau**](https://github.com/lc/gau) (go): HTML spider inayotumia providers wa nje (wayback, otx, commoncrawl)
- [**ParamSpider**](https://github.com/devanshbatham/ParamSpider): Script hii itapata URLs zilizo na parameter na itaorodhesha.
- [**galer**](https://github.com/dwisiswant0/galer) (go): HTML spider yenye uwezo wa JS rendering.
- [**LinkFinder**](https://github.com/GerbenJavado/LinkFinder) (python): HTML spider, na JS beautify capabilities inayoweza kutafuta njia mpya katika JS files. Inaweza pia kuwa muhimu kuangalia [JSScanner](https://github.com/dark-warlord14/JSScanner), ambayo ni wrapper ya LinkFinder.
- [**goLinkFinder**](https://github.com/0xsha/GoLinkFinder) (go): Ili kutoa endpoints ndani ya vyanzo vya HTML na javascript zilizojazwa. Inafaa kwa bug hunters, red teamers, infosec ninjas.
- [**JSParser**](https://github.com/nahamsec/JSParser) (python2.7): Script ya python 2.7 inayotumia Tornado na JSBeautifier kuparse URLs za relative kutoka kwa JavaScript files. Inafaa kugundua kwa urahisi AJAX requests. Inaonekana haitunzwiki.
- [**relative-url-extractor**](https://github.com/jobertabma/relative-url-extractor) (ruby): Ikipewa faili (HTML) itatoa URLs kutoka kwake kwa kutumia regex nzuri ili kupata na kutoa relative URLs kutoka kwa faili zilizopunguzwa (minify).
- [**JSFScan**](https://github.com/KathanP19/JSFScan.sh) (bash, several tools): Kusanya taarifa za kuvutia kutoka JS files kwa kutumia zana kadhaa.
- [**subjs**](https://github.com/lc/subjs) (go): Tafuta JS files.
- [**page-fetch**](https://github.com/detectify/page-fetch) (go): Pakia ukurasa katika headless browser na chapisha urls zote zilizopakiwa ili kupakia ukurasa.
- [**Feroxbuster**](https://github.com/epi052/feroxbuster) (rust): Zana ya content discovery inayochanganya chaguo kadhaa za zana zilizotajwa kabla.
- [**Javascript Parsing**](https://github.com/xnl-h4ck3r/burp-extensions): Burp extension ili kupata path na params katika JS files.
- [**Sourcemapper**](https://github.com/denandz/sourcemapper): Zana inayotolewa .js.map URL itakuletea code ya JS iliyofanyiwa beautify
- [**xnLinkFinder**](https://github.com/xnl-h4ck3r/xnLinkFinder): Zana hii hutumika kugundua endpoints kwa target fulani.
- [**waymore**](https://github.com/xnl-h4ck3r/waymore)**:** Gunda links kutoka kwa wayback machine (pia inapakua responses kwenye wayback na kutafuta links zaidi)
- [**HTTPLoot**](https://github.com/redhuntlabs/HTTPLoot) (go): Crawl (hata kwa kujaza fomu) na pia kutafuta info nyeti kwa kutumia regex maalum.
- [**SpiderSuite**](https://github.com/3nock/SpiderSuite): Spider Suite ni GUI ya juu yenye vipengele vingi kwa web security Crawler/Spider iliyoundwa kwa wataalamu wa usalama wa mtandao.
- [**jsluice**](https://github.com/BishopFox/jsluice) (go): Ni package ya Go na [command-line tool](https://github.com/BishopFox/jsluice/blob/main/cmd/jsluice) kwa kutoa URLs, paths, secrets, na data nyingine ya kuvutia kutoka kwa JavaScript source code.
- [**ParaForge**](https://github.com/Anof-cyber/ParaForge): ParaForge ni simple **Burp Suite extension** ya **kutoa paramters na endpoints** kutoka request ili kuunda custom wordlist kwa fuzzing na enumeration.
- [**katana**](https://github.com/projectdiscovery/katana) (go): Zana nzuri kwa hili.
- [**Crawley**](https://github.com/s0rg/crawley) (go): Chapisha kila link inayoweza kupata.

### Brute Force directories and files

Anza **brute-forcing** kutoka kwenye folda ya mizizi na hakikisha unafanya brute-force kwa **directories zote ulizopata** kwa kutumia **method hii** na kwa directories zote **zilizoonekana** kupitia **Spidering** (unaweza kufanya brute-forcing hii **recursively** na kuongeza mwanzoni mwa wordlist iliyotumika majina ya directories ulizopata).\
Zana:

- **Dirb** / **Dirbuster** - Imejumuishwa katika Kali, **old** (na **slow**) lakini inafanya kazi. Inaruhusu auto-signed certificates na recursive search. Polepole ikilinganishwa na chaguo nyingine.
- [**Dirsearch**](https://github.com/maurosoria/dirsearch) (python)**: Haina kuruhusu auto-signed certificates lakini** inaruhusu recursive search.
- [**Gobuster**](https://github.com/OJ/gobuster) (go): Inaruhusu auto-signed certificates, haina **recursive** search.
- [**Feroxbuster**](https://github.com/epi052/feroxbuster) **- Fast, supports recursive search.**
- [**wfuzz**](https://github.com/xmendez/wfuzz) `wfuzz -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt https://domain.com/api/FUZZ`
- [**ffuf** ](https://github.com/ffuf/ffuf)- Fast: `ffuf -c -w /usr/share/wordlists/dirb/big.txt -u http://10.10.10.10/FUZZ`
- [**uro**](https://github.com/s0md3v/uro) (python): Hii si spider lakini ni zana iliyopewa orodha ya URLs ulizopata itafuta na kuondoa URLs "zilizo duplicate".
- [**Scavenger**](https://github.com/0xDexter0us/Scavenger): Burp Extension ya kuunda orodha ya directories kutoka burp history ya kurasa tofauti
- [**TrashCompactor**](https://github.com/michael1026/trashcompactor): Ondoa URLs zenye utendaji sawa (kulingana na js imports)
- [**Chamaleon**](https://github.com/iustin24/chameleon): Inatumia wapalyzer kugundua teknolojia zinazotumika na kuchagua wordlists za kutumia.

**Recommended dictionaries:**

- [https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/bf_directories.txt](https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/bf_directories.txt)
- [**Dirsearch** included dictionary](https://github.com/maurosoria/dirsearch/blob/master/db/dicc.txt)
- [http://gist.github.com/jhaddix/b80ea67d85c13206125806f0828f4d10](http://gist.github.com/jhaddix/b80ea67d85c13206125806f0828f4d10)
- [Assetnote wordlists](https://wordlists.assetnote.io)
- [https://github.com/danielmiessler/SecLists/tree/master/Discovery/Web-Content](https://github.com/danielmiessler/SecLists/tree/master/Discovery/Web-Content)
- raft-large-directories-lowercase.txt
- directory-list-2.3-medium.txt
- RobotsDisallowed/top10000.txt
- [https://github.com/random-robbie/bruteforce-lists](https://github.com/random-robbie/bruteforce-lists)
- [https://github.com/google/fuzzing/tree/master/dictionaries](https://github.com/google/fuzzing/tree/master/dictionaries)
- [https://github.com/six2dez/OneListForAll](https://github.com/six2dez/OneListForAll)
- [https://github.com/random-robbie/bruteforce-lists](https://github.com/random-robbie/bruteforce-lists)
- [https://github.com/ayoubfathi/leaky-paths](https://github.com/ayoubfathi/leaky-paths)
- _/usr/share/wordlists/dirb/common.txt_
- _/usr/share/wordlists/dirb/big.txt_
- _/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt_

_Kumbuka kwamba kila wakati dirisha mpya inapogundulika wakati wa brute-forcing au spidering, inapaswa kufanywa Brute-Forced._

### What to check on each file found

- [**Broken link checker**](https://github.com/stevenvachon/broken-link-checker): Tafuta broken links ndani ya HTMLs ambazo zinaweza kuwa hatarini kwa takeovers
- **File Backups**: Mara tu utakapo pata faili zote, tafuta backups za faili zote za executable ("_.php_", "_.aspx_"...). Mabadiliko ya kawaida ya majina kwa backup ni: _file.ext\~, #file.ext#, \~file.ext, file.ext.bak, file.ext.tmp, file.ext.old, file.bak, file.tmp and file.old._ Pia unaweza kutumia zana [**bfac**](https://github.com/mazen160/bfac) **au** [**backup-gen**](https://github.com/Nishantbhagat57/backup-gen)**.**
- **Discover new parameters**: Unaweza kutumia zana kama [**Arjun**](https://github.com/s0md3v/Arjun)**,** [**parameth**](https://github.com/maK-/parameth)**,** [**x8**](https://github.com/sh1yo/x8) **na** [**Param Miner**](https://github.com/PortSwigger/param-miner) **kuvumbua parameters zilizofichwa. Ikiwa unaweza, jaribu kutafuta** hidden parameters kwenye kila faili za executable wa web.
- _Arjun all default wordlists:_ [https://github.com/s0md3v/Arjun/tree/master/arjun/db](https://github.com/s0md3v/Arjun/tree/master/arjun/db)
- _Param-miner “params” :_ [https://github.com/PortSwigger/param-miner/blob/master/resources/params](https://github.com/PortSwigger/param-miner/blob/master/resources/params)
- _Assetnote “parameters_top_1m”:_ [https://wordlists.assetnote.io/](https://wordlists.assetnote.io)
- _nullenc0de “params.txt”:_ [https://gist.github.com/nullenc0de/9cb36260207924f8e1787279a05eb773](https://gist.github.com/nullenc0de/9cb36260207924f8e1787279a05eb773)
- **Comments:** Kagua comments za faili zote, unaweza kupata **credentials** au **hidden functionality**.
- Ikiwa unacheza **CTF**, mbinu "ya kawaida" ni **kuficha** **taarifa** ndani ya comments upande wa **kulia** wa **ukurasa** (kwa kutumia **mia** za **spaces** ili usione data ukifungua source code katika browser). Mwingine ni kutumia **mialia mitanda** ya **new lines** na **kuficha taarifa** katika comment katikati ya mwisho wa ukurasa wa wavuti.
- **API keys**: Ikiwa utakuta API key yoyote kuna miongozo inayoonyesha jinsi ya kutumia API keys za platform tofauti: [**keyhacks**](https://github.com/streaak/keyhacks)**,** [**zile**](https://github.com/xyele/zile.git)**,** [**truffleHog**](https://github.com/trufflesecurity/truffleHog)**,** [**SecretFinder**](https://github.com/m4ll0k/SecretFinder)**,** [**RegHex**](https://github.com/l4yton/RegHex)**,** [**DumpsterDive**](https://github.com/securing/DumpsterDiver)**,** [**EarlyBird**](https://github.com/americanexpress/earlybird)
- Google API keys: Ikiwa utapata API key inayofanana na **AIza**SyA-qLheq6xjDiEIRisP_ujUseYLQCHUjik unaweza kutumia project [**gmapapiscanner**](https://github.com/ozguralp/gmapsapiscanner) kuchunguza ni API gani key inaweza kufikia.
- **S3 Buckets**: Wakati wa spidering angalia kama subdomain yoyote au link yoyote inahusiana na S3 bucket. Katika kesi hiyo, [**kagua** ruhusa za bucket](buckets/index.html).

### Special findings

Wakati unafanya **spidering** na **brute-forcing** unaweza kukutana na vitu vya kuvutia ambavyo unapaswa kukitambua.

**Interesting files**

- Tafuta **links** kwa faili nyingine ndani ya **CSS** files.
- [If you find a _**.git**_ file some information can be extracted](git.md)
- Ikiwa utapata _**.env**_ taarifa kama api keys, dbs passwords na taarifa nyingine zinaweza kupatikana.
- Ikiwa utapata **API endpoints** unapaswa pia kujaribu [kujaribu hizo](web-api-pentesting.md). Hizi si faili, lakini zinaweza "kuonekana kama" faili.
- **JS files**: Katika sehemu ya spidering zimetajwa zana kadhaa zinazoweza kutoa path kutoka kwa JS files. Pia, itakuwa muhimu **kufuatilia kila JS file uliyoipata**, kwani katika matukio fulani, mabadiliko yanaweza kuashiria kuwa udhaifu mpya umeingia kwenye code. Unaweza kutumia kwa mfano [**JSMon**](https://github.com/robre/jsmon)**.**
- Pia unapaswa kuangalia JS files zilizogunduliwa kwa [**RetireJS**](https://github.com/retirejs/retire.js/) au [**JSHole**](https://github.com/callforpapers-source/jshole) ili kubaini kama zina udhaifu.
- **Javascript Deobfuscator and Unpacker:** [https://lelinhtinh.github.io/de4js/](https://lelinhtinh.github.io/de4js/), [https://www.dcode.fr/javascript-unobfuscator](https://www.dcode.fr/javascript-unobfuscator)
- **Javascript Beautifier:** [http://jsbeautifier.org/](https://beautifier.io), [http://jsnice.org/](http://jsnice.org)
- **JsFuck deobfuscation** (javascript with chars:"\[]!+" [https://enkhee-osiris.github.io/Decoder-JSFuck/](https://enkhee-osiris.github.io/Decoder-JSFuck/))
- [**TrainFuck**](https://github.com/taco-c/trainfuck)**:** `+72.+29.+7..+3.-67.-12.+55.+24.+3.-6.-8.-67.-23.`
- Katika matukio mengi, utahitaji **kuelewa regular expressions** zinazotumika. Hii itakuwa muhimu: [https://regex101.com/](https://regex101.com) au [https://pythonium.net/regex](https://pythonium.net/regex)
- Pia unaweza **kufuatilia faili ambazo fomu zilipatikana**, kwani mabadiliko katika parameter au kuonekana kwa fomu mpya kunaweza kuashiria functionality mpya yenye uwezekano wa kuwa na udhaifu.

**403 Forbidden/Basic Authentication/401 Unauthorized (bypass)**


{{#ref}}
403-and-401-bypasses.md
{{#endref}}

**502 Proxy Error**

Ikiwa ukurasa wowote **unarejesha** na code hiyo, ni uwezekano ni **proxy iliyopangwa vibaya**. **Ikiwa utatuma HTTP request kama: `GET https://google.com HTTP/1.1`** (na host header na headers nyingine za kawaida), **proxy** itajaribu **kupata** _**google.com**_ **na utakuwa umeona** SSRF.

**NTLM Authentication - Info disclosure**

Ikiwa server inayotaka authentication ni **Windows** au ukiona login inakuomba **credentials** zako (na kuomba **domain** **name**), unaweza kusababisha **information disclosure**.\
**Tuma** header: `“Authorization: NTLM TlRMTVNTUAABAAAAB4IIAAAAAAAAAAAAAAAAAAAAAAA=”` na kutokana na jinsi **NTLM authentication** inavyofanya kazi, server itarejesha info ya ndani (version ya IIS, version ya Windows...) ndani ya header "WWW-Authenticate".\
Unaweza **kuendesha kiotomatiki** hili kwa kutumia **nmap plugin** "_http-ntlm-info.nse_".

**HTTP Redirect (CTF)**

Inawezekana **kuweka content** ndani ya **Redirection**. Content hii **haitaonyeshwa kwa mtumiaji** (kwa kuwa browser itatekeleza redirection) lakini kitu kinaweza ku**fichwa** ndani yake.

### Web Vulnerabilities Checking

Sasa kwamba enumeration ya kina ya web application imefanywa ni wakati wa kuangalia udhaifu wengi iwezekanavyo. Unaweza kupata checklist hapa:


{{#ref}}
../../pentesting-web/web-vulnerabilities-methodology.md
{{#endref}}

Pata taarifa zaidi kuhusu web vulns katika:

- [https://six2dez.gitbook.io/pentest-book/others/web-checklist](https://six2dez.gitbook.io/pentest-book/others/web-checklist)
- [https://kennel209.gitbooks.io/owasp-testing-guide-v4/content/en/web_application_security_testing/configuration_and_deployment_management_testing.html](https://kennel209.gitbooks.io/owasp-testing-guide-v4/content/en/web_application_security_testing/configuration_and_deployment_management_testing.html)
- [https://owasp-skf.gitbook.io/asvs-write-ups/kbid-111-client-side-template-injection](https://owasp-skf.gitbook.io/asvs-write-ups/kbid-111-client-side-template-injection)

### Monitor Pages for changes

Unaweza kutumia zana kama [https://github.com/dgtlmoon/changedetection.io](https://github.com/dgtlmoon/changedetection.io) kufuatilia mabadiliko kwenye kurasa ambayo yanaweza kuingiza udhaifu.

### HackTricks Automatic Commands

<details>
<summary>Amri za Kiotomatiki za HackTricks</summary>
```yaml
Protocol_Name: Web    #Protocol Abbreviation if there is one.
Port_Number:  80,443     #Comma separated if there is more than one.
Protocol_Description: Web         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for Web
Note: |
https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-web/index.html

Entry_2:
Name: Quick Web Scan
Description: Nikto and GoBuster
Command: nikto -host {Web_Proto}://{IP}:{Web_Port} &&&& gobuster dir -w {Small_Dirlist} -u {Web_Proto}://{IP}:{Web_Port} && gobuster dir -w {Big_Dirlist} -u {Web_Proto}://{IP}:{Web_Port}

Entry_3:
Name: Nikto
Description: Basic Site Info via Nikto
Command: nikto -host {Web_Proto}://{IP}:{Web_Port}

Entry_4:
Name: WhatWeb
Description: General purpose auto scanner
Command: whatweb -a 4 {IP}

Entry_5:
Name: Directory Brute Force Non-Recursive
Description:  Non-Recursive Directory Brute Force
Command: gobuster dir -w {Big_Dirlist} -u {Web_Proto}://{IP}:{Web_Port}

Entry_6:
Name: Directory Brute Force Recursive
Description: Recursive Directory Brute Force
Command: python3 {Tool_Dir}dirsearch/dirsearch.py -w {Small_Dirlist} -e php,exe,sh,py,html,pl -f -t 20 -u {Web_Proto}://{IP}:{Web_Port} -r 10

Entry_7:
Name: Directory Brute Force CGI
Description: Common Gateway Interface Brute Force
Command: gobuster dir -u {Web_Proto}://{IP}:{Web_Port}/ -w /usr/share/seclists/Discovery/Web-Content/CGIs.txt -s 200

Entry_8:
Name: Nmap Web Vuln Scan
Description: Tailored Nmap Scan for web Vulnerabilities
Command: nmap -vv --reason -Pn -sV -p {Web_Port} --script=`banner,(http* or ssl*) and not (brute or broadcast or dos or external or http-slowloris* or fuzzer)` {IP}

Entry_9:
Name: Drupal
Description: Drupal Enumeration Notes
Note: |
git clone https://github.com/immunIT/drupwn.git for low hanging fruit and git clone https://github.com/droope/droopescan.git for deeper enumeration

Entry_10:
Name: WordPress
Description: WordPress Enumeration with WPScan
Command: |
?What is the location of the wp-login.php? Example: /Yeet/cannon/wp-login.php
wpscan --url {Web_Proto}://{IP}{1} --enumerate ap,at,cb,dbe && wpscan --url {Web_Proto}://{IP}{1} --enumerate u,tt,t,vp --passwords {Big_Passwordlist} -e

Entry_11:
Name: WordPress Hydra Brute Force
Description: Need User (admin is default)
Command: hydra -l admin -P {Big_Passwordlist} {IP} -V http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:S=Location'

Entry_12:
Name: Ffuf Vhost
Description: Simple Scan with Ffuf for discovering additional vhosts
Command: ffuf -w {Subdomain_List}:FUZZ -u {Web_Proto}://{Domain_Name} -H "Host:FUZZ.{Domain_Name}" -c -mc all {Ffuf_Filters}
```
</details>

{{#include ../../banners/hacktricks-training.md}}
