{{#include ../banners/hacktricks-training.md}}

可以与 **CheckPoint** **Firewall-1** 防火墙进行交互，以发现有价值的信息，例如防火墙的名称和管理站的名称。这可以通过向端口 **264/TCP** 发送查询来完成。

### 获取防火墙和管理站名称

使用预身份验证请求，您可以执行一个针对 **CheckPoint Firewall-1** 的模块。此操作所需的命令如下所示：
```bash
use auxiliary/gather/checkpoint_hostname
set RHOST 10.10.10.10
```
在执行时，该模块尝试联系防火墙的 SecuRemote 拓扑服务。如果成功，它会确认 CheckPoint 防火墙的存在，并检索防火墙和 SmartCenter 管理主机的名称。以下是输出可能的示例：
```text
[*] Attempting to contact Checkpoint FW1 SecuRemote Topology service...
[+] Appears to be a CheckPoint Firewall...
[+] Firewall Host: FIREFIGHTER-SEC
[+] SmartCenter Host: FIREFIGHTER-MGMT.example.com
[*] Auxiliary module execution completed
```
### 主机名和 ICA 名称发现的替代方法

另一种技术涉及一个直接命令，该命令向防火墙发送特定查询并解析响应以提取防火墙的主机名和 ICA 名称。该命令及其结构如下：
```bash
printf '\x51\x00\x00\x00\x00\x00\x00\x21\x00\x00\x00\x0bsecuremote\x00' | nc -q 1 10.10.10.10 264 | grep -a CN | cut -c 2-
```
此命令的输出提供了有关防火墙证书名称（CN）和组织（O）的详细信息，如下所示：
```text
CN=Panama,O=MGMTT.srv.rxfrmi
```
## 参考文献

- [https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360](https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360)
- [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html\#check-point-firewall-1-topology-port-264](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html#check-point-firewall-1-topology-port-264)

{{#include ../banners/hacktricks-training.md}}
