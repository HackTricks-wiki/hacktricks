{{#include ../banners/hacktricks-training.md}}

Dit is moontlik om met **CheckPoint** **Firewall-1** firewalls te kommunikeer om waardevolle inligting soos die firewall se naam en die bestuursstasie se naam te ontdek. Dit kan gedoen word deur 'n navraag na die poort **264/TCP** te stuur.

### Verkryging van Firewall en Bestuursstasie Namen

Deur 'n voor-authentikasie versoek te gebruik, kan jy 'n module uitvoer wat op die **CheckPoint Firewall-1** teiken. Die nodige opdragte vir hierdie operasie is hieronder uiteengesit:
```bash
use auxiliary/gather/checkpoint_hostname
set RHOST 10.10.10.10
```
By uitvoering probeer die module om die firewall se SecuRemote Topology diens te kontak. As dit suksesvol is, bevestig dit die teenwoordigheid van 'n CheckPoint Firewall en haal die name van beide die firewall en die SmartCenter bestuurshuis op. Hier is 'n voorbeeld van hoe die uitvoer mag lyk:
```text
[*] Attempting to contact Checkpoint FW1 SecuRemote Topology service...
[+] Appears to be a CheckPoint Firewall...
[+] Firewall Host: FIREFIGHTER-SEC
[+] SmartCenter Host: FIREFIGHTER-MGMT.example.com
[*] Auxiliary module execution completed
```
### Alternatiewe Metode vir Hostnaam en ICA Naam Ontdekking

'n Ander tegniek behels 'n direkte opdrag wat 'n spesifieke navraag na die firewall stuur en die antwoord ontleed om die firewall se hostnaam en ICA naam te onttrek. Die opdrag en sy struktuur is soos volg:
```bash
printf '\x51\x00\x00\x00\x00\x00\x00\x21\x00\x00\x00\x0bsecuremote\x00' | nc -q 1 10.10.10.10 264 | grep -a CN | cut -c 2-
```
Die uitvoer van hierdie opdrag verskaf gedetailleerde inligting rakende die firewall se sertifikaatnaam (CN) en organisasie (O), soos hieronder gedemonstreer:
```text
CN=Panama,O=MGMTT.srv.rxfrmi
```
## Verwysings

- [https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360](https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360)
- [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html\#check-point-firewall-1-topology-port-264](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html#check-point-firewall-1-topology-port-264)

{{#include ../banners/hacktricks-training.md}}
