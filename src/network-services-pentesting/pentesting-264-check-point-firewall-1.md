{{#include ../banners/hacktricks-training.md}}

**CheckPoint** **Firewall-1** ファイアウォールと対話して、ファイアウォールの名前や管理ステーションの名前などの貴重な情報を発見することが可能です。これはポート **264/TCP** にクエリを送信することで行えます。

### ファイアウォールと管理ステーションの名前の取得

事前認証リクエストを使用して、**CheckPoint Firewall-1** をターゲットとするモジュールを実行できます。この操作に必要なコマンドは以下に示されています:
```bash
use auxiliary/gather/checkpoint_hostname
set RHOST 10.10.10.10
```
モジュールが実行されると、ファイアウォールのSecuRemoteトポロジーサービスに接続しようとします。成功すると、CheckPointファイアウォールの存在が確認され、ファイアウォールとSmartCenter管理ホストの名前が取得されます。出力の例は次のようになります:
```text
[*] Attempting to contact Checkpoint FW1 SecuRemote Topology service...
[+] Appears to be a CheckPoint Firewall...
[+] Firewall Host: FIREFIGHTER-SEC
[+] SmartCenter Host: FIREFIGHTER-MGMT.example.com
[*] Auxiliary module execution completed
```
### ホスト名とICA名の発見のための代替手法

別の手法は、ファイアウォールに特定のクエリを送信し、応答を解析してファイアウォールのホスト名とICA名を抽出する直接的なコマンドを含みます。コマンドとその構造は次のとおりです：
```bash
printf '\x51\x00\x00\x00\x00\x00\x00\x21\x00\x00\x00\x0bsecuremote\x00' | nc -q 1 10.10.10.10 264 | grep -a CN | cut -c 2-
```
このコマンドの出力は、ファイアウォールの証明書名 (CN) と組織 (O) に関する詳細情報を提供します。以下に示します:
```text
CN=Panama,O=MGMTT.srv.rxfrmi
```
## 参考文献

- [https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360](https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360)
- [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html\#check-point-firewall-1-topology-port-264](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html#check-point-firewall-1-topology-port-264)

{{#include ../banners/hacktricks-training.md}}
