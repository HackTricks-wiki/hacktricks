{{#include ../banners/hacktricks-training.md}}

**CheckPoint** **Firewall-1** 방화벽과 상호작용하여 방화벽의 이름과 관리 스테이션의 이름과 같은 귀중한 정보를 발견할 수 있습니다. 이는 포트 **264/TCP**에 쿼리를 전송하여 수행할 수 있습니다.

### 방화벽 및 관리 스테이션 이름 얻기

사전 인증 요청을 사용하여 **CheckPoint Firewall-1**을 대상으로 하는 모듈을 실행할 수 있습니다. 이 작업에 필요한 명령은 아래에 설명되어 있습니다:
```bash
use auxiliary/gather/checkpoint_hostname
set RHOST 10.10.10.10
```
모듈이 실행되면 방화벽의 SecuRemote Topology 서비스에 연락을 시도합니다. 성공하면 CheckPoint Firewall의 존재를 확인하고 방화벽과 SmartCenter 관리 호스트의 이름을 가져옵니다. 출력이 어떻게 보일 수 있는지에 대한 예는 다음과 같습니다:
```text
[*] Attempting to contact Checkpoint FW1 SecuRemote Topology service...
[+] Appears to be a CheckPoint Firewall...
[+] Firewall Host: FIREFIGHTER-SEC
[+] SmartCenter Host: FIREFIGHTER-MGMT.example.com
[*] Auxiliary module execution completed
```
### 호스트 이름 및 ICA 이름 검색을 위한 대체 방법

또 다른 기술은 방화벽에 특정 쿼리를 전송하고 응답을 구문 분석하여 방화벽의 호스트 이름과 ICA 이름을 추출하는 직접 명령을 포함합니다. 명령과 그 구조는 다음과 같습니다:
```bash
printf '\x51\x00\x00\x00\x00\x00\x00\x21\x00\x00\x00\x0bsecuremote\x00' | nc -q 1 10.10.10.10 264 | grep -a CN | cut -c 2-
```
이 명령의 출력은 방화벽의 인증서 이름(CN)과 조직(O)에 대한 자세한 정보를 제공합니다. 아래와 같이 보여집니다:
```text
CN=Panama,O=MGMTT.srv.rxfrmi
```
## 참고 문헌

- [https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360](https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360)
- [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html\#check-point-firewall-1-topology-port-264](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html#check-point-firewall-1-topology-port-264)

{{#include ../banners/hacktricks-training.md}}
