{{#include ../banners/hacktricks-training.md}}

**CheckPoint** **Firewall-1** güvenlik duvarlarıyla etkileşimde bulunarak güvenlik duvarının adı ve yönetim istasyonunun adı gibi değerli bilgilere ulaşmak mümkündür. Bu, **264/TCP** portuna bir sorgu göndererek yapılabilir.

### Güvenlik Duvarı ve Yönetim İstasyonu İsimlerini Elde Etme

Ön kimlik doğrulama isteği kullanarak, **CheckPoint Firewall-1**'i hedefleyen bir modül çalıştırabilirsiniz. Bu işlem için gerekli komutlar aşağıda belirtilmiştir:
```bash
use auxiliary/gather/checkpoint_hostname
set RHOST 10.10.10.10
```
Modül çalıştırıldığında, güvenlik duvarının SecuRemote Topology hizmetiyle iletişim kurmaya çalışır. Başarılı olursa, bir CheckPoint Firewall'ın varlığını doğrular ve hem güvenlik duvarının hem de SmartCenter yönetim ana bilgisayarının adlarını alır. Çıktının nasıl görünebileceğine dair bir örnek:
```text
[*] Attempting to contact Checkpoint FW1 SecuRemote Topology service...
[+] Appears to be a CheckPoint Firewall...
[+] Firewall Host: FIREFIGHTER-SEC
[+] SmartCenter Host: FIREFIGHTER-MGMT.example.com
[*] Auxiliary module execution completed
```
### Alternatif Yöntem için Host Adı ve ICA Adı Keşfi

Başka bir teknik, güvenlik duvarına belirli bir sorgu gönderen ve yanıtı ayrıştırarak güvenlik duvarının host adını ve ICA adını çıkaran doğrudan bir komutu içerir. Komut ve yapısı şu şekildedir:
```bash
printf '\x51\x00\x00\x00\x00\x00\x00\x21\x00\x00\x00\x0bsecuremote\x00' | nc -q 1 10.10.10.10 264 | grep -a CN | cut -c 2-
```
Bu komutun çıktısı, aşağıda gösterildiği gibi, güvenlik duvarının sertifika adı (CN) ve organizasyonu (O) hakkında ayrıntılı bilgi sağlar:
```text
CN=Panama,O=MGMTT.srv.rxfrmi
```
## Referanslar

- [https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360](https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360)
- [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html\#check-point-firewall-1-topology-port-264](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html#check-point-firewall-1-topology-port-264)

{{#include ../banners/hacktricks-training.md}}
