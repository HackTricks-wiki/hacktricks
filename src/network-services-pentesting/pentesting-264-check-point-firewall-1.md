{{#include ../banners/hacktricks-training.md}}

Il est possible d'interagir avec les pare-feu **CheckPoint** **Firewall-1** pour découvrir des informations précieuses telles que le nom du pare-feu et le nom de la station de gestion. Cela peut être fait en envoyant une requête au port **264/TCP**.

### Obtention des noms de pare-feu et de station de gestion

En utilisant une requête de pré-authentification, vous pouvez exécuter un module qui cible le **CheckPoint Firewall-1**. Les commandes nécessaires pour cette opération sont décrites ci-dessous :
```bash
use auxiliary/gather/checkpoint_hostname
set RHOST 10.10.10.10
```
Lors de l'exécution, le module tente de contacter le service Topologie SecuRemote du pare-feu. Si cela réussit, il confirme la présence d'un pare-feu CheckPoint et récupère les noms du pare-feu et de l'hôte de gestion SmartCenter. Voici un exemple de ce à quoi la sortie pourrait ressembler :
```text
[*] Attempting to contact Checkpoint FW1 SecuRemote Topology service...
[+] Appears to be a CheckPoint Firewall...
[+] Firewall Host: FIREFIGHTER-SEC
[+] SmartCenter Host: FIREFIGHTER-MGMT.example.com
[*] Auxiliary module execution completed
```
### Méthode alternative pour la découverte du nom d'hôte et du nom ICA

Une autre technique implique une commande directe qui envoie une requête spécifique au pare-feu et analyse la réponse pour extraire le nom d'hôte et le nom ICA du pare-feu. La commande et sa structure sont les suivantes :
```bash
printf '\x51\x00\x00\x00\x00\x00\x00\x21\x00\x00\x00\x0bsecuremote\x00' | nc -q 1 10.10.10.10 264 | grep -a CN | cut -c 2-
```
La sortie de cette commande fournit des informations détaillées concernant le nom du certificat du pare-feu (CN) et l'organisation (O), comme démontré ci-dessous :
```text
CN=Panama,O=MGMTT.srv.rxfrmi
```
## Références

- [https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360](https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360)
- [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html\#check-point-firewall-1-topology-port-264](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html#check-point-firewall-1-topology-port-264)

{{#include ../banners/hacktricks-training.md}}
