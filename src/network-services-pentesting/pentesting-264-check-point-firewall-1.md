{{#include ../banners/hacktricks-training.md}}

Możliwe jest interakcja z zaporami **CheckPoint** **Firewall-1**, aby odkryć cenne informacje, takie jak nazwa zapory i nazwa stacji zarządzającej. Można to zrobić, wysyłając zapytanie do portu **264/TCP**.

### Uzyskiwanie nazw zapory i stacji zarządzającej

Używając żądania przed uwierzytelnieniem, możesz wykonać moduł, który celuje w **CheckPoint Firewall-1**. Niezbędne polecenia do tej operacji są opisane poniżej:
```bash
use auxiliary/gather/checkpoint_hostname
set RHOST 10.10.10.10
```
Po uruchomieniu moduł próbuje skontaktować się z usługą SecuRemote Topology zapory. Jeśli się powiedzie, potwierdza obecność zapory CheckPoint i pobiera nazwy zarówno zapory, jak i hosta zarządzającego SmartCenter. Oto przykład, jak może wyglądać wynik:
```text
[*] Attempting to contact Checkpoint FW1 SecuRemote Topology service...
[+] Appears to be a CheckPoint Firewall...
[+] Firewall Host: FIREFIGHTER-SEC
[+] SmartCenter Host: FIREFIGHTER-MGMT.example.com
[*] Auxiliary module execution completed
```
### Alternatywna metoda odkrywania nazwy hosta i nazwy ICA

Inna technika polega na bezpośrednim poleceniu, które wysyła określone zapytanie do zapory i analizuje odpowiedź, aby wyodrębnić nazwę hosta zapory i nazwę ICA. Polecenie i jego struktura są następujące:
```bash
printf '\x51\x00\x00\x00\x00\x00\x00\x21\x00\x00\x00\x0bsecuremote\x00' | nc -q 1 10.10.10.10 264 | grep -a CN | cut -c 2-
```
Wynik tego polecenia dostarcza szczegółowych informacji dotyczących nazwy certyfikatu zapory (CN) oraz organizacji (O), jak pokazano poniżej:
```text
CN=Panama,O=MGMTT.srv.rxfrmi
```
## Odniesienia

- [https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360](https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360)
- [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html\#check-point-firewall-1-topology-port-264](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html#check-point-firewall-1-topology-port-264)

{{#include ../banners/hacktricks-training.md}}
