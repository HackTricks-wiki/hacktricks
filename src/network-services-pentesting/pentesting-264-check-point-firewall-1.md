{{#include ../banners/hacktricks-training.md}}

Είναι δυνατόν να αλληλεπιδράσετε με τα **CheckPoint** **Firewall-1** τείχη προστασίας για να ανακαλύψετε πολύτιμες πληροφορίες όπως το όνομα του τείχους προστασίας και το όνομα του σταθμού διαχείρισης. Αυτό μπορεί να γίνει στέλνοντας ένα ερώτημα στην θύρα **264/TCP**.

### Απόκτηση Ονομάτων Τείχους Προστασίας και Σταθμού Διαχείρισης

Χρησιμοποιώντας ένα αίτημα προ-authentication, μπορείτε να εκτελέσετε ένα module που στοχεύει το **CheckPoint Firewall-1**. Οι απαραίτητες εντολές για αυτή τη λειτουργία παρατίθενται παρακάτω:
```bash
use auxiliary/gather/checkpoint_hostname
set RHOST 10.10.10.10
```
Κατά την εκτέλεση, το module προσπαθεί να επικοινωνήσει με την υπηρεσία SecuRemote Topology του firewall. Εάν είναι επιτυχές, επιβεβαιώνει την παρουσία ενός CheckPoint Firewall και ανακτά τα ονόματα τόσο του firewall όσο και του SmartCenter management host. Ακολουθεί ένα παράδειγμα του πώς μπορεί να φαίνεται η έξοδος:
```text
[*] Attempting to contact Checkpoint FW1 SecuRemote Topology service...
[+] Appears to be a CheckPoint Firewall...
[+] Firewall Host: FIREFIGHTER-SEC
[+] SmartCenter Host: FIREFIGHTER-MGMT.example.com
[*] Auxiliary module execution completed
```
### Εναλλακτική Μέθοδος για την Ανακάλυψη Ονόματος Υπολογιστή και ICA Name

Μια άλλη τεχνική περιλαμβάνει μια άμεση εντολή που στέλνει ένα συγκεκριμένο ερώτημα στο firewall και αναλύει την απάντηση για να εξαγάγει το όνομα υπολογιστή του firewall και το ICA name. Η εντολή και η δομή της είναι οι εξής:
```bash
printf '\x51\x00\x00\x00\x00\x00\x00\x21\x00\x00\x00\x0bsecuremote\x00' | nc -q 1 10.10.10.10 264 | grep -a CN | cut -c 2-
```
Η έξοδος από αυτή την εντολή παρέχει λεπτομερείς πληροφορίες σχετικά με το όνομα του πιστοποιητικού του firewall (CN) και την οργάνωση (O), όπως φαίνεται παρακάτω:
```text
CN=Panama,O=MGMTT.srv.rxfrmi
```
## Αναφορές

- [https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360](https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360)
- [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html\#check-point-firewall-1-topology-port-264](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html#check-point-firewall-1-topology-port-264)

{{#include ../banners/hacktricks-training.md}}
