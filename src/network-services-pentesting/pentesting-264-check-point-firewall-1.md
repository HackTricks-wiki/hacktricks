{{#include ../banners/hacktricks-training.md}}

È possibile interagire con i firewall **CheckPoint** **Firewall-1** per scoprire informazioni preziose come il nome del firewall e il nome della stazione di gestione. Questo può essere fatto inviando una query alla porta **264/TCP**.

### Ottenere i nomi del firewall e della stazione di gestione

Utilizzando una richiesta di pre-autenticazione, è possibile eseguire un modulo che mira al **CheckPoint Firewall-1**. I comandi necessari per questa operazione sono delineati di seguito:
```bash
use auxiliary/gather/checkpoint_hostname
set RHOST 10.10.10.10
```
Al momento dell'esecuzione, il modulo tenta di contattare il servizio SecuRemote Topology del firewall. Se ha successo, conferma la presenza di un CheckPoint Firewall e recupera i nomi sia del firewall che dell'host di gestione SmartCenter. Ecco un esempio di come potrebbe apparire l'output:
```text
[*] Attempting to contact Checkpoint FW1 SecuRemote Topology service...
[+] Appears to be a CheckPoint Firewall...
[+] Firewall Host: FIREFIGHTER-SEC
[+] SmartCenter Host: FIREFIGHTER-MGMT.example.com
[*] Auxiliary module execution completed
```
### Metodo Alternativo per la Scoperta del Nome Host e del Nome ICA

Un'altra tecnica prevede un comando diretto che invia una query specifica al firewall e analizza la risposta per estrarre il nome host del firewall e il nome ICA. Il comando e la sua struttura sono i seguenti:
```bash
printf '\x51\x00\x00\x00\x00\x00\x00\x21\x00\x00\x00\x0bsecuremote\x00' | nc -q 1 10.10.10.10 264 | grep -a CN | cut -c 2-
```
L'output di questo comando fornisce informazioni dettagliate riguardo al nome del certificato del firewall (CN) e all'organizzazione (O), come dimostrato di seguito:
```text
CN=Panama,O=MGMTT.srv.rxfrmi
```
## Riferimenti

- [https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360](https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360)
- [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html\#check-point-firewall-1-topology-port-264](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html#check-point-firewall-1-topology-port-264)

{{#include ../banners/hacktricks-training.md}}
