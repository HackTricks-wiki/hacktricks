{{#include ../banners/hacktricks-training.md}}

Es ist möglich, mit **CheckPoint** **Firewall-1** Firewalls zu interagieren, um wertvolle Informationen wie den Namen der Firewall und den Namen der Managementstation zu entdecken. Dies kann durch das Senden einer Anfrage an den Port **264/TCP** erfolgen.

### Abrufen von Firewall- und Managementstation-Namen

Mit einer Vor-Authentifizierungsanfrage können Sie ein Modul ausführen, das auf die **CheckPoint Firewall-1** abzielt. Die notwendigen Befehle für diesen Vorgang sind unten aufgeführt:
```bash
use auxiliary/gather/checkpoint_hostname
set RHOST 10.10.10.10
```
Bei der Ausführung versucht das Modul, den SecuRemote Topologiedienst der Firewall zu kontaktieren. Bei Erfolg bestätigt es die Anwesenheit einer CheckPoint Firewall und ruft die Namen sowohl der Firewall als auch des SmartCenter-Managementhosts ab. Hier ist ein Beispiel, wie die Ausgabe aussehen könnte:
```text
[*] Attempting to contact Checkpoint FW1 SecuRemote Topology service...
[+] Appears to be a CheckPoint Firewall...
[+] Firewall Host: FIREFIGHTER-SEC
[+] SmartCenter Host: FIREFIGHTER-MGMT.example.com
[*] Auxiliary module execution completed
```
### Alternative Methode zur Entdeckung von Hostnamen und ICA-Namen

Eine weitere Technik besteht darin, einen direkten Befehl zu verwenden, der eine spezifische Abfrage an die Firewall sendet und die Antwort analysiert, um den Hostnamen und den ICA-Namen der Firewall zu extrahieren. Der Befehl und seine Struktur sind wie folgt:
```bash
printf '\x51\x00\x00\x00\x00\x00\x00\x21\x00\x00\x00\x0bsecuremote\x00' | nc -q 1 10.10.10.10 264 | grep -a CN | cut -c 2-
```
Die Ausgabe dieses Befehls liefert detaillierte Informationen über den Zertifikatsnamen (CN) und die Organisation (O) der Firewall, wie unten gezeigt:
```text
CN=Panama,O=MGMTT.srv.rxfrmi
```
## Referenzen

- [https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360](https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk69360)
- [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html\#check-point-firewall-1-topology-port-264](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html#check-point-firewall-1-topology-port-264)

{{#include ../banners/hacktricks-training.md}}
