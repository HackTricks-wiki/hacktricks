# 4786 - Cisco Smart Install

{{#include ../banners/hacktricks-training.md}}


## Основна інформація

**Cisco Smart Install** - це рішення Cisco, призначене для автоматизації початкової конфігурації та завантаження образу операційної системи для нового обладнання Cisco. **За замовчуванням Cisco Smart Install активний на обладнанні Cisco і використовує протокол транспортного рівня TCP з номером порту 4786.**

**Порт за замовчуванням:** 4786
```
PORT      STATE  SERVICE
4786/tcp  open   smart-install
```
## **Інструмент експлуатації Smart Install**

**У 2018 році в цьому протоколі була виявлена критична вразливість, CVE-2018–0171. Рівень загрози становить 9.8 за шкалою CVSS.**

**Спеціально сформований пакет, надісланий на TCP/4786 порт, де активний Cisco Smart Install, викликає переповнення буфера, що дозволяє зловмиснику:**

- примусово перезавантажити пристрій
- викликати RCE
- вкрасти конфігурації мережевого обладнання.

**Інструмент** [**SIET**](https://github.com/frostbits-security/SIET) **(Інструмент експлуатації Smart Install)** був розроблений для експлуатації цієї вразливості, він дозволяє зловживати Cisco Smart Install. У цій статті я покажу вам, як ви можете прочитати легітимний файл конфігурації мережевого обладнання. Конфігурація ексфільтрації може бути цінною для пентестера, оскільки вона дозволить дізнатися про унікальні особливості мережі. І це полегшить життя та дозволить знайти нові вектори для атаки.

**Цільовим пристроєм буде "живий" комутатор Cisco Catalyst 2960. Віртуальні образи не мають Cisco Smart Install, тому ви можете практикуватися лише на реальному обладнанні.**

Адреса цільового комутатора **10.10.100.10 і CSI активний.** Завантажте SIET і почніть атаку. **Аргумент -g** означає ексфільтрацію конфігурації з пристрою, **аргумент -i** дозволяє вам встановити IP-адресу вразливого цільового пристрою.
```
~/opt/tools/SIET$ sudo python2 siet.py -g -i 10.10.100.10
```
<figure><img src="../images/image (773).png" alt=""><figcaption></figcaption></figure>

Конфігурація комутатора **10.10.100.10** буде в папці **tftp/**

<figure><img src="../images/image (1116).png" alt=""><figcaption></figcaption></figure>


{{#include ../banners/hacktricks-training.md}}
