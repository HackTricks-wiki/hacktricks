# 4786 - Cisco Smart Install

{{#include ../banners/hacktricks-training.md}}


## Informations de base

**Cisco Smart Install** est un outil conçu par Cisco pour automatiser la configuration initiale et le chargement d'une image du système d'exploitation pour le nouveau matériel Cisco. **Par défaut, Cisco Smart Install est actif sur le matériel Cisco et utilise le protocole de couche de transport, TCP, avec le numéro de port 4786.**

**Port par défaut :** 4786
```
PORT      STATE  SERVICE
4786/tcp  open   smart-install
```
## **Outil d'Exploitation Smart Install**

**En 2018, une vulnérabilité critique, CVE-2018–0171, a été trouvée dans ce protocole. Le niveau de menace est de 9.8 sur l'échelle CVSS.**

**Un paquet spécialement conçu envoyé au port TCP/4786, où Cisco Smart Install est actif, déclenche un débordement de tampon, permettant à un attaquant de :**

- redémarrer de force l'appareil
- appeler RCE
- voler les configurations de l'équipement réseau.

**Le** [**SIET**](https://github.com/frostbits-security/SIET) **(Outil d'Exploitation Smart Install)** a été développé pour exploiter cette vulnérabilité, il vous permet d'abuser de Cisco Smart Install. Dans cet article, je vais vous montrer comment vous pouvez lire un fichier de configuration matériel réseau légitime. La configuration de l'exfiltration peut être précieuse pour un pentester car elle permettra d'apprendre les caractéristiques uniques du réseau. Et cela facilitera la vie et permettra de trouver de nouveaux vecteurs pour une attaque.

**L'appareil cible sera un commutateur Cisco Catalyst 2960 "en direct". Les images virtuelles n'ont pas Cisco Smart Install, donc vous ne pouvez pratiquer que sur le matériel réel.**

L'adresse du commutateur cible est **10.10.100.10 et CSI est actif.** Chargez SIET et commencez l'attaque. **L'argument -g** signifie exfiltration de la configuration de l'appareil, **l'argument -i** vous permet de définir l'adresse IP de la cible vulnérable.
```
~/opt/tools/SIET$ sudo python2 siet.py -g -i 10.10.100.10
```
<figure><img src="../images/image (773).png" alt=""><figcaption></figcaption></figure>

La configuration du switch **10.10.100.10** sera dans le dossier **tftp/**

<figure><img src="../images/image (1116).png" alt=""><figcaption></figcaption></figure>


{{#include ../banners/hacktricks-training.md}}
