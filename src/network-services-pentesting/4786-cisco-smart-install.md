# 4786 - Cisco Smart Install

{{#include ../banners/hacktricks-training.md}}

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## Βασικές Πληροφορίες

**Cisco Smart Install** είναι ένα εργαλείο της Cisco που έχει σχεδιαστεί για να αυτοματοποιεί την αρχική διαμόρφωση και τη φόρτωση μιας εικόνας λειτουργικού συστήματος για νέο υλικό Cisco. **Από προεπιλογή, το Cisco Smart Install είναι ενεργό σε υλικό Cisco και χρησιμοποιεί το πρωτόκολλο μεταφοράς, TCP, με αριθμό θύρας 4786.**

**Προεπιλεγμένη θύρα:** 4786
```
PORT      STATE  SERVICE
4786/tcp  open   smart-install
```
## **Εργαλείο Εκμετάλλευσης Smart Install**

**Το 2018, βρέθηκε μια κρίσιμη ευπάθεια, CVE-2018–0171, σε αυτό το πρωτόκολλο. Το επίπεδο απειλής είναι 9.8 στην κλίμακα CVSS.**

**Ένα ειδικά κατασκευασμένο πακέτο που αποστέλλεται στην πόρτα TCP/4786, όπου είναι ενεργό το Cisco Smart Install, προκαλεί υπερχείλιση μνήμης, επιτρέποντας σε έναν επιτιθέμενο να:**

- επανεκκινήσει βίαια τη συσκευή
- καλέσει RCE
- κλέψει τις ρυθμίσεις του δικτυακού εξοπλισμού.

**Το** [**SIET**](https://github.com/frostbits-security/SIET) **(Εργαλείο Εκμετάλλευσης Smart Install)** αναπτύχθηκε για να εκμεταλλευτεί αυτή την ευπάθεια, επιτρέποντάς σας να καταχραστείτε το Cisco Smart Install. Σε αυτό το άρθρο θα σας δείξω πώς μπορείτε να διαβάσετε ένα νόμιμο αρχείο ρυθμίσεων δικτυακού εξοπλισμού. Η ρύθμιση εξαγωγής μπορεί να είναι πολύτιμη για έναν pentester γιατί θα μάθει για τα μοναδικά χαρακτηριστικά του δικτύου. Και αυτό θα διευκολύνει τη ζωή και θα επιτρέψει την εύρεση νέων διανυσμάτων για μια επίθεση.

**Η στοχευμένη συσκευή θα είναι ένας “ζωντανός” διακόπτης Cisco Catalyst 2960. Οι εικονικές εικόνες δεν έχουν Cisco Smart Install, οπότε μπορείτε να εξασκηθείτε μόνο σε πραγματικό υλικό.**

Η διεύθυνση του στοχευμένου διακόπτη είναι **10.10.100.10 και το CSI είναι ενεργό.** Φορτώστε το SIET και ξεκινήστε την επίθεση. **Η παράμετρος -g** σημαίνει εξαγωγή της ρύθμισης από τη συσκευή, **η παράμετρος -i** σας επιτρέπει να ορίσετε τη διεύθυνση IP του ευάλωτου στόχου.
```
~/opt/tools/SIET$ sudo python2 siet.py -g -i 10.10.100.10
```
<figure><img src="../images/image (773).png" alt=""><figcaption></figcaption></figure>

Η διαμόρφωση του switch **10.10.100.10** θα βρίσκεται στον φάκελο **tftp/**

<figure><img src="../images/image (1116).png" alt=""><figcaption></figcaption></figure>

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

{{#include ../banners/hacktricks-training.md}}
