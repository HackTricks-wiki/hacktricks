# 5671,5672 - Pentesting AMQP

{{#include ../banners/hacktricks-training.md}}

## बुनियादी जानकारी

स्रोत [cloudamqp](https://www.cloudamqp.com/blog/2015-05-18-part1-rabbitmq-for-beginners-what-is-rabbitmq.html):

> **RabbitMQ** एक **मैसेज-क्यूइंग सॉफ़्टवेयर** है जिसे _message broker_ या _queue manager_ के रूप में भी जाना जाता है। सरल शब्दों में; यह वह सॉफ़्टवेयर है जहाँ queues परिभाषित की जाती हैं, जिनसे applications कनेक्ट होती हैं ताकि एक या अधिक संदेश स्थानांतरित किए जा सकें।\
> **एक संदेश किसी भी प्रकार की जानकारी शामिल कर सकता है**। उदाहरण के लिए इसमें किसी प्रक्रिया या कार्य के बारे में जानकारी हो सकती है जिसे किसी अन्य एप्लिकेशन पर शुरू किया जाना चाहिए (जो किसी अन्य सर्वर पर भी हो सकता है), या यह सिर्फ एक सरल टेक्स्ट संदेश भी हो सकता है। क्यू-मैनेजर सॉफ़्टवेयर संदेशों को तब तक संग्रहित करता है जब तक कोई प्राप्त करने वाला एप्लिकेशन कनेक्ट न हो कर क्यू से संदेश न ले ले। प्राप्त करने वाला एप्लिकेशन फिर संदेश को प्रोसेस करता है।\
> Definition from .

**डिफ़ॉल्ट पोर्ट**: 5672,5671
```
PORT     STATE SERVICE VERSION
5672/tcp open  amqp    RabbitMQ 3.1.5 (0-9)
```
## Enumeration

### मैन्युअल
```python
import amqp
#By default it uses default credentials "guest":"guest"
conn = amqp.connection.Connection(host="IP", port=5672, virtual_host="/")
conn.connect()
for k, v in conn.server_properties.items():
print(k, v)
```
### स्वचालित
```bash
nmap -sV -Pn -n -T4 -p 5672 --script amqp-info IP

PORT     STATE SERVICE VERSION
5672/tcp open  amqp    RabbitMQ 3.1.5 (0-9)
| amqp-info:
|   capabilities:
|     publisher_confirms: YES
|     exchange_exchange_bindings: YES
|     basic.nack: YES
|     consumer_cancel_notify: YES
|   copyright: Copyright (C) 2007-2013 GoPivotal, Inc.
|   information: Licensed under the MPL.  See http://www.rabbitmq.com/
|   platform: Erlang/OTP
|   product: RabbitMQ
|   version: 3.1.5
|   mechanisms: PLAIN AMQPLAIN
|_  locales: en_US
```
### Brute Force

- [**AMQP Protocol Brute-Force**](../generic-hacking/brute-force.md#amqp-activemq-rabbitmq-qpid-joram-and-solace)
- [**STOMP Protocol Brute-Force**](../generic-hacking/brute-force.md#stomp-activemq-rabbitmq-hornetq-and-openmq)

## अन्य RabbitMQ पोर्ट

In [https://www.rabbitmq.com/networking.html](https://www.rabbitmq.com/networking.html) आप देख सकते हैं कि **rabbitmq कई पोर्ट्स उपयोग करता है**:

- **1883, 8883**: ([MQTT clients](http://mqtt.org) TLS के बिना और TLS के साथ, यदि [MQTT plugin](https://www.rabbitmq.com/mqtt.html) सक्षम है। [**Learn more about how to pentest MQTT here**](1883-pentesting-mqtt-mosquitto.md).
- **4369: epmd**, एक peer discovery सेवा है जो RabbitMQ नोड्स और CLI टूल्स द्वारा उपयोग की जाती है। [**Learn more about how to pentest this service here**](4369-pentesting-erlang-port-mapper-daemon-epmd.md).
- **5672, 5671**: AMQP 0-9-1 और 1.0 क्लाइंट्स द्वारा TLS के बिना और TLS के साथ उपयोग किए जाते हैं
- **15672**: [HTTP API](https://www.rabbitmq.com/management.html) क्लाइंट्स, [management UI](https://www.rabbitmq.com/management.html) और [rabbitmqadmin](https://www.rabbitmq.com/management-cli.html) (केवल यदि [management plugin](https://www.rabbitmq.com/management.html) सक्षम है)। [**Learn more about how to pentest this service here**](15672-pentesting-rabbitmq-management.md).
- 15674: STOMP-over-WebSockets क्लाइंट्स (केवल यदि [Web STOMP plugin](https://www.rabbitmq.com/web-stomp.html) सक्षम है)
- 15675: MQTT-over-WebSockets क्लाइंट्स (केवल यदि [Web MQTT plugin](https://www.rabbitmq.com/web-mqtt.html) सक्षम है)
- 15692: Prometheus metrics (केवल यदि [Prometheus plugin](https://www.rabbitmq.com/prometheus.html) सक्षम है)
- 25672: inter-node और CLI टूल्स संचार के लिए उपयोग किया जाता है (Erlang distribution server port) और यह एक dynamic range से allocate होता है (डिफ़ॉल्ट रूप से एक single पोर्ट तक सीमित, गणना AMQP पोर्ट + 20000 के रूप में की जाती है)। जब तक इन पोर्ट्स पर बाहरी कनेक्शन वास्तव में आवश्यक न हों (उदा. क्लस्टर [federation](https://www.rabbitmq.com/federation.html) का उपयोग करता है या CLI टूल्स सबनेट के बाहर मशीनों पर उपयोग किए जाते हैं), इन पोर्ट्स को सार्वजनिक रूप से एक्सपोज़ नहीं किया जाना चाहिए। विवरण के लिए देखें [networking guide](https://www.rabbitmq.com/networking.html). **इनमें से केवल 9 पोर्ट इंटरनेट पर खुले हैं**.
- 35672-35682: नोड्स के साथ संचार के लिए CLI टूल्स द्वारा उपयोग किए जाते हैं (Erlang distribution client ports) और यह एक dynamic range से allocate होते हैं (गणना server distribution port + 10000 से लेकर server distribution port + 10010 तक के रूप में)। विवरण के लिए देखें [networking guide](https://www.rabbitmq.com/networking.html).
- 61613, 61614: [STOMP clients](https://stomp.github.io/stomp-specification-1.2.html) TLS के बिना और TLS के साथ (केवल यदि [STOMP plugin](https://www.rabbitmq.com/stomp.html) सक्षम है)। इस पोर्ट के साथ खुले डिवाइस 10 से कम हैं और ज्यादातर DHT नोड्स के लिए UDP होते हैं।

## यह भी देखें

{{#ref}}
4222-pentesting-nats.md
{{#endref}}

## Shodan

- `AMQP`

## संदर्भ

- [CloudAMQP – RabbitMQ for beginners](https://www.cloudamqp.com/blog/2015-05-18-part1-rabbitmq-for-beginners-what-is-rabbitmq.html)
- [RabbitMQ Networking Guide](https://www.rabbitmq.com/networking.html)

{{#include ../banners/hacktricks-training.md}}
