# 5353/UDP Multicast DNS (mDNS) na DNS-SD

{{#include ../banners/hacktricks-training.md}}

## **Taarifa za Msingi**

**Multicast DNS (mDNS)** inaruhusu **operesheni kama za DNS** ndani ya mitandao ya ndani bila kuhitaji seva ya jadi ya DNS. Inafanya kazi kwenye **UDP port 5353** na inaruhusu vifaa kugundua kila mmoja na huduma zao, ambayo mara nyingi inaonekana katika vifaa mbalimbali vya IoT. **DNS Service Discovery (DNS-SD)**, ambayo mara nyingi hutumika pamoja na mDNS, inasaidia katika kubaini huduma zinazopatikana kwenye mtandao kupitia maswali ya kawaida ya DNS.
```
PORT     STATE SERVICE
5353/udp open  zeroconf
```
### **Uendeshaji wa mDNS**

Katika mazingira yasiyo na seva ya DNS ya kawaida, mDNS inaruhusu vifaa kutatua majina ya kikoa yanayomalizika na **.local** kwa kuuliza anwani ya multicast **224.0.0.251** (IPv4) au **FF02::FB** (IPv6). Vipengele muhimu vya mDNS ni pamoja na thamani ya **Time-to-Live (TTL)** inayonyesha uhalali wa rekodi na **QU bit** inayotofautisha kati ya maswali ya unicast na multicast. Kwa upande wa usalama, ni muhimu kwa utekelezaji wa mDNS kuthibitisha kwamba anwani ya chanzo ya pakiti inalingana na subnet ya ndani.

### **Uendeshaji wa DNS-SD**

DNS-SD inarahisisha ugunduzi wa huduma za mtandao kwa kuuliza rekodi za pointer (PTR) ambazo zinachora aina za huduma kwa mifano yao. Huduma zinatambulishwa kwa kutumia muundo wa **\_\<Service>.\_tcp au \_\<Service>.\_udp** ndani ya kikoa cha **.local**, na kusababisha ugunduzi wa rekodi zinazolingana za **SRV** na **TXT** ambazo zinatoa maelezo ya kina kuhusu huduma.

### **Uchunguzi wa Mtandao**

#### **Matumizi ya nmap**

Amri inayofaa kwa ajili ya skanning mtandao wa ndani kwa huduma za mDNS ni:
```bash
nmap -Pn -sUC -p5353 [target IP address]
```
Amri hii husaidia kubaini bandari za mDNS zilizo wazi na huduma zinazotangazwa juu yao.

#### **Uhesabu wa Mtandao kwa kutumia Pholus**

Ili kutuma maombi ya mDNS kwa shughuli na kukamata trafiki, chombo cha **Pholus** kinaweza kutumika kama ifuatavyo:
```bash
sudo python3 pholus3.py [network interface] -rq -stimeout 10
```
## Mashambulizi

### **Kunutia mDNS Probing**

Njia ya shambulio inahusisha kutuma majibu ya uongo kwa mDNS probes, ikionyesha kwamba majina yote yanayowezekana tayari yanatumika, hivyo kuzuia vifaa vipya kuchagua jina la kipekee. Hii inaweza kufanywa kwa kutumia:
```bash
sudo python pholus.py [network interface] -afre -stimeout 1000
```
Teknolojia hii inazuia vifaa vipya kujiandikisha huduma zao kwenye mtandao.

**Kwa muhtasari**, kuelewa jinsi mDNS na DNS-SD zinavyofanya kazi ni muhimu kwa usimamizi wa mtandao na usalama. Zana kama **nmap** na **Pholus** hutoa maarifa muhimu kuhusu huduma za mtandao wa ndani, wakati ufahamu wa hatari zinazoweza kutokea husaidia katika kulinda dhidi ya mashambulizi.

### Spoofing/MitM

Shambulio la kuvutia zaidi ambalo unaweza kutekeleza kupitia huduma hii ni kufanya **MitM** katika **mawasiliano kati ya mteja na seva halisi**. Unaweza kuwa na uwezo wa kupata faili nyeti (MitM mawasiliano na printer) au hata akidi (uthibitishaji wa Windows).\
Kwa maelezo zaidi angalia:

{{#ref}}
../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md
{{#endref}}

## Marejeleo

- [Practical IoT Hacking: The Definitive Guide to Attacking the Internet of Things](https://books.google.co.uk/books/about/Practical_IoT_Hacking.html?id=GbYEEAAAQBAJ&redir_esc=y)

{{#include ../banners/hacktricks-training.md}}
