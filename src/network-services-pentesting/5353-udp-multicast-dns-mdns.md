# 5353/UDP मल्टीकास्ट DNS (mDNS) और DNS-SD

{{#include ../banners/hacktricks-training.md}}

## **बुनियादी जानकारी**

**मल्टीकास्ट DNS (mDNS)** स्थानीय नेटवर्कों में **DNS-जैसी क्रियाओं** को पारंपरिक DNS सर्वर की आवश्यकता के बिना सक्षम बनाता है। यह **UDP पोर्ट 5353** पर कार्य करता है और उपकरणों को एक-दूसरे और उनकी सेवाओं को खोजने की अनुमति देता है, जो विभिन्न IoT उपकरणों में सामान्यतः देखा जाता है। **DNS सेवा खोज (DNS-SD)**, जो अक्सर mDNS के साथ उपयोग की जाती है, नेटवर्क पर उपलब्ध सेवाओं की पहचान करने में मदद करती है मानक DNS प्रश्नों के माध्यम से।
```
PORT     STATE SERVICE
5353/udp open  zeroconf
```
### **mDNS का संचालन**

मानक DNS सर्वर के बिना वातावरण में, mDNS उपकरणों को **.local** में समाप्त होने वाले डोमेन नामों को हल करने की अनुमति देता है, जो मल्टीकास्ट पते **224.0.0.251** (IPv4) या **FF02::FB** (IPv6) को क्वेरी करके होता है। mDNS के महत्वपूर्ण पहलुओं में एक **Time-to-Live (TTL)** मान शामिल है जो रिकॉर्ड की वैधता को दर्शाता है और एक **QU बिट** जो यूनिकास्ट और मल्टीकास्ट क्वेरी के बीच अंतर करता है। सुरक्षा के दृष्टिकोण से, यह महत्वपूर्ण है कि mDNS कार्यान्वयन यह सत्यापित करें कि पैकेट का स्रोत पता स्थानीय उपनेट के साथ मेल खाता है।

### **DNS-SD का कार्य**

DNS-SD नेटवर्क सेवाओं की खोज को सुविधाजनक बनाता है, जो पॉइंटर रिकॉर्ड (PTR) के लिए क्वेरी करके सेवा प्रकारों को उनके उदाहरणों से मानचित्रित करता है। सेवाओं की पहचान **\_\<Service>.\_tcp या \_\<Service>.\_udp** पैटर्न का उपयोग करके **.local** डोमेन के भीतर की जाती है, जिससे संबंधित **SRV** और **TXT रिकॉर्ड** की खोज होती है जो विस्तृत सेवा जानकारी प्रदान करते हैं।

### **नेटवर्क अन्वेषण**

#### **nmap का उपयोग**

mDNS सेवाओं के लिए स्थानीय नेटवर्क को स्कैन करने के लिए एक उपयोगी कमांड है:
```bash
nmap -Pn -sUC -p5353 [target IP address]
```
यह कमांड खुले mDNS पोर्ट और उनके माध्यम से विज्ञापित सेवाओं की पहचान करने में मदद करता है।

#### **Pholus के साथ नेटवर्क एन्यूमरेशन**

सक्रिय रूप से mDNS अनुरोध भेजने और ट्रैफ़िक कैप्चर करने के लिए, **Pholus** टूल का उपयोग निम्नलिखित तरीके से किया जा सकता है:
```bash
sudo python3 pholus3.py [network interface] -rq -stimeout 10
```
## हमले

### **mDNS प्रॉबिंग का शोषण**

एक हमले का वेक्टर mDNS प्रॉब्स को धोखाधड़ी वाले उत्तर भेजने में शामिल है, यह सुझाव देते हुए कि सभी संभावित नाम पहले से ही उपयोग में हैं, इस प्रकार नए उपकरणों को एक अद्वितीय नाम चुनने से रोकना। इसे निम्नलिखित का उपयोग करके निष्पादित किया जा सकता है:
```bash
sudo python pholus.py [network interface] -afre -stimeout 1000
```
यह तकनीक नए उपकरणों को नेटवर्क पर अपनी सेवाएँ पंजीकृत करने से प्रभावी ढंग से रोकती है।

**संक्षेप में**, mDNS और DNS-SD के कार्यों को समझना नेटवर्क प्रबंधन और सुरक्षा के लिए महत्वपूर्ण है। **nmap** और **Pholus** जैसे उपकरण स्थानीय नेटवर्क सेवाओं के बारे में मूल्यवान जानकारी प्रदान करते हैं, जबकि संभावित कमजोरियों के प्रति जागरूकता हमलों से बचाने में मदद करती है।

### Spoofing/MitM

इस सेवा पर आप जो सबसे दिलचस्प हमला कर सकते हैं, वह है **MitM** करना **क्लाइंट और असली सर्वर के बीच संचार में**। आप संवेदनशील फ़ाइलें (प्रिंटर के साथ संचार को MitM करना) या यहां तक कि क्रेडेंशियल्स (Windows प्रमाणीकरण) प्राप्त करने में सक्षम हो सकते हैं।\
अधिक जानकारी के लिए देखें:

{{#ref}}
../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md
{{#endref}}

## संदर्भ

- [Practical IoT Hacking: The Definitive Guide to Attacking the Internet of Things](https://books.google.co.uk/books/about/Practical_IoT_Hacking.html?id=GbYEEAAAQBAJ&redir_esc=y)

{{#include ../banners/hacktricks-training.md}}
