# 5353/UDP Multicast DNS (mDNS) en DNS-SD

{{#include ../banners/hacktricks-training.md}}

## **Basiese Inligting**

**Multicast DNS (mDNS)** stel **DNS-agtige operasies** in staat binne plaaslike netwerke sonder die behoefte aan 'n tradisionele DNS-bediener. Dit werk op **UDP-poort 5353** en laat toestelle toe om mekaar en hul dienste te ontdek, wat algemeen gesien word in verskeie IoT-toestelle. **DNS-diensontdekking (DNS-SD)**, wat dikwels saam met mDNS gebruik word, help om dienste wat op die netwerk beskikbaar is, te identifiseer deur standaard DNS-vrae.
```
PORT     STATE SERVICE
5353/udp open  zeroconf
```
### **Bedryf van mDNS**

In omgewings sonder 'n standaard DNS-bediener, laat mDNS toestelle toe om domeinnames wat eindig op **.local** is, op te los deur die multicast adres **224.0.0.251** (IPv4) of **FF02::FB** (IPv6) te vra. Belangrike aspekte van mDNS sluit 'n **Tyd-tot-lewe (TTL)** waarde in wat die geldigheid van rekords aandui en 'n **QU bit** wat onderskei tussen unicast en multicast vrae. Veiligheidsoorweg is dit van kardinale belang dat mDNS-implementasies verifieer dat die bronadres van die pakket ooreenstem met die plaaslike subnet.

### **Funksionering van DNS-SD**

DNS-SD fasiliteer die ontdekking van netwerkdienste deur te vra vir wysers (PTR) wat diens tipes aan hul instansies koppel. Dienste word geïdentifiseer met behulp van 'n **\_\<Service>.\_tcp of \_\<Service>.\_udp** patroon binne die **.local** domein, wat lei tot die ontdekking van ooreenstemmende **SRV** en **TXT rekords** wat gedetailleerde diens inligting verskaf.

### **Netwerk Verkenning**

#### **nmap Gebruik**

'n Nuttige opdrag om die plaaslike netwerk vir mDNS-dienste te skandeer is:
```bash
nmap -Pn -sUC -p5353 [target IP address]
```
Hierdie opdrag help om oop mDNS-poorte en die dienste wat oor hulle geadverteer word, te identifiseer.

#### **Netwerkopsporing met Pholus**

Om aktief mDNS-versoeke te stuur en verkeer te vang, kan die **Pholus**-instrument soos volg gebruik word:
```bash
sudo python3 pholus3.py [network interface] -rq -stimeout 10
```
## Aanvalle

### **Benutting van mDNS Probing**

'n Aanvalsvector behels die stuur van vervalste antwoorde na mDNS probes, wat voorstel dat alle potensiële name reeds in gebruik is, en dus nuwe toestelle hindert om 'n unieke naam te kies. Dit kan uitgevoer word met:
```bash
sudo python pholus.py [network interface] -afre -stimeout 1000
```
Hierdie tegniek blokkeer effektief nuwe toestelle om hul dienste op die netwerk te registreer.

**In samevatting**, is dit van kardinale belang om die werking van mDNS en DNS-SD te verstaan vir netwerkbestuur en sekuriteit. Gereedskap soos **nmap** en **Pholus** bied waardevolle insigte in plaaslike netwerkdienste, terwyl bewustheid van potensiële kwesbaarhede help om teen aanvalle te beskerm.

### Spoofing/MitM

Die mees interessante aanval wat jy oor hierdie diens kan uitvoer, is om 'n **MitM** in die **kommunikasie tussen die kliënt en die werklike bediener** uit te voer. Jy mag in staat wees om sensitiewe lêers (MitM die kommunikasie met die drukker) of selfs akrediteer (Windows-outeentifikasie) te verkry.\
Vir meer inligting, kyk:

{{#ref}}
../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md
{{#endref}}

## Verwysings

- [Practical IoT Hacking: The Definitive Guide to Attacking the Internet of Things](https://books.google.co.uk/books/about/Practical_IoT_Hacking.html?id=GbYEEAAAQBAJ&redir_esc=y)

{{#include ../banners/hacktricks-training.md}}
