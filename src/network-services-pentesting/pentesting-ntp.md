# 123/udp - Pentesting NTP

{{#include ../banners/hacktricks-training.md}}

## åŸºæœ¬æƒ…å ±

**ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ™‚é–“ãƒ—ãƒ­ãƒˆã‚³ãƒ« (NTP)** ã¯ã€å¯å¤‰é…å»¶ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã‚„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‡ãƒã‚¤ã‚¹ãŒæ™‚è¨ˆã‚’æ­£ç¢ºã«åŒæœŸã•ã›ã‚‹ã“ã¨ã‚’ä¿è¨¼ã—ã¾ã™ã€‚ã“ã‚Œã¯ã€ITé‹ç”¨ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã€ãƒ­ã‚°è¨˜éŒ²ã«ãŠã„ã¦æ­£ç¢ºãªæ™‚é–“ç®¡ç†ã‚’ç¶­æŒã™ã‚‹ãŸã‚ã«é‡è¦ã§ã™ã€‚æ™‚é–“ã¯ã»ã¼ã™ã¹ã¦ã®èªè¨¼ã€æš—å·ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã€æ³•åŒ»å­¦ãƒ—ãƒ­ã‚»ã‚¹ã§ä½¿ç”¨ã•ã‚Œã‚‹ãŸã‚ã€**NTPã«å½±éŸ¿ã‚’ä¸ãˆã‚‹ã“ã¨ãŒã§ãã‚‹æ”»æ’ƒè€…ã¯ã€ã—ã°ã—ã°ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ¶å¾¡ã‚’å›é¿ã—ãŸã‚Šã€æ”»æ’ƒã®èª¿æŸ»ã‚’å›°é›£ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚**

### æ¦‚è¦ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãƒ’ãƒ³ãƒˆ

- **ç›®çš„**: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã§ãƒ‡ãƒã‚¤ã‚¹ã®æ™‚è¨ˆã‚’åŒæœŸã•ã›ã‚‹ã€‚
- **é‡è¦æ€§**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã€ãƒ­ã‚°è¨˜éŒ²ã€æš—å·ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã€åˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ ã«ã¨ã£ã¦é‡è¦ã€‚
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–**:
- èªè¨¼ä»˜ãã®ä¿¡é ¼ã§ãã‚‹NTPã¾ãŸã¯NTSï¼ˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ™‚é–“ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼‰ã‚½ãƒ¼ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹ã€‚
- ãƒ‡ãƒ¼ãƒ¢ãƒ³ã«ã‚¯ã‚¨ãƒª/ã‚³ãƒãƒ³ãƒ‰ã‚’é€ä¿¡ã§ãã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’åˆ¶é™ã™ã‚‹ï¼ˆ``restrict default noquery``, ``kod`` ãªã©ï¼‰ã€‚
- ãƒ¬ã‚¬ã‚·ãƒ¼ã®ãƒ¢ãƒ¼ãƒ‰6/7åˆ¶å¾¡ã‚¯ã‚¨ãƒªï¼ˆ``monlist``, ``ntpdc``ï¼‰ã‚’ç„¡åŠ¹ã«ã™ã‚‹ã‹ã€ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’ã‹ã‘ã‚‹ã€‚
- åŒæœŸã®ãƒ‰ãƒªãƒ•ãƒˆ/ãƒªãƒ¼ãƒ—ç§’çŠ¶æ…‹ã‚’ç›£è¦–ã—ã¦æ”¹ã–ã‚“ã‚’æ¤œå‡ºã™ã‚‹ã€‚
- ãƒ‡ãƒ¼ãƒ¢ãƒ³ã‚’æœ€æ–°ã®çŠ¶æ…‹ã«ä¿ã¤ï¼ˆä»¥ä¸‹ã®æœ€è¿‘ã®CVEã‚’å‚ç…§ï¼‰ã€‚

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆ**
```
123/udp   NTP            (data + legacy control)
4460/tcp  NTS-KE (RFC 8915) â€“ TLS key-establishment for NTP
```

```
PORT    STATE SERVICE REASON
123/udp open  ntp     udp-response
```
---
## åˆ—æŒ™

### ã‚¯ãƒ©ã‚·ãƒƒã‚¯ ntpd / ntpq / ntpdc
```bash
# Information & variables
ntpq -c rv <IP>
ntpq -c readvar <IP>
ntpq -c peers <IP>
ntpq -c associations <IP>

# Legacy mode-7 (often disabled >=4.2.8p9)
ntpdc -c monlist <IP>
ntpdc -c listpeers <IP>
ntpdc -c sysinfo  <IP>
```
### chrony / chronyc (ã»ã¨ã‚“ã©ã®æœ€æ–°ã®Linuxãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã§)

``cmdallow`` ãŒæœ‰åŠ¹ãªå ´åˆã€ãƒªãƒ¢ãƒ¼ãƒˆIPã‹ã‚‰å—ã‘å…¥ã‚Œã‚‰ã‚Œã‚‹ç›£è¦–ã‚³ãƒãƒ³ãƒ‰ã¯ã‚ãšã‹ã§ã™:
```bash
chronyc -a -n tracking   -h <IP>
chronyc -a -n sources -v -h <IP>
chronyc -a -n sourcestats -h <IP>
```
**M/S** ãƒ•ãƒ©ã‚°ã‚„ãã®ä»–ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆã‚¹ãƒˆãƒ©ã‚¿ãƒ ã€ãƒªãƒ¼ãƒã€ã‚¸ãƒƒã‚¿ãƒ¼ãªã©ï¼‰ã®æ„å‘³ã«ã¤ã„ã¦ã¯ã€chronycã®ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ãƒšãƒ¼ã‚¸ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

### Nmap
```bash
# Safe discovery & vuln detection
nmap -sU -sV --script "ntp* and (discovery or vuln) and not (dos or brute)" -p 123 <IP>

# Explicit monlist check
nmap -sU -p123 --script ntp-monlist <IP>
```
### å¤§è¦æ¨¡/ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚¹ã‚­ãƒ£ãƒ³
```bash
# Check if MONLIST is enabled (zgrab2 module)
zgrab2 ntp --monlist --timeout 3 --output-file monlist.json -f "zmap_results.csv"
```
---
## è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª

- ``/etc/ntp.conf`` (ntpd)
- ``/etc/chrony/chrony.conf`` (chrony)
- ``/etc/systemd/timesyncd.conf`` (timesyncd â€“ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ã¿)

``restrict`` è¡Œã€``kod`` (Kiss-o'-Death) è¨­å®šã€``disable monitor``/``includefile /etc/ntp/crypto``ã€ãŠã‚ˆã³ *NTS* ãŒæœ‰åŠ¹ã‹ã©ã†ã‹ (``nts enable``) ã«ç‰¹ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

---
## æœ€è¿‘ã®è„†å¼±æ€§ (2023-2025)

| å¹´ | CVE | ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | å½±éŸ¿ |
|------|-----|-----------|--------|
| 2023 | **CVE-2023-26551â†’26555** | ntp 4.2.8p15 (libntp *mstolfp*, *praecis_parse*) | **ntpq** å¿œç­”ã‚’ä»‹ã—ã¦åˆ°é”å¯èƒ½ãªè¤‡æ•°ã®ãƒãƒƒãƒ•ã‚¡ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼æ›¸ãè¾¼ã¿ã€‚**4.2.8p16** ã§ãƒ‘ãƒƒãƒ ğŸ¡’ ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã¾ãŸã¯ãƒãƒƒã‚¯ãƒãƒ¼ãƒˆä¿®æ­£ã€‚ îˆ€citeîˆ‚turn1search1îˆ‚turn1search2îˆ‚turn1search0îˆ|
| 2023 | **CVE-2023-33192** | **ntpd-rs** (Rust å®Ÿè£…) | å½¢å¼ãŒä¸æ­£ãª **NTS** ã‚¯ãƒƒã‚­ãƒ¼ãŒãƒªãƒ¢ãƒ¼ãƒˆ **DoS** ã‚’å¼•ãèµ·ã“ã™ v0.3.3 å‰ â€“ NTS **ç„¡åŠ¹** ã®å ´åˆã§ã‚‚ãƒãƒ¼ãƒˆ 123 ã«å½±éŸ¿ã€‚ îˆ€citeîˆ‚turn4view0îˆ|
| 2024 | ãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã®æ›´æ–° | **chrony 4.4 / 4.5** â€“ è¤‡æ•°ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ– & NTS-KE ä¿®æ­£ (ä¾‹: SUSE-RU-2024:2022) îˆ€citeîˆ‚turn2search2îˆ|
| 2024 | DDoS è¨˜éŒ² | Cloudflare ãŒ **5.6 Tbps UDP ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³** æ”»æ’ƒã‚’å ±å‘Š (ä½¿ç”¨ã•ã‚ŒãŸãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ä¸­ã« NTP ãŒå«ã¾ã‚Œã‚‹)ã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«é¢ã—ãŸãƒ›ã‚¹ãƒˆã§ã¯ *monitor* & *monlist* ã‚’ç„¡åŠ¹ã«ã—ã¦ãŠãã€‚ îˆ€citeîˆ‚turn5search0îˆ|

> **ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã‚­ãƒƒãƒˆ**: 2023 ntpq OOB æ›¸ãè¾¼ã¿ã‚·ãƒªãƒ¼ã‚ºã®æ¦‚å¿µå®Ÿè¨¼ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ãŒ GitHub ã«ã‚ã‚Š (Meinberg ã®è¨˜äº‹ã‚’å‚ç…§)ã€ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ãƒ•ã‚£ãƒƒã‚·ãƒ³ã‚°ã«æ­¦å™¨åŒ–å¯èƒ½ã€‚ îˆ€citeîˆ‚turn1search4îˆ

---
## é«˜åº¦ãªæ”»æ’ƒ

### 1. NTP å¢—å¹… / ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³

ãƒ¬ã‚¬ã‚·ãƒ¼ Mode-7 ``monlist`` ã‚¯ã‚¨ãƒªã¯æœ€å¤§ **600 ãƒ›ã‚¹ãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹** ã‚’è¿”ã—ã€æ•°åƒã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆãƒ›ã‚¹ãƒˆã«ã¾ã å­˜åœ¨ã—ã¾ã™ã€‚å¿œç­” (428-468 ãƒã‚¤ãƒˆ/ã‚¨ãƒ³ãƒˆãƒª) ã¯ 8 ãƒã‚¤ãƒˆã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã® *~ 200Ã—* å¤§ãã„ãŸã‚ã€æ”»æ’ƒè€…ã¯ä¸‰æ¡ã®å¢—å¹…ä¿‚æ•°ã«é”ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ç·©å’Œç­–:

- ntp 4.2.8p15+ ã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã—ã€``disable monitor`` ã‚’ **è¿½åŠ ** ã—ã¾ã™ã€‚
- ã‚¨ãƒƒã‚¸ã§ UDP/123 ã®ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’è¡Œã†ã‹ã€DDoS ã‚¢ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ã§ *sessions-required* ã‚’æœ‰åŠ¹ã«ã—ã¾ã™ã€‚
- ã‚½ãƒ¼ã‚¹ã‚¹ãƒ—ãƒ¼ãƒ•ã‚£ãƒ³ã‚°ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹ãŸã‚ã« *BCP 38* å‡ºå£ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚’æœ‰åŠ¹ã«ã—ã¾ã™ã€‚

Cloudflare ã®å­¦ç¿’ã‚»ãƒ³ã‚¿ãƒ¼ã®è¨˜äº‹ã‚’å‚ç…§ã—ã¦ã€ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã®å†…è¨³ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚ îˆ€citeîˆ‚turn5search1îˆ

### 2. æ™‚é–“ã‚·ãƒ•ãƒˆ / é…å»¶æ”»æ’ƒ (Khronos / Chronos ç ”ç©¶)

èªè¨¼ãŒã‚ã£ã¦ã‚‚ã€çµŒè·¯ä¸Šã®æ”»æ’ƒè€…ã¯ãƒ‘ã‚±ãƒƒãƒˆã‚’ãƒ‰ãƒ­ãƒƒãƒ—ã¾ãŸã¯é…å»¶ã•ã›ã‚‹ã“ã¨ã§ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®æ™‚è¨ˆã‚’é™ã‹ã« **ã‚·ãƒ•ãƒˆ** ã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚IETF **Khronos (ä»¥å‰ã® Chronos) ãƒ‰ãƒ©ãƒ•ãƒˆ** ã¯ã€ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§å¤šæ§˜ãªã‚µãƒ¼ãƒãƒ¼ã«ã‚¯ã‚¨ãƒªã‚’è¡Œã„ã€ã‚·ãƒ•ãƒˆ > ğš¡ ms ã‚’æ¤œå‡ºã™ã‚‹ãŸã‚ã«çµæœã‚’ã‚µãƒ‹ãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã“ã¨ã‚’ææ¡ˆã—ã¦ã„ã¾ã™ã€‚æœ€æ–°ã® chrony (4.4+) ã¯ã™ã§ã«é¡ä¼¼ã®ã‚µãƒ‹ãƒ†ã‚£ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ (``maxdistance`` / ``maxjitter``) ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚ îˆ€citeîˆ‚turn9search1îˆ

### 3. NTS æ‚ªç”¨ & 4460/tcp éœ²å‡º

NTS ã¯é‡ã„æš—å·å‡¦ç†ã‚’åˆ¥ã® **TLS 1.3 ãƒãƒ£ãƒ³ãƒãƒ« 4460/tcp** (``ntske/1``) ã«ç§»å‹•ã—ã¾ã™ã€‚å®Ÿè£…ãŒä¸ååˆ†ãªå ´åˆ (CVE-2023-33192 ã‚’å‚ç…§) ã¯ã€ã‚¯ãƒƒã‚­ãƒ¼ã®è§£ææ™‚ã«ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã™ã‚‹ã‹ã€å¼±ã„æš—å·ã‚’è¨±å¯ã—ã¾ã™ã€‚ãƒšãƒ³ãƒ†ã‚¹ã‚¿ãƒ¼ã¯:
```bash
# TLS reconnaissance
nmap -sV -p 4460 --script ssl-enum-ciphers,ssl-cert <IP>

# Grab banner & ALPN
openssl s_client -connect <IP>:4460 -alpn ntske/1 -tls1_3 -ign_eof
```
è‡ªå·±ç½²åã¾ãŸã¯æœŸé™åˆ‡ã‚Œã®è¨¼æ˜æ›¸ã¨å¼±ã„æš—å·ã‚¹ã‚¤ãƒ¼ãƒˆï¼ˆéAEADï¼‰ã‚’æ¢ã—ã¾ã™ã€‚å‚ç…§: RFC 8915 Â§4. îˆ€citeîˆ‚turn11search0îˆ

---
## ãƒãƒ¼ãƒ‰ãƒ‹ãƒ³ã‚° / ãƒ™ã‚¹ãƒˆãƒ»ã‚«ãƒ¬ãƒ³ãƒˆãƒ»ãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ (BCP-233 / RFC 8633)

*ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼ã¯æ¬¡ã®ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™:*

1. **â‰¥ 4** ã®ç‹¬ç«‹ã—ãŸå¤šæ§˜ãªæ™‚é–“ã‚½ãƒ¼ã‚¹ï¼ˆå…¬å…±ãƒ—ãƒ¼ãƒ«ã€GPSã€PTPãƒ–ãƒªãƒƒã‚¸ï¼‰ã‚’ä½¿ç”¨ã—ã¦ã€å˜ä¸€ã‚½ãƒ¼ã‚¹ã®æ±šæŸ“ã‚’é¿ã‘ã‚‹ã“ã¨ã€‚
2. ``kod`` ãŠã‚ˆã³ ``limited``/``nomodify`` åˆ¶é™ã‚’æœ‰åŠ¹ã«ã—ã¦ã€æ‚ªç”¨ã™ã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒå®Œå…¨ãªå¿œç­”ã®ä»£ã‚ã‚Šã« **Kiss-o'-Death** ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãƒ‘ã‚±ãƒƒãƒˆã‚’å—ã‘å–ã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã€‚
3. ãƒ‡ãƒ¼ãƒ¢ãƒ³ãƒ­ã‚°ã‚’ç›£è¦–ã—ã¦ **panic** ã‚¤ãƒ™ãƒ³ãƒˆã‚„ã‚¹ãƒ†ãƒƒãƒ—èª¿æ•´ > 1000 s ã‚’ç¢ºèªã™ã‚‹ã“ã¨ã€‚ï¼ˆRFC 8633 Â§5.3 ã«ã‚ˆã‚‹æ”»æ’ƒã®å…†å€™ã€‚ï¼‰
4. ãƒªãƒ¼ãƒ—ç§’ã®åœæ­¢ã‚’é¿ã‘ã‚‹ãŸã‚ã« **leap-smear** ã‚’æ¤œè¨ã™ã‚‹ãŒã€*ã™ã¹ã¦ã®* ä¸‹æµã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒåŒã˜ã‚¹ãƒŸã‚¢ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã“ã¨ã€‚
5. ãƒªãƒ¼ãƒ—ç§’ãƒ•ãƒ©ã‚°ã‚’è¦‹é€ƒã•ãªã„ã‚ˆã†ã«ã€ãƒãƒ¼ãƒªãƒ³ã‚°ã‚’ â‰¤24 h ã«ä¿ã¤ã“ã¨ã€‚

åŒ…æ‹¬çš„ãªãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã«ã¤ã„ã¦ã¯ RFC 8633 ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚ îˆ€citeîˆ‚turn8search0îˆ‚turn8search1îˆ

---
## Shodan / Censys Dorks
```
port:123 "ntpd"          # Version banner
udp port:123 monlist:true # Censys tag for vulnerable servers
port:4460 "ntske"         # NTS-KE
```
---
## æœ‰ç”¨ãªãƒ„ãƒ¼ãƒ«

| ãƒ„ãƒ¼ãƒ« | ç›®çš„ | ä¾‹ |
|------|---------|---------|
| ``ntpwn`` | monlist & peers ã‚¯ã‚¨ãƒªã‚’ã‚¹ãƒ—ãƒ¬ãƒ¼ã™ã‚‹ãŸã‚ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚­ãƒ‡ã‚£ãƒ©ãƒƒãƒ‘ãƒ¼ | ``python ntpwn.py --monlist targets.txt`` |
| **zgrab2 ntp** | å¤§è¦æ¨¡ã‚¹ã‚­ãƒ£ãƒ³ / monlist ãƒ•ãƒ©ã‚°ã‚’å«ã‚€ JSON å‡ºåŠ› | ä¸Šè¨˜ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å‚ç…§ |
| ``chronyd`` with ``allow`` | ãƒšãƒ³ãƒ†ã‚¹ãƒˆãƒ©ãƒœã§ã®æ‚ªæ„ã®ã‚ã‚‹ NTP ã‚µãƒ¼ãƒãƒ¼ã®å®Ÿè¡Œ | ``chronyd -q 'server 127.127.1.0 iburst'`` |
| ``BetterCap`` | Wi-Fi ä¸Šã§ã®æ™‚é–“ã‚·ãƒ•ãƒˆ MITM ã®ãŸã‚ã« NTP ãƒ‘ã‚±ãƒƒãƒˆã‚’æ³¨å…¥ | ``set arp.spoof.targets <victim>; set ntp.time.delta 30s; arp.spoof on`` |

---
## HackTricks è‡ªå‹•ã‚³ãƒãƒ³ãƒ‰
```
Protocol_Name: NTP
Port_Number: 123
Protocol_Description: Network Time Protocol

Entry_1:
Name: Notes
Description: Notes for NTP
Note: |
The Network Time Protocol (NTP) ensures computers and network devices across variable-latency networks sync their clocks accurately. It's vital for maintaining precise timekeeping in IT operations, security, and logging. NTP's accuracy is essential, but it also poses security risks if not properly managed.

https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-ntp.html

Entry_2:
Name: Nmap
Description: Enumerate NTP
Command: nmap -sU -sV --script "ntp* and (discovery or vuln) and not (dos or brute)" -p 123 {IP}
```
---
## å‚è€ƒæ–‡çŒ®

- RFC 8915 â€“ *Network Time Security for the Network Time Protocol* (port 4460) îˆ€citeîˆ‚turn11search0îˆ
- RFC 8633 â€“ *Network Time Protocol BCP* îˆ€citeîˆ‚turn8search0îˆ
- Cloudflare DDoS report 2024 Q4 (5.6 Tbps) îˆ€citeîˆ‚turn5search0îˆ
- Cloudflare *NTP Amplification Attack* article îˆ€citeîˆ‚turn5search1îˆ
- NTP 4.2.8p15 CVE series 2023-04 îˆ€citeîˆ‚turn1search4îˆ
- NVD entries **CVE-2023-26551â€“55**, **CVE-2023-33192** îˆ€citeîˆ‚turn1search1îˆ‚turn1search2îˆ‚turn1search0îˆ‚turn4view0îˆ
- SUSE chrony security update 2024 (chrony 4.5) îˆ€citeîˆ‚turn2search2îˆ
- Khronos/Chronos draft (time-shift mitigation) îˆ€citeîˆ‚turn9search1îˆ
- chronyc manual/examples for remote monitoring îˆ€citeîˆ‚turn3search0îˆ‚turn10search1îˆ
- zgrab2 ntp module docs îˆ€citeîˆ‚turn7search0îˆ
{{#include /banners/hacktricks-training.md}}
