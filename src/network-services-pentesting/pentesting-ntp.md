# 123/udp - Pentesting NTP

{{#include ../banners/hacktricks-training.md}}

## –û—Å–Ω–æ–≤–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è

**–ü—Ä–æ—Ç–æ–∫–æ–ª —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó —á–∞—Å—É –≤ –º–µ—Ä–µ–∂—ñ (NTP)** –∑–∞–±–µ–∑–ø–µ—á—É—î —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—é –≥–æ–¥–∏–Ω–Ω–∏–∫—ñ–≤ –∫–æ–º–ø'—é—Ç–µ—Ä—ñ–≤ —Ç–∞ –º–µ—Ä–µ–∂–µ–≤–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤ —á–µ—Ä–µ–∑ –º–µ—Ä–µ–∂—ñ –∑ —Ä—ñ–∑–Ω–æ—é –∑–∞—Ç—Ä–∏–º–∫–æ—é. –¶–µ –≤–∞–∂–ª–∏–≤–æ –¥–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ —Ç–æ—á–Ω–æ–≥–æ –æ–±–ª—ñ–∫—É —á–∞—Å—É –≤ –Ü–¢-–æ–ø–µ—Ä–∞—Ü—ñ—è—Ö, –±–µ–∑–ø–µ—Ü—ñ —Ç–∞ –≤–µ–¥–µ–Ω–Ω—ñ –∂—É—Ä–Ω–∞–ª—ñ–≤. –û—Å–∫—ñ–ª—å–∫–∏ —á–∞—Å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –ø—Ä–∞–∫—Ç–∏—á–Ω–æ –≤ –∫–æ–∂–Ω–æ–º—É –ø—Ä–æ—Ü–µ—Å—ñ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó, –∫—Ä–∏–ø—Ç–æ–ø—Ä–æ—Ç–æ–∫–æ–ª—ñ —Ç–∞ —Å—É–¥–æ–≤–æ-–º–µ–¥–∏—á–Ω–æ–º—É —Ä–æ–∑—Å–ª—ñ–¥—É–≤–∞–Ω–Ω—ñ, **–∑–ª–æ–≤–º–∏—Å–Ω–∏–∫, —è–∫–∏–π –º–æ–∂–µ –≤–ø–ª–∏–≤–∞—Ç–∏ –Ω–∞ NTP, —á–∞—Å—Ç–æ –º–æ–∂–µ –æ–±—ñ–π—Ç–∏ –∑–∞—Å–æ–±–∏ –±–µ–∑–ø–µ–∫–∏ –∞–±–æ —É—Å–∫–ª–∞–¥–Ω–∏—Ç–∏ —Ä–æ–∑—Å–ª—ñ–¥—É–≤–∞–Ω–Ω—è –∞—Ç–∞–∫.**

### –†–µ–∑—é–º–µ —Ç–∞ –ø–æ—Ä–∞–¥–∏ –∑ –±–µ–∑–ø–µ–∫–∏

- **–ú–µ—Ç–∞**: –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É—î –≥–æ–¥–∏–Ω–Ω–∏–∫–∏ –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤ —á–µ—Ä–µ–∑ –º–µ—Ä–µ–∂—ñ.
- **–í–∞–∂–ª–∏–≤—ñ—Å—Ç—å**: –ö—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–æ –¥–ª—è –±–µ–∑–ø–µ–∫–∏, –≤–µ–¥–µ–Ω–Ω—è –∂—É—Ä–Ω–∞–ª—ñ–≤, –∫—Ä–∏–ø—Ç–æ–ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤ —Ç–∞ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö —Å–∏—Å—Ç–µ–º.
- **–ó–∞—Ö–æ–¥–∏ –±–µ–∑–ø–µ–∫–∏**:
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –Ω–∞–¥—ñ–π–Ω—ñ –¥–∂–µ—Ä–µ–ª–∞ NTP –∞–±–æ NTS (Network Time Security) –∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é.
- –û–±–º–µ–∂—Ç–µ, —Ö—Ç–æ –º–æ–∂–µ –∑–∞–ø–∏—Ç—É–≤–∞—Ç–∏/–∫–µ—Ä—É–≤–∞—Ç–∏ –¥–µ–º–æ–Ω–æ–º (``restrict default noquery``, ``kod`` —Ç–æ—â–æ).
- –í–∏–º–∫–Ω—ñ—Ç—å –∑–∞–ø–∏—Ç–∏ –∫–æ–Ω—Ç—Ä–æ–ª—é —Å—Ç–∞—Ä–∏—Ö —Ä–µ–∂–∏–º—ñ–≤ 6/7 (``monlist``, ``ntpdc``) –∞–±–æ –æ–±–º–µ–∂—Ç–µ —ó—Ö —á–∞—Å—Ç–æ—Ç—É.
- –ú–æ–Ω—ñ—Ç–æ—Ä—Ç–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó/—Å—Ç–∞–Ω —Å—Ç—Ä–∏–±–∫–∞ —Å–µ–∫—É–Ω–¥ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –ø—ñ–¥—Ä–æ–±–æ–∫.
- –¢—Ä–∏–º–∞–π—Ç–µ –¥–µ–º–æ–Ω –æ–Ω–æ–≤–ª–µ–Ω–∏–º (–¥–∏–≤. –æ—Å—Ç–∞–Ω–Ω—ñ CVE –Ω–∏–∂—á–µ).

**–ü–æ—Ä—Ç –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º**
```
123/udp   NTP            (data + legacy control)
4460/tcp  NTS-KE (RFC 8915) ‚Äì TLS key-establishment for NTP
```

```
PORT    STATE SERVICE REASON
123/udp open  ntp     udp-response
```
---
## –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞–Ω–Ω—è

### –ö–ª–∞—Å–∏—á–Ω–∏–π ntpd / ntpq / ntpdc
```bash
# Information & variables
ntpq -c rv <IP>
ntpq -c readvar <IP>
ntpq -c peers <IP>
ntpq -c associations <IP>

# Legacy mode-7 (often disabled >=4.2.8p9)
ntpdc -c monlist <IP>
ntpdc -c listpeers <IP>
ntpdc -c sysinfo  <IP>
```
### chrony / chronyc (–≤ –±—ñ–ª—å—à–æ—Å—Ç—ñ —Å—É—á–∞—Å–Ω–∏—Ö –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤—ñ–≤ Linux)

–õ–∏—à–µ –∫—ñ–ª—å–∫–∞ –∫–æ–º–∞–Ω–¥ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –ø—Ä–∏–π–º–∞—é—Ç—å—Å—è –∑ –≤—ñ–¥–¥–∞–ª–µ–Ω–∏—Ö IP-–∞–¥—Ä–µ—Å, –∫–æ–ª–∏ ``cmdallow`` —É–≤—ñ–º–∫–Ω–µ–Ω–æ:
```bash
chronyc -a -n tracking   -h <IP>
chronyc -a -n sources -v -h <IP>
chronyc -a -n sourcestats -h <IP>
```
–î–∏–≤—ñ—Ç—å—Å—è —Å—Ç–æ—Ä—ñ–Ω–∫—É man –¥–ª—è chronyc –¥–ª—è –∑–Ω–∞—á–µ–Ω–Ω—è –ø—Ä–∞–ø–æ—Ä—Ü—ñ–≤ **M/S** —Ç–∞ —ñ–Ω—à–∏—Ö –ø–æ–ª—ñ–≤ (stratum, reach, jitter —Ç–æ—â–æ).

### Nmap
```bash
# Safe discovery & vuln detection
nmap -sU -sV --script "ntp* and (discovery or vuln) and not (dos or brute)" -p 123 <IP>

# Explicit monlist check
nmap -sU -p123 --script ntp-monlist <IP>
```
### –ú–∞—Å–æ–≤–µ/–Ü–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è
```bash
# Check if MONLIST is enabled (zgrab2 module)
zgrab2 ntp --monlist --timeout 3 --output-file monlist.json -f "zmap_results.csv"
```
---
## –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤

- ``/etc/ntp.conf`` (ntpd)
- ``/etc/chrony/chrony.conf`` (chrony)
- ``/etc/systemd/timesyncd.conf`` (timesyncd ‚Äì —Ç—ñ–ª—å–∫–∏ –∫–ª—ñ—î–Ω—Ç)

–ó–≤–µ—Ä–Ω—ñ—Ç—å –æ—Å–æ–±–ª–∏–≤—É —É–≤–∞–≥—É –Ω–∞ —Ä—è–¥–∫–∏ ``restrict``, –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è ``kod`` (Kiss-o'-Death), ``disable monitor``/``includefile /etc/ntp/crypto`` —Ç–∞ —á–∏ —É–≤—ñ–º–∫–Ω–µ–Ω–æ *NTS* (``nts enable``).

---
## –û—Å—Ç–∞–Ω–Ω—ñ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ (2023-2025)

| –†—ñ–∫ | CVE | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –í–ø–ª–∏–≤ |
|------|-----|-----------|--------|
| 2023 | **CVE-2023-26551‚Üí26555** | ntp 4.2.8p15 (libntp *mstolfp*, *praecis_parse*) | –ë–∞–≥–∞—Ç–æ—Ä–∞–∑–æ–≤—ñ –∑–∞–ø–∏—Å–∏ –∑–∞ –º–µ–∂–∞–º–∏ –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ, –¥–æ—Å—Ç—É–ø–Ω—ñ —á–µ—Ä–µ–∑ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ **ntpq**. –ü–∞—Ç—á —É **4.2.8p16** ü°í –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∞–±–æ –∑–≤–æ—Ä–æ—Ç–Ω–µ –ø–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—å. |
| 2023 | **CVE-2023-33192** | **ntpd-rs** (—Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –Ω–∞ Rust) | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å—Ñ–æ—Ä–º–æ–≤–∞–Ω–∏–π **NTS** cookie –≤–∏–∫–ª–∏–∫–∞—î –≤—ñ–¥–¥–∞–ª–µ–Ω–∏–π **DoS** –¥–æ v0.3.3 ‚Äì –≤–ø–ª–∏–≤–∞—î –Ω–∞ –ø–æ—Ä—Ç 123 –Ω–∞–≤—ñ—Ç—å –∫–æ–ª–∏ NTS **–≤–∏–º–∫–Ω–µ–Ω–æ**. |
| 2024 | –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤—ñ–≤ | **chrony 4.4 / 4.5** ‚Äì –∫—ñ–ª—å–∫–∞ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—å –±–µ–∑–ø–µ–∫–∏ —Ç–∞ NTS-KE (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, SUSE-RU-2024:2022) |
| 2024 | –ó–∞–ø–∏—Å DDoS | Cloudflare –ø–æ–≤—ñ–¥–æ–º–ª—è—î –ø—Ä–æ **5.6 Tbps UDP reflection** –∞—Ç–∞–∫—É (NTP —Å–µ—Ä–µ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤). –¢—Ä–∏–º–∞–π—Ç–µ *monitor* —Ç–∞ *monlist* –≤–∏–º–∫–Ω–µ–Ω–∏–º–∏ –Ω–∞ —Ö–æ—Å—Ç–∞—Ö, —â–æ –≤–∏—Ö–æ–¥—è—Ç—å –≤ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç. |

> **–ï–∫—Å–ø–ª–æ–π—Ç-–∫–∏—Ç–∏**: –ü–∞—Ç—á—ñ –¥–ª—è –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–∏—Ö –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å —Å–µ—Ä—ñ—ó 2023 ntpq OOB-write –¥–æ—Å—Ç—É–ø–Ω—ñ –Ω–∞ GitHub (–¥–∏–≤. –æ–ø–∏—Å Meinberg) —ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è —Ñ—ñ—à–∏–Ω–≥—É –∑ –±–æ–∫—É –∫–ª—ñ—î–Ω—Ç–∞ –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω–∏—Ö –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤.

---
## –†–æ–∑—à–∏—Ä–µ–Ω—ñ –∞—Ç–∞–∫–∏

### 1. NTP –ø—ñ–¥—Å–∏–ª–µ–Ω–Ω—è / –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è

–ó–∞–ø–∏—Ç —Å—Ç–∞—Ä–æ–≥–æ —Ä–µ–∂–∏–º—É-7 ``monlist`` –ø–æ–≤–µ—Ä—Ç–∞—î –¥–æ **600 –∞–¥—Ä–µ—Å —Ö–æ—Å—Ç—ñ–≤** —ñ –≤—Å–µ —â–µ –ø—Ä–∏—Å—É—Ç–Ω—ñ–π –Ω–∞ —Ç–∏—Å—è—á–∞—Ö –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç-—Ö–æ—Å—Ç—ñ–≤. –û—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å (428-468 –±–∞–π—Ç/–∑–∞–ø–∏—Å) —î *~ 200√ó* –±—ñ–ª—å—à–æ—é –∑–∞ 8-–±–∞–π—Ç–æ–≤–∏–π –∑–∞–ø–∏—Ç, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –º–æ–∂–µ –¥–æ—Å—è–≥—Ç–∏ —Ç—Ä–∏–∑–Ω–∞—á–Ω–∏—Ö –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤ –ø—ñ–¥—Å–∏–ª–µ–Ω–Ω—è. –ó–∞—Ö–æ–¥–∏ –ø–æ–º'—è–∫—à–µ–Ω–Ω—è:

- –û–Ω–æ–≤—ñ—Ç—å –¥–æ ntp 4.2.8p15+ —Ç–∞ **–¥–æ–¥–∞–π—Ç–µ** ``disable monitor``.
- –û–±–º–µ–∂—Ç–µ —à–≤–∏–¥–∫—ñ—Å—Ç—å UDP/123 –Ω–∞ –∫—Ä–∞—é –∞–±–æ —É–≤—ñ–º–∫–Ω—ñ—Ç—å *sessions-required* –Ω–∞ –ø—Ä–∏—Å—Ç—Ä–æ—è—Ö DDoS.
- –£–≤—ñ–º–∫–Ω—ñ—Ç—å *BCP 38* —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—é –≤–∏—Ö–æ–¥—É, —â–æ–± –∑–∞–±–ª–æ–∫—É–≤–∞—Ç–∏ –ø—ñ–¥—Ä–æ–±–∫—É –¥–∂–µ—Ä–µ–ª–∞.

–î–∏–≤—ñ—Ç—å—Å—è —Å—Ç–∞—Ç—Ç—é –Ω–∞–≤—á–∞–ª—å–Ω–æ–≥–æ —Ü–µ–Ω—Ç—Ä—É Cloudflare –¥–ª—è –ø–æ–∫—Ä–æ–∫–æ–≤–æ–≥–æ —Ä–æ–∑–±–æ—Ä—É.

### 2. –ê—Ç–∞–∫–∏ –Ω–∞ –∑—Å—É–≤ —á–∞—Å—É / –∑–∞—Ç—Ä–∏–º–∫—É (–¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è Khronos / Chronos)

–ù–∞–≤—ñ—Ç—å –∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é, –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫ –Ω–∞ —à–ª—è—Ö—É –º–æ–∂–µ –±–µ–∑—à—É–º–Ω–æ **–∑—Å—É–Ω—É—Ç–∏ –≥–æ–¥–∏–Ω–Ω–∏–∫ –∫–ª—ñ—î–Ω—Ç–∞**, —Å–∫–∏–¥–∞—é—á–∏/–∑–∞—Ç—Ä–∏–º—É—é—á–∏ –ø–∞–∫–µ—Ç–∏. –ü—Ä–æ–µ–∫—Ç IETF **Khronos (—Ä–∞–Ω—ñ—à–µ Chronos)** –ø—Ä–æ–ø–æ–Ω—É—î –∑–∞–ø–∏—Ç—É–≤–∞—Ç–∏ —Ä—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç–Ω–∏–π –Ω–∞–±—ñ—Ä —Å–µ—Ä–≤–µ—Ä—ñ–≤ —É —Ñ–æ–Ω–æ–≤–æ–º—É —Ä–µ–∂–∏–º—ñ —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –≤–∏—è–≤–ª–µ–Ω–Ω—è –∑—Å—É–≤—É > ùö° –º—Å. –°—É—á–∞—Å–Ω–∏–π chrony (4.4+) –≤–∂–µ —Ä–µ–∞–ª—ñ–∑—É—î –ø–æ–¥—ñ–±–Ω–∏–π —Ñ—ñ–ª—å—Ç—Ä –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ (``maxdistance`` / ``maxjitter``).

### 3. –ó–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è NTS —Ç–∞ –µ–∫—Å–ø–æ–∑–∏—Ü—ñ—è 4460/tcp

NTS –ø–µ—Ä–µ–º—ñ—â—É—î –≤–∞–∂–∫—É –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—é –Ω–∞ –æ–∫—Ä–µ–º–∏–π **TLS 1.3 –∫–∞–Ω–∞–ª –Ω–∞ 4460/tcp** (``ntske/1``). –ü–æ–≥–∞–Ω—ñ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó (–¥–∏–≤. CVE-2023-33192) –∞–≤–∞—Ä—ñ–π–Ω–æ –∑–∞–≤–µ—Ä—à—É—é—Ç—å—Å—è –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥—É cookie –∞–±–æ –¥–æ–∑–≤–æ–ª—è—é—Ç—å —Å–ª–∞–±–∫—ñ —à–∏—Ñ—Ä–∏. –ü–µ–Ω—Ç–µ—Å—Ç–µ—Ä–∏ –ø–æ–≤–∏–Ω–Ω—ñ:
```bash
# TLS reconnaissance
nmap -sV -p 4460 --script ssl-enum-ciphers,ssl-cert <IP>

# Grab banner & ALPN
openssl s_client -connect <IP>:4460 -alpn ntske/1 -tls1_3 -ign_eof
```
–®—É–∫–∞–π—Ç–µ —Å–∞–º–æ–ø—ñ–¥–ø–∏—Å–∞–Ω—ñ –∞–±–æ –ø—Ä–æ—Å—Ç—Ä–æ—á–µ–Ω—ñ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏ —Ç–∞ —Å–ª–∞–±–∫—ñ —à–∏—Ñ—Ä–∏ (non-AEAD). –ü–æ—Å–∏–ª–∞–Ω–Ω—è: RFC 8915 ¬ß4.

---
## –£–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è / –ù–∞–π–∫—Ä–∞—â–∞ –ø–æ—Ç–æ—á–Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞ (BCP-233 / RFC 8633)

*–û–ø–µ—Ä–∞—Ç–æ—Ä–∏ –ú–ê–Æ–¢–¨:*

1. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **‚â• 4** –Ω–µ–∑–∞–ª–µ–∂–Ω—ñ, —Ä—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç–Ω—ñ –¥–∂–µ—Ä–µ–ª–∞ —á–∞—Å—É (–ø—É–±–ª—ñ—á–Ω—ñ –ø—É–ª—ñ, GPS, PTP-–º—ñ—Å—Ç–∫–∏), —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –æ—Ç—Ä—É—î–Ω–Ω—è –∑ –æ–¥–Ω–æ–≥–æ –¥–∂–µ—Ä–µ–ª–∞.
2. –£–≤—ñ–º–∫–Ω—É—Ç–∏ ``kod`` —Ç–∞ ``limited``/``nomodify`` –æ–±–º–µ–∂–µ–Ω–Ω—è, —â–æ–± –∑–ª–æ–≤–º–∏—Å–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∏ –æ—Ç—Ä–∏–º—É–≤–∞–ª–∏ –ø–∞–∫–µ—Ç–∏ **Kiss-o'-Death** –∑ –æ–±–º–µ–∂–µ–Ω–Ω—è–º —à–≤–∏–¥–∫–æ—Å—Ç—ñ –∑–∞–º—ñ—Å—Ç—å –ø–æ–≤–Ω–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π.
3. –ú–æ–Ω—ñ—Ç–æ—Ä–∏—Ç–∏ –∂—É—Ä–Ω–∞–ª–∏ –¥–µ–º–æ–Ω—ñ–≤ –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å **panic** –ø–æ–¥—ñ–π –∞–±–æ –∫–æ—Ä–∏–≥—É–≤–∞–Ω—å –∫—Ä–æ–∫—É > 1000 —Å. (–°–∏–≥–Ω–∞—Ç—É—Ä–∏ –∞—Ç–∞–∫–∏ –∑–≥—ñ–¥–Ω–æ –∑ RFC 8633 ¬ß5.3.)
4. –†–æ–∑–≥–ª—è–Ω—É—Ç–∏ **leap-smear**, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –ø—Ä–æ—Å—Ç–æ—ó–≤ —á–µ—Ä–µ–∑ —Å—Ç—Ä–∏–±–∫–∏ —Å–µ–∫—É–Ω–¥, –∞–ª–µ –ø–µ—Ä–µ–∫–æ–Ω–∞—Ç–∏—Å—è, —â–æ *–≤—Å—ñ* downstream –∫–ª—ñ—î–Ω—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –æ–¥–Ω–µ –π —Ç–µ —Å–∞–º–µ –≤—ñ–∫–Ω–æ —Ä–æ–∑–º–∏—Ç—Ç—è.
5. –ó–±–µ—Ä—ñ–≥–∞—Ç–∏ –æ–ø–∏—Ç—É–≤–∞–Ω–Ω—è ‚â§24 –≥–æ–¥, —â–æ–± –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ –ø—Ä–∞–ø–æ—Ä–∏ —Å—Ç—Ä–∏–±–∫–∞ —Å–µ–∫—É–Ω–¥.

–î–∏–≤—ñ—Ç—å—Å—è RFC 8633 –¥–ª—è –≤—Å–µ–±—ñ—á–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–≥–æ —Å–ø–∏—Å–∫—É.

---
## Shodan / Censys Dorks
```
port:123 "ntpd"          # Version banner
udp port:123 monlist:true # Censys tag for vulnerable servers
port:4460 "ntske"         # NTS-KE
```
---
## –ö–æ—Ä–∏—Å–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

| –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è | –ü—Ä–∏–∫–ª–∞–¥ |
|------------|-------------|---------|
| ``ntpwn`` | –û–±–≥–æ—Ä—Ç–∫–∞ –¥–ª—è —Å–∫—Ä–∏–ø—Ç—ñ–≤, —â–æ–± —Ä–æ–∑–ø–æ–¥—ñ–ª–∏—Ç–∏ –∑–∞–ø–∏—Ç–∏ monlist —Ç–∞ peers | ``python ntpwn.py --monlist targets.txt`` |
| **zgrab2 ntp** | –ú–∞—Å–æ–≤–µ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è / JSON –≤–∏–≤—ñ–¥ –∑ –≤–∫–ª—é—á–µ–Ω–∏–º –ø—Ä–∞–ø–æ—Ä–æ–º monlist | –î–∏–≤. –∫–æ–º–∞–Ω–¥—É –≤–∏—â–µ |
| ``chronyd`` –∑ ``allow`` | –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –ø—ñ–¥—Ä–æ–±–ª–µ–Ω–∏–π NTP —Å–µ—Ä–≤–µ—Ä —É –ª–∞–±–æ—Ä–∞—Ç–æ—Ä—ñ—ó –ø–µ–Ω—Ç–µ—Å—Ç—É | ``chronyd -q 'server 127.127.1.0 iburst'`` |
| ``BetterCap`` | –í–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è NTP –ø–∞–∫–µ—Ç—ñ–≤ –¥–ª—è MITM –∑ –∑—Å—É–≤–æ–º —á–∞—Å—É –Ω–∞ Wi-Fi | ``set arp.spoof.targets <victim>; set ntp.time.delta 30s; arp.spoof on`` |

---
## –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –∫–æ–º–∞–Ω–¥–∏ HackTricks
```
Protocol_Name: NTP
Port_Number: 123
Protocol_Description: Network Time Protocol

Entry_1:
Name: Notes
Description: Notes for NTP
Note: |
The Network Time Protocol (NTP) ensures computers and network devices across variable-latency networks sync their clocks accurately. It's vital for maintaining precise timekeeping in IT operations, security, and logging. NTP's accuracy is essential, but it also poses security risks if not properly managed.

https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-ntp.html

Entry_2:
Name: Nmap
Description: Enumerate NTP
Command: nmap -sU -sV --script "ntp* and (discovery or vuln) and not (dos or brute)" -p 123 {IP}
```
---
## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

- RFC 8915 ‚Äì *–ë–µ–∑–ø–µ–∫–∞ —á–∞—Å—É –º–µ—Ä–µ–∂—ñ –¥–ª—è –ø—Ä–æ—Ç–æ–∫–æ–ª—É —á–∞—Å—É –º–µ—Ä–µ–∂—ñ* (–ø–æ—Ä—Ç 4460)
- RFC 8633 ‚Äì *–ü—Ä–æ—Ç–æ–∫–æ–ª —á–∞—Å—É –º–µ—Ä–µ–∂—ñ BCP*
- –ó–≤—ñ—Ç Cloudflare –ø—Ä–æ DDoS 2024 Q4 (5.6 Tbps)
- –°—Ç–∞—Ç—Ç—è Cloudflare *–ê—Ç–∞–∫–∞ –ø–æ—Å–∏–ª–µ–Ω–Ω—è NTP*
- NTP 4.2.8p15 —Å–µ—Ä—ñ—è CVE 2023-04
- –ó–∞–ø–∏—Å–∏ NVD **CVE-2023-26551‚Äì55**, **CVE-2023-33192**
- –û–Ω–æ–≤–ª–µ–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏ SUSE chrony 2024 (chrony 4.5)
- –ß–µ—Ä–Ω–µ—Ç–∫–∞ Khronos/Chronos (–∑–º–µ–Ω—à–µ–Ω–Ω—è –∑—Å—É–≤—É —á–∞—Å—É)
- –ü–æ—Å—ñ–±–Ω–∏–∫ chronyc/–ø—Ä–∏–∫–ª–∞–¥–∏ –¥–ª—è –≤—ñ–¥–¥–∞–ª–µ–Ω–æ–≥–æ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –º–æ–¥—É–ª—è zgrab2 ntp
{{#include /banners/hacktricks-training.md}}
