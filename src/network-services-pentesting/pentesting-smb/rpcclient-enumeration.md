# rpcclient enumeration

{{#include ../../banners/hacktricks-training.md}}

<figure><img src="/images/image (2).png" alt=""><figcaption></figcaption></figure>

Deepen your expertise in **Mobile Security** with 8kSec Academy. Master iOS and Android security through our self-paced courses and get certified:

{% embed url="https://academy.8ksec.io/" %}

### Muhtasari wa Vitambulisho vya Kijamii (RID) na Vitambulisho vya Usalama (SID)

**Vitambulisho vya Kijamii (RID)** na **Vitambulisho vya Usalama (SID)** ni vipengele muhimu katika mifumo ya uendeshaji ya Windows kwa ajili ya kutambulisha na kusimamia vitu, kama watumiaji na vikundi, ndani ya eneo la mtandao.

- **SIDs** hutumikia kama vitambulisho vya kipekee kwa maeneo, kuhakikisha kwamba kila eneo linaweza kutambulika.
- **RIDs** huongezwa kwa SIDs ili kuunda vitambulisho vya kipekee kwa vitu ndani ya maeneo hayo. Mchanganyiko huu unaruhusu kufuatilia na kusimamia ruhusa za vitu na udhibiti wa ufikiaji kwa usahihi.

Kwa mfano, mtumiaji anayeitwa `pepe` anaweza kuwa na kitambulisho cha kipekee kinachounganisha SID ya eneo na RID yake maalum, kinachowakilishwa kwa mifumo ya hexadecimal (`0x457`) na decimal (`1111`). Hii inasababisha kitambulisho kamili na cha kipekee kwa pepe ndani ya eneo kama: `S-1-5-21-1074507654-1937615267-42093643874-1111`.

### **Uhesabu wa rpcclient**

Zana ya **`rpcclient`** kutoka Samba inatumika kwa ajili ya kuingiliana na **nukta za RPC kupitia bomba zilizotajwa**. Amri zilizo hapa chini zinaweza kutolewa kwa interfaces za SAMR, LSARPC, na LSARPC-DS baada ya **kikao cha SMB kuanzishwa**, mara nyingi kinahitaji akidi.

#### Taarifa za Server

- Ili kupata **Taarifa za Server**: amri ya `srvinfo` inatumika.

#### Uhesabu wa Watumiaji

- **Watumiaji wanaweza kuorodheshwa** kwa kutumia: `querydispinfo` na `enumdomusers`.
- **Maelezo ya mtumiaji** kwa: `queryuser <0xrid>`.
- **Vikundi vya mtumiaji** kwa: `queryusergroups <0xrid>`.
- **SID ya mtumiaji inapatikana** kupitia: `lookupnames <username>`.
- **Majina ya watumiaji** kwa: `queryuseraliases [builtin|domain] <sid>`.
```bash
# Users' RIDs-forced
for i in $(seq 500 1100); do
rpcclient -N -U "" [IP_ADDRESS] -c "queryuser 0x$(printf '%x\n' $i)" | grep "User Name\|user_rid\|group_rid" && echo "";
done

# samrdump.py can also serve this purpose
```
#### Uainishaji wa Makundi

- **Makundi** kwa: `enumdomgroups`.
- **Maelezo ya kundi** na: `querygroup <0xrid>`.
- **Wajumbe wa kundi** kupitia: `querygroupmem <0xrid>`.

#### Uainishaji wa Makundi ya Alias

- **Makundi ya alias** kwa: `enumalsgroups <builtin|domain>`.
- **Wajumbe wa kundi la alias** na: `queryaliasmem builtin|domain <0xrid>`.

#### Uainishaji wa Majimbo

- **Majimbo** kwa kutumia: `enumdomains`.
- **SID ya jimbo inapatikana** kupitia: `lsaquery`.
- **Taarifa za jimbo zinapatikana** kwa: `querydominfo`.

#### Uainishaji wa Kushiriki

- **Kushiriki zote zinazopatikana** kwa: `netshareenumall`.
- **Taarifa kuhusu kushiriki maalum inapatikana** na: `netsharegetinfo <share>`.

#### Operesheni za Ziada na SIDs

- **SIDs kwa jina** kwa kutumia: `lookupnames <username>`.
- **SIDs zaidi** kupitia: `lsaenumsid`.
- **Kizunguzungu cha RID ili kuangalia SIDs zaidi** kinafanywa na: `lookupsids <sid>`.

#### **Amri za Ziada**

| **Amri**           | **Kiolesura**                                                                                                                                     | **Maelezo**                                                                                                                           |
| ------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------- |
| queryuser           | SAMR                                                                                                                                              | Pata taarifa za mtumiaji                                                                                                                 |
| querygroup          | Pata taarifa za kundi                                                                                                                        |                                                                                                                                           |
| querydominfo        | Pata taarifa za jimbo                                                                                                                       |                                                                                                                                           |
| enumdomusers        | Uainishe watumiaji wa jimbo                                                                                                                            |                                                                                                                                           |
| enumdomgroups       | Uainishe makundi ya jimbo                                                                                                                           |                                                                                                                                           |
| createdomuser       | Unda mtumiaji wa jimbo                                                                                                                              |                                                                                                                                           |
| deletedomuser       | Futa mtumiaji wa jimbo                                                                                                                              |                                                                                                                                           |
| lookupnames         | LSARPC                                                                                                                                            | Tafuta majina ya watumiaji hadi SID[a](https://learning.oreilly.com/library/view/network-security-assessment/9781491911044/ch08.html#ch08fn8) thamani |
| lookupsids          | Tafuta SIDs hadi majina ya watumiaji (kizunguzungu cha RID[b](https://learning.oreilly.com/library/view/network-security-assessment/9781491911044/ch08.html#ch08fn9)) |                                                                                                                                           |
| lsaaddacctrights    | Ongeza haki kwa akaunti ya mtumiaji                                                                                                                      |                                                                                                                                           |
| lsaremoveacctrights | Ondoa haki kutoka kwa akaunti ya mtumiaji                                                                                                                 |                                                                                                                                           |
| dsroledominfo       | LSARPC-DS                                                                                                                                         | Pata taarifa za msingi za jimbo                                                                                                            |
| dsenumdomtrusts     | Uainishe majimbo yanayotegemewa ndani ya msitu wa AD                                                                                                     |                                                                                                                                           |

Ili **kuelewa** vizuri jinsi zana _**samrdump**_ **na** _**rpcdump**_ zinavyofanya kazi unapaswa kusoma [**Pentesting MSRPC**](../135-pentesting-msrpc.md).

<figure><img src="/images/image (2).png" alt=""><figcaption></figcaption></figure>

Panua ujuzi wako katika **Usalama wa Simu** na 8kSec Academy. Master usalama wa iOS na Android kupitia kozi zetu za kujifunza kwa kasi yako na upate cheti:

{% embed url="https://academy.8ksec.io/" %}

{{#include ../../banners/hacktricks-training.md}}
