# 43 - Pentesting WHOIS

{{#include ../banners/hacktricks-training.md}}

## Osnovne informacije

Protokol **WHOIS** služi kao standardna metoda za **istraživanje o registrovanim ili vlasnicima raznih Internet resursa** putem specifičnih baza podataka. Ovi resursi obuhvataju imena domena, blokove IP adresa i autonomne sisteme, između ostalog. Pored ovoga, protokol se koristi za pristup širem spektru informacija.

**Podrazumevani port:** 43
```
PORT   STATE  SERVICE
43/tcp open   whois?
```
## Enumerate

Dobijte sve informacije koje whois servis ima o domenu:
```bash
whois -h <HOST> -p <PORT> "domain.tld"
echo "domain.ltd" | nc -vn <HOST> <PORT>
```
Obratite pažnju da ponekad kada tražite informacije od WHOIS servisa, baza podataka koja se koristi pojavljuje u odgovoru:

![](<../images/image (301).png>)

Takođe, WHOIS servis uvek mora koristiti **bazu podataka** za skladištenje i ekstrakciju informacija. Dakle, moguća **SQLInjection** može biti prisutna kada **upitujete** bazu podataka za neke informacije koje je pružio korisnik. Na primer, koristeći: `whois -h 10.10.10.155 -p 43 "a') or 1=1#"` mogli biste biti u mogućnosti da **izvučete sve** **informacije** sačuvane u bazi podataka.

## Shodan

- `port:43 whois`

## HackTricks Automatic Commands
```
Protocol_Name: WHOIS    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: WHOIS         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for WHOIS
Note: |
The WHOIS protocol serves as a standard method for inquiring about the registrants or holders of various Internet resources through specific databases. These resources encompass domain names, blocks of IP addresses, and autonomous systems, among others. Beyond these, the protocol finds application in accessing a broader spectrum of information.


https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-smtp/index.html

Entry_2:
Name: Banner Grab
Description: Grab WHOIS Banner
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43
```
{{#include ../banners/hacktricks-training.md}}
