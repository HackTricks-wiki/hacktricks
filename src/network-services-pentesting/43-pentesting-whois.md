# 43 - Pentesting WHOIS

{{#include ../banners/hacktricks-training.md}}

## Podstawowe informacje

Protokół **WHOIS** służy jako standardowa metoda **zapytania o rejestrujących lub posiadaczy różnych zasobów Internetu** za pośrednictwem określonych baz danych. Zasoby te obejmują nazwy domen, bloki adresów IP oraz systemy autonomiczne, między innymi. Poza tym protokół znajduje zastosowanie w uzyskiwaniu szerszego zakresu informacji.

**Domyślny port:** 43
```
PORT   STATE  SERVICE
43/tcp open   whois?
```
## Enumeracja

Uzyskaj wszystkie informacje, które usługa whois ma na temat domeny:
```bash
whois -h <HOST> -p <PORT> "domain.tld"
echo "domain.ltd" | nc -vn <HOST> <PORT>
```
Zauważ, że czasami, gdy żąda się informacji z usługi WHOIS, w odpowiedzi pojawia się używana baza danych:

![](<../images/image (301).png>)

Usługa WHOIS zawsze musi korzystać z **bazy danych** do przechowywania i wydobywania informacji. Dlatego możliwe, że występuje **SQLInjection**, gdy **zapytujesz** bazę danych o informacje podane przez użytkownika. Na przykład wykonując: `whois -h 10.10.10.155 -p 43 "a') or 1=1#"` możesz być w stanie **wyodrębnić wszystkie** **informacje** zapisane w bazie danych.

## Shodan

- `port:43 whois`

## HackTricks Automatic Commands
```
Protocol_Name: WHOIS    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: WHOIS         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for WHOIS
Note: |
The WHOIS protocol serves as a standard method for inquiring about the registrants or holders of various Internet resources through specific databases. These resources encompass domain names, blocks of IP addresses, and autonomous systems, among others. Beyond these, the protocol finds application in accessing a broader spectrum of information.


https://book.hacktricks.xyz/pentesting/pentesting-smtp

Entry_2:
Name: Banner Grab
Description: Grab WHOIS Banner
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43
```
{{#include ../banners/hacktricks-training.md}}
