# 43 - Pentesting WHOIS

{{#include ../banners/hacktricks-training.md}}

## Основна інформація

Протокол **WHOIS** слугує стандартним методом для **запитів про реєстраторів або власників різних Інтернет-ресурсів** через специфічні бази даних. Ці ресурси охоплюють доменні імена, блоки IP-адрес та автономні системи, серед інших. Крім цього, протокол знаходить застосування для доступу до більш широкого спектру інформації.

**Порт за замовчуванням:** 43
```
PORT   STATE  SERVICE
43/tcp open   whois?
```
## Перерахунок

Отримайте всю інформацію, яку сервіс whois має про домен:
```bash
whois -h <HOST> -p <PORT> "domain.tld"
echo "domain.ltd" | nc -vn <HOST> <PORT>
```
Зверніть увагу, що іноді, запитуючи інформацію у служби WHOIS, база даних, що використовується, з'являється у відповіді:

![](<../images/image (301).png>)

Крім того, служба WHOIS завжди повинна використовувати **базу даних** для зберігання та витягування інформації. Отже, можливий **SQLInjection** може бути присутнім при **запиті** бази даних на основі інформації, наданої користувачем. Наприклад, виконавши: `whois -h 10.10.10.155 -p 43 "a') or 1=1#"` ви зможете **витягнути всі** **дані**, збережені в базі даних.

## Shodan

- `port:43 whois`

## HackTricks Automatic Commands
```
Protocol_Name: WHOIS    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: WHOIS         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for WHOIS
Note: |
The WHOIS protocol serves as a standard method for inquiring about the registrants or holders of various Internet resources through specific databases. These resources encompass domain names, blocks of IP addresses, and autonomous systems, among others. Beyond these, the protocol finds application in accessing a broader spectrum of information.


https://book.hacktricks.xyz/pentesting/pentesting-smtp

Entry_2:
Name: Banner Grab
Description: Grab WHOIS Banner
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43
```
{{#include ../banners/hacktricks-training.md}}
