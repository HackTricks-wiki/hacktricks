# 43 - Pentesting WHOIS

{{#include ../banners/hacktricks-training.md}}

## Grundlegende Informationen

Das **WHOIS**-Protokoll dient als Standardmethode zur **Anfrage über die Registranten oder Inhaber verschiedener Internetressourcen** über spezifische Datenbanken. Diese Ressourcen umfassen Domainnamen, IP-Adressblöcke und autonome Systeme, unter anderem. Darüber hinaus findet das Protokoll Anwendung beim Zugriff auf ein breiteres Spektrum an Informationen.

**Standardport:** 43
```
PORT   STATE  SERVICE
43/tcp open   whois?
```
## Auflisten

Holen Sie sich alle Informationen, die ein Whois-Dienst über eine Domain hat:
```bash
whois -h <HOST> -p <PORT> "domain.tld"
echo "domain.ltd" | nc -vn <HOST> <PORT>
```
Beachten Sie, dass manchmal bei der Anfrage nach Informationen von einem WHOIS-Dienst die verwendete Datenbank in der Antwort erscheint:

![](<../images/image (301).png>)

Außerdem muss der WHOIS-Dienst immer eine **Datenbank** verwenden, um die Informationen zu speichern und abzurufen. Daher könnte eine mögliche **SQLInjection** vorhanden sein, wenn die **Abfrage** der Datenbank mit Informationen erfolgt, die vom Benutzer bereitgestellt werden. Zum Beispiel durch Ausführen von: `whois -h 10.10.10.155 -p 43 "a') or 1=1#"` könnten Sie in der Lage sein, **alle** **Informationen** abzurufen, die in der Datenbank gespeichert sind.

## Shodan

- `port:43 whois`

## HackTricks Automatische Befehle
```
Protocol_Name: WHOIS    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: WHOIS         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for WHOIS
Note: |
The WHOIS protocol serves as a standard method for inquiring about the registrants or holders of various Internet resources through specific databases. These resources encompass domain names, blocks of IP addresses, and autonomous systems, among others. Beyond these, the protocol finds application in accessing a broader spectrum of information.


https://book.hacktricks.xyz/pentesting/pentesting-smtp

Entry_2:
Name: Banner Grab
Description: Grab WHOIS Banner
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43
```
{{#include ../banners/hacktricks-training.md}}
