# 43 - Pentesting WHOIS

{{#include ../banners/hacktricks-training.md}}

## 기본 정보

**WHOIS** 프로토콜은 특정 데이터베이스를 통해 **다양한 인터넷 자원의 등록자 또는 소유자에 대한 문의를 위한 표준 방법**으로 사용됩니다. 이러한 자원에는 도메인 이름, IP 주소 블록 및 자율 시스템 등이 포함됩니다. 이 외에도, 이 프로토콜은 더 넓은 범위의 정보에 접근하는 데 사용됩니다.

**기본 포트:** 43
```
PORT   STATE  SERVICE
43/tcp open   whois?
```
## Enumerate

도메인에 대한 whois 서비스가 가진 모든 정보를 가져옵니다:
```bash
whois -h <HOST> -p <PORT> "domain.tld"
echo "domain.ltd" | nc -vn <HOST> <PORT>
```
WHOIS 서비스에 정보를 요청할 때 사용되는 데이터베이스가 응답에 나타나는 경우가 있습니다:

![](<../images/image (301).png>)

또한, WHOIS 서비스는 항상 정보를 저장하고 추출하기 위해 **데이터베이스**를 사용해야 합니다. 따라서 사용자가 제공한 정보로 **데이터베이스**를 **쿼리**할 때 **SQLInjection**이 발생할 수 있습니다. 예를 들어 `whois -h 10.10.10.155 -p 43 "a') or 1=1#"`를 실행하면 **데이터베이스**에 저장된 **모든 정보**를 **추출**할 수 있습니다.

## Shodan

- `port:43 whois`

## HackTricks Automatic Commands
```
Protocol_Name: WHOIS    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: WHOIS         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for WHOIS
Note: |
The WHOIS protocol serves as a standard method for inquiring about the registrants or holders of various Internet resources through specific databases. These resources encompass domain names, blocks of IP addresses, and autonomous systems, among others. Beyond these, the protocol finds application in accessing a broader spectrum of information.


https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-smtp/index.html

Entry_2:
Name: Banner Grab
Description: Grab WHOIS Banner
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43
```
{{#include ../banners/hacktricks-training.md}}
