# 43 - Pentesting WHOIS

{{#include ../banners/hacktricks-training.md}}

## Temel Bilgiler

**WHOIS** protokolü, belirli veritabanları aracılığıyla **çeşitli İnternet kaynaklarının kayıtlı sahipleri veya tutucuları hakkında sorgulama yapmak için standart bir yöntem** olarak hizmet eder. Bu kaynaklar, alan adları, IP adresi blokları ve otonom sistemler gibi unsurları kapsar. Bunların ötesinde, protokol daha geniş bir bilgi yelpazesine erişimde de uygulanır.

**Varsayılan port:** 43
```
PORT   STATE  SERVICE
43/tcp open   whois?
```
## Enumerate

Bir whois hizmetinin bir alan adı hakkında sahip olduğu tüm bilgileri alın:
```bash
whois -h <HOST> -p <PORT> "domain.tld"
echo "domain.ltd" | nc -vn <HOST> <PORT>
```
Dikkat edin ki bazen bir WHOIS hizmetinden bazı bilgiler talep ettiğinizde kullanılan veritabanı yanıt içinde görünebilir:

![](<../images/image (301).png>)

Ayrıca, WHOIS hizmeti her zaman bilgileri depolamak ve çıkarmak için bir **veritabanı** kullanmak zorundadır. Bu nedenle, kullanıcının sağladığı bazı bilgilerden veritabanını **sorgularken** olası bir **SQLInjection** mevcut olabilir. Örneğin `whois -h 10.10.10.155 -p 43 "a') or 1=1#"` yazarak veritabanında kaydedilen **tüm** **bilgileri** **çıkartabilirsiniz**.

## Shodan

- `port:43 whois`

## HackTricks Otomatik Komutlar
```
Protocol_Name: WHOIS    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: WHOIS         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for WHOIS
Note: |
The WHOIS protocol serves as a standard method for inquiring about the registrants or holders of various Internet resources through specific databases. These resources encompass domain names, blocks of IP addresses, and autonomous systems, among others. Beyond these, the protocol finds application in accessing a broader spectrum of information.


https://book.hacktricks.xyz/pentesting/pentesting-smtp

Entry_2:
Name: Banner Grab
Description: Grab WHOIS Banner
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43
```
{{#include ../banners/hacktricks-training.md}}
