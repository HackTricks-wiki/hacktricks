# 43 - Pentesting WHOIS

{{#include ../banners/hacktricks-training.md}}

## 基本信息

**WHOIS** 协议作为一种标准方法，用于 **查询各种互联网资源的注册人或持有者**，通过特定的数据库。这些资源包括域名、IP地址块和自治系统等。除此之外，该协议还可用于访问更广泛的信息。

**默认端口：** 43
```
PORT   STATE  SERVICE
43/tcp open   whois?
```
## 枚举

获取 whois 服务关于一个域名的所有信息：
```bash
whois -h <HOST> -p <PORT> "domain.tld"
echo "domain.ltd" | nc -vn <HOST> <PORT>
```
注意，有时在请求WHOIS服务的信息时，所使用的数据库会出现在响应中：

![](<../images/image (301).png>)

此外，WHOIS服务始终需要使用一个**数据库**来存储和提取信息。因此，当**查询**用户提供的一些信息时，可能会存在**SQL注入**的风险。例如，执行：`whois -h 10.10.10.155 -p 43 "a') or 1=1#"`，你可能能够**提取所有**存储在数据库中的**信息**。

## Shodan

- `port:43 whois`

## HackTricks 自动命令
```
Protocol_Name: WHOIS    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: WHOIS         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for WHOIS
Note: |
The WHOIS protocol serves as a standard method for inquiring about the registrants or holders of various Internet resources through specific databases. These resources encompass domain names, blocks of IP addresses, and autonomous systems, among others. Beyond these, the protocol finds application in accessing a broader spectrum of information.


https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-smtp/index.html

Entry_2:
Name: Banner Grab
Description: Grab WHOIS Banner
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43
```
{{#include ../banners/hacktricks-training.md}}
