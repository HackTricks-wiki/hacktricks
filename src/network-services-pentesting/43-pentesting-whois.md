# 43 - Pentesting WHOIS

{{#include ../banners/hacktricks-training.md}}

## Informations de base

Le protocole **WHOIS** sert de méthode standard pour **interroger les titulaires ou détenteurs de diverses ressources Internet** via des bases de données spécifiques. Ces ressources comprennent des noms de domaine, des blocs d'adresses IP et des systèmes autonomes, entre autres. Au-delà de cela, le protocole trouve application dans l'accès à un éventail plus large d'informations.

**Port par défaut :** 43
```
PORT   STATE  SERVICE
43/tcp open   whois?
```
## Énumérer

Obtenez toutes les informations qu'un service whois a sur un domaine :
```bash
whois -h <HOST> -p <PORT> "domain.tld"
echo "domain.ltd" | nc -vn <HOST> <PORT>
```
Remarquez que parfois, lors de la demande d'informations à un service WHOIS, la base de données utilisée apparaît dans la réponse :

![](<../images/image (301).png>)

De plus, le service WHOIS doit toujours utiliser une **base de données** pour stocker et extraire les informations. Ainsi, une possible **SQLInjection** pourrait être présente lors de la **requête** de la base de données à partir de certaines informations fournies par l'utilisateur. Par exemple, en faisant : `whois -h 10.10.10.155 -p 43 "a') or 1=1#"` vous pourriez être en mesure d'**extraire toutes** les **informations** enregistrées dans la base de données.

## Shodan

- `port:43 whois`

## HackTricks Commandes Automatiques
```
Protocol_Name: WHOIS    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: WHOIS         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for WHOIS
Note: |
The WHOIS protocol serves as a standard method for inquiring about the registrants or holders of various Internet resources through specific databases. These resources encompass domain names, blocks of IP addresses, and autonomous systems, among others. Beyond these, the protocol finds application in accessing a broader spectrum of information.


https://book.hacktricks.xyz/pentesting/pentesting-smtp

Entry_2:
Name: Banner Grab
Description: Grab WHOIS Banner
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43
```
{{#include ../banners/hacktricks-training.md}}
