# Cisco SNMP

{{#include ../../banners/hacktricks-training.md}}

## Ciscoネットワークのペンテスト

**SNMP**は、一般的なメッセージ用にポート161/UDP、トラップメッセージ用にポート162/UDPでUDP上で機能します。このプロトコルはコミュニティ文字列に依存しており、SNMPエージェントとサーバー間の通信を可能にするパスワードとして機能します。これらの文字列はアクセスレベルを決定するため、特に**読み取り専用（RO）または読み書き（RW）権限**において重要です。ペンテスターにとっての注目すべき攻撃ベクターは、**コミュニティ文字列のブルートフォース攻撃**であり、ネットワークデバイスに侵入することを目的としています。

このようなブルートフォース攻撃を実行するための実用的なツールは[**onesixtyone**](https://github.com/trailofbits/onesixtyone)であり、潜在的なコミュニティ文字列のリストとターゲットのIPアドレスが必要です。
```bash
onesixtyone -c communitystrings -i targets
```
#### `cisco_config_tftp`

Metasploitフレームワークには、デバイスの設定を抽出するための`cisco_config_tftp`モジュールがあり、RWコミュニティ文字列の取得に依存しています。この操作に必要な重要なパラメータは次のとおりです：

- RWコミュニティ文字列 (**COMMUNITY**)
- 攻撃者のIP (**LHOST**)
- ターゲットデバイスのIP (**RHOSTS**)
- 設定ファイルの保存先パス (**OUTPUTDIR**)

設定が完了すると、このモジュールはデバイスの設定を指定されたフォルダーに直接ダウンロードすることを可能にします。

#### `snmp_enum`

別のMetasploitモジュールである**`snmp_enum`**は、詳細なハードウェア情報を収集することに特化しています。これは、いずれかのタイプのコミュニティ文字列で動作し、成功裏に実行するためにはターゲットのIPアドレスが必要です：
```bash
msf6 auxiliary(scanner/snmp/snmp_enum) > set COMMUNITY public
msf6 auxiliary(scanner/snmp/snmp_enum) > set RHOSTS 10.10.100.10
msf6 auxiliary(scanner/snmp/snmp_enum) > exploit
```
## 参考文献

- [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)


{{#include ../../banners/hacktricks-training.md}}
