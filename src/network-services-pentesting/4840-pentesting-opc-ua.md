# 4840 - Pentesting OPC UA

{{#include ../banners/hacktricks-training.md}}

## Temel Bilgiler

**OPC UA**, yani **Açık Platform İletişim Birleşik Erişim**, veri alışverişi ve ekipman kontrolü için Üretim, Enerji, Havacılık ve Savunma gibi çeşitli endüstrilerde kullanılan önemli bir açık kaynak protokoldür. Farklı satıcıların ekipmanlarının, özellikle PLC'lerle iletişim kurmasını benzersiz bir şekilde sağlar.

Yapılandırması güçlü güvenlik önlemlerine olanak tanır, ancak genellikle eski cihazlarla uyumluluk için bunlar azaltılır ve sistemleri risklere maruz bırakır. Ayrıca, OPC UA hizmetlerini bulmak zor olabilir çünkü ağ tarayıcıları, standart dışı portlarda olduklarında bunları tespit edemeyebilir.

**Varsayılan port:** 4840
```text
PORT     STATE SERVICE REASON
4840/tcp open  unknown syn-ack
```
## Pentesting OPC UA

OPC UA sunucularındaki güvenlik sorunlarını ortaya çıkarmak için [OpalOPC](https://opalopc.com/) ile tarayın.
```bash
opalopc -vv opc.tcp://$target_ip_or_hostname:$target_port
```
### Açıkların Sömürülmesi

Eğer kimlik doğrulama atlama açıkları bulunursa, buna göre bir [OPC UA client](https://www.prosysopc.com/products/opc-ua-browser/) yapılandırabilir ve neye erişebileceğinizi görebilirsiniz. Bu, yalnızca süreç değerlerini okumaktan ağır sanayi ekipmanlarını çalıştırmaya kadar her şeyi mümkün kılabilir.

Erişim sağladığınız cihaz hakkında bir ipucu almak için, adres alanındaki "ServerStatus" düğüm değerlerini okuyun ve bir kullanım kılavuzu için Google'da arama yapın.

## Shodan

- `port:4840`

## Referanslar

- [https://opalopc.com/how-to-hack-opc-ua/](https://opalopc.com/how-to-hack-opc-ua/)


{{#include ../banners/hacktricks-training.md}}
