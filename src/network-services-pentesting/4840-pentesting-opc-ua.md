# 4840 - Pentesting OPC UA

{{#include ../banners/hacktricks-training.md}}

<figure><img src="/images/pentest-tools.svg" alt=""><figcaption></figcaption></figure>

**从黑客的角度看待您的网络应用、网络和云**

**查找并报告具有实际业务影响的关键可利用漏洞。** 使用我们20多个自定义工具来映射攻击面，发现让您提升权限的安全问题，并使用自动化利用收集重要证据，将您的辛勤工作转化为有说服力的报告。

{% embed url="https://pentest-tools.com/?utm_term=jul2024&utm_medium=link&utm_source=hacktricks&utm_campaign=spons" %}

## 基本信息

**OPC UA**，即**开放平台通信统一访问**，是一个在制造、能源、航空航天和国防等多个行业中用于数据交换和设备控制的重要开源协议。它独特地使不同供应商的设备能够进行通信，特别是与PLC的通信。

其配置允许强大的安全措施，但通常为了与旧设备的兼容性，这些措施会减弱，从而使系统面临风险。此外，查找OPC UA服务可能很棘手，因为网络扫描仪可能无法检测到它们，如果它们位于非标准端口上。

**默认端口：** 4840
```text
PORT     STATE SERVICE REASON
4840/tcp open  unknown syn-ack
```
## Pentesting OPC UA

要揭示OPC UA服务器中的安全问题，请使用[OpalOPC](https://opalopc.com/)进行扫描。
```bash
opalopc -vv opc.tcp://$target_ip_or_hostname:$target_port
```
### 利用漏洞

如果发现身份验证绕过漏洞，您可以相应地配置一个 [OPC UA client](https://www.prosysopc.com/products/opc-ua-browser/)，并查看您可以访问的内容。这可能允许从仅仅读取过程值到实际操作重型工业设备的任何事情。

要获取您可以访问的设备的线索，请读取地址空间中的 "ServerStatus" 节点值，并在谷歌上搜索使用手册。

## Shodan

- `port:4840`

## 参考

- [https://opalopc.com/how-to-hack-opc-ua/](https://opalopc.com/how-to-hack-opc-ua/)

<figure><img src="/images/pentest-tools.svg" alt=""><figcaption></figcaption></figure>

**从黑客的角度看待您的网络应用、网络和云**

**查找并报告具有实际商业影响的关键可利用漏洞。** 使用我们 20 多个自定义工具来映射攻击面，查找让您提升权限的安全问题，并使用自动化漏洞收集重要证据，将您的辛勤工作转化为有说服力的报告。

{% embed url="https://pentest-tools.com/?utm_term=jul2024&utm_medium=link&utm_source=hacktricks&utm_campaign=spons" %}

{{#include ../banners/hacktricks-training.md}}
