# 4840 - Pentesting OPC UA

{{#include ../banners/hacktricks-training.md}}

<figure><img src="/images/pentest-tools.svg" alt=""><figcaption></figcaption></figure>

**Erhalten Sie die Perspektive eines Hackers auf Ihre Webanwendungen, Ihr Netzwerk und die Cloud**

**Finden und melden Sie kritische, ausnutzbare Schwachstellen mit echtem Geschäftsauswirkungen.** Verwenden Sie unsere 20+ benutzerdefinierten Tools, um die Angriffsfläche zu kartieren, Sicherheitsprobleme zu finden, die Ihnen ermöglichen, Privilegien zu eskalieren, und nutzen Sie automatisierte Exploits, um wesentliche Beweise zu sammeln, die Ihre harte Arbeit in überzeugende Berichte verwandeln.

{% embed url="https://pentest-tools.com/?utm_term=jul2024&utm_medium=link&utm_source=hacktricks&utm_campaign=spons" %}

## Grundinformationen

**OPC UA**, was für **Open Platform Communications Unified Access** steht, ist ein entscheidendes Open-Source-Protokoll, das in verschiedenen Branchen wie Fertigung, Energie, Luft- und Raumfahrt sowie Verteidigung für den Datenaustausch und die Steuerung von Geräten verwendet wird. Es ermöglicht einzigartig die Kommunikation von Geräten verschiedener Anbieter, insbesondere mit SPS.

Seine Konfiguration ermöglicht starke Sicherheitsmaßnahmen, aber oft werden diese zur Kompatibilität mit älteren Geräten verringert, was Systeme Risiken aussetzt. Darüber hinaus kann es schwierig sein, OPC UA-Dienste zu finden, da Netzwerkscanner sie möglicherweise nicht erkennen, wenn sie auf nichtstandardmäßigen Ports sind.

**Standardport:** 4840
```text
PORT     STATE SERVICE REASON
4840/tcp open  unknown syn-ack
```
## Pentesting OPC UA

Um Sicherheitsprobleme in OPC UA-Servern aufzudecken, scannen Sie sie mit [OpalOPC](https://opalopc.com/).
```bash
opalopc -vv opc.tcp://$target_ip_or_hostname:$target_port
```
### Ausnutzen von Schwachstellen

Wenn Authentifizierungsumgehungsschwachstellen gefunden werden, können Sie einen [OPC UA-Client](https://www.prosysopc.com/products/opc-ua-browser/) entsprechend konfigurieren und sehen, auf was Sie zugreifen können. Dies kann alles ermöglichen, von der bloßen Anzeige von Prozesswerten bis hin zur tatsächlichen Bedienung von schweren Industrieanlagen.

Um einen Hinweis auf das Gerät zu erhalten, auf das Sie Zugriff haben, lesen Sie die "ServerStatus"-Knotenwerte im Adressraum und suchen Sie nach einem Benutzerhandbuch.

## Shodan

- `port:4840`

## Referenzen

- [https://opalopc.com/how-to-hack-opc-ua/](https://opalopc.com/how-to-hack-opc-ua/)

<figure><img src="/images/pentest-tools.svg" alt=""><figcaption></figcaption></figure>

**Erhalten Sie die Perspektive eines Hackers auf Ihre Webanwendungen, Ihr Netzwerk und Ihre Cloud**

**Finden und melden Sie kritische, ausnutzbare Schwachstellen mit echtem Geschäftsauswirkungen.** Verwenden Sie unsere 20+ benutzerdefinierten Tools, um die Angriffsfläche zu kartieren, Sicherheitsprobleme zu finden, die Ihnen ermöglichen, Berechtigungen zu eskalieren, und nutzen Sie automatisierte Exploits, um wesentliche Beweise zu sammeln, und verwandeln Sie Ihre harte Arbeit in überzeugende Berichte.

{% embed url="https://pentest-tools.com/?utm_term=jul2024&utm_medium=link&utm_source=hacktricks&utm_campaign=spons" %}

{{#include ../banners/hacktricks-training.md}}
