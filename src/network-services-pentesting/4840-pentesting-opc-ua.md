# 4840 - Pentesting OPC UA

{{#include ../banners/hacktricks-training.md}}

## Informações Básicas

**OPC UA**, que significa **Open Platform Communications Unified Access**, é um protocolo de código aberto crucial utilizado em várias indústrias como Manufatura, Energia, Aeroespacial e Defesa para troca de dados e controle de equipamentos. Ele permite de forma única que equipamentos de diferentes fornecedores se comuniquem, especialmente com PLCs.

Sua configuração permite medidas de segurança robustas, mas muitas vezes, para compatibilidade com dispositivos mais antigos, essas medidas são reduzidas, expondo os sistemas a riscos. Além disso, encontrar serviços OPC UA pode ser complicado, uma vez que scanners de rede podem não detectá-los se estiverem em portas não padrão.

**Porta padrão:** 4840
```text
PORT     STATE SERVICE REASON
4840/tcp open  unknown syn-ack
```
## Pentesting OPC UA

Para revelar problemas de segurança em servidores OPC UA, escaneie-os com [OpalOPC](https://opalopc.com/).
```bash
opalopc -vv opc.tcp://$target_ip_or_hostname:$target_port
```
### Explorando vulnerabilidades

Se vulnerabilidades de bypass de autenticação forem encontradas, você pode configurar um [OPC UA client](https://www.prosysopc.com/products/opc-ua-browser/) de acordo e ver o que pode acessar. Isso pode permitir desde apenas ler valores de processo até realmente operar equipamentos industriais pesados.

Para ter uma ideia do dispositivo ao qual você tem acesso, leia os valores do nó "ServerStatus" no espaço de endereços e pesquise um manual de uso.

## Shodan

- `port:4840`

## Referências

- [https://opalopc.com/how-to-hack-opc-ua/](https://opalopc.com/how-to-hack-opc-ua/)


{{#include ../banners/hacktricks-training.md}}
