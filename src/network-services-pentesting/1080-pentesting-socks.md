# 1080 - Pentesting Socks

{{#include ../banners/hacktricks-training.md}}

## Temel Bilgiler

**SOCKS** bir proxy üzerinden bir client ile server arasında veri aktarımı için kullanılan bir protokoldür. Beşinci sürümü, **SOCKS5**, isteğe bağlı bir kimlik doğrulama özelliği ekleyerek yalnızca yetkili kullanıcıların sunucuya erişmesine izin verir. Temelde TCP bağlantılarının proxylenmesi ve UDP paketlerinin iletilmesi (via the `UDP ASSOCIATE` command) ile ilgilenir ve OSI modelinin session layer (Layer 5) katmanında çalışır. Araçlar `socks5h` şemasını desteklediğinde, DNS çözümlemesi proxy üzerinden zorlanır; bu, yerel DNS leak'lerini önler ve kaynak host'un parmak izini çıkarmayı zorlaştırır.

**Varsayılan Port:** 1080

## Enumerasyon

### Kimlik Doğrulama Kontrolü
```bash
nmap -p 1080 <ip> --script socks-auth-info
```
### Brute Force

#### Temel kullanım
```bash
nmap --script socks-brute -p 1080 <ip>
```
#### Gelişmiş kullanım
```bash
nmap  --script socks-brute --script-args userdb=users.txt,passdb=rockyou.txt,unpwdb.timelimit=30m -p 1080 <ip>
```
#### Çıktı
```
PORT     STATE SERVICE
1080/tcp open  socks
| socks-brute:
|   Accounts
|     patrik:12345 - Valid credentials
|   Statistics
|_    Performed 1921 guesses in 6 seconds, average tps: 320
```
#### Hydra modülü
```bash
hydra -L users.txt -P passwords.txt -s 1080 -t 16 -V <ip> socks5
```
### Yöntem & open-proxy enumeration
```bash
nmap -sV --script socks-methods,socks-open-proxy -p 1080 <ip>
```
`socks-methods` sunucunun desteklenen kimlik doğrulama türlerini listelemesini zorlar, `socks-open-proxy` ise servisin bir relay olarak kötüye kullanılıp kullanılamayacağını doğrulamak için outbound CONNECT denemesi yapar.

#### Raw handshake check
```bash
printf '\x05\x01\x00' | nc -nv <ip> 1080
```
A `\x05 01 00` yanıtı SOCKS5'in "no authentication" sunduğunu gösterir. Herhangi bir `\x00`'ı takiben gelen `\x02` username/password gerektiğini belirtir; bu, exposed cihazları scripts içinde hızlıca fingerprinting için kullanışlıdır.

### Hızlı egress doğrulaması
```bash
curl --socks5-hostname <ip>:1080 https://ifconfig.me
curl --socks5-hostname user:pass@<ip>:1080 http://internal.target
```
DNS çözümlemesinin uzaktan gerçekleşmesi için `--socks5-hostname` (veya `socks5h://` URL'leri) kullanın. Bunu `proxychains4 -q nmap -sT -Pn --top-ports 200 <internal-host>` ile eşleştirerek proxy'nin gerçekten iç ağa erişim sağlayıp sağlamadığını doğrulayın.

### İnternet çapında keşif / fingerprinting
```bash
masscan 0.0.0.0/0 -p1080 --banners --rate 100000 -oX socks.xml
```
Sonuçları NSE, `zgrab2` veya özel python script'lerine geri besleyerek umut vadeden hostları önceliklendirin (ör. `3proxy`, `Dante`, `MikroTik` gibi banner stringleri).

## Tunneling and Port Forwarding

Tunneling ve post forwarding hakkında bilgi için şu sayfayı inceleyin: [Tunneling and Port Forwarding](../generic-hacking/tunneling-and-port-forwarding.md)

## Kaynaklar

- [Use a SOCKS5 Proxy to Access the Kubernetes API (Kubernetes Docs, 2024)](https://kubernetes.io/docs/tasks/extend-kubernetes/socks5-proxy-access-api)

{{#include ../banners/hacktricks-training.md}}
