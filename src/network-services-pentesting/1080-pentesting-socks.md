# 1080 - Pentesting Socks

{{#include ../banners/hacktricks-training.md}}

## Osnovne informacije

**SOCKS** je protokol koji se koristi za prenos podataka između klijenta i servera preko proxy-ja. Peta verzija, **SOCKS5**, dodaje opcionu funkciju autentifikacije, omogućavajući pristup serveru samo autorizovanim korisnicima. Pretežno se bavi proxy-ovanjem TCP konekcija i prosleđivanjem UDP paketa (putem `UDP ASSOCIATE` komande), radeći na sesijskom sloju (Layer 5) OSI modela. Kada alati podržavaju `socks5h` šemu, DNS rezolucija se forsira kroz proxy, sprečavajući lokalne DNS leaks i otežavajući fingerprinting izvornog hosta.

**Podrazumevani port:** 1080

## Enumeracija

### Provera autentifikacije
```bash
nmap -p 1080 <ip> --script socks-auth-info
```
### Brute Force

#### Osnovna upotreba
```bash
nmap --script socks-brute -p 1080 <ip>
```
#### Napredna upotreba
```bash
nmap  --script socks-brute --script-args userdb=users.txt,passdb=rockyou.txt,unpwdb.timelimit=30m -p 1080 <ip>
```
#### Izlaz
```
PORT     STATE SERVICE
1080/tcp open  socks
| socks-brute:
|   Accounts
|     patrik:12345 - Valid credentials
|   Statistics
|_    Performed 1921 guesses in 6 seconds, average tps: 320
```
#### Hydra modul
```bash
hydra -L users.txt -P passwords.txt -s 1080 -t 16 -V <ip> socks5
```
### Metoda & open-proxy enumeracija
```bash
nmap -sV --script socks-methods,socks-open-proxy -p 1080 <ip>
```
`socks-methods` prisiljava server da navede podržane tipove autentifikacije, dok `socks-open-proxy` pokušava outbound CONNECT da potvrdi da li se servis može zloupotrebiti kao relay.

#### Provera raw handshake-a
```bash
printf '\x05\x01\x00' | nc -nv <ip> 1080
```
Odgovor `\x05 01 00` označava da SOCKS5 nudi "no authentication". Svaki `\x00` praćen `\x02` znači da je potrebna username/password autentifikacija, što je korisno za brzo fingerprinting izloženih uređaja u scripts.

### Brza provera odlaznog saobraćaja
```bash
curl --socks5-hostname <ip>:1080 https://ifconfig.me
curl --socks5-hostname user:pass@<ip>:1080 http://internal.target
```
Koristite `--socks5-hostname` (ili `socks5h://` URL-ove) tako da DNS resolution bude izvršeno udaljeno. Uparite ga sa `proxychains4 -q nmap -sT -Pn --top-ports 200 <internal-host>` da biste proverili da li proxy zaista pruža internal reach.

### Otkriće širom Interneta / fingerprinting
```bash
masscan 0.0.0.0/0 -p1080 --banners --rate 100000 -oX socks.xml
```
Prosledite rezultate nazad u NSE, `zgrab2`, ili prilagođene python skripte kako biste dali prioritet obećavajućim hostovima (npr. banner strings kao `3proxy`, `Dante`, `MikroTik`).


## Tunneling and Port Forwarding

Za informacije o tunneling i post forwarding, pogledajte stranicu: [Tunneling and Port Forwarding](../generic-hacking/tunneling-and-port-forwarding.md)

## Reference

- [Use a SOCKS5 Proxy to Access the Kubernetes API (Kubernetes Docs, 2024)](https://kubernetes.io/docs/tasks/extend-kubernetes/socks5-proxy-access-api)

{{#include ../banners/hacktricks-training.md}}
