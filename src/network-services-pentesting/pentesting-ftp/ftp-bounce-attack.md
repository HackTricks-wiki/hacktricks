# FTP Bounce attack - Scan

{{#include ../../banners/hacktricks-training.md}}

## FTP Bounce - Scanning

### Manual

1. Συνδεθείτε σε ευάλωτο FTP
2. Χρησιμοποιήστε **`PORT`** ή **`EPRT`** (αλλά μόνο 1 από αυτά) για να δημιουργήσετε μια σύνδεση με το _\<IP:Port>_ που θέλετε να σαρώσετε:

`PORT 172,32,80,80,0,8080`\
`EPRT |2|172.32.80.80|8080|`

3. Χρησιμοποιήστε **`LIST`** (αυτό θα στείλει απλώς στη συνδεδεμένη _\<IP:Port>_ τη λίστα των τρεχουσών αρχείων στον φάκελο FTP) και ελέγξτε για τις πιθανές απαντήσεις: `150 File status okay` (Αυτό σημαίνει ότι η θύρα είναι ανοιχτή) ή `425 No connection established` (Αυτό σημαίνει ότι η θύρα είναι κλειστή)
1. Αντί για `LIST`, μπορείτε επίσης να χρησιμοποιήσετε **`RETR /file/in/ftp`** και να αναζητήσετε παρόμοιες απαντήσεις `Open/Close`.

Παράδειγμα Χρήσης **PORT** (η θύρα 8080 του 172.32.80.80 είναι ανοιχτή και η θύρα 7777 είναι κλειστή):

![](<../../images/image (241).png>)

Ίδιο παράδειγμα χρησιμοποιώντας **`EPRT`** (η αυθεντικοποίηση παραλείπεται στην εικόνα):

![](<../../images/image (539).png>)

Ανοιχτή θύρα χρησιμοποιώντας `EPRT` αντί για `LIST` (διαφορετικό περιβάλλον)

![](<../../images/image (875).png>)

### **nmap**
```bash
nmap -b <name>:<pass>@<ftp_server> <victim>
nmap -Pn -v -p 21,80 -b ftp:ftp@10.2.1.5 127.0.0.1 #Scan ports 21,80 of the FTP
nmap -v -p 21,22,445,80,443 -b ftp:ftp@10.2.1.5 192.168.0.1/24 #Scan the internal network (of the FTP) ports 21,22,445,80,443
```
{{#include ../../banners/hacktricks-training.md}}
