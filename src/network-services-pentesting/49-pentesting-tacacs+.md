# 49 - Pentesting TACACS+

{{#include ../banners/hacktricks-training.md}}

## Grundlegende Informationen

Das **Terminal Access Controller Access Control System (TACACS)**-Protokoll wird verwendet, um Benutzer, die versuchen, auf Router oder Network Access Servers (NAS) zuzugreifen, zentral zu validieren. Die aktualisierte Version, **TACACS+**, trennt die Dienste in Authentifizierung, Autorisierung und Abrechnung (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Standardport:** 49

## Authentifizierungsschlüssel abfangen

Wenn die Kommunikation zwischen dem Client und dem TACACS-Server von einem Angreifer abgefangen wird, kann der **verschlüsselte Authentifizierungsschlüssel abgefangen** werden. Der Angreifer kann dann versuchen, einen **lokalen Brute-Force-Angriff auf den Schlüssel durchzuführen, ohne in den Protokollen erkannt zu werden**. Wenn der Brute-Force-Angriff auf den Schlüssel erfolgreich ist, erhält der Angreifer Zugriff auf die Netzwerkausrüstung und kann den Datenverkehr mit Tools wie Wireshark entschlüsseln.

### Durchführung eines MitM-Angriffs

Ein **ARP-Spoofing-Angriff kann genutzt werden, um einen Man-in-the-Middle (MitM)-Angriff durchzuführen**.

### Brute-Forcing des Schlüssels

[Loki](https://c0decafe.de/svn/codename_loki/trunk/) kann verwendet werden, um den Schlüssel zu brute-forcen:
```
sudo loki_gtk.py
```
Wenn der Schlüssel erfolgreich **bruteforced** (**normalerweise im MD5-verschlüsselten Format**), **können wir auf die Geräte zugreifen und den TACACS-verschlüsselten Verkehr entschlüsseln.**

### Entschlüsselung des Verkehrs

Sobald der Schlüssel erfolgreich geknackt wurde, besteht der nächste Schritt darin, den **TACACS-verschlüsselten Verkehr zu entschlüsseln**. Wireshark kann verschlüsselten TACACS-Verkehr verarbeiten, wenn der Schlüssel bereitgestellt wird. Durch die Analyse des entschlüsselten Verkehrs können Informationen wie das **verwendete Banner und der Benutzername des Admin**-Benutzers gewonnen werden.

Durch den Zugriff auf das Kontrollpanel der Netzwerkgeräte mit den erhaltenen Anmeldeinformationen kann der Angreifer die Kontrolle über das Netzwerk ausüben. Es ist wichtig zu beachten, dass diese Aktionen ausschließlich zu Bildungszwecken durchgeführt werden und nicht ohne entsprechende Genehmigung verwendet werden sollten.

## Referenzen

- [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

{{#include ../banners/hacktricks-training.md}}
