# 49 - Pentesting TACACS+

{{#include ../banners/hacktricks-training.md}}

## Basic Information

Protokali ya **Terminal Access Controller Access Control System (TACACS)** inatumika kuthibitisha watumiaji kwa kati wanapojaribu kufikia routers au Network Access Servers (NAS). Toleo lake lililoboreshwa, **TACACS+**, linatenganisha huduma katika uthibitishaji, ruhusa, na uhasibu (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Default port:** 49

## Intercept Authentication Key

Ikiwa mawasiliano kati ya mteja na seva ya TACACS yanakatizwa na mshambuliaji, **ufunguo wa uthibitishaji uliosimbwa unaweza kukamatwa**. Mshambuliaji anaweza kisha kujaribu **shambulio la nguvu za ndani dhidi ya ufunguo bila kugundulika katika kumbukumbu**. Ikiwa atafanikiwa katika kujaribu nguvu ufunguo, mshambuliaji anapata ufikiaji wa vifaa vya mtandao na anaweza kufungua trafiki kwa kutumia zana kama Wireshark.

### Performing a MitM Attack

**Shambulio la ARP spoofing linaweza kutumika kufanya shambulio la Man-in-the-Middle (MitM)**.

### Brute-forcing the Key

[Loki](https://c0decafe.de/svn/codename_loki/trunk/) inaweza kutumika kujaribu nguvu ufunguo:
```
sudo loki_gtk.py
```
Ikiwa funguo imefanikiwa **bruteforced** (**kawaida katika muundo wa MD5 uliofichwa**), **tunaweza kufikia vifaa na kufichua trafiki iliyofichwa ya TACACS.**

### Kufichua Trafiki

Mara tu funguo inapofanikiwa kupasuliwa, hatua inayofuata ni **kufichua trafiki iliyofichwa ya TACACS**. Wireshark inaweza kushughulikia trafiki ya TACACS iliyofichwa ikiwa funguo itatolewa. Kwa kuchambua trafiki iliyofichuliwa, taarifa kama vile **bango lililotumika na jina la mtumiaji wa admin** inaweza kupatikana.

Kwa kupata ufikiaji wa paneli ya udhibiti ya vifaa vya mtandao kwa kutumia akidi zilizopatikana, mshambuliaji anaweza kudhibiti mtandao. Ni muhimu kutambua kwamba vitendo hivi ni kwa madhumuni ya kielimu tu na havipaswi kutumika bila idhini sahihi.

## Marejeleo

- [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

{{#include ../banners/hacktricks-training.md}}
