# 49 - Pentesting TACACS+

{{#include ../banners/hacktricks-training.md}}

## Informations de base

Le protocole **Terminal Access Controller Access Control System (TACACS)** est utilisé pour valider de manière centralisée les utilisateurs essayant d'accéder aux routeurs ou aux serveurs d'accès réseau (NAS). Sa version améliorée, **TACACS+**, sépare les services en authentification, autorisation et comptabilité (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Port par défaut :** 49

## Intercepter la clé d'authentification

Si la communication entre le client et le serveur TACACS est interceptée par un attaquant, la **clé d'authentification chiffrée peut être interceptée**. L'attaquant peut alors tenter une **attaque par force brute locale contre la clé sans être détecté dans les journaux**. S'il réussit à forcer la clé, l'attaquant obtient un accès à l'équipement réseau et peut déchiffrer le trafic en utilisant des outils comme Wireshark.

### Réaliser une attaque MitM

Une **attaque par spoofing ARP peut être utilisée pour réaliser une attaque de l'Homme du Milieu (MitM)**.

### Forcer la clé

[Loki](https://c0decafe.de/svn/codename_loki/trunk/) peut être utilisé pour forcer la clé :
```
sudo loki_gtk.py
```
Si la clé est **bruteforcée** avec succès (**généralement au format MD5**), **nous pouvons accéder à l'équipement et déchiffrer le trafic chiffré TACACS.**

### Déchiffrement du Trafic

Une fois la clé crackée avec succès, l'étape suivante consiste à **déchiffrer le trafic chiffré TACACS**. Wireshark peut gérer le trafic TACACS chiffré si la clé est fournie. En analysant le trafic déchiffré, des informations telles que le **bannière utilisée et le nom d'utilisateur de l'utilisateur admin** peuvent être obtenues.

En accédant au panneau de contrôle de l'équipement réseau en utilisant les identifiants obtenus, l'attaquant peut exercer un contrôle sur le réseau. Il est important de noter que ces actions sont strictement à des fins éducatives et ne doivent pas être utilisées sans autorisation appropriée.

## Références

- [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

{{#include ../banners/hacktricks-training.md}}
