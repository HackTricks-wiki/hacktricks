# 49 - Pentesting TACACS+

{{#include ../banners/hacktricks-training.md}}

## Basic Information

Το **Terminal Access Controller Access Control System (TACACS)** πρωτόκολλο χρησιμοποιείται για την κεντρική επικύρωση χρηστών που προσπαθούν να αποκτήσουν πρόσβαση σε δρομολογητές ή Διακομιστές Πρόσβασης Δικτύου (NAS). Η αναβαθμισμένη του έκδοση, **TACACS+**, διαχωρίζει τις υπηρεσίες σε επικύρωση, εξουσιοδότηση και λογιστική (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Default port:** 49

## Intercept Authentication Key

Αν η επικοινωνία του πελάτη και του TACACS server παρεμβληθεί από έναν επιτιθέμενο, το **κρυπτογραφημένο κλειδί αυθεντικοποίησης μπορεί να παρεμβληθεί**. Ο επιτιθέμενος μπορεί στη συνέχεια να προσπαθήσει μια **τοπική επίθεση brute-force κατά του κλειδιού χωρίς να ανιχνευθεί στα logs**. Αν είναι επιτυχής στην επίθεση brute-force του κλειδιού, ο επιτιθέμενος αποκτά πρόσβαση στον εξοπλισμό δικτύου και μπορεί να αποκρυπτογραφήσει την κίνηση χρησιμοποιώντας εργαλεία όπως το Wireshark.

### Performing a MitM Attack

Μια **επίθεση spoofing ARP μπορεί να χρησιμοποιηθεί για να εκτελέσει μια επίθεση Man-in-the-Middle (MitM)**.

### Brute-forcing the Key

[Loki](https://c0decafe.de/svn/codename_loki/trunk/) μπορεί να χρησιμοποιηθεί για να κάνει brute force το κλειδί:
```
sudo loki_gtk.py
```
Αν το κλειδί **σπάσει επιτυχώς** (**συνήθως σε κωδικοποιημένη μορφή MD5**), **μπορούμε να αποκτήσουμε πρόσβαση στον εξοπλισμό και να αποκωδικοποιήσουμε την TACACS-κωδικοποιημένη κίνηση.**

### Αποκωδικοποίηση Κίνησης

Αφού το κλειδί σπάσει επιτυχώς, το επόμενο βήμα είναι να **αποκωδικοποιήσουμε την TACACS-κωδικοποιημένη κίνηση**. Το Wireshark μπορεί να διαχειριστεί κωδικοποιημένη κίνηση TACACS αν το κλειδί παρέχεται. Αναλύοντας την αποκωδικοποιημένη κίνηση, μπορεί να αποκτηθεί πληροφορία όπως το **banner που χρησιμοποιείται και το όνομα χρήστη του admin**.

Αποκτώντας πρόσβαση στον πίνακα ελέγχου του δικτυακού εξοπλισμού χρησιμοποιώντας τα αποκτηθέντα διαπιστευτήρια, ο επιτιθέμενος μπορεί να ασκήσει έλεγχο στο δίκτυο. Είναι σημαντικό να σημειωθεί ότι αυτές οι ενέργειες προορίζονται αυστηρά για εκπαιδευτικούς σκοπούς και δεν θα πρέπει να χρησιμοποιούνται χωρίς την κατάλληλη εξουσιοδότηση.

## Αναφορές

- [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

{{#include ../banners/hacktricks-training.md}}
