# 49 - Pentesting TACACS+

{{#include ../banners/hacktricks-training.md}}

## Basic Information

Το **Terminal Access Controller Access Control System (TACACS)** πρωτόκολλο χρησιμοποιείται για την κεντρική επικύρωση χρηστών που προσπαθούν να αποκτήσουν πρόσβαση σε δρομολογητές ή Διακομιστές Πρόσβασης Δικτύου (NAS). Η αναβαθμισμένη του έκδοση, **TACACS+**, διαχωρίζει τις υπηρεσίες σε επικύρωση, εξουσιοδότηση και λογιστική (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Προεπιλεγμένη θύρα:** 49

## Παρεμπόδιση Κωδικού Αυθεντικοποίησης

Εάν η επικοινωνία του πελάτη και του διακομιστή TACACS παρεμποδιστεί από έναν επιτιθέμενο, ο **κωδικός αυθεντικοποίησης που έχει κρυπτογραφηθεί μπορεί να παρεμποδιστεί**. Ο επιτιθέμενος μπορεί στη συνέχεια να προσπαθήσει μια **τοπική επίθεση brute-force κατά του κωδικού χωρίς να ανιχνευθεί στα αρχεία καταγραφής**. Εάν είναι επιτυχής στην επίθεση brute-force του κωδικού, ο επιτιθέμενος αποκτά πρόσβαση στον εξοπλισμό δικτύου και μπορεί να αποκρυπτογραφήσει την κίνηση χρησιμοποιώντας εργαλεία όπως το Wireshark.

### Εκτέλεση Επίθεσης MitM

Μια **επίθεση spoofing ARP μπορεί να χρησιμοποιηθεί για την εκτέλεση μιας επίθεσης Man-in-the-Middle (MitM)**.

### Brute-forcing του Κωδικού

[Loki](https://c0decafe.de/svn/codename_loki/trunk/) μπορεί να χρησιμοποιηθεί για να κάνει brute force τον κωδικό:
```
sudo loki_gtk.py
```
Αν το κλειδί **bruteforced** (**συνήθως σε κωδικοποιημένη μορφή MD5**), **μπορούμε να αποκτήσουμε πρόσβαση στον εξοπλισμό και να αποκωδικοποιήσουμε την TACACS-κωδικοποιημένη κίνηση.**

### Αποκωδικοποίηση Κίνησης

Αφού το κλειδί αποκωδικοποιηθεί με επιτυχία, το επόμενο βήμα είναι να **αποκωδικοποιήσουμε την TACACS-κωδικοποιημένη κίνηση**. Το Wireshark μπορεί να διαχειριστεί κωδικοποιημένη κίνηση TACACS αν το κλειδί παρέχεται. Αναλύοντας την αποκωδικοποιημένη κίνηση, μπορεί να αποκτηθεί πληροφορία όπως το **banner που χρησιμοποιείται και το όνομα χρήστη του admin**.

Αποκτώντας πρόσβαση στον πίνακα ελέγχου του δικτυακού εξοπλισμού χρησιμοποιώντας τα αποκτηθέντα διαπιστευτήρια, ο επιτιθέμενος μπορεί να ασκήσει έλεγχο στο δίκτυο. Είναι σημαντικό να σημειωθεί ότι αυτές οι ενέργειες προορίζονται αυστηρά για εκπαιδευτικούς σκοπούς και δεν θα πρέπει να χρησιμοποιούνται χωρίς την κατάλληλη εξουσιοδότηση.

## Αναφορές

- [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

{{#include ../banners/hacktricks-training.md}}
