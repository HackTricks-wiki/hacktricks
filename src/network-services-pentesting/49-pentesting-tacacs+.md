# 49 - Pentesting TACACS+

{{#include ../banners/hacktricks-training.md}}

## Basiese Inligting

Die **Terminal Access Controller Access Control System (TACACS)** protokol word gebruik om gebruikers wat probeer om toegang tot roeters of Network Access Servers (NAS) te verkry, sentraal te valideer. Die opgegradeerde weergawe, **TACACS+**, skei die dienste in outentisering, magtiging en rekeningkunde (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Standaard poort:** 49

## Intercepteer Verifikasiesleutel

As die kliënt en TACACS-bediener kommunikasie deur 'n aanvaller geintercepteer word, kan die **versleutelde verifikasiesleutel geintercepteer word**. Die aanvaller kan dan 'n **lokale brute-force aanval teen die sleutel probeer sonder om in die logs opgespoor te word**. As die aanvaller daarin slaag om die sleutel te brute-force, verkry hy toegang tot die netwerktoerusting en kan die verkeer ontcijfer met behulp van gereedskap soos Wireshark.

### Uitvoering van 'n MitM-aanval

'n **ARP-spoofing-aanval kan gebruik word om 'n Man-in-the-Middle (MitM) aanval uit te voer**.

### Brute-forcing van die Sleutel

[Loki](https://c0decafe.de/svn/codename_loki/trunk/) kan gebruik word om die sleutel te brute-force:
```
sudo loki_gtk.py
```
As die sleutel suksesvol **bruteforced** is (**gewoonlik in MD5-enkripsie formaat**), **kan ons toegang tot die toerusting verkry en die TACACS-geënkripteerde verkeer ontsleutel.**

### Ontsleuteling van Verkeer

Sodra die sleutel suksesvol gekraak is, is die volgende stap om die **TACACS-geënkripteerde verkeer te ontsleutel**. Wireshark kan geënkripteerde TACACS-verkeer hanteer as die sleutel verskaf word. Deur die ontsleutelde verkeer te analiseer, kan inligting soos die **banner wat gebruik word en die gebruikersnaam van die admin** gebruiker verkry word.

Deur toegang tot die beheerpaneel van netwerktoerusting te verkry met die verkregen geloofsbriewe, kan die aanvaller beheer oor die netwerk uitoefen. Dit is belangrik om te noem dat hierdie aksies slegs vir opvoedkundige doeleindes is en nie sonder behoorlike magtiging gebruik moet word nie.

## Verwysings

- [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

{{#include ../banners/hacktricks-training.md}}
