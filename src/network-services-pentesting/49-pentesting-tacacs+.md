# 49 - Pentesting TACACS+

{{#include ../banners/hacktricks-training.md}}

## Temel Bilgiler

**Terminal Access Controller Access Control System (TACACS)** protokolü, yönlendiricilere veya Ağ Erişim Sunucularına (NAS) erişmeye çalışan kullanıcıları merkezi olarak doğrulamak için kullanılır. Geliştirilmiş versiyonu **TACACS+**, hizmetleri kimlik doğrulama, yetkilendirme ve muhasebe (AAA) olarak ayırır.
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Varsayılan port:** 49

## Kimlik Doğrulama Anahtarını Yakalama

Eğer istemci ve TACACS sunucusu arasındaki iletişim bir saldırgan tarafından kesilirse, **şifrelenmiş kimlik doğrulama anahtarı yakalanabilir**. Saldırgan daha sonra **anahtara karşı yerel bir brute-force saldırısı gerçekleştirmeyi deneyebilir ve bu, günlüklerde tespit edilmeden yapılabilir**. Anahtarı brute-force ile kırmayı başarırsa, saldırgan ağ ekipmanına erişim kazanır ve Wireshark gibi araçlar kullanarak trafiği şifreleyebilir.

### MitM Saldırısı Gerçekleştirme

**ARP sahtekarlığı saldırısı, Man-in-the-Middle (MitM) saldırısı gerçekleştirmek için kullanılabilir**.

### Anahtarı Brute-Force ile Kırma

[Loki](https://c0decafe.de/svn/codename_loki/trunk/) anahtarı brute force yapmak için kullanılabilir:
```
sudo loki_gtk.py
```
Eğer anahtar başarıyla **bruteforced** (**genellikle MD5 şifreli formatta**) olursa, **cihazlara erişebilir ve TACACS şifreli trafiği çözebiliriz.**

### Trafiği Çözme

Anahtar başarıyla kırıldıktan sonra, bir sonraki adım **TACACS şifreli trafiği çözmektir**. Wireshark, anahtar sağlandığında şifreli TACACS trafiğini işleyebilir. Çözülmüş trafiği analiz ederek, **kullanılan banner ve admin kullanıcısının kullanıcı adı** gibi bilgilere ulaşılabilir.

Elde edilen kimlik bilgileriyle ağ ekipmanının kontrol paneline erişim sağlandığında, saldırgan ağa hakimiyet kurabilir. Bu eylemlerin yalnızca eğitim amaçlı olduğunu ve uygun yetkilendirme olmadan kullanılmaması gerektiğini belirtmek önemlidir.

## Referanslar

- [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

{{#include ../banners/hacktricks-training.md}}
