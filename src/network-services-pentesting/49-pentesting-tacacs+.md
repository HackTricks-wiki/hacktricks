# 49 - Pentesting TACACS+

{{#include ../banners/hacktricks-training.md}}

## 기본 정보

**Terminal Access Controller Access Control System (TACACS)** 프로토콜은 라우터나 네트워크 접근 서버(NAS)에 접근하려는 사용자를 중앙에서 검증하는 데 사용됩니다. 업그레이드된 버전인 **TACACS+**는 서비스를 인증, 권한 부여 및 회계(AAA)로 분리합니다.
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**기본 포트:** 49

## 인증 키 가로채기

클라이언트와 TACACS 서버 간의 통신이 공격자에 의해 가로채어지면, **암호화된 인증 키가 가로채질 수 있습니다**. 공격자는 **로그에 감지되지 않고 키에 대해 로컬 브루트 포스 공격을 시도할 수 있습니다**. 키를 브루트 포스 공격하여 성공하면, 공격자는 네트워크 장비에 접근할 수 있으며 Wireshark와 같은 도구를 사용하여 트래픽을 복호화할 수 있습니다.

### MitM 공격 수행

**ARP 스푸핑 공격을 사용하여 중간자(MitM) 공격을 수행할 수 있습니다**.

### 키 브루트 포스 공격

[Loki](https://c0decafe.de/svn/codename_loki/trunk/)를 사용하여 키를 브루트 포스 공격할 수 있습니다:
```
sudo loki_gtk.py
```
키가 성공적으로 **bruteforced** (**일반적으로 MD5 암호화 형식**)되면, **장비에 접근하고 TACACS 암호화 트래픽을 복호화할 수 있습니다.**

### 트래픽 복호화

키가 성공적으로 해독되면, 다음 단계는 **TACACS 암호화 트래픽을 복호화하는 것**입니다. Wireshark는 키가 제공되면 암호화된 TACACS 트래픽을 처리할 수 있습니다. 복호화된 트래픽을 분석함으로써 **사용된 배너와 관리자** 사용자의 사용자 이름과 같은 정보를 얻을 수 있습니다.

획득한 자격 증명을 사용하여 네트워크 장비의 제어판에 접근함으로써 공격자는 네트워크를 제어할 수 있습니다. 이러한 행동은 교육 목적으로만 사용해야 하며, 적절한 권한 없이 사용해서는 안 됩니다.

## References

- [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

{{#include ../banners/hacktricks-training.md}}
