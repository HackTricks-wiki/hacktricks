# 49 - Pentesting TACACS+

{{#include ../banners/hacktricks-training.md}}

## Podstawowe informacje

Protokół **Terminal Access Controller Access Control System (TACACS)** jest używany do centralnej weryfikacji użytkowników próbujących uzyskać dostęp do routerów lub serwerów dostępu do sieci (NAS). Jego ulepszona wersja, **TACACS+**, dzieli usługi na uwierzytelnianie, autoryzację i rozliczanie (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Domyślny port:** 49

## Przechwytywanie klucza uwierzytelniającego

Jeśli komunikacja między klientem a serwerem TACACS zostanie przechwycona przez atakującego, **szyfrowany klucz uwierzytelniający może zostać przechwycony**. Atakujący może następnie spróbować **lokalnego ataku brute-force na klucz bez wykrycia w logach**. Jeśli uda mu się złamać klucz, zyskuje dostęp do sprzętu sieciowego i może odszyfrować ruch za pomocą narzędzi takich jak Wireshark.

### Wykonywanie ataku MitM

**Atak spoofingowy ARP może być wykorzystany do przeprowadzenia ataku Man-in-the-Middle (MitM)**.

### Łamanie klucza

[Loki](https://c0decafe.de/svn/codename_loki/trunk/) może być użyty do łamania klucza:
```
sudo loki_gtk.py
```
Jeśli klucz zostanie pomyślnie **bruteforced** (**zwykle w formacie zaszyfrowanym MD5**), **możemy uzyskać dostęp do urządzenia i odszyfrować ruch zaszyfrowany TACACS.**

### Odszyfrowywanie Ruchu

Gdy klucz zostanie pomyślnie złamany, następnym krokiem jest **odszyfrowanie ruchu zaszyfrowanego TACACS**. Wireshark może obsługiwać zaszyfrowany ruch TACACS, jeśli klucz zostanie podany. Analizując odszyfrowany ruch, można uzyskać informacje takie jak **używana baner i nazwa użytkownika administratora**.

Uzyskując dostęp do panelu sterowania urządzeń sieciowych za pomocą uzyskanych poświadczeń, atakujący może sprawować kontrolę nad siecią. Ważne jest, aby zauważyć, że te działania są ściśle edukacyjne i nie powinny być wykorzystywane bez odpowiedniej autoryzacji.

## Referencje

- [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

{{#include ../banners/hacktricks-training.md}}
