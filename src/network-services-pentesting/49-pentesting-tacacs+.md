# 49 - Pentesting TACACS+

{{#include ../banners/hacktricks-training.md}}

## Основна інформація

Протокол **Terminal Access Controller Access Control System (TACACS)** використовується для централізованої валідації користувачів, які намагаються отримати доступ до маршрутизаторів або мережевих серверів доступу (NAS). Його оновлена версія, **TACACS+**, розділяє послуги на аутентифікацію, авторизацію та облік (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**За замовчуванням порт:** 49

## Перехоплення ключа аутентифікації

Якщо комунікація між клієнтом і TACACS сервером перехоплюється зловмисником, **зашифрований ключ аутентифікації може бути перехоплений**. Зловмисник може спробувати **локальну атаку методом перебору на ключ без виявлення в журналах**. Якщо атака на ключ буде успішною, зловмисник отримує доступ до мережевого обладнання і може розшифрувати трафік за допомогою інструментів, таких як Wireshark.

### Виконання атаки MitM

**Атака ARP-спуфінгу може бути використана для виконання атаки Людина посередині (MitM)**.

### Перебір ключа

[Loki](https://c0decafe.de/svn/codename_loki/trunk/) може бути використаний для перебору ключа:
```
sudo loki_gtk.py
```
Якщо ключ успішно **bruteforced** (**зазвичай у форматі MD5**), **ми можемо отримати доступ до обладнання та розшифрувати трафік, зашифрований TACACS.**

### Розшифровка трафіку

Після успішного зламу ключа наступним кроком є **розшифровка трафіку, зашифрованого TACACS**. Wireshark може обробляти зашифрований TACACS-трафік, якщо ключ надано. Аналізуючи розшифрований трафік, можна отримати інформацію, таку як **використовуваний банер та ім'я користувача адміністратора**.

Отримавши доступ до панелі управління мережевим обладнанням за допомогою отриманих облікових даних, зловмисник може здійснювати контроль над мережею. Важливо зазначити, що ці дії строго для навчальних цілей і не повинні використовуватися без належного дозволу.

## Посилання

- [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

{{#include ../banners/hacktricks-training.md}}
