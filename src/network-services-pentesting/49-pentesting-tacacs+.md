# 49 - Pentesting TACACS+

{{#include ../banners/hacktricks-training.md}}

## Osnovne informacije

Protokol **Terminal Access Controller Access Control System (TACACS)** se koristi za centralnu validaciju korisnika koji pokušavaju da pristupe ruterima ili Network Access Servers (NAS). Njegova unapređena verzija, **TACACS+**, razdvaja usluge na autentifikaciju, autorizaciju i obračun (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Podrazumevani port:** 49

## Presretanje autentifikacionog ključa

Ako napadač presretne komunikaciju između klijenta i TACACS servera, **kriptovani autentifikacioni ključ može biti presretnut**. Napadač može pokušati **lokalni brute-force napad na ključ bez da bude otkriven u logovima**. Ako uspe u brute-forcing-u ključa, napadač dobija pristup mrežnoj opremi i može dekriptovati saobraćaj koristeći alate poput Wireshark.

### Izvođenje MitM napada

**ARP spoofing napad može se iskoristiti za izvođenje Man-in-the-Middle (MitM) napada**.

### Brute-forcing ključa

[Loki](https://c0decafe.de/svn/codename_loki/trunk/) se može koristiti za brute force ključa:
```
sudo loki_gtk.py
```
Ako je ključ uspešno **bruteforced** (**obično u MD5 enkriptovanom formatu**), **možemo pristupiti opremi i dekriptovati TACACS-enkriptovani saobraćaj.**

### Dekriptovanje Saobraćaja

Kada je ključ uspešno otkriven, sledeći korak je **dekriptovanje TACACS-enkriptovanog saobraćaja**. Wireshark može obraditi enkriptovani TACACS saobraćaj ako je ključ dostupan. Analizom dekriptovanog saobraćaja, informacije kao što su **baner koji se koristi i korisničko ime admin** korisnika mogu se dobiti.

Sticanjem pristupa kontrolnoj tabli mrežne opreme koristeći dobijene akreditive, napadač može ostvariti kontrolu nad mrežom. Važno je napomenuti da su ove akcije isključivo u obrazovne svrhe i ne bi se trebale koristiti bez odgovarajuće dozvole.

## Reference

- [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

{{#include ../banners/hacktricks-training.md}}
