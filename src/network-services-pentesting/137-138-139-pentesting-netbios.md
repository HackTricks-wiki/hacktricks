# 137,138,139 - Pentesting NetBios

{{#include ../banners/hacktricks-training.md}}

## NetBios Name Service

**NetBIOS Name Service** एक महत्वपूर्ण भूमिका निभाता है, जिसमें **नाम पंजीकरण और समाधान**, **डेटाग्राम वितरण**, और **सत्र सेवाएँ** शामिल हैं, प्रत्येक सेवा के लिए विशिष्ट पोर्ट का उपयोग करते हुए।

[From Wikidepia](https://en.wikipedia.org/wiki/NetBIOS_over_TCP/IP):

- नाम पंजीकरण और समाधान के लिए नाम सेवा (पोर्ट: 137/udp और 137/tcp)।
- कनेक्शन रहित संचार के लिए डेटाग्राम वितरण सेवा (पोर्ट: 138/udp)।
- कनेक्शन उन्मुख संचार के लिए सत्र सेवा (पोर्ट: 139/tcp)।

### Name Service

किसी डिवाइस को NetBIOS नेटवर्क में भाग लेने के लिए, इसका एक अद्वितीय नाम होना चाहिए। यह एक **ब्रॉडकास्ट प्रक्रिया** के माध्यम से प्राप्त किया जाता है जहाँ एक "Name Query" पैकेट भेजा जाता है। यदि कोई आपत्ति नहीं मिलती है, तो नाम उपलब्ध माना जाता है। वैकल्पिक रूप से, नाम उपलब्धता की जांच करने या किसी नाम को IP पते में हल करने के लिए सीधे **Name Service सर्वर** से पूछताछ की जा सकती है। `nmblookup`, `nbtscan`, और `nmap` जैसे उपकरणों का उपयोग NetBIOS सेवाओं की सूची बनाने के लिए किया जाता है, जो सर्वर नाम और MAC पते को प्रकट करते हैं।
```bash
PORT    STATE SERVICE    VERSION
137/udp open  netbios-ns Samba nmbd netbios-ns (workgroup: WORKGROUP)
```
NetBIOS सेवा की गणना करते समय, आप सर्वर द्वारा उपयोग किए जा रहे नामों और सर्वर के MAC पते को प्राप्त कर सकते हैं।
```bash
nmblookup -A <IP>
nbtscan <IP>/30
sudo nmap -sU -sV -T4 --script nbstat.nse -p137 -Pn -n <IP>
```
### Datagram वितरण सेवा

NetBIOS datagrams बिना कनेक्शन के संचार की अनुमति देते हैं UDP के माध्यम से, सीधे संदेश भेजने या सभी नेटवर्क नामों पर प्रसारण का समर्थन करते हैं। यह सेवा पोर्ट **138/udp** का उपयोग करती है।
```bash
PORT    STATE         SERVICE     VERSION
138/udp open|filtered netbios-dgm
```
### Session Service

कनेक्शन-उन्मुख इंटरैक्शन के लिए, **Session Service** दो उपकरणों के बीच बातचीत को सुविधाजनक बनाता है, **TCP** कनेक्शनों का उपयोग करते हुए पोर्ट **139/tcp** के माध्यम से। एक सत्र "Session Request" पैकेट के साथ शुरू होता है और प्रतिक्रिया के आधार पर स्थापित किया जा सकता है। यह सेवा बड़े संदेशों, त्रुटि पहचान और पुनर्प्राप्ति का समर्थन करती है, जिसमें TCP प्रवाह नियंत्रण और पैकेट पुनःप्रेषण को संभालता है।

एक सत्र के भीतर डेटा संचरण में **Session Message packets** शामिल होते हैं, और सत्रों को TCP कनेक्शन बंद करके समाप्त किया जाता है।

ये सेवाएँ **NetBIOS** कार्यक्षमता के लिए अनिवार्य हैं, जो नेटवर्क के पार कुशल संचार और संसाधन साझा करने को सक्षम बनाती हैं। TCP और IP प्रोटोकॉल के बारे में अधिक जानकारी के लिए, उनके संबंधित [TCP Wikipedia](https://en.wikipedia.org/wiki/Transmission_Control_Protocol) और [IP Wikipedia](https://en.wikipedia.org/wiki/Internet_Protocol) पृष्ठों पर जाएँ।
```bash
PORT      STATE SERVICE      VERSION
139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
```
**इस सेवा को सूचीबद्ध करने के लिए अगली पृष्ठ पढ़ें:**

{{#ref}}
137-138-139-pentesting-netbios.md
{{#endref}}

## HackTricks स्वचालित आदेश
```
Protocol_Name: Netbios    #Protocol Abbreviation if there is one.
Port_Number:  137,138,139     #Comma separated if there is more than one.
Protocol_Description: Netbios         #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for NetBios
Note: |
Name service for name registration and resolution (ports: 137/udp and 137/tcp).
Datagram distribution service for connectionless communication (port: 138/udp).
Session service for connection-oriented communication (port: 139/tcp).

For a device to participate in a NetBIOS network, it must have a unique name. This is achieved through a broadcast process where a "Name Query" packet is sent. If no objections are received, the name is considered available. Alternatively, a Name Service server can be queried directly to check for name availability or to resolve a name to an IP address.

https://book.hacktricks.xyz/pentesting/137-138-139-pentesting-netbios

Entry_2:
Name: Find Names
Description: Three scans to find the names of the server
Command: nmblookup -A {IP} &&&& nbtscan {IP}/30 &&&& nmap -sU -sV -T4 --script nbstat.nse -p 137 -Pn -n {IP}
```
{{#include ../banners/hacktricks-training.md}}
