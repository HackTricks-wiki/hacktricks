# Relro

{{#include ../../banners/hacktricks-training.md}}

## Relro

**RELRO** –æ–∑–Ω–∞—á–∞—î **Relocation Read-Only** —ñ —î –∑–∞—Ö–æ–¥–æ–º, —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–º –∫–æ–º–ø–æ–Ω–æ–≤–Ω–∏–∫–æ–º (`ld`), —è–∫–∏–π –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î –ø—ñ–¥–º–Ω–æ–∂–∏–Ω—É —Å–µ–≥–º–µ–Ω—Ç—ñ–≤ –¥–∞–Ω–∏—Ö ELF –Ω–∞ **—Ç—ñ–ª—å–∫–∏ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è –ø—ñ—Å–ª—è –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—å**. –ú–µ—Ç–∞ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ–± –∑—É–ø–∏–Ω–∏—Ç–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–∞ –≤—ñ–¥ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É –∑–∞–ø–∏—Å—ñ–≤ —É **GOT (Global Offset Table)** –∞–±–æ —ñ–Ω—à–∏—Ö —Ç–∞–±–ª–∏—Ü—è—Ö, –ø–æ–≤'—è–∑–∞–Ω–∏—Ö –∑ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—è–º–∏, —è–∫—ñ —Ä–æ–∑—ñ–º–µ–Ω–æ–≤—É—é—Ç—å—Å—è –ø—ñ–¥ —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø—Ä–æ–≥—Ä–∞–º–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `__fini_array`).

–°—É—á–∞—Å–Ω—ñ –∫–æ–º–ø–æ–Ω–æ–≤–Ω–∏–∫–∏ —Ä–µ–∞–ª—ñ–∑—É—é—Ç—å RELRO, **–ø–µ—Ä–µ—Å—Ç–∞–≤–ª—è—é—á–∏** **GOT** (—ñ –∫—ñ–ª—å–∫–∞ —ñ–Ω—à–∏—Ö —Å–µ–∫—Ü—ñ–π) —Ç–∞–∫, —â–æ–± –≤–æ–Ω–∏ –∑–Ω–∞—Ö–æ–¥–∏–ª–∏—Å—è **–ø–µ—Ä–µ–¥** **.bss** —ñ ‚Äì —â–æ –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–µ ‚Äì —Å—Ç–≤–æ—Ä—é—é—á–∏ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–π —Å–µ–≥–º–µ–Ω—Ç `PT_GNU_RELRO`, —è–∫–∏–π –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è `R‚ÄìX` –≤—ñ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ –¥–∏–Ω–∞–º—ñ—á–Ω–∏–π –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—á –∑–∞–∫—ñ–Ω—á—É—î –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—å. –í–Ω–∞—Å–ª—ñ–¥–æ–∫ —Ü—å–æ–≥–æ —Ç–∏–ø–æ–≤—ñ –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è –±—É—Ñ–µ—Ä–∞ –≤ **.bss** –±—ñ–ª—å—à–µ –Ω–µ –º–æ–∂—É—Ç—å –¥–æ—Å—è–≥—Ç–∏ GOT, —ñ –ø—Ä–∏–º—ñ—Ç–∏–≤–∏ –¥–æ–≤—ñ–ª—å–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É –Ω–µ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É –≤–∫–∞–∑—ñ–≤–Ω–∏–∫—ñ–≤ —Ñ—É–Ω–∫—Ü—ñ–π, —è–∫—ñ –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∑–∞—Ö–∏—â–µ–Ω–æ—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏ RELRO.

–Ü—Å–Ω—É—î **–¥–≤–∞ —Ä—ñ–≤–Ω—ñ** –∑–∞—Ö–∏—Å—Ç—É, —è–∫—ñ –º–æ–∂–µ –≤–∏–ø—É—Å—Ç–∏—Ç–∏ –∫–æ–º–ø–æ–Ω–æ–≤–Ω–∏–∫:

### Partial RELRO

* –í–∏—Ä–æ–±–ª—è—î—Ç—å—Å—è –∑ –ø—Ä–∞–ø–æ—Ä–æ–º `-Wl,-z,relro` (–∞–±–æ –ø—Ä–æ—Å—Ç–æ `-z relro`, –∫–æ–ª–∏ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è `ld` –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ).
* –¢—ñ–ª—å–∫–∏ **–Ω–µ-PLT** —á–∞—Å—Ç–∏–Ω–∞ **GOT** (—á–∞—Å—Ç–∏–Ω–∞, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—å –¥–∞–Ω–∏—Ö) –ø–æ–º—ñ—â–∞—î—Ç—å—Å—è –≤ —Å–µ–≥–º–µ–Ω—Ç —Ç—ñ–ª—å–∫–∏ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è. –°–µ–∫—Ü—ñ—ó, —è–∫—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –ø—ñ–¥ —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è ‚Äì –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–µ **.got.plt**, —â–æ –ø—ñ–¥—Ç—Ä–∏–º—É—î **lazy binding** ‚Äì –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è –∑–∞–ø–∏—Å—É–≤–∞–Ω–∏–º–∏.
* –ß–µ—Ä–µ–∑ —Ü–µ –ø—Ä–∏–º—ñ—Ç–∏–≤ **–¥–æ–≤—ñ–ª—å–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É** –≤—Å–µ —â–µ –º–æ–∂–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç–∏ –ø–æ—Ç—ñ–∫ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è, –ø–µ—Ä–µ–∑–∞–ø–∏—Å—É—é—á–∏ –∑–∞–ø–∏—Å PLT (–∞–±–æ –≤–∏–∫–æ–Ω—É—é—á–∏ **ret2dlresolve**).
* –í–ø–ª–∏–≤ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –Ω–µ–∑–Ω–∞—á–Ω–∏–π, —Ç–æ–º—É **–º–∞–π–∂–µ –∫–æ–∂–µ–Ω –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤ –ø—Ä–æ—Ç—è–≥–æ–º –±–∞–≥–∞—Ç—å–æ—Ö —Ä–æ–∫—ñ–≤ –ø–æ—Å—Ç–∞—á–∞—î –ø–∞–∫—É–Ω–∫–∏ –∑ –ø—Ä–∏–Ω–∞–π–º–Ω—ñ Partial RELRO (—Ü–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç GCC/Binutils –∑ 2016 —Ä–æ–∫—É)**.

### Full RELRO

* –í–∏—Ä–æ–±–ª—è—î—Ç—å—Å—è –∑ **–æ–±–æ–º–∞** –ø—Ä–∞–ø–æ—Ä–∞–º–∏ `-Wl,-z,relro,-z,now` (—Ç–∞–∫–æ–∂ –≤—ñ–¥–æ–º–∏–π —è–∫ `-z relro -z now`). `-z now` –∑–º—É—à—É—î –¥–∏–Ω–∞–º—ñ—á–Ω–∏–π –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—á –≤–∏—Ä—ñ—à—É–≤–∞—Ç–∏ **–≤—Å—ñ** —Å–∏–º–≤–æ–ª–∏ –∑–∞–∑–¥–∞–ª–µ–≥—ñ–¥—å (eager binding), —â–æ–± **.got.plt** –±—ñ–ª—å—à–µ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–ª–æ –∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ —ñ –π–æ–≥–æ –º–æ–∂–Ω–∞ –±—É–ª–æ –±–µ–∑–ø–µ—á–Ω–æ –≤—ñ–¥–æ–±—Ä–∞–∑–∏—Ç–∏ —è–∫ —Ç—ñ–ª—å–∫–∏ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è.
* –í–µ—Å—å **GOT**, **.got.plt**, **.fini_array**, **.init_array**, **.preinit_array** —Ç–∞ –∫—ñ–ª—å–∫–∞ –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö —Ç–∞–±–ª–∏—Ü—å glibc –ø–æ—Ç—Ä–∞–ø–ª—è—é—Ç—å —É —Å–µ–≥–º–µ–Ω—Ç —Ç—ñ–ª—å–∫–∏ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è `PT_GNU_RELRO`.
* –î–æ–¥–∞—î –≤–∏–º—ñ—Ä—é–≤–∞–Ω–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É (–≤—Å—ñ –¥–∏–Ω–∞–º—ñ—á–Ω—ñ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—è –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è –ø—ñ–¥ —á–∞—Å –∑–∞–ø—É—Å–∫—É), –∞–ª–µ **–Ω–µ–º–∞—î –Ω–∞–∫–ª–∞–¥–Ω–∏—Ö –≤–∏—Ç—Ä–∞—Ç –ø—ñ–¥ —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è**.

–ó 2023 —Ä–æ–∫—É –∫—ñ–ª—å–∫–∞ –æ—Å–Ω–æ–≤–Ω–∏—Ö –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤—ñ–≤ –ø–µ—Ä–µ–π—à–ª–∏ –Ω–∞ –∫–æ–º–ø—ñ–ª—è—Ü—ñ—é **—Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –Ω–∞–±–æ—Ä—É** (—ñ –±—ñ–ª—å—à–æ—Å—Ç—ñ –ø–∞–∫—É–Ω–∫—ñ–≤) –∑ **Full RELRO –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º** ‚Äì –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, **Debian 12 ‚Äúbookworm‚Äù (dpkg-buildflags 13.0.0)** —Ç–∞ **Fedora 35+**. –Ø–∫ –ø–µ–Ω—Ç–µ—Å—Ç–µ—Ä, –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ –æ—á—ñ–∫—É–≤–∞—Ç–∏ –∑—É—Å—Ç—Ä—ñ—Ç–∏ –±—ñ–Ω–∞—Ä–Ω—ñ —Ñ–∞–π–ª–∏, –¥–µ **–∫–æ–∂–µ–Ω –∑–∞–ø–∏—Å GOT —î —Ç—ñ–ª—å–∫–∏ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è**.

---

## –Ø–∫ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å RELRO –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É
```bash
$ checksec --file ./vuln
[*] '/tmp/vuln'
Arch:     amd64-64-little
RELRO:    Full
Stack:    Canary found
NX:       NX enabled
PIE:      No PIE (0x400000)
```
`checksec` (—á–∞—Å—Ç–∏–Ω–∞ [pwntools](https://github.com/pwncollege/pwntools) —Ç–∞ –±–∞–≥–∞—Ç—å–æ—Ö –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤—ñ–≤) –∞–Ω–∞–ª—ñ–∑—É—î –∑–∞–≥–æ–ª–æ–≤–∫–∏ `ELF` —ñ –≤–∏–≤–æ–¥–∏—Ç—å —Ä—ñ–≤–µ–Ω—å –∑–∞—Ö–∏—Å—Ç—É. –Ø–∫—â–æ –≤–∏ –Ω–µ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `checksec`, –ø–æ–∫–ª–∞–¥–∞–π—Ç–µ—Å—è –Ω–∞ `readelf`:
```bash
# Partial RELRO ‚Üí PT_GNU_RELRO is present but BIND_NOW is *absent*
$ readelf -l ./vuln | grep -E "GNU_RELRO|BIND_NOW"
GNU_RELRO      0x0000000000600e20 0x0000000000600e20
```

```bash
# Full RELRO ‚Üí PT_GNU_RELRO *and* the DF_BIND_NOW flag
$ readelf -d ./vuln | grep BIND_NOW
0x0000000000000010 (FLAGS)              FLAGS: BIND_NOW
```
–Ø–∫—â–æ –¥–≤—ñ–π–∫–æ–≤–∏–π —Ñ–∞–π–ª –ø—Ä–∞—Ü—é—î (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–æ–ø–æ–º—ñ–∂–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–∞ –∑ set-uid root), –≤–∏ –≤—Å–µ —â–µ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤–∏–∫–æ–Ω—É–≤–∞–Ω–∏–π —Ñ–∞–π–ª **—á–µ—Ä–µ–∑ `/proc/$PID/exe`**:
```bash
readelf -l /proc/$(pgrep helper)/exe | grep GNU_RELRO
```
---

## –£–≤—ñ–º–∫–Ω–µ–Ω–Ω—è RELRO –ø—ñ–¥ —á–∞—Å –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó –≤–ª–∞—Å–Ω–æ–≥–æ –∫–æ–¥—É
```bash
# GCC example ‚Äì create a PIE with Full RELRO and other common hardenings
$ gcc -fPIE -pie -z relro -z now -Wl,--as-needed -D_FORTIFY_SOURCE=2 main.c -o secure
```
`-z relro -z now` –ø—Ä–∞—Ü—é—î –¥–ª—è –æ–±–æ—Ö **GCC/clang** (–ø–µ—Ä–µ–¥–∞–Ω–æ –ø—ñ—Å–ª—è `-Wl,`) —ñ **ld** –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ. –ö–æ–ª–∏ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ **CMake 3.18+**, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–ø–∏—Ç–∞—Ç–∏ –ø–æ–≤–Ω–∏–π RELRO –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≤–±—É–¥–æ–≤–∞–Ω–æ–≥–æ –ø—Ä–µ—Å–µ—Ç—É:
```cmake
set(CMAKE_INTERPROCEDURAL_OPTIMIZATION ON) # LTO
set(CMAKE_ENABLE_EXPORTS OFF)
set(CMAKE_BUILD_RPATH_USE_ORIGIN ON)
set(CMAKE_EXE_LINKER_FLAGS "-Wl,-z,relro,-z,now")
```
---

## –¢–µ—Ö–Ω—ñ–∫–∏ –æ–±—Ö–æ–¥—É

| –†—ñ–≤–µ–Ω—å RELRO | –¢–∏–ø–æ–≤–∏–π –ø—Ä–∏–º—ñ—Ç–∏–≤ | –ú–æ–∂–ª–∏–≤—ñ —Ç–µ—Ö–Ω—ñ–∫–∏ –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó |
|--------------|------------------|------------------------------|
| –ù–µ–º–∞—î / –ß–∞—Å—Ç–∫–æ–≤–∏–π | –î–æ–≤—ñ–ª—å–Ω–∏–π –∑–∞–ø–∏—Å | 1. –ü–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –∑–∞–ø–∏—Å **.got.plt** —ñ –∑–º—ñ–Ω–∏—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è.<br>2. **ret2dlresolve** ‚Äì —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø—ñ–¥—Ä–æ–±–ª–µ–Ω—ñ `Elf64_Rela` —Ç–∞ `Elf64_Sym` —É –∑–∞–ø–∏—Å—É–≤–∞–Ω–æ–º—É —Å–µ–≥–º–µ–Ω—Ç—ñ —Ç–∞ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ `_dl_runtime_resolve`.<br>3. –ü–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∏ —Ñ—É–Ω–∫—Ü—ñ–π —É —Å–ø–∏—Å–∫—É **.fini_array** / **atexit()**. |
| –ü–æ–≤–Ω–∏–π | GOT —î —Ç—ñ–ª—å–∫–∏ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è | 1. –®—É–∫–∞—Ç–∏ **—ñ–Ω—à—ñ –∑–∞–ø–∏—Å—É–≤–∞–Ω—ñ –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∏ –∫–æ–¥—É** (C++ vtables, `__malloc_hook` < glibc 2.34, `__free_hook`, –∑–≤–æ—Ä–æ—Ç–Ω—ñ –≤–∏–∫–ª–∏–∫–∏ –≤ –∫–∞—Å—Ç–æ–º–Ω–∏—Ö —Å–µ–∫—Ü—ñ—è—Ö `.data`, JIT-—Å—Ç–æ—Ä—ñ–Ω–∫–∏).<br>2. –ó–ª–æ–≤–∂–∏–≤–∞—Ç–∏ *–≤—ñ–¥–Ω–æ—Å–Ω–∏–º–∏ —á–∏—Ç–∞–Ω–Ω—è–º–∏* –¥–ª—è –≤–∏—Ç–æ–∫—É libc —Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è **SROP/ROP —É libc**.<br>3. –í–ø—Ä–æ–≤–∞–¥–∏—Ç–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–π —Å–ø—ñ–ª—å–Ω–∏–π –æ–±'—î–∫—Ç —á–µ—Ä–µ–∑ **DT_RPATH**/`LD_PRELOAD` (—è–∫—â–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ –∫–æ–Ω—Ç—Ä–æ–ª—é—î—Ç—å—Å—è –∞—Ç–∞–∫—É—é—á–∏–º) –∞–±–æ **`ld_audit`**.<br>4. –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ **—Ñ–æ—Ä–º–∞—Ç–Ω–∏–π —Ä—è–¥–æ–∫** –∞–±–æ —á–∞—Å—Ç–∫–æ–≤–∏–π –ø–µ—Ä–µ–∑–∞–ø–∏—Å –≤–∫–∞–∑—ñ–≤–Ω–∏–∫–∞ –¥–ª—è –∑–º—ñ–Ω–∏ –ø–æ—Ç–æ–∫—É —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –±–µ–∑ —Ç–æ—Ä–∫–∞–Ω–Ω—è GOT. |

> üí° –ù–∞–≤—ñ—Ç—å –∑ –ü–æ–≤–Ω–∏–º RELRO **GOT –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏—Ö —Å–ø—ñ–ª—å–Ω–∏—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Å–∞–º–∞ libc)** —î **—Ç—ñ–ª—å–∫–∏ –ß–∞—Å—Ç–∫–æ–≤–∏–º RELRO**, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü—ñ –æ–±'—î–∫—Ç–∏ –≤–∂–µ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω—ñ, –∫–æ–ª–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—á –∑–∞—Å—Ç–æ—Å–æ–≤—É—î –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—è. –Ø–∫—â–æ –≤–∏ –æ—Ç—Ä–∏–º–∞–ª–∏ **–¥–æ–≤—ñ–ª—å–Ω–∏–π –∑–∞–ø–∏—Å** –ø—Ä–∏–º—ñ—Ç–∏–≤, —è–∫–∏–π –º–æ–∂–µ –Ω–∞—Ü—ñ–ª—é–≤–∞—Ç–∏—Å—è –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —ñ–Ω—à–æ–≥–æ —Å–ø—ñ–ª—å–Ω–æ–≥–æ –æ–±'—î–∫—Ç–∞, –≤–∏ –≤—Å–µ —â–µ –º–æ–∂–µ—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è, –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–≤—à–∏ –∑–∞–ø–∏—Å–∏ GOT libc –∞–±–æ —Å—Ç–µ–∫ `__rtld_global`, —Ç–µ—Ö–Ω—ñ–∫–∞, —è–∫–∞ —Ä–µ–≥—É–ª—è—Ä–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ —Å—É—á–∞—Å–Ω–∏—Ö CTF-–∑–∞–≤–¥–∞–Ω–Ω—è—Ö.

### –ü—Ä–∏–∫–ª–∞–¥ –æ–±—Ö–æ–¥—É –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —Å–≤—ñ—Ç—ñ (2024 CTF ‚Äì *pwn.college ‚Äúenlightened‚Äù*)

–ó–∞–≤–¥–∞–Ω–Ω—è –ø–æ—Å—Ç–∞—á–∞–ª–æ—Å—è –∑ –ü–æ–≤–Ω–∏–º RELRO. –ï–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∞ **off-by-one** –¥–ª—è –∫–æ—Ä—É–ø—Ü—ñ—ó —Ä–æ–∑–º—ñ—Ä—É —á–∞—Å—Ç–∏–Ω–∏ –∫—É–ø–∏, –≤–∏—Ç–µ–∫–ª–∞ libc –∑ `tcache poisoning`, —ñ –Ω–∞—Ä–µ—à—Ç—ñ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–ª–∞ `__free_hook` (–ø–æ–∑–∞ —Å–µ–≥–º–µ–Ω—Ç–æ–º RELRO) –∑ –æ–¥–Ω–∏–º –≥–∞–¥–∂–µ—Ç–æ–º –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–¥—É. –ó–∞–ø–∏—Å —É GOT –Ω–µ –±—É–≤ –ø–æ—Ç—Ä—ñ–±–µ–Ω.

---

## –û—Å—Ç–∞–Ω–Ω—ñ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è —Ç–∞ –≤—Ä–∞–∑–ª–∏–≤–æ—Å—Ç—ñ (2022-2025)

* **glibc 2.40 –∑–Ω–µ—Ü—ñ–Ω—é—î `__malloc_hook` / `__free_hook` (2025)** ‚Äì –ë—ñ–ª—å—à—ñ—Å—Ç—å —Å—É—á–∞—Å–Ω–∏—Ö –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ–π –∫—É–ø–∏, —è–∫—ñ –∑–ª–æ–≤–∂–∏–≤–∞–ª–∏ —Ü–∏–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏, —Ç–µ–ø–µ—Ä –ø–æ–≤–∏–Ω–Ω—ñ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–∏ –Ω–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ñ –≤–µ–∫—Ç–æ—Ä–∏, —Ç–∞–∫—ñ —è–∫ **`rtld_global._dl_load_jump`** –∞–±–æ —Ç–∞–±–ª–∏—Ü—ñ –≤–∏–∫–ª—é—á–µ–Ω—å C++. –û—Å–∫—ñ–ª—å–∫–∏ –≥–∞—á–∫–∏ –∂–∏–≤—É—Ç—å **–ø–æ–∑–∞** RELRO, —ó—Ö –≤–∏–¥–∞–ª–µ–Ω–Ω—è —É—Å–∫–ª–∞–¥–Ω—é—î –æ–±—Ö–æ–¥–∏ –ü–æ–≤–Ω–æ–≥–æ RELRO.
* **–í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è ‚Äúmax-page-size‚Äù Binutils 2.41 (2024)** ‚Äì –ü–æ–º–∏–ª–∫–∞ –¥–æ–∑–≤–æ–ª–∏–ª–∞ –æ—Å—Ç–∞–Ω–Ω—ñ–º –∫—ñ–ª—å–∫–æ–º –±–∞–π—Ç–∞–º —Å–µ–≥–º–µ–Ω—Ç–∞ RELRO –¥—ñ–ª–∏—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫—É –∑ –∑–∞–ø–∏—Å—É–≤–∞–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏ –Ω–∞ –¥–µ—è–∫–∏—Ö –∑–±—ñ—Ä–∫–∞—Ö ARM64, –∑–∞–ª–∏—à–∞—é—á–∏ –º–∞–ª–µ–Ω—å–∫–∏–π **RELRO-–ø—Ä–æ–º—ñ–∂–æ–∫**, —è–∫–∏–π –º–æ–∂–Ω–∞ –±—É–ª–æ –∑–∞–ø–∏—Å–∞—Ç–∏ –ø—ñ—Å–ª—è `mprotect`. –¢–µ–ø–µ—Ä upstream –≤–∏—Ä—ñ–≤–Ω—é—î `PT_GNU_RELRO` –¥–æ –º–µ–∂ —Å—Ç–æ—Ä—ñ–Ω–æ–∫, —É—Å—É–≤–∞—é—á–∏ —Ü–µ–π –∫—Ä–∞–π–Ω—ñ–π –≤–∏–ø–∞–¥–æ–∫.

---

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

* –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è Binutils ‚Äì *`-z relro`, `-z now` —Ç–∞ `PT_GNU_RELRO`*
* *‚ÄúRELRO ‚Äì –ü–æ–≤–Ω–∏–π, –ß–∞—Å—Ç–∫–æ–≤–∏–π —Ç–∞ –¢–µ—Ö–Ω—ñ–∫–∏ –æ–±—Ö–æ–¥—É‚Äù* ‚Äì –¥–æ–ø–∏—Å —É –±–ª–æ–∑—ñ @ wolfslittlered 2023

{{#include ../../banners/hacktricks-training.md}}
