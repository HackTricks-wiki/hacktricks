# iOS 如何连接到 Corellium

{{#include ../../banners/hacktricks-training.md}}

## **Prereqs**
- 一个 Corellium iOS VM（无论是否 jailbroken）。本指南假设你可以访问 Corellium。
- 本地工具：**ssh/scp**。
- （可选）将 **SSH keys** 添加到你的 Corellium 项目以便免密登录。


## **Connect to the iPhone VM from localhost**

### A) **Quick Connect（无需 VPN）**
0) 在 **`/admin/projects`** 添加你的 ssh key（推荐）。
1) 打开设备页面 → **Connect**
2) **复制 Corellium 显示的 Quick Connect SSH command** 并粘贴到终端。
3) 输入密码或使用你的 key（推荐）。

### B) **VPN → 直接 SSH**
0) 在 **`/admin/projects`** 添加你的 ssh key（推荐）。
1) 设备页面 → **CONNECT** → **VPN** → 下载 `.ovpn` 并使用支持 TAP 模式的任意 VPN 客户端连接。（如有问题，请查阅 [https://support.corellium.com/features/connect/vpn](https://support.corellium.com/features/connect/vpn)。）
2) 使用 SSH 连接到 VM 的 **10.11.x.x** 地址:
```bash
ssh root@10.11.1.1
```
## **上传并执行原生二进制**

### 2.1 **上传**
- 如果 Quick Connect 给了你 host/port：
```bash
scp -J <domain> ./mytool root@10.11.1.1:/var/root/mytool
```
- 如果使用 VPN (10.11.x.x):
```bash
scp ./mytool -J <domain> root@10.11.1.1:/var/root/mytool
```
## **上传并安装 iOS 应用 (.ipa)**

### 路径 A — **Web UI (fastest)**
1) 在 Device 页面 → **Apps** 选项卡 → **Install App** → 选择你的 `.ipa`.
2) 在同一选项卡中，你可以 **launch/kill/uninstall**.

### 路径 B — **通过 Corellium Agent 脚本化**
1) 使用 API Agent 来 **upload** 然后 **install**:
```js
// Node.js (pseudo) using Corellium Agent
await agent.upload("./app.ipa", "/var/tmp/app.ipa");
await agent.install("/var/tmp/app.ipa", (progress, status) => {
console.log(progress, status);
});
```
### 路径 C — **Non-jailbroken (proper signing / Sideloadly)**
- 如果你没有 provisioning profile，使用 **Sideloadly** 用你的 Apple ID 重新签名，或在 Xcode 中签名。
- 你也可以使用 **USBFlux** 将 VM 暴露给 Xcode（见 §5）。


- 如果想在不使用 SSH 的情况下快速查看日志/执行命令，在 UI 中使用设备的 **Console**。

## **Extras**

- **Port-forwarding**（让 VM 对其他工具感觉像本地）：
```bash
# Forward local 2222 -> device 22
ssh -N -L 2222:127.0.0.1:22 root@10.11.1.1
# Now you can: scp -P 2222 file root@10.11.1.1:/var/root/
```
- **LLDB remote debugging**：使用设备页面底部显示的 **LLDB/GDB stub** 地址（CONNECT → LLDB）。

- **USBFlux (macOS/Linux)**：将 VM 呈现给 **Xcode/Sideloadly**，就像一个通过数据线连接的设备。


## **常见陷阱**
- **Proper signing** 在 **non-jailbroken** 设备上是必需的；未签名的 IPAs 无法启动。
- **Quick Connect vs VPN**：Quick Connect 是最简单的；当你需要设备在本地网络上（例如，本地代理/工具）时，使用 **VPN**。
- **No App Store** 在 Corellium 设备上不可用；请自备已（重新）签名的 IPAs。



{{#include ../../banners/hacktricks-training.md}}
