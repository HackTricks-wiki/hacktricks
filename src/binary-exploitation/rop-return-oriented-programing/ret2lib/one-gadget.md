# One Gadget

{{#include ../../../banners/hacktricks-training.md}}

## Basic Information

[**One Gadget**](https://github.com/david942j/one_gadget) inaruhusu kupata shell badala ya kutumia **system** na **"/bin/sh". One Gadget** itapata ndani ya maktaba ya libc njia fulani ya kupata shell (`execve("/bin/sh")`) kwa kutumia tu **anwani** moja.\
Hata hivyo, kawaida kuna vizuizi fulani, zile za kawaida na rahisi kuepukwa ni kama `[rsp+0x30] == NULL` Kwa kuwa unadhibiti thamani ndani ya **RSP** unahitaji tu kutuma thamani zaidi za NULL ili kuepuka vizuizi hivyo.

![](<../../../images/image (754).png>)
```python
ONE_GADGET = libc.address + 0x4526a
rop2 = base + p64(ONE_GADGET) + "\x00"*100
```
Ili kufikia anwani iliyoonyeshwa na One Gadget unahitaji **kuongeza anwani ya msingi ambapo `libc`** imepakiwa.

> [!TIP]
> One Gadget ni **msaada mzuri kwa mbinu za Arbitrary Write 2 Exec** na inaweza **kurahisisha ROP** **mnyororo** kwani unahitaji tu kuita anwani moja (na kutimiza mahitaji).

### ARM64

Repo ya github inasema kwamba **ARM64 inasaidiwa** na chombo, lakini unapokimbia katika libc ya Kali 2023.3 **haipati gadget yoyote**.

## Angry Gadget

Kutoka kwenye [**github repo**](https://github.com/ChrisTheCoolHut/angry_gadget): Imehamasishwa na [OneGadget](https://github.com/david942j/one_gadget) chombo hiki kimeandikwa kwa python na kinatumia [angr](https://github.com/angr/angr) kujaribu vikwazo kwa gadgets zinazotekeleza `execve('/bin/sh', NULL, NULL)`\
Ikiwa umemaliza gadgets za kujaribu kutoka OneGadget, Angry Gadget inatoa mengi zaidi yenye vikwazo vigumu kujaribu!
```bash
pip install angry_gadget

angry_gadget.py examples/libc6_2.23-0ubuntu10_amd64.so
```
{{#include ../../../banners/hacktricks-training.md}}
