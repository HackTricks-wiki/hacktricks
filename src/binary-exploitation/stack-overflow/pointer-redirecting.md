# Redirecionamento de Ponteiros

{{#include ../../banners/hacktricks-training.md}}

## Ponteiros de String

Se uma chamada de função for usar um endereço de uma string que está localizada na pilha, é possível abusar do buffer overflow para **sobrescrever este endereço** e colocar um **endereço de uma string diferente** dentro do binário.

Se, por exemplo, uma chamada de função **`system`** for **usar o endereço de uma string para executar um comando**, um atacante poderia colocar o **endereço de uma string diferente na pilha**, **`export PATH=.:$PATH`** e criar no diretório atual um **script com o nome da primeira letra da nova string**, pois isso será executado pelo binário.

Você pode encontrar um **exemplo** disso em:

- [https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/strptr.c](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/strptr.c)
- [https://guyinatuxedo.github.io/04-bof_variable/tw17_justdoit/index.html](https://guyinatuxedo.github.io/04-bof_variable/tw17_justdoit/index.html)
- 32bit, mudar o endereço para a string de flags na pilha para que seja impressa por `puts`

## Ponteiros de Função

Mesma coisa que ponteiro de string, mas aplicando a funções, se a **pilha contém o endereço de uma função** que será chamada, é possível **mudá-lo** (por exemplo, para chamar **`system`**).

Você pode encontrar um exemplo em:

- [https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/funcptr.c](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/ASLR%20Smack%20and%20Laugh%20reference%20-%20Tilo%20Mueller/funcptr.c)

## Referências

- [https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/NOTES.md#pointer-redirecting](https://github.com/florianhofhammer/stack-buffer-overflow-internship/blob/master/NOTES.md#pointer-redirecting)

{{#include ../../banners/hacktricks-training.md}}
