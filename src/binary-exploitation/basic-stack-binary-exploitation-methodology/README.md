# बेसिक बाइनरी एक्सप्लॉइटेशन मेथोडोलॉजी

{{#include ../../banners/hacktricks-training.md}}

## ELF बेसिक जानकारी

किसी भी चीज़ का शोषण करने से पहले **ELF बाइनरी** की संरचना के एक भाग को समझना दिलचस्प है:

{{#ref}}
elf-tricks.md
{{#endref}}

## शोषण उपकरण

{{#ref}}
tools/
{{#endref}}

## स्टैक ओवरफ्लो मेथोडोलॉजी

इतनी सारी तकनीकों के साथ, यह अच्छा है कि जब प्रत्येक तकनीक उपयोगी होगी तो एक योजना हो। ध्यान दें कि समान सुरक्षा विभिन्न तकनीकों को प्रभावित करेगी। आप प्रत्येक सुरक्षा अनुभाग में सुरक्षा को बायपास करने के तरीके पा सकते हैं लेकिन इस मेथोडोलॉजी में नहीं।

## प्रवाह को नियंत्रित करना

एक प्रोग्राम के प्रवाह को नियंत्रित करने के लिए विभिन्न तरीके हैं:

- [**स्टैक ओवरफ्लो**](../stack-overflow/) स्टैक से रिटर्न पॉइंटर या EBP -> ESP -> EIP को ओवरराइट करना।
- ओवरफ्लो उत्पन्न करने के लिए [**इंटीजर ओवरफ्लो**](../integer-overflow.md) का दुरुपयोग करना पड़ सकता है।
- या **मनमाने लेखन + निष्पादन के लिए क्या लिखें** के माध्यम से।
- [**फॉर्मेट स्ट्रिंग्स**](../format-strings/)**:** `printf` का दुरुपयोग करके मनमाने पते पर मनमानी सामग्री लिखना।
- [**एरे इंडेक्सिंग**](../array-indexing.md): कुछ एरे को नियंत्रित करने और मनमाने लेखन प्राप्त करने के लिए खराब डिज़ाइन की गई इंडेक्सिंग का दुरुपयोग करना।
- ओवरफ्लो उत्पन्न करने के लिए [**इंटीजर ओवरफ्लो**](../integer-overflow.md) का दुरुपयोग करना पड़ सकता है।
- **bof से WWW तक ROP के माध्यम से**: एक बफर ओवरफ्लो का दुरुपयोग करके एक ROP का निर्माण करना और WWW प्राप्त करना।

आप **क्या लिखें कहाँ निष्पादन के लिए** तकनीकों को पा सकते हैं:

{{#ref}}
../arbitrary-write-2-exec/
{{#endref}}

## शाश्वत लूप

ध्यान में रखने के लिए एक बात यह है कि आमतौर पर **एक ही भेद्यता का शोषण सफल शोषण करने के लिए पर्याप्त नहीं हो सकता है**, विशेष रूप से कुछ सुरक्षा को बायपास करने की आवश्यकता होती है। इसलिए, यह दिलचस्प है कि **एकल भेद्यता को एक ही बाइनरी के निष्पादन में कई बार शोषण करने योग्य बनाने** के कुछ विकल्पों पर चर्चा करें:

- **`main` फ़ंक्शन** का पता या उस पते को लिखें जहाँ **भेद्यता** हो रही है।
- एक उचित ROP श्रृंखला को नियंत्रित करके आप उस श्रृंखला में सभी क्रियाएँ करने में सक्षम हो सकते हैं।
- **`exit` पते को GOT में** (या बाइनरी द्वारा समाप्त होने से पहले उपयोग किए जाने वाले किसी अन्य फ़ंक्शन) को **भेद्यता** पर वापस जाने के लिए पता लिखें।
- जैसा कि [**.fini_array**](../arbitrary-write-2-exec/www2exec-.dtors-and-.fini_array.md#eternal-loop)** में समझाया गया है,** यहाँ 2 फ़ंक्शन स्टोर करें, एक फिर से vuln को कॉल करने के लिए और दूसरा **`__libc_csu_fini`** को कॉल करने के लिए जो फिर से `.fini_array` से फ़ंक्शन को कॉल करेगा।

## शोषण लक्ष्य

### लक्ष्य: एक मौजूदा फ़ंक्शन को कॉल करें

- [**ret2win**](./#ret2win): कोड में एक फ़ंक्शन है जिसे आपको कॉल करना है (शायद कुछ विशिष्ट पैरामीटर के साथ) ताकि फ्लैग प्राप्त किया जा सके।
- एक **नियमित bof बिना** [**PIE**](../common-binary-protections-and-bypasses/pie/) **और** [**कनारी**](../common-binary-protections-and-bypasses/stack-canaries/) आपको बस स्टैक में स्टोर किए गए रिटर्न पते में पता लिखने की आवश्यकता है।
- [**PIE**](../common-binary-protections-and-bypasses/pie/) के साथ bof में, आपको इसे बायपास करने की आवश्यकता होगी।
- [**कनारी**](../common-binary-protections-and-bypasses/stack-canaries/) के साथ bof में, आपको इसे बायपास करने की आवश्यकता होगी।
- यदि आपको **ret2win** फ़ंक्शन को सही ढंग से कॉल करने के लिए कई पैरामीटर सेट करने की आवश्यकता है, तो आप उपयोग कर सकते हैं:
- यदि पर्याप्त गैजेट हैं तो [**ROP**](./#rop-and-ret2...-techniques) **श्रृंखला** सभी पैरामीटर तैयार करने के लिए।
- [**SROP**](../rop-return-oriented-programing/srop-sigreturn-oriented-programming/) (यदि आप इस syscall को कॉल कर सकते हैं) बहुत सारे रजिस्टर को नियंत्रित करने के लिए।
- [**ret2csu**](../rop-return-oriented-programing/ret2csu.md) और [**ret2vdso**](../rop-return-oriented-programing/ret2vdso.md) से गैजेट्स कई रजिस्टर को नियंत्रित करने के लिए।
- [**Write What Where**](../arbitrary-write-2-exec/) के माध्यम से आप **`win`** फ़ंक्शन को कॉल करने के लिए अन्य भेद्यताओं (bof नहीं) का दुरुपयोग कर सकते हैं।
- [**Pointers Redirecting**](../stack-overflow/pointer-redirecting.md): यदि स्टैक में किसी फ़ंक्शन के लिए या किसी स्ट्रिंग के लिए जो एक दिलचस्प फ़ंक्शन (system या printf) द्वारा उपयोग किया जाने वाला है, तो उस पते को ओवरराइट करना संभव है।
- [**ASLR**](../common-binary-protections-and-bypasses/aslr/) या [**PIE**](../common-binary-protections-and-bypasses/pie/) पते को प्रभावित कर सकते हैं।
- [**अनइनीशियलाइज़्ड वेरिएबल्स**](../stack-overflow/uninitialized-variables.md): आप कभी नहीं जानते।

### लक्ष्य: RCE

#### शेलकोड के माध्यम से, यदि nx अक्षम है या शेलकोड को ROP के साथ मिलाकर:

- [**(स्टैक) शेलकोड**](./#stack-shellcode): यह रिटर्न पॉइंटर को ओवरराइट करने से पहले या बाद में स्टैक में शेलकोड स्टोर करने के लिए उपयोगी है और फिर **इसे निष्पादित करने के लिए** कूदें:
- किसी भी मामले में, यदि वहाँ एक [**कनारी**](../common-binary-protections-and-bypasses/stack-canaries/)** है,** एक नियमित bof में आपको इसे बायपास (लीक) करने की आवश्यकता होगी।
- [**ASLR**](../common-binary-protections-and-bypasses/aslr/) **और** [**nx**](../common-binary-protections-and-bypasses/no-exec-nx.md) के बिना, स्टैक के पते पर कूदना संभव है क्योंकि यह कभी नहीं बदलेगा।
- [**ASLR**](../common-binary-protections-and-bypasses/aslr/) के साथ, आपको [**ret2esp/ret2reg**](../rop-return-oriented-programing/ret2esp-ret2reg.md) जैसी तकनीकों की आवश्यकता होगी।
- [**nx**](../common-binary-protections-and-bypasses/no-exec-nx.md) के साथ, आपको `memprotect` को कॉल करने के लिए कुछ [**ROP**](../rop-return-oriented-programing/) का उपयोग करने की आवश्यकता होगी और कुछ पृष्ठ `rwx` बनाना होगा, ताकि फिर **शेलकोड को वहाँ स्टोर किया जा सके** (उदाहरण के लिए पढ़ें) और फिर वहाँ कूदें।
- यह शेलकोड को ROP श्रृंखला के साथ मिलाएगा।

#### सिस्टम कॉल के माध्यम से

- [**Ret2syscall**](../rop-return-oriented-programing/rop-syscall-execv/): मनमाने आदेशों को चलाने के लिए `execve` को कॉल करने के लिए उपयोगी। आपको **विशिष्ट syscall को कॉल करने के लिए गैजेट्स खोजने में सक्षम होना चाहिए**।
- यदि [**ASLR**](../common-binary-protections-and-bypasses/aslr/) या [**PIE**](../common-binary-protections-and-bypasses/pie/) सक्षम हैं, तो आपको **ROP गैजेट्स का उपयोग करने के लिए उन्हें पराजित करने की आवश्यकता होगी**।
- [**SROP**](../rop-return-oriented-programing/srop-sigreturn-oriented-programming/) **ret2execve** तैयार करने के लिए उपयोगी हो सकता है।
- [**ret2csu**](../rop-return-oriented-programing/ret2csu.md) और [**ret2vdso**](../rop-return-oriented-programing/ret2vdso.md) से गैजेट्स कई रजिस्टर को नियंत्रित करने के लिए।

#### libc के माध्यम से

- [**Ret2lib**](../rop-return-oriented-programing/ret2lib/): एक लाइब्रेरी (आमतौर पर **`libc`**) से फ़ंक्शन को कॉल करने के लिए उपयोगी जैसे **`system`** कुछ तैयार तर्कों के साथ (जैसे `'/bin/sh'`)। आपको बाइनरी को **लाइब्रेरी** को लोड करने की आवश्यकता है जिसमें आप कॉल करना चाहते हैं (आमतौर पर libc)।
- यदि **स्थैतिक रूप से संकलित और कोई** [**PIE**](../common-binary-protections-and-bypasses/pie/) नहीं है, तो `system` और `/bin/sh` का **पता** नहीं बदलेगा, इसलिए आप उन्हें स्थैतिक रूप से उपयोग कर सकते हैं।
- **बिना** [**ASLR**](../common-binary-protections-and-bypasses/aslr/) **और libc संस्करण** को जानने के बिना, `system` और `/bin/sh` का **पता** नहीं बदलेगा, इसलिए आप उन्हें स्थैतिक रूप से उपयोग कर सकते हैं।
- [**ASLR**](../common-binary-protections-and-bypasses/aslr/) **के साथ लेकिन कोई** [**PIE**](../common-binary-protections-and-bypasses/pie/) नहीं है, libc को जानने और बाइनरी का उपयोग करते हुए `system` फ़ंक्शन के साथ, आप **GOT में system के पते पर `ret`** कर सकते हैं जिसमें `'/bin/sh'` का पता पैरामीटर में है (आपको इसे समझना होगा)।
- [ASLR](../common-binary-protections-and-bypasses/aslr/) के साथ लेकिन कोई [PIE](../common-binary-protections-and-bypasses/pie/) नहीं है, libc को जानने और **बाइनरी का उपयोग किए बिना `system`**:
- [**`ret2dlresolve`**](../rop-return-oriented-programing/ret2dlresolve.md) का उपयोग करें ताकि `system` का पता हल किया जा सके और इसे कॉल किया जा सके।
- [**ASLR**](../common-binary-protections-and-bypasses/aslr/) को बायपास करें और मेमोरी में `system` और `'/bin/sh'` का पता निकालें।
- [**ASLR**](../common-binary-protections-and-bypasses/aslr/) **और** [**PIE**](../common-binary-protections-and-bypasses/pie/) के साथ और libc को न जानते हुए: आपको:
- [**PIE**](../common-binary-protections-and-bypasses/pie/) को बायपास करना होगा।
- उपयोग की गई **`libc` संस्करण** को खोजें (कुछ फ़ंक्शन पते लीक करें)।
- आगे बढ़ने के लिए **ASLR के साथ पिछले परिदृश्यों** की जांच करें।

#### EBP/RBP के माध्यम से

- [**स्टैक पिवोटिंग / EBP2Ret / EBP चेनिंग**](../stack-overflow/stack-pivoting-ebp2ret-ebp-chaining.md): स्टैक में स्टोर किए गए EBP के माध्यम से RET को नियंत्रित करने के लिए ESP को नियंत्रित करें।
- **ऑफ-बाय-वन** स्टैक ओवरफ्लो के लिए उपयोगी।
- मेमोरी में पेलोड का निर्माण करते समय EIP को नियंत्रित करने के लिए एक वैकल्पिक तरीके के रूप में उपयोगी और फिर EBP के माध्यम से उस पर कूदना।

#### विविध

- [**Pointers Redirecting**](../stack-overflow/pointer-redirecting.md): यदि स्टैक में किसी फ़ंक्शन के लिए या किसी स्ट्रिंग के लिए जो एक दिलचस्प फ़ंक्शन (system या printf) द्वारा उपयोग किया जाने वाला है, तो उस पते को ओवरराइट करना संभव है।
- [**ASLR**](../common-binary-protections-and-bypasses/aslr/) या [**PIE**](../common-binary-protections-and-bypasses/pie/) पते को प्रभावित कर सकते हैं।
- [**अनइनीशियलाइज़्ड वेरिएबल्स**](../stack-overflow/uninitialized-variables.md): आप कभी नहीं जानते।

{{#include ../../banners/hacktricks-training.md}}
