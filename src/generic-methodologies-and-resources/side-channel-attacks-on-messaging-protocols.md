# Delivery Receipt Side-Channel Attacks in E2EE Messengers

{{#include ../banners/hacktricks-training.md}}

–ö–≤–∏—Ç–∞–Ω—Ü—ñ—ó –ø—Ä–æ –¥–æ—Å—Ç–∞–≤–∫—É (delivery receipts) —î –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–∏–º–∏ –≤ —Å—É—á–∞—Å–Ω–∏—Ö end-to-end encrypted (E2EE) –º–µ—Å–µ–Ω–¥–∂–µ—Ä–∞—Ö, –æ—Å–∫—ñ–ª—å–∫–∏ –∫–ª—ñ—î–Ω—Ç–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞—Ç–∏, –∫–æ–ª–∏ ciphertext –±—É–ª–æ —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ, —â–æ–± –≤–æ–Ω–∏ –º–æ–≥–ª–∏ –≤–∏–¥–∞–ª—è—Ç–∏ ratcheting state —Ç–∞ ephemeral keys. –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ—Å–∏–ª–∞—î –Ω–µ–ø—Ä–æ–∑–æ—Ä—ñ –±–ª–æ“ë–∏, —Ç–æ–∂ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –Ω–∞ –ø—Ä–∏—Å—Ç—Ä–æ—ó –æ—Ç—Ä–∏–º—É–≤–∞—á–∞ (double checkmarks) –≤—ñ–¥–ø—Ä–∞–≤–ª—è—é—Ç—å—Å—è –ø—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ—ó –¥–µ—à–∏—Ñ—Ä–∞—Ü—ñ—ó. –í–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è round-trip time (RTT) –º—ñ–∂ –¥—ñ—î—é, —ñ–Ω—ñ—Ü—ñ–π–æ–≤–∞–Ω–æ—é –∞—Ç–∞–∫—É—é—á–∏–º, —ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—é –∫–≤–∏—Ç–∞–Ω—Ü—ñ—î—é –ø—Ä–æ –¥–æ—Å—Ç–∞–≤–∫—É –≤—ñ–¥–∫—Ä–∏–≤–∞—î –≤–∏—Å–æ–∫–æ—Ç–æ—á–Ω–∏–π —Ç–∞–π–º—ñ–Ω–≥-–∫–∞–Ω–∞–ª, —è–∫–∏–π leaks —Å—Ç–∞–Ω –ø—Ä–∏—Å—Ç—Ä–æ—é, online presence —ñ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è covert DoS. –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –∑ –∫—ñ–ª—å–∫–æ–º–∞ –ø—Ä–∏—Å—Ç—Ä–æ—è–º–∏ ("client-fanout") –ø—ñ–¥—Å–∏–ª—é—é—Ç—å –≤–∏—Ç—ñ–∫, —Ç–æ–º—É —â–æ –∫–æ–∂–µ–Ω –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–∏–π –ø—Ä–∏—Å—Ç—Ä—ñ–π –¥–µ—à–∏—Ñ—Ä—É—î probe —ñ –ø–æ–≤–µ—Ä—Ç–∞—î –≤–ª–∞—Å–Ω—É –∫–≤–∏—Ç–∞–Ω—Ü—ñ—é.

## Delivery receipt sources vs. user-visible signals

–í–∏–±–∏—Ä–∞–π—Ç–µ —Ç–∏–ø–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å, —è–∫—ñ –∑–∞–≤–∂–¥–∏ –≥–µ–Ω–µ—Ä—É—é—Ç—å –∫–≤–∏—Ç–∞–Ω—Ü—ñ—é –ø—Ä–æ –¥–æ—Å—Ç–∞–≤–∫—É, –∞–ª–µ –Ω–µ —Å—Ç–≤–æ—Ä—é—é—Ç—å UI-–∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ñ–≤ —É –∂–µ—Ä—Ç–≤–∏. –ù–∞–≤–µ–¥–µ–Ω–∞ –Ω–∏–∂—á–µ —Ç–∞–±–ª–∏—Ü—è —É–∑–∞–≥–∞–ª—å–Ω—é—î –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω—É –ø–æ–≤–µ–¥—ñ–Ω–∫—É:

| Messenger | Action | Delivery receipt | Victim notification | Notes |
|-----------|--------|------------------|---------------------|-------|
| **WhatsApp** | Text message | ‚óè | ‚óè | Always noisy ‚Üí only useful to bootstrap state. |
| | Reaction | ‚óè | ‚óê (only if reacting to victim message) | Self-reactions and removals stay silent. |
| | Edit | ‚óè | Platform-dependent silent push | Edit window ‚âà20 min; still ack‚Äôd after expiry. |
| | Delete for everyone | ‚óè | ‚óã | UI allows ~60 h, but later packets still ack‚Äôd. |
| **Signal** | Text message | ‚óè | ‚óè | Same limitations as WhatsApp. |
| | Reaction | ‚óè | ‚óê | Self-reactions invisible to victim. |
| | Edit/Delete | ‚óè | ‚óã | Server enforces ~48 h window, allows up to 10 edits, but late packets still ack‚Äôd. |
| **Threema** | Text message | ‚óè | ‚óè | Multi-device receipts are aggregated, so only one RTT per probe becomes visible. |

Legend: ‚óè = always, ‚óê = conditional, ‚óã = never. Platform-dependent UI behaviour is noted inline. Disable read receipts if needed, but delivery receipts cannot be turned off in WhatsApp or Signal.

## Attacker goals and models

* **G1 ‚Äì Device fingerprinting:** –†–∞—Ö—É–≤–∞—Ç–∏, —Å–∫—ñ–ª—å–∫–∏ –∫–≤–∏—Ç–∞–Ω—Ü—ñ–π –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –Ω–∞ –æ–¥–∏–Ω probe, –∫–ª–∞—Å—Ç–µ—Ä–∏–∑—É–≤–∞—Ç–∏ RTT, —â–æ–± –≤–∏–∑–Ω–∞—á–∏—Ç–∏ OS/client (Android vs iOS vs desktop), —ñ –≤—ñ–¥—Å—Ç–µ–∂—É–≤–∞—Ç–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏ online/offline.
* **G2 ‚Äì Behavioural monitoring:** –†–æ–∑–≥–ª—è–¥–∞—Ç–∏ –≤–∏—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω—É –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å RTT (‚âà1 Hz —î —Å—Ç–∞–±—ñ–ª—å–Ω–æ—é) —è–∫ time-series —ñ –≤–∏–≤–æ–¥–∏—Ç–∏ screen on/off, app foreground/background, –≥–æ–¥–∏–Ω–∏ –ø–æ—ó–∑–¥–æ–∫ vs —Ä–æ–±–æ—Ç–∏ —Ç–æ—â–æ.
* **G3 ‚Äì Resource exhaustion:** –¢—Ä–∏–º–∞—Ç–∏ —Ä–∞–¥—ñ–æ/CPU –∫–æ–∂–Ω–æ–≥–æ –ø—Ä–∏—Å—Ç—Ä–æ—é –∂–µ—Ä—Ç–≤–∏ –∞–∫—Ç–∏–≤–Ω–∏–º–∏, –Ω–∞–¥—Å–∏–ª–∞—é—á–∏ –Ω–µ—Å–∫—ñ–Ω—á–µ–Ω–Ω—ñ silent probes, –≤–∏—Å–Ω–∞–∂—É—é—á–∏ –±–∞—Ç–∞—Ä–µ—é/–¥–∞–Ω—ñ —ñ –ø–æ–≥—ñ—Ä—à—É—é—á–∏ —è–∫—ñ—Å—Ç—å VoIP/RTC.

–î–≤–æ—Ö threat actors –¥–æ—Å—Ç–∞—Ç–Ω—å–æ, —â–æ–± –æ–ø–∏—Å–∞—Ç–∏ –ø–ª–æ—â—É –∑–ª–æ–≤–∂–∏–≤–∞–Ω–Ω—è:

1. **Creepy companion:** –≤–∂–µ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –æ–¥–Ω–æ–º—É —á–∞—Ç—ñ –∑ –∂–µ—Ä—Ç–≤–æ—é —ñ –∑–ª–æ–≤–∂–∏–≤–∞—î self-reactions, reaction removals –∞–±–æ –ø–æ–≤—Ç–æ—Ä—é–≤–∞–Ω–∏–º–∏ edits/deletes, –ø—Ä–∏–≤‚Äô—è–∑–∞–Ω–∏–º–∏ –¥–æ —ñ—Å–Ω—É—é—á–∏—Ö message ID.
2. **Spooky stranger:** —Ä–µ—î—Å—Ç—Ä—É—î –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–∏–π –∞–∫–∞—É–Ω—Ç —ñ –Ω–∞–¥—Å–∏–ª–∞—î reactions, —â–æ –ø–æ—Å–∏–ª–∞—é—Ç—å—Å—è –Ω–∞ message ID, —è–∫—ñ –Ω—ñ–∫–æ–ª–∏ –Ω–µ —ñ—Å–Ω—É–≤–∞–ª–∏ –≤ –ª–æ–∫–∞–ª—å–Ω—ñ–π –±–µ—Å—ñ–¥—ñ; WhatsApp —ñ Signal –≤—Å–µ –æ–¥–Ω–æ –¥–µ—à–∏—Ñ—Ä—É—é—Ç—å —ñ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—é—Ç—å —ó—Ö, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ UI –≤—ñ–¥–∫–∏–¥–∞—î –∑–º—ñ–Ω—É —Å—Ç–∞–Ω—É, —Ç–æ–∂ –ø–æ–ø–µ—Ä–µ–¥–Ω—è —Ä–æ–∑–º–æ–≤–∞ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–∞.

## Tooling for raw protocol access

–°–ø–∏—Ä–∞–π—Ç–µ—Å—è –Ω–∞ –∫–ª—ñ—î–Ω—Ç–∏, —â–æ –≤—ñ–¥–∫—Ä–∏–≤–∞—é—Ç—å underlying E2EE protocol, —â–æ–± –º–æ–∂–Ω–∞ –±—É–ª–æ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –ø–∞–∫–µ—Ç–∏ –ø–æ–∑–∞ UI-–æ–±–º–µ–∂–µ–Ω–Ω—è–º–∏, –∑–∞–¥–∞–≤–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω—ñ `message_id` —ñ –ª–æ–≥—É–≤–∞—Ç–∏ —Ç–æ—á–Ω—ñ timestamps:

* **WhatsApp:** [whatsmeow](https://github.com/tulir/whatsmeow) (Go, WhatsApp Web protocol) –∞–±–æ [Cobalt](https://github.com/Auties00/Cobalt) (–æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–∏–π –Ω–∞ mobile) –¥–æ–∑–≤–æ–ª—è—é—Ç—å –≤—ñ–¥–ø—Ä–∞–≤–ª—è—Ç–∏ raw `ReactionMessage`, `ProtocolMessage` (edit/delete) —Ç–∞ `Receipt` frames, –∑–±–µ—Ä—ñ–≥–∞—é—á–∏ double-ratchet state –≤ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ.
* **Signal:** [signal-cli](https://github.com/AsamK/signal-cli) —É –ø–æ—î–¥–Ω–∞–Ω–Ω—ñ –∑ [libsignal-service-java](https://github.com/signalapp/libsignal-service-java) –≤—ñ–¥–∫—Ä–∏–≤–∞—é—Ç—å —É—Å—ñ —Ç–∏–ø–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —á–µ—Ä–µ–∑ CLI/API. –ü—Ä–∏–∫–ª–∞–¥ –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è self-reaction:
```bash
signal-cli -u +12025550100 sendReaction --target +12025550123 \
--message-timestamp 1712345678901 --emoji "üëç"
signal-cli -u +12025550100 sendReaction --target +12025550123 \
--message-timestamp 1712345678901 --remove  # encodes empty emoji
```
* **Threema:** –í–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥ Android-–∫–ª—ñ—î–Ω—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç—É—î, —è–∫ delivery receipts –∞–≥—Ä–µ–≥—É—é—Ç—å—Å—è –ø–µ—Ä–µ–¥ –≤–∏—Ö–æ–¥–æ–º —ñ–∑ –ø—Ä–∏—Å—Ç—Ä–æ—é, –ø–æ—è—Å–Ω—é—é—á–∏, —á–æ–º—É side channel —Ç–∞–º –º–∞—î –Ω–µ–∑–Ω–∞—á–Ω—É –ø—Ä–æ–ø—É—Å–∫–Ω—É –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å.

–ö–æ–ª–∏ –∫–∞—Å—Ç–æ–º–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ñ, –º–æ–∂–Ω–∞ —Ç–∞–∫–æ–∂ –∑–∞–ø—É—Å–∫–∞—Ç–∏ silent actions –∑ WhatsApp Web –∞–±–æ Signal Desktop —ñ —Å–Ω—ñ—Ñ—Ñ–∏—Ç–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π websocket/WebRTC –∫–∞–Ω–∞–ª, –∞–ª–µ raw APIs –ø—Ä–∏–±–∏—Ä–∞—é—Ç—å UI-–∑–∞—Ç—Ä–∏–º–∫–∏ —ñ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó.

## Creepy companion: silent sampling loop

1. –í–∏–±–µ—Ä—ñ—Ç—å –±—É–¥—å-—è–∫–µ —ñ—Å—Ç–æ—Ä–∏—á–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —è–∫–µ –≤–∏ –≤—ñ–¥–ø—Ä–∞–≤–ª—è–ª–∏ –≤ —á–∞—Ç—ñ, —â–æ–± –∂–µ—Ä—Ç–≤–∞ –Ω—ñ–∫–æ–ª–∏ –Ω–µ –±–∞—á–∏–ª–∞ –∑–º—ñ–Ω—É "reaction" –±–∞–ª–æ–Ω—ñ–≤.
2. –ß–µ—Ä–≥—É–π—Ç–µ –≤–∏–¥–∏–º–∏–π emoji —ñ empty reaction payload (–∑–∞–∫–æ–¥–æ–≤–∞–Ω–∏–π —è–∫ `""` —É WhatsApp protobufs –∞–±–æ `--remove` —É signal-cli). –ö–æ–∂–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞—î device ack, –Ω–µ–∑–≤–∞–∂–∞—é—á–∏ –Ω–∞ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å UI-–¥–µ–ª—å—Ç–∏ –¥–ª—è –∂–µ—Ä—Ç–≤–∏.
3. –¢–∞–π–º—Å—Ç–∞–º–ø—ñ—Ç—å —á–∞—Å –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ —ñ –∫–æ–∂–Ω–µ –Ω–∞–¥—Ö–æ–¥–∂–µ–Ω–Ω—è delivery receipt. –¶–∏–∫–ª 1 Hz, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ —Ç–∞–∫–∏–π, –¥–∞—î RTT-—Ç—Ä–∞—Å–∏ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –ø—Ä–∏—Å—Ç—Ä–æ—é –±–µ–∑–∫—ñ–Ω–µ—á–Ω–æ:
```python
while True:
send_reaction(msg_id, "üëç")
log_receipts()
send_reaction(msg_id, "")  # removal
log_receipts()
time.sleep(0.5)
```
4. –û—Å–∫—ñ–ª—å–∫–∏ WhatsApp/Signal –ø—Ä–∏–π–º–∞—é—Ç—å –Ω–µ–æ–±–º–µ–∂–µ–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ä–µ–∞–∫—Ü—ñ–π, –∞—Ç–∞–∫—É—é—á–æ–º—É –Ω—ñ–∫–æ–ª–∏ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏ –Ω–æ–≤–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç —É —á–∞—Ç—ñ –∞–±–æ —Ç—É—Ä–±—É–≤–∞—Ç–∏—Å—è –ø—Ä–æ edit windows.

## Spooky stranger: probing arbitrary phone numbers

1. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ –Ω–æ–≤–∏–π WhatsApp/Signal –∞–∫–∞—É–Ω—Ç —ñ –æ—Ç—Ä–∏–º–∞—î—Ç–µ public identity keys –¥–ª—è —Ü—ñ–ª—å–æ–≤–æ–≥–æ –Ω–æ–º–µ—Ä–∞ (–≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—ñ–¥ —á–∞—Å –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–µ—Å—ñ—ó).
2. –°—Ñ–æ—Ä–º—É–π—Ç–µ reaction/edit/delete –ø–∞–∫–µ—Ç, —â–æ –ø–æ—Å–∏–ª–∞—î—Ç—å—Å—è –Ω–∞ –≤–∏–ø–∞–¥–∫–æ–≤–∏–π `message_id`, —è–∫–∏–π –Ω—ñ–∫–æ–ª–∏ –Ω–µ –±–∞—á–∏–ª–∏ –æ–±–∏–¥–≤—ñ —Å—Ç–æ—Ä–æ–Ω–∏ (WhatsApp –ø—Ä–∏–π–º–∞—î –¥–æ–≤—ñ–ª—å–Ω—ñ `key.id` GUID; Signal –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î millisecond timestamps).
3. –ù–∞–¥—ñ—à–ª—ñ—Ç—å –ø–∞–∫–µ—Ç, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ thread –Ω–µ —ñ—Å–Ω—É—î. –ü—Ä–∏—Å—Ç—Ä–æ—ó –∂–µ—Ä—Ç–≤–∏ –¥–µ—à–∏—Ñ—Ä—É—é—Ç—å –π–æ–≥–æ, –Ω–µ –º–æ–∂—É—Ç—å —Å–ø—ñ–≤—Å—Ç–∞–≤–∏—Ç–∏ –∑ –±–∞–∑–æ–≤–∏–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º, –≤—ñ–¥–∫–∏–¥–∞—é—Ç—å –∑–º—ñ–Ω—É —Å—Ç–∞–Ω—É, –∞–ª–µ –≤—Å–µ –æ–¥–Ω–æ acknowledge –≤—Ö—ñ–¥–Ω–∏–π ciphertext, –≤—ñ–¥–ø—Ä–∞–≤–ª—è—é—á–∏ device receipts –Ω–∞–∑–∞–¥ –∞—Ç–∞–∫—É—é—á–æ–º—É.
4. –ü–æ–≤—Ç–æ—Ä—é–π—Ç–µ –±–µ–∑–ø–µ—Ä–µ—Ä–≤–Ω–æ, —â–æ–± –ø–æ–±—É–¥—É–≤–∞—Ç–∏ RTT-–ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ, –Ω–µ –∑‚Äô—è–≤–ª—è—é—á–∏—Å—å –≤ —á–∞—Ç-–ª–∏—Å—Ç—ñ –∂–µ—Ä—Ç–≤–∏.

## Recycling edits and deletes as covert triggers

* **–ü–æ–≤—Ç–æ—Ä–Ω—ñ –≤–∏–¥–∞–ª–µ–Ω–Ω—è:** –ü—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±—É–ª–æ deleted-for-everyone –æ–¥–∏–Ω —Ä–∞–∑, –ø–æ–¥–∞–ª—å—à—ñ delete packets, —â–æ –ø–æ—Å–∏–ª–∞—é—Ç—å—Å—è –Ω–∞ —Ç–æ–π —Å–∞–º–∏–π `message_id`, –Ω–µ –º–∞—é—Ç—å UI-–µ—Ñ–µ–∫—Ç—É, –∞–ª–µ –∫–æ–∂–µ–Ω –ø—Ä–∏—Å—Ç—Ä—ñ–π –≤—Å–µ –æ–¥–Ω–æ –¥–µ—à–∏—Ñ—Ä—É—î –π –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î —ó—Ö.
* **–û–ø–µ—Ä–∞—Ü—ñ—ó –ø–æ–∑–∞ –≤—ñ–∫–Ω–æ–º:** WhatsApp –Ω–∞–∫–ª–∞–¥–∞—î ~60 h –¥–ª—è delete / ~20 min –¥–ª—è edit —É UI; Signal –Ω–∞–∫–ª–∞–¥–∞—î ~48 h. –ó–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω—ñ protocol messages –ø–æ–∑–∞ —Ü–∏–º–∏ –≤—ñ–∫–Ω–∞–º–∏ –Ω–∞ –ø—Ä–∏—Å—Ç—Ä–æ—ó –∂–µ—Ä—Ç–≤–∏ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è –±–µ–∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, –∞–ª–µ receipts –≤—Å–µ –æ–¥–Ω–æ –ø–µ—Ä–µ–¥–∞—é—Ç—å—Å—è, —Ç–æ–∂ –∞—Ç–∞–∫—É–≤–∞–ª—å–Ω–∏–∫–∏ –º–æ–∂—É—Ç—å probe –±–µ–∑—Å—Ç—Ä–æ–∫–æ–≤–æ –ø—ñ—Å–ª—è –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è —Ä–æ–∑–º–æ–≤–∏.
* **–ù–µ–≤—ñ—Ä–Ω—ñ payloads:** –ü–æ—à–∫–æ–¥–∂–µ–Ω—ñ edit bodies –∞–±–æ deletes, —â–æ –ø–æ—Å–∏–ª–∞—é—Ç—å—Å—è –Ω–∞ –≤–∂–µ –≤–∏–¥–∞–ª–µ–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, –≤–∏–∫–ª–∏–∫–∞—é—Ç—å —Ç—É –∂ –ø–æ–≤–µ–¥—ñ–Ω–∫—É ‚Äî –¥–µ—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø–ª—é—Å receipt, –Ω—É–ª—å –≤–∏–¥–∏–º–∏—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ñ–≤ –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.

## Multi-device amplification & fingerprinting

* –ö–æ–∂–µ–Ω –ø–æ–≤‚Äô—è–∑–∞–Ω–∏–π –ø—Ä–∏—Å—Ç—Ä—ñ–π (—Ç–µ–ª–µ—Ñ–æ–Ω, desktop app, browser companion) –¥–µ—à–∏—Ñ—Ä—É—î probe –Ω–µ–∑–∞–ª–µ–∂–Ω–æ —ñ –ø–æ–≤–µ—Ä—Ç–∞—î –≤–ª–∞—Å–Ω–∏–π ack. –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ receipts –∑–∞ probe –≤–∏—è–≤–ª—è—î —Ç–æ—á–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤.
* –Ø–∫—â–æ –ø—Ä–∏—Å—Ç—Ä—ñ–π –æ—Ñ–ª–∞–π–Ω, –π–æ–≥–æ receipt —Å—Ç–∞–≤–∏—Ç—å—Å—è –≤ —á–µ—Ä–≥—É —ñ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º—É –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—ñ. Gaps therefore leak online/offline cycles —ñ –Ω–∞–≤—ñ—Ç—å —Ä–æ–∑–∫–ª–∞–¥ –ø–æ—ó–∑–¥–æ–∫ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, desktop receipts –∑–Ω–∏–∫–∞—é—Ç—å –ø—ñ–¥ —á–∞—Å –ø–æ–¥–æ—Ä–æ–∂–µ–π).
* –†–æ–∑–ø–æ–¥—ñ–ª–∏ RTT –≤—ñ–¥—Ä—ñ–∑–Ω—è—é—Ç—å—Å—è –∑–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏ —á–µ—Ä–µ–∑ OS power management —ñ –º–µ—Ö–∞–Ω—ñ–∑–º–∏ push wakeups. –ö–ª–∞—Å—Ç–µ—Ä–∏–∑—É–π—Ç–µ RTT (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, k-means –ø–æ median/variance –æ–∑–Ω–∞–∫–∞—Ö), —â–æ–± –ø–æ–∑–Ω–∞—á–∏—Ç–∏ ‚ÄúAndroid handset", ‚ÄúiOS handset", ‚ÄúElectron desktop" —Ç–æ—â–æ.
* –û—Å–∫—ñ–ª—å–∫–∏ sender –ø–æ–≤–∏–Ω–µ–Ω –æ—Ç—Ä–∏–º–∞—Ç–∏ recipient‚Äôs key inventory –ø–µ—Ä–µ–¥ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è–º, –∞—Ç–∞–∫—É—é—á–∏–π —Ç–∞–∫–æ–∂ –º–æ–∂–µ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏, –∫–æ–ª–∏ –¥–æ–¥–∞—é—Ç—å—Å—è –Ω–æ–≤—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó; —Ä–∞–ø—Ç–æ–≤–µ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤ –∞–±–æ –Ω–æ–≤–∏–π RTT-–∫–ª–∞—Å—Ç–µ—Ä —î —Å–∏–ª—å–Ω–∏–º —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º.

## Behaviour inference from RTT traces

1. –ó–±–∏—Ä–∞–π—Ç–µ –≤–∏–±—ñ—Ä–∫–∏ –ø—Ä–∏ ‚â•1 Hz, —â–æ–± –∑–∞—Ö–æ–ø–∏—Ç–∏ –µ—Ñ–µ–∫—Ç–∏ –ø–ª–∞–Ω—É–≤–∞–Ω–Ω—è –û–°. –î–ª—è WhatsApp –Ω–∞ iOS RTT <1 s —Å–∏–ª—å–Ω–æ –∫–æ—Ä–µ–ª—é—î –∑ screen-on/foreground, >1 s ‚Äî –∑ screen-off/background throttling.
2. –ü–æ–±—É–¥—É–π—Ç–µ –ø—Ä–æ—Å—Ç—ñ –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏ (thresholding –∞–±–æ two-cluster k-means), —â–æ –≤—ñ–¥–º—ñ—á–∞—é—Ç—å –∫–æ–∂–µ–Ω RTT —è–∫ "active" –∞–±–æ "idle". –ê–≥—Ä–µ–≥—É–π—Ç–µ –º—ñ—Ç–∫–∏ –≤ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ, —â–æ–± –≤–∏–≤–µ—Å—Ç–∏ bedtimes, commutes, —Ä–æ–±–æ—á—ñ –≥–æ–¥–∏–Ω–∏ –∞–±–æ –∫–æ–ª–∏ –∞–∫—Ç–∏–≤–Ω–∏–π desktop companion.
3. –ö–æ—Ä–µ–ª—é–π—Ç–µ –æ–¥–Ω–æ—á–∞—Å–Ω—ñ probe –¥–æ –≤—Å—ñ—Ö –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤, —â–æ–± –±–∞—á–∏—Ç–∏, –∫–æ–ª–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –ø–µ—Ä–µ—Ö–æ–¥—è—Ç—å –∑ –º–æ–±—ñ–ª—å–Ω–æ–≥–æ –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø, –∫–æ–ª–∏ companions –≤—ñ–¥–∫–ª—é—á–∞—é—Ç—å—Å—è —ñ —á–∏ –æ–±–º–µ–∂—É—î—Ç—å—Å—è –¥–æ–¥–∞—Ç–æ–∫ rate limiting —á–µ—Ä–µ–∑ push vs persistent socket.

## Stealthy resource exhaustion

–û—Å–∫—ñ–ª—å–∫–∏ –∫–æ–∂–µ–Ω silent probe –º–∞—î –±—É—Ç–∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —ñ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–∏–π, –±–µ–∑–ø–µ—Ä–µ—Ä–≤–Ω–µ –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è toggle —Ä–µ–∞–∫—Ü—ñ–π, invalid edits –∞–±–æ delete-for-everyone –ø–∞–∫–µ—Ç—ñ–≤ —Å—Ç–≤–æ—Ä—é—î application-layer DoS:

* –ü—Ä–∏–º—É—à—É—î —Ä–∞–¥—ñ–æ/–º–æ–¥–µ–º –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏/–ø—Ä–∏–π–º–∞—Ç–∏ –∫–æ–∂–Ω—É —Å–µ–∫—É–Ω–¥—É ‚Üí –ø–æ–º—ñ—Ç–Ω–µ –≤–∏—Ç—Ä–∞—á–∞–Ω–Ω—è –±–∞—Ç–∞—Ä–µ—ó, –æ—Å–æ–±–ª–∏–≤–æ –Ω–∞ idle handsets.
* –ì–µ–Ω–µ—Ä—É—î –Ω–µ–º–∞—Ä–∫—ñ—Ä–æ–≤–∞–Ω–∏–π upstream/downstream —Ç—Ä–∞—Ñ—ñ–∫, —â–æ —Å–ø–æ–∂–∏–≤–∞—î –º–æ–±—ñ–ª—å–Ω—ñ data plans, –º–∞—Å–∫—É—é—á–∏—Å—å –ø—ñ–¥ TLS/WebSocket —à—É–º.
* –ó–∞–π–º–∞—î crypto threads —ñ –¥–æ–¥–∞—î jitter —É latency-sensitive —Ñ—É–Ω–∫—Ü—ñ—ó (VoIP, –≤—ñ–¥–µ–æ–¥–∑–≤—ñ–Ω–∫–∏), –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω—ñ–∫–æ–ª–∏ –Ω–µ –±–∞—á–∏—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å.

## References

- [Careless Whisper: Exploiting Silent Delivery Receipts to Monitor Users on Mobile Instant Messengers](https://arxiv.org/html/2411.11194v4)
- [whatsmeow](https://github.com/tulir/whatsmeow)
- [Cobalt](https://github.com/Auties00/Cobalt)
- [signal-cli](https://github.com/AsamK/signal-cli)
- [libsignal-service-java](https://github.com/signalapp/libsignal-service-java)

{{#include ../banners/hacktricks-training.md}}
