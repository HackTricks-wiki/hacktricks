{{#include ../../banners/hacktricks-training.md}}

# **TTL Manipulation**

Στείλτε κάποια πακέτα με TTL αρκετό για να φτάσουν στο IDS/IPS αλλά όχι αρκετό για να φτάσουν στο τελικό σύστημα. Και μετά, στείλτε άλλα πακέτα με τις ίδιες ακολουθίες όπως τα προηγούμενα, έτσι ώστε το IPS/IDS να νομίζει ότι είναι επαναλήψεις και να μην τα ελέγξει, αλλά στην πραγματικότητα μεταφέρουν το κακόβουλο περιεχόμενο.

**Nmap option:** `--ttlvalue <value>`

# Avoiding signatures

Απλά προσθέστε άχρηστα δεδομένα στα πακέτα ώστε να αποφευχθεί η υπογραφή του IPS/IDS.

**Nmap option:** `--data-length 25`

# **Fragmented Packets**

Απλά σπάστε τα πακέτα και στείλτε τα. Αν το IDS/IPS δεν έχει τη δυνατότητα να τα επανασυναρμολογήσει, θα φτάσουν στον τελικό υπολογιστή.

**Nmap option:** `-f`

# **Invalid** _**checksum**_

Οι αισθητήρες συνήθως δεν υπολογίζουν το checksum για λόγους απόδοσης. Έτσι, ένας επιτιθέμενος μπορεί να στείλει ένα πακέτο που θα **ερμηνευθεί από τον αισθητήρα αλλά θα απορριφθεί από τον τελικό υπολογιστή.** Παράδειγμα:

Στείλτε ένα πακέτο με τη σημαία RST και ένα άκυρο checksum, έτσι ώστε το IPS/IDS να νομίζει ότι αυτό το πακέτο θα κλείσει τη σύνδεση, αλλά ο τελικός υπολογιστής θα απορρίψει το πακέτο καθώς το checksum είναι άκυρο.

# **Uncommon IP and TCP options**

Ένας αισθητήρας μπορεί να αγνοήσει πακέτα με ορισμένες σημαίες και επιλογές που έχουν οριστεί στα IP και TCP headers, ενώ ο προορισμός υπολογιστής αποδέχεται το πακέτο κατά την παραλαβή.

# **Overlapping**

Είναι πιθανό όταν σπάτε ένα πακέτο, να υπάρχει κάποια μορφή επικαλυπτόμενης περιοχής μεταξύ των πακέτων (ίσως τα πρώτα 8 bytes του πακέτου 2 να επικαλύπτονται με τα τελευταία 8 bytes του πακέτου 1, και τα 8 τελευταία bytes του πακέτου 2 να επικαλύπτονται με τα πρώτα 8 bytes του πακέτου 3). Έτσι, αν το IDS/IPS τα επανασυναρμολογήσει με διαφορετικό τρόπο από τον τελικό υπολογιστή, ένα διαφορετικό πακέτο θα ερμηνευθεί.\
Ή ίσως, 2 πακέτα με την ίδια μετατόπιση έρχονται και ο υπολογιστής πρέπει να αποφασίσει ποιο θα κρατήσει.

- **BSD**: Έχει προτίμηση για πακέτα με μικρότερη _offset_. Για πακέτα με την ίδια μετατόπιση, θα επιλέξει το πρώτο.
- **Linux**: Όπως το BSD, αλλά προτιμά το τελευταίο πακέτο με την ίδια μετατόπιση.
- **First** (Windows): Πρώτη τιμή που έρχεται, τιμή που μένει.
- **Last** (cisco): Τελευταία τιμή που έρχεται, τιμή που μένει.

# Tools

- [https://github.com/vecna/sniffjoke](https://github.com/vecna/sniffjoke)

{{#include ../../banners/hacktricks-training.md}}
