{{#include ../../banners/hacktricks-training.md}}

# **TTL 조작**

IDS/IPS에 도달할 수 있을 만큼의 TTL을 가진 패킷을 보내되, 최종 시스템에는 도달하지 않도록 합니다. 그런 다음, 다른 패킷과 동일한 시퀀스를 가진 패킷을 다시 보내면 IPS/IDS는 이를 반복으로 간주하고 검사를 하지 않지만, 실제로는 악성 콘텐츠를 포함하고 있습니다.

**Nmap 옵션:** `--ttlvalue <value>`

# 서명 회피

패킷에 쓰레기 데이터를 추가하여 IPS/IDS 서명을 회피합니다.

**Nmap 옵션:** `--data-length 25`

# **조각화된 패킷**

패킷을 조각화하여 전송합니다. IDS/IPS가 이를 재조립할 수 없는 경우, 최종 호스트에 도달하게 됩니다.

**Nmap 옵션:** `-f`

# **유효하지 않은** _**체크섬**_

센서는 일반적으로 성능상의 이유로 체크섬을 계산하지 않습니다. 따라서 공격자는 **센서에 의해 해석되지만 최종 호스트에 의해 거부되는** 패킷을 보낼 수 있습니다. 예:

RST 플래그와 유효하지 않은 체크섬을 가진 패킷을 보내면, IPS/IDS는 이 패킷이 연결을 종료할 것이라고 생각할 수 있지만, 최종 호스트는 체크섬이 유효하지 않기 때문에 패킷을 폐기합니다.

# **비정상적인 IP 및 TCP 옵션**

센서는 IP 및 TCP 헤더 내에서 특정 플래그와 옵션이 설정된 패킷을 무시할 수 있지만, 목적지 호스트는 수신 시 패킷을 수용합니다.

# **중첩**

패킷을 조각화할 때 패킷 간에 어떤 종류의 중첩이 존재할 수 있습니다(예: 패킷 2의 처음 8바이트가 패킷 1의 마지막 8바이트와 중첩되고, 패킷 2의 마지막 8바이트가 패킷 3의 처음 8바이트와 중첩됨). 그런 다음 IDS/IPS가 이를 최종 호스트와 다르게 재조립하면 다른 패킷으로 해석될 수 있습니다.\
또는 동일한 오프셋을 가진 2개의 패킷이 도착하고 호스트가 어떤 것을 선택해야 할 수도 있습니다.

- **BSD**: 작은 _오프셋_을 가진 패킷을 선호합니다. 동일한 오프셋을 가진 패킷의 경우 첫 번째 것을 선택합니다.
- **Linux**: BSD와 유사하지만 동일한 오프셋을 가진 마지막 패킷을 선호합니다.
- **First** (Windows): 도착하는 첫 번째 값, 유지되는 값.
- **Last** (cisco): 도착하는 마지막 값, 유지되는 값.

# 도구

- [https://github.com/vecna/sniffjoke](https://github.com/vecna/sniffjoke)

{{#include ../../banners/hacktricks-training.md}}
