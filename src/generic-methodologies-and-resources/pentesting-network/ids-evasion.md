{{#include ../../banners/hacktricks-training.md}}

# **TTL Manipulation**

Tuma baadhi ya pakiti zenye TTL ya kutosha kufika kwenye IDS/IPS lakini si ya kutosha kufika kwenye mfumo wa mwisho. Kisha, tuma pakiti nyingine zenye mfuatano sawa na zile nyingine ili IPS/IDS ifikirie kwamba ni kurudiwa na haitazikagua, lakini kwa kweli zinabeba maudhui ya uhalifu.

**Nmap option:** `--ttlvalue <value>`

# Avoiding signatures

Ongeza tu data za takataka kwenye pakiti ili saini ya IPS/IDS ipuuziliwe mbali.

**Nmap option:** `--data-length 25`

# **Fragmented Packets**

Piga tu pakiti na uzitume. Ikiwa IDS/IPS haina uwezo wa kuziunganisha tena, zitaenda kwa mwenyeji wa mwisho.

**Nmap option:** `-f`

# **Invalid** _**checksum**_

Vihisi kwa kawaida havihesabu checksum kwa sababu za utendaji. Hivyo mshambuliaji anaweza kutuma pakiti ambayo itakuwa **imefasiriwa na kihisi lakini itakataliwa na mwenyeji wa mwisho.** Mfano:

Tuma pakiti yenye bendera RST na checksum isiyo sahihi, hivyo basi, IPS/IDS inaweza kufikiri kwamba pakiti hii inakwenda kufunga muunganisho, lakini mwenyeji wa mwisho atatupa pakiti hiyo kwa sababu checksum si sahihi.

# **Uncommon IP and TCP options**

Kihisi kinaweza kupuuza pakiti zenye bendera na chaguo fulani zilizowekwa ndani ya vichwa vya IP na TCP, wakati mwenyeji wa marudio anakubali pakiti hiyo mara inapopokelewa.

# **Overlapping**

Inawezekana kwamba unapovunja pakiti, kuna aina fulani ya kuingiliana kati ya pakiti (labda byte 8 za kwanza za pakiti 2 zinaingiliana na byte 8 za mwisho za pakiti 1, na byte 8 za mwisho za pakiti 2 zinaingiliana na byte 8 za kwanza za pakiti 3). Kisha, ikiwa IDS/IPS itaziunganisha kwa njia tofauti na mwenyeji wa mwisho, pakiti tofauti itafasiriwa.\
Au labda, pakiti 2 zenye offset sawa zinakuja na mwenyeji lazima aamua ipi inachukuliwa.

- **BSD**: Ina upendeleo kwa pakiti zenye _offset_ ndogo. Kwa pakiti zenye offset sawa, itachagua ya kwanza.
- **Linux**: Kama BSD, lakini inapendelea pakiti ya mwisho yenye offset sawa.
- **First** (Windows): Thamani ya kwanza inayokuja, thamani inayobaki.
- **Last** (cisco): Thamani ya mwisho inayokuja, thamani inayobaki.

# Tools

- [https://github.com/vecna/sniffjoke](https://github.com/vecna/sniffjoke)

{{#include ../../banners/hacktricks-training.md}}
