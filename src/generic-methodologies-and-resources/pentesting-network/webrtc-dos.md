# WebRTC DoS

{{#include ../../banners/hacktricks-training.md}}

**Tatizo hili lilipatikana katika chapisho hili la blog:** [**https://www.rtcsec.com/article/novel-dos-vulnerability-affecting-webrtc-media-servers/**](https://www.rtcsec.com/article/novel-dos-vulnerability-affecting-webrtc-media-servers/)

Uthibitisho wa udhaifu ulioelezwa katika seva za media za WebRTC unatokana na **hali ya mbio** wakati wa kuanzisha vikao vya media, hasa kati ya **uthibitishaji wa idhini ya media ya ICE** na **kuanzishwa kwa trafiki ya DTLS**. Hapa kuna muhtasari wa kina:

### Chanzo cha Udhihirisho

1. **Ugawaji wa Bandari za UDP:** Wakati mtumiaji anaanzisha simu ya WebRTC, seva ya media inagawa bandari za UDP kwa ajili ya kushughulikia mitiririko ya media, huku IP na bandari zik komunikwa kupitia ishara.
2. **Mchakato wa ICE na STUN:** Kivinjari cha mtumiaji kinatumia ICE kwa uthibitishaji wa idhini ya media, kikitumia STUN kubaini njia ya muunganisho hadi seva ya media.
3. **Kikao cha DTLS:** Baada ya uthibitishaji wa STUN kufanikiwa, kikao cha DTLS kinaanzishwa ili kuunda funguo za SRTP, kikibadilisha kuwa SRTP kwa ajili ya mtiririko wa media.

### Mekaniki ya Ukatili

- **Ukatili wa Hali ya Mbio:** Mshambuliaji anaweza kutumia hali ya mbio kwa kutuma ujumbe wa DTLS ClientHello kabla ya mtumiaji halali, akitumia seti ya cipher isiyo sahihi kama `TLS_NULL_WITH_NULL_NULL`. Hii husababisha kosa la DTLS kwenye seva, ikizuia kikao cha SRTP kuanzishwa.

### Mchakato wa Shambulio

- **Kuchunguza Bandari:** Mshambuliaji anahitaji kukisia ni bandari zipi za UDP zinazosimamia vikao vya media vinavyokuja, akituma ujumbe wa ClientHello na seti ya cipher isiyo na kitu kwa bandari hizi ili kuchochea udhaifu.
- **Mchoro wa Shambulio:** Mfuatano unajumuisha ujumbe wengi wa ClientHello wanaotumwa na mshambuliaji kwa seva, ukichanganywa na ishara halali na ujumbe wa DTLS, ukisababisha kushindwa kwa mkono kutokana na seti ya cipher isiyo sahihi.

### Upimaji na Kupunguza

- **Upimaji Salama:** Kwa kutumia zana kama Scapy, washambuliaji wanarejelea ujumbe wa DTLS ClientHello wakilenga bandari maalum za media. Kwa ajili ya upimaji wa kimaadili, marekebisho kwa Chromium (mfano, `JsepTransport::AddRemoteCandidates`) yalitumika kuiga tabia ya mwathirika kwa usalama.
- **Hatua za Kupunguza:** Suluhisho zinajumuisha kuangamiza pakiti kutoka kwa anwani zisizothibitishwa, kama ilivyotekelezwa katika matoleo mapya ya maktaba kama libnice. Suluhisho kuu linasisitiza kuamini mchakato wa uthibitishaji wa ICE na kushughulikia pakiti tu kutoka kwa mchanganyiko wa IP na bandari zilizothibitishwa.

### Mifano Isiyo na Udhihirisho

- **Mikakati ya Seva za DTLS:** Matukio ambapo kivinjari kinatumika kama seva ya DTLS au wakati seva ya media haitumii bandari za muda kwa vikao vya media hayana udhaifu huu.

### Hitimisho

Udhaifu huu unaonyesha usawa mwembamba katika mchakato wa kuanzisha vikao vya media na hitaji la wakati sahihi na mekaniki za uthibitishaji ili kuzuia ukatili. Wanakuza wanashauriwa kutekeleza marekebisho ya usalama yaliyopendekezwa na kuhakikisha mchakato wa uthibitishaji ni thabiti ili kupunguza udhaifu kama huu.

{{#include ../../banners/hacktricks-training.md}}
