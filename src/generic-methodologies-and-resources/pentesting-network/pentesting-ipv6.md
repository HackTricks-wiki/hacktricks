{{#include ../../banners/hacktricks-training.md}}

# IPv6 Temel Teori

## Ağlar

IPv6 adresleri, ağ organizasyonunu ve cihaz etkileşimini geliştirmek için yapılandırılmıştır. Bir IPv6 adresi şu şekilde bölünmüştür:

1. **Ağ Ön Eki**: Ağ segmentini belirleyen ilk 48 bit.
2. **Alt Ağ Kimliği**: Ağ içindeki belirli alt ağları tanımlamak için kullanılan sonraki 16 bit.
3. **Arayüz Tanımlayıcı**: Alt ağ içindeki bir cihazı benzersiz şekilde tanımlayan son 64 bit.

IPv6, IPv4'te bulunan ARP protokolünü hariç tutarken, iki ana mesajla **ICMPv6**'yı tanıtır:

- **Komşu İsteği (NS)**: Adres çözümü için çoklu yayın mesajları.
- **Komşu İlanı (NA)**: NS'ye veya kendiliğinden ilanlara yanıt olarak tekil yanıtlar.

IPv6 ayrıca özel adres türlerini de içerir:

- **Döngü Geri Adresi (`::1`)**: IPv4'teki `127.0.0.1` ile eşdeğer, ana bilgisayar içindeki iletişim için.
- **Bağlantı Yerel Adresleri (`FE80::/10`)**: Yerel ağ etkinlikleri için, internet yönlendirmesi için değil. Aynı yerel ağdaki cihazlar bu aralığı kullanarak birbirlerini keşfedebilirler.

### IPv6'nın Ağ Komutlarındaki Pratik Kullanımı

IPv6 ağlarıyla etkileşimde bulunmak için çeşitli komutlar kullanabilirsiniz:

- **Bağlantı Yerel Adresleri ile Ping**: `ping6` kullanarak yerel cihazların varlığını kontrol edin.
- **Komşu Keşfi**: Bağlantı katmanında keşfedilen cihazları görüntülemek için `ip neigh` kullanın.
- **alive6**: Aynı ağdaki cihazları keşfetmek için alternatif bir araç.

Aşağıda bazı komut örnekleri bulunmaktadır:
```bash
ping6 –I eth0 -c 5 ff02::1 > /dev/null 2>&1
ip neigh | grep ^fe80

# Alternatively, use alive6 for neighbor discovery
alive6 eth0
```
IPv6 adresleri, yerel iletişim için bir cihazın MAC adresinden türetilebilir. Bilinen bir MAC adresinden Link-local IPv6 adresini türetme ve bir ağ içinde IPv6 adreslerini keşfetme yöntemleri hakkında kısa bir genel bakış.

## **MAC Adresinden Link-local IPv6 Türetme**

Bir MAC adresi **`12:34:56:78:9a:bc`** verildiğinde, Link-local IPv6 adresini şu şekilde oluşturabilirsiniz:

1. MAC'i IPv6 formatına çevirin: **`1234:5678:9abc`**
2. `fe80::` ekleyin ve ortasına `fffe` yerleştirin: **`fe80::1234:56ff:fe78:9abc`**
3. Soldan yedinci biti ters çevirin, `1234`'ü `1034` olarak değiştirin: **`fe80::1034:56ff:fe78:9abc`**

## **IPv6 Adres Türleri**

- **Unique Local Address (ULA)**: Yerel iletişim için, kamu internet yönlendirmesi için tasarlanmamıştır. Ön ek: **`FEC00::/7`**
- **Multicast Address**: Birden bire iletişim için. Multicast grubundaki tüm arayüzlere iletilir. Ön ek: **`FF00::/8`**
- **Anycast Address**: Birden en yakın iletişim için. Yönlendirme protokolüne göre en yakın arayüze gönderilir. **`2000::/3`** küresel unicast aralığının bir parçasıdır.

## **Adres Ön Ekleri**

- **fe80::/10**: Link-Local adresler (169.254.x.x'e benzer)
- **fc00::/7**: Unique Local-Unicast (10.x.x.x, 172.16.x.x, 192.168.x.x gibi özel IPv4 aralıklarına benzer)
- **2000::/3**: Küresel Unicast
- **ff02::1**: Multicast Tüm Düğümler
- **ff02::2**: Multicast Yönlendirici Düğümleri

## **Ağ İçinde IPv6 Adreslerini Keşfetme**

### Yol 1: Link-local Adresleri Kullanarak

1. Ağ içindeki bir cihazın MAC adresini edinin.
2. MAC adresinden Link-local IPv6 adresini türetin.

### Yol 2: Multicast Kullanarak

1. Yerel ağda IPv6 adreslerini keşfetmek için `ff02::1` multicast adresine ping gönderin.
```bash
service ufw stop # Stop the firewall
ping6 -I <IFACE> ff02::1 # Send a ping to multicast address
ip -6 neigh # Display the neighbor table
```
## IPv6 Man-in-the-Middle (MitM) Saldırıları

IPv6 ağlarında MitM saldırılarını gerçekleştirmek için birkaç teknik bulunmaktadır, örneğin:

- ICMPv6 komşu veya yönlendirici reklamlarını sahtelemek.
- Yönlendirmeyi manipüle etmek için ICMPv6 yönlendirme veya "Paket Çok Büyük" mesajlarını kullanmak.
- Mobil IPv6'ya saldırmak (genellikle IPSec'in devre dışı bırakılmasını gerektirir).
- Sahte bir DHCPv6 sunucusu kurmak.

# IPv6 Adreslerini Belirleme

## Alt Alan Adlarını Keşfetme

IPv6 adresleriyle potansiyel olarak bağlantılı alt alan adlarını bulmanın bir yöntemi arama motorlarını kullanmaktır. Örneğin, `ipv6.*` gibi bir sorgu deseni etkili olabilir. Özellikle, Google'da şu arama komutunu kullanabilirsiniz:
```bash
site:ipv6./
```
## DNS Sorgularını Kullanma

IPv6 adreslerini belirlemek için belirli DNS kayıt türleri sorgulanabilir:

- **AXFR**: Tam bir alan transferi talep eder, potansiyel olarak geniş bir DNS kayıt yelpazesini ortaya çıkarır.
- **AAAA**: Doğrudan IPv6 adreslerini arar.
- **ANY**: Tüm mevcut DNS kayıtlarını döndüren geniş bir sorgu.

## Ping6 ile Sondaj Yapma

Bir organizasyonla ilişkili IPv6 adresleri belirlendikten sonra, `ping6` aracı sondaj yapmak için kullanılabilir. Bu araç, belirlenen IPv6 adreslerinin yanıt verebilirliğini değerlendirmeye yardımcı olur ve ayrıca komşu IPv6 cihazlarını keşfetmeye de yardımcı olabilir.

## Referanslar

- [http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html](http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html)
- [https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904](https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904)

{{#include ../../banners/hacktricks-training.md}}
