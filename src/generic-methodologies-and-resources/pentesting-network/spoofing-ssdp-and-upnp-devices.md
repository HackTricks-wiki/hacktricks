# Спуфінг пристроїв SSDP та UPnP за допомогою EvilSSDP

{{#include ../../banners/hacktricks-training.md}}

**Перевірте [https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/) для отримання додаткової інформації.**

## **Огляд SSDP та UPnP**

SSDP (Протокол простого виявлення послуг) використовується для реклами та виявлення мережевих послуг, працюючи на UDP порту 1900 без необхідності в налаштуваннях DHCP або DNS. Він є основоположним у архітектурі UPnP (Універсальне підключення та відтворення), що полегшує безперешкодну взаємодію між мережевими пристроями, такими як ПК, принтери та мобільні пристрої. Нульова конфігурація мережі UPnP підтримує виявлення пристроїв, призначення IP-адрес та рекламу послуг.

## **Потік та структура UPnP**

Архітектура UPnP складається з шести рівнів: адресація, виявлення, опис, управління, події та презентація. Спочатку пристрої намагаються отримати IP-адресу або самостійно призначити одну (AutoIP). Фаза виявлення включає SSDP, при цьому пристрої активно надсилають запити M-SEARCH або пасивно транслюють повідомлення NOTIFY для оголошення послуг. Контрольний рівень, важливий для взаємодії клієнта з пристроєм, використовує SOAP-повідомлення для виконання команд на основі описів пристроїв у XML-файлах.

## **Огляд IGD та інструментів**

IGD (Пристрій Інтернет-шлюзу) полегшує тимчасове відображення портів у NAT-налаштуваннях, дозволяючи приймати команди через відкриті контрольні точки SOAP, незважаючи на стандартні обмеження інтерфейсу WAN. Інструменти, такі як **Miranda**, допомагають у виявленні послуг UPnP та виконанні команд. **Umap** відкриває команди UPnP, доступні з WAN, тоді як репозиторії, такі як **upnp-arsenal**, пропонують різноманітні інструменти UPnP. **Evil SSDP** спеціалізується на фішингу через спуфінг пристроїв UPnP, пропонуючи шаблони для імітації легітимних послуг.

## **Практичне використання Evil SSDP**

Evil SSDP ефективно створює переконливі фальшиві пристрої UPnP, маніпулюючи користувачами, щоб вони взаємодіяли з на вигляд автентичними послугами. Користувачі, обмануті справжнім виглядом, можуть надати чутливу інформацію, таку як облікові дані. Універсальність інструменту поширюється на різні шаблони, імітуючи послуги, такі як сканери, Office365 і навіть сховища паролів, використовуючи довіру користувачів та видимість мережі. Після захоплення облікових даних зловмисники можуть перенаправити жертв на призначені URL-адреси, підтримуючи достовірність обману.

## **Стратегії пом'якшення**

Для боротьби з цими загрозами рекомендуються такі заходи:

- Вимкнення UPnP на пристроях, коли це не потрібно.
- Освіта користувачів про фішинг та мережеву безпеку.
- Моніторинг мережевого трафіку на предмет незашифрованих чутливих даних.

У суті, хоча UPnP пропонує зручність та мережеву гнучкість, він також відкриває двері для потенційної експлуатації. Обізнаність та проактивний захист є ключовими для забезпечення цілісності мережі.

{{#include ../../banners/hacktricks-training.md}}
