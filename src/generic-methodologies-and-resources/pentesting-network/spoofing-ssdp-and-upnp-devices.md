# Spoofing SSDP et UPnP Devices avec EvilSSDP

{{#include ../../banners/hacktricks-training.md}}

**Vérifiez [https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/) pour plus d'informations.**

## **Aperçu de SSDP & UPnP**

SSDP (Simple Service Discovery Protocol) est utilisé pour la publicité et la découverte de services réseau, fonctionnant sur le port UDP 1900 sans nécessiter de configurations DHCP ou DNS. Il est fondamental dans l'architecture UPnP (Universal Plug and Play), facilitant l'interaction transparente entre les appareils en réseau comme les PC, les imprimantes et les appareils mobiles. Le réseau sans configuration d'UPnP prend en charge la découverte d'appareils, l'attribution d'adresses IP et la publicité de services.

## **Flux et Structure UPnP**

L'architecture UPnP se compose de six couches : adressage, découverte, description, contrôle, événements et présentation. Au départ, les appareils tentent d'obtenir une adresse IP ou d'en auto-attribuer une (AutoIP). La phase de découverte implique le SSDP, les appareils envoyant activement des requêtes M-SEARCH ou diffusant passivement des messages NOTIFY pour annoncer des services. La couche de contrôle, vitale pour l'interaction client-appareil, utilise des messages SOAP pour l'exécution de commandes basées sur les descriptions d'appareils dans des fichiers XML.

## **Aperçu IGD & Outils**

IGD (Internet Gateway Device) facilite les mappages de ports temporaires dans les configurations NAT, permettant l'acceptation de commandes via des points de contrôle SOAP ouverts malgré les restrictions de l'interface WAN standard. Des outils comme **Miranda** aident à la découverte de services UPnP et à l'exécution de commandes. **Umap** expose des commandes UPnP accessibles depuis WAN, tandis que des dépôts comme **upnp-arsenal** offrent une gamme d'outils UPnP. **Evil SSDP** se spécialise dans le phishing via des appareils UPnP usurpés, hébergeant des modèles pour imiter des services légitimes.

## **Utilisation Pratique d'Evil SSDP**

Evil SSDP crée efficacement de faux appareils UPnP convaincants, manipulant les utilisateurs pour interagir avec des services apparemment authentiques. Les utilisateurs, trompés par l'apparence authentique, peuvent fournir des informations sensibles comme des identifiants. La polyvalence de l'outil s'étend à divers modèles, imitant des services comme des scanners, Office365, et même des coffres-forts de mots de passe, capitalisant sur la confiance des utilisateurs et la visibilité du réseau. Après la capture des identifiants, les attaquants peuvent rediriger les victimes vers des URL désignées, maintenant la crédibilité de la tromperie.

## **Stratégies d'Atténuation**

Pour lutter contre ces menaces, les mesures recommandées incluent :

- Désactiver UPnP sur les appareils lorsqu'il n'est pas nécessaire.
- Éduquer les utilisateurs sur le phishing et la sécurité réseau.
- Surveiller le trafic réseau pour des données sensibles non chiffrées.

En essence, bien qu'UPnP offre commodité et fluidité réseau, il ouvre également la porte à une exploitation potentielle. La sensibilisation et la défense proactive sont essentielles pour garantir l'intégrité du réseau.

{{#include ../../banners/hacktricks-training.md}}
