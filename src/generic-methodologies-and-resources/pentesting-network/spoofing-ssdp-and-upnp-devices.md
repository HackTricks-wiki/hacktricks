# EvilSSDP를 이용한 SSDP 및 UPnP 장치 스푸핑

{{#include ../../banners/hacktricks-training.md}}

**자세한 정보는 [https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/)를 확인하세요.**

## **SSDP 및 UPnP 개요**

SSDP (Simple Service Discovery Protocol)는 네트워크 서비스 광고 및 검색에 사용되며, DHCP 또는 DNS 구성 없이 UDP 포트 1900에서 작동합니다. 이는 UPnP (Universal Plug and Play) 아키텍처에서 기본적이며, PC, 프린터 및 모바일 장치와 같은 네트워크 장치 간의 원활한 상호작용을 촉진합니다. UPnP의 제로 구성 네트워킹은 장치 검색, IP 주소 할당 및 서비스 광고를 지원합니다.

## **UPnP 흐름 및 구조**

UPnP 아키텍처는 주소 지정, 검색, 설명, 제어, 이벤트 및 프레젠테이션의 여섯 가지 계층으로 구성됩니다. 처음에 장치는 IP 주소를 얻거나 자가 할당(AutoIP)하려고 시도합니다. 검색 단계는 SSDP를 포함하며, 장치는 M-SEARCH 요청을 적극적으로 전송하거나 서비스를 알리기 위해 NOTIFY 메시지를 수동적으로 방송합니다. 클라이언트-장치 상호작용에 중요한 제어 계층은 XML 파일의 장치 설명을 기반으로 명령 실행을 위해 SOAP 메시지를 활용합니다.

## **IGD 및 도구 개요**

IGD (Internet Gateway Device)는 NAT 설정에서 임시 포트 매핑을 촉진하여 표준 WAN 인터페이스 제한에도 불구하고 열린 SOAP 제어 지점을 통해 명령 수락을 가능하게 합니다. **Miranda**와 같은 도구는 UPnP 서비스 검색 및 명령 실행을 지원합니다. **Umap**은 WAN에서 접근 가능한 UPnP 명령을 노출하며, **upnp-arsenal**과 같은 저장소는 다양한 UPnP 도구를 제공합니다. **Evil SSDP**는 스푸핑된 UPnP 장치를 통해 피싱을 전문으로 하며, 합법적인 서비스를 모방하는 템플릿을 호스팅합니다.

## **Evil SSDP 실용 사용법**

Evil SSDP는 설득력 있는 가짜 UPnP 장치를 효과적으로 생성하여 사용자가 겉보기에는 진짜 서비스와 상호작용하도록 조작합니다. 진짜처럼 보이는 외관에 속은 사용자는 자격 증명과 같은 민감한 정보를 제공할 수 있습니다. 이 도구의 다재다능함은 스캐너, Office365 및 비밀번호 금고와 같은 서비스를 모방하는 다양한 템플릿으로 확장되어 사용자 신뢰와 네트워크 가시성을 활용합니다. 자격 증명이 캡처된 후, 공격자는 피해자를 지정된 URL로 리디렉션하여 속임수의 신뢰성을 유지할 수 있습니다.

## **완화 전략**

이러한 위협에 대응하기 위해 권장되는 조치는 다음과 같습니다:

- 필요하지 않을 때 장치에서 UPnP 비활성화.
- 사용자에게 피싱 및 네트워크 보안 교육.
- 암호화되지 않은 민감한 데이터에 대한 네트워크 트래픽 모니터링.

본질적으로, UPnP는 편리함과 네트워크 유동성을 제공하지만, 잠재적인 악용의 문도 열어줍니다. 인식과 적극적인 방어가 네트워크 무결성을 보장하는 핵심입니다.

{{#include ../../banners/hacktricks-training.md}}
