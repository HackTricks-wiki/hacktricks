# Spoofing SSDP und UPnP Geräte mit EvilSSDP

{{#include ../../banners/hacktricks-training.md}}

**Überprüfen Sie [https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/) für weitere Informationen.**

## **SSDP & UPnP Übersicht**

SSDP (Simple Service Discovery Protocol) wird für die Werbung und Entdeckung von Netzwerkdiensten verwendet und arbeitet über den UDP-Port 1900, ohne dass DHCP- oder DNS-Konfigurationen erforderlich sind. Es ist grundlegend in der UPnP (Universal Plug and Play) Architektur, die eine nahtlose Interaktion zwischen vernetzten Geräten wie PCs, Druckern und mobilen Geräten ermöglicht. UPnP's Zero-Configuration-Netzwerk unterstützt die Gerätesuche, IP-Adressenzuweisung und Dienstwerbung.

## **UPnP Ablauf & Struktur**

Die UPnP-Architektur besteht aus sechs Schichten: Adressierung, Entdeckung, Beschreibung, Steuerung, Ereignisverarbeitung und Präsentation. Zunächst versuchen Geräte, eine IP-Adresse zu erhalten oder eine selbst zuzuweisen (AutoIP). Die Entdeckungsphase umfasst das SSDP, wobei Geräte aktiv M-SEARCH-Anfragen senden oder passiv NOTIFY-Nachrichten senden, um Dienste anzukündigen. Die Steuerungsschicht, die für die Interaktion zwischen Client und Gerät entscheidend ist, nutzt SOAP-Nachrichten zur Ausführung von Befehlen basierend auf Geräbeschreibungen in XML-Dateien.

## **IGD & Tools Übersicht**

IGD (Internet Gateway Device) ermöglicht temporäre Portzuweisungen in NAT-Setups und erlaubt die Annahme von Befehlen über offene SOAP-Steuerpunkte, trotz der Einschränkungen der Standard-WAN-Schnittstelle. Tools wie **Miranda** unterstützen die Entdeckung von UPnP-Diensten und die Ausführung von Befehlen. **Umap** macht WAN-zugängliche UPnP-Befehle sichtbar, während Repositories wie **upnp-arsenal** eine Vielzahl von UPnP-Tools anbieten. **Evil SSDP** spezialisiert sich auf Phishing über gefälschte UPnP-Geräte und hostet Vorlagen, um legitime Dienste zu imitieren.

## **Evil SSDP Praktische Nutzung**

Evil SSDP erstellt effektiv überzeugende gefälschte UPnP-Geräte und manipuliert Benutzer dazu, mit scheinbar authentischen Diensten zu interagieren. Benutzer, die durch das echte Aussehen getäuscht werden, könnten sensible Informationen wie Anmeldeinformationen bereitstellen. Die Vielseitigkeit des Tools erstreckt sich über verschiedene Vorlagen, die Dienste wie Scanner, Office365 und sogar Passwortmanager nachahmen und das Vertrauen der Benutzer sowie die Sichtbarkeit im Netzwerk ausnutzen. Nach der Erfassung von Anmeldeinformationen können Angreifer die Opfer auf festgelegte URLs umleiten und die Glaubwürdigkeit der Täuschung aufrechterhalten.

## **Minderungsstrategien**

Um diesen Bedrohungen entgegenzuwirken, werden folgende Maßnahmen empfohlen:

- Deaktivieren von UPnP auf Geräten, wenn es nicht benötigt wird.
- Aufklärung der Benutzer über Phishing und Netzwerksicherheit.
- Überwachung des Netzwerkverkehrs auf unverschlüsselte sensible Daten.

Im Wesentlichen bietet UPnP zwar Bequemlichkeit und Netzwerkfluidität, öffnet jedoch auch Türen für potenzielle Ausbeutung. Bewusstsein und proaktive Verteidigung sind der Schlüssel zur Gewährleistung der Netzwerkintegrität.

{{#include ../../banners/hacktricks-training.md}}
