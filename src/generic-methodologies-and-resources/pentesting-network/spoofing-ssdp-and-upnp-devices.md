# Spoofing SSDP e Dispositivos UPnP com EvilSSDP

{{#include ../../banners/hacktricks-training.md}}

**Verifique [https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/) para mais informações.**

## **Visão Geral do SSDP & UPnP**

SSDP (Simple Service Discovery Protocol) é utilizado para publicidade e descoberta de serviços de rede, operando na porta UDP 1900 sem necessidade de configurações DHCP ou DNS. É fundamental na arquitetura UPnP (Universal Plug and Play), facilitando a interação sem costura entre dispositivos em rede, como PCs, impressoras e dispositivos móveis. A rede de zero configuração do UPnP suporta descoberta de dispositivos, atribuição de endereços IP e publicidade de serviços.

## **Fluxo e Estrutura do UPnP**

A arquitetura UPnP é composta por seis camadas: endereçamento, descoberta, descrição, controle, eventos e apresentação. Inicialmente, os dispositivos tentam obter um endereço IP ou autoatribuir um (AutoIP). A fase de descoberta envolve o SSDP, com dispositivos enviando ativamente solicitações M-SEARCH ou transmitindo passivamente mensagens NOTIFY para anunciar serviços. A camada de controle, vital para a interação cliente-dispositivo, utiliza mensagens SOAP para execução de comandos com base nas descrições dos dispositivos em arquivos XML.

## **Visão Geral do IGD & Ferramentas**

IGD (Internet Gateway Device) facilita mapeamentos temporários de portas em configurações NAT, permitindo a aceitação de comandos através de pontos de controle SOAP abertos, apesar das restrições padrão da interface WAN. Ferramentas como **Miranda** ajudam na descoberta de serviços UPnP e na execução de comandos. **Umap** expõe comandos UPnP acessíveis pela WAN, enquanto repositórios como **upnp-arsenal** oferecem uma variedade de ferramentas UPnP. **Evil SSDP** se especializa em phishing via dispositivos UPnP falsificados, hospedando templates para imitar serviços legítimos.

## **Uso Prático do Evil SSDP**

Evil SSDP cria efetivamente dispositivos UPnP falsos convincentes, manipulando usuários a interagir com serviços aparentemente autênticos. Usuários, enganados pela aparência genuína, podem fornecer informações sensíveis, como credenciais. A versatilidade da ferramenta se estende a vários templates, imitando serviços como scanners, Office365 e até cofres de senhas, capitalizando a confiança do usuário e a visibilidade da rede. Após a captura de credenciais, os atacantes podem redirecionar as vítimas para URLs designadas, mantendo a credibilidade da enganação.

## **Estratégias de Mitigação**

Para combater essas ameaças, as medidas recomendadas incluem:

- Desabilitar UPnP em dispositivos quando não necessário.
- Educar os usuários sobre phishing e segurança de rede.
- Monitorar o tráfego da rede em busca de dados sensíveis não criptografados.

Em essência, enquanto o UPnP oferece conveniência e fluidez na rede, também abre portas para potenciais explorações. A conscientização e a defesa proativa são fundamentais para garantir a integridade da rede.

{{#include ../../banners/hacktricks-training.md}}
