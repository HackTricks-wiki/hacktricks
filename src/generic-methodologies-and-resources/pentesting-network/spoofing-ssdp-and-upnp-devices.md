# EvilSSDPを使用したSSDPおよびUPnPデバイスのスプーフィング

{{#include ../../banners/hacktricks-training.md}}

**詳細については[https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/)を確認してください。**

## **SSDP & UPnPの概要**

SSDP（Simple Service Discovery Protocol）は、ネットワークサービスの広告と発見に利用され、DHCPやDNSの設定を必要とせずにUDPポート1900で動作します。これはUPnP（Universal Plug and Play）アーキテクチャの基本であり、PC、プリンター、モバイルデバイスなどのネットワーク接続デバイス間のシームレスな相互作用を促進します。UPnPのゼロコンフィギュレーションネットワーキングは、デバイスの発見、IPアドレスの割り当て、およびサービスの広告をサポートします。

## **UPnPのフローと構造**

UPnPアーキテクチャは、アドレッシング、発見、説明、制御、イベント、プレゼンテーションの6層で構成されています。最初に、デバイスはIPアドレスを取得しようとするか、自動的に割り当てます（AutoIP）。発見フェーズでは、SSDPが関与し、デバイスはM-SEARCHリクエストを積極的に送信するか、サービスを発表するためにNOTIFYメッセージを受動的にブロードキャストします。制御層は、クライアントとデバイスの相互作用に不可欠であり、XMLファイル内のデバイス説明に基づいてコマンドを実行するためにSOAPメッセージを利用します。

## **IGD & ツールの概要**

IGD（Internet Gateway Device）は、NATセットアップで一時的なポートマッピングを促進し、標準のWANインターフェース制限にもかかわらず、オープンなSOAP制御ポイントを介してコマンドを受け入れることを可能にします。**Miranda**のようなツールは、UPnPサービスの発見とコマンドの実行を支援します。**Umap**はWANアクセス可能なUPnPコマンドを公開し、**upnp-arsenal**のようなリポジトリはさまざまなUPnPツールを提供します。**Evil SSDP**は、スプーフィングされたUPnPデバイスを介したフィッシングに特化しており、正当なサービスを模倣するためのテンプレートをホストしています。

## **Evil SSDPの実用的な使用法**

Evil SSDPは、信頼できる偽のUPnPデバイスを効果的に作成し、ユーザーを騙して見かけ上の正当なサービスと相互作用させます。真実のように見える外観に騙されたユーザーは、資格情報などの機密情報を提供する可能性があります。このツールの多様性は、スキャナー、Office365、さらにはパスワードボールトなどのサービスを模倣するさまざまなテンプレートにまで及び、ユーザーの信頼とネットワークの可視性を利用します。資格情報をキャプチャした後、攻撃者は被害者を指定されたURLにリダイレクトし、欺瞞の信頼性を維持します。

## **緩和戦略**

これらの脅威に対抗するために推奨される対策は以下の通りです：

- 不要な場合はデバイスでUPnPを無効にする。
- ユーザーにフィッシングとネットワークセキュリティについて教育する。
- 暗号化されていない機密データのネットワークトラフィックを監視する。

要するに、UPnPは便利さとネットワークの流動性を提供しますが、同時に潜在的な悪用の扉を開きます。意識と積極的な防御がネットワークの整合性を確保する鍵です。

{{#include ../../banners/hacktricks-training.md}}
