# 使用 EvilSSDP 伪装 SSDP 和 UPnP 设备

{{#include ../../banners/hacktricks-training.md}}

**查看 [https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/) 获取更多信息。**

## **SSDP 和 UPnP 概述**

SSDP（简单服务发现协议）用于网络服务广告和发现，运行在 UDP 端口 1900 上，无需 DHCP 或 DNS 配置。它在 UPnP（通用即插即用）架构中是基础，促进了网络设备（如 PC、打印机和移动设备）之间的无缝交互。UPnP 的零配置网络支持设备发现、IP 地址分配和服务广告。

## **UPnP 流程与结构**

UPnP 架构由六层组成：寻址、发现、描述、控制、事件和展示。最初，设备尝试获取 IP 地址或自我分配一个（AutoIP）。发现阶段涉及 SSDP，设备主动发送 M-SEARCH 请求或被动广播 NOTIFY 消息以宣布服务。控制层对于客户端与设备的交互至关重要，利用 SOAP 消息根据 XML 文件中的设备描述执行命令。

## **IGD 和工具概述**

IGD（互联网网关设备）在 NAT 设置中促进临时端口映射，允许通过开放的 SOAP 控制点接受命令，尽管标准 WAN 接口存在限制。像 **Miranda** 这样的工具有助于 UPnP 服务发现和命令执行。**Umap** 暴露可通过 WAN 访问的 UPnP 命令，而像 **upnp-arsenal** 这样的库提供了一系列 UPnP 工具。**Evil SSDP** 专注于通过伪装的 UPnP 设备进行钓鱼，托管模板以模仿合法服务。

## **Evil SSDP 实际使用**

Evil SSDP 有效地创建令人信服的假 UPnP 设备，操纵用户与看似真实的服务进行交互。用户被真实的外观所欺骗，可能会提供敏感信息，如凭据。该工具的多功能性扩展到各种模板，模仿扫描仪、Office365 甚至密码保险库等服务，利用用户的信任和网络可见性。在捕获凭据后，攻击者可以将受害者重定向到指定的 URL，保持欺骗的可信度。

## **缓解策略**

为了应对这些威胁，建议采取以下措施：

- 在不需要时禁用设备上的 UPnP。
- 教育用户有关钓鱼和网络安全的知识。
- 监控网络流量以查找未加密的敏感数据。

总之，虽然 UPnP 提供了便利和网络流动性，但它也为潜在的利用打开了大门。意识和主动防御是确保网络完整性的关键。

{{#include ../../banners/hacktricks-training.md}}
