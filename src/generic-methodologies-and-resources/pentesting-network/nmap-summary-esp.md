# Nmap सारांश (ESP)

{{#include ../../banners/hacktricks-training.md}}
```
nmap -sV -sC -O -n -oA nmapscan 192.168.0.1/24
```
## पैरामीटर

### स्कैन करने के लिए आईपी

- **`<ip>,<net/mask>`:** आईपी को सीधे इंगित करें
- **`-iL <ips_file>`:** list_IPs
- **`-iR <number>`**: यादृच्छिक आईपी की संख्या, आप संभावित आईपी को `--exclude <Ips>` या `--excludefile <file>` के साथ बाहर कर सकते हैं।

### उपकरण खोज

डिफ़ॉल्ट रूप से Nmap एक खोज चरण शुरू करता है जिसमें शामिल हैं: `-PA80 -PS443 -PE -PP`

- **`-sL`**: यह आक्रामक नहीं है, यह लक्ष्यों की सूची बनाता है जो नामों को हल करने के लिए **DNS** अनुरोध करते हैं। यह जानने के लिए उपयोगी है कि उदाहरण के लिए www.prueba.es/24 सभी आईपी हमारे लक्ष्य हैं।
- **`-Pn`**: **कोई पिंग नहीं**। यह उपयोगी है यदि आप जानते हैं कि वे सभी सक्रिय हैं (यदि नहीं, तो आप बहुत सारा समय बर्बाद कर सकते हैं, लेकिन यह विकल्प भी गलत नकारात्मक उत्पन्न करता है यह कहते हुए कि वे सक्रिय नहीं हैं), यह खोज चरण को रोकता है।
- **`-sn`** : **कोई पोर्ट स्कैन नहीं**। यह अन्वेषण चरण को पूरा करने के बाद, पोर्ट स्कैन नहीं करता है। यह अपेक्षाकृत छिपा हुआ है, और एक छोटे नेटवर्क स्कैन की अनुमति देता है। विशेषाधिकार के साथ यह 80 पर ACK (-PA), 443 पर SYN(-PS) और एक इको अनुरोध और एक टाइमस्टैम्प अनुरोध भेजता है, बिना विशेषाधिकार के यह हमेशा कनेक्शन को पूरा करता है। यदि लक्ष्य नेटवर्क है, तो यह केवल ARP(-PR) का उपयोग करता है। यदि किसी अन्य विकल्प के साथ उपयोग किया जाता है, तो केवल अन्य विकल्प के पैकेट गिराए जाते हैं।
- **`-PR`**: **पिंग ARP**। यह हमारे नेटवर्क में कंप्यूटरों का विश्लेषण करते समय डिफ़ॉल्ट रूप से उपयोग किया जाता है, यह पिंग का उपयोग करने की तुलना में तेज है। यदि आप ARP पैकेट का उपयोग नहीं करना चाहते हैं तो `--send-ip` का उपयोग करें।
- **`-PS <ports>`**: यह SYN पैकेट भेजता है, यदि यह SYN/ACK के साथ उत्तर देता है तो यह खुला है (जिसका उत्तर RST के साथ दिया जाता है ताकि कनेक्शन समाप्त न हो), यदि यह RST के साथ उत्तर देता है तो यह बंद है और यदि यह उत्तर नहीं देता है तो यह पहुंच से बाहर है। यदि विशेषाधिकार नहीं हैं, तो एक पूर्ण कनेक्शन स्वचालित रूप से उपयोग किया जाता है। यदि कोई पोर्ट नहीं दिए जाते हैं, तो यह 80 पर फेंकता है।
- **`-PA <ports>`**: पिछले वाले की तरह लेकिन ACK के साथ, दोनों को मिलाकर बेहतर परिणाम मिलते हैं।
- **`-PU <ports>`**: उद्देश्य इसके विपरीत है, इन्हें उन पोर्टों पर भेजा जाता है जो बंद होने की उम्मीद की जाती है। कुछ फ़ायरवॉल केवल TCP कनेक्शनों की जांच करते हैं। यदि यह बंद है तो इसे पोर्ट पहुंच से बाहर के साथ उत्तर दिया जाता है, यदि इसे किसी अन्य ICMP के साथ उत्तर दिया जाता है या उत्तर नहीं दिया जाता है तो इसे गंतव्य पहुंच से बाहर के रूप में छोड़ दिया जाता है।
- **`-PE, -PP, -PM`** : ICMP PINGS: इको रिप्ले, टाइमस्टैम्प और एड्रेसमास्क। इन्हें यह पता लगाने के लिए लॉन्च किया जाता है कि क्या लक्ष्य सक्रिय है।
- **`-PY<ports>`**: डिफ़ॉल्ट रूप से 80 पर SCTP INIT प्रॉब भेजता है, INIT-ACK(खुला) या ABORT(बंद) या कुछ नहीं या ICMP पहुंच से बाहर(निष्क्रिय) का उत्तर दिया जा सकता है।
- **`-PO <protocols>`**: हेडर में एक प्रोटोकॉल इंगित किया जाता है, डिफ़ॉल्ट रूप से 1(ICMP), 2(IGMP) और 4(Encap IP)। ICMP, IGMP, TCP (6) और UDP (17) प्रोटोकॉल के लिए प्रोटोकॉल हेडर भेजे जाते हैं, बाकी के लिए केवल IP हेडर भेजा जाता है। इसका उद्देश्य यह है कि हेडर के विकृत होने के कारण, प्रोटोकॉल पहुंच से बाहर या उसी प्रोटोकॉल के उत्तर दिए जाते हैं यह जानने के लिए कि क्या यह सक्रिय है।
- **`-n`**: कोई DNS नहीं
- **`-R`**: DNS हमेशा

### पोर्ट स्कैनिंग तकनीकें

- **`-sS`**: कनेक्शन को पूरा नहीं करता है इसलिए कोई निशान नहीं छोड़ता, यदि इसका उपयोग किया जा सके तो बहुत अच्छा है। (विशेषाधिकार) यह डिफ़ॉल्ट रूप से उपयोग किया जाता है।
- **`-sT`**: कनेक्शन को पूरा करता है, इसलिए यह निशान छोड़ता है, लेकिन इसका उपयोग निश्चित रूप से किया जा सकता है। डिफ़ॉल्ट रूप से बिना विशेषाधिकार के।
- **`-sU`**: धीमा, UDP के लिए। मुख्य रूप से: DNS(53), SNMP(161,162), DHCP(67 और 68), (-sU53,161,162,67,68): खुला(उत्तर), बंद(पोर्ट पहुंच से बाहर), फ़िल्टर किया गया (अन्य ICMP), खुला/फ़िल्टर किया गया (कुछ नहीं)। खुला/फ़िल्टर किए जाने की स्थिति में, -sV किसी भी संस्करण का पता लगाने के लिए कई अनुरोध भेजता है जो nmap का समर्थन करता है और वास्तविक स्थिति का पता लगा सकता है। यह समय को बहुत बढ़ा देता है।
- **`-sY`**: SCTP प्रोटोकॉल कनेक्शन स्थापित करने में विफल रहता है, इसलिए कोई लॉग नहीं होते, यह -PY की तरह काम करता है।
- **`-sN,-sX,-sF`:** नल, फिन, क्रिसमस, ये कुछ फ़ायरवॉल में प्रवेश कर सकते हैं और जानकारी निकाल सकते हैं। ये इस तथ्य पर आधारित हैं कि मानक अनुपालन मशीनें सभी अनुरोधों का उत्तर RST के साथ देंगी जिनमें SYN, RST या ACK लंगर नहीं हैं: खुला/फ़िल्टर किया गया(कुछ नहीं), बंद(RST), फ़िल्टर किया गया (ICMP पहुंच से बाहर)। Windows, Cisco, BSDI और OS/400 पर अविश्वसनीय। यूनिक्स पर हाँ।
- **`-sM`**: माइमोन स्कैन: FIN और ACK ध्वज भेजता है, BSD के लिए उपयोग किया जाता है, वर्तमान में सभी को बंद के रूप में लौटाएगा।
- **`-sA, sW`**: ACK और विंडो, फ़ायरवॉल का पता लगाने के लिए उपयोग किया जाता है, यह जानने के लिए कि क्या पोर्ट फ़िल्टर किए गए हैं या नहीं। -sW खुला/बंद के बीच भेद करता है क्योंकि खुले उत्तर एक अलग विंडो मान के साथ होते हैं: खुला (RST विंडो 0 के अलावा), बंद (RST विंडो = 0), फ़िल्टर किया गया (ICMP पहुंच से बाहर या कुछ नहीं)। सभी कंप्यूटर इस तरह से काम नहीं करते, इसलिए यदि सभी बंद हैं, तो यह काम नहीं कर रहा है, यदि कुछ खुले हैं, तो यह ठीक काम कर रहा है, और यदि कई खुले हैं और कुछ बंद हैं, तो यह इसके विपरीत काम कर रहा है।
- **`-sI`:** आईडल स्कैन। उन मामलों के लिए जिनमें एक सक्रिय फ़ायरवॉल है लेकिन हम जानते हैं कि यह एक निश्चित आईपी को फ़िल्टर नहीं करता है (या जब हम बस गुमनामी चाहते हैं) हम ज़ोंबी स्कैनर का उपयोग कर सकते हैं (यह सभी पोर्ट के लिए काम करता है), संभावित ज़ोंबियों की तलाश के लिए हम स्क्रिप्ट ipidseq या एक्सप्लॉइट सहायक/स्कैनर/ip/ipidseq का उपयोग कर सकते हैं। यह स्कैनर IP पैकेट के IPID नंबर पर आधारित है।
- **`--badsum`:** यह गलत योग भेजता है, कंप्यूटर पैकेट को अस्वीकार कर देंगे, लेकिन फ़ायरवॉल कुछ उत्तर दे सकते हैं, इसका उपयोग फ़ायरवॉल का पता लगाने के लिए किया जाता है।
- **`-sZ`:** "अजीब" SCTP स्कैनर, जब कुकी इको फ़्रैगमेंट के साथ प्रॉब भेजते हैं तो उन्हें खोना चाहिए यदि खुला है या बंद होने पर ABORT के साथ उत्तर दिया जाना चाहिए। यह उन फ़ायरवॉल के माध्यम से जा सकता है जो init के माध्यम से नहीं जाते हैं, बुरी बात यह है कि यह फ़िल्टर किए गए और खुले के बीच भेद नहीं करता है।
- **`-sO`:** प्रोटोकॉल आईपी स्कैन। खराब और खाली हेडर भेजता है जिनमें कभी-कभी प्रोटोकॉल को भी भेद नहीं किया जा सकता है। यदि ICMP पहुंच से बाहर प्रोटोकॉल आता है तो यह बंद है, यदि पहुंच से बाहर पोर्ट आता है तो यह खुला है, यदि कोई अन्य त्रुटि आती है, तो फ़िल्टर किया गया, यदि कुछ नहीं आता है, तो खुला|फ़िल्टर किया गया।
- **`-b <server>`:** FTPhost--> यह एक होस्ट को दूसरे से स्कैन करने के लिए उपयोग किया जाता है, यह किसी अन्य मशीन के ftp से कनेक्ट करके और इसे उन पोर्टों पर फ़ाइलें भेजने के लिए कहकर किया जाता है जिन्हें आप किसी अन्य मशीन से स्कैन करना चाहते हैं, उत्तरों के अनुसार हम जानेंगे कि वे खुले हैं या नहीं। \[\<user>:\<password>@]\<server>\[:\<port>] लगभग सभी ftps सर्वर अब आपको ऐसा करने की अनुमति नहीं देते हैं और इसलिए इसका व्यावहारिक उपयोग बहुत कम है।

### **फोकस विश्लेषण**

**-p:** स्कैन करने के लिए पोर्ट निर्दिष्ट करने के लिए उपयोग किया जाता है। सभी 65,335 पोर्ट का चयन करने के लिए: **-p-** या **-p all**। Nmap की एक आंतरिक वर्गीकरण है जो लोकप्रियता पर आधारित है। डिफ़ॉल्ट रूप से, यह शीर्ष 1000 पोर्ट का उपयोग करता है। **-F** (तेज स्कैन) के साथ यह शीर्ष 100 का विश्लेषण करता है। **--top-ports <number>** के साथ यह शीर्ष पोर्टों की उस संख्या का विश्लेषण करता है (1 से 65,335 तक)। यह यादृच्छिक क्रम में पोर्ट की जांच करता है; इसे रोकने के लिए, **-r** का उपयोग करें। हम विशिष्ट पोर्ट भी चुन सकते हैं: 20-30,80,443,1024- (अर्थात 1024 से आगे देखना)। हम प्रोटोकॉल द्वारा पोर्ट भी समूहित कर सकते हैं: U:53,T:21-25,80,139,S:9। हम Nmap के लोकप्रिय पोर्टों के भीतर एक रेंज भी चुन सकते हैं: -p [-1024] nmap-services में शामिल उन तक पोर्ट 1024 तक का विश्लेषण करता है। **--port-ratio <ratio>** एक अनुपात के भीतर सबसे सामान्य पोर्टों का विश्लेषण करता है जो 0 और 1 के बीच है।

**-sV** संस्करण स्कैनिंग, तीव्रता को 0 से 9 के बीच नियंत्रित किया जा सकता है, डिफ़ॉल्ट 7 है।

**--version-intensity <number>** हम तीव्रता को नियंत्रित करते हैं, ताकि जितना कम हो, यह केवल सबसे संभावित प्रॉब लॉन्च करेगा, लेकिन सभी नहीं। इससे, हम UDP स्कैनिंग समय को काफी कम कर सकते हैं।

**-O** OS पहचान

**--osscan-limit** उचित होस्ट स्कैनिंग के लिए, कम से कम एक खुला पोर्ट और एक बंद पोर्ट की आवश्यकता होती है। यदि यह शर्त पूरी नहीं होती है और हमने इसे सेट किया है, तो यह OS भविष्यवाणी का प्रयास नहीं करेगा (समय बचाता है)।

**--osscan-guess** जब OS पहचान सही नहीं होती है, तो यह अधिक प्रयास करने के लिए बनाता है।

**स्क्रिप्ट**

--script _<filename>_|_<category>_|_<directory>_|_<expression>_[,...]

डिफ़ॉल्ट स्क्रिप्ट का उपयोग करने के लिए, -sC या --script=default का उपयोग करें।

उपलब्ध प्रकार हैं: auth, broadcast, default, discovery, dos, exploit, external, fuzzer, intrusive, malware, safe, version, और vuln।

- **Auth:** सभी उपलब्ध प्रमाणीकरण स्क्रिप्ट निष्पादित करता है।
- **Default:** बुनियादी डिफ़ॉल्ट टूल स्क्रिप्ट निष्पादित करता है।
- **Discovery:** लक्ष्य या पीड़ित से जानकारी प्राप्त करता है।
- **External:** बाहरी संसाधनों का उपयोग करने के लिए स्क्रिप्ट।
- **Intrusive:** पीड़ित या लक्ष्य के लिए आक्रामक मानी जाने वाली स्क्रिप्ट का उपयोग करता है।
- **Malware:** दुर्भावनापूर्ण कोड या बैकडोर द्वारा खोले गए कनेक्शनों की जांच करता है।
- **Safe:** गैर-आक्रामक स्क्रिप्ट निष्पादित करता है।
- **Vuln:** सबसे ज्ञात कमजोरियों का पता लगाता है।
- **All:** सभी उपलब्ध NSE एक्सटेंशन स्क्रिप्ट को पूरी तरह से निष्पादित करता है।

स्क्रिप्ट खोजने के लिए:

**nmap --script-help="http-\*" -> वे जो http- से शुरू होते हैं**

**nmap --script-help="not intrusive" -> सभी को छोड़कर**

**nmap --script-help="default or safe" -> वे जो किसी में या दोनों में हैं**

**nmap --script-help="default and safe" --> वे जो दोनों में हैं**

**nmap --script-help="(default or safe or intrusive) and not http-\*"**

--script-args _<n1>_=_<v1>_,_<n2>_={_<n3>_=_<v3>_},_<n4>_={_<v4>_,_<v5>_}

--script-args-file _<filename>_

--script-help _<filename>_|_<category>_|_<directory>_|_<expression>_|all[,...]

--script-trace ---> स्क्रिप्ट की प्रगति के बारे में जानकारी प्रदान करता है।

--script-updatedb

**स्क्रिप्ट का उपयोग करने के लिए, बस टाइप करें: nmap --script Script_Name target** --> स्क्रिप्ट का उपयोग करते समय, स्क्रिप्ट और स्कैनर दोनों निष्पादित होंगे, इसलिए स्कैनर विकल्प भी जोड़े जा सकते हैं। हम केवल सुरक्षित स्क्रिप्ट निष्पादित करने के लिए **"safe=1"** जोड़ सकते हैं।

**समय नियंत्रण**

**Nmap समय को सेकंड, मिनट, मिलीसेकंड में संशोधित कर सकता है:** --host-timeout arguments 900000ms, 900, 900s, और 15m सभी एक ही काम करते हैं।

Nmap स्कैन करने के लिए कुल होस्टों की संख्या को समूहों में विभाजित करता है और इन समूहों का विश्लेषण ब्लॉकों में करता है, इसलिए यह अगले ब्लॉक पर नहीं जाता जब तक सभी का विश्लेषण नहीं हो जाता (और उपयोगकर्ता को तब तक कोई अपडेट नहीं मिलता जब तक ब्लॉक का विश्लेषण नहीं हो जाता)। इस तरह, Nmap के लिए बड़े समूहों का उपयोग करना अधिक अनुकूल है। डिफ़ॉल्ट रूप से कक्षा C में, यह 256 का उपयोग करता है।

इसे **--min-hostgroup** _**<numhosts>**_**;** **--max-hostgroup** _**<numhosts>**_ के साथ बदला जा सकता है (समानांतर स्कैन समूह के आकार को समायोजित करें)।

आप समानांतर स्कैनरों की संख्या को नियंत्रित कर सकते हैं लेकिन बेहतर है कि ऐसा न करें (Nmap पहले से ही नेटवर्क स्थिति के आधार पर स्वचालित नियंत्रण शामिल करता है): **--min-parallelism** _**<numprobes>**_**;** **--max-parallelism** _**<numprobes>**_।

हम RTT टाइमआउट को संशोधित कर सकते हैं, लेकिन आमतौर पर इसकी आवश्यकता नहीं होती है: **--min-rtt-timeout** _**<time>**_**,** **--max-rtt-timeout** _**<time>**_**,** **--initial-rtt-timeout** _**<time>**_।

हम प्रयासों की संख्या को संशोधित कर सकते हैं: **--max-retries** _**<numtries>**_।

हम एक होस्ट के स्कैनिंग समय को संशोधित कर सकते हैं: **--host-timeout** _**<time>**_।

हम प्रत्येक परीक्षण के बीच समय को धीमा करने के लिए संशोधित कर सकते हैं: **--scan-delay** _**<time>**_**;** **--max-scan-delay** _**<time>**_।

हम प्रति सेकंड पैकेट की संख्या को संशोधित कर सकते हैं: **--min-rate** _**<number>**_**;** **--max-rate** _**<number>**_।

कई पोर्ट फ़िल्टर किए जाने या बंद होने पर प्रतिक्रिया देने में बहुत समय लेते हैं। यदि हम केवल खुले में रुचि रखते हैं, तो हम तेजी से जा सकते हैं: **--defeat-rst-ratelimit**।

यह परिभाषित करने के लिए कि हम Nmap को कितना आक्रामक बनाना चाहते हैं: -T paranoid|sneaky|polite|normal|aggressive|insane

-T (0-1)

-T0 --> केवल एक समय में 1 पोर्ट स्कैन करता है और अगले तक 5 मिनट इंतजार करता है।

-T1 और T2 --> बहुत समान लेकिन प्रत्येक परीक्षण के बीच केवल 15 और 0.4 सेकंड का इंतजार करते हैं।

-T3 --> डिफ़ॉल्ट संचालन, समानांतर स्कैनिंग शामिल है।

-T4 --> --max-rtt-timeout 1250ms --min-rtt-timeout 100ms --initial-rtt-timeout 500ms --max-retries 6 --max-scan-delay 10ms

-T5 --> --max-rtt-timeout 300ms --min-rtt-timeout 50ms --initial-rtt-timeout 250ms --max-retries 2 --host-timeout 15m --max-scan-delay 5ms

**फ़ायरवॉल/IDS**

वे पोर्टों तक पहुंच की अनुमति नहीं देते हैं और पैकेट का विश्लेषण करते हैं।

**-f** पैकेट को टुकड़ों में विभाजित करने के लिए, डिफ़ॉल्ट रूप से हेडर के बाद 8bytes में टुकड़ों में विभाजित करता है, उस आकार को निर्दिष्ट करने के लिए हम ..mtu का उपयोग करते हैं (इसके साथ, -f का उपयोग न करें), ऑफ़सेट 8 का गुणांक होना चाहिए। **संस्करण स्कैनर और स्क्रिप्ट टुकड़ों का समर्थन नहीं करते हैं**।

**-D decoy1,decoy2,ME** Nmap स्कैनर भेजता है लेकिन अन्य आईपी पते के रूप में उत्पत्ति के साथ, इस तरह से वे आपको छिपाते हैं। यदि आप सूची में ME डालते हैं, तो Nmap आपको वहां रखेगा, बेहतर है कि आप पूरी तरह से मास्क करने के लिए 5 या 6 पहले डालें। यादृच्छिक आईपी RND:<number> के साथ उत्पन्न किए जा सकते हैं। <number> यादृच्छिक आईपी उत्पन्न करने के लिए। ये TCP संस्करण डिटेक्टर्स के साथ बिना कनेक्शन के काम नहीं करते। यदि आप एक नेटवर्क के अंदर हैं, तो आप सक्रिय आईपी का उपयोग करना चाहते हैं, क्योंकि अन्यथा यह पता लगाना बहुत आसान होगा कि आप एकमात्र सक्रिय हैं।

यादृच्छिक आईपी का उपयोग करने के लिए: nmap -D RND:10 Target_IP

**-S IP** जब Nmap आपके आईपी पते को नहीं पकड़ता है तो आपको इसे इसके साथ देना होता है। यह उन्हें यह सोचने के लिए भी काम करता है कि कोई अन्य लक्ष्य उन्हें स्कैन कर रहा है।

**-e <interface>** इंटरफ़ेस चुनने के लिए।

कई व्यवस्थापक सभी चीजों को सही ढंग से काम करने के लिए सभी प्रवेश पोर्ट खोलते हैं और उनके लिए यह किसी अन्य समाधान को खोजने की तुलना में आसान होता है। ये DNS पोर्ट या FTP पोर्ट हो सकते हैं... इस कमजोरी को खोजने के लिए Nmap में शामिल है: **--source-port** _**<portnumber>**_**;-g** _**<portnumber>**_ _वे समकक्ष हैं_।

**--data** _**<hex string>**_ हेक्साडेसिमल टेक्स्ट भेजने के लिए: --data 0xdeadbeef और --data \xCA\xFE\x09।

**--data-string** _**<string>**_ सामान्य टेक्स्ट भेजने के लिए: --data-string "Scan conducted by Security Ops, extension 7192"।

**--data-length** _**<number>**_ Nmap केवल हेडर भेजता है, इसके साथ हम अधिक बाइट्स की संख्या जोड़ने में सक्षम होते हैं (जो यादृच्छिक रूप से उत्पन्न होंगे)।

IP पैकेट को पूरी तरह से कॉन्फ़िगर करने के लिए **--ip-options** का उपयोग करें।

यदि आप भेजे गए और प्राप्त पैकेट में विकल्प देखना चाहते हैं, तो --packet-trace निर्दिष्ट करें। Nmap के साथ IP विकल्पों का उपयोग करने के लिए अधिक जानकारी और उदाहरणों के लिए, देखें [http://seclists.org/nmap-dev/2006/q3/52](http://seclists.org/nmap-dev/2006/q3/52)।

**--ttl** _**<value>**_

**--randomize-hosts** हमले को कम स्पष्ट बनाने के लिए।

**--spoof-mac** _**<MAC address, prefix, or vendor name>**_ MAC को बदलने के लिए उदाहरण: Apple, 0, 01:02:03:04:05:06, deadbeefcafe, 0020F2, और Cisco।

**--proxies** _**<Comma-separated list of proxy URLs>**_ प्रॉक्सी का उपयोग करने के लिए, कभी-कभी एक प्रॉक्सी उतनी खुली कनेक्शन बनाए नहीं रखती जितनी Nmap चाहती है इसलिए समानांतरता को संशोधित करने की आवश्यकता होगी: --max-parallelism।

**-sP** हमारे नेटवर्क में ARP द्वारा होस्ट खोजने के लिए।

कई व्यवस्थापक एक फ़ायरवॉल नियम बनाते हैं जो एक विशेष पोर्ट से आने वाले सभी पैकेटों को पास करने की अनुमति देता है (जैसे 20,53 और 67), हम Nmap को इन पोर्टों से हमारे पैकेट भेजने के लिए कह सकते हैं: **nmap --source-port 53 IP**।

**आउटपुट**

**-oN file** सामान्य आउटपुट।

**-oX file** XML आउटपुट।

**-oS file** स्क्रिप्ट किडीज आउटपुट।

**-oG file** ग्रेपेबल आउटपुट।

**-oA file** सभी को छोड़कर -oS।

**-v level**verbosity।

**-d level**debugging।

**--reason** होस्ट और स्थिति का कारण।

**--stats-every time** हर उस समय हमें बताता है कि यह कैसे चल रहा है।

**--packet-trace** यह देखने के लिए कि कौन से पैकेट बाहर जा रहे हैं, फ़िल्टर निर्दिष्ट किए जा सकते हैं जैसे: --version-trace या --script-trace।

**--open** खुला, खुला|फ़िल्टर किया गया और अनफ़िल्टर किया गया दिखाता है।

**--resume file** एक सारांश आउटपुट करता है।

**विविध**

**-6** IPv6 की अनुमति देता है।

**-A** -O -sV -sC --traceroute के समान है।

**रन टाइम**

जब Nmap चल रहा है, हम विकल्प बदल सकते हैं:

v / V verbosity स्तर बढ़ाना / घटाना।

d / D debugging स्तर बढ़ाना / घटाना।

p / P पैकेट ट्रेसिंग चालू / बंद करना।

? रनटाइम इंटरएक्शन हेल्प स्क्रीन प्रिंट करें।

**Vulscan**

Nmap स्क्रिप्ट जो ऑफ़लाइन डेटाबेस (अन्य बहुत महत्वपूर्ण से डाउनलोड किया गया) में प्राप्त सेवाओं के संस्करणों को देखती है और संभावित कमजोरियों को लौटाती है।

यह जो DBs उपयोग करता है वे हैं:

1. Scipvuldb.csv | [http://www.scip.ch/en/?vuldb](http://www.scip.ch/en/?vuldb)
2. Cve.csv | [http://cve.mitre.org](http://cve.mitre.org/)
3. Osvdb.csv | [http://www.osvdb.org](http://www.osvdb.org/)
4. Securityfocus.csv | [http://www.securityfocus.com/bid/](http://www.securityfocus.com/bid/)
5. Securitytracker.csv | [http://www.securitytracker.com](http://www.securitytracker.com/)
6. Xforce.csv | [http://xforce.iss.net](http://xforce.iss.net/)
7. Exploitdb.csv | [http://www.exploit-db.com](http://www.exploit-db.com/)
8. Openvas.csv | [http://www.openvas.org](http://www.openvas.org/)।

Nmap फ़ोल्डर में डाउनलोड और इंस्टॉल करने के लिए:

wget http://www.computec.ch/projekte/vulscan/download/nmap_nse_vulscan-2.0.tar.gz && tar -czvf nmap_nse_vulscan-2.0.tar.gz vulscan/ && sudo cp -r vulscan/ /usr/share/nmap/scripts/

आपको DB पैकेज भी डाउनलोड करने की आवश्यकता होगी और उन्हें /usr/share/nmap/scripts/vulscan/ में जोड़ना होगा।

उपयोग:

सभी का उपयोग करने के लिए: sudo nmap -sV --script=vulscan HOST_TO_SCAN।

विशिष्ट DB का उपयोग करने के लिए: sudo nmap -sV --script=vulscan --script-args vulscandb=cve.csv HOST_TO_SCAN।

## Nmap सेवा स्कैन को x16 तेज करें

[**इस पोस्ट के अनुसार**](https://joshua.hu/nmap-speedup-service-scanning-16x) आप सभी **`totalwaitms`** मानों को **`/usr/share/nmap/nmap-service-probes`** में **300** और **`tcpwrappedms`** को **200** में संशोधित करके nmap सेवा विश्लेषण को तेज कर सकते हैं।

इसके अलावा, प्रॉब जो विशेष रूप से परिभाषित **`servicewaitms`** नहीं रखते हैं, वे **`5000`** का डिफ़ॉल्ट मान उपयोग करते हैं। इसलिए, हम प्रत्येक प्रॉब के लिए मान जोड़ सकते हैं, या हम **nmap** को स्वयं संकलित कर सकते हैं और [**service_scan.h**](https://github.com/nmap/nmap/blob/master/service_scan.h#L79) में डिफ़ॉल्ट मान को बदल सकते हैं।

यदि आप **`totalwaitms`** और **`tcpwrappedms`** के मानों को `/usr/share/nmap/nmap-service-probes` फ़ाइल में बिल्कुल भी नहीं बदलना चाहते हैं, तो आप [पार्सिंग कोड](https://github.com/nmap/nmap/blob/master/service_scan.cc#L1358) को इस तरह संपादित कर सकते हैं कि ये मान `nmap-service-probes` फ़ाइल में पूरी तरह से अनदेखा किए जाएं।


{{#include ../../banners/hacktricks-training.md}}
