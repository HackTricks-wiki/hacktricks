# Evil Twin EAP-TLS

{{#include ../../banners/hacktricks-training.md}}

किसी न किसी समय मुझे नीचे दिए गए पोस्ट द्वारा प्रस्तावित समाधान का उपयोग करने की आवश्यकता थी, लेकिन [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) में चरण आधुनिक काली (2019v3) में काम नहीं कर रहे थे।\
खैर, उन्हें काम करना आसान है।\
आपको केवल यहाँ से hostapd-2.6 डाउनलोड करने की आवश्यकता है: [https://w1.fi/releases/](https://w1.fi/releases/) और hostapd-wpe को फिर से संकलित करने से पहले स्थापित करें: `apt-get install libssl1.0-dev`

### Analyzing and Exploiting EAP-TLS in Wireless Networks

#### Background: EAP-TLS in Wireless Networks

EAP-TLS एक सुरक्षा प्रोटोकॉल है जो प्रमाणपत्रों का उपयोग करके क्लाइंट और सर्वर के बीच आपसी प्रमाणीकरण प्रदान करता है। कनेक्शन केवल तभी स्थापित होता है जब क्लाइंट और सर्वर एक-दूसरे के प्रमाणपत्रों को प्रमाणित करते हैं।

#### Challenge Encountered

एक मूल्यांकन के दौरान, `hostapd-wpe` उपकरण का उपयोग करते समय एक दिलचस्प त्रुटि का सामना करना पड़ा। उपकरण ने क्लाइंट के कनेक्शन को अस्वीकार कर दिया क्योंकि क्लाइंट का प्रमाणपत्र एक अज्ञात प्रमाणपत्र प्राधिकरण (CA) द्वारा हस्ताक्षरित था। इससे यह संकेत मिला कि क्लाइंट ने नकली सर्वर के प्रमाणपत्र पर भरोसा किया, जो क्लाइंट साइड पर सुरक्षा कॉन्फ़िगरेशन की ढिलाई को दर्शाता है।

#### Objective: Setting Up a Man-in-the-Middle (MiTM) Attack

लक्ष्य था उपकरण को इस तरह से संशोधित करना कि यह किसी भी क्लाइंट प्रमाणपत्र को स्वीकार करे। इससे दुर्भावनापूर्ण वायरलेस नेटवर्क के साथ कनेक्शन स्थापित करने और MiTM हमले को सक्षम करने की अनुमति मिलेगी, संभावित रूप से स्पष्ट क्रेडेंशियल्स या अन्य संवेदनशील डेटा को कैप्चर करना।

#### Solution: Modifying `hostapd-wpe`

`hostapd-wpe` के स्रोत कोड के विश्लेषण से पता चला कि क्लाइंट प्रमाणपत्र मान्यता एक पैरामीटर (`verify_peer`) द्वारा नियंत्रित होती है जो OpenSSL फ़ंक्शन `SSL_set_verify` में होती है। इस पैरामीटर के मान को 1 (मान्य) से 0 (मान्य नहीं) में बदलकर, उपकरण को किसी भी क्लाइंट प्रमाणपत्र को स्वीकार करने के लिए बनाया गया।

#### Execution of the Attack

1. **Environment Check:** वायरलेस नेटवर्क की निगरानी करने और लक्ष्यों की पहचान करने के लिए `airodump-ng` का उपयोग करें।
2. **Set Up Fake AP:** लक्षित नेटवर्क की नकल करते हुए एक नकली एक्सेस पॉइंट (AP) बनाने के लिए संशोधित `hostapd-wpe` चलाएँ।
3. **Captive Portal Customization:** कैप्टिव पोर्टल के लॉगिन पृष्ठ को वैध और लक्षित उपयोगकर्ता के लिए परिचित दिखने के लिए अनुकूलित करें।
4. **De-authentication Attack:** वैकल्पिक रूप से, क्लाइंट को वैध नेटवर्क से डिस्कनेक्ट करने और उन्हें नकली AP से कनेक्ट करने के लिए एक डि-ऑथ अटैक करें।
5. **Capturing Credentials:** एक बार जब क्लाइंट नकली AP से कनेक्ट होता है और कैप्टिव पोर्टल के साथ इंटरैक्ट करता है, तो उनके क्रेडेंशियल्स कैप्चर हो जाते हैं।

#### Observations from the Attack

- Windows मशीनों पर, सिस्टम स्वचालित रूप से नकली AP से कनेक्ट हो सकता है, जब वेब नेविगेशन का प्रयास किया जाता है तो कैप्टिव पोर्टल प्रस्तुत किया जाता है।
- iPhone पर, उपयोगकर्ता को एक नए प्रमाणपत्र को स्वीकार करने के लिए प्रेरित किया जा सकता है और फिर कैप्टिव पोर्टल प्रस्तुत किया जाता है।

#### Conclusion

हालांकि EAP-TLS को सुरक्षित माना जाता है, इसकी प्रभावशीलता सही कॉन्फ़िगरेशन और अंतिम उपयोगकर्ताओं के सतर्क व्यवहार पर बहुत निर्भर करती है। गलत कॉन्फ़िगर किए गए उपकरण या अनजान उपयोगकर्ता जो धोखाधड़ी प्रमाणपत्रों को स्वीकार करते हैं, EAP-TLS संरक्षित नेटवर्क की सुरक्षा को कमजोर कर सकते हैं।

For further details check https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

## References

- [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)

{{#include ../../banners/hacktricks-training.md}}
