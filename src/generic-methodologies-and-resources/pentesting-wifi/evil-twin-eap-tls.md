# Evil Twin EAP-TLS

{{#include ../../banners/hacktricks-training.md}}



Op 'n stadium moes ek die voorgestelde oplossing in die pos hieronder gebruik, maar die stappe in [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) het nie meer gewerk in moderne kali (2019v3).\
In elk geval, dit is maklik om hulle aan die gang te kry.\
Jy moet net die hostapd-2.6 hier aflaai: [https://w1.fi/releases/](https://w1.fi/releases/) en voordat jy weer hostapd-wpe compileer, installeer: `apt-get install libssl1.0-dev`

### Analyzing and Exploiting EAP-TLS in Wireless Networks

#### Background: EAP-TLS in Wireless Networks

EAP-TLS is 'n sekuriteitsprotokol wat wedersydse verifikasie tussen kliënt en bediener bied deur middel van sertifikate. Die verbinding word slegs gevestig as beide die kliënt en die bediener mekaar se sertifikate verifieer.

#### Challenge Encountered

Tydens 'n assessering is 'n interessante fout ondervind toe die `hostapd-wpe` hulpmiddel gebruik is. Die hulpmiddel het die kliënt se verbinding verwerp weens die kliënt se sertifikaat wat deur 'n onbekende Sertifikaatowerheid (CA) onderteken is. Dit het aangedui dat die kliënt die vals bediener se sertifikaat vertrou het, wat dui op los sekuriteitskonfigurasies aan die kliënt se kant.

#### Objective: Setting Up a Man-in-the-Middle (MiTM) Attack

Die doel was om die hulpmiddel te wysig om enige kliënt sertifikaat te aanvaar. Dit sou die vestiging van 'n verbinding met die kwaadwillige draadlose netwerk moontlik maak en 'n MiTM-aanval moontlik maak, wat die vang van platte teks geloofsbriewe of ander sensitiewe data moontlik maak.

#### Solution: Modifying `hostapd-wpe`

Analise van die bronkode van `hostapd-wpe` het onthul dat die kliënt sertifikaat validasie beheer is deur 'n parameter (`verify_peer`) in die OpenSSL funksie `SSL_set_verify`. Deur hierdie parameter se waarde van 1 (verifieer) na 0 (nie verifieer nie) te verander, is die hulpmiddel gemaak om enige kliënt sertifikaat te aanvaar.

#### Execution of the Attack

1. **Environment Check:** Gebruik `airodump-ng` om draadlose netwerke te monitor en teikens te identifiseer.
2. **Set Up Fake AP:** Voer die gewysigde `hostapd-wpe` uit om 'n vals Toegangspunt (AP) te skep wat die teiken netwerk naboots.
3. **Captive Portal Customization:** Pas die aanmeldbladsy van die gevangenisportaal aan om legitiem en bekend te lyk vir die teiken gebruiker.
4. **De-authentication Attack:** Opsioneel, voer 'n de-auth aanval uit om die kliënt van die legitieme netwerk af te skakel en hulle aan die vals AP te koppel.
5. **Capturing Credentials:** Sodra die kliënt aan die vals AP koppel en met die gevangenisportaal interaksie het, word hulle geloofsbriewe gevang.

#### Observations from the Attack

- Op Windows masjiene kan die stelsel outomaties aan die vals AP koppel, wat die gevangenisportaal aanbied wanneer web navigasie probeer word.
- Op 'n iPhone kan die gebruiker gevra word om 'n nuwe sertifikaat te aanvaar en dan met die gevangenisportaal voorgelê word.

#### Conclusion

Terwyl EAP-TLS as veilig beskou word, hang die doeltreffendheid daarvan sterk af van die korrekte konfigurasie en versigtige gedrag van eindgebruikers. Foutief geconfigureerde toestelle of onskuldige gebruikers wat rogue sertifikate aanvaar, kan die sekuriteit van 'n EAP-TLS beskermde netwerk ondermyn.

For further details check https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

## References

- [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)



{{#include ../../banners/hacktricks-training.md}}
