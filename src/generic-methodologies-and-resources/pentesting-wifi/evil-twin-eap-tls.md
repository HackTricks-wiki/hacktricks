# Evil Twin EAP-TLS

{{#include ../../banners/hacktricks-training.md}}



Bir noktada aşağıdaki gönderide önerilen çözümü kullanmam gerekti ama [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) üzerindeki adımlar modern kali (2019v3) üzerinde çalışmıyordu.\
Neyse ki, bunları çalıştırmak kolay.\
Sadece buradan hostapd-2.6 indirmelisiniz: [https://w1.fi/releases/](https://w1.fi/releases/) ve hostapd-wpe'yi tekrar derlemeden önce: `apt-get install libssl1.0-dev` yükleyin.

### Kablosuz Ağlarda EAP-TLS'yi Analiz Etme ve Sömürme

#### Arka Plan: Kablosuz Ağlarda EAP-TLS

EAP-TLS, istemci ve sunucu arasında karşılıklı kimlik doğrulama sağlayan bir güvenlik protokolüdür ve sertifikalar kullanır. Bağlantı, yalnızca istemci ve sunucu birbirlerinin sertifikalarını doğruladıysa kurulur.

#### Karşılaşılan Zorluk

Bir değerlendirme sırasında, `hostapd-wpe` aracını kullanırken ilginç bir hata ile karşılaşıldı. Araç, istemcinin sertifikasının bilinmeyen bir Sertifika Otoritesi (CA) tarafından imzalanması nedeniyle istemcinin bağlantısını reddetti. Bu, istemcinin sahte sunucunun sertifikasına güvenmediğini gösteriyordu ve istemci tarafındaki güvenlik yapılandırmalarının gevşek olduğunu işaret ediyordu.

#### Amaç: Adam Ortada (MiTM) Saldırısı Kurma

Amaç, aracı herhangi bir istemci sertifikasını kabul edecek şekilde değiştirmekti. Bu, kötü niyetli kablosuz ağ ile bağlantı kurulmasını sağlayacak ve bir MiTM saldırısına olanak tanıyacak, muhtemelen düz metin kimlik bilgilerini veya diğer hassas verileri yakalayabilecekti.

#### Çözüm: `hostapd-wpe`'yi Değiştirme

`hostapd-wpe` kaynak kodunun analizi, istemci sertifikası doğrulamasının OpenSSL fonksiyonu `SSL_set_verify` içindeki bir parametre (`verify_peer`) tarafından kontrol edildiğini ortaya koydu. Bu parametrenin değerini 1 (doğrula) yerine 0 (doğrulama) olarak değiştirerek, aracın herhangi bir istemci sertifikasını kabul etmesi sağlandı.

#### Saldırının Uygulanması

1. **Ortam Kontrolü:** Kablosuz ağları izlemek ve hedefleri tanımlamak için `airodump-ng` kullanın.
2. **Sahte AP Kurulumu:** Hedef ağı taklit eden sahte bir Erişim Noktası (AP) oluşturmak için değiştirilmiş `hostapd-wpe`'yi çalıştırın.
3. **Kapsayıcı Portal Özelleştirmesi:** Kapsayıcı portalın giriş sayfasını hedef kullanıcıya tanıdık ve meşru görünmesi için özelleştirin.
4. **De-authentication Saldırısı:** İsteğe bağlı olarak, istemciyi meşru ağdan ayırmak ve sahte AP'ye bağlamak için bir de-auth saldırısı gerçekleştirin.
5. **Kimlik Bilgilerini Yakalama:** İstemci sahte AP'ye bağlandığında ve kapsayıcı portal ile etkileşime geçtiğinde, kimlik bilgileri yakalanır.

#### Saldırıdan Gözlemler

- Windows makinelerinde, sistem otomatik olarak sahte AP'ye bağlanabilir ve web gezintisi denendiğinde kapsayıcı portalı sunabilir.
- Bir iPhone'da, kullanıcıdan yeni bir sertifikayı kabul etmesi istenebilir ve ardından kapsayıcı portal sunulabilir.

#### Sonuç

EAP-TLS güvenli olarak kabul edilse de, etkinliği doğru yapılandırma ve son kullanıcıların dikkatli davranışlarına büyük ölçüde bağlıdır. Yanlış yapılandırılmış cihazlar veya sahte sertifikaları kabul eden dikkatsiz kullanıcılar, EAP-TLS korumalı bir ağın güvenliğini zayıflatabilir.

Daha fazla detay için kontrol edin https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

## Referanslar

- [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)



{{#include ../../banners/hacktricks-training.md}}
