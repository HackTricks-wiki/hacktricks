# Evil Twin EAP-TLS

{{#include ../../banners/hacktricks-training.md}}



Katika hatua fulani nilihitaji kutumia suluhisho lililopendekezwa na posti iliyo chini lakini hatua katika [https://github.com/OpenSecurityResearch/hostapd-wpe](https://github.com/OpenSecurityResearch/hostapd-wpe) hazikufanya kazi katika kali ya kisasa (2019v3) tena.\
Hata hivyo, ni rahisi kufanya zifanye kazi.\
Unahitaji tu kupakua hostapd-2.6 kutoka hapa: [https://w1.fi/releases/](https://w1.fi/releases/) na kabla ya kuunda tena hostapd-wpe install: `apt-get install libssl1.0-dev`

### Kuchambua na Kutumia EAP-TLS katika Mitandao ya Wireless

#### Muktadha: EAP-TLS katika Mitandao ya Wireless

EAP-TLS ni itifaki ya usalama inayotoa uthibitisho wa pamoja kati ya mteja na seva kwa kutumia vyeti. Muunganisho unaundwa tu ikiwa mteja na seva wanathibitisha vyeti vya kila mmoja.

#### Changamoto Iliyokutana

Wakati wa tathmini, kosa la kuvutia lilikutana wakati wa kutumia zana ya `hostapd-wpe`. Zana hiyo ilikataa muunganisho wa mteja kwa sababu cheti cha mteja kilikuwa kimesainiwa na Mamlaka ya Cheti (CA) isiyojulikana. Hii ilionyesha kwamba mteja aliamini cheti cha seva bandia, ikionyesha mipangilio ya usalama dhaifu upande wa mteja.

#### Lengo: Kuanzisha Shambulio la Man-in-the-Middle (MiTM)

Lengo lilikuwa kubadilisha zana hiyo ili kukubali cheti chochote cha mteja. Hii ingekuwa na uwezo wa kuanzisha muunganisho na mtandao wa wireless mbaya na kuwezesha shambulio la MiTM, labda kukamata akidi za maandiko au data nyeti nyingine.

#### Suluhisho: Kubadilisha `hostapd-wpe`

Uchambuzi wa msimbo wa chanzo wa `hostapd-wpe` ulibaini kwamba uthibitishaji wa cheti cha mteja ulikuwa unadhibitiwa na parameter (`verify_peer`) katika kazi ya OpenSSL `SSL_set_verify`. Kwa kubadilisha thamani ya parameter hii kutoka 1 (thibitisha) hadi 0 (usithibitisha), zana hiyo ilifanywa kukubali cheti chochote cha mteja.

#### Utekelezaji wa Shambulio

1. **Ukaguzi wa Mazingira:** Tumia `airodump-ng` kufuatilia mitandao ya wireless na kubaini malengo.
2. **Kuanzisha AP Bandia:** Endesha `hostapd-wpe` iliyobadilishwa ili kuunda N pointi ya Upatikanaji (AP) inayofanana na mtandao wa lengo.
3. **Kurekebisha Portal ya Captive:** Rekebisha ukurasa wa kuingia wa portal ya captive ili kuonekana halali na wa kawaida kwa mtumiaji wa lengo.
4. **Shambulio la De-authentication:** Ikiwa ni lazima, fanya shambulio la de-auth ili kumkatisha mteja kutoka kwenye mtandao halali na kuwachanganya na AP bandia.
5. **Kukamata Akidi:** Mara tu mteja anapounganisha na AP bandia na kuingiliana na portal ya captive, akidi zao zinakamatwa.

#### Maoni Kutoka kwa Shambulio

- Kwenye mashine za Windows, mfumo unaweza kuunganishwa moja kwa moja na AP bandia, ukionyesha portal ya captive wakati wa kujaribu kuvinjari mtandao.
- Kwenye iPhone, mtumiaji anaweza kuombwa kukubali cheti kipya na kisha kuonyeshwa portal ya captive.

#### Hitimisho

Ingawa EAP-TLS inachukuliwa kuwa salama, ufanisi wake unategemea sana usanidi sahihi na tabia ya tahadhari ya watumiaji wa mwisho. Vifaa vilivyopangwa vibaya au watumiaji wasiojua wakikubali vyeti vya uasi vinaweza kudhoofisha usalama wa mtandao uliohifadhiwa na EAP-TLS.

Kwa maelezo zaidi angalia https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/

## Marejeo

- [https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/](https://versprite.com/blog/application-security/eap-tls-wireless-infrastructure/)



{{#include ../../banners/hacktricks-training.md}}
