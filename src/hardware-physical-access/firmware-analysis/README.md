# ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢è§£æ

{{#include ../../banners/hacktricks-training.md}}

## **ã¯ã˜ã‚ã«**

### é–¢é€£ãƒªã‚½ãƒ¼ã‚¹


{{#ref}}
synology-encrypted-archive-decryption.md
{{#endref}}

{{#ref}}
../../network-services-pentesting/32100-udp-pentesting-pppp-cs2-p2p-cameras.md
{{#endref}}


ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã¯ã€ãƒ‡ãƒã‚¤ã‚¹ãŒæ­£ã—ãå‹•ä½œã™ã‚‹ãŸã‚ã«ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ‰±ã†ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–“ã®é€šä¿¡ã‚’ç®¡ç†ãƒ»ä»²ä»‹ã™ã‚‹é‡è¦ãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã§ã™ã€‚ä¸æ®ç™ºæ€§ãƒ¡ãƒ¢ãƒªã«æ ¼ç´ã•ã‚Œã€é›»æºæŠ•å…¥ç›´å¾Œã‹ã‚‰ãƒ‡ãƒã‚¤ã‚¹ãŒå¿…è¦ãªå‘½ä»¤ã¸ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ã—ã¦OSã®èµ·å‹•ã«ç¹‹ãŒã‚Šã¾ã™ã€‚ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã‚’èª¿æŸ»ã—ã€å ´åˆã«ã‚ˆã£ã¦ã¯æ”¹å¤‰ã™ã‚‹ã“ã¨ã¯ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è„†å¼±æ€§ã‚’ç‰¹å®šã™ã‚‹ä¸Šã§é‡è¦ãªã‚¹ãƒ†ãƒƒãƒ—ã§ã™ã€‚

## **æƒ…å ±åé›†**

**æƒ…å ±åé›†** ã¯ã€ãƒ‡ãƒã‚¤ã‚¹ã®æ§‹æˆã‚„ä½¿ç”¨æŠ€è¡“ã‚’ç†è§£ã™ã‚‹ãŸã‚ã®é‡è¦ãªåˆæœŸæ®µéšã§ã™ã€‚ã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã§ã¯æ¬¡ã®ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ã‚’åé›†ã—ã¾ã™:

- CPUã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨å®Ÿè¡Œã—ã¦ã„ã‚‹OS
- ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ã®è©³ç´°
- ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã¨ãƒ‡ãƒ¼ã‚¿ã‚·ãƒ¼ãƒˆ
- ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã¨ã‚½ãƒ¼ã‚¹ã®æ‰€åœ¨
- å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ç¨®åˆ¥
- æ›´æ–°å±¥æ­´ã¨è¦åˆ¶èªè¨¼
- ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³ã‚„ãƒ•ãƒ­ãƒ¼å›³
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è©•ä¾¡ã¨ç‰¹å®šã•ã‚ŒãŸè„†å¼±æ€§

ã“ã®ç›®çš„ã«ã¯ã€**open-source intelligence (OSINT)** ãƒ„ãƒ¼ãƒ«ãŒéå¸¸ã«æœ‰ç”¨ã§ã‚ã‚Šã€å…¥æ‰‹å¯èƒ½ãªã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æ‰‹å‹•ãƒ»è‡ªå‹•ã§ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦è§£æã™ã‚‹ã“ã¨ã‚‚é‡è¦ã§ã™ã€‚Tools like [Coverity Scan](https://scan.coverity.com) and [Semmleâ€™s LGTM](https://lgtm.com/#explore) ã¯ã€æ½œåœ¨çš„ãªå•é¡Œã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã«æ´»ç”¨ã§ãã‚‹ç„¡æ–™ã®é™çš„è§£æã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚

## **ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã®å…¥æ‰‹**

ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã®å…¥æ‰‹æ–¹æ³•ã¯ã„ãã¤ã‹ã‚ã‚Šã€ãã‚Œãã‚Œé›£æ˜“åº¦ãŒç•°ãªã‚Šã¾ã™:

- **ç›´æ¥** é–‹ç™ºè€…ã‚„ãƒ¡ãƒ¼ã‚«ãƒ¼ã‹ã‚‰å…¥æ‰‹
- **Building** æä¾›ã•ã‚ŒãŸæ‰‹é †ã‹ã‚‰ãƒ“ãƒ«ãƒ‰ã™ã‚‹
- **Downloading** å…¬å¼ã‚µãƒãƒ¼ãƒˆã‚µã‚¤ãƒˆã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
- ãƒ›ã‚¹ãƒˆã•ã‚Œã¦ã„ã‚‹ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã«**Google dork**ã‚¯ã‚¨ãƒªã‚’åˆ©ç”¨
- [S3Scanner](https://github.com/sa7mon/S3Scanner) ã®ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ã§**ã‚¯ãƒ©ã‚¦ãƒ‰ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸**ã¸ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹
- man-in-the-middle æŠ€è¡“ã‚’ç”¨ã„ã¦**updates**ã‚’å‚å—
- **Extracting** ãƒ‡ãƒã‚¤ã‚¹ã‹ã‚‰ **UART**, **JTAG**, ã¾ãŸã¯ **PICit** ã®ã‚ˆã†ãªæ¥ç¶šçµŒç”±ã§æŠ½å‡º
- ãƒ‡ãƒã‚¤ã‚¹é€šä¿¡å†…ã®æ›´æ–°ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ç›£è¦–ã™ã‚‹**Sniffing**
- ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸæ›´æ–°ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ç‰¹å®šã—ã¦åˆ©ç”¨
- ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ã‚„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‹ã‚‰ã®**Dumping**
- ãã‚Œã§ã‚‚é§„ç›®ãªå ´åˆã€é©åˆ‡ãªãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒãƒƒãƒ—ã‚’**å–ã‚Šå¤–ã—ãƒ»èª­ã¿å–ã‚Š**

## ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã®è§£æ

**ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã‚’å…¥æ‰‹ã—ãŸã®ã§**ã€å‡¦ç†æ–¹æ³•ã‚’æ±ºã‚ã‚‹ãŸã‚ã«ãã®æƒ…å ±ã‚’æŠ½å‡ºã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«ä½¿ãˆã‚‹æ§˜ã€…ãªãƒ„ãƒ¼ãƒ«:
```bash
file <bin>
strings -n8 <bin>
strings -tx <bin> #print offsets in hex
hexdump -C -n 512 <bin> > hexdump.out
hexdump -C <bin> | head # might find signatures in header
fdisk -lu <bin> #lists a drives partition and filesystems if multiple
```
ã‚‚ã—ã“ã‚Œã‚‰ã®ãƒ„ãƒ¼ãƒ«ã§ã‚ã¾ã‚Šè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ã€`binwalk -E <bin>` ã§ã‚¤ãƒ¡ãƒ¼ã‚¸ã® **entropy** ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚entropy ãŒä½ã‘ã‚Œã°æš—å·åŒ–ã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ã¯ä½ãã€entropy ãŒé«˜ã‘ã‚Œã°æš—å·åŒ–ã•ã‚Œã¦ã„ã‚‹ï¼ˆã‚ã‚‹ã„ã¯ä½•ã‚‰ã‹ã®æ–¹æ³•ã§åœ§ç¸®ã•ã‚Œã¦ã„ã‚‹ï¼‰å¯èƒ½æ€§ãŒé«˜ã„ã§ã™ã€‚

ã•ã‚‰ã«ã€ã“ã‚Œã‚‰ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦ **ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢å†…ã«åŸ‹ã‚è¾¼ã¾ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«** ã‚’æŠ½å‡ºã§ãã¾ã™:


{{#ref}}
../../generic-methodologies-and-resources/basic-forensic-methodology/partitions-file-systems-carving/file-data-carving-recovery-tools.md
{{#endref}}

ã‚ã‚‹ã„ã¯ [**binvis.io**](https://binvis.io/#/) ([code](https://code.google.com/archive/p/binvis/)) ã‚’ä½¿ã£ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã§ãã¾ã™ã€‚

### Getting the Filesystem

`binwalk -ev <bin>` ã®ã‚ˆã†ãªå‰è¿°ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ãˆã°ã€**ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’æŠ½å‡ºã§ãã¦ã„ã‚‹ã¯ãšã§ã™**.\ Binwalk ã¯é€šå¸¸ã€æŠ½å‡ºã—ãŸã‚‚ã®ã‚’ **ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®ç¨®é¡ã‚’åå‰ã«ã—ãŸãƒ•ã‚©ãƒ«ãƒ€** å†…ã«ä¿å­˜ã—ã¾ã™ã€‚é€šå¸¸ã€ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã§ã™: squashfs, ubifs, romfs, rootfs, jffs2, yaffs2, cramfs, initramfs.

#### Manual Filesystem Extraction

å ´åˆã«ã‚ˆã£ã¦ã¯ã€binwalk ã®ã‚·ã‚°ãƒãƒãƒ£ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã® **ãƒã‚¸ãƒƒã‚¯ãƒã‚¤ãƒˆãŒå«ã¾ã‚Œã¦ã„ãªã„** ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®ã‚ˆã†ãªå ´åˆã¯ã€binwalk ã‚’ä½¿ã£ã¦ **ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’ç‰¹å®šã—ã€ãƒã‚¤ãƒŠãƒªã‹ã‚‰åœ§ç¸®ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’åˆ‡ã‚Šå‡ºã™** ã“ã¨ã§ã€ä»¥ä¸‹ã®æ‰‹é †ã«å¾“ã£ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’ **æ‰‹å‹•ã§æŠ½å‡º** ã—ã¦ãã ã•ã„ã€‚
```
$ binwalk DIR850L_REVB.bin

DECIMAL HEXADECIMAL DESCRIPTION
----------------------------------------------------------------------------- ---

0 0x0 DLOB firmware header, boot partition: """"dev=/dev/mtdblock/1""""
10380 0x288C LZMA compressed data, properties: 0x5D, dictionary size: 8388608 bytes, uncompressed size: 5213748 bytes
1704052 0x1A0074 PackImg section delimiter tag, little endian size: 32256 bytes; big endian size: 8257536 bytes
1704084 0x1A0094 Squashfs filesystem, little endian, version 4.0, compression:lzma, size: 8256900 bytes, 2688 inodes, blocksize: 131072 bytes, created: 2016-07-12 02:28:41
```
ä»¥ä¸‹ã® **dd command** ã‚’å®Ÿè¡Œã—ã¦ Squashfs filesystem ã‚’ã‚«ãƒ¼ãƒ“ãƒ³ã‚°ã—ã¦ãã ã•ã„ã€‚
```
$ dd if=DIR850L_REVB.bin bs=1 skip=1704084 of=dir.squashfs

8257536+0 records in

8257536+0 records out

8257536 bytes (8.3 MB, 7.9 MiB) copied, 12.5777 s, 657 kB/s
```
Alternatively, the following command could also be run.

`$ dd if=DIR850L_REVB.bin bs=1 skip=$((0x1A0094)) of=dir.squashfs`

- For squashfs (used in the example above)

`$ unsquashfs dir.squashfs`

Files will be in "`squashfs-root`" directory afterwards.

- CPIO archive files

`$ cpio -ivd --no-absolute-filenames -F <bin>`

- For jffs2 filesystems

`$ jefferson rootfsfile.jffs2`

- For ubifs filesystems with NAND flash

`$ ubireader_extract_images -u UBI -s <start_offset> <bin>`

`$ ubidump.py <bin>`

## ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã®è§£æ

ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã‚’å–å¾—ã—ãŸã‚‰ã€ãã®æ§‹é€ ã‚„æ½œåœ¨çš„ãªè„†å¼±æ€§ã‚’ç†è§£ã™ã‚‹ãŸã‚ã«è§£æã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚ã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã§ã¯ã€ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã‚¤ãƒ¡ãƒ¼ã‚¸ã‹ã‚‰æœ‰ç”¨ãªãƒ‡ãƒ¼ã‚¿ã‚’è§£æãƒ»æŠ½å‡ºã™ã‚‹ãŸã‚ã«ã•ã¾ã–ã¾ãªãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

### åˆæœŸè§£æãƒ„ãƒ¼ãƒ«

ä»¥ä¸‹ã¯ã€ãƒã‚¤ãƒŠãƒªãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`<bin>`ã¨å‘¼ã¶ï¼‰ã®åˆæœŸæ¤œæŸ»ã«ä½¿ç”¨ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ç¾¤ã§ã™ã€‚ã“ã‚Œã‚‰ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ—ã®ç‰¹å®šã€æ–‡å­—åˆ—æŠ½å‡ºã€ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ã®è§£æã€ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚„ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®è©³ç´°æŠŠæ¡ã«å½¹ç«‹ã¡ã¾ã™:
```bash
file <bin>
strings -n8 <bin>
strings -tx <bin> #prints offsets in hexadecimal
hexdump -C -n 512 <bin> > hexdump.out
hexdump -C <bin> | head #useful for finding signatures in the header
fdisk -lu <bin> #lists partitions and filesystems, if there are multiple
```
ã‚¤ãƒ¡ãƒ¼ã‚¸ã®æš—å·åŒ–çŠ¶æ…‹ã‚’è©•ä¾¡ã™ã‚‹ãŸã‚ã«ã€**ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼**ã‚’`binwalk -E <bin>`ã§ç¢ºèªã—ã¾ã™ã€‚ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ãŒä½ã„å ´åˆã¯æš—å·åŒ–ã•ã‚Œã¦ã„ãªã„ã“ã¨ã‚’ç¤ºå”†ã—ã€ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ãŒé«˜ã„å ´åˆã¯æš—å·åŒ–ã¾ãŸã¯åœ§ç¸®ã®å¯èƒ½æ€§ã‚’ç¤ºã—ã¾ã™ã€‚

åŸ‹ã‚è¾¼ã¿ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŠ½å‡ºã™ã‚‹ãŸã‚ã«ã€**file-data-carving-recovery-tools**ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚„ãƒ•ã‚¡ã‚¤ãƒ«æ¤œæŸ»ç”¨ã®**binvis.io**ã®ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ã‚„ãƒªã‚½ãƒ¼ã‚¹ãŒæ¨å¥¨ã•ã‚Œã¾ã™ã€‚

### ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®æŠ½å‡º

`binwalk -ev <bin>` ã‚’ä½¿ã†ã¨ã€é€šå¸¸ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’æŠ½å‡ºã§ãã€å¤šãã®å ´åˆãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚¿ã‚¤ãƒ—ï¼ˆä¾‹: squashfsã€ubifsï¼‰ã«ã¡ãªã‚“ã ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å±•é–‹ã•ã‚Œã¾ã™ã€‚ã—ã‹ã—ã€ãƒã‚¸ãƒƒã‚¯ãƒã‚¤ãƒˆãŒæ¬ ã‘ã¦ã„ã‚‹ãŸã‚ã« **binwalk** ãŒãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚¿ã‚¤ãƒ—ã‚’èªè­˜ã§ããªã„å ´åˆã¯ã€æ‰‹å‹•ã§ã®æŠ½å‡ºãŒå¿…è¦ã§ã™ã€‚ã“ã‚Œã«ã¯ `binwalk` ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’ç‰¹å®šã—ã€ç¶šã„ã¦ `dd` ã‚³ãƒãƒ³ãƒ‰ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’åˆ‡ã‚Šå‡ºã™ä½œæ¥­ãŒå«ã¾ã‚Œã¾ã™ï¼š
```bash
$ binwalk DIR850L_REVB.bin

$ dd if=DIR850L_REVB.bin bs=1 skip=1704084 of=dir.squashfs
```
ãã®å¾Œã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®ã‚¿ã‚¤ãƒ—ï¼ˆä¾‹ï¼šsquashfsã€cpioã€jffs2ã€ubifsï¼‰ã«å¿œã˜ã¦ã€å†…å®¹ã‚’æ‰‹å‹•ã§å±•é–‹ã™ã‚‹ãŸã‚ã«ç•°ãªã‚‹ã‚³ãƒãƒ³ãƒ‰ãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

### ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ è§£æ

ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’å±•é–‹ã—ãŸå¾Œã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®æ¬ é™¥ã‚’æ¢ã—å§‹ã‚ã¾ã™ã€‚ç‰¹ã«æ³¨æ„ã™ã‚‹é …ç›®ã¯ã€è„†å¼±ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ‡ãƒ¼ãƒ¢ãƒ³ã€ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸè³‡æ ¼æƒ…å ±ã€API endpointsã€æ›´æ–°ã‚µãƒ¼ãƒãƒ¼æ©Ÿèƒ½ã€æœªã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã®ã‚³ãƒ¼ãƒ‰ã€èµ·å‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆã€ãŠã‚ˆã³ã‚ªãƒ•ãƒ©ã‚¤ãƒ³è§£æç”¨ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ¸ˆã¿ãƒã‚¤ãƒŠãƒªã§ã™ã€‚

**ä¸»ã«ç¢ºèªã™ã¹ãå ´æ‰€** ã¨ **é …ç›®** ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ï¼š

- **etc/shadow** ãŠã‚ˆã³ **etc/passwd**ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼è³‡æ ¼æƒ…å ±ï¼‰
- **etc/ssl** ã«ã‚ã‚‹SSLè¨¼æ˜æ›¸ã¨éµ
- æ½œåœ¨çš„ãªè„†å¼±æ€§ã‚’å«ã‚€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚„ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
- è¿½åŠ è§£æã®ãŸã‚ã®çµ„ã¿è¾¼ã¿ãƒã‚¤ãƒŠãƒª
- ä¸€èˆ¬çš„ãªIoTãƒ‡ãƒã‚¤ã‚¹ã® web ã‚µãƒ¼ãƒãƒ¼ã‚„ãƒã‚¤ãƒŠãƒª

ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ å†…ã®æ©Ÿå¯†æƒ…å ±ã‚„è„†å¼±æ€§ã‚’ç™ºè¦‹ã™ã‚‹ã®ã«å½¹ç«‹ã¤ãƒ„ãƒ¼ãƒ«ï¼š

- [**LinPEAS**](https://github.com/carlospolop/PEASS-ng) ã¨ [**Firmwalker**](https://github.com/craigz28/firmwalker)ï¼šæ©Ÿå¯†æƒ…å ±ã®æ¤œç´¢ç”¨
- [**The Firmware Analysis and Comparison Tool (FACT)**](https://github.com/fkie-cad/FACT_core)ï¼šåŒ…æ‹¬çš„ãªãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢è§£æç”¨
- [**FwAnalyzer**](https://github.com/cruise-automation/fwanalyzer)ã€[**ByteSweep**](https://gitlab.com/bytesweep/bytesweep)ã€[**ByteSweep-go**](https://gitlab.com/bytesweep/bytesweep-go)ã€ãŠã‚ˆã³ [**EMBA**](https://github.com/e-m-b-a/emba)ï¼šfor static and dynamic analysis

### ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ¸ˆã¿ãƒã‚¤ãƒŠãƒªã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯

ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ å†…ã§è¦‹ã¤ã‹ã£ãŸã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ¸ˆã¿ãƒã‚¤ãƒŠãƒªã®ä¸¡æ–¹ã‚’è„†å¼±æ€§ã«ã¤ã„ã¦ç²¾æŸ»ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚Unixãƒã‚¤ãƒŠãƒªå‘ã‘ã® **checksec.sh** ã‚„ Windowsãƒã‚¤ãƒŠãƒªå‘ã‘ã® **PESecurity** ã®ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ã¯ã€æ‚ªç”¨å¯èƒ½ãªä¿è­·ã®ãªã„ãƒã‚¤ãƒŠãƒªã‚’ç‰¹å®šã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚

## ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã‚’ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã—ã¦ Dynamic Analysis ã‚’è¡Œã†

ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã‚’ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒã‚¤ã‚¹å…¨ä½“ã®å‹•ä½œã‚„å€‹ã€…ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã® dynamic analysis ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚ã“ã®æ–¹æ³•ã¯ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã‚„ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ä¾å­˜ã®å•é¡Œã«ç›´é¢ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ãŒã€ãƒ«ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚„ç‰¹å®šã®ãƒã‚¤ãƒŠãƒªã‚’ã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã‚¨ãƒ³ãƒ‡ã‚£ã‚¢ãƒ³ãŒä¸€è‡´ã™ã‚‹ãƒ‡ãƒã‚¤ã‚¹ï¼ˆä¾‹ï¼šRaspberry Piï¼‰ã‚„äº‹å‰æ§‹ç¯‰ã•ã‚ŒãŸä»®æƒ³ãƒã‚·ãƒ³ã«ç§»ã™ã“ã¨ã§ã€ã•ã‚‰ãªã‚‹ãƒ†ã‚¹ãƒˆãŒå®¹æ˜“ã«ãªã‚Šã¾ã™ã€‚

### å€‹ã€…ã®ãƒã‚¤ãƒŠãƒªã®ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

å˜ä¸€ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’è§£æã™ã‚‹å ´åˆã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã‚¨ãƒ³ãƒ‡ã‚£ã‚¢ãƒ³ã¨CPUã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’ç‰¹å®šã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚

#### MIPS ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ä¾‹

MIPSã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ãƒã‚¤ãƒŠãƒªã‚’ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã§ãã¾ã™ï¼š
```bash
file ./squashfs-root/bin/busybox
```
ãã—ã¦ã€å¿…è¦ãªã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ„ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã«ã¯:
```bash
sudo apt-get install qemu qemu-user qemu-user-static qemu-system-arm qemu-system-mips qemu-system-x86 qemu-utils
```
For MIPS (big-endian), `qemu-mips` is used, and for little-endian binaries, `qemu-mipsel` would be the choice.

#### ARM Architecture Emulation

For ARM binaries, the process is similar, with the `qemu-arm` emulator being utilized for emulation.

### Full System Emulation

Tools like [Firmadyne](https://github.com/firmadyne/firmadyne), [Firmware Analysis Toolkit](https://github.com/attify/firmware-analysis-toolkit), and others, facilitate full firmware emulation, automating the process and aiding in dynamic analysis.

## Dynamic Analysis in Practice

ã“ã®æ®µéšã§ã¯ã€å®Ÿæ©Ÿã¾ãŸã¯ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã—ãŸãƒ‡ãƒã‚¤ã‚¹ç’°å¢ƒã®ã„ãšã‚Œã‹ã‚’ç”¨ã„ã¦è§£æã‚’è¡Œã„ã¾ã™ã€‚OS ã¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¸ã®ã‚·ã‚§ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ã‚’ç¶­æŒã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã¨ã®ç›¸äº’ä½œç”¨ã‚’å®Œå…¨ã«ã¯å†ç¾ã—ãªã„å ´åˆãŒã‚ã‚Šã€ãã®ãŸã‚ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®å†èµ·å‹•ãŒå¿…è¦ã«ãªã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚è§£æã§ã¯ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’å†ç¢ºèªã—ã€å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ã‚„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ‚ªç”¨ã—ã€ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ã®è„†å¼±æ€§ã‚’èª¿æŸ»ã™ã‚‹ã¹ãã§ã™ã€‚ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã®æ•´åˆæ€§ãƒ†ã‚¹ãƒˆã¯ã€ãƒãƒƒã‚¯ãƒ‰ã‚¢ã¨ãªã‚Šã†ã‚‹è„†å¼±æ€§ã‚’ç‰¹å®šã™ã‚‹ãŸã‚ã«é‡è¦ã§ã™ã€‚

## Runtime Analysis Techniques

ãƒ©ãƒ³ã‚¿ã‚¤ãƒ è§£æã¯ã€ãƒ—ãƒ­ã‚»ã‚¹ã‚„ãƒã‚¤ãƒŠãƒªã‚’ãã®å®Ÿè¡Œç’°å¢ƒã§æ“ä½œã™ã‚‹ã“ã¨ã‚’å«ã¿ã€ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã®è¨­å®šã‚„ fuzzing ãªã©ã®æ‰‹æ³•ã§è„†å¼±æ€§ã‚’ç‰¹å®šã™ã‚‹ãŸã‚ã« gdb-multiarchã€Fridaã€Ghidra ã®ã‚ˆã†ãªãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

## Binary Exploitation and Proof-of-Concept

æ—¢çŸ¥ã®è„†å¼±æ€§ã«å¯¾ã™ã‚‹ PoC ã‚’é–‹ç™ºã™ã‚‹ã«ã¯ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æ·±ã„ç†è§£ã¨ä½ãƒ¬ãƒ™ãƒ«è¨€èªã§ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãŒå¿…è¦ã§ã™ã€‚çµ„ã¿è¾¼ã¿ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ãƒã‚¤ãƒŠãƒªã®ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ä¿è­·ã¯ç¨€ã§ã™ãŒã€å­˜åœ¨ã™ã‚‹å ´åˆã¯ Return Oriented Programming (ROP) ã®ã‚ˆã†ãªæ‰‹æ³•ãŒå¿…è¦ã«ãªã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

## Prepared Operating Systems for Firmware Analysis

Operating systems like [AttifyOS](https://github.com/adi0x90/attifyos) and [EmbedOS](https://github.com/scriptingxss/EmbedOS) provide pre-configured environments for firmware security testing, equipped with necessary tools.

## Prepared OSs to analyze Firmware

- [**AttifyOS**](https://github.com/adi0x90/attifyos): AttifyOS ã¯ Internet of Things (IoT) ãƒ‡ãƒã‚¤ã‚¹ã® security assessment ã¨ penetration testing ã‚’è¡Œã†ãŸã‚ã®ãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚å¿…è¦ãªãƒ„ãƒ¼ãƒ«ãŒãƒ—ãƒªã‚³ãƒ³ãƒ•ã‚£ã‚°æ¸ˆã¿ã§å…¨ã¦ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã‚‹ç’°å¢ƒã‚’æä¾›ã™ã‚‹ã“ã¨ã§ã€å¤šãã®æ™‚é–“ã‚’ç¯€ç´„ã§ãã¾ã™ã€‚
- [**EmbedOS**](https://github.com/scriptingxss/EmbedOS): Ubuntu 18.04 ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãŸ embedded security testing ç”¨ã®ã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã§ã€ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆç”¨ã®ãƒ„ãƒ¼ãƒ«ãŒãƒ—ãƒªãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ã¾ã™ã€‚

## Firmware Downgrade Attacks & Insecure Update Mechanisms

ãƒ™ãƒ³ãƒ€ãƒ¼ãŒãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã‚¤ãƒ¡ãƒ¼ã‚¸ã«å¯¾ã—ã¦æš—å·ç½²åã®ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè£…ã—ã¦ã„ã¦ã‚‚ã€**version rollback (downgrade) protection ã¯ã—ã°ã—ã°æ¬ å¦‚ã—ã¦ã„ã¾ã™**ã€‚ãƒ–ãƒ¼ãƒˆãƒ­ãƒ¼ãƒ€ã‚„ãƒªã‚«ãƒãƒªãƒ¼ãƒ­ãƒ¼ãƒ€ãŒåŸ‹ã‚è¾¼ã¿å…¬é–‹éµã§ç½²åã®ã¿ã‚’æ¤œè¨¼ã—ã€ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã•ã‚Œã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã® *version*ï¼ˆã¾ãŸã¯å˜èª¿å¢—åŠ ã‚«ã‚¦ãƒ³ã‚¿ï¼‰ã‚’æ¯”è¼ƒã—ãªã„å ´åˆã€æ”»æ’ƒè€…ã¯åˆæ³•çš„ã«æœ‰åŠ¹ãªç½²åã‚’ä¿æŒã—ãŸ **å¤ã„è„†å¼±ãªãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«** ã§ãã€ãƒ‘ãƒƒãƒæ¸ˆã¿ã®è„†å¼±æ€§ã‚’å†å°å…¥ã§ãã¾ã™ã€‚

Typical attack workflow:

1. **Obtain an older signed image**
* ãƒ™ãƒ³ãƒ€ãƒ¼ã®å…¬é–‹ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒãƒ¼ã‚¿ãƒ«ã€CDNã€ã¾ãŸã¯ã‚µãƒãƒ¼ãƒˆã‚µã‚¤ãƒˆã‹ã‚‰å…¥æ‰‹ã™ã‚‹ã€‚
* ã‚³ãƒ³ãƒ‘ãƒ‹ã‚ªãƒ³ã®ãƒ¢ãƒã‚¤ãƒ«/ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰æŠ½å‡ºã™ã‚‹ï¼ˆä¾‹ï¼šAndroid APK å†…ã® `assets/firmware/` ã«å«ã¾ã‚Œã‚‹å ´åˆï¼‰ã€‚
* VirusTotalã€Internet archivesã€ãƒ•ã‚©ãƒ¼ãƒ©ãƒ ãªã©ã®ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰å–å¾—ã™ã‚‹ã€‚
2. **Upload or serve the image to the device** via any exposed update channel:
* Web UI, mobile-app API, USB, TFTP, MQTT, etc.
* å¤šãã®ã‚³ãƒ³ã‚·ãƒ¥ãƒ¼ãƒå‘ã‘ IoT ãƒ‡ãƒã‚¤ã‚¹ã¯ *unauthenticated* ãª HTTP(S) ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å…¬é–‹ã—ã¦ãŠã‚Šã€Base64-encoded ãªãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ãƒ–ãƒ­ãƒ–ã‚’å—ã‘å–ã‚Šã€ã‚µãƒ¼ãƒãƒ¼å´ã§ãƒ‡ã‚³ãƒ¼ãƒ‰ã—ã¦ãƒªã‚«ãƒãƒª/ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã‚’ãƒˆãƒªã‚¬ãƒ¼ã—ã¾ã™ã€‚
3. ãƒ€ã‚¦ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰å¾Œã€æ–°ã—ã„ãƒªãƒªãƒ¼ã‚¹ã§ãƒ‘ãƒƒãƒã•ã‚ŒãŸè„†å¼±æ€§ã‚’æ‚ªç”¨ã™ã‚‹ï¼ˆä¾‹ãˆã°å¾Œã‹ã‚‰è¿½åŠ ã•ã‚ŒãŸ command-injection ãƒ•ã‚£ãƒ«ã‚¿ãªã©ï¼‰ã€‚
4. æ°¸ç¶šåŒ–ã‚’å¾—ãŸå¾Œã€æ¤œå‡ºã‚’é¿ã‘ã‚‹ãŸã‚ã«ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§æœ€æ–°ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã«å†ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã™ã‚‹ã‹ã€æ›´æ–°ã‚’ç„¡åŠ¹ã«ã™ã‚‹ã€‚

### ä¾‹: Command Injection ã®ãƒ€ã‚¦ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰å¾Œ
```http
POST /check_image_and_trigger_recovery?md5=1; echo 'ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC...' >> /root/.ssh/authorized_keys HTTP/1.1
Host: 192.168.0.1
Content-Type: application/octet-stream
Content-Length: 0
```
è„†å¼±ãªï¼ˆãƒ€ã‚¦ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰ã•ã‚ŒãŸï¼‰ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã§ã¯ã€`md5` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒã‚µãƒ‹ã‚¿ã‚¤ã‚ºã•ã‚Œãšã«ç›´æ¥ã‚·ã‚§ãƒ«ã‚³ãƒãƒ³ãƒ‰ã«é€£çµã•ã‚Œã¦ãŠã‚Šã€ä»»æ„ã®ã‚³ãƒãƒ³ãƒ‰ã‚’æ³¨å…¥ã§ãã‚‹ï¼ˆã“ã“ã§ã¯ SSH key-based root access ã‚’æœ‰åŠ¹ã«ã™ã‚‹ï¼‰ã€‚å¾Œç¶šã®ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯åŸºæœ¬çš„ãªæ–‡å­—ãƒ•ã‚£ãƒ«ã‚¿ãŒå°å…¥ã•ã‚ŒãŸãŒã€ãƒ€ã‚¦ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰ä¿è­·ãŒãªã„ãŸã‚ä¿®æ­£ã¯æ„å‘³ã‚’æˆã•ãªã„ã€‚

### ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªã‹ã‚‰ã®ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢æŠ½å‡º

å¤šãã®ãƒ™ãƒ³ãƒ€ã¯ã€ã‚³ãƒ³ãƒ‘ãƒ‹ã‚ªãƒ³ã®ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªå†…ã«å®Œå…¨ãªãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒãƒ³ãƒ‰ãƒ«ã—ã¦ãŠã‚Šã€ã‚¢ãƒ—ãƒªãŒ Bluetooth/Wiâ€‘Fi çµŒç”±ã§ãƒ‡ãƒã‚¤ã‚¹ã‚’æ›´æ–°ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ã‚‹ã€‚ã“ã‚Œã‚‰ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯é€šå¸¸ã€APK/APEX ã® `assets/fw/` ã‚„ `res/raw/` ã®ã‚ˆã†ãªãƒ‘ã‚¹ã«æš—å·åŒ–ã•ã‚Œãšã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã€‚`apktool`ã€`ghidra`ã€ã¾ãŸã¯å˜ç´”ã« `unzip` ãªã©ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ãˆã°ã€ç‰©ç†ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã«è§¦ã‚Œãšã«ç½²åæ¸ˆã¿ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å–ã‚Šå‡ºã™ã“ã¨ãŒã§ãã‚‹ã€‚
```
$ apktool d vendor-app.apk -o vendor-app
$ ls vendor-app/assets/firmware
firmware_v1.3.11.490_signed.bin
```
### æ›´æ–°ãƒ­ã‚¸ãƒƒã‚¯è©•ä¾¡ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

* *update endpoint* ã®ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆï¼èªè¨¼ã¯ååˆ†ã«ä¿è­·ã•ã‚Œã¦ã„ã‚‹ã‹ï¼ˆTLS + authenticationï¼‰?
* ãƒ‡ãƒã‚¤ã‚¹ã¯ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã®å‰ã« **ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·** ã¾ãŸã¯ **monotonic anti-rollback counter** ã‚’æ¯”è¼ƒã—ã¦ã„ã‚‹ã‹?
* ã‚¤ãƒ¡ãƒ¼ã‚¸ã¯ã‚»ã‚­ãƒ¥ã‚¢ãƒ–ãƒ¼ãƒˆãƒã‚§ãƒ¼ãƒ³ã®å†…éƒ¨ã§æ¤œè¨¼ã•ã‚Œã¦ã„ã‚‹ã‹ï¼ˆä¾‹ï¼šROM code ã«ã‚ˆã‚‹ç½²åãƒã‚§ãƒƒã‚¯ï¼‰?
* userland code ã¯è¿½åŠ ã®å¦¥å½“æ€§ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹ã‹ï¼ˆä¾‹ï¼šè¨±å¯ã•ã‚ŒãŸ partition mapã€model numberï¼‰?
* *partial* ã‚„ *backup* ã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆãƒ•ãƒ­ãƒ¼ã¯åŒã˜æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯ã‚’å†åˆ©ç”¨ã—ã¦ã„ã‚‹ã‹?

> ğŸ’¡  ä¸Šè¨˜ã®ã„ãšã‚Œã‹ãŒæ¬ ã‘ã¦ã„ã‚‹å ´åˆã€ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã¯ãŠãã‚‰ã rollback attacks ã«å¯¾ã—ã¦è„†å¼±ã§ã™ã€‚

## æ¼”ç¿’å‘ã‘ã®è„†å¼±ãªãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢

ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã®è„†å¼±æ€§ç™ºè¦‹ã‚’ç·´ç¿’ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®è„†å¼±ãªãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å‡ºç™ºç‚¹ã¨ã—ã¦åˆ©ç”¨ã—ã¦ãã ã•ã„ã€‚

- OWASP IoTGoat
- [https://github.com/OWASP/IoTGoat](https://github.com/OWASP/IoTGoat)
- The Damn Vulnerable Router Firmware Project
- [https://github.com/praetorian-code/DVRF](https://github.com/praetorian-code/DVRF)
- Damn Vulnerable ARM Router (DVAR)
- [https://blog.exploitlab.net/2018/01/dvar-damn-vulnerable-arm-router.html](https://blog.exploitlab.net/2018/01/dvar-damn-vulnerable-arm-router.html)
- ARM-X
- [https://github.com/therealsaumil/armx#downloads](https://github.com/therealsaumil/armx#downloads)
- Azeria Labs VM 2.0
- [https://azeria-labs.com/lab-vm-2-0/](https://azeria-labs.com/lab-vm-2-0/)
- Damn Vulnerable IoT Device (DVID)
- [https://github.com/Vulcainreo/DVID](https://github.com/Vulcainreo/DVID)

## å‚è€ƒ

- [https://scriptingxss.gitbook.io/firmware-security-testing-methodology/](https://scriptingxss.gitbook.io/firmware-security-testing-methodology/)
- [Practical IoT Hacking: The Definitive Guide to Attacking the Internet of Things](https://www.amazon.co.uk/Practical-IoT-Hacking-F-Chantzis/dp/1718500904)
- [Exploiting zero days in abandoned hardware â€“ Trail of Bits blog](https://blog.trailofbits.com/2025/07/25/exploiting-zero-days-in-abandoned-hardware/)

## ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã¨èªå®š

- [https://www.attify-store.com/products/offensive-iot-exploitation](https://www.attify-store.com/products/offensive-iot-exploitation)

{{#include ../../banners/hacktricks-training.md}}
