{{#include ../../banners/hacktricks-training.md}}

इंटरनेट पर कई ब्लॉग हैं जो **डिफ़ॉल्ट/कमजोर** लॉगिन क्रेडेंशियल्स के साथ प्रिंटर को LDAP के साथ कॉन्फ़िगर करने के खतरों को **हाइलाइट** करते हैं।\
इसका कारण यह है कि एक हमलावर **प्रिंटर को एक धोखेबाज़ LDAP सर्वर के खिलाफ प्रमाणित करने के लिए धोखा दे सकता है** (आमतौर पर एक `nc -vv -l -p 444` पर्याप्त है) और प्रिंटर के **क्रेडेंशियल्स को स्पष्ट पाठ में कैप्चर कर सकता है**।

इसके अलावा, कई प्रिंटर **उपयोगकर्ता नामों के साथ लॉग** रखेंगे या यहां तक कि **डोमेन कंट्रोलर से सभी उपयोगकर्ता नामों को डाउनलोड** करने में सक्षम हो सकते हैं।

यह **संवेदनशील जानकारी** और सामान्य **सुरक्षा की कमी** प्रिंटर को हमलावरों के लिए बहुत दिलचस्प बनाती है।

इस विषय पर कुछ ब्लॉग:

- [https://www.ceos3c.com/hacking/obtaining-domain-credentials-printer-netcat/](https://www.ceos3c.com/hacking/obtaining-domain-credentials-printer-netcat/)
- [https://medium.com/@nickvangilder/exploiting-multifunction-printers-during-a-penetration-test-engagement-28d3840d8856](https://medium.com/@nickvangilder/exploiting-multifunction-printers-during-a-penetration-test-engagement-28d3840d8856)

## प्रिंटर कॉन्फ़िगरेशन

- **स्थान**: LDAP सर्वर सूची यहाँ पाई जाती है: `Network > LDAP Setting > Setting Up LDAP`।
- **व्यवहार**: इंटरफ़ेस LDAP सर्वर संशोधनों की अनुमति देता है बिना क्रेडेंशियल्स फिर से दर्ज किए, उपयोगकर्ता की सुविधा के लिए लेकिन सुरक्षा जोखिम पैदा करता है।
- **शोषण**: शोषण में LDAP सर्वर पते को एक नियंत्रित मशीन पर पुनर्निर्देशित करना और क्रेडेंशियल्स कैप्चर करने के लिए "Test Connection" फ़ीचर का लाभ उठाना शामिल है।

## क्रेडेंशियल्स कैप्चर करना

**अधिक विस्तृत चरणों के लिए, मूल [स्रोत](https://grimhacker.com/2018/03/09/just-a-printer/) को देखें।**

### विधि 1: नेटकैट लिस्नर

एक साधारण नेटकैट लिस्नर पर्याप्त हो सकता है:
```bash
sudo nc -k -v -l -p 386
```
हालांकि, इस विधि की सफलता भिन्न होती है।

### विधि 2: पूर्ण LDAP सर्वर के साथ Slapd

एक अधिक विश्वसनीय दृष्टिकोण एक पूर्ण LDAP सर्वर स्थापित करना है क्योंकि प्रिंटर एक शून्य बाइंड करता है उसके बाद एक क्वेरी करता है इससे पहले कि क्रेडेंशियल बाइंडिंग का प्रयास किया जाए।

1. **LDAP सर्वर सेटअप**: गाइड [इस स्रोत](https://www.server-world.info/en/note?os=Fedora_26&p=openldap) से चरणों का पालन करता है।
2. **मुख्य चरण**:
- OpenLDAP स्थापित करें।
- व्यवस्थापक पासवर्ड कॉन्फ़िगर करें।
- बुनियादी स्कीमा आयात करें।
- LDAP DB पर डोमेन नाम सेट करें।
- LDAP TLS कॉन्फ़िगर करें।
3. **LDAP सेवा निष्पादन**: एक बार सेटअप हो जाने के बाद, LDAP सेवा को निम्नलिखित का उपयोग करके चलाया जा सकता है:
```bash
slapd -d 2
```
## संदर्भ

- [https://grimhacker.com/2018/03/09/just-a-printer/](https://grimhacker.com/2018/03/09/just-a-printer/)

{{#include ../../banners/hacktricks-training.md}}
