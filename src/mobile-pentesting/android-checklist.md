# Android APK 检查表

{{#include ../banners/hacktricks-training.md}}


### [学习 Android 基础](android-app-pentesting/index.html#2-android-application-fundamentals)

- [ ] [基础知识](android-app-pentesting/index.html#fundamentals-review)
- [ ] [Dalvik & Smali](android-app-pentesting/index.html#dalvik--smali)
- [ ] [入口点](android-app-pentesting/index.html#application-entry-points)
- [ ] [Activities](android-app-pentesting/index.html#launcher-activity)
- [ ] [URL Schemes](android-app-pentesting/index.html#url-schemes)
- [ ] [Content Providers](android-app-pentesting/index.html#services)
- [ ] [Services](android-app-pentesting/index.html#services-1)
- [ ] [Broadcast Receivers](android-app-pentesting/index.html#broadcast-receivers)
- [ ] [Intents](android-app-pentesting/index.html#intents)
- [ ] [Intent Filter](android-app-pentesting/index.html#intent-filter)
- [ ] [其他组件](android-app-pentesting/index.html#other-app-components)
- [ ] [如何使用 ADB](android-app-pentesting/index.html#adb-android-debug-bridge)
- [ ] [如何修改 Smali](android-app-pentesting/index.html#smali)

### [静态分析](android-app-pentesting/index.html#static-analysis)

- [ ] 检查是否使用了[混淆](android-checklist.md#some-obfuscation-deobfuscation-information)、检测设备是否已 root、是否在模拟器上运行以及防篡改检测。[阅读更多](android-app-pentesting/index.html#other-checks)。
- [ ] 敏感应用（如银行应用）应检测设备是否已 root 并据此采取措施。
- [ ] 搜索[有价值的字符串](android-app-pentesting/index.html#looking-for-interesting-info)（密码、URLs、API、加密、后门、tokens、Bluetooth uuids 等）。
- [ ] 特别注意 firebase APIs。
- [ ] [阅读 manifest:](android-app-pentesting/index.html#basic-understanding-of-the-application-manifest-xml)
- [ ] 检查应用是否处于 debug 模式并尝试“利用”它
- [ ] 检查 APK 是否允许备份
- [ ] 导出（exported）Activities
- [ ] Unity Runtime：导出的 UnityPlayerActivity/UnityPlayerGameActivity 带有 `unity` CLI extras bridge。测试 `-xrsdk-pre-init-library <abs-path>` 以在 pre-init 时通过 `dlopen()` 触发 RCE。参见 [Intent Injection → Unity Runtime](android-app-pentesting/intent-injection.md)。
- [ ] Content Providers
- [ ] 暴露的 services
- [ ] Broadcast Receivers
- [ ] URL Schemes
- [ ] 应用是否在内部或外部不安全地保存数据？(android-app-pentesting/index.html#insecure-data-storage)
- [ ] 是否有任何[硬编码或保存在磁盘上的密码](android-app-pentesting/index.html#poorkeymanagementprocesses)？应用是否[使用不安全或已弃用的加密算法](android-app-pentesting/index.html#useofinsecureandordeprecatedalgorithms)？
- [ ] 所有库是否都使用了 PIE 标志进行编译？
- [ ] 别忘了有一堆[静态 Android 分析器](android-app-pentesting/index.html#automatic-analysis) 可以在此阶段大幅帮助你。
- [ ] `android:exported` **在 Android 12+ 上是强制的** – 错误配置的 exported 组件可能导致外部 intent 被调用。
- [ ] 审查 **Network Security Config**（`networkSecurityConfig` XML），检查 `cleartextTrafficPermitted="true"` 或针对域的例外配置。
- [ ] 查找对 **Play Integrity / SafetyNet / DeviceCheck** 的调用 – 判断自定义 attestation 是否可以被 hook/绕过。
- [ ] 检查 **App Links / Deep Links**（`android:autoVerify`）是否存在 intent 重定向或 open-redirect 问题。
- [ ] 识别 **WebView.addJavascriptInterface** 或 `loadData*()` 的使用，这些可能导致应用内的 RCE / XSS。
- [ ] 分析跨平台包（Flutter 的 `libapp.so`、React-Native JS bundles、Capacitor/Ionic 资产）。专用工具：
- `flutter-packer`, `fluttersign`, `rn-differ`
- [ ] 扫描第三方本地库以查找已知 CVE（例如 **libwebp CVE-2023-4863**、**libpng** 等）。
- [ ] 评估 **SEMgrep Mobile rules**、**Pithus** 和最新的 **MobSF ≥ 3.9** AI 辅助扫描结果以发现更多问题。
- [ ] 检查 OEM ROM 的附加组件（OxygenOS/ColorOS/MIUI/OneUI），是否存在可绕过权限的额外 **exported ContentProviders**；尝试在没有 `READ_SMS` 的情况下使用 `content query --uri content://com.android.providers.telephony/ServiceNumberProvider`（例如 OnePlus CVE-2025-10184）。

### [动态分析](android-app-pentesting/index.html#dynamic-analysis)

- [ ] 准备环境（[在线](android-app-pentesting/index.html#online-dynamic-analysis)、[本地 VM 或物理设备](android-app-pentesting/index.html#local-dynamic-analysis)）
- [ ] 是否存在任何[非预期的数据泄露](android-app-pentesting/index.html#unintended-data-leakage)（日志、复制/粘贴、崩溃日志）？
- [ ] [是否有机密信息保存在 SQLite dbs 中](android-app-pentesting/index.html#sqlite-dbs)？
- [ ] [可被利用的导出 Activities](android-app-pentesting/index.html#exploiting-exported-activities-authorisation-bypass)？
- [ ] [可被利用的 Content Providers](android-app-pentesting/index.html#exploiting-content-providers-accessing-and-manipulating-sensitive-information)？
- [ ] [可被利用的导出 Services](android-app-pentesting/index.html#exploiting-services)？
- [ ] [可被利用的 Broadcast Receivers](android-app-pentesting/index.html#exploiting-broadcast-receivers)？
- [ ] 应用是否[以明文传输信息/或使用弱算法](android-app-pentesting/index.html#insufficient-transport-layer-protection)？是否可能被 MitM？
- [ ] [检查 HTTP/HTTPS 流量](android-app-pentesting/index.html#inspecting-http-traffic)
- [ ] 这一点非常重要，因为如果你能捕获 HTTP 流量，就可以搜索常见的 Web 漏洞（Hacktricks 对 Web 漏洞有大量信息）。
- [ ] 检查可能的 [Android Client Side Injections](android-app-pentesting/index.html#android-client-side-injections-and-others)（静态代码分析可能对这点很有帮助）
- [ ] [Frida](android-app-pentesting/index.html#frida)：仅使用 Frida，从应用中获取有价值的动态数据（可能包括某些密码...）
- [ ] 测试 **Tapjacking / Animation-driven attacks (TapTrap 2025)** 即使在 Android 15+（无需 overlay 权限）。
- [ ] 进行 **overlay / SYSTEM_ALERT_WINDOW clickjacking** 和 **Accessibility Service 滥用** 测试以尝试权限提升。
- [ ] 检查 `adb backup` / `bmgr backupnow` 是否仍能导出应用数据（忘记禁用 `allowBackup` 的应用）。
- [ ] 探测 **Binder 级别的 LPE**（例如 **CVE-2023-20963, CVE-2023-20928**）；在许可的情况下使用内核 fuzzers 或 PoC。
- [ ] 如果强制使用 Play Integrity / SafetyNet，尝试运行时 hook（`Frida Gadget`, `MagiskIntegrityFix`, `Integrity-faker`）或网络层重放。近期的 Play Integrity Fix 分支（≥17.x）嵌入了 `playcurl`——重点关注 ZygiskNext + PIF + ZygiskAssistant/TrickyStore 组合以恢复 DEVICE/STRONG 判定。
- [ ] 使用现代工具进行检测与分析：
- **Objection > 2.0**, **Frida 17+ (Android 16 支持, ART 偏移修复)**, **NowSecure-Tracer (2024)**
- 使用 `perfetto` / `simpleperf` 进行动态系统级追踪。
- [ ] 对于 OEM 电话/提供者漏洞（例如 OxygenOS CVE-2025-10184），尝试通过 `content` CLI 或应用内的 `ContentResolver` 做无权限的 SMS 读/发；在 `update()` 中测试盲注 SQLi 以外泄行数据。

### Some obfuscation/Deobfuscation information

- [ ] [阅读这里](android-app-pentesting/index.html#obfuscating-deobfuscating-code)


## 参考

- [CVE-2025-59489 – Arbitrary Code Execution in Unity Runtime (blog)](https://flatt.tech/research/posts/arbitrary-code-execution-in-unity-runtime/)
- [Rapid7: CVE-2025-10184 OnePlus OxygenOS Telephony provider permission bypass](https://www.rapid7.com/blog/post/cve-2025-10184-oneplus-oxygenos-telephony-provider-permission-bypass-not-fixed/)
- [TapTrap animation-based tapjacking research (TU Wien)](https://www.tomsguide.com/computing/online-security/this-new-android-attack-could-trick-you-into-compromising-your-own-phone-everything-you-need-to-know)

{{#include ../banners/hacktricks-training.md}}
