# Android APK Checkliste

{{#include ../banners/hacktricks-training.md}}


### [Android-Grundlagen](android-app-pentesting/index.html#2-android-application-fundamentals)

- [ ] [Grundlagen](android-app-pentesting/index.html#fundamentals-review)
- [ ] [Dalvik & Smali](android-app-pentesting/index.html#dalvik--smali)
- [ ] [Einstiegspunkte](android-app-pentesting/index.html#application-entry-points)
- [ ] [Activities](android-app-pentesting/index.html#launcher-activity)
- [ ] [URL-Schemata](android-app-pentesting/index.html#url-schemes)
- [ ] [Content Providers](android-app-pentesting/index.html#services)
- [ ] [Services](android-app-pentesting/index.html#services-1)
- [ ] [Broadcast Receivers](android-app-pentesting/index.html#broadcast-receivers)
- [ ] [Intents](android-app-pentesting/index.html#intents)
- [ ] [Intent Filter](android-app-pentesting/index.html#intent-filter)
- [ ] [Weitere Komponenten](android-app-pentesting/index.html#other-app-components)
- [ ] [Wie man ADB verwendet](android-app-pentesting/index.html#adb-android-debug-bridge)
- [ ] [Wie man Smali bearbeitet](android-app-pentesting/index.html#smali)

### [Statische Analyse](android-app-pentesting/index.html#static-analysis)

- [ ] Prüfe die Verwendung von [obfuscation](android-checklist.md#some-obfuscation-deobfuscation-information), prüfe, ob das Gerät gerootet ist, ob ein Emulator verwendet wird und führe Anti-Tampering-Checks durch. [Mehr Infos](android-app-pentesting/index.html#other-checks).
- [ ] Sensible Anwendungen (z. B. Bank-Apps) sollten prüfen, ob das Gerät gerootet ist und entsprechend reagieren.
- [ ] Suche nach [interessante Strings](android-app-pentesting/index.html#looking-for-interesting-info) (Passwörter, URLs, API, Verschlüsselung, backdoors, Tokens, Bluetooth uuids...).
- [ ] Besondere Aufmerksamkeit für [firebase ](android-app-pentesting/index.html#firebase)APIs.
- [ ] [Manifest lesen:](android-app-pentesting/index.html#basic-understanding-of-the-application-manifest-xml)
- [ ] Prüfe, ob die Anwendung im Debug-Modus ist und versuche, sie zu exploiten
- [ ] Prüfe, ob das APK Backups erlaubt
- [ ] Exported Activities
- [ ] Unity Runtime: exported UnityPlayerActivity/UnityPlayerGameActivity mit einer `unity` CLI extras bridge. Teste `-xrsdk-pre-init-library <abs-path>` für pre-init `dlopen()` RCE. Siehe [Intent Injection → Unity Runtime](android-app-pentesting/intent-injection.md).
- [ ] Content Providers
- [ ] Exponierte services
- [ ] Broadcast Receivers
- [ ] URL Schemes
- [ ] Ist die Anwendung s[aving data insecurely internally or externally](android-app-pentesting/index.html#insecure-data-storage)?
- [ ] Gibt es ein [password hard coded or saved in disk](android-app-pentesting/index.html#poorkeymanagementprocesses)? Verwendet die App [using insecurely crypto algorithms](android-app-pentesting/index.html#useofinsecureandordeprecatedalgorithms)?
- [ ] Sind alle Libraries mit dem PIE-Flag kompiliert?
- [ ] Vergiss nicht, dass es eine Reihe von [ static Android Analyzers](android-app-pentesting/index.html#automatic-analysis) gibt, die dir in dieser Phase sehr helfen können.
- [ ] `android:exported` **mandatory on Android 12+** – fehlkonfigurierte exportierte Komponenten können zu externen Intent-Aufrufen führen.
- [ ] Überprüfe die **Network Security Config** (`networkSecurityConfig` XML) auf `cleartextTrafficPermitted="true"` oder domain-spezifische Overrides.
- [ ] Suche nach Aufrufen von **Play Integrity / SafetyNet / DeviceCheck** – beurteile, ob custom attestation gehookt/umgangen werden kann.
- [ ] Untersuche **App Links / Deep Links** (`android:autoVerify`) auf Intent-Redirects oder Open-Redirect-Probleme.
- [ ] Identifiziere Nutzung von **WebView.addJavascriptInterface** oder `loadData*()` die zu RCE / XSS innerhalb der App führen kann.
- [ ] Analysiere cross-platform Bundles (Flutter `libapp.so`, React-Native JS bundles, Capacitor/Ionic assets). Dedizierte Tools:
- `flutter-packer`, `fluttersign`, `rn-differ`
- [ ] Scanne Third-Party native Libraries nach bekannten CVEs (z. B. **libwebp CVE-2023-4863**, **libpng**, etc.).
- [ ] Bewerte **SEMgrep Mobile rules**, **Pithus** und die neuesten **MobSF ≥ 3.9** AI-unterstützten Scan-Ergebnisse für zusätzliche Findings.
- [ ] Prüfe OEM-ROM-Add-ons (OxygenOS/ColorOS/MIUI/OneUI) auf zusätzliche **exported ContentProviders**, die Berechtigungen umgehen; versuche `content query --uri content://com.android.providers.telephony/ServiceNumberProvider` ohne `READ_SMS` (z. B. OnePlus CVE-2025-10184).

### [Dynamische Analyse](android-app-pentesting/index.html#dynamic-analysis)

- [ ] Bereite die Umgebung vor ([online](android-app-pentesting/index.html#online-dynamic-analysis), [lokale VM oder physisches Gerät](android-app-pentesting/index.html#local-dynamic-analysis))
- [ ] Gibt es unerwünschte unintended data leakage (Logging, Copy/Paste, Crash-Logs)?
- [ ] Werden vertrauliche Informationen in SQLite dbs gespeichert? ([Confidential information being saved in SQLite dbs](android-app-pentesting/index.html#sqlite-dbs)?)
- [ ] [Exploitable exposed Activities](android-app-pentesting/index.html#exploiting-exported-activities-authorisation-bypass)?
- [ ] [Exploitable Content Providers](android-app-pentesting/index.html#exploiting-content-providers-accessing-and-manipulating-sensitive-information)?
- [ ] [Exploitable exposed Services](android-app-pentesting/index.html#exploiting-services)?
- [ ] [Exploitable Broadcast Receivers](android-app-pentesting/index.html#exploiting-broadcast-receivers)?
- [ ] Überträgt die Anwendung Informationen im Klartext/unter Verwendung schwacher Algorithmen (is a MitM possible)?
- [ ] [Untersuche HTTP/HTTPS Traffic](android-app-pentesting/index.html#inspecting-http-traffic)
- [ ] Das ist sehr wichtig: wenn du den HTTP-Traffic erfassen kannst, kannst du nach gängigen Web-Vulnerabilities suchen (Hacktricks enthält viele Informationen zu Web-Vulns).
- [ ] Prüfe auf mögliche [Android Client Side Injections](android-app-pentesting/index.html#android-client-side-injections-and-others) (wahrscheinlich hilft hier ein statischer Code-Scan).
- [ ] [Frida](android-app-pentesting/index.html#frida): Einfach Frida nutzen, um interessante dynamische Daten aus der Anwendung zu erhalten (vielleicht Passwörter...).
- [ ] Teste für **Tapjacking / Animation-driven attacks (TapTrap 2025)** sogar auf Android 15+ (keine Overlay-Berechtigung erforderlich).
- [ ] Versuche **overlay / SYSTEM_ALERT_WINDOW clickjacking** und **Accessibility Service abuse** für Privilegieneskalation.
- [ ] Prüfe, ob `adb backup` / `bmgr backupnow` noch App-Daten dumpen können (Apps, die vergessen haben, `allowBackup` zu deaktivieren).
- [ ] Suche nach **Binder-level LPEs** (z. B. **CVE-2023-20963, CVE-2023-20928**); nutze Kernel-Fuzzer oder PoCs, wenn erlaubt.
- [ ] Wenn Play Integrity / SafetyNet durchgesetzt wird, versuche Runtime-Hooks (`Frida Gadget`, `MagiskIntegrityFix`, `Integrity-faker`) oder Netzwerk-Level Replay. Neuere Play Integrity Fix Forks (≥17.x) betten `playcurl` ein—fokussiere auf ZygiskNext + PIF + ZygiskAssistant/TrickyStore-Kombinationen, um DEVICE/STRONG Verdicts zurückzugewinnen.
- [ ] Instrumentiere mit modernem Tooling:
- **Objection > 2.0**, **Frida 17+ (Android 16 support, ART offset fixes)**, **NowSecure-Tracer (2024)**
- Dynamisches systemweites Tracing mit `perfetto` / `simpleperf`.
- [ ] Für OEM-Telephony/Provider-Bugs (z. B. OxygenOS CVE-2025-10184), versuche **permission-less SMS read/send** über die `content` CLI oder in-app `ContentResolver`; teste blind SQLi in `update()` zum Exfiltrieren von Rows.

### Some obfuscation/Deobfuscation information

- [ ] [Lies hier](android-app-pentesting/index.html#obfuscating-deobfuscating-code)


## Referenzen

- [CVE-2025-59489 – Arbitrary Code Execution in Unity Runtime (blog)](https://flatt.tech/research/posts/arbitrary-code-execution-in-unity-runtime/)
- [Rapid7: CVE-2025-10184 OnePlus OxygenOS Telephony provider permission bypass](https://www.rapid7.com/blog/post/cve-2025-10184-oneplus-oxygenos-telephony-provider-permission-bypass-not-fixed/)
- [TapTrap animation-based tapjacking research (TU Wien)](https://www.tomsguide.com/computing/online-security/this-new-android-attack-could-trick-you-into-compromising-your-own-phone-everything-you-need-to-know)

{{#include ../banners/hacktricks-training.md}}
