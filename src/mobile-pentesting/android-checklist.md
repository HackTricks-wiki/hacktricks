# Checklist APK Android

{{#include ../banners/hacktricks-training.md}}


### [Impara i fondamenti di Android](android-app-pentesting/index.html#2-android-application-fundamentals)

- [ ] [Nozioni di base](android-app-pentesting/index.html#fundamentals-review)
- [ ] [Dalvik & Smali](android-app-pentesting/index.html#dalvik--smali)
- [ ] [Punti di ingresso](android-app-pentesting/index.html#application-entry-points)
- [ ] [Activities](android-app-pentesting/index.html#launcher-activity)
- [ ] [Schemi URL](android-app-pentesting/index.html#url-schemes)
- [ ] [Content Providers](android-app-pentesting/index.html#services)
- [ ] [Services](android-app-pentesting/index.html#services-1)
- [ ] [Broadcast Receivers](android-app-pentesting/index.html#broadcast-receivers)
- [ ] [Intents](android-app-pentesting/index.html#intents)
- [ ] [Intent Filter](android-app-pentesting/index.html#intent-filter)
- [ ] [Altri componenti](android-app-pentesting/index.html#other-app-components)
- [ ] [Come usare ADB](android-app-pentesting/index.html#adb-android-debug-bridge)
- [ ] [Come modificare Smali](android-app-pentesting/index.html#smali)

### [Analisi statica](android-app-pentesting/index.html#static-analysis)

- [ ] Controlla l'uso di obfuscation, verifica se il dispositivo è rooted, se è in esecuzione su un emulatore e i controlli anti-tampering. [Leggi qui per maggiori info](android-app-pentesting/index.html#other-checks).
- [ ] Le applicazioni sensibili (es. app bancarie) dovrebbero verificare se il dispositivo è rooted e agire di conseguenza.
- [ ] Cerca stringhe interessanti (password, URL, API, encryption, backdoors, token, UUID Bluetooth...).
- [ ] Particolare attenzione alle API di firebase.
- [ ] [Leggi il manifest:](android-app-pentesting/index.html#basic-understanding-of-the-application-manifest-xml)
- [ ] Verifica se l'app è in debug mode e prova a "sfruttarla"
- [ ] Verifica se l'APK permette backup
- [ ] Activities esportate
- [ ] Unity Runtime: exported UnityPlayerActivity/UnityPlayerGameActivity con un bridge `unity` CLI extras. Testa `-xrsdk-pre-init-library <abs-path>` per un pre-init `dlopen()` RCE. Vedi [Intent Injection → Unity Runtime](android-app-pentesting/intent-injection.md).
- [ ] Content Providers
- [ ] Servizi esposti
- [ ] Broadcast Receivers
- [ ] Schemi URL
- [ ] [L'applicazione sta salvando dati in modo insicuro internamente o esternamente](android-app-pentesting/index.html#insecure-data-storage)?
- [ ] [Ci sono password hard coded o salvate su disco](android-app-pentesting/index.html#poorkeymanagementprocesses)? L'app [usa algoritmi crypto insicuri](android-app-pentesting/index.html#useofinsecureandordeprecatedalgorithms)?
- [ ] Tutte le librerie sono compilate con il flag PIE?
- [ ] Non dimenticare che esistono molti strumenti di analisi statica Android che possono aiutarti molto in questa fase. [static Android Analyzers](android-app-pentesting/index.html#automatic-analysis)
- [ ] `android:exported` **obbligatorio su Android 12+** – componenti esportati mal configurati possono permettere invocazioni di intent esterni.
- [ ] Revisiona la **Network Security Config** (`networkSecurityConfig` XML) per `cleartextTrafficPermitted="true"` o override specifici per dominio.
- [ ] Cerca chiamate a **Play Integrity / SafetyNet / DeviceCheck** – determina se l'attestazione personalizzata può essere hookata/bypassed.
- [ ] Ispeziona **App Links / Deep Links** (`android:autoVerify`) per redirect di intent o problemi di open-redirect.
- [ ] Identifica l'uso di **WebView.addJavascriptInterface** o `loadData*()` che possono portare a RCE / XSS all'interno dell'app.
- [ ] Analizza bundle cross-platform (Flutter `libapp.so`, bundle JS di React-Native, asset di Capacitor/Ionic). Tool dedicati:
- `flutter-packer`, `fluttersign`, `rn-differ`
- [ ] Scansiona librerie native di terze parti per CVE note (es. **libwebp CVE-2023-4863**, **libpng**, ecc.).
- [ ] Valuta le regole **SEMgrep Mobile**, **Pithus** e i risultati di scansione AI-assisted dell'ultima **MobSF ≥ 3.9** per ulteriori finding.

### [Analisi dinamica](android-app-pentesting/index.html#dynamic-analysis)

- [ ] Prepara l'ambiente ([online](android-app-pentesting/index.html#online-dynamic-analysis), [VM locale o fisico](android-app-pentesting/index.html#local-dynamic-analysis))
- [ ] Ci sono perdite di dati non intenzionali (logging, copy/paste, crash logs)?
- [ ] [Informazioni riservate salvate in db SQLite](android-app-pentesting/index.html#sqlite-dbs)?
- [ ] [Activities esposte sfruttabili](android-app-pentesting/index.html#exploiting-exported-activities-authorisation-bypass)?
- [ ] [Content Providers sfruttabili](android-app-pentesting/index.html#exploiting-content-providers-accessing-and-manipulating-sensitive-information)?
- [ ] [Servizi esposti sfruttabili](android-app-pentesting/index.html#exploiting-services)?
- [ ] [Broadcast Receivers sfruttabili](android-app-pentesting/index.html#exploiting-broadcast-receivers)?
- [ ] L'applicazione trasmette informazioni in chiaro/usa algoritmi deboli? È possibile un MitM?
- [ ] [Ispeziona il traffico HTTP/HTTPS](android-app-pentesting/index.html#inspecting-http-traffic)
- [ ] Questo è molto importante: se riesci a catturare il traffico HTTP puoi cercare vulnerabilità Web comuni (Hacktricks ha molte informazioni su Web vulns).
- [ ] Verifica possibili [Android Client Side Injections](android-app-pentesting/index.html#android-client-side-injections-and-others) (probabilmente un'analisi statica del codice aiuterà).
- [ ] **Frida** (usalo per ottenere dati dinamici interessanti dall'applicazione — forse anche qualche password...)
- [ ] Testa **Tapjacking / Animation-driven attacks (TapTrap 2025)** anche su Android 15+ (non è richiesta la permission per overlay).
- [ ] Prova overlay / SYSTEM_ALERT_WINDOW clickjacking e abuso di Accessibility Service per escalation di privilegi.
- [ ] Verifica se `adb backup` / `bmgr backupnow` possono ancora dumpare i dati dell'app (app che hanno dimenticato di disabilitare `allowBackup`).
- [ ] Sonda per **Binder-level LPEs** (es. **CVE-2023-20963, CVE-2023-20928**); usa kernel fuzzers o PoC se consentito.
- [ ] Se Play Integrity / SafetyNet è applicato, prova runtime hooks (`Frida Gadget`, `MagiskIntegrityFix`, `Integrity-faker`) o replay a livello di rete.
- [ ] Strumenta con tooling moderno:
- **Objection > 2.0**, **Frida 17+**, **NowSecure-Tracer (2024)**
- Tracing dinamico a livello di sistema con `perfetto` / `simpleperf`.

### Some obfuscation/Deobfuscation information

- [ ] [Leggi qui](android-app-pentesting/index.html#obfuscating-deobfuscating-code)


## References

- [CVE-2025-59489 – Arbitrary Code Execution in Unity Runtime (blog)](https://flatt.tech/research/posts/arbitrary-code-execution-in-unity-runtime/)

{{#include ../banners/hacktricks-training.md}}
