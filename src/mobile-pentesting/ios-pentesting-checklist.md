# iOS Pentesting Checklist

{{#include ../banners/hacktricks-training.md}}

### 準備

- [ ] [**iOSの基本**](ios-pentesting/ios-basics.md)を読む
- [ ] [**iOSテスト環境**](ios-pentesting/ios-testing-environment.md)を読み、環境を準備する
- [ ] [**iOS初期分析**](ios-pentesting/#initial-analysis)のすべてのセクションを読み、iOSアプリケーションのペンテストにおける一般的なアクションを学ぶ

### データストレージ

- [ ] [**Plistファイル**](ios-pentesting/#plist)は機密情報を保存するために使用される可能性がある。
- [ ] [**Core Data**](ios-pentesting/#core-data)（SQLiteデータベース）は機密情報を保存できる。
- [ ] [**YapDatabases**](ios-pentesting/#yapdatabase)（SQLiteデータベース）は機密情報を保存できる。
- [ ] [**Firebase**](ios-pentesting/#firebase-real-time-databases)の設定ミス。
- [ ] [**Realmデータベース**](ios-pentesting/#realm-databases)は機密情報を保存できる。
- [ ] [**Couchbase Liteデータベース**](ios-pentesting/#couchbase-lite-databases)は機密情報を保存できる。
- [ ] [**バイナリクッキー**](ios-pentesting/#cookies)は機密情報を保存できる。
- [ ] [**キャッシュデータ**](ios-pentesting/#cache)は機密情報を保存できる。
- [ ] [**自動スナップショット**](ios-pentesting/#snapshots)は視覚的な機密情報を保存できる。
- [ ] [**キーチェーン**](ios-pentesting/#keychain)は通常、電話を再販する際に残る可能性のある機密情報を保存するために使用される。
- [ ] 要約すると、**アプリケーションがファイルシステムに保存した機密情報を確認すること**。

### キーボード

- [ ] アプリケーションは[**カスタムキーボードの使用を許可しているか**](ios-pentesting/#custom-keyboards-keyboard-cache)？
- [ ] 機密情報が[**キーボードキャッシュファイル**](ios-pentesting/#custom-keyboards-keyboard-cache)に保存されているか確認する。

### **ログ**

- [ ] [**機密情報がログに記録されているか**](ios-pentesting/#logs)確認する。

### バックアップ

- [ ] [**バックアップ**](ios-pentesting/#backups)はファイルシステムに保存された**機密情報にアクセスするために使用できる**（このチェックリストの最初のポイントを確認）。
- [ ] また、[**バックアップ**](ios-pentesting/#backups)はアプリケーションの**設定を変更するために使用できる**。その後、バックアップを電話に**復元**し、**変更された設定**が**読み込まれる**と、いくつかの（セキュリティ）**機能**が**回避される**可能性がある。

### **アプリケーションメモリ**

- [ ] [**アプリケーションのメモリ**](ios-pentesting/#testing-memory-for-sensitive-data)内の機密情報を確認する。

### **壊れた暗号化**

- [ ] [**暗号化に使用されるパスワード**](ios-pentesting/#broken-cryptography)を見つけられるか確認する。
- [ ] 機密データを送信/保存するために[**非推奨/弱いアルゴリズム**](ios-pentesting/#broken-cryptography)が使用されているか確認する。
- [ ] [**暗号化関数をフックして監視する**](ios-pentesting/#broken-cryptography)。

### **ローカル認証**

- [ ] アプリケーションで[**ローカル認証**](ios-pentesting/#local-authentication)が使用されている場合、認証がどのように機能しているか確認する。
- [ ] [**ローカル認証フレームワーク**](ios-pentesting/#local-authentication-framework)を使用している場合、簡単に回避できる可能性がある。
- [ ] [**動的に回避可能な関数**](ios-pentesting/#local-authentication-using-keychain)を使用している場合、カスタムFridaスクリプトを作成できる。

### IPCを通じた機密機能の露出

- [**カスタムURIハンドラー / ディープリンク / カスタムスキーム**](ios-pentesting/#custom-uri-handlers-deeplinks-custom-schemes)
- [ ] アプリケーションが**プロトコル/スキームを登録しているか**確認する。
- [ ] アプリケーションが**プロトコル/スキームを使用するために登録しているか**確認する。
- [ ] アプリケーションが**カスタムスキームから受信することを期待している機密情報の種類**を確認し、同じスキームを登録している別のアプリケーションによって**傍受される**可能性があるか確認する。
- [ ] アプリケーションが**カスタムスキームを介してユーザー入力を確認およびサニタイズしていない**場合、いくつかの**脆弱性が悪用される**可能性があるか確認する。
- [ ] アプリケーションが**どこからでも呼び出すことができる機密アクションを公開しているか**確認する。
- [**ユニバーサルリンク**](ios-pentesting/#universal-links)
- [ ] アプリケーションが**ユニバーサルプロトコル/スキームを登録しているか**確認する。
- [ ] `apple-app-site-association`ファイルを確認する。
- [ ] アプリケーションが**カスタムスキームを介してユーザー入力を確認およびサニタイズしていない**場合、いくつかの**脆弱性が悪用される**可能性があるか確認する。
- [ ] アプリケーションが**どこからでも呼び出すことができる機密アクションを公開しているか**確認する。
- [**UIActivity共有**](ios-pentesting/ios-uiactivity-sharing.md)
- [ ] アプリケーションがUIActivitiesを受信できるか、特別に作成されたアクティビティで脆弱性を悪用できるか確認する。
- [**UIPasteboard**](ios-pentesting/ios-uipasteboard.md)
- [ ] アプリケーションが**一般的なペーストボードに何かをコピーしているか**確認する。
- [ ] アプリケーションが**一般的なペーストボードのデータを何かに使用しているか**確認する。
- [ ] ペーストボードを監視して、**機密データがコピーされているか**確認する。
- [**アプリ拡張**](ios-pentesting/ios-app-extensions.md)
- [ ] アプリケーションが**拡張を使用しているか**？
- [**WebViews**](ios-pentesting/ios-webviews.md)
- [ ] 使用されているWebViewの種類を確認する。
- [ ] **`javaScriptEnabled`**、**`JavaScriptCanOpenWindowsAutomatically`**、**`hasOnlySecureContent`**の状態を確認する。
- [ ] WebViewが**file://**プロトコルで**ローカルファイルにアクセスできるか**確認する（`allowFileAccessFromFileURLs`、`allowUniversalAccessFromFileURLs`）。
- [ ] Javascriptが**ネイティブ**の**メソッド**（`JSContext`、`postMessage`）にアクセスできるか確認する。

### ネットワーク通信

- [ ] [**通信に対するMitMを実行**](ios-pentesting/#network-communication)し、Webの脆弱性を探す。
- [ ] [**証明書のホスト名**](ios-pentesting/#hostname-check)が確認されているか確認する。
- [ ] [**証明書ピンニング**](ios-pentesting/#certificate-pinning)を確認/回避する。

### **その他**

- [ ] [**自動パッチ/更新**](ios-pentesting/#hot-patching-enforced-updateing)メカニズムを確認する。
- [ ] [**悪意のあるサードパーティライブラリ**](ios-pentesting/#third-parties)を確認する。

{{#include ../banners/hacktricks-training.md}}
