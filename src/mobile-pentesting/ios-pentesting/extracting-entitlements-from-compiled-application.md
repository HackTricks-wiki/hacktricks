# Kutolewa kwa Haki kutoka kwa Programu Iliyoandikwa

{{#include ../../banners/hacktricks-training.md}}

Muhtasari wa ukurasa [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0069/#review-entitlements-embedded-in-the-compiled-app-binary](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0069/#review-entitlements-embedded-in-the-compiled-app-binary)

### **Kutolewa kwa Haki na Faili za Utoaji wa Simu**

Wakati wa kushughulikia IPA ya programu au programu iliyosakinishwa kwenye kifaa kilichovunjwa, kupata faili za `.entitlements` au faili ya `embedded.mobileprovision` moja kwa moja huenda isiwezekane. Hata hivyo, orodha za mali za haki bado zinaweza kutolewa kutoka kwa binary ya programu, kufuata taratibu zilizoelezwa katika sura ya "Kujaribu Usalama wa Msingi wa iOS", hasa sehemu ya "Kupata Binary ya Programu".

Hata na binaries zilizofichwa, hatua fulani zinaweza kutumika kutolewa faili hizi. Ikiwa hatua hizi zitashindwa, zana kama Clutch (ikiwa inafaa na toleo la iOS), frida-ios-dump, au zana zinazofanana zinaweza kuhitajika kufichua na kutoa programu.

#### **Kutolewa kwa Orodha ya Haki kutoka kwa Binary ya Programu**

Ikiwa binary ya programu inapatikana kwenye kompyuta, **binwalk** inaweza kutumika kutoa faili zote za XML. Amri iliyo hapa chini inaonyesha jinsi ya kufanya hivyo:
```bash
$ binwalk -e -y=xml ./Telegram\ X

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
1430180       0x15D2A4        XML document, version: "1.0"
1458814       0x16427E        XML document, version: "1.0"
```
Kwa upande mwingine, **radare2** inaweza kutumika kutekeleza amri kwa kimya na kutoka, ikitafuta nyuzi zote katika binary ya programu zinazojumuisha "PropertyList":
```bash
$ r2 -qc 'izz~PropertyList' ./Telegram\ X

0x0015d2a4 ascii <?xml version="1.0" encoding="UTF-8" standalone="yes"?>...
0x0016427d ascii H<?xml version="1.0" encoding="UTF-8"?>...
```
Mbinu zote mbili, binwalk na radare2, zinaruhusu uchimbaji wa faili za `plist`, huku ukaguzi wa wa kwanza (0x0015d2a4) ukionyesha urejeleaji wa mafanikio wa [faili ya awali ya entitlements kutoka Telegram](https://github.com/peter-iakovlev/Telegram-iOS/blob/77ee5c4dabdd6eb5f1e2ff76219edf7e18b45c00/Telegram-iOS/Telegram-iOS-AppStoreLLC.entitlements).

Kwa binaries za programu zinazopatikana kwenye vifaa vilivyovunjwa (kwa mfano, kupitia SSH), amri ya **grep** yenye bendera `-a, --text` inaweza kutumika kutibu faili zote kama maandiko ya ASCII:
```bash
$ grep -a -A 5 'PropertyList' /var/containers/Bundle/Application/...
```
Kurekebisha bendera `-A num, --after-context=num` kunaruhusu kuonyeshwa kwa mistari zaidi au kidogo. Njia hii inafaa hata kwa binaries za programu zilizofichwa na imethibitishwa dhidi ya programu nyingi za App Store. Zana zilizoelezwa hapo awali zinaweza pia kutumika kwenye vifaa vya iOS vilivyovunjwa kwa madhumuni sawa.

**Kumbuka**: Matumizi ya moja kwa moja ya amri `strings` hayapendekezwi kwa kazi hii kutokana na mipaka yake katika kupata habari muhimu. Badala yake, kutumia grep na bendera `-a` kwenye binary au kutumia radare2 (`izz`)/rabin2 (`-zz`) inashauriwa kwa matokeo bora zaidi.

{{#include ../../banners/hacktricks-training.md}}
