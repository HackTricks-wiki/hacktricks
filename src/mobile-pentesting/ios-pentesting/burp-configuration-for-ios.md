# iOS Burp Suite Configuration

{{#include ../../banners/hacktricks-training.md}}

## iOS 기기에서 Burp 인증서 설치

안전한 웹 트래픽 분석 및 iOS 기기에서 SSL 핀닝을 위해 Burp Suite는 **Burp Mobile Assistant**를 통해 또는 수동 구성으로 활용할 수 있습니다. 아래는 두 방법에 대한 요약 가이드입니다:

### Burp Mobile Assistant를 통한 자동 설치

**Burp Mobile Assistant**는 Burp 인증서, 프록시 구성 및 SSL 핀닝 설치 과정을 간소화합니다. 자세한 안내는 [PortSwigger의 공식 문서](https://portswigger.net/burp/documentation/desktop/tools/mobile-assistant/installing)에서 확인할 수 있습니다.

### 수동 설치 단계

1. **프록시 구성:** iPhone의 Wi-Fi 설정에서 Burp를 프록시로 설정합니다.
2. **인증서 다운로드:** 기기 브라우저에서 `http://burp`로 이동하여 인증서를 다운로드합니다.
3. **인증서 설치:** 다운로드한 프로필을 **설정** > **일반** > **VPN 및 기기 관리**를 통해 설치한 후, **인증서 신뢰 설정**에서 PortSwigger CA에 대한 신뢰를 활성화합니다.

### 인터셉션 프록시 구성

이 설정은 Burp를 통해 iOS 기기와 인터넷 간의 트래픽 분석을 가능하게 하며, 클라이언트 간 트래픽을 지원하는 Wi-Fi 네트워크가 필요합니다. 사용 불가능할 경우, usbmuxd를 통한 USB 연결이 대안이 될 수 있습니다. PortSwigger의 튜토리얼은 [기기 구성](https://support.portswigger.net/customer/portal/articles/1841108-configuring-an-ios-device-to-work-with-burp) 및 [인증서 설치](https://support.portswigger.net/customer/portal/articles/1841109-installing-burp-s-ca-certificate-in-an-ios-device)에 대한 심층 지침을 제공합니다.

### 탈옥 기기를 위한 고급 구성

탈옥된 기기를 사용하는 경우, USB를 통한 SSH( **iproxy** 사용)는 트래픽을 Burp를 통해 직접 라우팅하는 방법을 제공합니다:

1. **SSH 연결 설정:** iproxy를 사용하여 SSH를 로컬호스트로 포워딩하여 iOS 기기가 Burp를 실행하는 컴퓨터에 연결할 수 있도록 합니다.

```bash
iproxy 2222 22
```

2. **원격 포트 포워딩:** iOS 기기의 포트 8080을 컴퓨터의 로컬호스트로 포워딩하여 Burp의 인터페이스에 직접 접근할 수 있도록 합니다.

```bash
ssh -R 8080:localhost:8080 root@localhost -p 2222
```

3. **전역 프록시 설정:** 마지막으로, iOS 기기의 Wi-Fi 설정을 수동 프록시를 사용하도록 구성하여 모든 웹 트래픽이 Burp를 통해 흐르도록 합니다.

### 전체 네트워크 모니터링/스니핑

비 HTTP 기기 트래픽 모니터링은 모든 형태의 데이터 트래픽을 캡처할 수 있는 도구인 **Wireshark**를 사용하여 효율적으로 수행할 수 있습니다. iOS 기기의 경우, 원격 가상 인터페이스 생성을 통해 실시간 트래픽 모니터링이 가능하며, 이 과정은 [이 Stack Overflow 게시물](https://stackoverflow.com/questions/9555403/capturing-mobile-phone-traffic-on-wireshark/33175819#33175819)에서 자세히 설명되어 있습니다. 시작하기 전에 macOS 시스템에 **Wireshark**를 설치하는 것이 필요합니다.

절차는 여러 주요 단계로 구성됩니다:

1. iOS 기기와 macOS 호스트 간의 USB 연결을 시작합니다.
2. 트래픽 모니터링에 필요한 iOS 기기의 **UDID**를 확인합니다. 이는 macOS 터미널에서 명령을 실행하여 수행할 수 있습니다:
```bash
$ rvictl -s <UDID>
Starting device <UDID> [SUCCEEDED] with interface rvi0
```
3. UDID 식별 후, **Wireshark**를 열고 데이터 캡처를 위해 "rvi0" 인터페이스를 선택합니다.  
4. 특정 IP 주소와 관련된 HTTP 트래픽 캡처와 같은 목표 모니터링을 위해 Wireshark의 캡처 필터를 사용할 수 있습니다:

## 시뮬레이터에서 Burp Cert 설치

- **Burp 인증서 내보내기**

_Proxy_ --> _Options_ --> _Export CA certificate_ --> _Certificate in DER format_

![](<../../images/image (534).png>)

- 인증서를 에뮬레이터 안으로 **드래그 앤 드롭**합니다.  
- **에뮬레이터 안에서** _Settings_ --> _General_ --> _Profile_ --> _PortSwigger CA_로 가서 **인증서를 확인합니다.**  
- **에뮬레이터 안에서** _Settings_ --> _General_ --> _About_ --> _Certificate Trust Settings_로 가서 **PortSwigger CA를 활성화합니다.**

![](<../../images/image (1048).png>)

**축하합니다, iOS 시뮬레이터에서 Burp CA 인증서를 성공적으로 구성했습니다.**

> [!NOTE]  
> **iOS 시뮬레이터는 MacOS의 프록시 구성을 사용합니다.**

### MacOS 프록시 구성

Burp를 프록시로 구성하는 단계:

- _System Preferences_ --> _Network_ --> _Advanced_로 이동합니다.  
- _Proxies_ 탭에서 _Web Proxy (HTTP)_와 _Secure Web Proxy (HTTPS)_를 선택합니다.  
- 두 옵션 모두에 _127.0.0.1:8080_을 구성합니다.

![](<../../images/image (431).png>)

- _**Ok**_를 클릭한 후 _**Apply**_를 클릭합니다.  

{{#include ../../banners/hacktricks-training.md}}
