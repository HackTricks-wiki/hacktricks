# iOS Burp Suite Konfiguration

{{#include ../../banners/hacktricks-training.md}}

## Installation des Burp-Zertifikats auf iOS-Geräten

Für die sichere Analyse von Webverkehr und SSL-Pinning auf iOS-Geräten kann die Burp Suite entweder über den **Burp Mobile Assistant** oder durch manuelle Konfiguration genutzt werden. Nachfolgend finden Sie eine zusammengefasste Anleitung zu beiden Methoden:

### Automatische Installation mit Burp Mobile Assistant

Der **Burp Mobile Assistant** vereinfacht den Installationsprozess des Burp-Zertifikats, die Proxy-Konfiguration und das SSL-Pinning. Detaillierte Anleitungen finden Sie in der [offiziellen Dokumentation von PortSwigger](https://portswigger.net/burp/documentation/desktop/tools/mobile-assistant/installing).

### Manuelle Installationsschritte

1. **Proxy-Konfiguration:** Beginnen Sie damit, Burp als Proxy in den Wi-Fi-Einstellungen des iPhones einzustellen.
2. **Zertifikat herunterladen:** Navigieren Sie im Browser Ihres Geräts zu `http://burp`, um das Zertifikat herunterzuladen.
3. **Zertifikat installieren:** Installieren Sie das heruntergeladene Profil über **Einstellungen** > **Allgemein** > **VPN & Geräteverwaltung**, und aktivieren Sie das Vertrauen für die PortSwigger CA unter **Zertifikatvertrauenseinstellungen**.

### Konfiguration eines Interception-Proxys

Die Einrichtung ermöglicht die Analyse des Verkehrs zwischen dem iOS-Gerät und dem Internet über Burp, wobei ein Wi-Fi-Netzwerk erforderlich ist, das Client-zu-Client-Verkehr unterstützt. Falls dies nicht verfügbar ist, kann eine USB-Verbindung über usbmuxd als Alternative dienen. Die Tutorials von PortSwigger bieten detaillierte Anleitungen zur [Gerätekonfiguration](https://support.portswigger.net/customer/portal/articles/1841108-configuring-an-ios-device-to-work-with-burp) und zur [Zertifikatsinstallation](https://support.portswigger.net/customer/portal/articles/1841109-installing-burp-s-ca-certificate-in-an-ios-device).

### Erweiterte Konfiguration für Jailbreak-Geräte

Für Benutzer mit jailbroken Geräten bietet SSH über USB (via **iproxy**) eine Methode, um den Verkehr direkt über Burp zu leiten:

1.  **SSH-Verbindung herstellen:** Verwenden Sie iproxy, um SSH auf localhost weiterzuleiten, sodass eine Verbindung vom iOS-Gerät zum Computer, auf dem Burp läuft, hergestellt werden kann.

```bash
iproxy 2222 22
```

2.  **Remote-Portweiterleitung:** Leiten Sie den Port 8080 des iOS-Geräts an den localhost des Computers weiter, um direkten Zugriff auf die Burp-Oberfläche zu ermöglichen.

```bash
ssh -R 8080:localhost:8080 root@localhost -p 2222
```

3.  **Globale Proxy-Einstellung:** Konfigurieren Sie schließlich die Wi-Fi-Einstellungen des iOS-Geräts so, dass ein manueller Proxy verwendet wird, der den gesamten Webverkehr über Burp leitet.

### Vollständige Netzwerküberwachung/Sniffing

Die Überwachung des nicht-HTTP-Verkehrs von Geräten kann effizient mit **Wireshark** durchgeführt werden, einem Tool, das in der Lage ist, alle Formen von Datenverkehr zu erfassen. Für iOS-Geräte wird die Echtzeitüberwachung des Verkehrs durch die Erstellung eines Remote Virtual Interface erleichtert, ein Prozess, der in [diesem Stack Overflow-Beitrag](https://stackoverflow.com/questions/9555403/capturing-mobile-phone-traffic-on-wireshark/33175819#33175819) detailliert beschrieben ist. Vor Beginn ist die Installation von **Wireshark** auf einem macOS-System eine Voraussetzung.

Das Verfahren umfasst mehrere wichtige Schritte:

1. Stellen Sie eine Verbindung zwischen dem iOS-Gerät und dem macOS-Host über USB her.
2. Bestimmen Sie die **UDID** des iOS-Geräts, ein notwendiger Schritt für die Verkehrsüberwachung. Dies kann durch Ausführen eines Befehls im macOS-Terminal erfolgen:
```bash
$ rvictl -s <UDID>
Starting device <UDID> [SUCCEEDED] with interface rvi0
```
3. Nach der Identifizierung der UDID ist **Wireshark** zu öffnen und das "rvi0"-Interface für die Datenerfassung auszuwählen.  
4. Für gezielte Überwachung, wie das Erfassen von HTTP-Verkehr, der mit einer bestimmten IP-Adresse verbunden ist, können die Capture-Filter von Wireshark verwendet werden:

## Burp-Zertifikat-Installation im Simulator

- **Burp-Zertifikat exportieren**

In _Proxy_ --> _Options_ --> _Export CA certificate_ --> _Certificate in DER format_

![](<../../images/image (534).png>)

- **Ziehen und Ablegen** des Zertifikats in den Emulator  
- **Im Emulator** zu _Settings_ --> _General_ --> _Profile_ --> _PortSwigger CA_ gehen und **das Zertifikat überprüfen**  
- **Im Emulator** zu _Settings_ --> _General_ --> _About_ --> _Certificate Trust Settings_ gehen und **PortSwigger CA aktivieren**

![](<../../images/image (1048).png>)

**Herzlichen Glückwunsch, Sie haben das Burp CA-Zertifikat erfolgreich im iOS-Simulator konfiguriert**

> [!NOTE]  
> **Der iOS-Simulator verwendet die Proxy-Konfigurationen von MacOS.**

### MacOS-Proxy-Konfiguration

Schritte zur Konfiguration von Burp als Proxy:

- Gehe zu _System Preferences_ --> _Network_ --> _Advanced_  
- Im Tab _Proxies_ die Optionen _Web Proxy (HTTP)_ und _Secure Web Proxy (HTTPS)_ markieren  
- In beiden Optionen _127.0.0.1:8080_ konfigurieren  

![](<../../images/image (431).png>)

- Klicken Sie auf _**Ok**_ und dann auf _**Apply**_  


{{#include ../../banners/hacktricks-training.md}}
