# Configurazione di Burp Suite per iOS

{{#include ../../banners/hacktricks-training.md}}

## Installazione del Certificato Burp sui Dispositivi iOS

Per l'analisi sicura del traffico web e il SSL pinning sui dispositivi iOS, Burp Suite può essere utilizzato sia tramite il **Burp Mobile Assistant** che tramite configurazione manuale. Di seguito è riportata una guida riassuntiva su entrambi i metodi:

### Installazione Automatica con Burp Mobile Assistant

Il **Burp Mobile Assistant** semplifica il processo di installazione del Certificato Burp, configurazione del proxy e SSL Pinning. Ulteriori dettagli possono essere trovati nella [documentazione ufficiale di PortSwigger](https://portswigger.net/burp/documentation/desktop/tools/mobile-assistant/installing).

### Passaggi per l'Installazione Manuale

1. **Configurazione del Proxy:** Inizia impostando Burp come proxy nelle impostazioni Wi-Fi dell'iPhone.
2. **Download del Certificato:** Naviga su `http://burp` nel browser del tuo dispositivo per scaricare il certificato.
3. **Installazione del Certificato:** Installa il profilo scaricato tramite **Impostazioni** > **Generale** > **VPN e gestione dispositivo**, quindi abilita la fiducia per il CA di PortSwigger sotto **Impostazioni di fiducia del certificato**.

### Configurazione di un Proxy di Intercettazione

La configurazione consente l'analisi del traffico tra il dispositivo iOS e Internet tramite Burp, richiedendo una rete Wi-Fi che supporti il traffico client-to-client. Se non disponibile, una connessione USB tramite usbmuxd può servire come alternativa. I tutorial di PortSwigger forniscono istruzioni dettagliate sulla [configurazione del dispositivo](https://support.portswigger.net/customer/portal/articles/1841108-configuring-an-ios-device-to-work-with-burp) e sull'[installazione del certificato](https://support.portswigger.net/customer/portal/articles/1841109-installing-burp-s-ca-certificate-in-an-ios-device).

### Configurazione Avanzata per Dispositivi Jailbroken

Per gli utenti con dispositivi jailbroken, SSH su USB (tramite **iproxy**) offre un metodo per instradare il traffico direttamente attraverso Burp:

1.  **Stabilire la Connessione SSH:** Usa iproxy per inoltrare SSH a localhost, consentendo la connessione dal dispositivo iOS al computer che esegue Burp.

```bash
iproxy 2222 22
```

2.  **Inoltro della Porta Remota:** Inoltra la porta 8080 del dispositivo iOS al localhost del computer per abilitare l'accesso diretto all'interfaccia di Burp.

```bash
ssh -R 8080:localhost:8080 root@localhost -p 2222
```

3.  **Impostazione del Proxy Globale:** Infine, configura le impostazioni Wi-Fi del dispositivo iOS per utilizzare un proxy manuale, indirizzando tutto il traffico web attraverso Burp.

### Monitoraggio/Sniffing Completo della Rete

Il monitoraggio del traffico non-HTTP del dispositivo può essere condotto in modo efficiente utilizzando **Wireshark**, uno strumento in grado di catturare tutte le forme di traffico dati. Per i dispositivi iOS, il monitoraggio del traffico in tempo reale è facilitato dalla creazione di un Interfaccia Virtuale Remota, un processo dettagliato in [questo post di Stack Overflow](https://stackoverflow.com/questions/9555403/capturing-mobile-phone-traffic-on-wireshark/33175819#33175819). Prima di iniziare, è necessario installare **Wireshark** su un sistema macOS.

La procedura prevede diversi passaggi chiave:

1. Inizia una connessione tra il dispositivo iOS e l'host macOS tramite USB.
2. Accertati del **UDID** del dispositivo iOS, un passaggio necessario per il monitoraggio del traffico. Questo può essere fatto eseguendo un comando nel Terminale di macOS:
```bash
$ rvictl -s <UDID>
Starting device <UDID> [SUCCEEDED] with interface rvi0
```
3. Dopo l'identificazione dell'UDID, **Wireshark** deve essere aperto e selezionata l'interfaccia "rvi0" per la cattura dei dati.  
4. Per il monitoraggio mirato, come la cattura del traffico HTTP relativo a un indirizzo IP specifico, possono essere utilizzati i Filtri di Cattura di Wireshark:

## Installazione del Certificato Burp nel Simulatore

- **Esporta il Certificato Burp**

In _Proxy_ --> _Options_ --> _Export CA certificate_ --> _Certificate in DER format_

![](<../../images/image (534).png>)

- **Trascina e Rilascia** il certificato all'interno dell'Emulatore  
- **All'interno dell'emulatore** vai su _Settings_ --> _General_ --> _Profile_ --> _PortSwigger CA_, e **verifica il certificato**  
- **All'interno dell'emulatore** vai su _Settings_ --> _General_ --> _About_ --> _Certificate Trust Settings_, e **abilita PortSwigger CA**

![](<../../images/image (1048).png>)

**Congratulazioni, hai configurato con successo il Certificato CA di Burp nel simulatore iOS**

> [!NOTE]  
> **Il simulatore iOS utilizzerà le configurazioni proxy del MacOS.**

### Configurazione Proxy MacOS

Passaggi per configurare Burp come proxy:

- Vai su _System Preferences_ --> _Network_ --> _Advanced_  
- Nella scheda _Proxies_ seleziona _Web Proxy (HTTP)_ e _Secure Web Proxy (HTTPS)_  
- In entrambe le opzioni configura _127.0.0.1:8080_

![](<../../images/image (431).png>)

- Clicca su _**Ok**_ e poi su _**Apply**_  


{{#include ../../banners/hacktricks-training.md}}
