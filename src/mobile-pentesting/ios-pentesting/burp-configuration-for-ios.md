# Configuración de Burp Suite para iOS

{{#include ../../banners/hacktricks-training.md}}

## Instalación del Certificado Burp en Dispositivos iOS

Para el análisis seguro del tráfico web y el SSL pinning en dispositivos iOS, se puede utilizar Burp Suite a través del **Burp Mobile Assistant** o mediante configuración manual. A continuación se presenta una guía resumida sobre ambos métodos:

### Instalación Automatizada con Burp Mobile Assistant

El **Burp Mobile Assistant** simplifica el proceso de instalación del Certificado Burp, la configuración del proxy y el SSL Pinning. Se puede encontrar una guía detallada en la [documentación oficial de PortSwigger](https://portswigger.net/burp/documentation/desktop/tools/mobile-assistant/installing).

### Pasos de Instalación Manual

1. **Configuración del Proxy:** Comience configurando Burp como el proxy en la configuración de Wi-Fi del iPhone.
2. **Descarga del Certificado:** Navegue a `http://burp` en el navegador de su dispositivo para descargar el certificado.
3. **Instalación del Certificado:** Instale el perfil descargado a través de **Configuración** > **General** > **VPN y Gestión de Dispositivos**, luego habilite la confianza para el CA de PortSwigger en **Configuración de Confianza del Certificado**.

### Configuración de un Proxy de Intercepción

La configuración permite el análisis del tráfico entre el dispositivo iOS y el internet a través de Burp, requiriendo una red Wi-Fi que soporte tráfico de cliente a cliente. Si no está disponible, una conexión USB a través de usbmuxd puede servir como alternativa. Los tutoriales de PortSwigger proporcionan instrucciones detalladas sobre [la configuración del dispositivo](https://support.portswigger.net/customer/portal/articles/1841108-configuring-an-ios-device-to-work-with-burp) y [la instalación del certificado](https://support.portswigger.net/customer/portal/articles/1841109-installing-burp-s-ca-certificate-in-an-ios-device).

### Configuración Avanzada para Dispositivos Jailbroken

Para usuarios con dispositivos jailbroken, SSH sobre USB (a través de **iproxy**) ofrece un método para enrutar el tráfico directamente a través de Burp:

1.  **Establecer Conexión SSH:** Use iproxy para redirigir SSH a localhost, permitiendo la conexión desde el dispositivo iOS a la computadora que ejecuta Burp.

```bash
iproxy 2222 22
```

2.  **Redirección de Puerto Remoto:** Redirija el puerto 8080 del dispositivo iOS al localhost de la computadora para habilitar el acceso directo a la interfaz de Burp.

```bash
ssh -R 8080:localhost:8080 root@localhost -p 2222
```

3.  **Configuración de Proxy Global:** Por último, configure la configuración de Wi-Fi del dispositivo iOS para usar un proxy manual, dirigiendo todo el tráfico web a través de Burp.

### Monitoreo/Sniffing Completo de Red

El monitoreo del tráfico no HTTP del dispositivo se puede realizar de manera eficiente utilizando **Wireshark**, una herramienta capaz de capturar todas las formas de tráfico de datos. Para dispositivos iOS, el monitoreo de tráfico en tiempo real se facilita a través de la creación de una Interfaz Virtual Remota, un proceso detallado en [esta publicación de Stack Overflow](https://stackoverflow.com/questions/9555403/capturing-mobile-phone-traffic-on-wireshark/33175819#33175819). Antes de comenzar, la instalación de **Wireshark** en un sistema macOS es un requisito previo.

El procedimiento implica varios pasos clave:

1. Inicie una conexión entre el dispositivo iOS y el host macOS a través de USB.
2. Asegúrese del **UDID** del dispositivo iOS, un paso necesario para el monitoreo del tráfico. Esto se puede hacer ejecutando un comando en la Terminal de macOS:
```bash
$ rvictl -s <UDID>
Starting device <UDID> [SUCCEEDED] with interface rvi0
```
3. Después de identificar el UDID, **Wireshark** debe abrirse y seleccionar la interfaz "rvi0" para la captura de datos.  
4. Para el monitoreo específico, como capturar tráfico HTTP relacionado con una dirección IP específica, se pueden emplear los Filtros de Captura de Wireshark:

## Instalación del Certificado Burp en el Simulador

- **Exportar Certificado Burp**

En _Proxy_ --> _Options_ --> _Export CA certificate_ --> _Certificate in DER format_

![](<../../images/image (534).png>)

- **Arrastrar y Soltar** el certificado dentro del Emulador  
- **Dentro del emulador**, ir a _Settings_ --> _General_ --> _Profile_ --> _PortSwigger CA_, y **verificar el certificado**  
- **Dentro del emulador**, ir a _Settings_ --> _General_ --> _About_ --> _Certificate Trust Settings_, y **habilitar PortSwigger CA**

![](<../../images/image (1048).png>)

**Felicidades, has configurado exitosamente el Certificado CA de Burp en el simulador de iOS**

> [!NOTE]  
> **El simulador de iOS utilizará las configuraciones de proxy de MacOS.**

### Configuración de Proxy en MacOS

Pasos para configurar Burp como proxy:

- Ir a _System Preferences_ --> _Network_ --> _Advanced_  
- En la pestaña _Proxies_ marcar _Web Proxy (HTTP)_ y _Secure Web Proxy (HTTPS)_  
- En ambas opciones configurar _127.0.0.1:8080_

![](<../../images/image (431).png>)

- Hacer clic en _**Ok**_ y luego en _**Apply**_  


{{#include ../../banners/hacktricks-training.md}}
