# iOS Burp Suite Configuration

{{#include ../../banners/hacktricks-training.md}}

## Встановлення сертифіката Burp на пристроях iOS

Для безпечного аналізу веб-трафіку та SSL pinning на пристроях iOS, Burp Suite можна використовувати або через **Burp Mobile Assistant**, або через ручну конфігурацію. Нижче наведено узагальнений посібник обох методів:

### Автоматичне встановлення за допомогою Burp Mobile Assistant

**Burp Mobile Assistant** спрощує процес встановлення сертифіката Burp, конфігурації проксі та SSL Pinning. Детальні інструкції можна знайти в [офіційній документації PortSwigger](https://portswigger.net/burp/documentation/desktop/tools/mobile-assistant/installing).

### Кроки ручного встановлення

1. **Конфігурація проксі:** Почніть з налаштування Burp як проксі в налаштуваннях Wi-Fi iPhone.
2. **Завантаження сертифіката:** Перейдіть на `http://burp` у браузері вашого пристрою, щоб завантажити сертифікат.
3. **Встановлення сертифіката:** Встановіть завантажений профіль через **Налаштування** > **Основні** > **VPN та управління пристроєм**, потім увімкніть довіру для PortSwigger CA в **Налаштуваннях довіри сертифікатів**.

### Налаштування проксі для перехоплення

Налаштування дозволяє аналізувати трафік між пристроєм iOS та інтернетом через Burp, вимагаючи Wi-Fi мережу, яка підтримує клієнтський трафік. Якщо це неможливо, USB-з'єднання через usbmuxd може слугувати альтернативою. Тут ви знайдете детальні інструкції щодо [конфігурації пристрою](https://support.portswigger.net/customer/portal/articles/1841108-configuring-an-ios-device-to-work-with-burp) та [встановлення сертифіката](https://support.portswigger.net/customer/portal/articles/1841109-installing-burp-s-ca-certificate-in-an-ios-device).

### Розширена конфігурація для джейлбрейкнутіх пристроїв

Для користувачів з джейлбрейкнутими пристроями, SSH через USB (за допомогою **iproxy**) пропонує метод маршрутизації трафіку безпосередньо через Burp:

1.  **Встановлення SSH-з'єднання:** Використовуйте iproxy для перенаправлення SSH на localhost, що дозволяє з'єднання з пристроєм iOS до комп'ютера, на якому працює Burp.

```bash
iproxy 2222 22
```

2.  **Віддалене перенаправлення порту:** Перенаправте порт 8080 пристрою iOS на localhost комп'ютера, щоб забезпечити прямий доступ до інтерфейсу Burp.

```bash
ssh -R 8080:localhost:8080 root@localhost -p 2222
```

3.  **Глобальні налаштування проксі:** Нарешті, налаштуйте налаштування Wi-Fi пристрою iOS для використання ручного проксі, направляючи весь веб-трафік через Burp.

### Повний моніторинг/перехоплення мережі

Моніторинг не-HTTP трафіку пристроїв можна ефективно проводити за допомогою **Wireshark**, інструменту, здатного захоплювати всі форми даних. Для пристроїв iOS моніторинг трафіку в реальному часі здійснюється через створення віддаленого віртуального інтерфейсу, процес якого детально описано в [цьому пості на Stack Overflow](https://stackoverflow.com/questions/9555403/capturing-mobile-phone-traffic-on-wireshark/33175819#33175819). Перед початком необхідно встановити **Wireshark** на систему macOS.

Процедура включає кілька ключових кроків:

1. Ініціюйте з'єднання між пристроєм iOS та хостом macOS через USB.
2. Визначте **UDID** пристрою iOS, що є необхідним кроком для моніторингу трафіку. Це можна зробити, виконавши команду в терміналі macOS:
```bash
$ rvictl -s <UDID>
Starting device <UDID> [SUCCEEDED] with interface rvi0
```
3. Після ідентифікації UDID, **Wireshark** потрібно відкрити та вибрати інтерфейс "rvi0" для захоплення даних.  
4. Для цілеспрямованого моніторингу, наприклад, захоплення HTTP-трафіку, пов'язаного з певною IP-адресою, можна використовувати фільтри захоплення Wireshark:

## Встановлення сертифіката Burp в емуляторі

- **Експортувати сертифікат Burp**

У _Proxy_ --> _Options_ --> _Export CA certificate_ --> _Certificate in DER format_

![](<../../images/image (534).png>)

- **Перетягніть і скиньте** сертифікат всередину емулятора  
- **Внутрішньо в емуляторі** перейдіть до _Settings_ --> _General_ --> _Profile_ --> _PortSwigger CA_, і **перевірте сертифікат**  
- **Внутрішньо в емуляторі** перейдіть до _Settings_ --> _General_ --> _About_ --> _Certificate Trust Settings_, і **увімкніть PortSwigger CA**

![](<../../images/image (1048).png>)

**Вітаємо, ви успішно налаштували сертифікат CA Burp в емуляторі iOS**

> [!NOTE]  
> **Емулятор iOS використовуватиме конфігурації проксі MacOS.**

### Конфігурація проксі MacOS

Кроки для налаштування Burp як проксі:

- Перейдіть до _System Preferences_ --> _Network_ --> _Advanced_  
- У вкладці _Proxies_ позначте _Web Proxy (HTTP)_ та _Secure Web Proxy (HTTPS)_  
- У обох опціях налаштуйте _127.0.0.1:8080_

![](<../../images/image (431).png>)

- Натисніть на _**Ok**_ і потім на _**Apply**_  


{{#include ../../banners/hacktricks-training.md}}
