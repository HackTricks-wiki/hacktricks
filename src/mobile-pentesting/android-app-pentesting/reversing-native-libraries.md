# 反向工程本地库

{{#include ../../banners/hacktricks-training.md}}

<figure><img src="/images/image (2).png" alt=""><figcaption></figcaption></figure>

通过8kSec Academy深化您在**移动安全**方面的专业知识。通过我们的自学课程掌握iOS和Android安全并获得认证：

{% embed url="https://academy.8ksec.io/" %}

**更多信息请查看：** [**https://maddiestone.github.io/AndroidAppRE/reversing_native_libs.html**](https://maddiestone.github.io/AndroidAppRE/reversing_native_libs.html)

Android应用可以使用本地库，通常用C或C++编写，以执行性能关键的任务。恶意软件创建者也使用这些库，因为它们比DEX字节码更难以反向工程。该部分强调针对Android的反向工程技能，而不是教授汇编语言。提供ARM和x86版本的库以确保兼容性。

### 关键点：

- **Android应用中的本地库：**
- 用于性能密集型任务。
- 用C或C++编写，使反向工程具有挑战性。
- 以`.so`（共享对象）格式存在，类似于Linux二进制文件。
- 恶意软件创建者更喜欢本地代码以增加分析难度。
- **Java本地接口（JNI）和Android NDK：**
- JNI允许在本地代码中实现Java方法。
- NDK是用于编写本地代码的Android特定工具集。
- JNI和NDK将Java（或Kotlin）代码与本地库连接起来。
- **库加载与执行：**
- 使用`System.loadLibrary`或`System.load`将库加载到内存中。
- 在加载库时执行JNI_OnLoad。
- Java声明的本地方法链接到本地函数，从而启用执行。
- **将Java方法链接到本地函数：**
- **动态链接：** 本地库中的函数名称匹配特定模式，允许自动链接。
- **静态链接：** 使用`RegisterNatives`进行链接，提供函数命名和结构的灵活性。
- **反向工程工具和技术：**
- Ghidra和IDA Pro等工具有助于分析本地库。
- `JNIEnv`对于理解JNI函数和交互至关重要。
- 提供练习以实践加载库、链接方法和识别本地函数。

### 资源：

- **学习ARM汇编：**
- 建议深入了解底层架构。
- 推荐Azeria Labs的[ARM汇编基础](https://azeria-labs.com/writing-arm-assembly-part-1/)。
- **JNI和NDK文档：**
- [Oracle的JNI规范](https://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/jniTOC.html)
- [Android的JNI提示](https://developer.android.com/training/articles/perf-jni)
- [开始使用NDK](https://developer.android.com/ndk/guides/)
- **调试本地库：**
- [使用JEB反编译器调试Android本地库](https://medium.com/@shubhamsonani/how-to-debug-android-native-libraries-using-jeb-decompiler-eec681a22cf3)

<figure><img src="/images/image (2).png" alt=""><figcaption></figcaption></figure>

通过8kSec Academy深化您在**移动安全**方面的专业知识。通过我们的自学课程掌握iOS和Android安全并获得认证：

{% embed url="https://academy.8ksec.io/" %}

{{#include ../../banners/hacktricks-training.md}}
