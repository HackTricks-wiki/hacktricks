# Kutumia programu inayoweza kudhibitiwa

{{#include ../../banners/hacktricks-training.md}}

# **Kupita vizuizi vya root na vya kudhibitiwa**

Sehemu hii ya chapisho ni muhtasari kutoka kwa chapisho [**https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0**](https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0)

## Hatua za Kufanya Programu ya Android Iweze Kudhibitiwa na Kupita Vizuizi

### **Kufanya Programu Iweze Kudhibitiwa**

Maudhui yanategemea https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0

1. **Decompile APK:**

- Tumia zana ya APK-GUI kwa ajili ya decompiling APK.
- Katika faili _android-manifest_, weka `android:debuggable=true` ili kuwezesha hali ya kudhibiti.
- Recompile, sign, na zipalign programu iliyobadilishwa.

2. **Sakinisha Programu Iliyobadilishwa:**

- Tumia amri: `adb install <application_name>`.

3. **Pata Jina la Kifurushi:**

- Tekeleza `adb shell pm list packages –3` ili orodhesha programu za wahusika wengine na kupata jina la kifurushi.

4. **Weka Programu Kusubiri Muunganisho wa Debugger:**

- Amri: `adb shell am setup-debug-app –w <package_name>`.
- **Kumbuka:** Amri hii lazima ifanywe kila wakati kabla ya kuanzisha programu ili kuhakikisha inasubiri debugger.
- Kwa kudumu, tumia `adb shell am setup-debug-app –w -–persistent <package_name>`.
- Kuondoa bendera zote, tumia `adb shell am clear-debug-app <package_name>`.

5. **Jiandae kwa Debugging katika Android Studio:**

- Tembea katika Android Studio hadi _File -> Open Profile or APK_.
- Fungua APK iliyorekebishwa.

6. **Weka Breakpoints katika Faili Muhimu za Java:**
- Weka breakpoints katika `MainActivity.java` (hasa katika njia ya `onCreate`), `b.java`, na `ContextWrapper.java`.

### **Kupita Vizuizi**

Programu, katika hatua fulani, itathibitisha ikiwa inaweza kudhibitiwa na pia itakagua binaries zinazoashiria kifaa kilichoshikiliwa. Debugger inaweza kutumika kubadilisha taarifa za programu, kuondoa kipande cha kudhibiti, na kubadilisha majina ya binaries yanayotafutwa ili kupita vizuizi hivi.

Kwa ajili ya ukaguzi wa kudhibitiwa:

1. **Badilisha Mipangilio ya Bendera:**
- Katika sehemu ya mabadiliko ya debugger console, tembea hadi: `this mLoadedAPK -> mApplicationInfo -> flags = 814267974`.
- **Kumbuka:** Uwakilishi wa binary wa `flags = 814267974` ni `11000011100111011110`, unaonyesha kuwa "Flag_debuggable" inafanya kazi.

![https://miro.medium.com/v2/resize:fit:1400/1*-ckiSbWGSoc1beuxxpKbow.png](https://miro.medium.com/v2/resize:fit:1400/1*-ckiSbWGSoc1beuxxpKbow.png)

Hatua hizi kwa pamoja zinahakikisha kuwa programu inaweza kudhibitiwa na kwamba vizuizi fulani vya usalama vinaweza kupitishwa kwa kutumia debugger, kuruhusu uchambuzi wa kina au mabadiliko ya tabia ya programu.

Hatua ya 2 inahusisha kubadilisha thamani ya bendera kuwa 814267972, ambayo inawakilishwa kwa binary kama 110000101101000000100010100.

# **Kutumia Uthibitisho**

Uonyeshaji ulitolewa kwa kutumia programu yenye udhaifu inayojumuisha kitufe na textview. Kwanza, programu inaonyesha "Crack Me". Lengo ni kubadilisha ujumbe kutoka "Try Again" hadi "Hacked" wakati wa utendaji, bila kubadilisha msimbo wa chanzo.

## **Kuangalia Uthibitisho**

- Programu ilidecompiled kwa kutumia `apktool` ili kufikia faili `AndroidManifest.xml`.
- Uwepo wa `android_debuggable="true"` katika AndroidManifest.xml unaonyesha kuwa programu inaweza kudhibitiwa na inahatarishwa kwa matumizi mabaya.
- Inafaa kutambua kuwa `apktool` inatumika pekee kuangalia hali ya kudhibitiwa bila kubadilisha msimbo wowote.

## **Kuandaa Mipangilio**

- Mchakato ulijumuisha kuanzisha emulator, kusakinisha programu yenye udhaifu, na kutumia `adb jdwp` ili kubaini bandari za Dalvik VM zinazot listening.
- JDWP (Java Debug Wire Protocol) inaruhusu kudhibiti programu inayotembea katika VM kwa kufichua bandari ya kipekee.
- Kuelekeza bandari ilikuwa muhimu kwa ajili ya kudhibiti kwa mbali, ikifuatiwa na kuunganisha JDB kwenye programu lengwa.

## **Kuingiza Msimbo Wakati wa Utendaji**

- Uthibitisho ulifanywa kwa kuweka breakpoints na kudhibiti mtiririko wa programu.
- Amri kama `classes` na `methods <class_name>` zilitumika kufichua muundo wa programu.
- Breakpoint iliwekwa katika njia ya `onClick`, na utekelezaji wake ulidhibitiwa.
- Amri za `locals`, `next`, na `set` zilitumika kukagua na kubadilisha mabadiliko ya ndani, hasa kubadilisha ujumbe wa "Try Again" kuwa "Hacked".
- Msimbo uliobadilishwa ulitekelezwa kwa kutumia amri ya `run`, kwa mafanikio kubadilisha matokeo ya programu kwa wakati halisi.

Mfano huu ulionyesha jinsi tabia ya programu inayoweza kudhibitiwa inaweza kubadilishwa, ikionyesha uwezekano wa matumizi mabaya zaidi kama kupata ufikiaji wa shell kwenye kifaa katika muktadha wa programu.

## Marejeleo

- [https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0](https://medium.com/@shubhamsonani/hacking-with-precision-bypass-techniques-via-debugger-in-android-apps-27fd562b2cc0)
- [https://resources.infosecinstitute.com/android-hacking-security-part-6-exploiting-debuggable-android-applications](https://resources.infosecinstitute.com/android-hacking-security-part-6-exploiting-debuggable-android-applications)

{{#include ../../banners/hacktricks-training.md}}
