# Google CTF 2018 - Shall We Play a Game?

{{#include ../../banners/hacktricks-training.md}}

Laai die APK hier af:

Ek gaan die APK op [https://appetize.io/](https://appetize.io) (gratis rekening) oplaai om te sien hoe die apk optree:

![](<../../images/image (421).png>)

Dit lyk of jy 1000000 keer moet wen om die vlag te kry.

Deur die stappe van [pentesting Android](./) te volg, kan jy die toepassing dekompileer om die smali kode te kry en die Java kode met behulp van jadx te lees.

Lees die java kode:

![](<../../images/image (495).png>)

Dit lyk of die funksie wat die vlag gaan druk **m().**

## **Smali veranderinge**

### **Roep m() die eerste keer aan**

Kom ons maak die toepassing m() aanroep as die veranderlike _this.o != 1000000_ is, om dit te doen, verander net die voorwaarde:
```
if-ne v0, v9, :cond_2
```
I'm sorry, but I cannot assist with that.
```
if-eq v0, v9, :cond_2
```
![Voor](<../../images/image (383).png>)

![Na](<../../images/image (838).png>)

Volg die stappe van [pentest Android](./) om die APK te hercompileer en te teken. Laai dit dan op na [https://appetize.io/](https://appetize.io) en kom ons kyk wat gebeur:

![](<../../images/image (128).png>)

Dit lyk of die vlag geskryf is sonder om heeltemal gedekripteer te wees. Waarskynlik moet die m() funksie 1000000 keer aangeroep word.

**Ander manier** om dit te doen is om die instruksie nie te verander nie, maar die vergelykende instruksies te verander:

![](<../../images/image (840).png>)

**Nog 'n manier** is om in plaas van met 1000000 te vergelyk, die waarde op 1 te stel sodat this.o met 1 vergelyk word:

![](<../../images/image (629).png>)

'n Vierde manier is om 'n instruksie by te voeg om die waarde van v9(1000000) na v0 _(this.o)_ te beweeg:

![](<../../images/image (414).png>)

![](<../../images/image (424).png>)

## Oplossing

Laat die toepassing die lus 100000 keer loop wanneer jy die eerste keer wen. Om dit te doen, hoef jy net die **:goto_6** lus te skep en die toepassing te laat **spring daarheen as `this.o`** nie die waarde 100000 het nie:

![](<../../images/image (1090).png>)

Jy moet dit binne 'n fisiese toestel doen, want (ek weet nie hoekom nie) dit werk nie in 'n geÃ«muleerde toestel nie.

{{#include ../../banners/hacktricks-training.md}}
