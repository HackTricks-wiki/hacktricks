{{#include ../../banners/hacktricks-training.md}}

Einige Anwendungen akzeptieren keine vom Benutzer heruntergeladenen Zertifikate. Um den Webverkehr für einige Apps zu inspizieren, müssen wir die Anwendung tatsächlich dekompilieren, ein paar Dinge hinzufügen und sie dann neu kompilieren.

# Automatisch

Das Tool [**https://github.com/shroudedcode/apk-mitm**](https://github.com/shroudedcode/apk-mitm) wird **automatisch** die notwendigen Änderungen an der Anwendung vornehmen, um die Anfragen zu erfassen, und wird auch das Zertifikat-Pinning deaktivieren (falls vorhanden).

# Manuell

Zuerst dekompilieren wir die App: `apktool d *file-name*.apk`

![](../../images/img9.png)

Dann gehen wir in die **Manifest.xml**-Datei und scrollen zum `<\application android>`-Tag und fügen die folgende Zeile hinzu, falls sie noch nicht vorhanden ist:

`android:networkSecurityConfig="@xml/network_security_config"`

Vor dem Hinzufügen:

![](../../images/img10.png)

Nach dem Hinzufügen:

![](../../images/img11.png)

Jetzt gehen wir in den **res/xml**-Ordner und erstellen/modifizieren eine Datei namens network_security_config.xml mit folgendem Inhalt:
```markup
<network-security-config>
<base-config>
<trust-anchors>
<!-- Trust preinstalled CAs -->
<certificates src="system" />
<!-- Additionally trust user added CAs -->
<certificates src="user" />
</trust-anchors>
</base-config>
</network-security-config>
```
Dann speichern Sie die Datei, gehen Sie aus allen Verzeichnissen zurück und bauen Sie die apk mit dem folgenden Befehl neu auf: `apktool b *folder-name/* -o *output-file.apk*`

![](../../images/img12.png)

Schließlich müssen Sie nur noch **die neue Anwendung signieren**. [Lesen Sie diesen Abschnitt der Seite Smali - Decompiling/\[Modifying\]/Compiling, um zu erfahren, wie Sie sie signieren](smali-changes.md#sing-the-new-apk).

{{#include ../../banners/hacktricks-training.md}}
