{{#include ../../banners/hacktricks-training.md}}

一部のアプリケーションはユーザーがダウンロードした証明書を好まないため、特定のアプリのウェブトラフィックを検査するには、実際にアプリケーションを逆コンパイルし、いくつかの変更を加えて再コンパイルする必要があります。

# 自動

ツール [**https://github.com/shroudedcode/apk-mitm**](https://github.com/shroudedcode/apk-mitm) は、リクエストのキャプチャを開始するためにアプリケーションに必要な変更を**自動的に**行い、証明書ピンニングを無効にします（ある場合）。

# 手動

まず、アプリを逆コンパイルします: `apktool d *file-name*.apk`

![](../../images/img9.png)

次に、**Manifest.xml**ファイルに移動し、`<\application android>`タグまでスクロールして、以下の行がまだない場合は追加します:

`android:networkSecurityConfig="@xml/network_security_config"`

追加前:

![](../../images/img10.png)

追加後:

![](../../images/img11.png)

次に、**res/xml**フォルダーに移動し、network_security_config.xmlという名前のファイルを作成または修正し、以下の内容を追加します:
```markup
<network-security-config>
<base-config>
<trust-anchors>
<!-- Trust preinstalled CAs -->
<certificates src="system" />
<!-- Additionally trust user added CAs -->
<certificates src="user" />
</trust-anchors>
</base-config>
</network-security-config>
```
次に、ファイルを保存し、すべてのディレクトリからバックアウトして、次のコマンドでapkを再構築します: `apktool b *folder-name/* -o *output-file.apk*`

![](../../images/img12.png)

最後に、**新しいアプリケーションに署名する**必要があります。[署名する方法については、ページのこのセクションをお読みください Smali - Decompiling/\[Modifying\]/Compiling](smali-changes.md#sing-the-new-apk)。

{{#include ../../banners/hacktricks-training.md}}
