# Blockchain και Κρυπτονομίσματα

{{#include ../../banners/hacktricks-training.md}}

## Βασικές Έννοιες

- **Smart Contracts** ορίζονται ως προγράμματα που εκτελούνται σε ένα blockchain όταν πληρούνται ορισμένες προϋποθέσεις, αυτοματοποιώντας την εκτέλεση συμφωνιών χωρίς διαμεσολαβητές.
- **Decentralized Applications (dApps)** βασίζονται σε smart contracts, με φιλικό προς τον χρήστη front-end και διαφανές, ελεγχόμενο back-end.
- **Tokens & Coins** διαχωρίζονται όπου τα coins λειτουργούν ως ψηφιακό χρήμα, ενώ τα tokens αντιπροσωπεύουν αξία ή ιδιοκτησία σε συγκεκριμένα πλαίσια.
- **Utility Tokens** παρέχουν πρόσβαση σε υπηρεσίες, και **Security Tokens** υποδηλώνουν ιδιοκτησία περιουσιακών στοιχείων.
- **DeFi** σημαίνει Decentralized Finance, προσφέροντας χρηματοοικονομικές υπηρεσίες χωρίς κεντρικές αρχές.
- **DEX** και **DAOs** αναφέρονται σε Decentralized Exchange Platforms και Decentralized Autonomous Organizations, αντίστοιχα.

## Consensus Mechanisms

Οι μηχανισμοί συναίνεσης διασφαλίζουν ασφαλή και συμφωνημένη επαλήθευση συναλλαγών στο blockchain:

- **Proof of Work (PoW)** βασίζεται στην υπολογιστική ισχύ για την επαλήθευση συναλλαγών.
- **Proof of Stake (PoS)** απαιτεί από validators να κατέχουν ένα συγκεκριμένο ποσό tokens, μειώνοντας την κατανάλωση ενέργειας σε σχέση με το PoW.

## Bitcoin Essentials

### Transactions

Οι συναλλαγές Bitcoin περιλαμβάνουν τη μεταφορά κεφαλαίων μεταξύ διευθύνσεων. Οι συναλλαγές επαληθεύονται μέσω ψηφιακών υπογραφών, διασφαλίζοντας ότι μόνο ο κάτοχος του private key μπορεί να ξεκινήσει μεταφορές.

#### Key Components:

- **Multisignature Transactions** απαιτούν πολλαπλές υπογραφές για την εξουσιοδότηση μιας συναλλαγής.
- Οι συναλλαγές αποτελούνται από **inputs** (πηγή των κεφαλαίων), **outputs** (προορισμός), **fees** (πληρωτέα σε miners) και **scripts** (κανόνες της συναλλαγής).

### Lightning Network

Σκοπός του είναι να βελτιώσει την επεκτασιμότητα του Bitcoin επιτρέποντας πολλαπλές συναλλαγές εντός ενός καναλιού, μεταδίδοντας στην blockchain μόνο την τελική κατάσταση.

## Bitcoin Privacy Concerns

Επιθέσεις στο απόρρητο, όπως το **Common Input Ownership** και η **UTXO Change Address Detection**, εκμεταλλεύονται πρότυπα συναλλαγών. Στρατηγικές όπως οι **Mixers** και το **CoinJoin** βελτιώνουν την ανωνυμία με το να συγκαλύπτουν τις συνδέσεις συναλλαγών μεταξύ χρηστών.

## Acquiring Bitcoins Anonymously

Μέθοδοι περιλαμβάνουν συναλλαγές με μετρητά, mining και χρήση mixers. Το **CoinJoin** αναμειγνύει πολλαπλές συναλλαγές για να περιπλέξει την ιχνηλασιμότητα, ενώ το **PayJoin** μεταμφιέζει CoinJoins ως κανονικές συναλλαγές για αυξημένη ιδιωτικότητα.

# Επιθέσεις στην Ιδιωτικότητα του Bitcoin

# Περίληψη Επιθέσεων στην Ιδιωτικότητα του Bitcoin

Στον κόσμο του Bitcoin, το απόρρητο των συναλλαγών και η ανωνυμία των χρηστών συχνά εγείρουν ανησυχίες. Ακολουθεί μια απλοποιημένη επισκόπηση αρκετών συνηθισμένων μεθόδων με τις οποίες οι επιτιθέμενοι μπορούν να υπονομεύσουν το απόρρητο του Bitcoin.

## **Common Input Ownership Assumption**

Γενικά είναι σπάνιο inputs από διαφορετικούς χρήστες να συνδυάζονται σε μια ενιαία συναλλαγή λόγω της πολυπλοκότητας που συνεπάγεται. Έτσι, **δύο input διευθύνσεις στην ίδια συναλλαγή συχνά θεωρούνται ότι ανήκουν στον ίδιο κάτοχο**.

## **UTXO Change Address Detection**

Μια UTXO, ή **Unspent Transaction Output**, πρέπει να ξοδευτεί ολόκληρη σε μια συναλλαγή. Εάν μόνο ένα μέρος της αποσταλεί σε άλλη διεύθυνση, το υπόλοιπο πηγαίνει σε μια νέα change address. Οι παρατηρητές μπορούν να υποθέσουν ότι αυτή η νέα διεύθυνση ανήκει στον αποστολέα, υπονομεύοντας το απόρρητο.

### Παράδειγμα

Για να μετριαστεί αυτό, υπηρεσίες mixing ή η χρήση πολλαπλών διευθύνσεων μπορούν να βοηθήσουν να συγκαλυφθεί η ιδιοκτησία.

## **Social Networks & Forums Exposure**

Οι χρήστες μερικές φορές μοιράζονται τις διευθύνσεις Bitcoin online, καθιστώντας εύκολη τη σύνδεση της διεύθυνσης με τον κάτοχό της.

## **Transaction Graph Analysis**

Οι συναλλαγές μπορούν να οπτικοποιηθούν ως γράφοι, αποκαλύπτοντας πιθανές συνδέσεις μεταξύ χρηστών με βάση τη ροή κεφαλαίων.

## **Unnecessary Input Heuristic (Optimal Change Heuristic)**

Αυτή η ευρετική βασίζεται στην ανάλυση συναλλαγών με πολλαπλά inputs και outputs για να μαντέψει ποιο output είναι το change που επιστρέφει στον αποστολέα.

### Παράδειγμα
```bash
2 btc --> 4 btc
3 btc     1 btc
```
If adding more inputs makes the change output larger than any single input, it can confuse the heuristic.

## **Forced Address Reuse**

Οι επιτιθέμενοι μπορεί να στείλουν μικρά ποσά σε διευθύνσεις που έχουν χρησιμοποιηθεί προηγουμένως, ελπίζοντας ότι ο παραλήπτης θα τα συνδυάσει με άλλες εισόδους σε μελλοντικές συναλλαγές, συνδέοντας έτσι τις διευθύνσεις μεταξύ τους.

### Correct Wallet Behavior

Τα Wallets θα πρέπει να αποφεύγουν τη χρήση νομισμάτων που ελήφθησαν σε ήδη χρησιμοποιημένες, κενές διευθύνσεις για να προλάβουν αυτό το privacy leak.

## **Other Blockchain Analysis Techniques**

- **Exact Payment Amounts:** Συναλλαγές χωρίς change είναι πιθανό να είναι μεταξύ δύο διευθύνσεων που ανήκουν στον ίδιο χρήστη.
- **Round Numbers:** Ένας στρογγυλός αριθμός σε μια συναλλαγή υποδηλώνει ότι είναι πληρωμή, με την μη-στρογγυλή έξοδο να είναι πιθανότατα η αλλαγή.
- **Wallet Fingerprinting:** Διάφορα wallets έχουν μοναδικά πρότυπα δημιουργίας συναλλαγών, επιτρέποντας σε αναλυτές να αναγνωρίσουν το λογισμικό που χρησιμοποιήθηκε και ενδεχομένως τη change address.
- **Amount & Timing Correlations:** Η αποκάλυψη χρόνων ή ποσών συναλλαγών μπορεί να κάνει τις συναλλαγές ιχνηλάσιμες.

## **Traffic Analysis**

Παρακολουθώντας την δικτυακή κίνηση, οι επιτιθέμενοι μπορούν ενδεχομένως να συνδέσουν συναλλαγές ή blocks με IP διευθύνσεις, διακυβεύοντας την ιδιωτικότητα των χρηστών. Αυτό ισχύει ιδιαίτερα εάν ένας φορέας χειρίζεται πολλούς Bitcoin nodes, ενισχύοντας την ικανότητά του να παρακολουθεί συναλλαγές.

## More

For a comprehensive list of privacy attacks and defenses, visit [Bitcoin Privacy on Bitcoin Wiki](https://en.bitcoin.it/wiki/Privacy).

# Anonymous Bitcoin Transactions

## Ways to Get Bitcoins Anonymously

- **Cash Transactions**: Απόκτηση bitcoin με μετρητά.
- **Cash Alternatives**: Αγορά gift cards και ανταλλαγή τους online για bitcoin.
- **Mining**: Ο πιο ιδιωτικός τρόπος απόκτησης bitcoins είναι μέσω mining, ειδικά όταν γίνεται solo, καθώς τα mining pools μπορεί να γνωρίζουν την IP του miner. [Mining Pools Information](https://en.bitcoin.it/wiki/Pooled_mining)
- **Theft**: Θεωρητικά, η κλοπή bitcoin θα μπορούσε να είναι ένας άλλος τρόπος απόκτησής τους ανώνυμα, αν και είναι παράνομο και μη συνιστώμενο.

## Mixing Services

Χρησιμοποιώντας μια mixing service, ένας χρήστης μπορεί να στείλει bitcoins και να λάβει διαφορετικά bitcoins ως αντάλλαγμα, καθιστώντας δύσκολη την ανίχνευση του αρχικού ιδιοκτήτη. Ωστόσο, αυτό απαιτεί εμπιστοσύνη στην υπηρεσία ότι δεν κρατάει logs και ότι θα επιστρέψει πραγματικά τα bitcoins. Εναλλακτικές επιλογές mixing περιλαμβάνουν Bitcoin casinos.

## CoinJoin

Το CoinJoin συγχωνεύει πολλαπλές συναλλαγές από διαφορετικούς χρήστες σε μία, περιπλέκοντας τη διαδικασία για όποιον προσπαθεί να ταιριάξει inputs με outputs. Παρότι είναι αποτελεσματικό, οι συναλλαγές με μοναδικά μεγέθη εισόδων και εξόδων μπορούν ακόμα να ιχνηλατηθούν.

Παραδείγματα συναλλαγών που ενδέχεται να έχουν χρησιμοποιήσει CoinJoin περιλαμβάνουν `402d3e1df685d1fdf82f36b220079c1bf44db227df2d676625ebcbee3f6cb22a` και `85378815f6ee170aa8c26694ee2df42b99cff7fa9357f073c1192fff1f540238`.

For more information, visit [CoinJoin](https://coinjoin.io/en). For a similar service on Ethereum, check out [Tornado Cash](https://tornado.cash), which anonymizes transactions with funds from miners.

## PayJoin

Μια παραλλαγή του CoinJoin, το PayJoin (ή P2EP), συγκαλύπτει τη συναλλαγή μεταξύ δύο μερών (π.χ. πελάτη και εμπόρου) ως κανονική συναλλαγή, χωρίς τα χαρακτηριστικά ίσων εξόδων που συνηθίζονται στο CoinJoin. Αυτό το καθιστά εξαιρετικά δύσκολο στην ανίχνευση και μπορεί να αναιρεί την common-input-ownership heuristic που χρησιμοποιούν οι οντότητες παρακολούθησης συναλλαγών.
```plaintext
2 btc --> 3 btc
5 btc     4 btc
```
Συναλλαγές όπως η παραπάνω μπορεί να είναι PayJoin, βελτιώνοντας την ιδιωτικότητα ενώ παραμένουν αδιακρίτως από τις τυπικές bitcoin συναλλαγές.

**Η χρήση του PayJoin μπορεί να αναταράξει σημαντικά τις παραδοσιακές μεθόδους παρακολούθησης**, καθιστώντας το μια πολλά υποσχόμενη εξέλιξη στην αναζήτηση της ιδιωτικότητας στις συναλλαγές.

# Καλές Πρακτικές για Ιδιωτικότητα στα Κρυπτονομίσματα

## **Τεχνικές Συγχρονισμού Πορτοφολιών**

Για τη διατήρηση της ιδιωτικότητας και της ασφάλειας, ο συγχρονισμός των πορτοφολιών με το blockchain είναι κρίσιμος. Δύο μέθοδοι ξεχωρίζουν:

- **Full node**: Με το κατέβασμα ολόκληρου του blockchain, ένας full node εξασφαλίζει μέγιστη ιδιωτικότητα. Όλες οι συναλλαγές που έγιναν αποθηκεύονται τοπικά, καθιστώντας αδύνατο για τους αντιπάλους να εντοπίσουν ποιες συναλλαγές ή διευθύνσεις ενδιαφέρουν τον χρήστη.
- **Client-side block filtering**: Αυτή η μέθοδος περιλαμβάνει τη δημιουργία φίλτρων για κάθε block στο blockchain, επιτρέποντας στα πορτοφόλια να εντοπίζουν σχετικές συναλλαγές χωρίς να αποκαλύπτουν συγκεκριμένα ενδιαφέροντα στους παρατηρητές του δικτύου. Τα ελαφριά πορτοφόλια (lightweight wallets) κατεβάζουν αυτά τα φίλτρα, ανακτώντας πλήρη blocks μόνο όταν βρεθεί αντιστοιχία με τις διευθύνσεις του χρήστη.

## **Χρήση του Tor για Ανωνυμία**

Δεδομένου ότι το Bitcoin λειτουργεί σε ένα peer-to-peer δίκτυο, η χρήση του Tor συνιστάται για να κρύβετε τη διεύθυνση IP σας, ενισχύοντας την ιδιωτικότητα κατά την αλληλεπίδραση με το δίκτυο.

## **Αποφυγή Επαναχρησιμοποίησης Διευθύνσεων**

Για την προστασία της ιδιωτικότητας, είναι ζωτικής σημασίας να χρησιμοποιείτε μια νέα διεύθυνση για κάθε συναλλαγή. Η επαναχρησιμοποίηση διευθύνσεων μπορεί να υπονομεύσει την ιδιωτικότητα συνδέοντας συναλλαγές με τον ίδιο φορέα. Τα σύγχρονα πορτοφόλια αποθαρρύνουν την επαναχρησιμοποίηση διευθύνσεων μέσω του σχεδιασμού τους.

## **Στρατηγικές για την Ιδιωτικότητα Συναλλαγών**

- **Multiple transactions**: Η διάσπαση μιας πληρωμής σε πολλές συναλλαγές μπορεί να συγκαλύψει το ποσό της συναλλαγής, αποτρέποντας επιθέσεις κατά της ιδιωτικότητας.
- **Change avoidance**: Η επιλογή συναλλαγών που δεν απαιτούν change outputs αυξάνει την ιδιωτικότητα διαταράσσοντας μεθόδους ανίχνευσης change.
- **Multiple change outputs**: Αν η αποφυγή change δεν είναι εφικτή, η δημιουργία πολλαπλών change outputs μπορεί παρ' όλα αυτά να βελτιώσει την ιδιωτικότητα.

# **Monero: Φάρος της Ανωνυμίας**

Το Monero αντιμετωπίζει την ανάγκη για απόλυτη ανωνυμία στις ψηφιακές συναλλαγές, θέτοντας υψηλό πρότυπο για την ιδιωτικότητα.

# **Ethereum: Gas και Συναλλαγές**

## **Κατανόηση του Gas**

Το gas μετρά την υπολογιστική προσπάθεια που απαιτείται για την εκτέλεση λειτουργιών στο Ethereum, τιμολογείται σε **gwei**. Για παράδειγμα, μια συναλλαγή που κοστίζει 2,310,000 gwei (ή 0.00231 ETH) περιλαμβάνει ένα gas limit και ένα base fee, με ένα tip για να δώσει κίνητρο στους miners. Οι χρήστες μπορούν να ορίσουν ένα max fee για να διασφαλίσουν ότι δεν θα πληρώσουν παραπάνω, με το πλεόνασμα να επιστρέφεται.

## **Εκτέλεση Συναλλαγών**

Οι συναλλαγές στο Ethereum περιλαμβάνουν έναν αποστολέα και έναν παραλήπτη, οι οποίοι μπορεί να είναι είτε διευθύνσεις χρηστών είτε smart contract. Απαιτούν μια αμοιβή και πρέπει να γίνουν mined. Βασικές πληροφορίες σε μια συναλλαγή περιλαμβάνουν τον παραλήπτη, την υπογραφή του αποστολέα, την αξία (value), προαιρετικά δεδομένα, το gas limit, και τις fees. Σημειωτέον ότι η διεύθυνση του αποστολέα εξαχθεί από την υπογραφή, εξαλείφοντας την ανάγκη να συμπεριληφθεί στα δεδομένα της συναλλαγής.

Αυτές οι πρακτικές και μηχανισμοί αποτελούν θεμέλιο για οποιονδήποτε επιθυμεί να ασχοληθεί με τα κρυπτονομίσματα δίνοντας προτεραιότητα στην ιδιωτικότητα και την ασφάλεια.

## Value-Centric Web3 Red Teaming

- Inventory value-bearing components (signers, oracles, bridges, automation) για να κατανοήσετε ποιος μπορεί να μετακινήσει κεφάλαια και πώς.
- Χαρτογραφήστε κάθε component στις σχετικές τακτικές MITRE AADAPT για να αποκαλύψετε μονοπάτια privilege escalation.
- Επαναλάβετε αλυσίδες επιθέσεων flash-loan/oracle/credential/cross-chain για να επιβεβαιώσετε τον αντίκτυπο και να τεκμηριώσετε τις εκμεταλλεύσιμες προϋποθέσεις.

{{#ref}}
value-centric-web3-red-teaming.md
{{#endref}}

## Smart Contract Security

- Mutation testing για να βρείτε τυφλά σημεία στις test suites:

{{#ref}}
../smart-contract-security/mutation-testing-with-slither.md
{{#endref}}

## Αναφορές

- [https://en.wikipedia.org/wiki/Proof_of_stake](https://en.wikipedia.org/wiki/Proof_of_stake)
- [https://www.mycryptopedia.com/public-key-private-key-explained/](https://www.mycryptopedia.com/public-key-private-key-explained/)
- [https://bitcoin.stackexchange.com/questions/3718/what-are-multi-signature-transactions](https://bitcoin.stackexchange.com/questions/3718/what-are-multi-signature-transactions)
- [https://ethereum.org/en/developers/docs/transactions/](https://ethereum.org/en/developers/docs/transactions/)
- [https://ethereum.org/en/developers/docs/gas/](https://ethereum.org/en/developers/docs/gas/)
- [https://en.bitcoin.it/wiki/Privacy](https://en.bitcoin.it/wiki/Privacy#Forced_address_reuse)

## DeFi/AMM Exploitation

Εάν ερευνάτε πρακτικές εκμεταλλεύσεις DEXes και AMMs (Uniswap v4 hooks, rounding/precision abuse, flash‑loan amplified threshold‑crossing swaps), δείτε:

{{#ref}}
defi-amm-hook-precision.md
{{#endref}}

Για pools με πολλαπλά assets που χρησιμοποιούν cached virtual balances και μπορούν να δηλητηριαστούν όταν `supply == 0`, μελετήστε:

{{#ref}}
defi-amm-virtual-balance-cache-exploitation.md
{{#endref}}

{{#include ../../banners/hacktricks-training.md}}
