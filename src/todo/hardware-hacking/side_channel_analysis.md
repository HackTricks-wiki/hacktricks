# Ανάλυση Επιθέσεων Παράπλευρης Διάχυσης

{{#include ../../banners/hacktricks-training.md}}

Οι επιθέσεις παράπλευρης διάχυσης ανακτούν μυστικά παρατηρώντας φυσική ή μικρο-αρχιτεκτονική "διαρροή" που είναι *συσχετισμένη* με την εσωτερική κατάσταση αλλά *δεν είναι* μέρος της λογικής διεπαφής της συσκευής. Παραδείγματα κυμαίνονται από τη μέτρηση της στιγμιαίας κατανάλωσης ρεύματος που αντλεί μια έξυπνη κάρτα μέχρι την κατάχρηση των επιδράσεων διαχείρισης ενέργειας CPU μέσω ενός δικτύου.

---

## Κύριες Διαρροές

| Κανάλι | Τυπικός Στόχος | Οργάνωση |
|---------|---------------|-----------------|
| Κατανάλωση ενέργειας | Έξυπνες κάρτες, MCU IoT, FPGA | Οσυλλοσκόπιο + αντιστάτης shunt/HS probe (π.χ. CW503) |
| Ηλεκτρομαγνητικό πεδίο (EM) | CPUs, RFID, επιταχυντές AES | Probe H-field + LNA, ChipWhisperer/RTL-SDR |
| Χρόνος εκτέλεσης / cache | Desktop & cloud CPUs | Χρονομετρητές υψηλής ακρίβειας (rdtsc/rdtscp), απομακρυσμένος χρόνος πτήσης |
| Ακουστικός / μηχανικός | Πληκτρολόγια, 3-D εκτυπωτές, ρελέ | Μικρόφωνο MEMS, λέιζερ vibrometer |
| Οπτικός & θερμικός | LEDs, εκτυπωτές λέιζερ, DRAM | Φωτοδιόδος / κάμερα υψηλής ταχύτητας, κάμερα IR |
| Διαρροές που προκαλούνται από σφάλματα | ASIC/MCU κρυπτογραφίες | Σφάλμα ρολογιού/τάσης, EMFI, έγχυση λέιζερ |

---

## Ανάλυση Ικανότητας

### Απλή Ανάλυση Ικανότητας (SPA)
Παρατηρήστε μια *μοναδική* διαδρομή και συσχετίστε άμεσα τις κορυφές/κοιλάδες με τις λειτουργίες (π.χ. S-boxes DES).
```python
# ChipWhisperer-husky example – capture one AES trace
from chipwhisperer.capture.api.programmers import STMLink
from chipwhisperer.capture import CWSession
cw = CWSession(project='aes')
trig = cw.scope.trig
cw.connect(cw.capture.scopes[0])
cw.capture.init()
trace = cw.capture.capture_trace()
print(trace.wave)  # numpy array of power samples
```
### Differential/Correlation Power Analysis (DPA/CPA)
Αποκτήστε *N > 1 000* ίχνη, υποθέστε το byte κλειδιού `k`, υπολογίστε το μοντέλο HW/HD και συσχετίστε με τη διαρροή.
```python
import numpy as np
corr = np.corrcoef(leakage_model(k), traces[:,sample])
```
CPA παραμένει κορυφαία τεχνολογία, αλλά οι παραλλαγές μηχανικής μάθησης (MLA, deep-learning SCA) κυριαρχούν πλέον σε διαγωνισμούς όπως το ASCAD-v2 (2023).

---

## Ηλεκτρομαγνητική Ανάλυση (EMA)
Οι κοντινές EM ανιχνευτές (500 MHz–3 GHz) διαρρέουν ταυτόσημες πληροφορίες με την ανάλυση ισχύος *χωρίς* να εισάγουν shunts. Η έρευνα του 2024 απέδειξε την ανάκτηση κλειδιών σε **>10 cm** από ένα STM32 χρησιμοποιώντας συσχέτιση φάσματος και χαμηλού κόστους RTL-SDR front-ends.

---

## Χρονιστικές & Μικροαρχιτεκτονικές Επιθέσεις
Οι σύγχρονοι επεξεργαστές διαρρέουν μυστικά μέσω κοινών πόρων:
* **Hertzbleed (2022)** – Η κλιμάκωση συχνότητας DVFS συσχετίζεται με το βάρος Hamming, επιτρέποντας την *απομακρυσμένη* εξαγωγή κλειδιών EdDSA.
* **Downfall / Gather Data Sampling (Intel, 2023)** – εκτέλεση μεταβατικών για ανάγνωση δεδομένων AVX-gather μέσω SMT threads.
* **Zenbleed (AMD, 2023) & Inception (AMD, 2023)** – η υποθετική λανθασμένη πρόβλεψη διαρρέει καταχωρητές διατομής.

Για μια ευρεία αντιμετώπιση θεμάτων κλάσης Spectre δείτε {{#ref}}
../../cpu-microarchitecture/microarchitectural-attacks.md
{{#endref}}

---

## Ακουστικές & Οπτικές Επιθέσεις
* Το 2024 "​iLeakKeys" έδειξε 95 % ακρίβεια στην ανάκτηση πληκτρολογήσεων φορητού υπολογιστή από ένα **μικρόφωνο smartphone μέσω Zoom** χρησιμοποιώντας έναν ταξινομητή CNN.
* Οι ταχύτατοι φωτοδιόδοι καταγράφουν τη δραστηριότητα LED DDR4 και ανακατασκευάζουν τα κλειδιά γύρου AES σε λιγότερο από 1 λεπτό (BlackHat 2023).

---

## Έγχυση Σφαλμάτων & Διαφορική Ανάλυση Σφαλμάτων (DFA)
Ο συνδυασμός σφαλμάτων με διαρροή πλευρικού καναλιού επιταχύνει την αναζήτηση κλειδιών (π.χ. 1-trace AES DFA). Πρόσφατα εργαλεία σε τιμές χομπίστα:
* **ChipSHOUTER & PicoEMP** – σφάλματα ηλεκτρομαγνητικού παλμού κάτω από 1 ns.
* **GlitchKit-R5 (2025)** – πλατφόρμα σφαλμάτων ρολογιού/τάσης ανοιχτού κώδικα που υποστηρίζει RISC-V SoCs.

---

## Τυπική Ροή Επίθεσης
1. Εντοπίστε το κανάλι διαρροής & το σημείο στήριξης (VCC pin, decoupling cap, κοντινός χώρος).
2. Εισάγετε τον πυροδότη (GPIO ή βασισμένο σε μοτίβο).
3. Συλλέξτε >1 k ίχνη με κατάλληλη δειγματοληψία/φίλτρα.
4. Προεπεξεργασία (ευθυγράμμιση, αφαίρεση μέσου, LP/HP φίλτρο, wavelet, PCA).
5. Στατιστική ή ML ανάκτηση κλειδιών (CPA, MIA, DL-SCA).
6. Επικυρώστε και επαναλάβετε για τις εξαιρέσεις.

---

## Άμυνες & Σκληρύνσεις
* **Constant-time** υλοποιήσεις & μνημονιακά σκληρά αλγόριθμοι.
* **Masking/shuffling** – διαχωρίστε τα μυστικά σε τυχαία μερίδια; η αντίσταση πρώτης τάξης πιστοποιείται από TVLA.
* **Hiding** – ρυθμιστές τάσης on-chip, τυχαίο ρολόι, λογική διπλής ράγας, EM shields.
* **Ανίχνευση σφαλμάτων** – πλεονάζουσα υπολογιστική, υπογραφές κατωφλίου.
* **Λειτουργικές** – απενεργοποιήστε το DVFS/turbo σε κρυπτογραφικούς πυρήνες, απομονώστε SMT, απαγορεύστε τη συν-τοποθέτηση σε πολυ-ενοικιαζόμενα νέφη.

---

## Εργαλεία & Πλαίσια
* **ChipWhisperer-Husky** (2024) – 500 MS/s scope + Cortex-M trigger; Python API όπως παραπάνω.
* **Riscure Inspector & FI** – εμπορικό, υποστηρίζει αυτοματοποιημένη αξιολόγηση διαρροής (TVLA-2.0).
* **scaaml** – βιβλιοθήκη SCA βάσει TensorFlow (v1.2 – 2025).
* **pyecsca** – ανοιχτού κώδικα πλαίσιο ECC SCA της ANSSI.

---

## Αναφορές

* [ChipWhisperer Documentation](https://chipwhisperer.readthedocs.io/en/latest/)
* [Hertzbleed Attack Paper](https://www.hertzbleed.com/)


{{#include ../../banners/hacktricks-training.md}}
