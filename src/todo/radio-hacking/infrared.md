# Υπέρυθρη

{{#include ../../banners/hacktricks-training.md}}

## Πώς λειτουργεί η Υπέρυθρη <a href="#how-the-infrared-port-works" id="how-the-infrared-port-works"></a>

**Το υπέρυθρο φως είναι αόρατο στους ανθρώπους**. Το μήκος κύματος IR κυμαίνεται από **0.7 έως 1000 μικρόμετρα**. Οι τηλεχειριστήρες χρησιμοποιούν ένα σήμα IR για τη μετάδοση δεδομένων και λειτουργούν στο εύρος μήκους κύματος 0.75..1.4 μικρόμετρα. Ένας μικροελεγκτής στον τηλεχειριστήριο κάνει μια υπέρυθρη LED να αναβοσβήνει με μια συγκεκριμένη συχνότητα, μετατρέποντας το ψηφιακό σήμα σε σήμα IR.

Για να ληφθούν τα σήματα IR χρησιμοποιείται ένας **φωτοδέκτης**. Αυτός **μετατρέπει το υπέρυθρο φως σε παλμούς τάσης**, οι οποίοι είναι ήδη **ψηφιακά σήματα**. Συνήθως, υπάρχει ένα **φίλτρο σκοτεινού φωτός μέσα στον δέκτη**, το οποίο επιτρέπει **μόνο το επιθυμητό μήκος κύματος** και κόβει τον θόρυβο.

### Ποικιλία Πρωτοκόλλων IR <a href="#variety-of-ir-protocols" id="variety-of-ir-protocols"></a>

Τα πρωτόκολλα IR διαφέρουν σε 3 παράγοντες:

- κωδικοποίηση bit
- δομή δεδομένων
- συχνότητα φορέα — συχνά στο εύρος 36..38 kHz

#### Τρόποι κωδικοποίησης bit <a href="#bit-encoding-ways" id="bit-encoding-ways"></a>

**1. Κωδικοποίηση Απόστασης Παλμού**

Τα bits κωδικοποιούνται με την τροποποίηση της διάρκειας του διαστήματος μεταξύ των παλμών. Το πλάτος του παλμού είναι σταθερό.

<figure><img src="../../images/image (295).png" alt=""><figcaption></figcaption></figure>

**2. Κωδικοποίηση Πλάτους Παλμού**

Τα bits κωδικοποιούνται με την τροποποίηση του πλάτους του παλμού. Το πλάτος του διαστήματος μετά την έκρηξη του παλμού είναι σταθερό.

<figure><img src="../../images/image (282).png" alt=""><figcaption></figcaption></figure>

**3. Κωδικοποίηση Φάσης**

Είναι επίσης γνωστή ως κωδικοποίηση Manchester. Η λογική τιμή καθορίζεται από την πολικότητα της μετάβασης μεταξύ της έκρηξης του παλμού και του διαστήματος. "Διάστημα προς έκρηξη παλμού" δηλώνει λογική "0", "έκρηξη παλμού προς διάστημα" δηλώνει λογική "1".

<figure><img src="../../images/image (634).png" alt=""><figcaption></figcaption></figure>

**4. Συνδυασμός των προηγούμενων και άλλων εξωτικών**

> [!NOTE]
> Υπάρχουν πρωτόκολλα IR που **προσπαθούν να γίνουν καθολικά** για αρκετούς τύπους συσκευών. Τα πιο διάσημα είναι τα RC5 και NEC. Δυστυχώς, το πιο διάσημο **δεν σημαίνει το πιο κοινό**. Στο περιβάλλον μου, συνάντησα μόνο δύο τηλεχειριστήρια NEC και κανένα RC5.
>
> Οι κατασκευαστές αγαπούν να χρησιμοποιούν τα δικά τους μοναδικά πρωτόκολλα IR, ακόμη και εντός της ίδιας κατηγορίας συσκευών (για παράδειγμα, τηλεοπτικά κουτιά). Επομένως, τα τηλεχειριστήρια από διαφορετικές εταιρείες και μερικές φορές από διαφορετικά μοντέλα της ίδιας εταιρείας, δεν μπορούν να λειτουργήσουν με άλλες συσκευές του ίδιου τύπου.

### Εξερεύνηση ενός σήματος IR

Ο πιο αξιόπιστος τρόπος για να δείτε πώς φαίνεται το σήμα IR του τηλεχειριστηρίου είναι να χρησιμοποιήσετε ένα παλμογράφο. Δεν αποδιαμορφώνει ή αναστρέφει το ληφθέν σήμα, απλώς εμφανίζεται "όπως είναι". Αυτό είναι χρήσιμο για δοκιμές και αποσφαλμάτωση. Θα δείξω το αναμενόμενο σήμα με το παράδειγμα του πρωτοκόλλου IR NEC.

<figure><img src="../../images/image (235).png" alt=""><figcaption></figcaption></figure>

Συνήθως, υπάρχει μια προοίμια στην αρχή ενός κωδικοποιημένου πακέτου. Αυτό επιτρέπει στον δέκτη να προσδιορίσει το επίπεδο ενίσχυσης και το υπόβαθρο. Υπάρχουν επίσης πρωτόκολλα χωρίς προοίμια, για παράδειγμα, Sharp.

Στη συνέχεια, μεταδίδονται τα δεδομένα. Η δομή, η προοίμια και η μέθοδος κωδικοποίησης bit καθορίζονται από το συγκεκριμένο πρωτόκολλο.

Το **πρωτόκολλο IR NEC** περιέχει μια σύντομη εντολή και έναν κωδικό επανάληψης, ο οποίος αποστέλλεται ενώ πατάτε το κουμπί. Και η εντολή και ο κωδικός επανάληψης έχουν την ίδια προοίμια στην αρχή.

Η **εντολή NEC**, εκτός από την προοίμια, αποτελείται από ένα byte διεύθυνσης και ένα byte αριθμού εντολής, με το οποίο η συσκευή καταλαβαίνει τι πρέπει να εκτελέσει. Τα byte διεύθυνσης και αριθμού εντολής επαναλαμβάνονται με αντίστροφες τιμές, για να ελέγξουν την ακεραιότητα της μετάδοσης. Υπάρχει ένα επιπλέον bit σταματήματος στο τέλος της εντολής.

Ο **κωδικός επανάληψης** έχει ένα "1" μετά την προοίμια, το οποίο είναι ένα bit σταματήματος.

Για **λογική "0" και "1"** το NEC χρησιμοποιεί Κωδικοποίηση Απόστασης Παλμού: πρώτα, μεταδίδεται μια έκρηξη παλμού μετά την οποία υπάρχει μια παύση, το μήκος της οποίας καθορίζει την τιμή του bit.

### Κλιματιστικά

Σε αντίθεση με άλλους τηλεχειριστήρες, **τα κλιματιστικά δεν μεταδίδουν μόνο τον κωδικό του πατημένου κουμπιού**. Μεταδίδουν επίσης **όλες τις πληροφορίες** όταν πατηθεί ένα κουμπί για να διασφαλίσουν ότι η **μηχανή κλιματισμού και το τηλεχειριστήριο είναι συγχρονισμένα**.\
Αυτό θα αποτρέψει το να ρυθμιστεί μια μηχανή στους 20ºC και να αυξηθεί στους 21ºC με ένα τηλεχειριστήριο, και στη συνέχεια όταν χρησιμοποιηθεί ένα άλλο τηλεχειριστήριο, το οποίο έχει ακόμα τη θερμοκρασία στους 20ºC, να αυξηθεί περισσότερο η θερμοκρασία, θα "αυξηθεί" στους 21ºC (και όχι στους 22ºC νομίζοντας ότι είναι στους 21ºC).

### Επιθέσεις

Μπορείτε να επιτεθείτε στην Υπέρυθρη με το Flipper Zero:

{{#ref}}
flipper-zero/fz-infrared.md
{{#endref}}

## Αναφορές

- [https://blog.flipperzero.one/infrared/](https://blog.flipperzero.one/infrared/)

{{#include ../../banners/hacktricks-training.md}}
