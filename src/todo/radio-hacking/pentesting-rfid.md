# Pentesting RFID

{{#include ../../banners/hacktricks-training.md}}

## Introduction

**रेडियो फ़्रीक्वेंसी पहचान (RFID)** सबसे लोकप्रिय शॉर्ट-रेंज रेडियो समाधान है। इसका उपयोग आमतौर पर किसी इकाई की पहचान करने वाली जानकारी को स्टोर और ट्रांसमिट करने के लिए किया जाता है।

एक RFID टैग **अपनी खुद की पावर स्रोत (सक्रिय)** पर निर्भर कर सकता है, जैसे कि एक एम्बेडेड बैटरी, या प्राप्त रेडियो तरंगों से **उत्पन्न वर्तमान** से अपनी शक्ति प्राप्त कर सकता है (**निष्क्रिय**).

### Classes

EPCglobal RFID टैग को छह श्रेणियों में विभाजित करता है। प्रत्येक श्रेणी में एक टैग में पिछले श्रेणी में सूचीबद्ध सभी क्षमताएँ होती हैं, जिससे यह पीछे की ओर संगत होता है।

- **क्लास 0** टैग **निष्क्रिय** टैग होते हैं जो **UHF** बैंड में काम करते हैं। विक्रेता इन्हें उत्पादन फैक्ट्री में **पूर्व-प्रोग्राम** करता है। परिणामस्वरूप, आप **उनकी मेमोरी में स्टोर की गई जानकारी को बदल नहीं सकते**।
- **क्लास 1** टैग भी **HF** बैंड में काम कर सकते हैं। इसके अलावा, इन्हें उत्पादन के बाद **केवल एक बार लिखा जा सकता है**। कई क्लास 1 टैग भी प्राप्त आदेशों के **साइक्लिक रेडंडेंसी चेक** (CRCs) को प्रोसेस कर सकते हैं। CRCs आदेशों के अंत में त्रुटि पहचान के लिए कुछ अतिरिक्त बाइट्स होते हैं।
- **क्लास 2** टैग को **कई बार लिखा जा सकता है**।
- **क्लास 3** टैग में **एम्बेडेड सेंसर** हो सकते हैं जो पर्यावरणीय मापदंडों को रिकॉर्ड कर सकते हैं, जैसे वर्तमान तापमान या टैग की गति। ये टैग **सेमी-पैसिव** होते हैं, क्योंकि हालांकि इनमें एक एम्बेडेड पावर स्रोत होता है, जैसे एक एकीकृत **बैटरी**, वे अन्य टैग या रीडर्स के साथ वायरलेस **संवाद** **शुरू नहीं कर सकते**।
- **क्लास 4** टैग समान श्रेणी के अन्य टैग के साथ संवाद शुरू कर सकते हैं, जिससे वे **सक्रिय टैग** बन जाते हैं।
- **क्लास 5** टैग अन्य टैग को **शक्ति प्रदान कर सकते हैं और सभी पिछले टैग** श्रेणियों के साथ संवाद कर सकते हैं। क्लास 5 टैग **RFID रीडर्स** के रूप में कार्य कर सकते हैं।

### Information Stored in RFID Tags

एक RFID टैग की मेमोरी आमतौर पर चार प्रकार के डेटा को स्टोर करती है: **पहचान डेटा**, जो उस **इकाई** की पहचान करता है जिससे टैग जुड़ा होता है (इस डेटा में उपयोगकर्ता-परिभाषित फ़ील्ड शामिल होते हैं, जैसे बैंक खाते); **पूरक डेटा**, जो इकाई के बारे में **अधिक** **विवरण** प्रदान करता है; **नियंत्रण डेटा**, जो टैग की आंतरिक **कॉन्फ़िगरेशन** के लिए उपयोग किया जाता है; और टैग का **निर्माता डेटा**, जिसमें टैग का यूनिक आइडेंटिफायर (**UID**) और टैग के **उत्पादन**, **प्रकार**, और **विक्रेता** के बारे में विवरण होता है। आप पहले दो प्रकार के डेटा सभी व्यावसायिक टैग में पाएंगे; अंतिम दो टैग के विक्रेता के आधार पर भिन्न हो सकते हैं।

ISO मानक एप्लिकेशन फैमिली आइडेंटिफायर (**AFI**) मान को निर्दिष्ट करता है, जो एक कोड है जो टैग जिस **वस्तु** से संबंधित है उसे इंगित करता है। एक अन्य महत्वपूर्ण रजिस्टर, जिसे ISO द्वारा भी निर्दिष्ट किया गया है, डेटा स्टोरेज फॉर्मेट आइडेंटिफायर (**DSFID**) है, जो **उपयोगकर्ता डेटा** के तार्किक संगठन को परिभाषित करता है।

अधिकांश RFID **सुरक्षा नियंत्रण** में ऐसे तंत्र होते हैं जो प्रत्येक उपयोगकर्ता मेमोरी ब्लॉक और AFI और DSFID मानों को समाहित करने वाले विशेष रजिस्टरों पर **पढ़ने** या **लिखने** के संचालन को **सीमित** करते हैं। ये **लॉक** **तंत्र** नियंत्रण मेमोरी में स्टोर किए गए डेटा का उपयोग करते हैं और विक्रेता द्वारा पूर्व-निर्धारित **डिफ़ॉल्ट पासवर्ड** होते हैं लेकिन टैग मालिकों को **कस्टम पासवर्ड** कॉन्फ़िगर करने की अनुमति देते हैं।

### Low & High frequency tags comparison

<figure><img src="../../images/image (983).png" alt=""><figcaption></figcaption></figure>

## Low-Frequency RFID Tags (125kHz)

**लो-फ्रीक्वेंसी टैग** अक्सर उन सिस्टम में उपयोग किए जाते हैं जो **उच्च सुरक्षा की आवश्यकता नहीं होती**: भवन की पहुंच, इंटरकॉम कुंजी, जिम सदस्यता कार्ड, आदि। उनकी उच्च रेंज के कारण, इन्हें भुगतान किए गए कार पार्किंग के लिए उपयोग करना सुविधाजनक होता है: चालक को कार्ड को रीडर के करीब लाने की आवश्यकता नहीं होती, क्योंकि इसे दूर से सक्रिय किया जाता है। साथ ही, लो-फ्रीक्वेंसी टैग बहुत प्राइमिटिव होते हैं, इनकी डेटा ट्रांसफर दर कम होती है। इस कारण, जैसे कि बैलेंस बनाए रखना और क्रिप्टोग्राफी के लिए जटिल दो-तरफा डेटा ट्रांसफर लागू करना असंभव है। लो-फ्रीक्वेंसी टैग केवल अपनी छोटी ID को बिना किसी प्रमाणीकरण के ट्रांसमिट करते हैं।

ये उपकरण **निष्क्रिय** **RFID** तकनीक पर निर्भर करते हैं और **30 kHz से 300 kHz** की रेंज में काम करते हैं, हालांकि 125 kHz से 134 kHz का उपयोग करना अधिक सामान्य है:

- **लॉन्ग रेंज** — कम फ़्रीक्वेंसी का मतलब उच्च रेंज है। कुछ EM-Marin और HID रीडर्स हैं, जो एक मीटर की दूरी से काम करते हैं। इनका अक्सर कार पार्किंग में उपयोग किया जाता है।
- **प्राइमिटिव प्रोटोकॉल** — कम डेटा ट्रांसफर दर के कारण ये टैग केवल अपनी छोटी ID को ट्रांसमिट कर सकते हैं। अधिकांश मामलों में, डेटा को प्रमाणीकरण नहीं किया जाता है और इसे किसी भी तरह से सुरक्षित नहीं किया जाता है। जैसे ही कार्ड रीडर की रेंज में आता है, यह बस अपनी ID ट्रांसमिट करना शुरू कर देता है।
- **कम सुरक्षा** — इन कार्डों को आसानी से कॉपी किया जा सकता है, या यहां तक कि किसी और की जेब से पढ़ा जा सकता है, क्योंकि प्रोटोकॉल प्राइमिटिव है।

**लोकप्रिय 125 kHz प्रोटोकॉल:**

- **EM-Marin** — EM4100, EM4102। CIS में सबसे लोकप्रिय प्रोटोकॉल। इसकी सरलता और स्थिरता के कारण लगभग एक मीटर से पढ़ा जा सकता है।
- **HID Prox II** — HID Global द्वारा पेश किया गया लो-फ्रीक्वेंसी प्रोटोकॉल। यह प्रोटोकॉल पश्चिमी देशों में अधिक लोकप्रिय है। यह अधिक जटिल है और इस प्रोटोकॉल के लिए कार्ड और रीडर्स अपेक्षाकृत महंगे हैं।
- **Indala** — बहुत पुराना लो-फ्रीक्वेंसी प्रोटोकॉल जो Motorola द्वारा पेश किया गया था, और बाद में HID द्वारा अधिग्रहित किया गया। आप इसे पिछले दो की तुलना में कम ही पाएंगे क्योंकि इसका उपयोग कम हो रहा है।

वास्तव में, और भी बहुत सारे लो-फ्रीक्वेंसी प्रोटोकॉल हैं। लेकिन वे सभी भौतिक स्तर पर समान मॉड्यूलेशन का उपयोग करते हैं और इन्हें एक तरह से या किसी अन्य तरीके से ऊपर सूचीबद्ध प्रोटोकॉल का एक रूप माना जा सकता है।

### Attack

You can **attack these Tags with the Flipper Zero**:

{{#ref}}
flipper-zero/fz-125khz-rfid.md
{{#endref}}

## High-Frequency RFID Tags (13.56 MHz)

**हाई-फ्रीक्वेंसी टैग** का उपयोग तब किया जाता है जब आपको क्रिप्टोग्राफी, बड़े दो-तरफा डेटा ट्रांसफर, प्रमाणीकरण आदि की आवश्यकता होती है।\
यह आमतौर पर बैंक कार्ड, सार्वजनिक परिवहन, और अन्य सुरक्षित पास में पाया जाता है।

**हाई-फ्रीक्वेंसी 13.56 MHz टैग मानकों और प्रोटोकॉल का एक सेट हैं**। इन्हें आमतौर पर [NFC](https://nfc-forum.org/what-is-nfc/about-the-technology/) के रूप में संदर्भित किया जाता है, लेकिन यह हमेशा सही नहीं होता। भौतिक और तार्किक स्तर पर उपयोग किए जाने वाले मूल प्रोटोकॉल सेट ISO 14443 है। उच्च-स्तरीय प्रोटोकॉल, साथ ही वैकल्पिक मानक (जैसे ISO 19092), इसके आधार पर हैं। कई लोग इस तकनीक को **नियर फील्ड कम्युनिकेशन (NFC)** के रूप में संदर्भित करते हैं, जो 13.56 MHz फ़्रीक्वेंसी पर काम करने वाले उपकरणों के लिए एक शब्द है।

<figure><img src="../../images/image (930).png" alt=""><figcaption></figcaption></figure>

साधारण शब्दों में, NFC की आर्किटेक्चर इस तरह काम करती है: ट्रांसमिशन प्रोटोकॉल उस कंपनी द्वारा चुना जाता है जो कार्ड बनाती है और इसे निम्न-स्तरीय ISO 14443 के आधार पर लागू किया जाता है। उदाहरण के लिए, NXP ने एक उच्च-स्तरीय ट्रांसमिशन प्रोटोकॉल का आविष्कार किया जिसे Mifare कहा जाता है। लेकिन निम्न स्तर पर, Mifare कार्ड ISO 14443-A मानक पर आधारित होते हैं।

Flipper निम्न-स्तरीय ISO 14443 प्रोटोकॉल के साथ-साथ Mifare Ultralight डेटा ट्रांसफर प्रोटोकॉल और बैंक कार्ड में उपयोग किए जाने वाले EMV के साथ इंटरैक्ट कर सकता है। हम Mifare Classic और NFC NDEF के लिए समर्थन जोड़ने पर काम कर रहे हैं। NFC के निर्माण करने वाले प्रोटोकॉल और मानकों पर एक गहन नज़र एक अलग लेख के लायक है जिसे हम बाद में प्रकाशित करने की योजना बना रहे हैं।

ISO 14443-A मानक पर आधारित सभी उच्च-फ्रीक्वेंसी कार्ड में एक अद्वितीय चिप ID होती है। यह कार्ड का सीरियल नंबर के रूप में कार्य करता है, जैसे नेटवर्क कार्ड का MAC पता। **आमतौर पर, UID 4 या 7 बाइट लंबा होता है**, लेकिन यह शायद ही कभी **10** तक जा सकता है। UIDs कोई रहस्य नहीं हैं और इन्हें आसानी से पढ़ा जा सकता है, **कभी-कभी तो कार्ड पर ही प्रिंट किया जाता है**।

कई एक्सेस कंट्रोल सिस्टम UID पर निर्भर करते हैं ताकि **प्रमाणित और पहुंच प्रदान करें**। कभी-कभी यह तब भी होता है जब RFID टैग **क्रिप्टोग्राफी** का समर्थन करते हैं। ऐसी **दुरुपयोग** उन्हें **125 kHz कार्डों** के स्तर पर ले आता है सुरक्षा के मामले में। वर्चुअल कार्ड (जैसे Apple Pay) एक गतिशील UID का उपयोग करते हैं ताकि फोन मालिक अपने भुगतान ऐप के साथ दरवाजे न खोल सकें।

- **कम रेंज** — उच्च-फ्रीक्वेंसी कार्ड विशेष रूप से इस तरह से डिज़ाइन किए गए हैं कि उन्हें रीडर के करीब रखा जाना चाहिए। यह कार्ड को अनधिकृत इंटरैक्शन से भी बचाने में मदद करता है। अधिकतम पढ़ने की रेंज जो हम प्राप्त करने में सक्षम थे वह लगभग 15 सेमी थी, और वह कस्टम-निर्मित उच्च-रेंज रीडर्स के साथ थी।
- **उन्नत प्रोटोकॉल** — डेटा ट्रांसफर की गति 424 kbps तक जटिल प्रोटोकॉल की अनुमति देती है जिसमें पूर्ण-फledged दो-तरफा डेटा ट्रांसफर होता है। जो बदले में **क्रिप्टोग्राफी**, डेटा ट्रांसफर आदि की अनुमति देता है।
- **उच्च सुरक्षा** — उच्च-फ्रीक्वेंसी संपर्क रहित कार्ड स्मार्ट कार्डों की तुलना में किसी भी तरह से कम नहीं होते हैं। ऐसे कार्ड हैं जो क्रिप्टोग्राफिक रूप से मजबूत एल्गोरिदम जैसे AES का समर्थन करते हैं और विषम क्रिप्टोग्राफी को लागू करते हैं।

### Attack

You can **attack these Tags with the Flipper Zero**:

{{#ref}}
flipper-zero/fz-nfc.md
{{#endref}}

Or using the **proxmark**:

{{#ref}}
proxmark-3.md
{{#endref}}

## References

- [https://blog.flipperzero.one/rfid/](https://blog.flipperzero.one/rfid/)

{{#include ../../banners/hacktricks-training.md}}
