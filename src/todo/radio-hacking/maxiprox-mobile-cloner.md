# ポータブル HID MaxiProx 125 kHz モバイルクローンの構築

{{#include ../../banners/hacktricks-training.md}}

## 目標
メイン電源で動作する HID MaxiProx 5375 ロングレンジ 125 kHz リーダーを、物理セキュリティ評価中に近接カードを静かに収集するフィールド展開可能なバッテリー駆動のバッジクローンに変換します。

ここで説明する変換は、TrustedSec の「Let’s Clone a Cloner – Part 3: Putting It All Together」研究シリーズに基づいており、最終的なデバイスがバックパックに入れられ、現場で即座に使用できるように、機械的、電気的、RF の考慮事項を組み合わせています。

> [!warning]
> メイン電源で動作する機器やリチウムイオン電源バンクを操作することは危険です。回路に電源を入れる前に**すべての接続を確認**し、リーダーの調整を避けるためにアンテナ、同軸ケーブル、接地プレーンを工場設計のままに保ってください。

## 材料費用明細書 (BOM)

* HID MaxiProx 5375 リーダー（または任意の 12 V HID Prox® ロングレンジリーダー）
* ESP RFID Tool v2.2 (ESP32ベースのWiegandスニファー/ロガー)
* 12 V @ ≥3 A を交渉できる USB-PD (Power-Delivery) トリガーモジュール
* 100 W USB-C パワーバンク（12 V PD プロファイル出力）
* 26 AWG シリコン絶縁フックアップワイヤー – 赤/白
* パネルマウント SPST トグルスイッチ（ビーパーキルスイッチ用）
* NKK AT4072 スイッチガード / 事故防止キャップ
* ハンダごて、ハンダ吸い取り線 & 吸い取りポンプ
* ABS 評価の手工具：コーピングソー、ユーティリティナイフ、平ファイル & 半丸ファイル
* ドリルビット 1/16″ (1.5 mm) と 1/8″ (3 mm)
* 3 M VHB 両面テープ & ジップタイ

## 1. 電源サブシステム

1. 論理 PCB 用に 5 V を生成するために使用される工場のバッカンバーを脱ハンダして取り外します。
2. ESP RFID Tool の隣に USB-PD トリガーを取り付け、トリガーの USB-C 受信口をエンクロージャの外側にルーティングします。
3. PD トリガーはパワーバンクから 12 V を交渉し、直接 MaxiProx に供給します（リーダーは本来 10–14 V を期待します）。 ESP ボードから 5 V のセカンダリレールを取り出して、アクセサリに電力を供給します。
4. 100 W バッテリーパックは内部スタンドオフにフラッシュに配置され、フェライトアンテナに電源ケーブルがかからないようにして RF 性能を保持します。

## 2. ビーパーキルスイッチ – サイレントオペレーション

1. MaxiProx 論理基板上の 2 つのスピーカーパッドを見つけます。
2. *両方*のパッドをきれいにし、**負**のパッドのみを再ハンダします。
3. ビーパー パッドに 26 AWG ワイヤー（白 = 負、赤 = 正）をハンダ付けし、新たに切ったスロットを通してパネルマウント SPST スイッチにルーティングします。
4. スイッチがオープンのとき、ビーパー回路は切断され、リーダーは完全に静かに動作します – 秘密のバッジ収集に最適です。
5. トグルの上に NKK AT4072 スプリングローデッドセーフティキャップを取り付けます。コーピングソー/ファイルで穴を慎重に広げ、スイッチ本体にスナップするまで広げます。ガードはバックパック内での誤作動を防ぎます。

## 3. エンクロージャ & 機械作業

• フラッシュカッターを使用し、次にナイフとファイルで内部の ABS “バンプアウト” を*取り除き*、大きな USB-C バッテリーがスタンドオフに平らに座るようにします。
• エンクロージャの壁に USB-C ケーブル用の 2 つの平行なチャネルを彫ります。これによりバッテリーが固定され、動きや振動が排除されます。
• バッテリーの**電源**ボタン用の長方形の開口部を作成します：
1. 位置に紙の型紙をテープで貼ります。
2. すべての四隅に 1/16″ のパイロットホールをドリルします。
3. 1/8″ ビットで拡大します。
4. コーピングソーで穴をつなぎ、ファイルでエッジを仕上げます。
✱ 高速ビットが厚い ABS を溶かし、醜いエッジを残すため、回転式 Dremel は*避けられました*。

## 4. 最終組み立て

1. MaxiProx 論理基板を再取り付けし、SMA ピグテールをリーダーの PCB グラウンドパッドに再ハンダします。
2. ESP RFID Tool と USB-PD トリガーを 3 M VHB を使用して取り付けます。
3. すべての配線をジップタイで整え、電源リードをアンテナループから**遠く**に保ちます。
4. エンクロージャのネジを締めてバッテリーが軽く圧縮されるまで締めます。内部の摩擦がデバイスがカードを読み取った後にパックが移動するのを防ぎます。

## 5. 範囲 & シールドテスト

* 125 kHz **Pupa** テストカードを使用して、ポータブルクローンは**≈ 8 cm**の範囲で一貫した読み取りを達成しました – メイン電源での動作と同じです。
* リーダーを薄壁の金属製現金箱の中に置く（銀行ロビーのデスクを模擬するため）と、範囲が ≤ 2 cm に減少し、 substantial metal enclosures が効果的な RF シールドとして機能することが確認されました。

## 使用ワークフロー

1. USB-C バッテリーを充電し、接続し、メイン電源スイッチを切り替えます。
2. （オプション）ビーパーガードを開き、ベンチテスト時に音声フィードバックを有効にします。秘密のフィールド使用の前にロックします。
3. ターゲットバッジホルダーの近くを歩きます – MaxiProx がカードに電力を供給し、ESP RFID Tool が Wiegand ストリームをキャプチャします。
4. キャプチャした認証情報を Wi-Fi または USB-UART 経由でダンプし、必要に応じて再生/クローンします。

## トラブルシューティング

| 症状 | 考えられる原因 | 修正 |
|---------|--------------|------|
| カードを提示するとリーダーが再起動する | PD トリガーが 9 V を交渉したが 12 V ではない | トリガージャンパーを確認 / より高出力の USB-C ケーブルを試す |
| 読み取り範囲がない | バッテリーまたは配線がアンテナの*上に*ある | ケーブルを再ルーティングし、フェライトループの周りに 2 cm のクリアランスを保つ |
| ビーパーがまだ鳴る | スイッチが負のリードではなく正のリードに配線されている | キルスイッチを移動して**負**のスピーカートレースを切断します |

## 参考文献

- [Let’s Clone a Cloner – Part 3 (TrustedSec)](https://trustedsec.com/blog/lets-clone-a-cloner-part-3-putting-it-all-together)

{{#include ../../banners/hacktricks-training.md}}
