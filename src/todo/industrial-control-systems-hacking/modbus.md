# Modbus协议

## Modbus协议简介

Modbus协议是工业自动化和控制系统中广泛使用的协议。Modbus允许可编程逻辑控制器（PLC）、传感器、执行器和其他工业设备之间的通信。理解Modbus协议至关重要，因为这是ICS中使用最广泛的通信协议，并且具有大量的潜在攻击面，可以进行嗅探甚至向PLC注入命令。

在这里，概念以要点形式陈述，提供协议的背景及其操作性质。ICS系统安全的最大挑战是实施和升级的成本。这些协议和标准是在80年代和90年代早期设计的，至今仍被广泛使用。由于一个行业有很多设备和连接，升级设备非常困难，这使得黑客在处理过时协议时占据了优势。对Modbus的攻击几乎是不可避免的，因为它将在没有升级的情况下使用，而其操作对行业至关重要。

## 客户端-服务器架构

Modbus协议通常用作客户端-服务器架构，其中主设备（客户端）与一个或多个从设备（服务器）发起通信。这也被称为主从架构，广泛用于电子和物联网中，如SPI、I2C等。

## 串行和以太网版本

Modbus协议设计用于串行通信和以太网通信。串行通信在遗留系统中广泛使用，而现代设备支持以太网，提供更高的数据传输速率，更适合现代工业网络。

## 数据表示

数据在Modbus协议中以ASCII或二进制形式传输，尽管由于与旧设备的兼容性，通常使用二进制格式。

## 功能代码

ModBus协议通过传输特定的功能代码来操作PLC和各种控制设备。这部分很重要，因为重放攻击可以通过重新传输功能代码来实现。遗留设备不支持任何数据传输加密，通常有长电缆连接，这导致这些电缆被篡改并捕获/注入数据。

## Modbus的寻址

网络中的每个设备都有一些唯一地址，这对于设备之间的通信至关重要。像Modbus RTU、Modbus TCP等协议用于实现寻址，并作为数据传输的传输层。传输的数据是Modbus协议格式，包含消息。

此外，Modbus还实现了错误检查，以确保传输数据的完整性。但最重要的是，Modbus是开放标准，任何人都可以在其设备中实现。这使得该协议成为全球标准，并在工业自动化行业中广泛应用。

由于其大规模使用和缺乏升级，攻击Modbus提供了显著的优势，具有广泛的攻击面。ICS高度依赖设备之间的通信，任何对它们的攻击都可能对工业系统的操作造成危险。如果攻击者识别出传输媒介，可以进行重放、数据注入、数据嗅探和泄露、拒绝服务、数据伪造等攻击。
