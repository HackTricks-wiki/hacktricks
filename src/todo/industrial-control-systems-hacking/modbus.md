# Το Πρωτόκολλο Modbus

## Εισαγωγή στο Πρωτόκολλο Modbus

Το πρωτόκολλο Modbus είναι ένα ευρέως χρησιμοποιούμενο πρωτόκολλο στην Βιομηχανική Αυτοματοποίηση και τα Συστήματα Ελέγχου. Το Modbus επιτρέπει την επικοινωνία μεταξύ διαφόρων συσκευών όπως προγραμματιζόμενοι λογικοί ελεγκτές (PLCs), αισθητήρες, ενεργοποιητές και άλλες βιομηχανικές συσκευές. Η κατανόηση του Πρωτοκόλλου Modbus είναι απαραίτητη, καθώς αυτό είναι το πιο χρησιμοποιούμενο πρωτόκολλο επικοινωνίας στα ICS και έχει μεγάλη επιφάνεια πιθανών επιθέσεων για υποκλοπή και ακόμη και εισαγωγή εντολών σε PLCs.

Εδώ, οι έννοιες αναφέρονται σημειωτικά παρέχοντας το πλαίσιο του πρωτοκόλλου και τη φύση της λειτουργίας του. Η μεγαλύτερη πρόκληση στην ασφάλεια των συστημάτων ICS είναι το κόστος υλοποίησης και αναβάθμισης. Αυτά τα πρωτόκολλα και τα πρότυπα σχεδιάστηκαν στις αρχές της δεκαετίας του '80 και του '90 και εξακολουθούν να χρησιμοποιούνται ευρέως. Δεδομένου ότι μια βιομηχανία έχει πολλές συσκευές και συνδέσεις, η αναβάθμιση των συσκευών είναι πολύ δύσκολη, γεγονός που παρέχει στους χάκερ πλεονέκτημα στην αντιμετώπιση παλαιών πρωτοκόλλων. Οι επιθέσεις στο Modbus είναι σχεδόν αναπόφευκτες, καθώς θα χρησιμοποιείται χωρίς αναβάθμιση και η λειτουργία του είναι κρίσιμη για τη βιομηχανία.

## Η Αρχιτεκτονική Πελάτη-Εξυπηρετητή

Το Πρωτόκολλο Modbus χρησιμοποιείται συνήθως σε Αρχιτεκτονική Πελάτη-Εξυπηρετητή όπου μια κύρια συσκευή (πελάτης) ξεκινά την επικοινωνία με μία ή περισσότερες δευτερεύουσες συσκευές (εξυπηρετητές). Αυτό αναφέρεται επίσης ως αρχιτεκτονική Master-Slave, η οποία χρησιμοποιείται ευρέως στην ηλεκτρονική και το IoT με SPI, I2C, κ.λπ.

## Εκδόσεις Σειριακής και Ethernet

Το Πρωτόκολλο Modbus έχει σχεδιαστεί τόσο για Σειριακή Επικοινωνία όσο και για Επικοινωνίες Ethernet. Η Σειριακή Επικοινωνία χρησιμοποιείται ευρέως σε κληρονομημένα συστήματα, ενώ οι σύγχρονες συσκευές υποστηρίζουν Ethernet, το οποίο προσφέρει υψηλές ταχύτητες δεδομένων και είναι πιο κατάλληλο για σύγχρονα βιομηχανικά δίκτυα.

## Αναπαράσταση Δεδομένων

Τα δεδομένα μεταδίδονται στο πρωτόκολλο Modbus ως ASCII ή Δυαδικά, αν και η δυαδική μορφή χρησιμοποιείται λόγω της συμβατότητάς της με παλαιότερες συσκευές.

## Κωδικοί Λειτουργιών

Το Πρωτόκολλο ModBus λειτουργεί με τη μετάδοση συγκεκριμένων κωδικών λειτουργιών που χρησιμοποιούνται για τη λειτουργία των PLCs και διαφόρων συσκευών ελέγχου. Αυτή η ενότητα είναι σημαντική για την κατανόηση, καθώς οι επιθέσεις επανάληψης μπορούν να γίνουν με την επαναμετάδοση κωδικών λειτουργιών. Οι κληρονομημένες συσκευές δεν υποστηρίζουν καμία κρυπτογράφηση κατά τη μετάδοση δεδομένων και συνήθως έχουν μακριά καλώδια που τις συνδέουν, γεγονός που οδηγεί σε παραποίηση αυτών των καλωδίων και σύλληψη/εισαγωγή δεδομένων.

## Διευθύνσεις Modbus

Κάθε συσκευή στο δίκτυο έχει κάποια μοναδική διεύθυνση που είναι απαραίτητη για την επικοινωνία μεταξύ των συσκευών. Πρωτόκολλα όπως Modbus RTU, Modbus TCP, κ.λπ. χρησιμοποιούνται για την υλοποίηση διευθύνσεων και λειτουργούν ως επίπεδο μεταφοράς για τη μετάδοση δεδομένων. Τα δεδομένα που μεταφέρονται είναι σε μορφή πρωτοκόλλου Modbus που περιέχει το μήνυμα.

Επιπλέον, το Modbus εφαρμόζει επίσης ελέγχους σφαλμάτων για να διασφαλίσει την ακεραιότητα των μεταδιδόμενων δεδομένων. Αλλά το πιο σημαντικό, το Modbus είναι ένα Ανοιχτό Πρότυπο και ο καθένας μπορεί να το εφαρμόσει στις συσκευές του. Αυτό έκανε το πρωτόκολλο αυτό να γίνει παγκόσμιο πρότυπο και είναι ευρέως διαδεδομένο στη βιομηχανία αυτοματοποίησης.

Λόγω της εκτενούς χρήσης του και της έλλειψης αναβαθμίσεων, η επίθεση στο Modbus παρέχει σημαντικό πλεονέκτημα με την επιφάνεια επίθεσής του. Το ICS εξαρτάται σε μεγάλο βαθμό από την επικοινωνία μεταξύ των συσκευών και οποιαδήποτε επίθεση σε αυτές μπορεί να είναι επικίνδυνη για τη λειτουργία των βιομηχανικών συστημάτων. Επιθέσεις όπως επανάληψη, εισαγωγή δεδομένων, υποκλοπή δεδομένων και διαρροή, Άρνηση Υπηρεσίας, πλαστογράφηση δεδομένων, κ.λπ. μπορούν να πραγματοποιηθούν εάν το μέσο μετάδοσης αναγνωριστεί από τον επιτιθέμενο.
