# Extracci贸n de Entitlements de la Aplicaci贸n Compilada

<details>

<summary><strong>Aprende hacking en AWS desde cero hasta experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** 隆Consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Obt茅n [**productos oficiales de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆gueme** en **Twitter**  [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>


Resumen de la p谩gina [https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0069/#review-entitlements-embedded-in-the-compiled-app-binary](https://mas.owasp.org/MASTG/tests/ios/MASVS-PLATFORM/MASTG-TEST-0069/#review-entitlements-embedded-in-the-compiled-app-binary)

### **Extracci贸n de Entitlements y Archivos de Provisi贸n M贸vil**

Cuando se trata de un IPA de una aplicaci贸n o de una aplicaci贸n instalada en un dispositivo con jailbreak, puede que no sea posible encontrar archivos `.entitlements` o el archivo `embedded.mobileprovision` directamente. Sin embargo, las listas de propiedades de los entitlements a煤n pueden ser extra铆das del binario de la aplicaci贸n, siguiendo los procedimientos descritos en el cap铆tulo "Pruebas B谩sicas de Seguridad en iOS", en particular la secci贸n "Adquisici贸n del Binario de la Aplicaci贸n".

Incluso con binarios encriptados, se pueden emplear ciertos pasos para extraer estos archivos. Si estos pasos fallan, pueden ser necesarios herramientas como Clutch (si es compatible con la versi贸n de iOS), frida-ios-dump, u utilidades similares para descifrar y extraer la aplicaci贸n.

#### **Extracci贸n del Plist de Entitlements del Binario de la Aplicaci贸n**

Con el binario de la aplicaci贸n accesible en un ordenador, **binwalk** puede ser utilizado para extraer todos los archivos XML. El siguiente comando demuestra c贸mo hacerlo:
```bash
$ binwalk -e -y=xml ./Telegram\ X

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
1430180       0x15D2A4        XML document, version: "1.0"
1458814       0x16427E        XML document, version: "1.0"
```
Alternativamente, **radare2** se puede utilizar para ejecutar silenciosamente un comando y salir, buscando todas las cadenas en el binario de la aplicaci贸n que contienen "PropertyList":
```bash
$ r2 -qc 'izz~PropertyList' ./Telegram\ X

0x0015d2a4 ascii <?xml version="1.0" encoding="UTF-8" standalone="yes"?>...
0x0016427d ascii H<?xml version="1.0" encoding="UTF-8"?>...
```
Ambos m茅todos, binwalk y radare2, permiten la extracci贸n de archivos `plist`, con una inspecci贸n del primero (0x0015d2a4) revelando una recuperaci贸n exitosa del [archivo de permisos original de Telegram](https://github.com/peter-iakovlev/Telegram-iOS/blob/77ee5c4dabdd6eb5f1e2ff76219edf7e18b45c00/Telegram-iOS/Telegram-iOS-AppStoreLLC.entitlements).

Para binarios de aplicaciones accedidos en dispositivos con jailbreak (por ejemplo, a trav茅s de SSH), el comando **grep** con la bandera `-a, --text` se puede utilizar para tratar todos los archivos como texto ASCII:
```bash
$ grep -a -A 5 'PropertyList' /var/containers/Bundle/Application/...
```
Ajustar la bandera `-A num, --after-context=num` permite mostrar m谩s o menos l铆neas. Este m茅todo es viable incluso para binarios de aplicaciones encriptadas y ha sido verificado en m煤ltiples aplicaciones de la App Store. Las herramientas mencionadas anteriormente tambi茅n pueden ser utilizadas en dispositivos iOS con jailbreak con prop贸sitos similares.

**Nota**: No se recomienda el uso directo del comando `strings` para esta tarea debido a sus limitaciones para encontrar informaci贸n relevante. En su lugar, se aconseja utilizar grep con la bandera `-a` en el binario o utilizar radare2 (`izz`)/rabin2 (`-zz`) para obtener resultados m谩s efectivos.
