# Burpè¨¼æ˜æ›¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼šç¤¾**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ**HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹**ã—ãŸã‚Šã€**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* [**å…¬å¼ã®PEASS & HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã—ã¾ã—ã‚‡ã†ã€‚
* **[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã‚„[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ ã™ã‚‹ã‹ã€**Twitter**ã§ç§ã‚’**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚³ãƒ„ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€**[**hacktricksãƒªãƒã‚¸ãƒˆãƒª**](https://github.com/carlospolop/hacktricks)ã¨[**hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª**](https://github.com/carlospolop/hacktricks-cloud)ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>

## ä»®æƒ³ãƒã‚·ãƒ³ä¸Šã§

ã¾ãšæœ€åˆã«ã€Burpã‹ã‚‰Derè¨¼æ˜æ›¸ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ _**Proxy**_ --> _**Options**_ --> _**Import / Export CA certificate**_ ã§è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚

![](<../../.gitbook/assets/image (367).png>)

**Derå½¢å¼ã§è¨¼æ˜æ›¸ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—**ã€**Android**ãŒ**ç†è§£ã§ãã‚‹å½¢å¼ã«å¤‰æ›**ã—ã¾ã—ã‚‡ã†ã€‚**AVDã®Androidãƒã‚·ãƒ³ã«burpè¨¼æ˜æ›¸ã‚’è¨­å®šã™ã‚‹ãŸã‚ã«ã¯**ã€**`-writable-system`** ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä»˜ã‘ã¦ã“ã®ãƒã‚·ãƒ³ã‚’**å®Ÿè¡Œ**ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚\
ä¾‹ãˆã°ã€æ¬¡ã®ã‚ˆã†ã«å®Ÿè¡Œã§ãã¾ã™ï¼š

{% code overflow="wrap" %}
```bash
C:\Users\<UserName>\AppData\Local\Android\Sdk\tools\emulator.exe -avd "AVD9" -http-proxy 192.168.1.12:8080 -writable-system
```
{% endcode %}

æ¬¡ã«ã€**burpsè¨¼æ˜æ›¸ã‚’è¨­å®šã™ã‚‹ã«ã¯**ï¼š

{% code overflow="wrap" %}
```bash
openssl x509 -inform DER -in burp_cacert.der -out burp_cacert.pem
CERTHASHNAME="`openssl x509 -inform PEM -subject_hash_old -in burp_cacert.pem | head -1`.0"
mv burp_cacert.pem $CERTHASHNAME #Correct name
adb root && sleep 2 && adb remount #Allow to write on /syste
adb push $CERTHASHNAME /sdcard/ #Upload certificate
adb shell mv /sdcard/$CERTHASHNAME /system/etc/security/cacerts/ #Move to correct location
adb shell chmod 644 /system/etc/security/cacerts/$CERTHASHNAME #Assign privileges
adb reboot #Now, reboot the machine
```
{% endcode %}

**ãƒã‚·ãƒ³ãŒå†èµ·å‹•ã‚’å®Œäº†ã™ã‚‹ã¨**ã€Burpè¨¼æ˜æ›¸ãŒä½¿ç”¨ã•ã‚Œã¾ã™ï¼

## Magiscã‚’ä½¿ç”¨ã™ã‚‹

ã‚‚ã—**Magiscã§ãƒ‡ãƒã‚¤ã‚¹ã‚’ãƒ«ãƒ¼ãƒˆåŒ–**ã—ã¦ã„ã¦ï¼ˆã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã®å ´åˆã‚‚ã‚ã‚Šã¾ã™ï¼‰ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ãŒ**èª­ã¿å–ã‚Šå°‚ç”¨**ã§æ›¸ãè¾¼ã¿å¯èƒ½ã«ãƒªãƒã‚¦ãƒ³ãƒˆã§ããªã„ãŸã‚ã«ã€Burpè¨¼æ˜æ›¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã«å…ˆè¿°ã®**æ‰‹é †**ã‚’**ãŸã©ã‚Œãªã„**å ´åˆã€åˆ¥ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚

[**ã“ã®ãƒ“ãƒ‡ã‚ª**](https://www.youtube.com/watch?v=qQicUW0svB8)ã§èª¬æ˜ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã«ã€ä»¥ä¸‹ã®æ‰‹é †ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š

1. **CAè¨¼æ˜æ›¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹**ï¼šDERå½¢å¼ã®Burpè¨¼æ˜æ›¸ã‚’`.crt`ã«**æ‹¡å¼µå­ã‚’å¤‰æ›´ã—ã¦**ãƒ¢ãƒã‚¤ãƒ«ã«**ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—**ã—ã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ«ãƒ€ã«ä¿å­˜ã—ã¾ã™ã€‚ãã—ã¦`Install a certificate` -> `CA certificate`ã«é€²ã¿ã¾ã™ã€‚

<figure><img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" width="164"><figcaption></figcaption></figure>

* `Trusted credentials` -> `USER`ã«é€²ã‚“ã§ã€è¨¼æ˜æ›¸ãŒæ­£ã—ãä¿å­˜ã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

<figure><img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" width="334"><figcaption></figcaption></figure>

2. **ã‚·ã‚¹ãƒ†ãƒ ã§ä¿¡é ¼ã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹**ï¼šMagiscãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«[MagiskTrustUserCerts](https://github.com/NVISOsecurity/MagiskTrustUserCerts)ï¼ˆ.zipãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€é›»è©±ã«**ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—**ã—ã¦ã€é›»è©±ã®**Magicsã‚¢ãƒ—ãƒª**ã§**`Modules`**ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«é€²ã¿ã€**`Install from storage`**ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€`.zip`ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’é¸æŠã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸå¾Œã€é›»è©±ã‚’**å†èµ·å‹•**ã—ã¾ã™ï¼š

<figure><img src="../../.gitbook/assets/image (2) (1) (1) (1) (1) (1) (1) (1).png" alt="" width="345"><figcaption></figcaption></figure>

* å†èµ·å‹•å¾Œã€`Trusted credentials` -> `SYSTEM`ã«é€²ã¿ã€Postswiggerè¨¼æ˜æ›¸ãŒãã“ã«ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

<figure><img src="../../.gitbook/assets/image (3) (1) (1) (1).png" alt="" width="314"><figcaption></figcaption></figure>

## Android 14ä»¥é™

å¤‰æ›´ç‚¹ï¼š

* ã“ã‚Œã¾ã§ã€ã‚·ã‚¹ãƒ†ãƒ ã§ä¿¡é ¼ã•ã‚Œã‚‹CAè¨¼æ˜æ›¸ã¯**`/system/etc/security/cacerts/`**ã«ã‚ã‚Šã¾ã—ãŸã€‚æ¨™æº–ã®AOSPã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã§ã¯ã€æœ€å°é™ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã§**ãƒ«ãƒ¼ãƒˆã‚¢ã‚¯ã‚»ã‚¹ã‚’ä½¿ã£ã¦ç›´æ¥å¤‰æ›´**ã§ãã€**ã™ãã«å…¨ä½“ã«å½±éŸ¿**ã‚’ä¸ãˆã¾ã—ãŸã€‚
* Android 14ã§ã¯ã€ã‚·ã‚¹ãƒ†ãƒ ã§ä¿¡é ¼ã•ã‚Œã‚‹CAè¨¼æ˜æ›¸ã¯ä¸€èˆ¬çš„ã«**`/apex/com.android.conscrypt/cacerts`**ã«ã‚ã‚Šã€**`/apex`å…¨ä½“ãŒä¸å¤‰**ã§ã™ã€‚
* **APEX cacertsãƒ‘ã‚¹ã¯æ›¸ãè¾¼ã¿å¯èƒ½ã¨ã—ã¦ãƒªãƒã‚¦ãƒ³ãƒˆã§ãã¾ã›ã‚“** - ãƒªãƒã‚¦ãƒ³ãƒˆã¯å˜ã«å¤±æ•—ã—ã¾ã™ã€‚å®Ÿéš›ã€ãƒ«ãƒ¼ãƒˆã‚·ã‚§ãƒ«ã‹ã‚‰å®Œå…¨ã«ãƒ‘ã‚¹ã‚’ã‚¢ãƒ³ãƒã‚¦ãƒ³ãƒˆã—ã¦ã‚‚ã€ã‚¢ãƒ—ãƒªã¯å¼•ãç¶šãè¨¼æ˜æ›¸ã‚’å•é¡Œãªãèª­ã¿å–ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
* tmpfsãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä¸Šã«ãƒã‚¦ãƒ³ãƒˆã™ã‚‹ä»£æ›¿æŠ€è¡“ã‚‚**æ©Ÿèƒ½ã—ã¾ã›ã‚“** - ã“ã‚Œã¯`ls /apex/com.android.conscrypt/cacerts`ãŒä½•ã‚‚è¿”ã•ãªã„ï¼ˆã¾ãŸã¯å¥½ããªã‚‚ã®ã‚’è¿”ã™ï¼‰ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€ã‚¢ãƒ—ãƒªã¯ä¾ç„¶ã¨ã—ã¦å…ƒã®ãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
* `/apex`ãƒã‚¦ãƒ³ãƒˆã¯ã€ãƒ—ãƒ­ã‚»ã‚¹é–“ã§`/apex`ãƒ‘ã‚¹å†…ã®ãƒã‚¦ãƒ³ãƒˆã®å¤‰æ›´ãŒå…±æœ‰ã•ã‚Œãªã„ã‚ˆã†ã«ã€[æ˜ç¤ºçš„ã«](https://cs.android.com/android/platform/superproject/main/+/main:system/core/init/mount\_namespace.cpp;l=97;drc=566c65239f1cf3fcb0d8745715e5ef1083d4bd3a) **PRIVATEä¼æ’­ã§ãƒã‚¦ãƒ³ãƒˆã•ã‚Œã¦ã„ã¾ã™**ã€‚

ã“ã‚Œã¯OSã‚’èµ·å‹•ã™ã‚‹`init`ãƒ—ãƒ­ã‚»ã‚¹ã«ã‚ˆã£ã¦è¡Œã‚ã‚Œã€ãã®å¾Œã€[Zygoteãƒ—ãƒ­ã‚»ã‚¹](https://en.wikipedia.org/wiki/Booting\_process\_of\_Android\_devices#Zygote)ï¼ˆè¦ªã‹ã‚‰ã‚³ãƒ”ãƒ¼ã•ã‚ŒãŸæ–°ã—ã„ãƒã‚¦ãƒ³ãƒˆåå‰ç©ºé–“ã‚’å«ã‚€ãŸã‚ã€**è‡ªèº«ã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãª`/apex`ãƒã‚¦ãƒ³ãƒˆ**ã‚’å«ã‚€ï¼‰ã‚’èµ·å‹•ã—ã€ãã®å¾Œã€ãƒ‡ãƒã‚¤ã‚¹ä¸Šã§ã‚¢ãƒ—ãƒªãŒèµ·å‹•ã•ã‚Œã‚‹ãŸã³ã«**å„ã‚¢ãƒ—ãƒªãƒ—ãƒ­ã‚»ã‚¹ã‚’é–‹å§‹ã—ã¾ã™**ï¼ˆãã‚Œãã‚ŒãŒåŒã˜ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãª`/apex`ãƒã‚¦ãƒ³ãƒˆã‚’**ã‚³ãƒ”ãƒ¼ã—ã¾ã™**ï¼‰ã€‚

### ãƒã‚¦ãƒ³ãƒˆãƒã‚¤ãƒ³ãƒˆã‚’å†å¸°çš„ã«ãƒªãƒã‚¦ãƒ³ãƒˆã™ã‚‹

* `/apex`ã‚’æ‰‹å‹•ã§ãƒªãƒã‚¦ãƒ³ãƒˆã—ã€PRIVATEä¼æ’­ã‚’å‰Šé™¤ã—ã¦æ›¸ãè¾¼ã¿å¯èƒ½ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆçš®è‚‰ãªã“ã¨ã«ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆä¼æ’­ã‚’å®Œå…¨ã«å‰Šé™¤ã™ã‚‹ã¨ã€ã©ã“ã«ã§ã‚‚_ä¼æ’­ã™ã‚‹_ã‚ˆã†ã§ã™ï¼‰
* `/apex/com.android.conscrypt`ã®å…¨å†…å®¹ã‚’åˆ¥ã®å ´æ‰€ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã™
* ãã®å¾Œã€`/apex/com.android.conscrypt`ã‚’å®Œå…¨ã«ã‚¢ãƒ³ãƒã‚¦ãƒ³ãƒˆã—ã¾ã™ - ã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä¸å¤‰ã§æä¾›ã™ã‚‹èª­ã¿å–ã‚Šå°‚ç”¨ãƒã‚¦ãƒ³ãƒˆã‚’å‰Šé™¤ã—ã¾ã™
* ãã®å¾Œã€å†…å®¹ã‚’æˆ»ã—ã¦ã€`/apex`ãƒã‚¦ãƒ³ãƒˆã«ç›´æ¥ç”Ÿãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ãã“ã§ã¯å¤‰æ›´ãŒå¯èƒ½ã§ã™ï¼ˆ[ã©ã†ã‚„ã‚‰](https://infosec.exchange/@g1a55er/111069489513139531)ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€è¿…é€Ÿã«è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼‰
* ã“ã‚Œã¯ã™ãã«åŠ¹æœãŒã‚ã‚‹ã¯ãšã§ã™ãŒã€`system_server`ã‚’çµ‚äº†ã™ã‚‹ï¼ˆã™ã¹ã¦ã®ã‚¢ãƒ—ãƒªã‚’å†èµ·å‹•ã™ã‚‹ï¼‰ã“ã¨ã§ã€ã™ã¹ã¦ã‚’ä¸€è²«ã—ãŸçŠ¶æ…‹ã«æˆ»ã™ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™
```bash
# Create a separate temp directory, to hold the current certificates
# Otherwise, when we add the mount we can't read the current certs anymore.
mkdir -p -m 700 /data/local/tmp/tmp-ca-copy

# Copy out the existing certificates
cp /apex/com.android.conscrypt/cacerts/* /data/local/tmp/tmp-ca-copy/

# Create the in-memory mount on top of the system certs folder
mount -t tmpfs tmpfs /system/etc/security/cacerts

# Copy the existing certs back into the tmpfs, so we keep trusting them
mv /data/local/tmp/tmp-ca-copy/* /system/etc/security/cacerts/

# Copy our new cert in, so we trust that too
mv $CERTIFICATE_PATH /system/etc/security/cacerts/

# Update the perms & selinux context labels
chown root:root /system/etc/security/cacerts/*
chmod 644 /system/etc/security/cacerts/*
chcon u:object_r:system_file:s0 /system/etc/security/cacerts/*

# Deal with the APEX overrides, which need injecting into each namespace:

# First we get the Zygote process(es), which launch each app
ZYGOTE_PID=$(pidof zygote || true)
ZYGOTE64_PID=$(pidof zygote64 || true)
# N.b. some devices appear to have both!

# Apps inherit the Zygote's mounts at startup, so we inject here to ensure
# all newly started apps will see these certs straight away:
for Z_PID in "$ZYGOTE_PID" "$ZYGOTE64_PID"; do
if [ -n "$Z_PID" ]; then
nsenter --mount=/proc/$Z_PID/ns/mnt -- \
/bin/mount --bind /system/etc/security/cacerts /apex/com.android.conscrypt/cacerts
fi
done

# Then we inject the mount into all already running apps, so they
# too see these CA certs immediately:

# Get the PID of every process whose parent is one of the Zygotes:
APP_PIDS=$(
echo "$ZYGOTE_PID $ZYGOTE64_PID" | \
xargs -n1 ps -o 'PID' -P | \
grep -v PID
)

# Inject into the mount namespace of each of those apps:
for PID in $APP_PIDS; do
nsenter --mount=/proc/$PID/ns/mnt -- \
/bin/mount --bind /system/etc/security/cacerts /apex/com.android.conscrypt/cacerts &
done
wait # Launched in parallel - wait for completion here

echo "System certificate injected"
```
### NSEnterã‚’ä½¿ç”¨ã—ãŸãƒã‚¤ãƒ³ãƒ‰ãƒã‚¦ãƒ³ãƒˆ

* æœ€åˆã«ã€ã©ã“ã‹ã«æ›¸ãè¾¼ã¿å¯èƒ½ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚æ—¢å­˜ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¨ã®äº’æ›æ€§ã‚’å®¹æ˜“ã«ã™ã‚‹ãŸã‚ã«ã€ç§ã¯éAPEXã‚·ã‚¹ãƒ†ãƒ è¨¼æ˜æ›¸ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆã¾ã å­˜åœ¨ã—ã¦ã„ã‚‹ï¼‰ä¸Šã«`tmpfs`ãƒã‚¦ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¦ã“ã‚Œã‚’è¡Œã£ã¦ã„ã¾ã™ï¼š

```bash
mount -t tmpfs tmpfs /system/etc/security/cacerts
```
* æ¬¡ã«ã€èˆˆå‘³ã®ã‚ã‚‹CAè¨¼æ˜æ›¸ã‚’ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é…ç½®ã—ã¾ã™ï¼ˆä¾‹ãˆã°ã€æ—¢å­˜ã®`/apex/com.android.conscrypt/cacerts/` CAè¨¼æ˜æ›¸ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ã™ã¹ã¦ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼‰ãã—ã¦ã€é©åˆ‡ãªæ¨©é™ã¨SELinuxãƒ©ãƒ™ãƒ«ã‚’è¨­å®šã—ã¾ã™ã€‚
* ãã®å¾Œã€`nsenter`ã‚’ä½¿ç”¨ã—ã¦Zygoteã®ãƒã‚¦ãƒ³ãƒˆåå‰ç©ºé–“ã«å…¥ã‚Šã€ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’APEXãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ãƒã‚¤ãƒ³ãƒ‰ãƒã‚¦ãƒ³ãƒˆã—ã¾ã™ï¼š

```bash
nsenter --mount=/proc/$ZYGOTE_PID/ns/mnt -- \
/bin/mount --bind /system/etc/security/cacerts /apex/com.android.conscrypt/cacerts
```

Zygoteãƒ—ãƒ­ã‚»ã‚¹ã¯å„ã‚¢ãƒ—ãƒªã‚’ç”Ÿæˆã—ã€ãã®éš›ã«ãƒã‚¦ãƒ³ãƒˆåå‰ç©ºé–“ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹ãŸã‚ã€ã“ã‚Œã«ã‚ˆã‚Šæ–°ã—ãèµ·å‹•ã•ã‚Œã‚‹ã™ã¹ã¦ã®ã‚¢ãƒ—ãƒªï¼ˆã“ã‚Œã‹ã‚‰é–‹å§‹ã•ã‚Œã‚‹ã™ã¹ã¦ã®ã‚‚ã®ï¼‰ãŒã“ã‚Œã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚
* ãã®å¾Œã€`nsenter`ã‚’ä½¿ç”¨ã—ã¦æ—¢ã«å®Ÿè¡Œä¸­ã®å„ã‚¢ãƒ—ãƒªã®åå‰ç©ºé–“ã«å…¥ã‚Šã€åŒã˜ã“ã¨ã‚’è¡Œã„ã¾ã™ï¼š

```bash
nsenter --mount=/proc/$APP_PID/ns/mnt -- \
/bin/mount --bind /system/etc/security/cacerts /apex/com.android.conscrypt/cacerts
```

ä»£ã‚ã‚Šã«ã€UXãŒå°‘ã—ä¸ä¾¿ã§ã‚‚æ§‹ã‚ãªã„å ´åˆã¯ã€`init`è‡ªä½“ï¼ˆPID 1ï¼‰ã§ãƒã‚¤ãƒ³ãƒ‰ãƒã‚¦ãƒ³ãƒˆã‚’è¡Œã„ã€ãã®å¾Œ`stop && start`ã‚’å®Ÿè¡Œã—ã¦OSã‚’ã‚½ãƒ•ãƒˆãƒªãƒ–ãƒ¼ãƒˆã—ã€ã™ã¹ã¦ã®åå‰ç©ºé–“ã‚’å†ä½œæˆã—ã¦å¤‰æ›´ã‚’è‡³ã‚‹æ‰€ã«ä¼æ’­ã•ã›ã‚‹ã“ã¨ãŒã§ãã‚‹ã¯ãšã§ã™ï¼ˆãŸã ã—ã€ç§ã¯ä¸ä¾¿ãªãƒªãƒ–ãƒ¼ãƒˆã‚’æ°—ã«ã™ã‚‹ã®ã§ã€ãã®æ–¹æ³•ã¯å®Œå…¨ã«ç„¡è¦–ã—ã¦ã„ã¾ã™ï¼‰ã€‚

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼šç¤¾**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã«ã‚ãªãŸã®ä¼šç¤¾ã‚’åºƒå‘Šã—ãŸã„ã§ã™ã‹ï¼Ÿ** ã¾ãŸã¯ã€**æœ€æ–°ç‰ˆã®PEASSã‚’å…¥æ‰‹**ã—ãŸã‚Šã€**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç§ãŸã¡ã®ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ã”è¦§ãã ã•ã„ã€‚
* [**å…¬å¼ã®PEASS & HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* **[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã‚„[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã«**ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€**[**hacktricksãƒªãƒã‚¸ãƒˆãƒª**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª**](https://github.com/carlospolop/hacktricks-cloud) **ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>
