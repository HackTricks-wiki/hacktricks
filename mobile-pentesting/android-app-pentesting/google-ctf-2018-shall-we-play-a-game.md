# Google CTF 2018 - ã‚²ãƒ¼ãƒ ã‚’ã—ã¾ã—ã‚‡ã†ã‹ï¼Ÿ

<details>

<summary><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>ã§AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§å­¦ã¶</strong></a><strong>ï¼</strong></summary>

HackTricks ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•ï¼š

* **HackTricks ã§ä¼æ¥­ã‚’å®£ä¼ã—ãŸã„** ã¾ãŸã¯ **HackTricks ã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„** å ´åˆã¯ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASSï¼†HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã™ã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family) ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª [**NFTs**](https://opensea.io/collection/the-peass-family) ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¦‹ã¤ã‘ã‚‹
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f) ã«å‚åŠ ã™ã‚‹ã‹ã€[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass) ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live) ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€** [**HackTricks**](https://github.com/carlospolop/hacktricks) ã¨ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã™ã‚‹ã€‚

</details>

APKã¯ã“ã¡ã‚‰ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ï¼š

APKã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ã€APKã®å‹•ä½œã‚’ç¢ºèªã™ã‚‹ãŸã‚ã« [https://appetize.io/](https://appetize.io)ï¼ˆç„¡æ–™ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼‰ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹äºˆå®šã§ã™ï¼š

![](<../../.gitbook/assets/image (46).png>)

ãƒ•ãƒ©ã‚°ã‚’å–å¾—ã™ã‚‹ã«ã¯1000000å›å‹ã¤å¿…è¦ãŒã‚ã‚‹ã‚ˆã†ã§ã™ã€‚

[pentesting Android](./) ã®æ‰‹é †ã«å¾“ã£ã¦ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é€†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦smaliã‚³ãƒ¼ãƒ‰ã‚’å–å¾—ã—ã€jadxã‚’ä½¿ç”¨ã—ã¦Javaã‚³ãƒ¼ãƒ‰ã‚’èª­ã¿å–ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

Javaã‚³ãƒ¼ãƒ‰ã‚’èª­ã‚€ï¼š

![](<../../.gitbook/assets/image (47).png>)

ãƒ•ãƒ©ã‚°ã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°ã¯ **m().** ã®ã‚ˆã†ã§ã™ã€‚

## **Smaliã®å¤‰æ›´**

### **æœ€åˆã®m()ã®å‘¼ã³å‡ºã—**

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒ _this.o != 1000000_ ã®å ´åˆã«m()ã‚’å‘¼ã³å‡ºã™ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†ã€‚ãã®ãŸã‚ã«ã€æ¡ä»¶ã‚’å¤‰æ›´ã™ã‚‹ã ã‘ã§ã™ï¼š
```
if-ne v0, v9, :cond_2
```
```markdown
## Google CTF 2018: Shall we play a game?

### Challenge Description
The challenge is an Android APK where you have to play a game to get the flag. The game is a simple number-guessing game. You can input a number, and the app will tell you if the number is too high or too low. The goal is to guess the correct number to win the game and obtain the flag.

### Tools Used
- APKTool
- jadx
- Android Emulator

### Methodology
1. **Decompile the APK**: Use APKTool to decompile the APK file.
2. **Understand the Code**: Analyze the decompiled code using jadx to understand how the game logic works.
3. **Identify Vulnerabilities**: Look for any vulnerabilities in the code that can be exploited to cheat in the game.
4. **Modify the Code**: Make necessary changes to the code to make it easier to win the game.
5. **Recompile and Test**: Recompile the APK with the modified code and test it in an Android Emulator to see if the changes work.
6. **Retrieve the Flag**: Play the game with the modified APK to guess the correct number and obtain the flag.

### Conclusion
By analyzing and modifying the game logic in the Android APK, we were able to cheat and win the game to retrieve the flag.
```
```html
<hr>
<p style="text-align:center">This content is from a hacking book about hacking techniques.</p>
```
```
if-eq v0, v9, :cond_2
```
![Before](<../../.gitbook/assets/image (48).png>)

![After](<../../.gitbook/assets/image (49).png>)

[pentest Android](./)ã®æ‰‹é †ã«å¾“ã£ã¦APKã‚’å†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦ç½²åã—ã¾ã™ã€‚ãã®å¾Œã€[https://appetize.io/](https://appetize.io)ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ã€ä½•ãŒèµ·ã“ã‚‹ã‹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

![](<../../.gitbook/assets/image (50).png>)

ãƒ•ãƒ©ã‚°ãŒå®Œå…¨ã«å¾©å·åŒ–ã•ã‚Œãšã«æ›¸ã‹ã‚Œã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚ãŠãã‚‰ãm()é–¢æ•°ã‚’1000000å›å‘¼ã³å‡ºã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ã“ã‚Œã‚’è¡Œã†**åˆ¥ã®æ–¹æ³•**ã¯ã€å‘½ä»¤ã‚’å¤‰æ›´ã›ãšã«æ¯”è¼ƒã•ã‚Œã‚‹å‘½ä»¤ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã§ã™ï¼š

![](<../../.gitbook/assets/image (55).png>)

**åˆ¥ã®æ–¹æ³•**ã¯ã€1000000ã¨æ¯”è¼ƒã™ã‚‹ä»£ã‚ã‚Šã«ã€å€¤ã‚’1ã«è¨­å®šã—ã¦ã€this.oãŒ1ã¨æ¯”è¼ƒã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã§ã™ï¼š

![](<../../.gitbook/assets/image (57).png>)

å››ç•ªç›®ã®æ–¹æ³•ã¯ã€v9ï¼ˆ1000000ï¼‰ã®å€¤ã‚’v0ï¼ˆthis.oï¼‰ã«ç§»å‹•ã™ã‚‹å‘½ä»¤ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã™ï¼š

![](<../../.gitbook/assets/image (58).png>)

![](<../../.gitbook/assets/image (52).png>)

## è§£æ±ºç­–

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒæœ€åˆã«å‹åˆ©ã—ãŸã¨ãã«ãƒ«ãƒ¼ãƒ—ã‚’100000å›å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ã“ã‚Œã‚’è¡Œã†ã«ã¯ã€**:goto\_6**ãƒ«ãƒ¼ãƒ—ã‚’ä½œæˆã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒ`this.o`ã®å€¤ãŒ100000ã§ãªã„å ´åˆã«**ãã“ã«ã‚¸ãƒ£ãƒ³ãƒ—**ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™\:

![](<../../.gitbook/assets/image (59).png>)

ã“ã‚Œã¯ç‰©ç†ãƒ‡ãƒã‚¤ã‚¹å†…ã§è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ˆãªãœã‹ã¯ã‚ã‹ã‚Šã¾ã›ã‚“ï¼‰ä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹ã§ã¯æ©Ÿèƒ½ã—ã¾ã›ã‚“ã€‚

<details>

<summary><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰ã§AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§å­¦ã¶</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

* **HackTricksã§ä¼æ¥­ã‚’å®£ä¼ã—ãŸã„**ã¾ãŸã¯**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„**å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASSï¼†HackTricksã®ã‚¹ã‚¦ã‚©ãƒƒã‚°**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã—ã¦ãã ã•ã„
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[NFTs](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¦‹ã¤ã‘ã¾ã™
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ã‚’**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„ã€‚
* **HackTricks**ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ã€ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚

</details>
