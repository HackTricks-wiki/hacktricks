# Google CTF 2018 - Vamos jogar um jogo?

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* VocÃª trabalha em uma **empresa de seguranÃ§a cibernÃ©tica**? VocÃª quer ver sua **empresa anunciada no HackTricks**? ou quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe suas tÃ©cnicas de hacking enviando PRs para o** [**repositÃ³rio hacktricks**](https://github.com/carlospolop/hacktricks) **e para o** [**repositÃ³rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

Baixe o APK aqui:

Vou fazer o upload do APK para [https://appetize.io/](https://appetize.io) (conta gratuita) para ver como o apk estÃ¡ se comportando:

![](<../../.gitbook/assets/image (46).png>)

Parece que vocÃª precisa ganhar 1000000 vezes para obter a flag.

Seguindo os passos de [pentesting Android](./), vocÃª pode descompilar o aplicativo para obter o cÃ³digo smali e ler o cÃ³digo Java usando o jadx.

Lendo o cÃ³digo Java:

![](<../../.gitbook/assets/image (47).png>)

Parece que a funÃ§Ã£o que vai imprimir a flag Ã© **m().**

## **AlteraÃ§Ãµes no Smali**

### **Chamando m() pela primeira vez**

Vamos fazer o aplicativo chamar m() se a variÃ¡vel _this.o != 1000000_. Para fazer isso, basta mudar a condiÃ§Ã£o:
```
 if-ne v0, v9, :cond_2 
```
Sorry, I didn't understand your message. Could you please provide more information or clarify your request?
```
 if-eq v0, v9, :cond_2 
```
![Antes](<../../.gitbook/assets/image (48).png>)

![Depois](<../../.gitbook/assets/image (49).png>)

Siga os passos do [pentest Android](./) para recompilar e assinar o APK. Em seguida, faÃ§a o upload para [https://appetize.io/](https://appetize.io) e veja o que acontece:

![](<../../.gitbook/assets/image (50).png>)

Parece que a flag Ã© escrita sem ser completamente descriptografada. Provavelmente, a funÃ§Ã£o m() deveria ser chamada 1000000 vezes.

**Outra maneira** de fazer isso Ã© nÃ£o mudar a instruÃ§Ã£o, mas mudar as instruÃ§Ãµes comparadas:

![](<../../.gitbook/assets/image (55).png>)

**Outra maneira** Ã©, em vez de comparar com 1000000, definir o valor como 1 para que this.o seja comparado com 1:

![](<../../.gitbook/assets/image (57).png>)

Uma quarta maneira Ã© adicionar uma instruÃ§Ã£o para mover o valor de v9 (1000000) para v0 _(this.o)_:

![](<../../.gitbook/assets/image (58).png>)

![](<../../.gitbook/assets/image (52).png>)

## SoluÃ§Ã£o

FaÃ§a o aplicativo executar o loop 100000 vezes quando vocÃª ganhar pela primeira vez. Para fazer isso, vocÃª sÃ³ precisa criar o loop **:goto\_6** e fazer o aplicativo **pular lÃ¡ se \_this.o**\_\*\* nÃ£o tiver o valor 100000\*\*:

![](<../../.gitbook/assets/image (59).png>)

VocÃª precisa fazer isso em um dispositivo fÃ­sico, pois (nÃ£o sei por que) isso nÃ£o funciona em um dispositivo emulado.

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* VocÃª trabalha em uma **empresa de seguranÃ§a cibernÃ©tica**? VocÃª quer ver sua **empresa anunciada no HackTricks**? ou vocÃª quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Compartilhe suas tÃ©cnicas de hacking enviando PRs para o** [**repositÃ³rio hacktricks**](https://github.com/carlospolop/hacktricks) **e para o** [**repositÃ³rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
