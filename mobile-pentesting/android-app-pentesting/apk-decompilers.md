# Decompiladores de APK

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* VocÃª trabalha em uma **empresa de seguranÃ§a cibernÃ©tica**? VocÃª quer ver sua **empresa anunciada no HackTricks**? ou vocÃª quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe suas tÃ©cnicas de hacking enviando PRs para o** [**repositÃ³rio hacktricks**](https://github.com/carlospolop/hacktricks) **e para o** [**repositÃ³rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## [JD-Gui](https://github.com/java-decompiler/jd-gui)

O primeiro decompilador Java gui famoso, vocÃª pode usÃ¡-lo para investigar o cÃ³digo Java do APK depois de obtÃª-lo.

## [Jadx](https://github.com/skylot/jadx)

ConstruÃ­do em Java (multiplataforma) e neste momento acredito que seja o recomendado.\
Apenas **baixe** a **versÃ£o mais recente** e execute-a a partir da pasta _**bin**_:
```
jadx-gui
```
Usando a GUI, vocÃª pode realizar uma **busca de texto**, ir para as **definiÃ§Ãµes de funÃ§Ãµes** (_CTRL + clique esquerdo_ na funÃ§Ã£o) e referÃªncias cruzadas (_clique direito_ --> _Encontrar uso_)

Se vocÃª **sÃ³ quer** o **cÃ³digo java** mas sem usar uma GUI, uma maneira muito fÃ¡cil Ã© usar a ferramenta de linha de comando jadx:
```
jadx app.apk
```
Algumas **opÃ§Ãµes interessantes do jadx** (versÃµes GUI e CLI) sÃ£o:
```
-d <path to output dir>
--no-res #No resources
--no-src #No source code
--no-imports #Always write entire package name (very useful to know where is the function that you might want to hook)
```
## [GDA-android-reversing-Tool](https://github.com/charles2gan/GDA-android-reversing-Tool)

O GDA Ã© tambÃ©m uma plataforma poderosa e rÃ¡pida de anÃ¡lise reversa. Que nÃ£o sÃ³ suporta a operaÃ§Ã£o bÃ¡sica de decompilaÃ§Ã£o, mas tambÃ©m muitas funÃ§Ãµes excelentes como **DetecÃ§Ã£o de comportamento malicioso, DetecÃ§Ã£o de vazamento de privacidade, DetecÃ§Ã£o de vulnerabilidade, ResoluÃ§Ã£o de caminho, IdentificaÃ§Ã£o de empacotador, AnÃ¡lise de rastreamento de variÃ¡veis, Deobfuscation, Scripts Python e Java, ExtraÃ§Ã£o de memÃ³ria do dispositivo, DecodificaÃ§Ã£o e codificaÃ§Ã£o de dados** etc\*\*.\*\*

**Apenas para Windows.**

![](<../../.gitbook/assets/image (207) (1) (1).png>)

## [Bytecode-Viewer](https://github.com/Konloch/bytecode-viewer/releases)

Outra **ferramenta interessante para fazer uma anÃ¡lise estÃ¡tica Ã©**: [**bytecode-viewer**](https://github.com/Konloch/bytecode-viewer/releases)**.** Ele permite que vocÃª descompile o APK usando **vÃ¡rios descompiladores ao mesmo tempo**. EntÃ£o, vocÃª pode ver, por exemplo, 2 descompiladores Java diferentes e um descompilador Smali. Ele tambÃ©m permite que vocÃª **modifique** o cÃ³digo:

![](<../../.gitbook/assets/image (82).png>)

Se vocÃª modificar o cÃ³digo, entÃ£o vocÃª pode **exportÃ¡-lo**.\
Uma coisa ruim do bytecode-viewer Ã© que ele **nÃ£o tem referÃªncias** ou **referÃªncias cruzadas**.

## [**Enjarify**](https://github.com/Storyyeller/enjarify)

Enjarify Ã© uma ferramenta para traduzir o bytecode Dalvik em bytecode Java equivalente. Isso permite que as ferramentas de anÃ¡lise Java analisem aplicativos Android.\
Dex2jar Ã© uma ferramenta mais antiga que tambÃ©m tenta traduzir Dalvik para bytecode Java. Funciona razoavelmente bem na maioria das vezes, mas muitos recursos obscuros ou casos extremos farÃ£o com que ele falhe ou atÃ© mesmo produza resultados incorretos silenciosamente. Em contraste, o Enjarify Ã© projetado para funcionar em tantos casos quanto possÃ­vel, mesmo para cÃ³digo onde o Dex2jar falharia. Entre outras coisas, o Enjarify lida corretamente com nomes de classe Unicode, constantes usadas como vÃ¡rios tipos, conversÃµes implÃ­citas, manipuladores de exceÃ§Ã£o que saltam para o fluxo de controle normal, classes que referenciam muitas constantes, mÃ©todos muito longos, manipuladores de exceÃ§Ã£o apÃ³s um manipulador catchall e valores iniciais estÃ¡ticos do tipo errado.

## [CFR](https://github.com/leibnitz27/cfr)

CFR irÃ¡ descompilar recursos Java modernos - [incluindo grande parte do Java ](https://www.benf.org/other/cfr/java9observations.html)[9](https://github.com/leibnitz27/cfr/blob/master/java9stringconcat.html), [12](https://www.benf.org/other/cfr/switch\_expressions.html) & [14](https://www.benf.org/other/cfr/java14instanceof\_pattern), mas Ã© escrito inteiramente em Java 6, entÃ£o funcionarÃ¡ em qualquer lugar! ([FAQ](https://www.benf.org/other/cfr/faq.html)) - Ele atÃ© farÃ¡ um bom trabalho ao transformar arquivos de classe de outras linguagens JVM de volta para java!

Esse arquivo JAR pode ser usado da seguinte forma:
```
java -jar ./cfr.jar "$JARFILE" --outputdir "$OUTDIR"
```
Para arquivos JAR maiores, notei que a memÃ³ria pode acabar. Se isso acontecer com vocÃª, basta ajustar o tamanho do pool de alocaÃ§Ã£o de memÃ³ria do JVM.
```
java -Xmx4G -jar ./cfr.jar "$JARFILE" --outputdir "$OUTDIR"
```
Este exemplo permitirÃ¡ a alocaÃ§Ã£o mÃ¡xima de 4GB.

No diretÃ³rio de saÃ­da, vocÃª encontrarÃ¡ os arquivos `.java` descompilados, juntamente com um resumo da descompilaÃ§Ã£o.

## [Fernflower](https://github.com/JetBrains/intellij-community/tree/master/plugins/java-decompiler/engine)

Em seguida, temos o [Fernflower](https://github.com/JetBrains/intellij-community/tree/master/plugins/java-decompiler/engine), que faz parte do [IntelliJ IDEA](https://www.jetbrains.com/idea/). Todo mundo menciona que Ã© um descompilador _analÃ­tico_ (conforme declarado em sua descriÃ§Ã£o de projeto), mas ninguÃ©m aponta o que isso realmente significa. Eu sÃ³ encontrei [esta pergunta do Stackoverflow](https://stackoverflow.com/q/62298929), que infelizmente permanece sem resposta atÃ© hoje.

De qualquer forma, como nÃ£o hÃ¡ lanÃ§amentos autocontidos, vocÃª precisa construÃ­-lo sozinho. Como um projeto baseado em [Gradle](https://gradle.org), vocÃª pode clonÃ¡-lo e, em seguida, executar o seguinte comando, desde que o Gradle esteja instalado em sua mÃ¡quina.
```
cd ./plugins/java-decompiler/engine && gradle jar
```
Aqui, primeiro mudamos nosso diretÃ³rio de trabalho para o diretÃ³rio raiz do Fernflower. Em seguida, instruÃ­mos o Gradle a construir o arquivo `./build/libs/fernflower.jar`.

A invocaÃ§Ã£o do Fernflower Ã© semelhante Ã  do CFR.
```
java -jar ./fernflower.jar "$JARFILE" "$OUTDIR"
```
Entre os decompiladores descritos aqui, este Ã© o Ãºnico que gera arquivos `.java` em um arquivo JAR. VocÃª pode facilmente extrair os arquivos de origem usando o comando `unzip`.

## [Krakatau](https://github.com/Storyyeller/Krakatau)

Lembra do Enjarify acima? O mesmo autor Ã© tambÃ©m o desenvolvedor de um decompilador chamado [Krakatau](https://github.com/Storyyeller/Krakatau).

Em contraste com os outros projetos, este Ã© escrito em Python. E acredito que esta Ã© a razÃ£o pela qual ele Ã© um pouco diferente dos outros.

Deixe-me citar [o README do projeto](https://github.com/Storyyeller/Krakatau/blob/master/README.md).

> Em seguida, certifique-se de ter arquivos JAR contendo definiÃ§Ãµes para quaisquer classes externas (ou seja, bibliotecas) que possam ser referenciadas pelo JAR que vocÃª estÃ¡ tentando descompilar. Isso inclui as classes da biblioteca padrÃ£o (ou seja, JRT).

E de acordo com a descriÃ§Ã£o, essas classes da biblioteca padrÃ£o vÃªm com a versÃ£o 8 do Java na forma do arquivo `rt.jar`. Para versÃµes posteriores, o autor fornece o [jrt-extractor](https://github.com/Storyyeller/jrt-extractor), que pode gerar este arquivo para nÃ³s.

EntÃ£o, baixamos essa ferramenta e executamos os seguintes comandos.
```
cd ./jrt-extractor
javac JRTExtractor.java
java -ea JRTExtractor
```
Isso deveria ter escrito um arquivo `rt.jar` dentro do diretÃ³rio.

Com este arquivo, podemos executar o Krakatau da seguinte forma.
```
./Krakatau/decompile.py -out "$OUTDIR" -skip -nauto -path ./jrt-extractor/rt.jar "$JARFILE"
```
Deixe-me consultar o GitHub do projeto para uma explicaÃ§Ã£o dos parÃ¢metros. Apenas observe que, para qualquer biblioteca usada pelo seu arquivo JAR, o Krakatau exigirÃ¡ que vocÃª a adicione como um arquivo JAR para a flag `-path`.

## [procyon](https://github.com/mstrobel/procyon)

Uma vez instalado, o uso Ã© simples.
```
procyon -jar "$JARFILE" -o "$OUTDIR"
```
## ReferÃªncias

{% embed url="https://eiken.dev/blog/2021/02/how-to-break-your-jar-in-2021-decompilation-guide-for-jars-and-apks/#cfr" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* VocÃª trabalha em uma **empresa de seguranÃ§a cibernÃ©tica**? VocÃª quer ver sua **empresa anunciada no HackTricks**? ou vocÃª quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe suas tÃ©cnicas de hacking enviando PRs para o** [**repositÃ³rio hacktricks**](https://github.com/carlospolop/hacktricks) **e para o** [**repositÃ³rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
