# Decompiladores de APK

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Â¿Trabajas en una **empresa de ciberseguridad**? Â¿Quieres ver tu **empresa anunciada en HackTricks**? Â¿O quieres tener acceso a la **Ãºltima versiÃ³n de PEASS o descargar HackTricks en PDF**? Â¡Consulta los [**PLANES DE SUSCRIPCIÃ“N**](https://github.com/sponsors/carlospolop)!
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecciÃ³n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Consigue el [**swag oficial de PEASS y HackTricks**](https://peass.creator-spring.com)
* **Ãšnete al** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sÃ­gueme** en **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PR al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## [JD-Gui](https://github.com/java-decompiler/jd-gui)

El primer decompilador de Java con interfaz grÃ¡fica famoso, se puede utilizar para investigar el cÃ³digo Java del APK una vez que lo hayas obtenido.

## [Jadx](https://github.com/skylot/jadx)

Construido en Java (multiplataforma) y en este momento creo que es el recomendado.\
Solo **descarga** la **Ãºltima** versiÃ³n y ejecÃºtalo desde la carpeta _**bin**_:
```
jadx-gui
```
Usando la interfaz grÃ¡fica de usuario puedes realizar una **bÃºsqueda de texto**, ir a las **definiciones de funciones** (_CTRL + clic izquierdo_ en la funciÃ³n) y referencias cruzadas (_clic derecho_ --> _Buscar uso_)

Si **sÃ³lo quieres** el **cÃ³digo java** pero sin usar una interfaz grÃ¡fica, una forma muy sencilla es usar la herramienta de lÃ­nea de comandos jadx:
```
jadx app.apk
```
Algunas **opciones interesantes de jadx** (versiones GUI y CLI) son:
```
-d <path to output dir>
--no-res #No resources
--no-src #No source code
--no-imports #Always write entire package name (very useful to know where is the function that you might want to hook)
```
## [GDA-android-reversing-Tool](https://github.com/charles2gan/GDA-android-reversing-Tool)

GDA es tambiÃ©n una plataforma de anÃ¡lisis inverso rÃ¡pida y poderosa. No solo admite la operaciÃ³n bÃ¡sica de descompilaciÃ³n, sino tambiÃ©n muchas funciones excelentes como **detecciÃ³n de comportamiento malicioso, detecciÃ³n de fugas de privacidad, detecciÃ³n de vulnerabilidades, resoluciÃ³n de rutas, identificaciÃ³n de empaquetadores, anÃ¡lisis de seguimiento de variables, desofuscaciÃ³n, scripts de Python y Java, extracciÃ³n de memoria del dispositivo, cifrado y descifrado de datos**, etc.

**Solo para Windows.**

![](<../../.gitbook/assets/image (207) (1) (1).png>)

## [Bytecode-Viewer](https://github.com/Konloch/bytecode-viewer/releases)

Otra **herramienta interesante para realizar un anÃ¡lisis estÃ¡tico es**: [**bytecode-viewer**](https://github.com/Konloch/bytecode-viewer/releases)**.** Te permite descompilar el APK usando **varios descompiladores al mismo tiempo**. Luego, puedes ver, por ejemplo, 2 descompiladores de Java diferentes y un descompilador de Smali. TambiÃ©n te permite **modificar** el cÃ³digo:

![](<../../.gitbook/assets/image (82).png>)

Si modificas el cÃ³digo, entonces puedes **exportarlo**.\
Una mala cosa de bytecode-viewer es que **no tiene referencias** o **referencias cruzadas**.

## [**Enjarify**](https://github.com/Storyyeller/enjarify)

Enjarify es una herramienta para traducir el bytecode de Dalvik al bytecode de Java equivalente. Esto permite que las herramientas de anÃ¡lisis de Java analicen aplicaciones de Android.\
Dex2jar es una herramienta mÃ¡s antigua que tambiÃ©n intenta traducir Dalvik al bytecode de Java. Funciona razonablemente bien la mayor parte del tiempo, pero muchas caracterÃ­sticas oscuras o casos extremos harÃ¡n que falle o incluso produzca resultados incorrectos en silencio. En cambio, Enjarify estÃ¡ diseÃ±ado para funcionar en tantos casos como sea posible, incluso para el cÃ³digo donde Dex2jar fallarÃ­a. Entre otras cosas, Enjarify maneja correctamente los nombres de clase Unicode, las constantes utilizadas como mÃºltiples tipos, las conversiones implÃ­citas, los manejadores de excepciones que saltan al flujo de control normal, las clases que hacen referencia a demasiadas constantes, los mÃ©todos muy largos, los manejadores de excepciones despuÃ©s de un manejador de captura todo y los valores iniciales estÃ¡ticos del tipo incorrecto.

## [CFR](https://github.com/leibnitz27/cfr)

CFR descompilarÃ¡ las caracterÃ­sticas modernas de Java, [incluyendo gran parte de Java](https://www.benf.org/other/cfr/java9observations.html) [9](https://github.com/leibnitz27/cfr/blob/master/java9stringconcat.html), [12](https://www.benf.org/other/cfr/switch\_expressions.html) y [14](https://www.benf.org/other/cfr/java14instanceof\_pattern), pero estÃ¡ escrito completamente en Java 6, Â¡asÃ­ que funcionarÃ¡ en cualquier lugar! ([FAQ](https://www.benf.org/other/cfr/faq.html)) - Â¡Incluso harÃ¡ un buen trabajo convirtiendo archivos de clase de otros lenguajes JVM de vuelta a Java!

Ese archivo JAR se puede usar de la siguiente manera:
```
java -jar ./cfr.jar "$JARFILE" --outputdir "$OUTDIR"
```
Para archivos JAR mÃ¡s grandes, encontrÃ© que se quedaba sin memoria. Si eso tambiÃ©n te sucede, simplemente puedes adaptar el tamaÃ±o del pool de asignaciÃ³n de memoria de la JVM.
```
java -Xmx4G -jar ./cfr.jar "$JARFILE" --outputdir "$OUTDIR"
```
Este ejemplo permitirÃ¡ asignar un mÃ¡ximo de 4GB.

En el directorio de salida, encontrarÃ¡s los archivos `.java` descompilados, junto con un resumen de la descompilaciÃ³n.

## [Fernflower](https://github.com/JetBrains/intellij-community/tree/master/plugins/java-decompiler/engine)

A continuaciÃ³n, tenemos [Fernflower](https://github.com/JetBrains/intellij-community/tree/master/plugins/java-decompiler/engine), que forma parte de [IntelliJ IDEA](https://www.jetbrains.com/idea/). Todo el mundo menciona que es un descompilador _analÃ­tico_ (como se indica en su descripciÃ³n del proyecto), pero nadie seÃ±ala lo que esto realmente significa. Solo encontrÃ© [esta pregunta de Stackoverflow](https://stackoverflow.com/q/62298929), que lamentablemente sigue sin respuesta hasta hoy.

De todos modos, como no hay versiones autocontenidas, necesitas construirlo tÃº mismo. Como proyecto basado en [Gradle](https://gradle.org), puedes clonarlo y luego ejecutar el siguiente comando siempre y cuando Gradle estÃ© instalado en tu mÃ¡quina.
```
cd ./plugins/java-decompiler/engine && gradle jar
```
AquÃ­, primero cambiamos nuestro directorio de trabajo al directorio raÃ­z de Fernflower. Luego, instruimos a Gradle para que construya el archivo `./build/libs/fernflower.jar`.

La invocaciÃ³n de Fernflower es similar a la de CFR.
```
java -jar ./fernflower.jar "$JARFILE" "$OUTDIR"
```
Entre los descompiladores descritos aquÃ­, este es el Ãºnico que genera archivos `.java` en un archivo JAR. Puedes extraer fÃ¡cilmente los archivos fuente usando `unzip`.

## [Krakatau](https://github.com/Storyyeller/Krakatau)

Â¿Recuerdas Enjarify de arriba? El mismo autor es tambiÃ©n el desarrollador de un descompilador llamado [Krakatau](https://github.com/Storyyeller/Krakatau).

En contraste con los otros proyectos, este estÃ¡ escrito en Python. Y creo que esta es la razÃ³n por la que es un poco diferente de los demÃ¡s.

PermÃ­teme citar [el README del proyecto](https://github.com/Storyyeller/Krakatau/blob/master/README.md).

> A continuaciÃ³n, asegÃºrate de tener archivos JAR que contengan definiciones para cualquier clase externa (es decir, bibliotecas) que pueda ser referenciada por el archivo JAR que estÃ¡s intentando descompilar. Esto incluye las clases de la biblioteca estÃ¡ndar (es decir, JRT).

Y segÃºn la descripciÃ³n, estas clases de biblioteca estÃ¡ndar vienen con la versiÃ³n 8 de Java en forma del archivo `rt.jar`. Para versiones posteriores, el autor proporciona [jrt-extractor](https://github.com/Storyyeller/jrt-extractor), que puede generar este archivo para nosotros.

AsÃ­ que descargamos esa herramienta y ejecutamos los siguientes comandos.
```
cd ./jrt-extractor
javac JRTExtractor.java
java -ea JRTExtractor
```
Esto deberÃ­a haber escrito un archivo `rt.jar` dentro del directorio.

Dado este archivo, podemos ejecutar Krakatau de la siguiente manera.
```
./Krakatau/decompile.py -out "$OUTDIR" -skip -nauto -path ./jrt-extractor/rt.jar "$JARFILE"
```
PermÃ­teme referirme al GitHub del proyecto para una explicaciÃ³n de los parÃ¡metros. Solo ten en cuenta que para cualquier biblioteca utilizada por tu archivo JAR, Krakatau requerirÃ¡ que la agregues como un archivo JAR en la bandera `-path`.

## [procyon](https://github.com/mstrobel/procyon)

Una vez instalado, su uso es sencillo.
```
procyon -jar "$JARFILE" -o "$OUTDIR"
```
## Referencias

{% embed url="https://eiken.dev/blog/2021/02/how-to-break-your-jar-in-2021-decompilation-guide-for-jars-and-apks/#cfr" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Â¿Trabajas en una **empresa de ciberseguridad**? Â¿Quieres ver tu **empresa anunciada en HackTricks**? Â¿O quieres tener acceso a la **Ãºltima versiÃ³n de PEASS o descargar HackTricks en PDF**? Â¡Consulta los [**PLANES DE SUSCRIPCIÃ“N**](https://github.com/sponsors/carlospolop)!
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecciÃ³n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* ObtÃ©n la [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **Ãšnete al** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) **grupo de Discord** o al [**grupo de telegram**](https://t.me/peass) o **sÃ­gueme en** **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
