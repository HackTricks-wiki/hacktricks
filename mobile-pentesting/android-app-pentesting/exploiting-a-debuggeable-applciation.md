

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Do you work in a **cybersecurity company**? Do you want to see your **company advertised in HackTricks**? or do you want to have access to the **latest version of the PEASS or download HackTricks in PDF**? Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!

- Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)

- Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **Join the** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** me on **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Share your hacking tricks by submitting PRs to the [hacktricks repo](https://github.com/carlospolop/hacktricks) and [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


**Information copied from** [**https://resources.infosecinstitute.com/android-hacking-security-part-6-exploiting-debuggable-android-applications/#article**](https://resources.infosecinstitute.com/android-hacking-security-part-6-exploiting-debuggable-android-applications/#article)

To make this article more interesting, I have developed a vulnerable application for demonstration purposes, which has a â€œ**button**â€ and a â€œ**textview**â€œ.

Fill out the form below to download the code associated with this article.

If we launch the application, it shows the message â€œ**Crack Me**â€œ.

![](https://resources.infosecinstitute.com/wp-content/uploads/052314\_1204\_AndroidHack1.png)

Figure 1

If we click the button, it says â€œ**Try Again**â€œ. Now, our goal is to change the message â€œTry Againâ€ to â€œHackedâ€ without modifying the applicationâ€™s source code. To be precise, we have to change it at runtime.

## **Required tools**

* Emulator
* adb â€“ Android Debug Bridge
* jdb â€“ Java Debugger

In my case, to make the installations easier, I am using Android Tamer since all the above required tools are pre-installed.

## **Topics Involved**

* Checking for Vulnerability.
* Getting Ready with the Setup.
* Runtime Code Injection.

Letâ€™s begin the game.

## **Checking for vulnerability**

In fact, this is the easiest part of the entire article.

* Decompile the application using APKTOOL to get the AndroidManifest.xml file using the following command.

apktool d \<vulnerableapp>.apk

* Inspect Androidmanifest.xml file for the following line.

android\_debuggable=â€trueâ€

If you find the above line in the AndroidManifest.xml file, the application is debuggable and it can be exploited.

**Note:** We used APKTOOL to see whether the app is debuggable or not. We wonâ€™t touch or modify any piece of code as mentioned earlier.

## **Getting ready with the setup**

In this step, we will set up all the required things to inject code in to the app during its execution. As mentioned in the previous article, we will use remote debugging in this article.

* Start Your Emulator
* Install the vulnerable application
* Open up your terminal and run the following command to see the Dalvik VM ports listening on the emulator.

_**adb jdwp**_

The above command displays all the ports on which we can connect and debug as shown below.

![](https://resources.infosecinstitute.com/wp-content/uploads/052314\_1204\_AndroidHack2.png)

Figure 2

**Note:** JDWP stands for Java Debug Wire Protocol. If an application running in its VM is debuggable, it exposes a unique port on which we can connect to it using JDB. This is possible in Dalvik Virtual Machines with the support of JDWP.

* Now, launch our target application and run the same command to see the listening port associated with our target application. It looks as shown below.

![](https://resources.infosecinstitute.com/wp-content/uploads/052314\_1204\_AndroidHack3.png)

Figure 2

If we observe the difference between Figure 2 and Figure 3, there is one extra port 543 listening after launching the target application in Figure 3. We will attach JDB to the application using this port, since this is our target.

* Before attaching to the application, we need to port forward using adb since we are using remote debugging. This is shown in Figure 4.

![](https://resources.infosecinstitute.com/wp-content/uploads/052314\_1204\_AndroidHack4.png)

Figure 4

* Now, letâ€™s attach JDB to the application as shown in the following figure.

![](https://resources.infosecinstitute.com/wp-content/uploads/052314\_1204\_AndroidHack5.png)

Figure 5

## **Runtime code injection**

In this step, we will actually exploit the vulnerable application by modifying its behavior at runtime.

To modify the applicationâ€™s behavior at runtime, we need to set up breakpoints and control the flow. But, we donâ€™t know what classes and methods are used in the application. So, letâ€™s use the following commands to find out the classes and methods used in the application.

To find the classes: â€œ**classes**â€

![](https://resources.infosecinstitute.com/wp-content/uploads/052314\_1204\_AndroidHack6.png)

Figure 6.1

Since I have too many classes listed, I am listing only a few classes. But if you still scroll down, you will see some interesting user defined classes as shown in the figure below.

![](https://resources.infosecinstitute.com/wp-content/uploads/052314\_1204\_AndroidHack7.png)

Figure 6.2

Now, let us see the methods associated with MainActivity$1 class using the following command.

â€œ_**methods com.example.debug.MainActivity$1**_â€

This is shown in figure 7.

![](https://resources.infosecinstitute.com/wp-content/uploads/052314\_1204\_AndroidHack8.png)

Figure 7

Now, letâ€™s set up a breakpoint at onClick method and control the execution of the app as shown in Figure 8.

_**â€œstop in com.example.debug.MainActivity$1.onClick(android.view.View)â€**_

![](https://resources.infosecinstitute.com/wp-content/uploads/052314\_1204\_AndroidHack9.png)

Figure 8

To hit the breakpoint, we will have to manually click the button in the application. Once after clicking the button, the breakpoint will be hit and it appears as shown in Figure 9.

![](https://resources.infosecinstitute.com/wp-content/uploads/052314\_1204\_AndroidHack10.png)

Figure 9

From here onwards, we will be able to control and see the sensitive values, method arguments, etc. using various commands.

Just to understand whatâ€™s happening in the background, I am following the code associated with the onClick method, which is shown in Figure 10.

![](https://resources.infosecinstitute.com/wp-content/uploads/052314\_1204\_AndroidHack11.png)

Figure 10

Before proceeding further, letâ€™s see if there are any local variables at this point in time using the command â€œ**locals**â€œ.

![](https://resources.infosecinstitute.com/wp-content/uploads/052314\_1204\_AndroidHack12.png)

Figure 11

As we can see, there is no interesting information for us.

So, letâ€™s execute the next line using the â€œ**next**â€ command as shown below.

![](https://resources.infosecinstitute.com/wp-content/uploads/052314\_1204\_AndroidHack13.png)

Figure 12

Letâ€™s again try executing the command â€œ**locals**â€ to see what happened in the previous command.

![](https://resources.infosecinstitute.com/wp-content/uploads/052314\_1204\_AndroidHack14.png)

Figure 13

Itâ€™s pretty clear that TextView has been loaded into method arguments. If we look at the source code provided in Figure 10, the line associated with TextView instantiation has been executed.

Letâ€™s now execute the next lines by executing the â€œ**next**â€ command, and check the local variables as shown in the figure below.

![](https://resources.infosecinstitute.com/wp-content/uploads/052314\_1204\_AndroidHack15.png)

Figure 14

As we can see, all the local variables have been displayed. The string â€œ**secret**â€ looks interesting. The value â€œTry Againâ€ is what is going to be printed when we click the button.

From Figure 10, it is very clear that the method **setText** is getting executed to print the value â€œ**Try Again**â€œ. So, letâ€™s use the â€œ**step**â€ command to get into the definition of the â€œ**setText**â€ method and dynamically modify the text to be printed.

![](https://resources.infosecinstitute.com/wp-content/uploads/052314\_1204\_AndroidHack16.png)

Figure 15

Letâ€™s see the local variables inside the definition using â€œ**locals**â€œ.

![](https://resources.infosecinstitute.com/wp-content/uploads/052314\_1204\_AndroidHack17.png)

Figure 16

Now, letâ€™s change the value of â€œ**text**â€ from â€œ**Try Again**â€ to â€œ**Hacked**â€ using â€œ**set**â€ command.

![](https://resources.infosecinstitute.com/wp-content/uploads/052314\_1204\_AndroidHack18.png)

Figure 17

We cannot see any changes in the application, since we havenâ€™t executed the modified code.

So, letâ€™s run the application using the â€œ**run**â€ command as shown below, and see the applicationâ€™s output on its screen.

![](https://resources.infosecinstitute.com/wp-content/uploads/052314\_1204\_AndroidHack19.png)

Figure 18

Letâ€™s look at the application running in the emulator.

![](https://resources.infosecinstitute.com/wp-content/uploads/052314\_1204\_AndroidHack20.png)

Figure 19

We have successfully modified the output of the application at runtime. This is just an example to show how an applicationâ€™s behavior can be modified if the application is debuggable. We can perform various other things including â€œ**Getting a shell**â€ on the device in the context of the vulnerable application.


<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Do you work in a **cybersecurity company**? Do you want to see your **company advertised in HackTricks**? or do you want to have access to the **latest version of the PEASS or download HackTricks in PDF**? Check the [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)!

- Discover [**The PEASS Family**](https://opensea.io/collection/the-peass-family), our collection of exclusive [**NFTs**](https://opensea.io/collection/the-peass-family)

- Get the [**official PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **Join the** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** me on **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Share your hacking tricks by submitting PRs to the [hacktricks repo](https://github.com/carlospolop/hacktricks) and [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


