# ãƒ©ãƒ¼ã‚¸ãƒ“ãƒ³æ”»æ’ƒ

<details>

<summary><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>ã§AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§å­¦ã¶</strong></a><strong>ï¼</strong></summary>

HackTricks ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

* **HackTricks ã§ä¼æ¥­ã‚’å®£ä¼ã—ãŸã„** ã¾ãŸã¯ **HackTricks ã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„** å ´åˆã¯ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASSï¼†HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã™ã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª [**NFTs**](https://opensea.io/collection/the-peass-family) ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¦‹ã¤ã‘ã‚‹
* **ğŸ’¬ [Discordã‚°ãƒ«ãƒ¼ãƒ—](https://discord.gg/hRep4RUj7f)** ã«å‚åŠ ã™ã‚‹ã‹ã€[telegramã‚°ãƒ«ãƒ¼ãƒ—](https://t.me/peass) ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹**
* **ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«** [**HackTricks**](https://github.com/carlospolop/hacktricks) ã¨ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ã®githubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã™ã‚‹

</details>

## åŸºæœ¬æƒ…å ±

ãƒ©ãƒ¼ã‚¸ãƒ“ãƒ³ã¨ã¯ä½•ã‹ã«ã¤ã„ã¦ã®è©³ç´°æƒ…å ±ã¯ã€æ¬¡ã®ãƒšãƒ¼ã‚¸ã‚’å‚ç…§ã—ã¦ãã ã•ã„:

{% content-ref url="bins-and-memory-allocations.md" %}
[bins-and-memory-allocations.md](bins-and-memory-allocations.md)
{% endcontent-ref %}

[**how2heap - large bin attack**](https://github.com/shellphish/how2heap/blob/master/glibc\_2.35/large\_bin\_attack.c) ã«ç´ æ™´ã‚‰ã—ã„ä¾‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã™ã€‚

åŸºæœ¬çš„ã«ã€æœ€æ–°ã®ã€Œç¾åœ¨ã®ã€glibcï¼ˆ2.35ï¼‰ã§ã¯ã€**`P->bk_nextsize`** ãŒãƒã‚§ãƒƒã‚¯ã•ã‚Œã¦ã„ãªã„ãŸã‚ã€ç‰¹å®šã®æ¡ä»¶ãŒæº€ãŸã•ã‚Œã‚‹ã¨å¤§ããªãƒ“ãƒ³ãƒãƒ£ãƒ³ã‚¯ã®å€¤ã§ä»»æ„ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å¤‰æ›´ã§ãã¾ã™ã€‚

ãã®ä¾‹ã§ã¯ã€æ¬¡ã®æ¡ä»¶ãŒè¦‹ã¤ã‹ã‚Šã¾ã™:

* å¤§ããªãƒãƒ£ãƒ³ã‚¯ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹
* æœ€åˆã®ãƒãƒ£ãƒ³ã‚¯ã‚ˆã‚Šã‚‚å°ã•ã„ãŒåŒã˜ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«ã‚ã‚‹å¤§ããªãƒãƒ£ãƒ³ã‚¯ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹
* ãƒ“ãƒ³å†…ã§æœ€åˆã«è¡Œãå¿…è¦ãŒã‚ã‚‹ãŸã‚ã€ãã‚Œã‚ˆã‚Šã‚‚å°ã•ããªã‘ã‚Œã°ãªã‚‰ãªã„
* ï¼ˆãƒˆãƒƒãƒ—ãƒãƒ£ãƒ³ã‚¯ã¨ã®ãƒãƒ¼ã‚¸ã‚’é˜²ããƒãƒ£ãƒ³ã‚¯ãŒä½œæˆã•ã‚Œã‚‹ï¼‰
* æ¬¡ã«ã€æœ€åˆã®å¤§ããªãƒãƒ£ãƒ³ã‚¯ãŒè§£æ”¾ã•ã‚Œã€ãã‚Œã‚ˆã‚Šã‚‚å¤§ããªæ–°ã—ã„ãƒãƒ£ãƒ³ã‚¯ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ -> ãƒãƒ£ãƒ³ã‚¯1ã¯ãƒ©ãƒ¼ã‚¸ãƒ“ãƒ³ã«ç§»å‹•
* æ¬¡ã«ã€2ç•ªç›®ã®å¤§ããªãƒãƒ£ãƒ³ã‚¯ãŒè§£æ”¾ã•ã‚Œã‚‹
* ãã—ã¦ã€è„†å¼±æ€§: æ”»æ’ƒè€…ã¯ `chunk1->bk_nextsize` ã‚’ `[target-0x20]` ã«å¤‰æ›´ã§ãã‚‹
* æ¬¡ã«ã€ãƒãƒ£ãƒ³ã‚¯2ã‚ˆã‚Šã‚‚å¤§ããªãƒãƒ£ãƒ³ã‚¯ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã‚‹ã¨ã€ãƒãƒ£ãƒ³ã‚¯2ãŒãƒ©ãƒ¼ã‚¸ãƒ“ãƒ³ã«æŒ¿å…¥ã•ã‚Œã€ã‚¢ãƒ‰ãƒ¬ã‚¹ `chunk1->bk_nextsize->fd_nextsize` ãŒãƒãƒ£ãƒ³ã‚¯2ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ä¸Šæ›¸ãã•ã‚Œã¾ã™

{% hint style="success" %}
ä»–ã®æ½œåœ¨çš„ãªã‚·ãƒŠãƒªã‚ªãŒã‚ã‚Šã¾ã™ãŒã€é‡è¦ãªã®ã¯ã€ãƒ“ãƒ³ã«ç¾åœ¨ã®Xãƒãƒ£ãƒ³ã‚¯ã‚ˆã‚Šã‚‚**å°ã•ã„**ãƒãƒ£ãƒ³ã‚¯ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã™ã€‚ãã®ãŸã‚ã«ã¯ã€ãƒ“ãƒ³å†…ã§ãã‚Œã‚ˆã‚Šã‚‚å‰ã«æŒ¿å…¥ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€Xã® **`bk_nextsize`** ã‚’å¤‰æ›´ã§ãã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãã‚ŒãŒå°ã•ãªãƒãƒ£ãƒ³ã‚¯ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ›¸ãè¾¼ã¾ã‚Œã‚‹å ´æ‰€ã§ã™ã€‚
{% endhint %}

ã“ã‚Œã¯mallocã‹ã‚‰ã®é–¢é€£ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã§ã™ã€‚ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒã©ã®ã‚ˆã†ã«ä¸Šæ›¸ãã•ã‚ŒãŸã‹ã‚’ã‚ˆã‚Šã‚ˆãç†è§£ã™ã‚‹ãŸã‚ã«ã‚³ãƒ¡ãƒ³ãƒˆãŒè¿½åŠ ã•ã‚Œã¦ã„ã¾ã™:

{% code overflow="wrap" %}
```c
/* if smaller than smallest, bypass loop below */
assert (chunk_main_arena (bck->bk));
if ((unsigned long) (size) < (unsigned long) chunksize_nomask (bck->bk))
{
fwd = bck; // fwd = p1
bck = bck->bk; // bck = p1->bk

victim->fd_nextsize = fwd->fd; // p2->fd_nextsize = p1->fd (Note that p1->fd is p1 as it's the only chunk)
victim->bk_nextsize = fwd->fd->bk_nextsize; // p2->bk_nextsize = p1->fd->bk_nextsize
fwd->fd->bk_nextsize = victim->bk_nextsize->fd_nextsize = victim; // p1->fd->bk_nextsize->fd_nextsize = p2
}
```
{% endcode %}

ã“ã‚Œã¯ã€`global_max_fast`ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã‚’ä¸Šæ›¸ãã—ã¦ã€ã‚ˆã‚Šå¤§ããªãƒãƒ£ãƒ³ã‚¯ã§é«˜é€Ÿãƒ“ãƒ³ã‚¢ã‚¿ãƒƒã‚¯ã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã¾ã™ã€‚

ã“ã®æ”»æ’ƒã®åˆ¥ã®ç´ æ™´ã‚‰ã—ã„èª¬æ˜ã¯ã€[**guyinatuxedo**](https://guyinatuxedo.github.io/32-largebin\_attack/largebin\_explanation0/index.html)ã§è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

<details>

<summary><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong>ã‚’ä½¿ç”¨ã—ã¦ã€ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã³ã¾ã—ã‚‡ã†</summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•ï¼š

* **HackTricksã§ä¼æ¥­ã‚’å®£ä¼ã—ãŸã„**å ´åˆã‚„**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã—ã¦ãã ã•ã„
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[NFTs](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã«å‚åŠ ã™ã‚‹ã‹ã€[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€[**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>
