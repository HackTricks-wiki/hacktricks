# WWW2Exec - \_\_malloc\_hook

<details>

<summary><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>ã‚’é€šã˜ã¦ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã¶</strong></a><strong>ï¼</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•ï¼š

* **HackTricksã§ä¼æ¥­ã‚’å®£ä¼ã—ãŸã„**ã¾ãŸã¯**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„å ´åˆã¯**[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASSï¼†HackTricksã‚¹ã‚¦ã‚§ã‚°**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã™ã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ã”è¦§ãã ã•ã„
* **ğŸ’¬ [Discordã‚°ãƒ«ãƒ¼ãƒ—](https://discord.gg/hRep4RUj7f)**ã«å‚åŠ ã™ã‚‹ã‹ã€[telegramã‚°ãƒ«ãƒ¼ãƒ—](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã™ã‚‹ï¼š[**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€**[**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>

## **Malloc Hook**

[å…¬å¼GNUã‚µã‚¤ãƒˆ](https://www.gnu.org/software/libc/manual/html\_node/Hooks-for-Malloc.html)ã«ã‚ˆã‚‹ã¨ã€å¤‰æ•°**`__malloc_hook`**ã¯ã€`malloc()`ãŒå‘¼ã³å‡ºã•ã‚Œã‚‹ãŸã³ã«**å‘¼ã³å‡ºã•ã‚Œã‚‹é–¢æ•°ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŒ‡ã™ãƒã‚¤ãƒ³ã‚¿**ã§ã‚ã‚Šã€**libcãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒ‡ãƒ¼ã‚¿ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«æ ¼ç´ã•ã‚Œã¦ã„ã¾ã™**ã€‚ã—ãŸãŒã£ã¦ã€ã“ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒä¾‹ãˆã°**One Gadget**ã§ä¸Šæ›¸ãã•ã‚Œã€`malloc`ãŒå‘¼ã³å‡ºã•ã‚Œã‚‹ã¨ã€**One GadgetãŒå‘¼ã³å‡ºã•ã‚Œã¾ã™**ã€‚

mallocã‚’å‘¼ã³å‡ºã™ã«ã¯ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒãã‚Œã‚’å‘¼ã³å‡ºã™ã®ã‚’å¾…ã¤ã‹ã€**`printf("%10000$c")`ã‚’å‘¼ã³å‡ºã™**ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€`libc`ãŒå¤šãã®ãƒã‚¤ãƒˆã‚’å‰²ã‚Šå½“ã¦ã€ãã‚Œã‚‰ã‚’ãƒ’ãƒ¼ãƒ—ã«å‰²ã‚Šå½“ã¦ã‚‹ã‚ˆã†ã«`malloc`ãŒå‘¼ã³å‡ºã•ã‚Œã¾ã™ã€‚

One Gadgetã«é–¢ã™ã‚‹è©³ç´°æƒ…å ±ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ï¼š

{% content-ref url="../rop-return-oriented-programing/ret2lib/one-gadget.md" %}
[one-gadget.md](../rop-return-oriented-programing/ret2lib/one-gadget.md)
{% endcontent-ref %}

{% hint style="warning" %}
ãƒ•ãƒƒã‚¯ã¯**GLIBC >= 2.34**ã§ã¯**ç„¡åŠ¹**ã«ãªã£ã¦ã„ã¾ã™ã€‚æœ€æ–°ã®GLIBCãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯ä»–ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ãŒä½¿ç”¨ã§ãã¾ã™ã€‚å‚ç…§ï¼š[https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md](https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md)ã€‚
{% endhint %}

## References

* [https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook](https://ir0nstone.gitbook.io/notes/types/stack/one-gadgets-and-malloc-hook)
* [https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md](https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md).

<details>

<summary><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>ã‚’é€šã˜ã¦ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã¶</strong></a><strong>ï¼</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•ï¼š

* **HackTricksã§ä¼æ¥­ã‚’å®£ä¼ã—ãŸã„**ã¾ãŸã¯**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„å ´åˆã¯**[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASSï¼†HackTricksã‚¹ã‚¦ã‚§ã‚°**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã™ã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ã”è¦§ãã ã•ã„
* **ğŸ’¬ [Discordã‚°ãƒ«ãƒ¼ãƒ—](https://discord.gg/hRep4RUj7f)**ã«å‚åŠ ã™ã‚‹ã‹ã€[telegramã‚°ãƒ«ãƒ¼ãƒ—](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã™ã‚‹ï¼š[**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€**[**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>
