# SuplantaciÃ³n de dispositivos SSDP y UPnP con EvilSSDP

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> - <a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Â¿Trabajas en una **empresa de ciberseguridad**? Â¿Quieres que tu **empresa sea anunciada en HackTricks**? Â¿O quieres tener acceso a la **Ãºltima versiÃ³n de PEASS o descargar HackTricks en PDF**? Â¡Consulta los [**PLANES DE SUSCRIPCIÃ“N**](https://github.com/sponsors/carlospolop)!
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecciÃ³n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* ObtÃ©n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **Ãšnete al** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) **grupo de Discord**](https://discord.gg/hRep4RUj7f) o al **grupo de telegram**](https://t.me/peass) o **sÃ­gueme** en **Twitter** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Comparte tus trucos de hacking enviando PRs al [repositorio de hacktricks](https://github.com/carlospolop/hacktricks) y al [repositorio de hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

**Consulta [https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/](https://www.hackingarticles.in/evil-ssdp-spoofing-the-ssdp-and-upnp-devices/) para obtener mÃ¡s informaciÃ³n.**

## **VisiÃ³n general de SSDP y UPnP**

SSDP (Protocolo de Descubrimiento de Servicios Simples) se utiliza para la publicidad y descubrimiento de servicios de red, funcionando en el puerto UDP 1900 sin necesidad de configuraciones de DHCP o DNS. Es fundamental en la arquitectura de UPnP (Universal Plug and Play), facilitando la interacciÃ³n sin problemas entre dispositivos en red como PC, impresoras y dispositivos mÃ³viles. La red de configuraciÃ³n cero de UPnP admite el descubrimiento de dispositivos, la asignaciÃ³n de direcciones IP y la publicidad de servicios.

## **Flujo y Estructura de UPnP**

La arquitectura de UPnP consta de seis capas: direccionamiento, descubrimiento, descripciÃ³n, control, eventos y presentaciÃ³n. Inicialmente, los dispositivos intentan obtener una direcciÃ³n IP o asignarse una automÃ¡ticamente (AutoIP). La fase de descubrimiento implica el SSDP, con dispositivos enviando activamente solicitudes M-SEARCH o transmitiendo pasivamente mensajes NOTIFY para anunciar servicios. La capa de control, vital para la interacciÃ³n cliente-dispositivo, utiliza mensajes SOAP para la ejecuciÃ³n de comandos basados en descripciones de dispositivos en archivos XML.

## **VisiÃ³n general de IGD y herramientas**

IGD (Dispositivo de Puerta de Enlace a Internet) facilita mapeos temporales de puertos en configuraciones NAT, permitiendo la aceptaciÃ³n de comandos a travÃ©s de puntos de control SOAP abiertos a pesar de las restricciones estÃ¡ndar de la interfaz WAN. Herramientas como **Miranda** ayudan en el descubrimiento de servicios UPnP y la ejecuciÃ³n de comandos. **Umap** expone comandos UPnP accesibles desde WAN, mientras que repositorios como **upnp-arsenal** ofrecen una variedad de herramientas UPnP. **Evil SSDP** se especializa en phishing a travÃ©s de dispositivos UPnP falsificados, alojando plantillas para imitar servicios legÃ­timos.

## **Uso prÃ¡ctico de Evil SSDP**

Evil SSDP crea de manera efectiva dispositivos UPnP falsos convincentes, manipulando a los usuarios para que interactÃºen con servicios aparentemente autÃ©nticos. Los usuarios, engaÃ±ados por la apariencia genuina, pueden proporcionar informaciÃ³n sensible como credenciales. La versatilidad de la herramienta se extiende a varias plantillas, imitando servicios como escÃ¡neres, Office365 e incluso bÃ³vedas de contraseÃ±as, aprovechando la confianza del usuario y la visibilidad de la red. DespuÃ©s de capturar credenciales, los atacantes pueden redirigir a las vÃ­ctimas a URL designadas, manteniendo la credibilidad del engaÃ±o.

## **Estrategias de mitigaciÃ³n**

Para combatir estas amenazas, se recomiendan medidas como:

- Desactivar UPnP en dispositivos cuando no sea necesario.
- Educar a los usuarios sobre el phishing y la seguridad de la red.
- Monitorear el trÃ¡fico de red en busca de datos sensibles no encriptados.

En esencia, si bien UPnP ofrece conveniencia y fluidez en la red, tambiÃ©n abre puertas a posibles explotaciones. La conciencia y la defensa proactiva son clave para garantizar la integridad de la red. 

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> - <a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Â¿Trabajas en una **empresa de ciberseguridad**? Â¿Quieres que tu **empresa sea anunciada en HackTricks**? Â¿O quieres tener acceso a la **Ãºltima versiÃ³n de PEASS o descargar HackTricks en PDF**? Â¡Consulta los [**PLANES DE SUSCRIPCIÃ“N**](https://github.com/sponsors/carlospolop)!
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecciÃ³n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* ObtÃ©n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **Ãšnete al** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) **grupo de Discord**](https://discord.gg/hRep4RUj7f) o al **grupo de telegram**](https://t.me/peass) o **sÃ­gueme** en **Twitter** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Comparte tus trucos de hacking enviando PRs al [repositorio de hacktricks](https://github.com/carlospolop/hacktricks) y al [repositorio de hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
