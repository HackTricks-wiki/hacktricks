<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- VocÃª trabalha em uma **empresa de seguranÃ§a cibernÃ©tica**? VocÃª quer ver sua **empresa anunciada no HackTricks**? ou vocÃª quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!

- Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)

- **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Compartilhe suas tÃ©cnicas de hacking enviando PRs para o [repositÃ³rio hacktricks](https://github.com/carlospolop/hacktricks) e [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


# Teoria bÃ¡sica do IPv6

## Redes

Em um endereÃ§o IPv6, os **primeiros 48 bits sÃ£o o prefixo de rede**. Os **prÃ³ximos 16 bits sÃ£o o ID da sub-rede** e sÃ£o usados para definir sub-redes. Os Ãºltimos **64 bits sÃ£o o identificador de interface** (tambÃ©m conhecido como ID de interface ou ID de dispositivo, Ã© para dispositivos). Se necessÃ¡rio, os bits normalmente reservados para o ID do dispositivo podem ser usados para mascaramento adicional de sub-rede.

NÃ£o hÃ¡ ARP no IPv6. Em vez disso, hÃ¡ **ICMPv6 NS (Neighbor Solicitation) e NA (Neighbor Advertisement)**. O **NS** Ã© usado para resolver um endereÃ§o, entÃ£o ele envia pacotes **multicast**. O **NA** Ã© **unicast** e Ã© usado para responder ao NS. Um pacote NA tambÃ©m pode ser enviado sem a necessidade de um pacote NS.

**0:0:0:0:0:0:0:1** = 1 (`::1` para abreviar) - Este Ã© o equivalente a 127.0.0.1 no IPv4.

**EndereÃ§os Link-local:** Estes sÃ£o endereÃ§os privados que nÃ£o devem ser roteados na internet. Eles podem ser usados localmente por LANs privadas ou temporÃ¡rias para compartilhamento e distribuiÃ§Ã£o de arquivos entre dispositivos na LAN. Outros dispositivos em sua LAN local que usam esse tipo de endereÃ§o podem ser encontrados enviando um ping para o endereÃ§o multicast ff02::01\
**FE80::/10** - Faixa de endereÃ§o unicast local de link.
```bash
ping6 â€“I eth0 -c 5 ff02::1 > /dev/null 2>&1
ip neigh | grep ^fe80

#Or you could also use
alive6 eth0
```
Se vocÃª **sabe o endereÃ§o MAC de um host na mesma rede** que vocÃª (vocÃª pode simplesmente pingar o endereÃ§o ipv4 dele e visualizar a tabela arp para encontrar o endereÃ§o MAC), vocÃª pode calcular o endereÃ§o Link-local dele para se comunicar com ele.\
Suponha que o **endereÃ§o MAC** seja **`12:34:56:78:9a:bc`**

1. Para notaÃ§Ã£o IPv6: **`1234:5678:9abc`**
2. Adicione `fe80::` no inÃ­cio e insira `fffe` no meio: **`fe80::`**`1234:56`**`ff:fe`**`78:9abc`
3. Inverta o sÃ©timo bit da esquerda, de 0001 0010 para 0001 0000: `fe80::1`**`0`**`34:56ff:fe78:9abc`
4. `fe80::1034:56ff:fe78:9abc`

**EndereÃ§o local Ãºnico:** Este tipo de endereÃ§o ipv6 tambÃ©m nÃ£o Ã© destinado a ser roteado na internet pÃºblica. O local Ãºnico Ã© uma substituiÃ§Ã£o do endereÃ§o de site local, que permite a comunicaÃ§Ã£o dentro de um site enquanto Ã© roteÃ¡vel para vÃ¡rias redes locais.\
**FEC00::/7**  â€“ O intervalo de endereÃ§os locais Ãºnicos.

**EndereÃ§o Multicast:** Isso tambÃ©m pode ser referido como Um-para-Muitos. Pacotes endereÃ§ados ao endereÃ§o multicast sÃ£o entregues a todas as interfaces identificadas pelo endereÃ§o multicast. Os tipos de endereÃ§o multicast sÃ£o facilmente notÃ¡veis porque normalmente comeÃ§am com FF.\
**FF00::/8**  â€“ O intervalo de endereÃ§os multicast.

**Anycast:** Esta forma de endereÃ§o ipv6 Ã© semelhante ao endereÃ§o multicast com uma pequena diferenÃ§a. O endereÃ§o anycast tambÃ©m pode ser referido como Um para o Mais PrÃ³ximo. Ele pode ser usado para endereÃ§ar pacotes destinados a vÃ¡rias interfaces; mas geralmente envia pacotes para a primeira interface que encontra, conforme definido na distÃ¢ncia de roteamento. Isso significa que ele envia pacotes para a interface mais prÃ³xima, conforme determinado pelos protocolos de roteamento.\
**20000::/3**  â€“ O intervalo de endereÃ§os unicast global.

fe80::/10--> Link-Local Ãšnico (169.254.x.x) \[fe80:0000:0000:0000:0000:0000:0000:0000,febf:ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff]\
fc00::/7 --> Local-unicast Ãºnico (10.x.x.x, 172.16.x.x, 192.168.x.x) \[]\
2000::/3 --> Unicast Global\
ff02::1 --> Multicast Todos os NÃ³s\
ff02::2 --> Multicast NÃ³s do Roteador

## **Adivinhe o IPv6 de uma mÃ¡quina**

**Forma 1**

Os endereÃ§os IPv6 de fe80::/10 sÃ£o baseados no MAC. Se vocÃª tem o IPv6 de um dispositivo dentro de uma rede e deseja adivinhar o IPv6 de outro dispositivo da rede, pode obter seu endereÃ§o MAC usando um ping (dentro da tabela arp).

**Forma 2**

VocÃª pode enviar um ping6 para o multicast e obter o endereÃ§o IPv6 dentro da tabela arp.
```bash
service ufw stop #Stop firewall
ping6 -I <IFACE> ff02::1 #You could also make: ping6 -I <IPV6> ff02::1 if you want to make a ping to a specific IP Address
ip -6 neigh
alive6
use auxiliary/scanner/discovery/ipv6_neighbor_router_advertisement; set INTERFACE eth1; run
```
# IPv6 MitM

Homem no meio com anÃºncio de vizinho ICMPv6 falsificado.

* Homem no meio com anÃºncio de roteador ICMPv6 falsificado.
* Homem no meio usando redirecionamento ICMPv6 ou ICMPv6 muito grande para implantar rota.
* Homem no meio para atacar o IPv6 mÃ³vel, mas requer que o ipsec seja desativado.
* Homem no meio com servidor DHCPv6 falso.

# Descobrindo endereÃ§os IPv6 na rede

## SubdomÃ­nios

VocÃª pode usar o Google e outros navegadores para procurar subdomÃ­nios como "ipv6.\*"
```bash
site:ipv6./
```
## DNS

TambÃ©m Ã© possÃ­vel tentar procurar por endereÃ§os IPv6 usando "**AXFR**" (transferÃªncia de zona), "**AAAA**" (IPv6) ou atÃ© mesmo "**ANY**" (todos) registros no DNS.

## Ping6

Uma vez que alguns dispositivos IPv6 de uma organizaÃ§Ã£o tenham sido encontrados, vocÃª pode tentar usar o `ping6` para verificar endereÃ§os prÃ³ximos.

# ReferÃªncias

* [http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html](http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html)
* [https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904](https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904)


<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- VocÃª trabalha em uma **empresa de seguranÃ§a cibernÃ©tica**? VocÃª quer ver sua **empresa anunciada no HackTricks**? ou vocÃª quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!

- Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)

- **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Compartilhe suas tÃ©cnicas de hacking enviando PRs para o [repositÃ³rio hacktricks](https://github.com/carlospolop/hacktricks) e [hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
