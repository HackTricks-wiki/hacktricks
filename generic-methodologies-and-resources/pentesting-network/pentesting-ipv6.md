# TeorÃ­a bÃ¡sica de IPv6

## Redes

En una direcciÃ³n IPv6, los **primeros 48 bits son el prefijo de red**. Los **siguientes 16 bits son el ID de subred** y se utilizan para definir subredes. Los Ãºltimos **64 bits son el identificador de interfaz** (tambiÃ©n conocido como ID de interfaz o ID de dispositivo, es para dispositivos). Si es necesario, los bits que normalmente estÃ¡n reservados para el ID de dispositivo se pueden utilizar para una mÃ¡scara de subred adicional.

No hay ARP en IPv6. En su lugar, hay **ICMPv6 NS (Solicitud de vecino) y NA (Anuncio de vecino)**. El **NS** se utiliza para resolver una direcciÃ³n, por lo que envÃ­a paquetes **multidifusiÃ³n**. El **NA** es **unicast** y se utiliza para responder al NS. Un paquete NA tambiÃ©n se puede enviar sin necesidad de un paquete NS.

**0:0:0:0:0:0:0:1** = 1 (`::1` para abreviar) - Esto es equivalente a 127.0.0.1 en IPv4.

**Direcciones de enlace local:** Estas son direcciones privadas que no estÃ¡n destinadas a ser enrutadas en Internet. Pueden ser utilizadas localmente por LAN privadas o temporales para compartir y distribuir archivos entre dispositivos en la LAN. Otros dispositivos en su LAN local que utilizan este tipo de direcciones se pueden encontrar enviando un ping a la direcciÃ³n multicast ff02::01\
**FE80::/10** - Rango de direcciÃ³n unicast de enlace local.
```bash
ping6 â€“I eth0 -c 5 ff02::1 > /dev/null 2>&1
ip neigh | grep ^fe80

#Or you could also use
alive6 eth0
```
Si **conoces la direcciÃ³n MAC de un host en la misma red** que tÃº (puedes simplemente hacer ping a su direcciÃ³n IPv4 y ver la tabla ARP para encontrar su direcciÃ³n MAC), puedes calcular su direcciÃ³n de enlace local para comunicarte con Ã©l.\
Supongamos que la **direcciÃ³n MAC** es **`12:34:56:78:9a:bc`**

1. En notaciÃ³n IPv6: **`1234:5678:9abc`**
2. Agrega `fe80::` al principio e inserta `fffe` en el medio: **`fe80::`**`1234:56`**`ff:fe`**`78:9abc`
3. Invierte el sÃ©ptimo bit desde la izquierda, de 0001 0010 a 0001 0000: `fe80::1`**`0`**`34:56ff:fe78:9abc`
4. `fe80::1034:56ff:fe78:9abc`

**DirecciÃ³n local Ãºnica:** Este tipo de direcciÃ³n IPv6 tampoco estÃ¡ destinado a ser enrutado en Internet pÃºblico. La direcciÃ³n local Ãºnica es un reemplazo de la direcciÃ³n de sitio local, que permite la comunicaciÃ³n dentro de un sitio mientras es enrutable a mÃºltiples redes locales.\
**FEC00::/7**  â€“ El rango de direcciÃ³n local Ãºnica.

**DirecciÃ³n multicast:** TambiÃ©n se puede referir como Uno-a-Muchos. Los paquetes dirigidos a una direcciÃ³n multicast se entregan a todas las interfaces identificadas por la direcciÃ³n multicast. Los tipos de direcciÃ³n multicast son fÃ¡cilmente identificables porque normalmente comienzan con FF.\
**FF00::/8**  â€“ El rango multicast.

**Anycast:** Esta forma de direcciÃ³n IPv6 es similar a la direcciÃ³n multicast con una ligera diferencia. La direcciÃ³n anycast tambiÃ©n se puede referir como Uno a MÃ¡s Cercano. Se puede utilizar para dirigir paquetes a mÃºltiples interfaces; pero normalmente envÃ­a paquetes a la primera interfaz que encuentra segÃºn lo definido en la distancia de enrutamiento. Esto significa que envÃ­a paquetes a la interfaz mÃ¡s cercana determinada por los protocolos de enrutamiento.\
**20000::/3**  â€“ El rango de direcciÃ³n unicast global.

fe80::/10--> Enlace local Ãºnico (169.254.x.x) \[fe80:0000:0000:0000:0000:0000:0000:0000,febf:ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff]\
fc00::/7 --> Local-unicast Ãºnico (10.x.x.x, 172.16.x.x, 192.168.x.x) \[]\
2000::/3 --> Unicast global\
ff02::1 --> Multicast Todos los nodos\
ff02::2 --> Multicast Nodos de enrutador

## **Adivina la direcciÃ³n IPv6 de una mÃ¡quina**

**Forma 1**

Las direcciones IPv6 de fe80::/10 se basan en la MAC. Si tienes la direcciÃ³n IPv6 de un dispositivo dentro de una red y quieres adivinar la direcciÃ³n IPv6 de otro dispositivo de la red, puedes obtener su direcciÃ³n MAC usando un ping (dentro de la tabla ARP).

**Forma 2**

Puedes enviar un ping6 al multicast y obtener la direcciÃ³n IPv6 dentro de la tabla ARP.
```bash
service ufw stop #Stop firewall
ping6 -I <IFACE> ff02::1 #You could also make: ping6 -I <IPV6> ff02::1 if you want to make a ping to a specific IP Address
ip -6 neigh
alive6
use auxiliary/scanner/discovery/ipv6_neighbor_router_advertisement; set INTERFACE eth1; run
```
# IPv6 MitM

Hombre en el medio con anuncio de vecino ICMPv6 falsificado.

* Hombre en el medio con anuncio de router ICMPv6 falsificado.
* Hombre en el medio usando redirecciÃ³n ICMPv6 o ICMPv6 demasiado grande para implantar ruta.
* Hombre en el medio para atacar IPv6 mÃ³vil pero requiere que ipsec estÃ© deshabilitado.
* Hombre en el medio con servidor DHCPv6 falso.

# Descubriendo direcciones IPv6 en la red

## Subdominios

Puedes usar Google y otros navegadores para buscar subdominios como "ipv6.\*"
```bash
site:ipv6./
```
## DNS

TambiÃ©n se puede intentar buscar direcciones IPv6 utilizando "**AXFR**" (transferencia de zona), "**AAAA**" (IPv6) o incluso "**ANY**" (todos) en el registro DNS.

## Ping6

Una vez que se han encontrado algunos dispositivos IPv6 de una organizaciÃ³n, se puede intentar usar `ping6` para verificar las direcciones cercanas.

# Referencias

* [http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html](http://www.firewall.cx/networking-topics/protocols/877-ipv6-subnetting-how-to-subnet-ipv6.html)
* [https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904](https://www.sans.org/reading-room/whitepapers/detection/complete-guide-ipv6-attack-defense-33904)


<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Â¿Trabajas en una **empresa de ciberseguridad**? Â¿Quieres ver tu **empresa anunciada en HackTricks**? Â¿O quieres tener acceso a la **Ãºltima versiÃ³n de PEASS o descargar HackTricks en PDF**? Â¡Consulta los [**PLANES DE SUSCRIPCIÃ“N**](https://github.com/sponsors/carlospolop)!

- Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecciÃ³n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- ObtÃ©n el [**swag oficial de PEASS y HackTricks**](https://peass.creator-spring.com)

- **Ãšnete al** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sÃ­gueme** en **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Comparte tus trucos de hacking enviando PR al [repositorio de hacktricks](https://github.com/carlospolop/hacktricks) y al [repositorio de hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
