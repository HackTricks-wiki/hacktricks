# Lateral VLAN Segmentation Bypass

<details>

<summary><strong>ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ã¦ã¿ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®PEASSã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†ã€‚ç‹¬å çš„ãª[NFTs](https://opensea.io/collection/the-peass-family)ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚
* [**å…¬å¼PEASSï¼†HackTricksã‚¹ã‚¦ã‚§ã‚°**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* **[ğŸ’¬](https://emojipedia.org/speech-balloon/) [Discordã‚°ãƒ«ãƒ¼ãƒ—](https://discord.gg/hRep4RUj7f)ã«å‚åŠ ã™ã‚‹ã‹ã€[telegramã‚°ãƒ«ãƒ¼ãƒ—](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€ã¾ãŸã¯**Twitter**ã§**ç§ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„** ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[hacktricksãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks)ã¨[hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks-cloud)ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>

ã‚¹ã‚¤ãƒƒãƒã¸ã®ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ãŒå¯èƒ½ãªå ´åˆã€VLANã‚»ã‚°ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒã‚¤ãƒ‘ã‚¹ã§ãã¾ã™ã€‚ã“ã‚Œã«ã¯ã€æ¥ç¶šã•ã‚ŒãŸãƒãƒ¼ãƒˆã‚’ãƒˆãƒ©ãƒ³ã‚¯ãƒ¢ãƒ¼ãƒ‰ã«å†æ§‹æˆã—ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆVLANç”¨ã®ä»®æƒ³ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ç¢ºç«‹ã—ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å‹•çš„ã«ï¼ˆDHCPï¼‰ã¾ãŸã¯é™çš„ã«è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã‚·ãƒŠãƒªã‚ªã«å¿œã˜ã¦ï¼ˆ**è©³ç´°ã«ã¤ã„ã¦ã¯[https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼‰**ã€‚

ã¾ãšã€ç‰¹å®šã®æ¥ç¶šãƒãƒ¼ãƒˆã®è­˜åˆ¥ãŒå¿…è¦ã§ã™ã€‚ã“ã‚Œã¯é€šå¸¸ã€CDPãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä»‹ã—ã¦é”æˆã§ãã¾ã™ã€‚ã¾ãŸã¯ã€**include**ãƒã‚¹ã‚¯ã‚’ä½¿ç”¨ã—ã¦ãƒãƒ¼ãƒˆã‚’æ¤œç´¢ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã‚‚é”æˆã§ãã¾ã™ã€‚

**CDPãŒå‹•ä½œã—ã¦ã„ãªã„å ´åˆã€MACã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ¤œç´¢ã—ã¦ãƒãƒ¼ãƒˆã‚’ç‰¹å®šã§ãã¾ã™**:
```
SW1(config)# show mac address-table | include 0050.0000.0500
```
äº‹å‰ã«ãƒˆãƒ©ãƒ³ã‚¯ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆã‚‹å‰ã«ã€æ—¢å­˜ã®VLANã®ãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã€ãã‚Œã‚‰ã®è­˜åˆ¥å­ã‚’æ±ºå®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ ã“ã‚Œã‚‰ã®è­˜åˆ¥å­ã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã€ãƒˆãƒ©ãƒ³ã‚¯ã‚’ä»‹ã—ã¦ã•ã¾ã–ã¾ãªVLANã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ ãŸã¨ãˆã°ã€ä½¿ç”¨ä¸­ã®ãƒãƒ¼ãƒˆã¯VLAN 10ã«é–¢é€£ä»˜ã‘ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚
```
SW1# show vlan brief
```
**ãƒˆãƒ©ãƒ³ã‚¯ãƒ¢ãƒ¼ãƒ‰ã¸ã®ç§»è¡Œã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹æ§‹æˆãƒ¢ãƒ¼ãƒ‰ã«å…¥ã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™**:
```
SW1(config)# interface GigabitEthernet 0/2
SW1(config-if)# switchport trunk encapsulation dot1q
SW1(config-if)# switchport mode trunk
```
ã‚¹ã‚¤ãƒƒãƒã‚’ãƒˆãƒ©ãƒ³ã‚¯ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆã‚‹ã¨ã€ä¸€æ™‚çš„ã«æ¥ç¶šãŒä¸­æ–­ã•ã‚Œã¾ã™ãŒã€ãã®å¾Œã«å¾©å…ƒã§ãã¾ã™ã€‚

ä»®æƒ³ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒä½œæˆã•ã‚Œã€VLAN IDãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã€ã‚¢ã‚¯ãƒ†ã‚£ãƒ–åŒ–ã•ã‚Œã¾ã™ï¼š
```bash
sudo vconfig add eth0 10
sudo vconfig add eth0 20
sudo vconfig add eth0 50
sudo vconfig add eth0 60
sudo ifconfig eth0.10 up
sudo ifconfig eth0.20 up
sudo ifconfig eth0.50 up
sudo ifconfig eth0.60 up
```
ãã®å¾Œã€DHCPã‚’ä»‹ã—ã¦ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒè¡Œã‚ã‚Œã¾ã™ã€‚DHCPãŒé©ç”¨ã§ããªã„å ´åˆã¯ã€ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ‰‹å‹•ã§è¨­å®šã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚
```bash
sudo dhclient -v eth0.10
sudo dhclient -v eth0.20
sudo dhclient -v eth0.50
sudo dhclient -v eth0.60
```
ä»¥ä¸‹ã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆVLAN 10ï¼‰ã«é™çš„IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ‰‹å‹•ã§è¨­å®šã™ã‚‹ä¾‹ã§ã™ï¼š
```bash
sudo ifconfig eth0.10 10.10.10.66 netmask 255.255.255.0
```
Connectivity is tested by initiating ICMP requests to the default gateways for VLANs 10, 20, 50, and 60.

Ultimately, this process enables bypassing of VLAN segmentation, thereby facilitating unrestricted access to any VLAN network, and setting the stage for subsequent actions.

## References

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)

<details>

<summary><strong>ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§ã®AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¦‹ã¤ã‘ã¾ã™
* [**å…¬å¼PEASSï¼†HackTricksã‚¹ã‚¦ã‚©ãƒƒã‚°**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã™
* **[ğŸ’¬](https://emojipedia.org/speech-balloon/) Discordã‚°ãƒ«ãƒ¼ãƒ—**ã«**å‚åŠ **ã™ã‚‹ã‹ã€[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter**ã§ç§ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹ğŸ¦[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€[hacktricksãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks)ã¨[hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks-cloud)**ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>
