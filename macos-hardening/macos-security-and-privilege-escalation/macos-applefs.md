# macOS AppleFS

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®PEASSã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†ã€ç§ãŸã¡ã®ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³
* [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€PRã‚’** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>

## Apple Propietary File System (APFS)

APFSã€ã¾ãŸã¯Apple File Systemã¯ã€Apple Inc.ã«ã‚ˆã£ã¦é–‹ç™ºã•ã‚ŒãŸç¾ä»£çš„ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã§ã€å¤ã„Hierarchical File System Plus (HFS+)ã‚’ç½®ãæ›ãˆã‚‹ãŸã‚ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚APFSã¯**ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã€åŠ¹ç‡ã®å‘ä¸Š**ã‚’é‡è¦–ã—ã¦ã„ã¾ã™ã€‚

APFSã®ã„ãã¤ã‹ã®æ³¨ç›®ã™ã¹ãç‰¹å¾´ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ï¼š

1. **ã‚¹ãƒšãƒ¼ã‚¹å…±æœ‰**ï¼šAPFSã¯ã€è¤‡æ•°ã®ãƒœãƒªãƒ¥ãƒ¼ãƒ ãŒå˜ä¸€ã®ç‰©ç†ãƒ‡ãƒã‚¤ã‚¹ä¸Šã®**åŒã˜åŸºç¤ã®ç©ºãã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’å…±æœ‰**ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒœãƒªãƒ¥ãƒ¼ãƒ ã¯æ‰‹å‹•ã§ã®ãƒªã‚µã‚¤ã‚ºã‚„å†ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ‹ãƒ³ã‚°ã®å¿…è¦ãªãã€å‹•çš„ã«æˆé•·ãŠã‚ˆã³ç¸®å°ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
1. ã“ã‚Œã¯ã€APFSã§ã¯ç•°ãªã‚‹ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ï¼ˆãƒœãƒªãƒ¥ãƒ¼ãƒ ï¼‰ãŒãƒ‡ã‚£ã‚¹ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã‚’å…±æœ‰ã™ã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ãŒã€é€šå¸¸ã®ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã¯å›ºå®šã‚µã‚¤ã‚ºã‚’æŒã£ã¦ã„ã¾ã—ãŸã€‚
2. **ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ**ï¼šAPFSã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®**èª­ã¿å–ã‚Šå°‚ç”¨**ã®ç‰¹å®šæ™‚ç‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ã‚ã‚‹ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã®ä½œæˆã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã¯ã€è¿½åŠ ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’æœ€å°é™ã«æ¶ˆè²»ã—ã€è¿…é€Ÿã«ä½œæˆã¾ãŸã¯å…ƒã«æˆ»ã™ã“ã¨ãŒã§ãã‚‹ãŸã‚ã€åŠ¹ç‡çš„ãªãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚
3. **ã‚¯ãƒ­ãƒ¼ãƒ³**ï¼šAPFSã¯ã€ã‚ªãƒªã‚¸ãƒŠãƒ«ã¨åŒã˜ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’å…±æœ‰ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã¾ãŸã¯ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³ã‚’ä½œæˆã§ãã¾ã™ã€‚ã“ã®æ©Ÿèƒ½ã«ã‚ˆã‚Šã€ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚¹ãƒšãƒ¼ã‚¹ã‚’è¤‡è£½ã›ãšã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã‚³ãƒ”ãƒ¼ã‚’åŠ¹ç‡çš„ã«ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
4. **æš—å·åŒ–**ï¼šAPFSã¯ã€ãƒ•ãƒ«ãƒ‡ã‚£ã‚¹ã‚¯æš—å·åŒ–ã ã‘ã§ãªãã€ãƒ•ã‚¡ã‚¤ãƒ«ã”ã¨ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã”ã¨ã®æš—å·åŒ–ã‚‚**ãƒã‚¤ãƒ†ã‚£ãƒ–ã§ã‚µãƒãƒ¼ãƒˆ**ã—ã¦ãŠã‚Šã€ã•ã¾ã–ã¾ãªãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã§ãƒ‡ãƒ¼ã‚¿ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’å‘ä¸Šã•ã›ã¾ã™ã€‚
5. **ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ä¿è­·**ï¼šAPFSã¯ã€ã‚³ãƒ”ãƒ¼ãƒ»ã‚ªãƒ³ãƒ»ãƒ©ã‚¤ãƒˆã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚¹ã‚­ãƒ¼ãƒ ã‚’ä½¿ç”¨ã—ã¦ã€çªç„¶ã®åœé›»ã‚„ã‚·ã‚¹ãƒ†ãƒ ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã®å ´åˆã§ã‚‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®æ•´åˆæ€§ã‚’ç¢ºä¿ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ‡ãƒ¼ã‚¿ã®ç ´æã®ãƒªã‚¹ã‚¯ã‚’æ¸›ã‚‰ã—ã¾ã™ã€‚

å…¨ä½“çš„ã«ã€APFSã¯Appleãƒ‡ãƒã‚¤ã‚¹ã«å¯¾ã—ã¦ã‚ˆã‚Šç¾ä»£çš„ã§æŸ”è»Ÿã‹ã¤åŠ¹ç‡çš„ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‚’æä¾›ã—ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã€ä¿¡é ¼æ€§ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å‘ä¸Šã«é‡ç‚¹ã‚’ç½®ã„ã¦ã„ã¾ã™ã€‚
```bash
diskutil list # Get overview of the APFS volumes
```
## Firmlinks

`Data`ãƒœãƒªãƒ¥ãƒ¼ãƒ ã¯**`/System/Volumes/Data`**ã«ãƒã‚¦ãƒ³ãƒˆã•ã‚Œã¦ã„ã¾ã™ï¼ˆ`diskutil apfs list`ã§ç¢ºèªã§ãã¾ã™ï¼‰ã€‚

ãƒ•ã‚¡ãƒ¼ãƒ ãƒªãƒ³ã‚¯ã®ãƒªã‚¹ãƒˆã¯**`/usr/share/firmlinks`**ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚ã‚Šã¾ã™ã€‚
```bash
cat /usr/share/firmlinks
/AppleInternal	AppleInternal
/Applications	Applications
/Library	Library
[...]
```
**å·¦å´**ã«ã¯**ã‚·ã‚¹ãƒ†ãƒ ãƒœãƒªãƒ¥ãƒ¼ãƒ **ä¸Šã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ‘ã‚¹ãŒã‚ã‚Šã€**å³å´**ã«ã¯**ãƒ‡ãƒ¼ã‚¿ãƒœãƒªãƒ¥ãƒ¼ãƒ **ä¸Šã§ã®ãƒãƒƒãƒ”ãƒ³ã‚°ã•ã‚ŒãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ‘ã‚¹ãŒã‚ã‚Šã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€`/library` --> `/system/Volumes/data/library`
