# 53 - Pentesting DNS

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* ¬øTrabajas en una **empresa de ciberseguridad**? ¬øQuieres ver tu **empresa anunciada en HackTricks**? ¬øO quieres tener acceso a la **√∫ltima versi√≥n de PEASS o descargar HackTricks en PDF**? ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obt√©n el [**swag oficial de PEASS y HackTricks**](https://peass.creator-spring.com)
* **√önete al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="../.gitbook/assets/image (1) (1) (2) (4).png" alt=""><figcaption></figcaption></figure>

[**DragonJAR Security Conference es un evento internacional de ciberseguridad**](https://www.dragonjarcon.org/) con m√°s de una d√©cada que se celebrar√° el 7 y 8 de septiembre de 2023 en Bogot√°, Colombia. Es un evento de gran contenido t√©cnico donde se presentan las √∫ltimas investigaciones en espa√±ol que atrae a hackers e investigadores de todo el mundo.\
¬°Reg√≠strate ahora en el siguiente enlace y no te pierdas esta gran conferencia!:

{% embed url="https://www.dragonjarcon.org/" %}

## **Informaci√≥n b√°sica**

El Sistema de Nombres de Dominio (DNS) es la gu√≠a telef√≥nica de Internet. Los humanos acceden a la informaci√≥n en l√≠nea a trav√©s de nombres de dominio, como nytimes.com o espn.com. Los navegadores web interact√∫an a trav√©s de direcciones de Protocolo de Internet (IP). DNS traduce los nombres de dominio a [direcciones IP](https://www.cloudflare.com/learning/dns/glossary/what-is-my-ip-address/) para que los navegadores puedan cargar recursos de Internet.\
Desde [aqu√≠](https://www.cloudflare.com/learning/dns/what-is-dns/).

**Puerto predeterminado:** 53
```
PORT     STATE SERVICE  REASON
53/tcp   open  domain  Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)
5353/udp open  zeroconf udp-response
53/udp   open  domain  Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)
```
### Diferentes Servidores DNS

Informaci√≥n de [https://academy.hackthebox.com/module/112/section/1069](https://academy.hackthebox.com/module/112/section/1069)

| **Tipo de Servidor**           | **Descripci√≥n**                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| ------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `Servidor Ra√≠z DNS`            | Los servidores ra√≠z del DNS son responsables de los dominios de nivel superior (`TLD`). Como √∫ltima instancia, solo se solicitan si el servidor de nombres no responde. Por lo tanto, un servidor ra√≠z es una interfaz central entre los usuarios y el contenido en Internet, ya que vincula el dominio y la direcci√≥n IP. La [Corporaci√≥n de Internet para la Asignaci√≥n de Nombres y N√∫meros](https://www.icann.org/) (`ICANN`) coordina el trabajo de los servidores ra√≠z. Hay `13` servidores ra√≠z en todo el mundo. |
| `Servidor de Nombres Autoritativo`     | Los servidores de nombres autoritativos tienen autoridad sobre una zona en particular. Solo responden consultas de su √°rea de responsabilidad y su informaci√≥n es vinculante. Si un servidor de nombres autoritativo no puede responder a la consulta de un cliente, el servidor de nombres ra√≠z se hace cargo en ese momento.                                                                                                                                                                                                            |
| `Servidor de Nombres No Autoritativo` | Los servidores de nombres no autoritativos no son responsables de una zona DNS en particular. En cambio, recopilan informaci√≥n sobre zonas DNS espec√≠ficas ellos mismos, lo cual se hace mediante consultas DNS recursivas o iterativas.                                                                                                                                                                                                                                                                               |
| `Servidor de Cach√© DNS`           | Los servidores de cach√© DNS almacenan en cach√© informaci√≥n de otros servidores de nombres durante un per√≠odo especificado. La duraci√≥n de este almacenamiento la determina el servidor de nombres autoritativo.                                                                                                                                                                                                                                                                                                                             |
| `Servidor de Reenv√≠o`            | Los servidores de reenv√≠o solo realizan una funci√≥n: reenv√≠an consultas DNS a otro servidor DNS.                                                                                                                                                                                                                                                                                                                                                                                            |
| `Resolver`                     | Los resolutores no son servidores DNS autoritativos, pero realizan la resoluci√≥n de nombres localmente en la computadora o en el enrutador.                                                                                                                                                                                                                                                                                                                                                                               |

## Enumeraci√≥n

### **Obtenci√≥n de Banners**

DNS no tiene un "banner" para obtener. Lo m√°s parecido es una consulta m√°gica para `version.bind. CHAOS TXT`, que funcionar√° en la mayor√≠a de los servidores BIND.\
Puedes realizar esta consulta usando `dig`:
```bash
dig version.bind CHAOS TXT @DNS
```
Si eso no funciona, puedes utilizar t√©cnicas de fingerprinting para determinar la versi√≥n del servidor remoto -- la herramienta [`fpdns`](https://github.com/kirei/fpdns) es una opci√≥n para eso, pero hay otras.

Tambi√©n puedes obtener el banner con un script de **nmap**:
```
--script dns-nsid
```
### **Cualquier registro**

El registro **ANY** solicitar√° al servidor DNS que **devuelva** todas las **entradas** disponibles que **est√© dispuesto a revelar**.
```bash
dig any victim.com @<DNS_IP>
```
### **Transferencia de Zona**

Este procedimiento se abrevia como `Transferencia de Zona Asincr√≥nica Completa` (`AXFR`).
```bash
dig axfr @<DNS_IP> #Try zone transfer without domain
dig axfr @<DNS_IP> <DOMAIN> #Try zone transfer guessing the domain
fierce --domain <DOMAIN> --dns-servers <DNS_IP> #Will try toperform a zone transfer against every authoritative name server and if this doesn'twork, will launch a dictionary attack
```
### M√°s informaci√≥n
```bash
dig ANY @<DNS_IP> <DOMAIN>     #Any information
dig A @<DNS_IP> <DOMAIN>       #Regular DNS request
dig AAAA @<DNS_IP> <DOMAIN>    #IPv6 DNS request
dig TXT @<DNS_IP> <DOMAIN>     #Information
dig MX @<DNS_IP> <DOMAIN>      #Emails related
dig NS @<DNS_IP> <DOMAIN>      #DNS that resolves that name
dig -x 192.168.0.2 @<DNS_IP>   #Reverse lookup
dig -x 2a00:1450:400c:c06::93 @<DNS_IP> #reverse IPv6 lookup

#Use [-p PORT]  or  -6 (to use ivp6 address of dns)
```
#### Automatizaci√≥n

Automatizaci√≥n es el proceso de realizar tareas de forma autom√°tica, sin intervenci√≥n humana. En el contexto de la pentesting de servicios de red, la automatizaci√≥n puede ser utilizada para realizar pruebas de penetraci√≥n en los servicios DNS.

#### Escaneo de DNS

El escaneo de DNS es una t√©cnica utilizada para descubrir informaci√≥n sobre los servidores DNS de un objetivo. Esto puede incluir la identificaci√≥n de servidores DNS autorizados, registros de zona, registros de recursos y otros detalles relacionados con la configuraci√≥n del DNS.

#### Enumeraci√≥n de DNS

La enumeraci√≥n de DNS es el proceso de recopilar informaci√≥n sobre los registros DNS de un objetivo. Esto puede incluir la obtenci√≥n de registros de zona, registros de recursos, registros de correo y otros detalles relacionados con la configuraci√≥n del DNS.

#### Transferencia de zona DNS

La transferencia de zona DNS es una operaci√≥n que permite a un servidor DNS obtener una copia completa de la zona DNS de otro servidor DNS. Esto puede ser utilizado por un atacante para obtener informaci√≥n sensible sobre la configuraci√≥n del DNS de un objetivo.

#### Envenenamiento de cach√© DNS

El envenenamiento de cach√© DNS es una t√©cnica utilizada para corromper la cach√© de un servidor DNS con informaci√≥n falsa. Esto puede ser utilizado por un atacante para redirigir el tr√°fico de red a servidores maliciosos o para realizar ataques de phishing.

#### Amplificaci√≥n de DNS

La amplificaci√≥n de DNS es una t√©cnica utilizada para amplificar el tr√°fico de red mediante consultas DNS maliciosas. Esto puede ser utilizado por un atacante para realizar ataques de denegaci√≥n de servicio (DoS) al saturar la red del objetivo con respuestas DNS amplificadas.

#### Ataques de fuerza bruta DNS

Los ataques de fuerza bruta DNS son ataques en los que un atacante intenta adivinar o descubrir informaci√≥n sensible sobre los registros DNS de un objetivo mediante la prueba de diferentes combinaciones de nombres de dominio o direcciones IP.

#### Ataques de envenenamiento de cach√© DNS

Los ataques de envenenamiento de cach√© DNS son ataques en los que un atacante corrompe la cach√© de un servidor DNS con informaci√≥n falsa. Esto puede ser utilizado para redirigir el tr√°fico de red a servidores maliciosos o para realizar ataques de phishing.

#### Ataques de denegaci√≥n de servicio DNS

Los ataques de denegaci√≥n de servicio DNS son ataques en los que un atacante intenta saturar la red del objetivo con consultas DNS maliciosas, lo que resulta en la interrupci√≥n del servicio DNS y la incapacidad de los usuarios para acceder a los recursos de red.

#### Ataques de secuestro de zona DNS

Los ataques de secuestro de zona DNS son ataques en los que un atacante obtiene el control de la zona DNS de un objetivo y redirige el tr√°fico de red a servidores maliciosos. Esto puede ser utilizado para interceptar comunicaciones o realizar ataques de phishing.
```bash
for sub in $(cat <WORDLIST>);do dig $sub.<DOMAIN> @<DNS_IP> | grep -v ';\|SOA' | sed -r '/^\s*$/d' | grep $sub | tee -a subdomains.txt;done

dnsenum --dnsserver <DNS_IP> --enum -p 0 -s 0 -o subdomains.txt -f <WORDLIST> <DOMAIN>
```
#### Usando nslookup

`nslookup` is a command-line tool used to query DNS (Domain Name System) servers to obtain information about domain names, IP addresses, and other DNS records. It is commonly used in network services pentesting to gather information about a target's DNS infrastructure.

To use `nslookup`, open a terminal and type `nslookup` followed by the domain name or IP address you want to query. By default, `nslookup` will display the IP address of the queried domain name.

For example, to query the IP address of the domain `example.com`, you would type:

```
nslookup example.com
```

`nslookup` can also be used to query specific types of DNS records, such as MX (Mail Exchanger) records or NS (Name Server) records. To do this, you can use the `-type` option followed by the record type.

For example, to query the MX records of `example.com`, you would type:

```
nslookup -type=mx example.com
```

`nslookup` can also be used to perform reverse DNS lookups by querying the IP address instead of the domain name. To do this, simply type the IP address instead of the domain name.

For example, to perform a reverse DNS lookup on the IP address `192.168.0.1`, you would type:

```
nslookup 192.168.0.1
```

`nslookup` provides a simple and straightforward way to gather information about a target's DNS infrastructure during a network services pentest. By querying DNS servers, you can obtain valuable information that can be used to identify potential vulnerabilities or misconfigurations.
```bash
nslookup
> SERVER <IP_DNS> #Select dns server
> 127.0.0.1 #Reverse lookup of 127.0.0.1, maybe...
> <IP_MACHINE> #Reverse lookup of a machine, maybe...
```
### M√≥dulos √∫tiles de Metasploit

Metasploit es una herramienta de prueba de penetraci√≥n ampliamente utilizada que ofrece una amplia gama de m√≥dulos para realizar pruebas de seguridad en sistemas y redes. A continuaci√≥n se presentan algunos m√≥dulos √∫tiles de Metasploit que pueden ser utilizados en pruebas de penetraci√≥n relacionadas con servicios de red:

- **`auxiliary/scanner/dns/dns_cache_snoop`**: Este m√≥dulo permite realizar un snoop en la cach√© DNS de un servidor para obtener informaci√≥n sensible, como registros DNS previamente consultados.

- **`auxiliary/scanner/dns/dns_enum`**: Este m√≥dulo se utiliza para enumerar registros DNS en un dominio espec√≠fico. Puede ayudar a identificar subdominios y obtener informaci√≥n sobre los registros DNS asociados.

- **`auxiliary/scanner/dns/dns_forward_lookup`**: Este m√≥dulo realiza una b√∫squeda de DNS hacia adelante para obtener informaci√≥n sobre los registros DNS asociados a un dominio o direcci√≥n IP espec√≠fica.

- **`auxiliary/scanner/dns/dns_reverse_lookup`**: Este m√≥dulo realiza una b√∫squeda de DNS inversa para obtener informaci√≥n sobre los nombres de dominio asociados a una direcci√≥n IP espec√≠fica.

- **`auxiliary/scanner/dns/dns_srv_enum`**: Este m√≥dulo se utiliza para enumerar registros de servicio (SRV) DNS en un dominio espec√≠fico. Puede ayudar a identificar servicios y obtener informaci√≥n sobre los registros SRV asociados.

- **`auxiliary/scanner/dns/dns_wildcard_enum`**: Este m√≥dulo se utiliza para enumerar subdominios utilizando una t√©cnica de b√∫squeda de comodines en un dominio espec√≠fico.

Estos son solo algunos ejemplos de los m√≥dulos √∫tiles de Metasploit que pueden ser utilizados en pruebas de penetraci√≥n relacionadas con servicios de red. Metasploit ofrece una amplia gama de m√≥dulos adicionales que pueden adaptarse a diferentes escenarios de prueba.
```bash
auxiliary/gather/enum_dns #Perform enumeration actions
```
### Scripts de nmap √∫tiles

Nmap es una herramienta de escaneo de red muy poderosa que se utiliza com√∫nmente en pruebas de penetraci√≥n. Adem√°s de sus capacidades de escaneo b√°sicas, Nmap tambi√©n admite scripts personalizados que pueden ser utilizados para realizar pruebas m√°s avanzadas. A continuaci√≥n se presentan algunos scripts de Nmap √∫tiles para pruebas de penetraci√≥n de servicios DNS:

- **dns-brute.nse**: Este script realiza un ataque de fuerza bruta contra un servidor DNS para descubrir subdominios y registros DNS ocultos.

- **dns-cache-snoop.nse**: Este script explota la funci√≥n de cach√© de un servidor DNS para revelar informaci√≥n confidencial, como registros DNS antiguos y subdominios.

- **dns-zone-transfer.nse**: Este script intenta realizar una transferencia de zona DNS desde un servidor DNS para obtener una lista completa de registros DNS y subdominios.

- **dns-recursion.nse**: Este script verifica si un servidor DNS permite consultas recursivas, lo que podr√≠a ser utilizado para realizar ataques de amplificaci√≥n DNS.

- **dns-update.nse**: Este script intenta realizar una actualizaci√≥n de zona DNS en un servidor DNS para agregar o modificar registros DNS.

Estos scripts pueden ser ejecutados utilizando el comando `nmap` seguido del nombre del script y la direcci√≥n IP del servidor DNS objetivo.
```bash
#Perform enumeration actions
nmap -n --script "(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport" <IP>
```
### DNS - Fuerza Bruta Inversa

La Fuerza Bruta Inversa es una t√©cnica utilizada en pruebas de penetraci√≥n para descubrir informaci√≥n sobre los registros DNS inversos de un objetivo. Los registros DNS inversos se utilizan para mapear direcciones IP a nombres de dominio. 

En un ataque de Fuerza Bruta Inversa, el objetivo es enumerar todos los posibles nombres de dominio asociados a una direcci√≥n IP espec√≠fica. Esto se logra enviando consultas DNS inversas a un servidor DNS y analizando las respuestas recibidas. 

El proceso de Fuerza Bruta Inversa implica generar una lista de nombres de dominio posibles y enviar consultas DNS inversas para cada uno de ellos. Si el servidor DNS responde con un registro v√°lido, se considera un √©xito y se registra como una posible asociaci√≥n entre la direcci√≥n IP y el nombre de dominio. 

Este tipo de ataque puede revelar informaci√≥n sensible, como nombres de dominio internos, nombres de servidores, subdominios ocultos y otros detalles que pueden ser utilizados en futuros ataques. Por lo tanto, es importante que los administradores de sistemas aseguren adecuadamente sus registros DNS inversos y tomen medidas para mitigar este tipo de ataques.
```bash
dnsrecon -r 127.0.0.0/24 -n <IP_DNS>  #DNS reverse of all of the addresses
dnsrecon -r 127.0.1.0/24 -n <IP_DNS>  #DNS reverse of all of the addresses
dnsrecon -r <IP_DNS>/24 -n <IP_DNS>   #DNS reverse of all of the addresses
dnsrecon -d active.htb -a -n <IP_DNS> #Zone transfer
```
{% hint style="info" %}
Si logras encontrar subdominios que resuelven a direcciones IP internas, debes intentar realizar un ataque de fuerza bruta de DNS inverso a los servidores de nombres del dominio solicitando ese rango de IP.
{% endhint %}

Otra herramienta para hacer esto: [https://github.com/amine7536/reverse-scan](https://github.com/amine7536/reverse-scan)

Puedes consultar rangos de IP inversos en [https://bgp.he.net/net/205.166.76.0/24#\_dns](https://bgp.he.net/net/205.166.76.0/24#\_dns) (esta herramienta tambi√©n es √∫til con BGP).

### DNS - Ataque de fuerza bruta a subdominios
```bash
dnsenum --dnsserver <IP_DNS> --enum -p 0 -s 0 -o subdomains.txt -f subdomains-1000.txt <DOMAIN>
dnsrecon -D subdomains-1000.txt -d <DOMAIN> -n <IP_DNS>
dnscan -d <domain> -r -w subdomains-1000.txt #Bruteforce subdomains in recursive way, https://github.com/rbsec/dnscan
```
### Servidores de Active Directory

Active Directory (AD) es un servicio de directorio desarrollado por Microsoft que se utiliza para administrar y organizar los recursos de red en un entorno de red de Windows. Los servidores de Active Directory son servidores que alojan y ejecutan el servicio de directorio de Active Directory.

Durante una prueba de penetraci√≥n, es importante identificar y evaluar los servidores de Active Directory en la red objetivo. Estos servidores son fundamentales para el funcionamiento de la infraestructura de red y, por lo tanto, pueden ser un objetivo atractivo para los atacantes.

Algunas t√©cnicas comunes utilizadas para pentesting de servidores de Active Directory incluyen:

- Enumeraci√≥n de usuarios y grupos: identificar los usuarios y grupos de Active Directory para obtener informaci√≥n sobre la estructura de la red y los posibles objetivos.
- Ataques de fuerza bruta: intentar adivinar las contrase√±as de los usuarios de Active Directory mediante la prueba de diferentes combinaciones de contrase√±as.
- Ataques de diccionario: utilizar diccionarios de contrase√±as predefinidos para intentar adivinar las contrase√±as de los usuarios de Active Directory.
- Ataques de inyecci√≥n de comandos: aprovechar las vulnerabilidades de inyecci√≥n de comandos para ejecutar comandos maliciosos en los servidores de Active Directory.
- Ataques de elevaci√≥n de privilegios: buscar vulnerabilidades que permitan a un atacante elevar sus privilegios en los servidores de Active Directory y obtener un mayor acceso y control sobre la red.

Es importante realizar estas pruebas de penetraci√≥n de manera √©tica y con el permiso del propietario de la red objetivo. El objetivo principal es identificar y remediar las posibles vulnerabilidades en los servidores de Active Directory para fortalecer la seguridad de la red.
```
dig -t _gc._tcp.lab.domain.com
dig -t _ldap._tcp.lab.domain.com
dig -t _kerberos._tcp.lab.domain.com
dig -t _kpasswd._tcp.lab.domain.com
nmap --script dns-srv-enum --script-args "dns-srv-enum.domain='domain.com'"
```
### DNSSec

DNSSec (Domain Name System Security Extensions) es una extensi√≥n de seguridad para el sistema de nombres de dominio (DNS). Su objetivo principal es proteger el DNS contra ataques de envenenamiento de cach√© y falsificaci√≥n de respuestas.

DNSSec utiliza criptograf√≠a de clave p√∫blica para garantizar la autenticidad e integridad de las respuestas DNS. Esto se logra mediante la firma digital de las respuestas DNS con claves privadas y la verificaci√≥n de estas firmas utilizando las claves p√∫blicas correspondientes.

Al implementar DNSSec, se puede garantizar que las respuestas DNS no hayan sido modificadas en tr√°nsito y que provengan de la fuente leg√≠tima. Esto ayuda a prevenir ataques como el envenenamiento de cach√©, donde un atacante puede redirigir el tr√°fico de DNS a servidores maliciosos.

Para realizar pruebas de penetraci√≥n en DNSSec, se pueden utilizar herramientas como `dnssec-verify` y `dnssec-dsfromkey` para verificar la configuraci√≥n y la cadena de confianza de DNSSec en un dominio espec√≠fico.

Es importante tener en cuenta que DNSSec no proporciona confidencialidad de los datos transmitidos a trav√©s del DNS. Si se requiere confidencialidad, se debe utilizar una capa adicional de cifrado, como DNS sobre TLS (DoT) o DNS sobre HTTPS (DoH).
```bash
#Query paypal subdomains to ns3.isc-sns.info
nmap -sSU -p53 --script dns-nsec-enum --script-args dns-nsec-enum.domains=paypal.com ns3.isc-sns.info
```
### IPv6

Realizar un ataque de fuerza bruta utilizando solicitudes "AAAA" para recopilar las direcciones IPv6 de los subdominios.
```bash
dnsdict6 -s -t <domain>
```
# Pentesting DNS

## Bruteforce reverse DNS in using IPv6 addresses

In some cases, during a penetration test, it may be necessary to perform a reverse DNS lookup on IPv6 addresses. This can be useful to gather information about the target network and identify potential vulnerabilities.

To bruteforce reverse DNS in using IPv6 addresses, you can follow these steps:

1. **Enumerate IPv6 addresses**: Use various techniques to identify IPv6 addresses associated with the target network. This can include scanning the network for live hosts, analyzing DNS records, or using tools like `nmap` or `masscan`.

2. **Generate possible domain names**: Once you have a list of IPv6 addresses, generate possible domain names based on the target's domain naming convention. This can include using common subdomains like `www`, `mail`, `ftp`, or any other subdomains that are commonly used by the target organization.

3. **Perform reverse DNS lookup**: Use a tool like `dig` or `nslookup` to perform a reverse DNS lookup on each IPv6 address and check if it resolves to any domain name. This can be done by querying the PTR record for each IPv6 address.

4. **Analyze the results**: Analyze the results of the reverse DNS lookup to identify any potential misconfigurations or vulnerabilities. Look for domain names that do not match the target's naming convention or any unexpected domain names that may indicate a security issue.

5. **Exploit the vulnerabilities**: If any vulnerabilities are identified, further exploit them to gain unauthorized access or gather additional information about the target network. This can include performing DNS zone transfers, conducting DNS cache poisoning attacks, or exploiting misconfigured DNS servers.

By following these steps, you can bruteforce reverse DNS in using IPv6 addresses and gather valuable information about the target network. This information can be used to identify potential security weaknesses and improve the overall security posture of the target organization.

Remember to always obtain proper authorization before performing any penetration testing activities and to comply with all applicable laws and regulations.
```bash
dnsrevenum6 pri.authdns.ripe.net 2001:67c:2e8::/48 #Will use the dns pri.authdns.ripe.net
```
### DNS Recursion DDoS

Si la **recursi√≥n DNS est√° habilitada**, un atacante podr√≠a **falsificar** el **origen** en el paquete UDP para hacer que el **DNS env√≠e la respuesta al servidor v√≠ctima**. Un atacante podr√≠a abusar de los tipos de registros **ANY** o **DNSSEC** ya que suelen tener respuestas m√°s grandes.\
La forma de **verificar** si un DNS admite **recursi√≥n** es consultar un nombre de dominio y **verificar** si la **bandera "ra"** (_recursi√≥n disponible_) est√° en la respuesta:
```bash
dig google.com A @<IP>
```
**No disponible**:

![](<../.gitbook/assets/image (275).png>)

**Disponible**:

![](<../.gitbook/assets/image (276).png>)

<figure><img src="../.gitbook/assets/image (1) (1) (2) (4).png" alt=""><figcaption></figcaption></figure>

[**DragonJAR Security Conference es un evento internacional de ciberseguridad**](https://www.dragonjarcon.org/) con m√°s de una d√©cada que se celebrar√° el 7 y 8 de septiembre de 2023 en Bogot√°, Colombia. Es un evento de gran contenido t√©cnico donde se presentan las √∫ltimas investigaciones en espa√±ol que atrae a hackers e investigadores de todo el mundo.\
¬°Reg√≠strate ahora en el siguiente enlace y no te pierdas esta gran conferencia!:

{% embed url="https://www.dragonjarcon.org/" %}

### Correo a una cuenta inexistente

Del libro: Evaluaci√≥n de seguridad de redes (3¬™ edici√≥n)

Simplemente enviar un mensaje de correo electr√≥nico a una direcci√≥n inexistente en un dominio objetivo a menudo revela informaci√≥n √∫til de la red interna a trav√©s de una _notificaci√≥n de no entrega_ (NDN).
```
Generating server: noa.nintendo.com

blah@nintendo.com
#550 5.1.1 RESOLVER.ADR.RecipNotFound; not found ##

Original message headers:

Received: from ONERDEDGE02.one.nintendo.com (10.13.20.35) by
onerdexch08.one.nintendo.com (10.13.30.39) with Microsoft SMTP Server (TLS)
id 14.3.174.1; Sat, 26 Apr 2014 16:52:22 -0700
Received: from barracuda.noa.nintendo.com (205.166.76.35) by
ONERDEDGE02.one.nintendo.com (10.13.20.35) with Microsoft SMTP Server (TLS)
id 14.3.174.1; Sat, 26 Apr 2014 16:51:22 -0700
X-ASG-Debug-ID: 1398556333-0614671716199b0d0001-zOQ9WJ
Received: from gateway05.websitewelcome.com (gateway05.websitewelcome.com  [69.93.154.37]) by
barracuda.noa.nintendo.com with ESMTP id xVNPkwaqGgdyH5Ag for <blah@nintendo.com>; Sat,
26 Apr 2014 16:52:13 -0700 (PDT)
X-Barracuda-Envelope-From: chris@example.org
X-Barracuda-Apparent-Source-IP: 69.93.154.37
```
Los siguientes datos en esta transcripci√≥n son √∫tiles:

* Nombres de host internos, direcciones IP y dise√±o de subdominios
* El servidor de correo est√° ejecutando Microsoft Exchange Server 2010 SP3
* Se utiliza un dispositivo de Barracuda Networks para realizar filtrado de contenido

## Archivos de configuraci√≥n
```
host.conf
/etc/resolv.conf
/etc/bind/named.conf
/etc/bind/named.conf.local
/etc/bind/named.conf.options
/etc/bind/named.conf.log
/etc/bind/*
```
Configuraciones peligrosas al configurar un servidor Bind:

| **Opci√≥n**        | **Descripci√≥n**                                                                |
| ----------------- | ------------------------------------------------------------------------------ |
| `allow-query`     | Define qu√© hosts tienen permitido enviar solicitudes al servidor DNS.            |
| `allow-recursion` | Define qu√© hosts tienen permitido enviar solicitudes recursivas al servidor DNS.  |
| `allow-transfer`  | Define qu√© hosts tienen permitido recibir transferencias de zona desde el servidor DNS. |
| `zone-statistics` | Recopila datos estad√≠sticos de las zonas.                                            |

## Comandos autom√°ticos de HackTricks
```
Protocol_Name: DNS    #Protocol Abbreviation if there is one.
Port_Number:  53     #Comma separated if there is more than one.
Protocol_Description: Domain Name Service        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for DNS
Note: |
#These are the commands I run every time I see an open DNS port

dnsrecon -r 127.0.0.0/24 -n {IP} -d {Domain_Name}
dnsrecon -r 127.0.1.0/24 -n {IP} -d {Domain_Name}
dnsrecon -r {Network}{CIDR} -n {IP} -d {Domain_Name}
dig axfr @{IP}
dig axfr {Domain_Name} @{IP}
nslookup
SERVER {IP}
127.0.0.1
{IP}
Domain_Name
exit

https://book.hacktricks.xyz/pentesting/pentesting-dns

Entry_2:
Name: Banner Grab
Description: Grab DNS Banner
Command: dig version.bind CHAOS TXT @DNS

Entry_3:
Name: Nmap Vuln Scan
Description: Scan for Vulnerabilities with Nmap
Command: nmap -n --script "(default and *dns*) or fcrdns or dns-srv-enum or dns-random-txid or dns-random-srcport" {IP}

Entry_4:
Name: Zone Transfer
Description: Three attempts at forcing a zone transfer
Command: dig axfr @{IP} && dix axfr @{IP} {Domain_Name} && fierce --dns-servers {IP} --domain {Domain_Name}


Entry_5:
Name: Active Directory
Description: Eunuerate a DC via DNS
Command: dig -t _gc._{Domain_Name} && dig -t _ldap._{Domain_Name} && dig -t _kerberos._{Domain_Name} && dig -t _kpasswd._{Domain_Name} && nmap --script dns-srv-enum --script-args "dns-srv-enum.domain={Domain_Name}"

Entry_6:
Name: consolesless mfs enumeration
Description: DNS enumeration without the need to run msfconsole
Note: sourced from https://github.com/carlospolop/legion
Command: msfconsole -q -x 'use auxiliary/scanner/dns/dns_amp; set RHOSTS {IP}; set RPORT 53; run; exit' && msfconsole -q -x 'use auxiliary/gather/enum_dns; set RHOSTS {IP}; set RPORT 53; run; exit'
```
<figure><img src="../.gitbook/assets/image (1) (1) (2) (4).png" alt=""><figcaption></figcaption></figure>

[**DragonJAR Security Conference is an international cybersecurity event**](https://www.dragonjarcon.org/) with over a decade of history that will take place on September 7th and 8th, 2023 in Bogot√°, Colombia. It is a highly technical event where the latest research in Spanish is presented, attracting hackers and researchers from around the world.\
Register now at the following link and don't miss out on this great conference!:

{% embed url="https://www.dragonjarcon.org/" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* ¬øTrabajas en una **empresa de ciberseguridad**? ¬øQuieres ver tu **empresa anunciada en HackTricks**? ¬øO quieres tener acceso a la **√∫ltima versi√≥n de PEASS o descargar HackTricks en PDF**? ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obt√©n el [**merchandising oficial de PEASS y HackTricks**](https://peass.creator-spring.com)
* **√önete al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de Telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
