# 873 - Pentesting Rsync

<details>

<summary><strong>ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•ï¼š

* **HackTricksã§ä¼æ¥­ã‚’å®£ä¼ã—ãŸã„**ã¾ãŸã¯**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„**å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASSï¼†HackTricksã‚¹ãƒ¯ãƒƒã‚°**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã™ã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¦‹ã¤ã‘ã‚‹
* **ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã™ã‚‹ã€‚
* **ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€[**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã™ã‚‹ã€‚**

</details>

## **åŸºæœ¬æƒ…å ±**

[wikipedia](https://en.wikipedia.org/wiki/Rsync)ã‹ã‚‰ï¼š

> **rsync**ã¯ã€[ãƒ•ã‚¡ã‚¤ãƒ«ã®è»¢é€](https://en.wikipedia.org/wiki/File\_transfer)ã¨[ãƒ•ã‚¡ã‚¤ãƒ«ã®åŒæœŸ](https://en.wikipedia.org/wiki/File\_synchronization)ã‚’åŠ¹ç‡çš„ã«è¡Œã†ãŸã‚ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã§ã‚ã‚Šã€[ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿](https://en.wikipedia.org/wiki/Computer)ã¨å¤–éƒ¨ãƒãƒ¼ãƒ‰ãƒ‰ãƒ©ã‚¤ãƒ–ã€ãŠã‚ˆã³[ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯](https://en.wikipedia.org/wiki/Computer\_network)ä¸Šã®[ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿](https://en.wikipedia.org/wiki/Computer)é–“ã§ã€ãƒ•ã‚¡ã‚¤ãƒ«ã®[ä¿®æ­£æ™‚åˆ»](https://en.wikipedia.org/wiki/Timestamping\_\(computing\))ã¨ã‚µã‚¤ã‚ºã‚’æ¯”è¼ƒã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦è¡Œã‚ã‚Œã¾ã™ã€‚[Unix-like](https://en.wikipedia.org/wiki/Unix-like) [ã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ](https://en.wikipedia.org/wiki/Operating\_system)ã§ä¸€èˆ¬çš„ã«è¦‹ã‚‰ã‚Œã¾ã™ã€‚rsyncã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯[ãƒ‡ãƒ«ã‚¿ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°](https://en.wikipedia.org/wiki/Delta\_encoding)ã®ä¸€ç¨®ã§ã‚ã‚Šã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä½¿ç”¨é‡ã‚’æœ€å°é™ã«æŠ‘ãˆã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚è¿½åŠ ã®[ãƒ‡ãƒ¼ã‚¿åœ§ç¸®](https://en.wikipedia.org/wiki/Data\_compression)ã«ã¯[Zlib](https://en.wikipedia.org/wiki/Zlib)ãŒä½¿ç”¨ã•ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã«ã¯[SSH](https://en.wikipedia.org/wiki/Secure\_Shell)ã¾ãŸã¯[stunnel](https://en.wikipedia.org/wiki/Stunnel)ãŒä½¿ç”¨ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆ:** 873
```
PORT    STATE SERVICE REASON
873/tcp open  rsync   syn-ack
```
## åˆ—æŒ™

### ãƒãƒŠãƒ¼ï¼†ãƒãƒ‹ãƒ¥ã‚¢ãƒ«é€šä¿¡
```bash
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0        <--- You receive this banner with the version from the server
@RSYNCD: 31.0        <--- Then you send the same info
#list                <--- Then you ask the sever to list
raidroot             <--- The server starts enumerating
USBCopy
NAS_Public
_NAS_Recycle_TOSRAID	<--- Enumeration finished
@RSYNCD: EXIT         <--- Sever closes the connection


#Now lets try to enumerate "raidroot"
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0
@RSYNCD: 31.0
raidroot
@RSYNCD: AUTHREQD 7H6CqsHCPG06kRiFkKwD8g    <--- This means you need the password
```
### **å…±æœ‰ãƒ•ã‚©ãƒ«ãƒ€ã®åˆ—æŒ™**

**Rsyncãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«**ã¯ã€**ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ä¿è­·ã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå…±æœ‰**ã¨ã—ã¦èªè­˜ã•ã‚Œã¾ã™ã€‚åˆ©ç”¨å¯èƒ½ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ç‰¹å®šã—ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå¿…è¦ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ãŒä½¿ç”¨ã•ã‚Œã¾ã™ï¼š
```bash
nmap -sV --script "rsync-list-modules" -p <PORT> <IP>
msf> use auxiliary/scanner/rsync/modules_list

# Example with IPv6 and alternate port
rsync -av --list-only rsync://[dead:beef::250:56ff:feb9:e90a]:8730
```
Be aware that some shares might not appear in the list, possibly hiding them. Additionally, accessing some shares might be restricted to specific **credentials**, indicated by an **"Access Denied"** message.

### [**Brute Force**](../generic-methodologies-and-resources/brute-force.md#rsync)

### Manual Rsync Usage

Upon obtaining a **module list**, actions depend on whether authentication is needed. Without authentication, **listing** and **copying** files from a shared folder to a local directory is achieved through:
```bash
# Listing a shared folder
rsync -av --list-only rsync://192.168.0.123/shared_name

# Copying files from a shared folder
rsync -av rsync://192.168.0.123:8730/shared_name ./rsyn_shared
```
ã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†å¸°çš„ã«è»¢é€ã—ã€ãã®å±æ€§ã¨æ¨©é™ã‚’ä¿æŒã—ã¾ã™ã€‚

**è³‡æ ¼æƒ…å ±**ã‚’ä½¿ç”¨ã—ã¦ã€å…±æœ‰ãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰ã®ãƒªã‚¹ãƒˆè¡¨ç¤ºã‚„ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
```bash
rsync -av --list-only rsync://username@192.168.0.123/shared_name
rsync -av rsync://username@192.168.0.123:8730/shared_name ./rsyn_shared
```
**ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰**ã™ã‚‹ã«ã¯ã€ã‚¢ã‚¯ã‚»ã‚¹ç”¨ã® _**authorized_keys**_ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™:
```bash
rsync -av home_user/.ssh/ rsync://username@192.168.0.123/home_user/.ssh
```
## POST

rsyncdã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¦‹ã¤ã‘ã‚‹ã«ã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š
```bash
find /etc \( -name rsyncd.conf -o -name rsyncd.secrets \)
```
## å‚ç…§

* [https://www.smeegesec.com/2016/12/pentesting-rsync.html](https://www.smeegesec.com/2016/12/pentesting-rsync.html)

<details>

<summary><strong>ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§ã®AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

* **HackTricksã§ä¼æ¥­ã‚’å®£ä¼ã—ãŸã„** ã¾ãŸã¯ **HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„** å ´åˆã¯ [**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop) ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼PEASSï¼†HackTricksã‚¹ãƒ¯ãƒƒã‚°**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª [**NFTs**](https://opensea.io/collection/the-peass-family) ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¦‹ã¤ã‘ã‚‹
* **ğŸ’¬ [Discordã‚°ãƒ«ãƒ¼ãƒ—](https://discord.gg/hRep4RUj7f)** ã¾ãŸã¯ [telegramã‚°ãƒ«ãƒ¼ãƒ—](https://t.me/peass) ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live) ã‚’**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„ã€‚
* **HackTricks** ã¨ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ã€ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚

</details>
