# 111/TCP/UDP - Portmapperã®ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ

<details>

<summary><strong>AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§å­¦ã¶ã«ã¯</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ã‚’ãƒã‚§ãƒƒã‚¯ï¼</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

* **HackTricksã«ã‚ãªãŸã®ä¼šç¤¾ã‚’åºƒå‘Šã—ãŸã„å ´åˆ**ã‚„**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„å ´åˆ**ã¯ã€[**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**å…¬å¼ã®PEASS & HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã™ã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã‚„[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ ã™ã‚‹**ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)ã§**ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹**ã€‚
* [**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®githubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ã€ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚³ãƒ„ã‚’**å…±æœ‰ã™ã‚‹**ã€‚

</details>

## åŸºæœ¬æƒ…å ±

Unixãƒ™ãƒ¼ã‚¹ã®ã‚·ã‚¹ãƒ†ãƒ é–“ã§æƒ…å ±ã‚’æä¾›ã—ã¾ã™ã€‚ã“ã®ãƒãƒ¼ãƒˆã¯ã‚ˆãèª¿æŸ»ã•ã‚Œã€Nix OSã®ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒˆã‚„åˆ©ç”¨å¯èƒ½ãªã‚µãƒ¼ãƒ“ã‚¹ã«é–¢ã™ã‚‹æƒ…å ±ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚NFSã€NISã€ã¾ãŸã¯ä»»æ„ã®rpcãƒ™ãƒ¼ã‚¹ã®ã‚µãƒ¼ãƒ“ã‚¹ã§ä½¿ç”¨ã•ã‚Œã‚‹ãƒãƒ¼ãƒˆã§ã™ã€‚

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆ:** 111/TCP/UDPã€Oracle Solarisã§ã¯32771
```
PORT    STATE SERVICE
111/tcp open  rpcbind
```
## åˆ—æŒ™
```
rpcinfo irked.htb
nmap -sSUC -p111 192.168.10.1
```
æ™‚ã«ã¯ä½•ã®æƒ…å ±ã‚‚å¾—ã‚‰ã‚Œãªã„ã“ã¨ãŒã‚ã‚Šã¾ã™ãŒã€ä»–ã®å ´åˆã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªæƒ…å ±ãŒå¾—ã‚‰ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ï¼š

![](<../.gitbook/assets/image (230).png>)

### Shodan

* `port:111 portmap`

## RPCBind + NFS

NFSã‚µãƒ¼ãƒ“ã‚¹ã‚’è¦‹ã¤ã‘ãŸå ´åˆã€ãŠãã‚‰ããƒ•ã‚¡ã‚¤ãƒ«ã®ãƒªã‚¹ãƒˆã‚’è¡¨ç¤ºã—ã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆãã—ã¦ãŠãã‚‰ãã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼‰ãŒã§ãã‚‹ã§ã—ã‚‡ã†ï¼š

![](<../.gitbook/assets/image (232).png>)

ã“ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ãƒ†ã‚¹ãƒˆæ–¹æ³•ã«ã¤ã„ã¦ã¯ã€[2049 - NFSã‚µãƒ¼ãƒ“ã‚¹ã®ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ](nfs-service-pentesting.md)ã‚’èª­ã‚“ã§ãã ã•ã„ã€‚

## NIS

`ypbind`ã‚µãƒ¼ãƒ“ã‚¹ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹å ´åˆï¼š

![](<../.gitbook/assets/image (233).png>)

ãã‚Œã‚’æ‚ªç”¨ã—ã‚ˆã†ã¨è©¦ã¿ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã¨ã«ã‹ãã€ã¾ãšã¯NISã®ã€Œãƒ‰ãƒ¡ã‚¤ãƒ³åã€ã‚’**æ¨æ¸¬ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™**ï¼ˆNISãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã‚‹ã¨ã€ã€Œãƒ‰ãƒ¡ã‚¤ãƒ³åã€ãŒè¨­å®šã•ã‚Œã¾ã™ï¼‰ã—ã€**ã“ã®ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’çŸ¥ã‚‰ãªã‘ã‚Œã°ä½•ã‚‚ã§ãã¾ã›ã‚“**ã€‚

ç’°å¢ƒã®NISãƒ‰ãƒ¡ã‚¤ãƒ³åï¼ˆã“ã®å ´åˆã¯example.orgï¼‰ã‚’å–å¾—ã—ãŸã‚‰ã€ypwhichã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦NISã‚µãƒ¼ãƒãƒ¼ã«pingã‚’é€ã‚Šã€ypcatã‚’ä½¿ç”¨ã—ã¦æ©Ÿå¯†æƒ…å ±ã‚’å–å¾—ã—ã¾ã™ã€‚æš—å·åŒ–ã•ã‚ŒãŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥ã‚’John the Ripperã«å…¥åŠ›ã—ã€ã‚¯ãƒ©ãƒƒã‚¯ã—ãŸã‚‰ã€ã‚·ã‚¹ãƒ†ãƒ ã‚¢ã‚¯ã‚»ã‚¹ã¨æ¨©é™ã‚’è©•ä¾¡ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã—ã¾ã™ã€‚
```bash
root@kali:~# apt-get install nis
root@kali:~# ypwhich -d example.org 192.168.10.1
potatohead.example.org
root@kali:~# ypcat â€“d example.org â€“h 192.168.10.1 passwd.byname
tiff:noR7Bk6FdgcZg:218:101::/export/home/tiff:/bin/bash
katykat:d.K5tGUWCJfQM:2099:102::/export/home/katykat:/bin/bash
james:i0na7pfgtxi42:332:100::/export/home/james:/bin/tcsh
florent:nUNzkxYF0Hbmk:199:100::/export/home/florent:/bin/csh
dave:pzg1026SzQlwc:182:100::/export/home/dave:/bin/bash
yumi:ZEadZ3ZaW4v9.:1377:160::/export/home/yumi:/bin/bash
```
| **ãƒã‚¹ã‚¿ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«** | **ãƒãƒƒãƒ—** | **ãƒãƒ¼ãƒˆ** |
| -------------------- | ---------- | ---------- |
| /etc/hosts           | hosts.byname, hosts.byaddr | ãƒ›ã‚¹ãƒˆåã¨IPã®è©³ç´°ã‚’å«ã‚€ |
| /etc/passwd          | passwd.byname, passwd.byuid | NISãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ« |
| /etc/group           | group.byname, group.bygid | NISã‚°ãƒ«ãƒ¼ãƒ—ãƒ•ã‚¡ã‚¤ãƒ« |
| /usr/lib/aliases     | mail.aliases | ãƒ¡ãƒ¼ãƒ«ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã®è©³ç´° |

## RPC ãƒ¦ãƒ¼ã‚¶ãƒ¼

**rusersd** ã‚µãƒ¼ãƒ“ã‚¹ãŒã“ã®ã‚ˆã†ã«ãƒªã‚¹ãƒˆã•ã‚Œã¦ã„ã‚‹å ´åˆï¼š

![](<../.gitbook/assets/image (231).png>)

ãƒœãƒƒã‚¯ã‚¹ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’åˆ—æŒ™ã§ãã¾ã™ã€‚å­¦ã³æ–¹ã¯[1026 - Rsusersdã®ãƒšãƒ³ãƒ†ã‚¹ãƒˆ](1026-pentesting-rusersd.md)ã‚’èª­ã‚“ã§ãã ã•ã„ã€‚

## ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã•ã‚ŒãŸPortmapperãƒãƒ¼ãƒˆã®ãƒã‚¤ãƒ‘ã‚¹

nmapã‚¹ã‚­ãƒ£ãƒ³ä¸­ã«NFSã®ã‚ˆã†ãªã‚ªãƒ¼ãƒ—ãƒ³ãƒãƒ¼ãƒˆãŒè¦‹ãˆã‚‹ãŒã€ãƒãƒ¼ãƒˆ111ãŒãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã•ã‚Œã¦ã„ã‚‹å ´åˆã€ãã‚Œã‚‰ã®ãƒãƒ¼ãƒˆã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚\
ã—ã‹ã—ã€ãƒ­ãƒ¼ã‚«ãƒ«ã«portmapperã‚µãƒ¼ãƒ“ã‚¹ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã—ã€NFSãƒãƒ¼ãƒˆã‚’è‡ªåˆ†ã®ãƒã‚·ãƒ³ã‹ã‚‰è¢«å®³è€…ã®ãƒã‚·ãƒ³ã«ãƒˆãƒ³ãƒãƒªãƒ³ã‚°ã™ã‚‹ã“ã¨ãŒã§ãã‚Œã°ã€é€šå¸¸ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ãã‚Œã‚‰ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\
è©³ç´°ã¯[https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc](https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## Shodan

* `Portmap`

## ç·´ç¿’ç”¨ãƒ©ãƒœ

* [**Irked HTBãƒã‚·ãƒ³**](https://app.hackthebox.com/machines/Irked)ã§ã“ã‚Œã‚‰ã®æŠ€è¡“ã‚’ç·´ç¿’ã—ã¦ãã ã•ã„ã€‚

## HackTricks è‡ªå‹•ã‚³ãƒãƒ³ãƒ‰
```
Protocol_Name: Portmapper    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: PM or RPCBind        #Protocol Abbreviation Spelled out

Entry_1:
Name: Notes
Description: Notes for PortMapper
Note: |
Provides information between Unix based systems. Port is often probed, it can be used to fingerprint the Nix OS, and to obtain information about available services. Port used with NFS, NIS, or any rpc-based service.

https://book.hacktricks.xyz/pentesting/pentesting-rpcbind

Entry_2:
Name: rpc info
Description: May give netstat-type info
Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43

Entry_3:
Name: nmap
Description: May give netstat-type info
Command: nmap -sSUC -p 111 {IP}
```
<details>

<summary><strong>AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§å­¦ã¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ï¼</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

* **HackTricksã«ã‚ãªãŸã®ä¼šç¤¾ã‚’åºƒå‘Šã—ãŸã„å ´åˆ**ã€ã¾ãŸã¯**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„å ´åˆ**ã¯ã€[**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚
* [**å…¬å¼PEASS & HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã™ã‚‹
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã™ã‚‹ã€ç§ãŸã¡ã®ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã«**å‚åŠ ã™ã‚‹**ã‹ã€[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)ã‚’**ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹**ã€‚
* [**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®githubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ã€ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚³ãƒ„ã‚’**å…±æœ‰ã™ã‚‹**ã€‚

</details>
