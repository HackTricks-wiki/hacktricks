# 111/TCP/UDP - Teste de penetraÃ§Ã£o no Portmapper

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* VocÃª trabalha em uma **empresa de seguranÃ§a cibernÃ©tica**? VocÃª quer ver sua **empresa anunciada no HackTricks**? ou vocÃª quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe suas tÃ©cnicas de hacking enviando PRs para o** [**repositÃ³rio hacktricks**](https://github.com/carlospolop/hacktricks) **e para o** [**repositÃ³rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## InformaÃ§Ãµes bÃ¡sicas

Fornece informaÃ§Ãµes entre sistemas baseados em Unix. A porta Ã© frequentemente sondada, pode ser usada para identificar o sistema operacional Nix e obter informaÃ§Ãµes sobre serviÃ§os disponÃ­veis. A porta Ã© usada com NFS, NIS ou qualquer serviÃ§o baseado em rpc.

**Porta padrÃ£o:** 111/TCP/UDP, 32771 no Oracle Solaris
```
PORT    STATE SERVICE
111/tcp open  rpcbind
```
## EnumeraÃ§Ã£o
```
rpcinfo irked.htb
nmap -sSUC -p111 192.168.10.1
```
Ã€s vezes, nÃ£o fornece nenhuma informaÃ§Ã£o, em outras ocasiÃµes, vocÃª obterÃ¡ algo como isto:

![](<../.gitbook/assets/image (230).png>)

### Shodan

* `port:111 portmap`

## RPCBind + NFS

Se vocÃª encontrar o serviÃ§o NFS, provavelmente poderÃ¡ listar e baixar (e talvez enviar) arquivos:

![](<../.gitbook/assets/image (232).png>)

Leia [2049 - Pentesting NFS service](nfs-service-pentesting.md) para saber mais sobre como testar este protocolo.

## NIS

Se vocÃª encontrar o serviÃ§o `ypbind` em execuÃ§Ã£o:

![](<../.gitbook/assets/image (233).png>)

VocÃª pode tentar explorÃ¡-lo. De qualquer forma, em primeiro lugar, vocÃª **precisarÃ¡ adivinhar o "nome de domÃ­nio" NIS** da mÃ¡quina (quando o NIS Ã© instalado, Ã© configurado um "nome de domÃ­nio") e **sem saber este nome de domÃ­nio, vocÃª nÃ£o pode fazer nada**.

Ao obter o nome de domÃ­nio NIS para o ambiente (example.org neste caso), use o comando ypwhich para pingar o servidor NIS e ypcat para obter material sensÃ­vel. VocÃª deve alimentar hashes de senha criptografadas no John the Ripper e, uma vez quebradas, pode usÃ¡-las para avaliar o acesso e os privilÃ©gios do sistema.
```bash
root@kali:~# apt-get install nis
root@kali:~# ypwhich -d example.org 192.168.10.1
potatohead.example.org
root@kali:~# ypcat â€“d example.org â€“h 192.168.10.1 passwd.byname
tiff:noR7Bk6FdgcZg:218:101::/export/home/tiff:/bin/bash 
katykat:d.K5tGUWCJfQM:2099:102::/export/home/katykat:/bin/bash 
james:i0na7pfgtxi42:332:100::/export/home/james:/bin/tcsh 
florent:nUNzkxYF0Hbmk:199:100::/export/home/florent:/bin/csh 
dave:pzg1026SzQlwc:182:100::/export/home/dave:/bin/bash 
yumi:ZEadZ3ZaW4v9.:1377:160::/export/home/yumi:/bin/bash
```
| **Arquivo mestre** | **Mapa(s)**                 | **Notas**                                        |
| ------------------ | --------------------------- | ------------------------------------------------ |
| /etc/hosts         | hosts.byname, hosts.byaddr  | ContÃ©m nomes de host e detalhes de IP             |
| /etc/passwd        | passwd.byname, passwd.byuid | Arquivo de senha do usuÃ¡rio NIS                  |
| /etc/group         | group.byname, group.bygid   | Arquivo de grupo NIS                             |
| /usr/lib/aliases   | mail.aliases                | Detalhes de alias de email                        |

## UsuÃ¡rios RPC

Se vocÃª encontrar o serviÃ§o **rusersd** listado assim:

![](<../.gitbook/assets/image (231).png>)

VocÃª pode enumerar usuÃ¡rios da mÃ¡quina. Para aprender como, leia [1026 - Pentesting Rsusersd](1026-pentesting-rusersd.md).

## Bypass no portmapper filtrado

Se durante uma varredura nmap vocÃª vir portas abertas como NFS, mas a porta 111 estÃ¡ filtrada, vocÃª nÃ£o poderÃ¡ explorar essas portas.\
Mas, se vocÃª puder simular localmente um serviÃ§o de portmapper e tunelar a porta NFS da sua mÃ¡quina para a vÃ­tima, vocÃª poderÃ¡ usar ferramentas regulares para explorar esses serviÃ§os.\
Mais informaÃ§Ãµes em [https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc](https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc)

## Shodan

* `Portmap`

## LaboratÃ³rios para praticar

* Pratique essas tÃ©cnicas na mÃ¡quina [**Irked HTB**](https://app.hackthebox.com/machines/Irked).

## Comandos AutomÃ¡ticos do HackTricks
```
Protocol_Name: Portmapper    #Protocol Abbreviation if there is one.
Port_Number:  43     #Comma separated if there is more than one.
Protocol_Description: PM or RPCBind        #Protocol Abbreviation Spelled out

Entry_1:
  Name: Notes
  Description: Notes for PortMapper
  Note: |
    Provides information between Unix based systems. Port is often probed, it can be used to fingerprint the Nix OS, and to obtain information about available services. Port used with NFS, NIS, or any rpc-based service.

    https://book.hacktricks.xyz/pentesting/pentesting-rpcbind

Entry_2:
  Name: rpc info
  Description: May give netstat-type info
  Command: whois -h {IP} -p 43 {Domain_Name} && echo {Domain_Name} | nc -vn {IP} 43

Entry_3:
  Name: nmap
  Description: May give netstat-type info
  Command: nmap -sSUC -p 111 {IP}
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* VocÃª trabalha em uma **empresa de seguranÃ§a cibernÃ©tica**? VocÃª quer ver sua **empresa anunciada no HackTricks**? ou vocÃª quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) **grupo do Discord** ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live).
* **Compartilhe suas tÃ©cnicas de hacking enviando PRs para o** [**repositÃ³rio hacktricks**](https://github.com/carlospolop/hacktricks) **e para o** [**repositÃ³rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
