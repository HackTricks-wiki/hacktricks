# WebDav

![](<../../.gitbook/assets/image (9) (1) (2).png>)

Use [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir e automatizar facilmente fluxos de trabalho com as ferramentas comunitÃ¡rias mais avanÃ§adas do mundo. Obtenha acesso hoje:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* VocÃª trabalha em uma **empresa de seguranÃ§a cibernÃ©tica**? VocÃª quer ver sua **empresa anunciada no HackTricks**? ou vocÃª quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenha o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe suas tÃ©cnicas de hacking enviando PRs para o** [**repositÃ³rio hacktricks**](https://github.com/carlospolop/hacktricks) **e** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud).

</details>

Um **servidor HTTP com WebDav** ativo Ã© um servidor onde vocÃª provavelmente pode **atualizar, excluir, mover, copiar** arquivos. Ã€s vezes, vocÃª precisa ter **credenciais vÃ¡lidas** (geralmente verifique com AutenticaÃ§Ã£o BÃ¡sica HTTP).

VocÃª deve tentar **carregar** algum **webshell** e **executÃ¡-lo** a partir do servidor web para assumir o controle do servidor.\
Normalmente, para **conectar** um servidor WebDav, vocÃª precisarÃ¡ de **credenciais vÃ¡lidas**: [**WebDav brute force**](../../generic-methodologies-and-resources/brute-force.md#http-basic-auth) _(AutenticaÃ§Ã£o BÃ¡sica)_.

Outra configuraÃ§Ã£o comum Ã© **proibir o upload** de arquivos com **extensÃµes** que serÃ£o **executados** pelo servidor web, vocÃª deve verificar como **burlar isso:**

* **Carregar** arquivos com **extensÃµes executÃ¡veis** (talvez nÃ£o seja proibido).
* **Carregar** arquivos **sem extensÃµes executÃ¡veis** (como .txt) e tentar **renomear** o arquivo (mover) com uma **extensÃ£o executÃ¡vel**.
* **Carregar** arquivos **sem extensÃµes executÃ¡veis** (como .txt) e tentar **copiar** o arquivo (mover) com **extensÃ£o executÃ¡vel.**

## DavTest

**Davtest** tenta **carregar vÃ¡rios arquivos com diferentes extensÃµes** e **verifica** se a extensÃ£o Ã© **executada**:
```bash
davtest [-auth user:password] -move -sendbd auto -url http://<IP> #Uplaod .txt files and try to move it to other extensions
davtest [-auth user:password] -sendbd auto -url http://<IP> #Try to upload every extension
```
SaÃ­da de exemplo:

![](<../../.gitbook/assets/image (19) (1) (1).png>)

Isso nÃ£o significa que as extensÃµes **.txt** e **.html estÃ£o sendo executadas**. Isso significa que vocÃª pode **acessar esses arquivos** pela web.

## Cadaver

VocÃª pode usar essa ferramenta para **conectar-se ao servidor WebDav** e realizar aÃ§Ãµes (como **upload**, **mover** ou **excluir**) **manualmente**.
```
cadaver <IP>
```
## RequisiÃ§Ã£o PUT

---

### Description

The HTTP PUT method is used to update a resource on a server. In the context of web applications, this method is commonly used to update files on a web server. The PUT method is part of the WebDAV protocol, which is an extension of the HTTP protocol that allows clients to perform remote web content authoring operations.

### DescriÃ§Ã£o

O mÃ©todo HTTP PUT Ã© usado para atualizar um recurso em um servidor. No contexto de aplicaÃ§Ãµes web, este mÃ©todo Ã© comumente usado para atualizar arquivos em um servidor web. O mÃ©todo PUT faz parte do protocolo WebDAV, que Ã© uma extensÃ£o do protocolo HTTP que permite que clientes realizem operaÃ§Ãµes de autoria de conteÃºdo web remoto. 

---

### Vulnerability

The PUT method can be vulnerable to attacks if the server does not properly validate the input data. An attacker can use the PUT method to upload a malicious file to the server or overwrite an existing file with malicious content. This can lead to a compromise of the server or the web application.

### Vulnerabilidade

O mÃ©todo PUT pode ser vulnerÃ¡vel a ataques se o servidor nÃ£o validar corretamente os dados de entrada. Um atacante pode usar o mÃ©todo PUT para fazer upload de um arquivo malicioso para o servidor ou sobrescrever um arquivo existente com conteÃºdo malicioso. Isso pode levar a uma comprometimento do servidor ou da aplicaÃ§Ã£o web.

---

### Exploitation

To exploit this vulnerability, an attacker can use a tool like cURL to send a PUT request to the server with a malicious file as the payload. The attacker can also use a web application that allows file uploads to upload a malicious file using the PUT method.

### ExploraÃ§Ã£o

Para explorar essa vulnerabilidade, um atacante pode usar uma ferramenta como o cURL para enviar uma requisiÃ§Ã£o PUT para o servidor com um arquivo malicioso como carga Ãºtil. O atacante tambÃ©m pode usar uma aplicaÃ§Ã£o web que permita o upload de arquivos para fazer o upload de um arquivo malicioso usando o mÃ©todo PUT. 

---

### Mitigation

To mitigate this vulnerability, the server should properly validate the input data and only allow authorized users to perform PUT requests. The server should also limit the size of uploaded files and restrict the types of files that can be uploaded.

### MitigaÃ§Ã£o

Para mitigar essa vulnerabilidade, o servidor deve validar corretamente os dados de entrada e permitir apenas que usuÃ¡rios autorizados realizem requisiÃ§Ãµes PUT. O servidor tambÃ©m deve limitar o tamanho dos arquivos enviados e restringir os tipos de arquivos que podem ser enviados.
```
curl -T 'shell.txt' 'http://$ip'
```
## RequisiÃ§Ã£o MOVE
```
curl -X MOVE --header 'Destination:http://$ip/shell.php' 'http://$ip/shell.txt'
```
![](<../../.gitbook/assets/image (9) (1) (2).png>)

Use [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir e automatizar facilmente fluxos de trabalho com as ferramentas comunitÃ¡rias mais avanÃ§adas do mundo.\
Obtenha acesso hoje:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Vulnerabilidade IIS5/6 WebDav

Essa vulnerabilidade Ã© muito interessante. O **WebDav** **nÃ£o permite** o **upload** ou **renomeaÃ§Ã£o** de arquivos com a extensÃ£o **.asp**. Mas vocÃª pode **burlar** isso **adicionando** ao final do nome **";.txt"** e o arquivo serÃ¡ **executado** como se fosse um arquivo .asp (vocÃª tambÃ©m pode **usar ".html" em vez de ".txt"** mas **NÃƒO esqueÃ§a do ";"**).

EntÃ£o vocÃª pode **fazer upload** do seu shell como um arquivo ".**txt"** e **copiÃ¡-lo/movÃª-lo para um arquivo ".asp;.txt"**. Ao acessar esse arquivo pelo servidor web, ele serÃ¡ **executado** (o cadaver dirÃ¡ que a aÃ§Ã£o de movimento nÃ£o funcionou, mas funcionou).

![](<../../.gitbook/assets/image (18) (1) (1).png>)

## Postar credenciais

Se o Webdav estiver usando um servidor Apache, vocÃª deve procurar nos sites configurados no Apache. Comumente:\
_**/etc/apache2/sites-enabled/000-default**_

Dentro dele, vocÃª pode encontrar algo como:
```
ServerAdmin webmaster@localhost
        Alias /webdav /var/www/webdav
        <Directory /var/www/webdav>
                DAV On
                AuthType Digest
                AuthName "webdav"
                AuthUserFile /etc/apache2/users.password
                Require valid-user
```
Como vocÃª pode ver, hÃ¡ arquivos com as **credenciais** vÃ¡lidas para o servidor **webdav**:
```
/etc/apache2/users.password
```
Dentro deste tipo de arquivos, vocÃª encontrarÃ¡ o **nome de usuÃ¡rio** e um **hash** da senha. Estas sÃ£o as credenciais que o servidor webdav estÃ¡ usando para autenticar usuÃ¡rios.

VocÃª pode tentar **quebrÃ¡-las**, ou **adicionar mais** se, por algum motivo, vocÃª quiser **acessar** o servidor **webdav**:
```bash
htpasswd /etc/apache2/users.password <USERNAME> #You will be prompted for the password
```
Para verificar se as novas credenciais estÃ£o funcionando, vocÃª pode fazer:
```bash
wget --user <USERNAME> --ask-password http://domain/path/to/webdav/ -O - -q
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* VocÃª trabalha em uma **empresa de seguranÃ§a cibernÃ©tica**? VocÃª quer ver sua **empresa anunciada no HackTricks**? ou vocÃª quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!
* Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)
* **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Compartilhe seus truques de hacking enviando PRs para o** [**repositÃ³rio hacktricks**](https://github.com/carlospolop/hacktricks) **e para o** [**repositÃ³rio hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

![](<../../.gitbook/assets/image (9) (1) (2).png>)

\
Use [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir e **automatizar fluxos de trabalho** facilmente, alimentados pelas ferramentas comunitÃ¡rias mais avanÃ§adas do mundo.\
Obtenha acesso hoje:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
