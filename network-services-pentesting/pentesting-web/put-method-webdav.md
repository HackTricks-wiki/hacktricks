# WebDav

![](<../../.gitbook/assets/image (9) (1) (2).png>)

\
Utilice [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir y **automatizar flujos de trabajo** con las herramientas de la comunidad **m√°s avanzadas del mundo**.\
Obtenga acceso hoy:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* ¬øTrabaja en una **empresa de ciberseguridad**? ¬øQuiere ver su **empresa anunciada en HackTricks**? ¬øO quiere tener acceso a la **√∫ltima versi√≥n de PEASS o descargar HackTricks en PDF**? ¬°Consulte los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Descubra [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenga el [**swag oficial de PEASS y HackTricks**](https://peass.creator-spring.com)
* **√önase al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠game** en **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparta sus trucos de hacking enviando PR al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

Un servidor **HTTP con WebDav** activo es un servidor donde probablemente se puedan **actualizar, eliminar, mover, copiar** archivos. **A veces** se **necesitan** credenciales **v√°lidas** (generalmente se comprueba con la autenticaci√≥n b√°sica HTTP).

Debe intentar **cargar** alg√∫n **webshell** y **ejecutarlo** desde el servidor web para tomar el control del servidor.\
Por lo general, para **conectar** un servidor WebDav necesitar√° **credenciales v√°lidas**: [**fuerza bruta de WebDav**](../../generic-methodologies-and-resources/brute-force.md#http-basic-auth) _(Autenticaci√≥n b√°sica)_.

Otra configuraci√≥n com√∫n es **prohibir la carga** de archivos con **extensiones** que ser√°n **ejecutados** por el servidor web, debe verificar c√≥mo **burlar esto:**

* **Cargar** archivos con **extensiones ejecutables** (tal vez no est√© prohibido).
* **Cargar** archivos **sin extensiones ejecutables** (como .txt) e intentar **renombrar** el archivo (mover) con una **extensi√≥n ejecutable**.
* **Cargar** archivos **sin extensiones ejecutables** (como .txt) e intentar **copiar** el archivo (mover) con una **extensi√≥n ejecutable.**

## DavTest

**Davtest** intenta **cargar varios archivos con diferentes extensiones** y **verifica** si se **ejecuta** la extensi√≥n:
```bash
davtest [-auth user:password] -move -sendbd auto -url http://<IP> #Uplaod .txt files and try to move it to other extensions
davtest [-auth user:password] -sendbd auto -url http://<IP> #Try to upload every extension
```
Salida de ejemplo:

![](<../../.gitbook/assets/image (19) (1).png>)

Esto no significa que las extensiones **.txt** y **.html se est√©n ejecutando**. Esto significa que puedes **acceder a estos archivos** a trav√©s de la web.

## Cadaver

Puedes usar esta herramienta para **conectarte al servidor WebDav** y realizar acciones (como **subir**, **mover** o **eliminar**) **manualmente**.
```
cadaver <IP>
```
## Petici√≥n PUT

### Description

### Descripci√≥n

The HTTP PUT method is used to update a resource on a server. In the context of web applications, this method is often used to update files on a web server. 

El m√©todo HTTP PUT se utiliza para actualizar un recurso en un servidor. En el contexto de las aplicaciones web, este m√©todo se utiliza a menudo para actualizar archivos en un servidor web.

WebDAV (Web Distributed Authoring and Versioning) is an extension of the HTTP protocol that allows clients to perform remote Web content authoring operations. WebDAV is often used to manage files on a web server. 

WebDAV (Web Distributed Authoring and Versioning) es una extensi√≥n del protocolo HTTP que permite a los clientes realizar operaciones de autor√≠a de contenido web remoto. WebDAV se utiliza a menudo para gestionar archivos en un servidor web.

### Vulnerability

### Vulnerabilidad

The PUT method can be vulnerable to attacks if the server does not properly validate the input data. An attacker can use the PUT method to upload a malicious file to the server, or to modify an existing file to include malicious code. 

El m√©todo PUT puede ser vulnerable a ataques si el servidor no valida correctamente los datos de entrada. Un atacante puede utilizar el m√©todo PUT para cargar un archivo malicioso en el servidor, o para modificar un archivo existente para incluir c√≥digo malicioso.

### Exploitation

### Explotaci√≥n

To exploit this vulnerability, an attacker can use a tool like curl to send a PUT request to the server with a malicious file as the payload. The attacker can then use the file to execute code on the server or to gain access to sensitive information. 

Para explotar esta vulnerabilidad, un atacante puede utilizar una herramienta como curl para enviar una petici√≥n PUT al servidor con un archivo malicioso como carga √∫til. El atacante puede entonces utilizar el archivo para ejecutar c√≥digo en el servidor o para acceder a informaci√≥n sensible.

### Mitigation

### Mitigaci√≥n

To mitigate this vulnerability, the server should properly validate all input data and should only allow authorized users to perform PUT requests. Additionally, the server should be configured to limit the size and type of files that can be uploaded using the PUT method. 

Para mitigar esta vulnerabilidad, el servidor debe validar correctamente todos los datos de entrada y s√≥lo permitir a los usuarios autorizados realizar peticiones PUT. Adem√°s, el servidor debe estar configurado para limitar el tama√±o y el tipo de archivos que se pueden cargar utilizando el m√©todo PUT.
```
curl -T 'shell.txt' 'http://$ip'
```
## Solicitud MOVE
```
curl -X MOVE --header 'Destination:http://$ip/shell.php' 'http://$ip/shell.txt'
```
![](<../../.gitbook/assets/image (9) (1) (2).png>)

Utilice [**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) para construir y automatizar f√°cilmente flujos de trabajo impulsados por las herramientas comunitarias m√°s avanzadas del mundo.\
Obtenga acceso hoy:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Vulnerabilidad WebDav en IIS5/6

Esta vulnerabilidad es muy interesante. El **WebDav** no permite **cargar** o **renombrar** archivos con la extensi√≥n **.asp**. Pero puedes **burlar** esto **a√±adiendo** al final del nombre **";.txt"** y el archivo se ejecutar√° como si fuera un archivo .asp (tambi√©n puedes **usar ".html" en lugar de ".txt"** pero **NO olvides el ";"**).

Luego puedes **cargar** tu shell como un archivo ".**txt"** y **copiar/moverlo a un archivo ".asp;.txt"**. Al acceder a ese archivo a trav√©s del servidor web, se **ejecutar√°** (cadaver dir√° que la acci√≥n de mover no funcion√≥, pero s√≠ lo hizo).

![](<../../.gitbook/assets/image (18) (1) (1).png>)

## Publicar credenciales

Si el Webdav estaba usando un servidor Apache, deber√≠as buscar en los sitios configurados en Apache. Com√∫nmente:\
_**/etc/apache2/sites-enabled/000-default**_

Dentro de √©l, podr√≠as encontrar algo como:
```
ServerAdmin webmaster@localhost
        Alias /webdav /var/www/webdav
        <Directory /var/www/webdav>
                DAV On
                AuthType Digest
                AuthName "webdav"
                AuthUserFile /etc/apache2/users.password
                Require valid-user
```
Como puedes ver, hay archivos con las credenciales v√°lidas para el servidor **webdav**:
```
/etc/apache2/users.password
```
Dentro de este tipo de archivos encontrar√°s el **nombre de usuario** y un **hash** de la contrase√±a. Estas son las credenciales que el servidor webdav utiliza para autenticar a los usuarios.

Puedes intentar **descifrar** las credenciales, o **a√±adir m√°s** si por alguna raz√≥n deseas **acceder** al servidor **webdav**:
```bash
htpasswd /etc/apache2/users.password <USERNAME> #You will be prompted for the password
```
Para comprobar si las nuevas credenciales funcionan, puedes hacer lo siguiente:
```bash
wget --user <USERNAME> --ask-password http://domain/path/to/webdav/ -O - -q
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>‚òÅÔ∏è HackTricks Cloud ‚òÅÔ∏è</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>üê¶ Twitter üê¶</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>üéôÔ∏è Twitch üéôÔ∏è</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>üé• Youtube üé•</strong></a></summary>

* ¬øTrabajas en una **empresa de ciberseguridad**? ¬øQuieres ver tu **empresa anunciada en HackTricks**? ¬øO quieres tener acceso a la **√∫ltima versi√≥n de PEASS o descargar HackTricks en PDF**? ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obt√©n la [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **√önete al** [**üí¨**](https://emojipedia.org/speech-balloon/) **grupo de Discord** o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** [**üê¶**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

![](<../../.gitbook/assets/image (9) (1) (2).png>)

\
Utiliza [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir y **automatizar flujos de trabajo** con las herramientas de la comunidad m√°s avanzadas del mundo.\
Obt√©n acceso hoy mismo:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
