# WebDav

![](<../../.gitbook/assets/image (9) (1) (2).png>)

\
Utilice [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir y automatizar fÃ¡cilmente flujos de trabajo impulsados por las herramientas comunitarias mÃ¡s avanzadas del mundo.\
Obtenga acceso hoy:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Â¿Trabaja en una **empresa de ciberseguridad**? Â¿Quiere ver su **empresa anunciada en HackTricks**? Â¿O quiere tener acceso a la **Ãºltima versiÃ³n de PEASS o descargar HackTricks en PDF**? Â¡Consulte los [**PLANES DE SUSCRIPCIÃ“N**](https://github.com/sponsors/carlospolop)!
* Descubra [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecciÃ³n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obtenga el [**swag oficial de PEASS y HackTricks**](https://peass.creator-spring.com)
* **Ãšnase al** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sÃ­game** en **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparta sus trucos de hacking enviando PR al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

Un servidor **HTTP con WebDav** activo es un servidor donde probablemente se puedan **actualizar, eliminar, mover, copiar** archivos. **A veces** necesitarÃ¡ tener **credenciales vÃ¡lidas** (generalmente verifique con la autenticaciÃ³n bÃ¡sica HTTP).

Debe intentar **cargar** algÃºn **webshell** y **ejecutarlo** desde el servidor web para tomar el control del servidor.\
Por lo general, para **conectar** un servidor WebDav necesitarÃ¡ **credenciales vÃ¡lidas**: [**fuerza bruta de WebDav**](../../generic-methodologies-and-resources/brute-force.md#http-basic-auth) _(AutenticaciÃ³n bÃ¡sica)_.

Otra configuraciÃ³n comÃºn es **prohibir la carga** de archivos con **extensiones** que serÃ¡n **ejecutados** por el servidor web, debe verificar cÃ³mo **burlar esto:**

* **Cargar** archivos con **extensiones ejecutables** (tal vez no estÃ© prohibido).
* **Cargar** archivos **sin extensiones ejecutables** (como .txt) e intentar **renombrar** el archivo (mover) con una **extensiÃ³n ejecutable**.
* **Cargar** archivos **sin extensiones ejecutables** (como .txt) e intentar **copiar** el archivo (mover) con una **extensiÃ³n ejecutable.**

## DavTest

**Davtest** intenta **cargar varios archivos con diferentes extensiones** y **verifica** si se **ejecuta** la extensiÃ³n:
```bash
davtest [-auth user:password] -move -sendbd auto -url http://<IP> #Uplaod .txt files and try to move it to other extensions
davtest [-auth user:password] -sendbd auto -url http://<IP> #Try to upload every extension
```
Salida de ejemplo:

![](<../../.gitbook/assets/image (19) (1) (1).png>)

Esto no significa que las extensiones **.txt** y **.html se estÃ©n ejecutando**. Esto significa que puedes **acceder a estos archivos** a travÃ©s de la web.

## Cadaver

Puedes usar esta herramienta para **conectarte al servidor WebDav** y realizar acciones (como **subir**, **mover** o **eliminar**) **manualmente**.
```
cadaver <IP>
```
## PeticiÃ³n PUT

The HTTP PUT method is used to update a resource on a server. In the context of web applications, this method is often used to update data on a server-side database. However, it can also be used to upload files to a server.

El mÃ©todo HTTP PUT se utiliza para actualizar un recurso en un servidor. En el contexto de las aplicaciones web, este mÃ©todo se utiliza a menudo para actualizar datos en una base de datos del lado del servidor. Sin embargo, tambiÃ©n se puede utilizar para cargar archivos en un servidor.

WebDAV servers also support the PUT method, which allows clients to upload files to the server. This can be useful for attackers who want to upload malicious files to a server.

Los servidores WebDAV tambiÃ©n admiten el mÃ©todo PUT, que permite a los clientes cargar archivos en el servidor. Esto puede ser Ãºtil para los atacantes que desean cargar archivos maliciosos en un servidor.
```
curl -T 'shell.txt' 'http://$ip'
```
## Solicitud MOVE
```
curl -X MOVE --header 'Destination:http://$ip/shell.php' 'http://$ip/shell.txt'
```
![](<../../.gitbook/assets/image (9) (1) (2).png>)

Utilice [**Trickest**](https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks) para construir y automatizar fÃ¡cilmente flujos de trabajo impulsados por las herramientas comunitarias mÃ¡s avanzadas del mundo.\
Obtenga acceso hoy:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}

## Vulnerabilidad WebDav de IIS5/6

Esta vulnerabilidad es muy interesante. El **WebDav** no permite **cargar** o **renombrar** archivos con la extensiÃ³n **.asp**. Pero puedes **burlar** esto **aÃ±adiendo** al final del nombre **";.txt"** y el archivo se **ejecutarÃ¡** como si fuera un archivo .asp (tambiÃ©n puedes **usar ".html" en lugar de ".txt"** pero **NO olvides el ";"**).

Luego puedes **cargar** tu shell como un archivo ".**txt"** y **copiar/moverlo a un archivo ".asp;.txt"**. Al acceder a ese archivo a travÃ©s del servidor web, se **ejecutarÃ¡** (cadaver dirÃ¡ que la acciÃ³n de mover no funcionÃ³, pero sÃ­ lo hizo).

![](<../../.gitbook/assets/image (18) (1) (1).png>)

## Publicar credenciales

Si el Webdav estaba usando un servidor Apache, deberÃ­a buscar en los sitios configurados en Apache. ComÃºnmente:\
_**/etc/apache2/sites-enabled/000-default**_

Dentro de Ã©l, podrÃ­a encontrar algo como:
```
ServerAdmin webmaster@localhost
        Alias /webdav /var/www/webdav
        <Directory /var/www/webdav>
                DAV On
                AuthType Digest
                AuthName "webdav"
                AuthUserFile /etc/apache2/users.password
                Require valid-user
```
Como puedes ver, hay archivos con las credenciales vÃ¡lidas para el servidor **webdav**:
```
/etc/apache2/users.password
```
Dentro de este tipo de archivos encontrarÃ¡s el **nombre de usuario** y un **hash** de la contraseÃ±a. Estas son las credenciales que el servidor webdav utiliza para autenticar a los usuarios.

Puedes intentar **descifrar** las credenciales, o **aÃ±adir mÃ¡s** si por alguna razÃ³n deseas **acceder** al servidor **webdav**:
```bash
htpasswd /etc/apache2/users.password <USERNAME> #You will be prompted for the password
```
Para comprobar si las nuevas credenciales funcionan, puedes hacer lo siguiente:
```bash
wget --user <USERNAME> --ask-password http://domain/path/to/webdav/ -O - -q
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* Â¿Trabajas en una **empresa de ciberseguridad**? Â¿Quieres ver tu **empresa anunciada en HackTricks**? Â¿O quieres tener acceso a la **Ãºltima versiÃ³n de PEASS o descargar HackTricks en PDF**? Â¡Consulta los [**PLANES DE SUSCRIPCIÃ“N**](https://github.com/sponsors/carlospolop)!
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecciÃ³n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* ObtÃ©n la [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **Ãšnete al** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) **grupo de Discord** o al [**grupo de telegram**](https://t.me/peass) o **sÃ­gueme** en **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

![](<../../.gitbook/assets/image (9) (1) (2).png>)

\
Utiliza [**Trickest**](https://trickest.com/?utm\_campaign=hacktrics\&utm\_medium=banner\&utm\_source=hacktricks) para construir y **automatizar flujos de trabajo** con las herramientas de la comunidad mÃ¡s avanzadas del mundo.\
ObtÃ©n acceso hoy mismo:

{% embed url="https://trickest.com/?utm_campaign=hacktrics&utm_medium=banner&utm_source=hacktricks" %}
