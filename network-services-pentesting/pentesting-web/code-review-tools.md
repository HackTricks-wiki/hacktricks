# Herramientas de revisiÃ³n de cÃ³digo

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Â¿Trabajas en una **empresa de ciberseguridad**? Â¿Quieres ver tu **empresa anunciada en HackTricks**? Â¿O quieres tener acceso a la **Ãºltima versiÃ³n de PEASS o descargar HackTricks en PDF**? Â¡Consulta los [**PLANES DE SUSCRIPCIÃ“N**](https://github.com/sponsors/carlospolop)!

- Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecciÃ³n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- ObtÃ©n el [**swag oficial de PEASS y HackTricks**](https://peass.creator-spring.com)

- **Ãšnete al** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) **grupo de Discord** o al [**grupo de telegram**](https://t.me/peass) o **sÃ­gueme** en **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Comparte tus trucos de hacking enviando PR al [repositorio de hacktricks](https://github.com/carlospolop/hacktricks) y al [repositorio de hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

## General

* [**https://owasp.org/www-community/Source\_Code\_Analysis\_Tools**](https://owasp.org/www-community/Source\_Code\_Analysis\_Tools)\
  
* [**https://github.com/analysis-tools-dev/static-analysis**](https://github.com/analysis-tools-dev/static-analysis)
```bash
https://www.sonarqube.org/downloads/
https://deepsource.io/signup/
https://github.com/pyupio/safety
https://github.com/returntocorp/semgrep
https://github.com/WhaleShark-Team/cobra
https://github.com/insidersec/insider

# Find interesting strings
https://github.com/s0md3v/hardcodes
https://github.com/micha3lb3n/SourceWolf
https://libraries.io/pypi/detect-secrets
```
## JavaScript
### Descubrimiento
1. Burp:
   - Spider y descubrir contenido
   - Sitemap > filtro
   - Sitemap > clic derecho en el dominio > Herramientas de compromiso > Buscar scripts
2. [WaybackURLs](https://github.com/tomnomnom/waybackurls):
   - `waybackurls <dominio> |grep -i "\.js" |sort -u`
### AnÃ¡lisis estÃ¡tico
#### Desminimizar/Embellecer
https://prettier.io/playground/
https://beautifier.io/
#### Desofuscar/Desempaquetar
__Nota__: Puede que no sea posible desofuscar completamente.
1. Encontrar y usar archivos .map:
   - Si los archivos .map estÃ¡n expuestos, se pueden usar para desofuscar fÃ¡cilmente.
   - ComÃºnmente, foo.js.map mapea a foo.js. BÃºscalos manualmente.
   - Usa [JS Miner](https://github.com/PortSwigger/js-miner) para buscarlos.
    - AsegÃºrate de que se realice un escaneo activo.
    - Lee '[Consejos/Notas](https://github.com/minamo7sen/burp-JS-Miner/wiki#tips--notes)'
   - Si se encuentran, usa [Maximize](https://www.npmjs.com/package/maximize) para desofuscar.
2. Sin archivos .map, prueba JSnice:
   - Referencias: http://jsnice.org/ y https://www.npmjs.com/package/jsnice
   - Consejos:
     - Si usas jsnice.org, haz clic en el botÃ³n de opciones junto al botÃ³n "Nicify JavaScript" y desmarca "Infer types" para reducir el desorden en el cÃ³digo con comentarios.
     - AsegÃºrate de no dejar ninguna lÃ­nea vacÃ­a antes del script, ya que puede afectar al proceso de desofuscaciÃ³n y dar resultados inexactos.
3. Usa console.log(<packerReturnVariable>);
   - Encuentra el valor de retorno al final y cÃ¡mbialo a `console.log(<packerReturnVariable>);` para que se imprima el js desofuscado en lugar de ejecutarse.
   - Luego, pega el js modificado (y aÃºn ofuscado) en https://jsconsole.com/ para ver el js desofuscado registrado en la consola.
   - Finalmente, pega la salida desofuscada en https://prettier.io/playground/ para embellecerla para su anÃ¡lisis.
   - __Nota__: Si aÃºn ves js empaquetado (pero diferente), puede estar empaquetado recursivamente. Repite el proceso.
#### Analizar
Referencias:
https://medium.com/techiepedia/javascript-code-review-guide-for-bug-bounty-hunters-c95a8aa7037a

 Busca:
- Carga anti-depuraciÃ³n
  - Angular: [enableProdMode](https://blog.nvisium.com/angular-for-pentesters-part-2)
- Secretos
  - Usa:
    - [JS Miner](https://github.com/PortSwigger/js-miner)
    - Patrones [RegHex](https://github.com/l4yton/RegHex)
    - Patrones [gf](https://github.com/tomnomnom/gf/tree/master/examples)
    - Busca patrones relevantes en el diccionario:
      - pass, user, admin
      - auth, login, sign, challenge, 2fa
      - key, apikey, api_key, api-key, jwt, token
      - secret, security, secure
      - ...
    - RevisiÃ³n manual
  - Si se encuentra una clave de API, comprueba aquÃ­ la sintaxis de uso potencial: https://github.com/streaak/keyhacks.
- Funciones vulnerables
  - InnerHTML() - Si encuentras esto, significa que hay una posibilidad potencial de XSS si no se realiza una sanitizaciÃ³n adecuada. Incluso si tu carga Ãºtil estÃ¡ sanitizada, no te preocupes. Rastrea el cÃ³digo para averiguar dÃ³nde se realiza la sanitizaciÃ³n. EstÃºdialo e intenta sortear la sanitizaciÃ³n.
  - Postmessage() - Si has leÃ­do mi publicaciÃ³n anterior (https://medium.com/techiepedia/what-are-sop-cors-and-ways-to-exploit-it-62a5e02100dc), notarÃ¡s que Postmessage() podrÃ­a llevar a un problema potencial de CORS. Si el segundo parÃ¡metro de la funciÃ³n se establece en *, eres afortunado. Consulta mi publicaciÃ³n anterior para entender mÃ¡s sobre el mecanismo detrÃ¡s de esto.
  - String.prototype.search() - Esta funciÃ³n parece normal. Â¿Por quÃ© serÃ­a una funciÃ³n peligrosa? Bueno, es porque algunos desarrolladores la usaron para encontrar la ocurrencia de una cadena dentro de otra cadena. Sin embargo, "." se trata como comodÃ­n en esta funciÃ³n. AsÃ­ que, si esta funciÃ³n se usa como comprobaciÃ³n de sanitizaciÃ³n, puedes simplemente sortearla introduciendo ".". Consulta el informe de hackerone de Filedescryptor: https://hackerone.com/reports/129873
- Endpoints y parÃ¡metros
  - Usa [LinkFinder](https://github.com/GerbenJavado/LinkFinder) y [JS Miner](https://github.com/PortSwigger/js-miner).
- Bibliotecas y dependencias vulnerables
  - Usa [Retire.js](https://retirejs.github.io/retire.js/) y [NPM](https://snyk.io/advisor/) (desplÃ¡zate hacia abajo hasta la secciÃ³n de seguridad > enlace de todas las versiones).
- URLs de la nube
  - Usa [JS Miner](https://github.com/PortSwigger/js-miner).
- Subdominios
  - Usa [JS Miner](https://github.com/PortSwigger/js-miner).
- Errores de lÃ³gica
  - ObtÃ©n conciencia situacional:
    - `use strict;`?
  - Busca controles del lado del cliente:
    - disable, enable, hidden, hide, show
    - catch, finally, throw, try
    - input, validate, verify, valid, correct, check, confirm, require, ..
  - Busca no primitivos:
    - function , =>
    - class
### AnÃ¡lisis dinÃ¡mico

Referencias
- https://www.youtube.com/watch?v=_v8r_t4v6hQ
- https://blog.nvisium.com/angular-for-pentesters-part-1
- https://blog.nvisium.com/angular-for-pentesters-part-2

Herramientas
- https://portswigger.net/burp/documentation/desktop/tools/dom-invader

#### Referencias menos utilizadas
- https://cyberchef.org/
- https://olajs.com/javascript-prettifier
- https://jshint.com/
- https://github.com/jshint/jshint/

## NodeJS
```
https://github.com/ajinabraham/nodejsscan
```
## Electron

Electron es un framework de cÃ³digo abierto que permite crear aplicaciones de escritorio multiplataforma utilizando tecnologÃ­as web como HTML, CSS y JavaScript. Es utilizado por muchas aplicaciones populares como Slack, Discord y Visual Studio Code.

Sin embargo, debido a su naturaleza basada en web, las aplicaciones de Electron pueden ser vulnerables a ataques comunes de seguridad web, como XSS y CSRF. Es importante realizar una revisiÃ³n de cÃ³digo exhaustiva para identificar y corregir posibles vulnerabilidades en la aplicaciÃ³n de Electron.
```
https://github.com/doyensec/electronegativity
```
## Python

Python es un lenguaje de programaciÃ³n popular utilizado en el desarrollo de aplicaciones web y en la creaciÃ³n de herramientas de hacking. Algunas de las bibliotecas mÃ¡s utilizadas en el hacking son `requests`, `beautifulsoup4`, `selenium` y `scrapy`. 

`Requests` es una biblioteca utilizada para enviar solicitudes HTTP/HTTPS a un servidor web y recibir respuestas. `BeautifulSoup4` es una biblioteca utilizada para analizar y extraer informaciÃ³n de documentos HTML y XML. `Selenium` es una biblioteca utilizada para automatizar pruebas en navegadores web. `Scrapy` es un framework utilizado para extraer datos de sitios web de manera estructurada.

Python tambiÃ©n es utilizado en la creaciÃ³n de herramientas de hacking personalizadas, como scripts de automatizaciÃ³n de tareas repetitivas, herramientas de escaneo de puertos y vulnerabilidades, y herramientas de explotaciÃ³n de vulnerabilidades.
```bash
# bandit
https://github.com/PyCQA/bandit
# pyt
https://github.com/python-security/pyt
```
## .NET

.NET es un framework de software desarrollado por Microsoft que se utiliza para construir aplicaciones de Windows y web. Es un entorno de tiempo de ejecuciÃ³n que permite a los desarrolladores escribir aplicaciones en varios lenguajes de programaciÃ³n, como C#, VB.NET y F#. AdemÃ¡s, .NET proporciona una amplia biblioteca de clases y funciones que los desarrolladores pueden utilizar para crear aplicaciones de alta calidad de manera eficiente. En tÃ©rminos de seguridad, .NET tiene algunas caracterÃ­sticas Ãºtiles, como la capacidad de implementar la autenticaciÃ³n y la autorizaciÃ³n en las aplicaciones. Sin embargo, tambiÃ©n puede ser vulnerable a ciertos tipos de ataques, como la inyecciÃ³n de SQL y la falsificaciÃ³n de solicitudes entre sitios (CSRF). Por lo tanto, es importante que los desarrolladores de .NET sean conscientes de estas vulnerabilidades y tomen medidas para proteger sus aplicaciones.
```bash
# dnSpy
https://github.com/0xd4d/dnSpy

# .NET compilation
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe test.cs
```
## Java

Java es un lenguaje de programaciÃ³n popular utilizado en el desarrollo de aplicaciones empresariales y de servidor. Es conocido por su portabilidad, seguridad y capacidad para manejar grandes cantidades de datos. Sin embargo, tambiÃ©n es conocido por ser vulnerable a ciertos tipos de ataques, como la inyecciÃ³n de cÃ³digo y la deserializaciÃ³n no segura.

### Herramientas de revisiÃ³n de cÃ³digo Java

- [FindBugs](http://findbugs.sourceforge.net/) - Herramienta de anÃ¡lisis estÃ¡tico de cÃ³digo que busca errores de programaciÃ³n comunes en Java.
- [Checkstyle](http://checkstyle.sourceforge.net/) - Herramienta de anÃ¡lisis estÃ¡tico de cÃ³digo que busca violaciones de estilo de codificaciÃ³n en Java.
- [PMD](https://pmd.github.io/) - Herramienta de anÃ¡lisis estÃ¡tico de cÃ³digo que busca errores de programaciÃ³n comunes en Java y otros lenguajes.
- [SonarQube](https://www.sonarqube.org/) - Plataforma de anÃ¡lisis de cÃ³digo que proporciona informes detallados sobre la calidad del cÃ³digo, la seguridad y la cobertura de pruebas.
- [Eclipse IDE](https://www.eclipse.org/ide/) - Entorno de desarrollo integrado que incluye herramientas de anÃ¡lisis de cÃ³digo para Java.
- [IntelliJ IDEA](https://www.jetbrains.com/idea/) - Entorno de desarrollo integrado que incluye herramientas de anÃ¡lisis de cÃ³digo para Java.

Es importante utilizar estas herramientas para identificar y corregir vulnerabilidades en el cÃ³digo Java antes de que puedan ser explotadas por atacantes.
```bash
# JD-Gui
https://github.com/java-decompiler/jd-gui

# Java compilation step-by-step
javac -source 1.8 -target 1.8 test.java
mkdir META-INF
echo "Main-Class: test" > META-INF/MANIFEST.MF
jar cmvf META-INF/MANIFEST.MF test.jar test.class
```
| Tarea           | Comando                                                   |
| --------------- | --------------------------------------------------------- |
| Ejecutar Jar    | java -jar \[jar]                                          |
| Descomprimir Jar| unzip -d \[directorio de salida] \[jar]                   |
| Crear Jar       | jar -cmf META-INF/MANIFEST.MF \[jar de salida] \*         |
| Base64 SHA256   | sha256sum \[archivo] \| cut -d' ' -f1 \| xxd -r -p \| base64 |
| Eliminar Firma  | rm META-INF/_.SF META-INF/_.RSA META-INF/\*.DSA           |
| Eliminar de Jar | zip -d \[jar] \[archivo a eliminar]                       |
| Descompilar clase| procyon -o . \[ruta de la clase]                          |
| Descompilar Jar | procyon -jar \[jar] -o \[directorio de salida]            |
| Compilar clase  | javac \[ruta del archivo .java]                           |

## Go
```bash
https://github.com/securego/gosec
```
## PHP

[Psalm](https://phpmagazine.net/2018/12/find-errors-in-your-php-applications-with-psalm.html) y [PHPStan](https://phpmagazine.net/2020/09/phpstan-pro-edition-launched.html).

### Plugins de Wordpress

[https://www.pluginvulnerabilities.com/plugin-security-checker/](https://www.pluginvulnerabilities.com/plugin-security-checker/)

## Solidity

* [https://www.npmjs.com/package/solium](https://www.npmjs.com/package/solium)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Â¿Trabajas en una **empresa de ciberseguridad**? Â¿Quieres ver tu **empresa anunciada en HackTricks**? Â¿O quieres tener acceso a la **Ãºltima versiÃ³n de PEASS o descargar HackTricks en PDF**? Â¡Consulta los [**PLANES DE SUSCRIPCIÃ“N**](https://github.com/sponsors/carlospolop)!

- Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecciÃ³n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- ObtÃ©n el [**swag oficial de PEASS y HackTricks**](https://peass.creator-spring.com)

- **Ãšnete al** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sÃ­gueme en** **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Comparte tus trucos de hacking enviando PR al repositorio [hacktricks](https://github.com/carlospolop/hacktricks) y al repositorio [hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
