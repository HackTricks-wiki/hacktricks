# Ferramentas de RevisÃ£o de CÃ³digo

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- VocÃª trabalha em uma **empresa de seguranÃ§a cibernÃ©tica**? VocÃª quer ver sua **empresa anunciada no HackTricks**? ou quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Confira os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!

- Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)

- **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Compartilhe suas tÃ©cnicas de hacking enviando PRs para o [repositÃ³rio hacktricks](https://github.com/carlospolop/hacktricks) e [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

## Geral

* [**https://owasp.org/www-community/Source\_Code\_Analysis\_Tools**](https://owasp.org/www-community/Source\_Code\_Analysis\_Tools)\
  
* [**https://github.com/analysis-tools-dev/static-analysis**](https://github.com/analysis-tools-dev/static-analysis)
```bash
https://www.sonarqube.org/downloads/
https://deepsource.io/signup/
https://github.com/pyupio/safety
https://github.com/returntocorp/semgrep
https://github.com/WhaleShark-Team/cobra
https://github.com/insidersec/insider

# Find interesting strings
https://github.com/s0md3v/hardcodes
https://github.com/micha3lb3n/SourceWolf
https://libraries.io/pypi/detect-secrets
```
## JavaScript
### Descoberta
1. Burp:
   - Spider e descobrir conteÃºdo
   - Sitemap > filtro
   - Sitemap > clique com o botÃ£o direito do mouse no domÃ­nio > Ferramentas de engajamento > Encontrar scripts
2. [WaybackURLs](https://github.com/tomnomnom/waybackurls):
   - `waybackurls <domÃ­nio> |grep -i "\.js" |sort -u`
### AnÃ¡lise estÃ¡tica
#### Desminificar/Embelezar/Formatar
https://prettier.io/playground/
https://beautifier.io/
#### Desofuscar/Descompactar
__Nota__: Pode nÃ£o ser possÃ­vel desofuscar completamente.
1. Encontre e use arquivos .map:
   - Se os arquivos .map estiverem expostos, eles podem ser usados para desofuscar facilmente.
   - Comumente, foo.js.map mapeia para foo.js. Procure manualmente por eles.
   - Use [JS Miner](https://github.com/PortSwigger/js-miner) para procurÃ¡-los.
    - Certifique-se de que a verificaÃ§Ã£o ativa seja realizada.
    - Leia '[Dicas/Notas](https://github.com/minamo7sen/burp-JS-Miner/wiki#tips--notes)'
   - Se encontrados, use [Maximize](https://www.npmjs.com/package/maximize) para desofuscar.
2. Sem arquivos .map, tente JSnice:
   - ReferÃªncias: http://jsnice.org/ & https://www.npmjs.com/package/jsnice
   - Dicas:
     - Se estiver usando jsnice.org, clique no botÃ£o de opÃ§Ãµes ao lado do botÃ£o "Nicify JavaScript" e desmarque "Infer types" para reduzir a desordem no cÃ³digo com comentÃ¡rios.
     - Certifique-se de nÃ£o deixar nenhuma linha vazia antes do script, pois isso pode afetar o processo de desofuscaÃ§Ã£o e fornecer resultados imprecisos.
3. Use console.log(<packerReturnVariable>);
   - Encontre o valor de retorno no final e altere-o para `console.log(<packerReturnVariable>);` para que o js desofuscado seja impresso em vez de ser executado.
   - Em seguida, cole o js modificado (e ainda ofuscado) em https://jsconsole.com/ para ver o js desofuscado registrado no console.
   - Finalmente, cole a saÃ­da desofuscada em https://prettier.io/playground/ para embelezÃ¡-la para anÃ¡lise.
   - __Nota__: Se vocÃª ainda estiver vendo js compactado (mas diferente), ele pode estar compactado recursivamente. Repita o processo.
#### Analisar
ReferÃªncias:
https://medium.com/techiepedia/javascript-code-review-guide-for-bug-bounty-hunters-c95a8aa7037a

 Procure por:
- Carregamento anti-depurador
  - Angular: [enableProdMode](https://blog.nvisium.com/angular-for-pentesters-part-2)
- Segredos
  - Use:
    - [JS Miner](https://github.com/PortSwigger/js-miner)
    - [RegHex](https://github.com/l4yton/RegHex) padrÃµes
    - [gf](https://github.com/tomnomnom/gf/tree/master/examples) padrÃµes
    - Grep padrÃµes relevantes do dicionÃ¡rio:
      - pass, user, admin
      - auth, login, sign, challenge, 2fa
      - key, apikey, api_key, api-key, jwt, token
      - secret, security, secure
      - ...
    - RevisÃ£o manual
  - Se a chave da API for encontrada, verifique aqui a sintaxe potencial de uso: https://github.com/streaak/keyhacks.
- FunÃ§Ãµes vulnerÃ¡veis
  - InnerHTML() - Se vocÃª encontrou isso, significa que hÃ¡ uma chance potencial de XSS se nÃ£o houver uma sanitizaÃ§Ã£o adequada. Mesmo que sua carga Ãºtil esteja sanitizada, nÃ£o se preocupe. Trace o cÃ³digo para descobrir onde a sanitizaÃ§Ã£o ocorre. Estude-o e tente contornar a sanitizaÃ§Ã£o.
  - Postmessage() - Se vocÃª leu meu post anterior (https://medium.com/techiepedia/what-are-sop-cors-and-ways-to-exploit-it-62a5e02100dc), vocÃª notaria que Postmessage() pode levar a um possÃ­vel problema de CORS. Se o segundo parÃ¢metro da funÃ§Ã£o for definido como *, vocÃª Ã© o sortudo. Confira meu post anterior para entender mais sobre o mecanismo por trÃ¡s.
  - String.prototype.search() - Esta funÃ§Ã£o parece normal. Por que seria uma funÃ§Ã£o perigosa? Bem, Ã© porque alguns desenvolvedores usaram isso para encontrar a ocorrÃªncia de uma string dentro de outra string. No entanto, "." Ã© tratado como curinga nesta funÃ§Ã£o. EntÃ£o, se esta funÃ§Ã£o for usada como verificaÃ§Ã£o de sanitizaÃ§Ã£o, vocÃª pode simplesmente contornÃ¡-la inserindo ".". Confira o relatÃ³rio do hackerone do Filedescryptor: https://hackerone.com/reports/129873
- Endpoints e parÃ¢metros
  - Use [LinkFinder](https://github.com/GerbenJavado/LinkFinder) & [JS Miner](https://github.com/PortSwigger/js-miner).
- Bibliotecas e dependÃªncias vulnerÃ¡veis
  - Use [Retire.js](https://retirejs.github.io/retire.js/) e [NPM](https://snyk.io/advisor/) (role para baixo atÃ© a seÃ§Ã£o de seguranÃ§a > link de todas as versÃµes).
- URLs de nuvem
  - Use [JS Miner](https://github.com/PortSwigger/js-miner).
- SubdomÃ­nios
  - Use [JS Miner](https://github.com/PortSwigger/js-miner).
- Falhas de lÃ³gica
  - Obtenha consciÃªncia situacional:
    - `use strict;`?
  - Grep para controles do lado do cliente:
    - disable, enable, hidden, hide, show
    - catch, finally, throw, try
    - input, validate, verify, valid, correct, check, confirm, require, ..
  - Grep para nÃ£o-primitivos:
    - function , =>
    - class
### AnÃ¡lise dinÃ¢mica

ReferÃªncias
- https://www.youtube.com/watch?v=_v8r_t4v6hQ
- https://blog.nvisium.com/angular-for-pentesters-part-1
- https://blog.nvisium.com/angular-for-pentesters-part-2

Ferramentas
- https://portswigger.net/burp/documentation/desktop/tools/dom-invader

#### ReferÃªncias menos usadas
- https://cyberchef.org/
- https://olajs.com/javascript-prettifier
- https://jshint.com/
- https://github.com/jshint/jshint/

## NodeJS
```
https://github.com/ajinabraham/nodejsscan
```
## Electron

Electron Ã© um framework de cÃ³digo aberto criado pela equipe do GitHub. Ele permite que os desenvolvedores criem aplicativos de desktop multiplataforma usando tecnologias web como HTML, CSS e JavaScript. O Electron Ã© usado por muitos aplicativos populares, incluindo o Slack, o Visual Studio Code e o Discord.

Embora o Electron seja uma ferramenta poderosa para criar aplicativos de desktop, ele tambÃ©m pode ser uma fonte de vulnerabilidades de seguranÃ§a. Os aplicativos do Electron sÃ£o executados em um ambiente de navegador incorporado, o que significa que eles tÃªm acesso a muitos recursos do sistema operacional, como o sistema de arquivos e a rede. Isso pode ser Ãºtil para os desenvolvedores, mas tambÃ©m pode ser explorado por atacantes.

Os testadores de seguranÃ§a devem estar cientes das vulnerabilidades comuns do Electron, como a execuÃ§Ã£o remota de cÃ³digo (RCE) e a injeÃ§Ã£o de cÃ³digo malicioso. Eles tambÃ©m devem estar familiarizados com as ferramentas de anÃ¡lise de seguranÃ§a do Electron, como o Electron Security Checklist e o Electron Scanner, para ajudar a identificar possÃ­veis vulnerabilidades em aplicativos do Electron.
```
https://github.com/doyensec/electronegativity
```
## Python

Python Ã© uma linguagem de programaÃ§Ã£o popular usada em muitas aplicaÃ§Ãµes, incluindo desenvolvimento web. Ã‰ uma linguagem interpretada, o que significa que o cÃ³digo Ã© executado linha por linha em tempo de execuÃ§Ã£o. Python Ã© conhecido por sua sintaxe clara e concisa, tornando-o uma escolha popular para iniciantes em programaÃ§Ã£o.

Algumas ferramentas Ãºteis para revisÃ£o de cÃ³digo Python incluem:

- **Pylint**: uma ferramenta de anÃ¡lise de cÃ³digo que verifica se o cÃ³digo Python estÃ¡ em conformidade com as convenÃ§Ãµes de codificaÃ§Ã£o definidas pela PEP 8. Ele tambÃ©m pode detectar erros comuns de programaÃ§Ã£o, como variÃ¡veis nÃ£o utilizadas e referÃªncias indefinidas.

- **Pyflakes**: uma ferramenta de anÃ¡lise de cÃ³digo que verifica se o cÃ³digo Python tem erros de sintaxe ou referÃªncias indefinidas.

- **Bandit**: uma ferramenta de seguranÃ§a de cÃ³digo que verifica se o cÃ³digo Python tem vulnerabilidades de seguranÃ§a conhecidas.

- **Mypy**: uma ferramenta de anÃ¡lise de tipo estÃ¡tico que verifica se o cÃ³digo Python tem erros de tipo.

- **Black**: uma ferramenta de formataÃ§Ã£o de cÃ³digo que ajuda a manter a consistÃªncia do estilo de cÃ³digo Python em um projeto.
```bash
# bandit
https://github.com/PyCQA/bandit
# pyt
https://github.com/python-security/pyt
```
## .NET

O .NET Ã© uma plataforma de desenvolvimento de software da Microsoft que Ã© amplamente utilizada para criar aplicativos Windows e Web. Ele fornece uma estrutura de desenvolvimento de software que inclui uma linguagem de programaÃ§Ã£o (C # ou VB.NET), um ambiente de tempo de execuÃ§Ã£o e uma biblioteca de classes. O .NET Ã© uma plataforma poderosa e flexÃ­vel que permite aos desenvolvedores criar aplicativos de alta qualidade com facilidade.

### Ferramentas de RevisÃ£o de CÃ³digo .NET

Existem vÃ¡rias ferramentas de revisÃ£o de cÃ³digo disponÃ­veis para o .NET que podem ajudar a identificar vulnerabilidades de seguranÃ§a em seu cÃ³digo. Algumas das ferramentas mais populares incluem:

- **Visual Studio**: O Visual Studio inclui uma sÃ©rie de ferramentas de anÃ¡lise de cÃ³digo que podem ajudar a identificar problemas de seguranÃ§a em seu cÃ³digo .NET. Essas ferramentas incluem o Code Analysis, que verifica seu cÃ³digo em busca de problemas de seguranÃ§a e o FxCop, que verifica seu cÃ³digo em busca de conformidade com as diretrizes de codificaÃ§Ã£o.

- **ReSharper**: O ReSharper Ã© uma ferramenta de revisÃ£o de cÃ³digo para o Visual Studio que pode ajudar a identificar problemas de seguranÃ§a em seu cÃ³digo .NET. Ele fornece sugestÃµes de correÃ§Ã£o de cÃ³digo em tempo real e pode ajudar a melhorar a qualidade do seu cÃ³digo.

- **NDepend**: O NDepend Ã© uma ferramenta de anÃ¡lise de cÃ³digo que pode ajudar a identificar problemas de seguranÃ§a em seu cÃ³digo .NET. Ele fornece uma anÃ¡lise detalhada do seu cÃ³digo e pode ajudar a identificar Ã¡reas que precisam de melhorias de seguranÃ§a.

- **SonarQube**: O SonarQube Ã© uma plataforma de anÃ¡lise de cÃ³digo que pode ajudar a identificar problemas de seguranÃ§a em seu cÃ³digo .NET. Ele fornece uma anÃ¡lise detalhada do seu cÃ³digo e pode ajudar a identificar Ã¡reas que precisam de melhorias de seguranÃ§a.

- **Fortify**: O Fortify Ã© uma ferramenta de anÃ¡lise de seguranÃ§a que pode ajudar a identificar vulnerabilidades de seguranÃ§a em seu cÃ³digo .NET. Ele fornece uma anÃ¡lise detalhada do seu cÃ³digo e pode ajudar a identificar Ã¡reas que precisam de melhorias de seguranÃ§a.
```bash
# dnSpy
https://github.com/0xd4d/dnSpy

# .NET compilation
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe test.cs
```
## Java

Java Ã© uma linguagem de programaÃ§Ã£o popular usada para desenvolver aplicativos em vÃ¡rias plataformas. Ã‰ uma linguagem orientada a objetos e Ã© executada em uma mÃ¡quina virtual Java (JVM). A JVM permite que o cÃ³digo Java seja executado em qualquer plataforma que tenha uma JVM instalada. O Java Ã© usado em muitos aplicativos da web e Ã© uma das linguagens mais populares para desenvolvimento de aplicativos Android.
```bash
# JD-Gui
https://github.com/java-decompiler/jd-gui

# Java compilation step-by-step
javac -source 1.8 -target 1.8 test.java
mkdir META-INF
echo "Main-Class: test" > META-INF/MANIFEST.MF
jar cmvf META-INF/MANIFEST.MF test.jar test.class
```
| Tarefa           | Comando                                                   |
| ---------------- | --------------------------------------------------------- |
| Executar Jar     | java -jar \[jar]                                          |
| Descompactar Jar | unzip -d \[diretÃ³rio de saÃ­da] \[jar]                     |
| Criar Jar        | jar -cmf META-INF/MANIFEST.MF \[jar de saÃ­da] \*          |
| Base64 SHA256    | sha256sum \[arquivo] \| cut -d' ' -f1 \| xxd -r -p \| base64 |
| Remover Assinatura| rm META-INF/_.SF META-INF/_.RSA META-INF/\*.DSA           |
| Excluir do Jar   | zip -d \[jar] \[arquivo a ser removido]                   |
| Descompilar classe | procyon -o . \[caminho para a classe]                     |
| Descompilar Jar  | procyon -jar \[jar] -o \[diretÃ³rio de saÃ­da]              |
| Compilar classe  | javac \[caminho para o arquivo .java]                     |
```bash
https://github.com/securego/gosec
```
## PHP

[Psalm](https://phpmagazine.net/2018/12/find-errors-in-your-php-applications-with-psalm.html) e [PHPStan](https://phpmagazine.net/2020/09/phpstan-pro-edition-launched.html).

### Plugins do Wordpress

[https://www.pluginvulnerabilities.com/plugin-security-checker/](https://www.pluginvulnerabilities.com/plugin-security-checker/)

## Solidity

* [https://www.npmjs.com/package/solium](https://www.npmjs.com/package/solium)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- VocÃª trabalha em uma **empresa de ciberseguranÃ§a**? VocÃª quer ver sua **empresa anunciada no HackTricks**? ou vocÃª quer ter acesso Ã  **Ãºltima versÃ£o do PEASS ou baixar o HackTricks em PDF**? Verifique os [**PLANOS DE ASSINATURA**](https://github.com/sponsors/carlospolop)!

- Descubra [**A FamÃ­lia PEASS**](https://opensea.io/collection/the-peass-family), nossa coleÃ§Ã£o exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Adquira o [**swag oficial do PEASS & HackTricks**](https://peass.creator-spring.com)

- **Junte-se ao** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo do Discord**](https://discord.gg/hRep4RUj7f) ou ao [**grupo do telegram**](https://t.me/peass) ou **siga-me** no **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Compartilhe suas tÃ©cnicas de hacking enviando PRs para o [repositÃ³rio hacktricks](https://github.com/carlospolop/hacktricks) e [hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
