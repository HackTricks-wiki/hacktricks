# 22 - SSH/SFTPã®ãƒšãƒ³ãƒ†ã‚¹ãƒˆ

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚
* [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„ã€‚
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€PRã‚’** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ã«æå‡º**ã—ã¦ãã ã•ã„ã€‚

</details>

<img src="../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

ã‚‚ã—ã€**ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚­ãƒ£ãƒªã‚¢**ã«èˆˆå‘³ãŒã‚ã‚Šã€**è§£èª­ä¸èƒ½ãªã‚‚ã®ã‚’ãƒãƒƒã‚¯**ã—ãŸã„å ´åˆã¯ã€**æ¡ç”¨ä¸­ã§ã™ï¼**ï¼ˆæµæš¢ãªãƒãƒ¼ãƒ©ãƒ³ãƒ‰èªã®èª­ã¿æ›¸ããŒå¿…è¦ã§ã™ï¼‰ã€‚

{% embed url="https://www.stmcyber.com/careers" %}

## åŸºæœ¬æƒ…å ±

**SSHã¾ãŸã¯Secure Shellã¾ãŸã¯Secure Socket Shell**ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ**ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãªã„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’ä»‹ã—ã¦ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã«å®‰å…¨ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ—ãƒ­ãƒˆã‚³ãƒ«**ã§ã™ã€‚

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆï¼š** 22
```
22/tcp open  ssh     syn-ack
```
**SSHã‚µãƒ¼ãƒãƒ¼:**

* [openSSH](http://www.openssh.org) â€“ OpenBSD SSHã€BSDã€Linuxãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã€ãŠã‚ˆã³Windows 10ä»¥é™ã«æ­è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚
* [Dropbear](https://matt.ucc.asn.au/dropbear/dropbear.html) â€“ ä½ãƒ¡ãƒ¢ãƒªã¨ãƒ—ãƒ­ã‚»ãƒƒã‚µãƒªã‚½ãƒ¼ã‚¹ã®ç’°å¢ƒå‘ã‘ã®SSHå®Ÿè£…ã§ã€OpenWrtã«æ­è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚
* [PuTTY](https://www.chiark.greenend.org.uk/\~sgtatham/putty/) â€“ Windowså‘ã‘ã®SSHå®Ÿè£…ã§ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ä¸€èˆ¬çš„ã«ä½¿ç”¨ã•ã‚Œã¾ã™ãŒã€ã‚µãƒ¼ãƒãƒ¼ã®ä½¿ç”¨ã¯ç¨€ã§ã™ã€‚
* [CopSSH](https://www.itefix.net/copssh) â€“ Windowså‘ã‘ã®OpenSSHã®å®Ÿè£…ã§ã™ã€‚

**SSHãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã®å®Ÿè£…ï¼‰:**

* [libssh](https://www.libssh.org) â€“ SSHv2ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’å®Ÿè£…ã—ãŸãƒãƒ«ãƒãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®Cãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã€[Python](https://github.com/ParallelSSH/ssh-python)ã€[Perl](https://github.com/garnier-quentin/perl-libssh/)ã€ãŠã‚ˆã³[R](https://github.com/ropensci/ssh)ã«ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãŒã‚ã‚Šã¾ã™ã€‚KDEã§ã¯sftpã«ã€GitHubã§ã¯git SSHã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚
* [wolfSSH](https://www.wolfssl.com/products/wolfssh/) â€“ ANSI Cã§æ›¸ã‹ã‚ŒãŸSSHv2ã‚µãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã€çµ„ã¿è¾¼ã¿ã€RTOSã€ãƒªã‚½ãƒ¼ã‚¹åˆ¶ç´„ã®ã‚ã‚‹ç’°å¢ƒã‚’å¯¾è±¡ã¨ã—ã¦ã„ã¾ã™ã€‚
* [Apache MINA SSHD](https://mina.apache.org/sshd-project/index.html) â€“ Apache SSHD javaãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯Apache MINAã«åŸºã¥ã„ã¦ã„ã¾ã™ã€‚
* [paramiko](https://github.com/paramiko/paramiko) â€“ Python SSHv2ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

## åˆ—æŒ™

### ãƒãƒŠãƒ¼ã®å–å¾—
```bash
nc -vn <IP> 22
```
### è‡ªå‹•åŒ–ã•ã‚ŒãŸssh-audit

ssh-auditã¯ã€sshã‚µãƒ¼ãƒãƒ¼ãŠã‚ˆã³ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®è¨­å®šç›£æŸ»ã®ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

[https://github.com/jtesta/ssh-audit](https://github.com/jtesta/ssh-audit)ã¯ã€[https://github.com/arthepsy/ssh-audit/](https://github.com/arthepsy/ssh-audit/)ã‹ã‚‰æ›´æ–°ã•ã‚ŒãŸãƒ•ã‚©ãƒ¼ã‚¯ã§ã™ã€‚

**ç‰¹å¾´:**

* SSH1ãŠã‚ˆã³SSH2ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚µãƒ¼ãƒãƒ¼ã‚µãƒãƒ¼ãƒˆ
* SSHã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®è¨­å®šã‚’åˆ†æ
* ãƒãƒŠãƒ¼ã‚’å–å¾—ã—ã€ãƒ‡ãƒã‚¤ã‚¹ã¾ãŸã¯ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¨ã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã‚’èªè­˜ã—ã€åœ§ç¸®ã‚’æ¤œå‡º
* ã‚­ãƒ¼ã‚¨ã‚¯ã‚¹ãƒã‚§ãƒ³ã‚¸ã€ãƒ›ã‚¹ãƒˆã‚­ãƒ¼ã€æš—å·åŒ–ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸èªè¨¼ã‚³ãƒ¼ãƒ‰ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’åé›†
* ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ æƒ…å ±ã‚’å‡ºåŠ›ï¼ˆåˆ©ç”¨å¯èƒ½ãªæœŸé–“ã€å‰Šé™¤/ç„¡åŠ¹åŒ–ã€å®‰å…¨ã§ãªã„/å¼±ã„/ãƒ¬ã‚¬ã‚·ãƒ¼ãªã©ï¼‰
* ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®æ¨å¥¨äº‹é …ã‚’å‡ºåŠ›ï¼ˆèªè­˜ã•ã‚ŒãŸã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«åŸºã¥ã„ã¦è¿½åŠ ã¾ãŸã¯å‰Šé™¤ï¼‰
* ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æƒ…å ±ã‚’å‡ºåŠ›ï¼ˆé–¢é€£ã™ã‚‹å•é¡Œã€å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸCVEãƒªã‚¹ãƒˆãªã©ï¼‰
* ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ æƒ…å ±ã«åŸºã¥ã„ãŸSSHãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®äº’æ›æ€§ã‚’åˆ†æ
* OpenSSHã€Dropbear SSHã€libsshã‹ã‚‰ã®éå»ã®æƒ…å ±
* Linuxã¨Windowsã§å®Ÿè¡Œå¯èƒ½
* ä¾å­˜é–¢ä¿‚ãªã—
```bash
usage: ssh-audit.py [-1246pbcnjvlt] <host>

-1,  --ssh1             force ssh version 1 only
-2,  --ssh2             force ssh version 2 only
-4,  --ipv4             enable IPv4 (order of precedence)
-6,  --ipv6             enable IPv6 (order of precedence)
-p,  --port=<port>      port to connect
-b,  --batch            batch output
-c,  --client-audit     starts a server on port 2222 to audit client
software config (use -p to change port;
use -t to change timeout)
-n,  --no-colors        disable colors
-j,  --json             JSON output
-v,  --verbose          verbose output
-l,  --level=<level>    minimum output level (info|warn|fail)
-t,  --timeout=<secs>   timeout (in seconds) for connection and reading
(default: 5)
$ python3 ssh-audit <IP>
```
### ã‚µãƒ¼ãƒãƒ¼ã®å…¬é–‹SSHã‚­ãƒ¼

```plaintext
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDZz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz6Xz
```bash
ssh-keyscan -t rsa <IP> -p <PORT>
```
### å¼±ã„æš—å·ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

ã“ã‚Œã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ **nmap** ã«ã‚ˆã£ã¦ç™ºè¦‹ã•ã‚Œã¾ã™ã€‚ãŸã ã—ã€**sslscan** ã¾ãŸã¯ **sslyze** ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

### Nmapã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```bash
nmap -p22 <ip> -sC # Send default nmap scripts for SSH
nmap -p22 <ip> -sV # Retrieve version
nmap -p22 <ip> --script ssh2-enum-algos # Retrieve supported algorythms
nmap -p22 <ip> --script ssh-hostkey --script-args ssh_hostkey=full # Retrieve weak keys
nmap -p22 <ip> --script ssh-auth-methods --script-args="ssh.user=root" # Check authentication methods
```
### Shodan

* `ssh`

## ãƒ¦ãƒ¼ã‚¶ãƒ¼åã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€ãŠã‚ˆã³ç§˜å¯†éµã®ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒ

### ãƒ¦ãƒ¼ã‚¶ãƒ¼åã®åˆ—æŒ™

OpenSSHã®ä¸€éƒ¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯ã€ã‚¿ã‚¤ãƒŸãƒ³ã‚°æ”»æ’ƒã‚’ä½¿ç”¨ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’åˆ—æŒ™ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã‚’æ‚ªç”¨ã™ã‚‹ãŸã‚ã«ã€Metasploitãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```
msf> use scanner/ssh/ssh_enumusers
```
### [ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹](../generic-methodologies-and-resources/brute-force.md#ssh)

ä¸€éƒ¨ã®ä¸€èˆ¬çš„ãªsshã®è³‡æ ¼æƒ…å ±ã¯[ã“ã¡ã‚‰](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Default-Credentials/ssh-betterdefaultpasslist.txt)ã¨[ã“ã¡ã‚‰](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Common-Credentials/top-20-common-SSH-passwords.txt)ã«ã‚ã‚Šã¾ã™ã€‚

### ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚­ãƒ¼ã®ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹

ä½¿ç”¨å¯èƒ½ãªsshã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆã‚­ãƒ¼ãŒã‚ã‹ã£ã¦ã„ã‚‹å ´åˆã¯ã€è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚nmapã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚
```
https://nmap.org/nsedoc/scripts/ssh-publickey-acceptance.html
```
ã¾ãŸã¯ã€MSFè£œåŠ©ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼š
```
msf> use scanner/ssh/ssh_identify_pubkeys
```
ã¾ãŸã¯ã€`ssh-keybrute.py`ï¼ˆãƒã‚¤ãƒ†ã‚£ãƒ–ã®Python3ã§ã€è»½é‡ã§ãƒ¬ã‚¬ã‚·ãƒ¼ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã¾ã™ï¼‰ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼š[snowdroppe/ssh-keybrute](https://github.com/snowdroppe/ssh-keybrute)ã€‚

#### ã“ã“ã§æ‚ªåé«˜ã„éµã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š

{% embed url="https://github.com/rapid7/ssh-badkeys/tree/master/authorized" %}

#### å¼±ã„SSHéµ/Debianã®äºˆæ¸¬å¯èƒ½ãªPRNG

ä¸€éƒ¨ã®ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ã€æš—å·è³‡æã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹ãƒ©ãƒ³ãƒ€ãƒ ã‚·ãƒ¼ãƒ‰ã«æ—¢çŸ¥ã®æ¬ é™¥ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒãŒå¯èƒ½ãªéµã‚¹ãƒšãƒ¼ã‚¹ãŒåŠ‡çš„ã«æ¸›å°‘ã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚å¼±ã„PRNGã«ã‚ˆã£ã¦å½±éŸ¿ã‚’å—ã‘ãŸDebianã‚·ã‚¹ãƒ†ãƒ ã§ç”Ÿæˆã•ã‚ŒãŸäº‹å‰ç”Ÿæˆã•ã‚ŒãŸéµã‚»ãƒƒãƒˆã¯ã€ã“ã“ã§å…¥æ‰‹ã§ãã¾ã™ï¼š[g0tmi1k/debian-ssh](https://github.com/g0tmi1k/debian-ssh)ã€‚

è¢«å®³è€…ã®ãƒã‚·ãƒ³ã®æœ‰åŠ¹ãªéµã‚’æ¤œç´¢ã™ã‚‹ãŸã‚ã«ã“ã“ã‚’èª¿ã¹ã‚‹ã¹ãã§ã™ã€‚

### Kerberos

`ssh`ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹**crackmapexec**ã¯ã€`--kerberos`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦**Kerberosã‚’ä»‹ã—ã¦èªè¨¼**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚è©³ç´°ã«ã¤ã„ã¦ã¯ã€`crackmapexec ssh --help`ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

## ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è³‡æ ¼æƒ…å ±

| **ãƒ™ãƒ³ãƒ€ãƒ¼** | **ãƒ¦ãƒ¼ã‚¶ãƒ¼å**                                                                                              | **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰**                                                                                                                                                                                             |
| ------------ | ---------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| APC          | apcã€device                                                                                                | apc                                                                                                                                                                                                       |
| Brocade      | admin                                                                                                      | admin123ã€passwordã€brocadeã€fibranne                                                                                                                                                                     |
| Cisco        | adminã€ciscoã€enableã€hsaã€pixã€pnadminã€ripeopã€rootã€shelladmin                                           | adminã€Admin123ã€defaultã€passwordã€secur4uã€ciscoã€Ciscoã€\_Ciscoã€cisco123ã€C1sco!23ã€Cisco123ã€Cisco1234ã€TANDBERGã€change\_itã€12345ã€ipicsã€pnadminã€diamondã€hsadbã€cã€ccã€attackã€blenderã€changeme |
| Citrix       | rootã€nsrootã€nsmaintã€vdiadminã€kvmã€cliã€admin                                                            | C1trix321ã€nsrootã€nsmaintã€kavizaã€kaviza123ã€freebsdã€publicã€rootadminã€wanscaler                                                                                                                      |
| D-Link       | adminã€user                                                                                                | privateã€adminã€user                                                                                                                                                                                      |
| Dell         | rootã€user1ã€adminã€vkernelã€cli                                                                           | calvinã€123456ã€passwordã€vkernelã€Stor@ge!ã€admin                                                                                                                                                        |
| EMC          | adminã€rootã€sysadmin                                                                                      | EMCPMAdm7nã€Password#1ã€Password123#ã€sysadminã€changemeã€emc                                                                                                                                             |
| HP/3Com      | adminã€rootã€vcxã€appã€spvarã€manageã€hpsupportã€opc\_op                                                    | adminã€passwordã€hpinventã€iMC123ã€pvadminã€passw0rdã€besgroupã€vcxã€niceã€accessã€configã€3V@rparã€3V#rparã€procurveã€badg3r5ã€OpC\_opã€!manageã€!admin                                                  |
| Huawei       | adminã€root                                                                                                | 123456ã€adminã€rootã€Admin123ã€Admin@storageã€Huawei12#$ã€HwDec@01ã€hwosta2.0ã€HuaWei123ã€fsp200@HWã€huawei123                                                                                            |
| IBM          | USERIDã€adminã€managerã€mqmã€db2inst1ã€db2fenc1ã€dausr1ã€db2adminã€iadminã€systemã€deviceã€ufmcliã€customer | PASSW0RDã€passw0rdã€adminã€passwordã€Passw8rdã€iadminã€apcã€123456ã€cust0mer                                                                                                                              |
| Juniper      | netscreen                                                                                                  | netscreen                                                                                                                                                                                                 |
| NetApp       | admin                                                                                                      | netapp123                                                                                                                                                                                                 |
| Oracle       | rootã€oracleã€oravisã€applvisã€ilom-adminã€ilom-operatorã€nm2user                                           | changemeã€ilom-adminã€ilom-operatorã€welcome1ã€oracle                                                                                                                                                     |
| VMware       | vi-adminã€rootã€hqadminã€vmwareã€admin                                                                      | vmwareã€vmw@reã€hqadminã€default                                                                                                                                                                          |

## SSH-MitM

ã‚‚ã—ã€è¢«å®³è€…ãŒãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦SSHã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã™ã‚‹ãŸã‚ã«ãƒ­ãƒ¼ã‚«ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«ã„ã‚‹å ´åˆã€**MitMæ”»æ’ƒã‚’è¡Œã£ã¦èªè¨¼æƒ…å ±ã‚’ç›—ã‚€**ã“ã¨ãŒã§ãã¾ã™ã€‚

**æ”»æ’ƒçµŒè·¯ï¼š**

- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã¯æ”»æ’ƒãƒã‚·ãƒ³ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã¾ã™
- æ”»æ’ƒè€…ã¯SSHã‚µãƒ¼ãƒãƒ¼ã¸ã®æ¥ç¶šè©¦è¡Œã‚’ç›£è¦–ã—ã€ãã‚Œã‚‰ã‚’è‡ªèº«ã®SSHã‚µãƒ¼ãƒãƒ¼ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã—ã¾ã™
- æ”»æ’ƒè€…ã®SSHã‚µãƒ¼ãƒãƒ¼ã¯ã€ã¾ãšã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã‚’ã™ã¹ã¦ãƒ­ã‚°ã«è¨˜éŒ²ã—ã€æ¬¡ã«ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ¥ç¶šã—ãŸã„æ­£è¦ã®SSHã‚µãƒ¼ãƒãƒ¼ã«ã‚³ãƒãƒ³ãƒ‰ã‚’é€ä¿¡ã—ã¦å®Ÿè¡Œã—ã€çµæœã‚’æ­£è¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¿”ã—ã¾ã™

\*\*\*\*[**SSH MITM**](https://github.com/jtesta/ssh-mitm) \*\*\*\*ã¯ã€ä¸Šè¨˜ã§èª¬æ˜ã—ãŸã“ã¨ã‚’æ­£ç¢ºã«è¡Œã„ã¾ã™ã€‚

å®Ÿéš›ã®MitMã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã€ARPã‚¹ãƒ—ãƒ¼ãƒ•ã‚£ãƒ³ã‚°ã€DNSã‚¹ãƒ—ãƒ¼ãƒ•ã‚£ãƒ³ã‚°ãªã©ã®æŠ€è¡“ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚è©³ç´°ã«ã¤ã„ã¦ã¯ã€[**ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¹ãƒ—ãƒ¼ãƒ•ã‚£ãƒ³ã‚°æ”»æ’ƒ**](../generic-methodologies-and-resources/pentesting-network/#spoofing)ã§èª¬æ˜ã•ã‚Œã¦ã„ã¾ã™ã€‚

## è¨­å®šã®èª¤æ§‹æˆ

### rootãƒ­ã‚°ã‚¤ãƒ³

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€ã»ã¨ã‚“ã©ã®SSHã‚µãƒ¼ãƒãƒ¼ã®å®Ÿè£…ã§ã¯rootãƒ­ã‚°ã‚¤ãƒ³ãŒè¨±å¯ã•ã‚Œã¦ã„ã¾ã™ãŒã€ã“ã‚Œã‚’ç„¡åŠ¹ã«ã™ã‚‹ã“ã¨ãŒæ¨å¥¨ã•ã‚Œã¦ã„ã¾ã™ã€‚ãªãœãªã‚‰ã€ã“ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®è³‡æ ¼æƒ…å ±ãŒæ¼æ´©ã—ãŸå ´åˆã€æ”»æ’ƒè€…ã¯ç›´æ¥ç®¡ç†è€…æ¨©é™ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã€ã¾ãŸã€ã“ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¸ã®ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã‚’è¡Œã†ã“ã¨ã‚‚å¯èƒ½ã«ãªã‚‹ãŸã‚ã§ã™ã€‚

**openSSHã§rootãƒ­ã‚°ã‚¤ãƒ³ã‚’ç„¡åŠ¹ã«ã™ã‚‹æ–¹æ³•ï¼š**

1. SSHã‚µãƒ¼ãƒãƒ¼ã®è¨­å®šã‚’ç·¨é›†ã—ã¾ã™ `sudoedit /etc/ssh/sshd_config`
2. `#PermitRootLogin yes` ã‚’ `PermitRootLogin no` ã«å¤‰æ›´ã—ã¾ã™
3. è¨­å®šã®å¤‰æ›´ã‚’åæ˜ ã•ã›ã¾ã™ `sudo systemctl daemon-reload`
4. SSHã‚µãƒ¼ãƒãƒ¼ã‚’å†èµ·å‹•ã—ã¾ã™ `sudo systemctl restart sshd`

### SFTPã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œ

ã‚‚ã†1ã¤ã®ä¸€èˆ¬çš„ãªSSHã®èª¤æ§‹æˆã¯ã€SFTPã®è¨­å®šã§ã‚ˆãè¦‹ã‚‰ã‚Œã¾ã™ã€‚ã»ã¨ã‚“ã©ã®å ´åˆã€SFTPã‚µãƒ¼ãƒãƒ¼ã‚’ä½œæˆã™ã‚‹éš›ã«ã€ç®¡ç†è€…ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ•ã‚¡ã‚¤ãƒ«ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã®SFTPã‚¢ã‚¯ã‚»ã‚¹ã‚’æŒã¤ã“ã¨ã‚’æœ›ã‚“ã§ã„ã¾ã™ãŒã€ãƒã‚·ãƒ³ä¸Šã§ãƒªãƒ¢ãƒ¼ãƒˆã‚·ã‚§ãƒ«ã‚’å–å¾—ã™ã‚‹ã“ã¨ã¯æœ›ã‚“ã§ã„ã¾ã›ã‚“ã€‚ãã®ãŸã‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚·ã‚§ãƒ«ï¼ˆ`/usr/bin/nologin`ã‚„`/usr/bin/false`ãªã©ï¼‰ã‚’å‰²ã‚Šå½“ã¦ã€å½¼ã‚’ã‚¸ã‚§ã‚¤ãƒ«ã«ãƒãƒ¥ãƒ¼ãƒˆãƒªãƒ³ã‚°ã™ã‚‹ã ã‘ã§ã€ã‚·ã‚§ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ã‚„å…¨ä½“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¸ã®ä¹±ç”¨ã‚’é˜²ãã“ã¨ãŒã§ãã‚‹ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚ã—ã‹ã—ã€å½¼ã‚‰ã¯é–“é•ã£ã¦ã„ã¾ã™ã€‚**ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚³ãƒãƒ³ãƒ‰ã‚„ã‚·ã‚§ãƒ«ãŒå®Ÿè¡Œã•ã‚Œã‚‹å‰ã«ã€èªè¨¼å¾Œã™ãã«ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«è¦æ±‚ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™**ã€‚ã—ãŸãŒã£ã¦ã€ã‚·ã‚§ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ã‚’æ‹’å¦ã™ã‚‹ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚·ã‚§ãƒ«ã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹ã«ã¯ã€å˜ã«äº‹å‰ã«ã‚³ãƒãƒ³ãƒ‰ï¼ˆä¾‹ï¼š`/bin/bash`ï¼‰ã‚’å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«è¦æ±‚ã™ã‚‹ã ã‘ã§ã™ã€‚
```
$ ssh -v noraj@192.168.1.94 id
...
Password:
debug1: Authentication succeeded (keyboard-interactive).
Authenticated to 192.168.1.94 ([192.168.1.94]:22).
debug1: channel 0: new [client-session]
debug1: Requesting no-more-sessions@openssh.com
debug1: Entering interactive session.
debug1: pledge: network
debug1: client_input_global_request: rtype hostkeys-00@openssh.com want_reply 0
debug1: Sending command: id
debug1: client_input_channel_req: channel 0 rtype exit-status reply 0
debug1: client_input_channel_req: channel 0 rtype eow@openssh.com reply 0
uid=1000(noraj) gid=100(users) groups=100(users)
debug1: channel 0: free: client-session, nchannels 1
Transferred: sent 2412, received 2480 bytes, in 0.1 seconds
Bytes per second: sent 43133.4, received 44349.5
debug1: Exit status 0

$ ssh noraj@192.168.1.94 /bin/bash
```
ä»¥ä¸‹ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼`noraj`ã®ã‚»ã‚­ãƒ¥ã‚¢ãªSFTPè¨­å®šã®ä¾‹ã§ã™ï¼ˆ`/etc/ssh/sshd_config` - openSSHï¼‰ï¼š

```plaintext
# SFTP Configuration for noraj
Subsystem sftp internal-sftp

Match User noraj
    ChrootDirectory /home/noraj
    ForceCommand internal-sftp
    AllowTcpForwarding no
    X11Forwarding no
    PasswordAuthentication yes
    PermitTunnel no
    PermitTTY no
    PermitUserEnvironment no
    AllowAgentForwarding no
    AllowStreamLocalForwarding no
    ClientAliveInterval 300
    ClientAliveCountMax 2
    UsePAM yes
```

ã“ã®è¨­å®šã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼`noraj`ã«å¯¾ã—ã¦SFTPã®ã¿ã‚’è¨±å¯ã—ã€ãã®ä»–ã®SSHæ©Ÿèƒ½ã‚’åˆ¶é™ã—ã¦ã„ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯è‡ªåˆ†ã®ãƒ›ãƒ¼ãƒ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª`/home/noraj`ã«åˆ¶é™ã•ã‚Œã€å†…éƒ¨ã®SFTPã‚µãƒ¼ãƒãƒ¼ãŒå¼·åˆ¶çš„ã«å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼ãŒæœ‰åŠ¹ã«ãªã£ã¦ãŠã‚Šã€TCPè»¢é€ã‚„X11è»¢é€ã¯è¨±å¯ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ã¾ãŸã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ã®æ¥ç¶šãŒ300ç§’é–“ç„¡åŠ¹ã§ã‚ã‚Œã°åˆ‡æ–­ã•ã‚Œã€æœ€å¤§2å›ã¾ã§å†æ¥ç¶šãŒè¨±å¯ã•ã‚Œã¾ã™ã€‚PAMã‚‚ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚
```
Match User noraj
ChrootDirectory %h
ForceCommand internal-sftp
AllowTcpForwarding no
PermitTunnel no
X11Forwarding no
PermitTTY no
```
ã“ã®è¨­å®šã§ã¯ã€SFTPã®ã¿ã‚’è¨±å¯ã—ã¾ã™ã€‚ã‚·ã‚§ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ã‚’ç„¡åŠ¹ã«ã™ã‚‹ãŸã‚ã«ã€startã‚³ãƒãƒ³ãƒ‰ã‚’å¼·åˆ¶ã—ã€TTYã‚¢ã‚¯ã‚»ã‚¹ã‚‚ç„¡åŠ¹ã«ã—ã¾ã™ã€‚ã¾ãŸã€ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚„ãƒˆãƒ³ãƒãƒªãƒ³ã‚°ã‚‚ã™ã¹ã¦ç„¡åŠ¹ã«ã—ã¾ã™ã€‚

### SFTPãƒˆãƒ³ãƒãƒªãƒ³ã‚°

SFTPã‚µãƒ¼ãƒãƒ¼ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©ãŒã‚ã‚‹å ´åˆã€ä¸€èˆ¬çš„ãªãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’ä½¿ç”¨ã—ã¦ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’ãƒˆãƒ³ãƒãƒªãƒ³ã‚°ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚
```
sudo ssh -L <local_port>:<remote_host>:<remote_port> -N -f <username>@<ip_compromised>
```
### SFTPã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯

**sftp**ã«ã¯ã€Œ**symlink**ã€ã¨ã„ã†ã‚³ãƒãƒ³ãƒ‰ãŒã‚ã‚Šã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€ã‚ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ã«**æ›¸ãè¾¼ã¿æ¨©é™**ãŒã‚ã‚‹å ´åˆã€**ä»–ã®ãƒ•ã‚©ãƒ«ãƒ€/ãƒ•ã‚¡ã‚¤ãƒ«**ã®**ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯**ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãŠãã‚‰ãã€ã‚ãªãŸã¯chrootå†…ã«**é–‰ã˜è¾¼ã‚ã‚‰ã‚Œã¦ã„ã‚‹**ãŸã‚ã€ã“ã‚Œã¯ç‰¹ã«å½¹ã«ç«‹ãŸãªã„ã§ã—ã‚‡ã†ãŒã€ä½œæˆã—ãŸ**ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯**ã«**no-chrootã‚µãƒ¼ãƒ“ã‚¹**ï¼ˆãŸã¨ãˆã°ã€ã‚¦ã‚§ãƒ–ã‹ã‚‰ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹å ´åˆï¼‰ã‹ã‚‰**ã‚¢ã‚¯ã‚»ã‚¹**ã§ãã‚‹å ´åˆã€**ã‚¦ã‚§ãƒ–ã‚’ä»‹ã—ã¦ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã**ã“ã¨ãŒã§ãã¾ã™ã€‚

ãŸã¨ãˆã°ã€æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«ã€Œ**_froot_**ã€ã‹ã‚‰ã€Œ**_/**_ã€ã¸ã®**ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯**ã‚’ä½œæˆã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¾ã™ï¼š
```
sftp> symlink / froot
```
ã‚‚ã—ã‚¦ã‚§ãƒ–çµŒç”±ã§ãƒ•ã‚¡ã‚¤ãƒ« "_froot_" ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹å ´åˆã€ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ«ãƒ¼ãƒˆ ("/") ãƒ•ã‚©ãƒ«ãƒ€ã‚’ãƒªã‚¹ãƒˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### èªè¨¼æ–¹æ³•

é«˜ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç’°å¢ƒã§ã¯ã€å˜ç´”ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã®èªè¨¼ã§ã¯ãªãã€ã‚­ãƒ¼ãƒ™ãƒ¼ã‚¹ã¾ãŸã¯äºŒè¦ç´ èªè¨¼ã®ã¿ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã“ã¨ãŒä¸€èˆ¬çš„ãªæ…£è¡Œã§ã™ã€‚ã—ã‹ã—ã€ã—ã°ã—ã°ã‚ˆã‚Šå¼·åŠ›ãªèªè¨¼æ–¹æ³•ãŒç„¡åŠ¹ã«ã•ã‚Œãšã«æœ‰åŠ¹ã«ã•ã‚Œã¦ã„ã¾ã™ã€‚ã‚ˆãã‚ã‚‹ã‚±ãƒ¼ã‚¹ã¯ã€openSSHã®è¨­å®šã§ `publickey` ã‚’æœ‰åŠ¹ã«ã—ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®èªè¨¼æ–¹æ³•ã«è¨­å®šã™ã‚‹ãŒã€`password` ã‚’ç„¡åŠ¹ã«ã—ãªã„ã“ã¨ã§ã™ã€‚ã—ãŸãŒã£ã¦ã€SSHã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®è©³ç´°ãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€æ”»æ’ƒè€…ã¯ã‚ˆã‚Šå¼±ã„èªè¨¼æ–¹æ³•ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã§ãã¾ã™ã€‚
```
$ ssh -v 192.168.1.94
OpenSSH_8.1p1, OpenSSL 1.1.1d  10 Sep 2019
...
debug1: Authentications that can continue: publickey,password,keyboard-interactive
```
ãŸã¨ãˆã°ã€èªè¨¼ã®å¤±æ•—åˆ¶é™ãŒè¨­å®šã•ã‚Œã¦ãŠã‚Šã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ãƒ¡ã‚½ãƒƒãƒ‰ã«åˆ°é”ã™ã‚‹æ©Ÿä¼šãŒãªã„å ´åˆã€`PreferredAuthentications`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã€ã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å¼·åˆ¶çš„ã«ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```
$ ssh -v 192.168.1.94 -o PreferredAuthentications=password
...
debug1: Next authentication method: password
```
è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¯ã€äºˆæœŸã•ã‚Œã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã®ã¿ãŒæ‰¿èªã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«å¿…è¦ã§ã™ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§è©³ç´°ãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€è¨­å®šã®åŠ¹æœã‚’ç¢ºèªã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚

### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
```
ssh_config
sshd_config
authorized_keys
ssh_known_hosts
known_hosts
id_rsa
```
## Fuzzing

* [https://packetstormsecurity.com/files/download/71252/sshfuzz.txt](https://packetstormsecurity.com/files/download/71252/sshfuzz.txt)
* [https://www.rapid7.com/db/modules/auxiliary/fuzzers/ssh/ssh\_version\_2](https://www.rapid7.com/db/modules/auxiliary/fuzzers/ssh/ssh\_version\_2)

## References

* You can find interesting guides on how to harden SSH in [https://www.ssh-audit.com/hardening\_guides.html](https://www.ssh-audit.com/hardening\_guides.html)
* [https://community.turgensec.com/ssh-hacking-guide](https://community.turgensec.com/ssh-hacking-guide)

<img src="../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

If you are interested in **hacking career** and hack the unhackable - **we are hiring!** (_fluent polish written and spoken required_).

{% embed url="https://www.stmcyber.com/careers" %}

## HackTricks Automatic Commands

## ãƒ•ã‚¡ã‚¸ãƒ³ã‚°

* [https://packetstormsecurity.com/files/download/71252/sshfuzz.txt](https://packetstormsecurity.com/files/download/71252/sshfuzz.txt)
* [https://www.rapid7.com/db/modules/auxiliary/fuzzers/ssh/ssh\_version\_2](https://www.rapid7.com/db/modules/auxiliary/fuzzers/ssh/ssh\_version\_2)

## å‚è€ƒæ–‡çŒ®

* [https://www.ssh-audit.com/hardening\_guides.html](https://www.ssh-audit.com/hardening\_guides.html) ã§SSHã®å¼·åŒ–ã‚¬ã‚¤ãƒ‰ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
* [https://community.turgensec.com/ssh-hacking-guide](https://community.turgensec.com/ssh-hacking-guide)

<img src="../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt="" data-size="original">

ã‚‚ã—èˆˆå‘³ãŒã‚ã‚‹ãªã‚‰ã€**ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚­ãƒ£ãƒªã‚¢**ã‚’è¿½æ±‚ã—ã€**ç§ãŸã¡ã¯æ¡ç”¨ã—ã¦ã„ã¾ã™ï¼**ï¼ˆæµæš¢ãªãƒãƒ¼ãƒ©ãƒ³ãƒ‰èªã®èª­ã¿æ›¸ããŒå¿…è¦ã§ã™ï¼‰ã€‚

{% embed url="https://www.stmcyber.com/careers" %}

## HackTricksè‡ªå‹•ã‚³ãƒãƒ³ãƒ‰
```
Protocol_Name: SSH
Port_Number: 22
Protocol_Description: Secure Shell Hardening

Entry_1:
Name: Hydra Brute Force
Description: Need Username
Command: hydra -v -V -u -l {Username} -P {Big_Passwordlist} -t 1 {IP} ssh

Entry_2:
Name: consolesless mfs enumeration
Description: SSH enumeration without the need to run msfconsole
Note: sourced from https://github.com/carlospolop/legion
Command: msfconsole -q -x 'use auxiliary/scanner/ssh/ssh_version; set RHOSTS {IP}; set RPORT 22; run; exit' && msfconsole -q -x 'use scanner/ssh/ssh_enumusers; set RHOSTS {IP}; set RPORT 22; run; exit' && msfconsole -q -x 'use auxiliary/scanner/ssh/juniper_backdoor; set RHOSTS {IP}; set RPORT 22; run; exit'

```
<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼šç¤¾**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®PEASSã‚’å…¥æ‰‹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚
* [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€PRã‚’** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>
