# 5671,5672 - Pentesting AMQP

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼šç¤¾**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ**HackTricksã§ä¼šç¤¾ã®åºƒå‘Šã‚’æ²è¼‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**æœ€æ–°ç‰ˆã®PEASSã‚’å…¥æ‰‹**ã—ãŸã‚Šã€**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã¦ãã ã•ã„ã€‚ç§ãŸã¡ã®ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚
* [**å…¬å¼ã®PEASS & HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* **[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã‚„[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ ã™ã‚‹ã‹**ã€**Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã«**ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚³ãƒ„ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€**[**hacktricksãƒªãƒã‚¸ãƒˆãƒª**](https://github.com/carlospolop/hacktricks)ã¨[**hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª**](https://github.com/carlospolop/hacktricks-cloud)ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>

## åŸºæœ¬æƒ…å ±

**RabbitMQ**ã¯ã€_ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ–ãƒ­ãƒ¼ã‚«ãƒ¼_ã¾ãŸã¯_ã‚­ãƒ¥ãƒ¼ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼_ã¨ã—ã¦ã‚‚çŸ¥ã‚‰ã‚Œã‚‹**ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¥ãƒ¼ã‚¤ãƒ³ã‚°ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢**ã§ã™ã€‚ç°¡å˜ã«è¨€ã†ã¨ã€ã‚­ãƒ¥ãƒ¼ãŒå®šç¾©ã•ã‚Œã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ¥ç¶šã—ã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è»¢é€ã™ã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã§ã™ã€‚\
**ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã¯ã‚ã‚‰ã‚†ã‚‹ç¨®é¡ã®æƒ…å ±ã‚’å«ã‚€ã“ã¨ãŒã§ãã¾ã™**ã€‚ä¾‹ãˆã°ã€åˆ¥ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆåˆ¥ã®ã‚µãƒ¼ãƒãƒ¼ä¸Šã«ã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼‰ã§é–‹å§‹ã™ã¹ããƒ—ãƒ­ã‚»ã‚¹ã‚„ã‚¿ã‚¹ã‚¯ã«é–¢ã™ã‚‹æƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã—ã€å˜ãªã‚‹ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã‚ã‚‹å¯èƒ½æ€§ã‚‚ã‚ã‚Šã¾ã™ã€‚ã‚­ãƒ¥ãƒ¼ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¯ã€å—ä¿¡ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ¥ç¶šã—ã¦ã‚­ãƒ¥ãƒ¼ã‹ã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å–ã‚Šå‡ºã™ã¾ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿å­˜ã—ã¾ã™ã€‚ãã®å¾Œã€å—ä¿¡ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡¦ç†ã—ã¾ã™ã€‚\
å®šç¾©ã¯[ã“ã¡ã‚‰](https://www.cloudamqp.com/blog/2015-05-18-part1-rabbitmq-for-beginners-what-is-rabbitmq.html)ã‹ã‚‰ã€‚

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆ**: 5672,5671
```
PORT     STATE SERVICE VERSION
5672/tcp open  amqp    RabbitMQ 3.1.5 (0-9)
```
## åˆ—æŒ™

### æ‰‹å‹•
```python
import amqp
#By default it uses default credentials "guest":"guest"
conn = amqp.connection.Connection(host="<IP>", port=5672, virtual_host="/")
conn.connect()
for k, v in conn.server_properties.items():
print(k, v)
```
### è‡ªå‹•
```bash
nmap -sV -Pn -n -T4 -p 5672 --script amqp-info <IP>

PORT     STATE SERVICE VERSION
5672/tcp open  amqp    RabbitMQ 3.1.5 (0-9)
| amqp-info:
|   capabilities:
|     publisher_confirms: YES
|     exchange_exchange_bindings: YES
|     basic.nack: YES
|     consumer_cancel_notify: YES
|   copyright: Copyright (C) 2007-2013 GoPivotal, Inc.
|   information: Licensed under the MPL.  See http://www.rabbitmq.com/
|   platform: Erlang/OTP
|   product: RabbitMQ
|   version: 3.1.5
|   mechanisms: PLAIN AMQPLAIN
|_  locales: en_US
```
### ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹

* [**AMQPãƒ—ãƒ­ãƒˆã‚³ãƒ« ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹**](../generic-methodologies-and-resources/brute-force.md#amqp-activemq-rabbitmq-qpid-joram-and-solace)
* [**STOMPãƒ—ãƒ­ãƒˆã‚³ãƒ« ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹**](../generic-methodologies-and-resources/brute-force.md#stomp-activemq-rabbitmq-hornetq-and-openmq)

## ãã®ä»–ã®RabbitMQãƒãƒ¼ãƒˆ

[https://www.rabbitmq.com/networking.html](https://www.rabbitmq.com/networking.html) ã‹ã‚‰ã€**rabbitmqãŒè¤‡æ•°ã®ãƒãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹**ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼š

* **1883, 8883**: ([MQTTã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ](http://mqtt.org) TLSãªã—ã¨TLSã‚ã‚Šã€[MQTTãƒ—ãƒ©ã‚°ã‚¤ãƒ³](https://www.rabbitmq.com/mqtt.html)ãŒæœ‰åŠ¹ãªå ´åˆã€‚[**MQTTã®ãƒšãƒ³ãƒ†ã‚¹ãƒˆæ–¹æ³•ã«ã¤ã„ã¦ã¯ã“ã¡ã‚‰ã‚’å‚ç…§ã—ã¦ãã ã•ã„**](1883-pentesting-mqtt-mosquitto.md)ã€‚
* **4369: epmd**, RabbitMQãƒãƒ¼ãƒ‰ã¨CLIãƒ„ãƒ¼ãƒ«ãŒä½¿ç”¨ã™ã‚‹ãƒ”ã‚¢ãƒ‡ã‚£ã‚¹ã‚«ãƒãƒªãƒ¼ã‚µãƒ¼ãƒ“ã‚¹ã€‚[**ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒšãƒ³ãƒ†ã‚¹ãƒˆæ–¹æ³•ã«ã¤ã„ã¦ã¯ã“ã¡ã‚‰ã‚’å‚ç…§ã—ã¦ãã ã•ã„**](4369-pentesting-erlang-port-mapper-daemon-epmd.md)ã€‚
* **5672, 5671**: AMQP 0-9-1ã¨1.0ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒTLSãªã—ã¨TLSã‚ã‚Šã§ä½¿ç”¨
* **15672**: [HTTP API](https://www.rabbitmq.com/management.html)ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã€[ç®¡ç†UI](https://www.rabbitmq.com/management.html)ã€[rabbitmqadmin](https://www.rabbitmq.com/management-cli.html)ï¼ˆ[ç®¡ç†ãƒ—ãƒ©ã‚°ã‚¤ãƒ³](https://www.rabbitmq.com/management.html)ãŒæœ‰åŠ¹ãªå ´åˆã®ã¿ï¼‰ã€‚[**ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒšãƒ³ãƒ†ã‚¹ãƒˆæ–¹æ³•ã«ã¤ã„ã¦ã¯ã“ã¡ã‚‰ã‚’å‚ç…§ã—ã¦ãã ã•ã„**](15672-pentesting-rabbitmq-management.md)ã€‚
* 15674: STOMP-over-WebSocketsã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆ[Web STOMPãƒ—ãƒ©ã‚°ã‚¤ãƒ³](https://www.rabbitmq.com/web-stomp.html)ãŒæœ‰åŠ¹ãªå ´åˆã®ã¿ï¼‰
* 15675: MQTT-over-WebSocketsã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆ[Web MQTTãƒ—ãƒ©ã‚°ã‚¤ãƒ³](https://www.rabbitmq.com/web-mqtt.html)ãŒæœ‰åŠ¹ãªå ´åˆã®ã¿ï¼‰
* 15692: Prometheusãƒ¡ãƒˆãƒªã‚¯ã‚¹ï¼ˆ[Prometheusãƒ—ãƒ©ã‚°ã‚¤ãƒ³](https://www.rabbitmq.com/prometheus.html)ãŒæœ‰åŠ¹ãªå ´åˆã®ã¿ï¼‰
* 25672: ãƒãƒ¼ãƒ‰é–“ãŠã‚ˆã³CLIãƒ„ãƒ¼ãƒ«é€šä¿¡ç”¨ï¼ˆErlangé…å¸ƒã‚µãƒ¼ãƒãƒ¼ãƒãƒ¼ãƒˆï¼‰ã§ã€å‹•çš„ç¯„å›²ã‹ã‚‰å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¾ã™ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯å˜ä¸€ã®ãƒãƒ¼ãƒˆã«é™å®šã•ã‚Œã€AMQPãƒãƒ¼ãƒˆ+20000ã¨ã—ã¦è¨ˆç®—ã•ã‚Œã¾ã™ï¼‰ã€‚å¤–éƒ¨æ¥ç¶šãŒæœ¬å½“ã«å¿…è¦ã§ãªã„é™ã‚Šï¼ˆä¾‹ãˆã°ã€ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼ãŒ[ãƒ•ã‚§ãƒ‡ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³](https://www.rabbitmq.com/federation.html)ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã€ã¾ãŸã¯ã‚µãƒ–ãƒãƒƒãƒˆå¤–ã®ãƒã‚·ãƒ³ã§CLIãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆï¼‰ã€ã“ã‚Œã‚‰ã®ãƒãƒ¼ãƒˆã¯å…¬é–‹ã•ã‚Œã‚‹ã¹ãã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚è©³ç´°ã¯[ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰](https://www.rabbitmq.com/networking.html)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚**ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã§é–‹ã‹ã‚Œã¦ã„ã‚‹ã®ã¯ã“ã‚Œã‚‰ã®ãƒãƒ¼ãƒˆã®ã†ã¡9ã¤ã ã‘ã§ã™**ã€‚
* 35672-35682: CLIãƒ„ãƒ¼ãƒ«ãŒãƒãƒ¼ãƒ‰ã¨é€šä¿¡ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã™ã‚‹ï¼ˆErlangé…å¸ƒã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒãƒ¼ãƒˆï¼‰ã§ã€å‹•çš„ç¯„å›²ã‹ã‚‰å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¾ã™ï¼ˆã‚µãƒ¼ãƒãƒ¼é…å¸ƒãƒãƒ¼ãƒˆ+10000ã‹ã‚‰ã‚µãƒ¼ãƒãƒ¼é…å¸ƒãƒãƒ¼ãƒˆ+10010ã¾ã§è¨ˆç®—ã•ã‚Œã¾ã™ï¼‰ã€‚è©³ç´°ã¯[ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰](https://www.rabbitmq.com/networking.html)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
* 61613, 61614: [STOMPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ](https://stomp.github.io/stomp-specification-1.2.html) TLSãªã—ã¨TLSã‚ã‚Šï¼ˆ[STOMPãƒ—ãƒ©ã‚°ã‚¤ãƒ³](https://www.rabbitmq.com/stomp.html)ãŒæœ‰åŠ¹ãªå ´åˆã®ã¿ï¼‰ã€‚ã“ã®ãƒãƒ¼ãƒˆã‚’é–‹ã„ã¦ã„ã‚‹ãƒ‡ãƒã‚¤ã‚¹ã¯10å°æœªæº€ã§ã€ã»ã¨ã‚“ã©ãŒDHTãƒãƒ¼ãƒ‰ã®UDPã§ã™ã€‚

## Shodan

* `AMQP`

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼šç¤¾**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ**HackTricksã«ã‚ãªãŸã®ä¼šç¤¾ã‚’åºƒå‘Šã—ãŸã„ã§ã™ã‹ï¼Ÿ** ã¾ãŸã¯ã€**æœ€æ–°ã®PEASSãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„ã§ã™ã‹ï¼Ÿ** [**ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã¦ãã ã•ã„ã€‚ç§ãŸã¡ã®ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚
* [**å…¬å¼ã®PEASS & HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* **[**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã‚„[**ãƒ†ãƒ¬ã‚°ãƒ©ãƒ ã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ ã™ã‚‹ã‹ã€** Twitter **[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã«**ãƒ•ã‚©ãƒ­ãƒ¼ã—ã¦ãã ã•ã„ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ã‚³ãƒ„ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã€** [**hacktricksãƒªãƒã‚¸ãƒˆãƒª**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª**](https://github.com/carlospolop/hacktricks-cloud) **ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>
