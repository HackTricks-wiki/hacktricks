<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚

- [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚

- [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**

- **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[hacktricksãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks)ã¨[hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks-cloud)ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>


# **ãƒ—ãƒ­ãƒˆã‚³ãƒ«æƒ…å ±**

EtherNet/IPã«é–¢ã™ã‚‹Wikipediaã®è¨˜äº‹ã‹ã‚‰å¼•ç”¨ [http://en.wikipedia.org/wiki/EtherNet/IP](http://en.wikipedia.org/wiki/EtherNet/IP)

> EtherNet/IPã¯ã€Rockwell Automationã«ã‚ˆã£ã¦1990å¹´ä»£å¾ŒåŠã«é–‹ç™ºã•ã‚Œã€Rockwellã®ç”£æ¥­ç”¨ã‚¤ãƒ¼ã‚µãƒãƒƒãƒˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã®ä¸€éƒ¨ã¨ã—ã¦é–‹ç™ºã•ã‚Œã¾ã—ãŸã€‚Rockwellã¯EtherNet/IPã¨ã„ã†åå‰ã‚’ä»˜ã‘ã€ç¾åœ¨ã¯ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ç®¡ç†ã—ã€æ–°ã—ã„ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’åˆ©ç”¨ã™ã‚‹è£½å“ãŒé–‹ç™ºã•ã‚Œã‚‹éš›ã«ã¯ã€ç¢ºç«‹ã•ã‚ŒãŸæ¨™æº–ã«æº–æ‹ ã™ã‚‹ã“ã¨ã‚’è¦æ±‚ã—ã¦ã€ãƒãƒ«ãƒãƒ™ãƒ³ãƒ€ãƒ¼ã‚·ã‚¹ãƒ†ãƒ ã®ç›¸äº’é‹ç”¨æ€§ã‚’ä¿è¨¼ã—ã¦ã„ã¾ã™ã€‚

> EtherNet/IPã¯ã€ä¸»ã«æ°´å‡¦ç†ãƒ—ãƒ©ãƒ³ãƒˆã€è£½é€ æ–½è¨­ã€å…¬ç›Šäº‹æ¥­ãªã©ã®ç”£æ¥­ç”¨è‡ªå‹•åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ ã§æœ€ã‚‚ä¸€èˆ¬çš„ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚ã„ãã¤ã‹ã®åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ ãƒ™ãƒ³ãƒ€ãƒ¼ã¯ã€EtherNet/IPã‚’ä»‹ã—ã¦é€šä¿¡ã§ãã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ–ãƒ«ã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã¨I/Oã‚’é–‹ç™ºã—ã¦ã„ã¾ã™ã€‚

EtherNet/IPãƒ‡ãƒã‚¤ã‚¹ã¯ã€TCP/44818ã‚’ã‚¯ã‚¨ãƒªã™ã‚‹ã“ã¨ã§æ­£ç¢ºã«è­˜åˆ¥ã•ã‚Œã¾ã™ã€‚ãƒªã‚¹ãƒˆIdentitiesãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆ0x63ï¼‰ã‚’ä½¿ç”¨ã—ã¦ã€å¿œç­”ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒEtherNet/IPãƒ‡ãƒã‚¤ã‚¹ã§ã‚ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤æ–­ã—ã€ãƒ‡ãƒã‚¤ã‚¹ã‚’åˆ—æŒ™ã™ã‚‹ãŸã‚ã®æƒ…å ±ã‚’è§£æã—ã¾ã™ã€‚\
[ã“ã“ã‹ã‚‰](https://github.com/digitalbond/Redpoint)

**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒãƒ¼ãƒˆ:** 44818 UDP/TCP
```
PORT      STATE SERVICE
44818/tcp open  EtherNet/IP
```
# **åˆ—æŒ™**

---

## **Ethernet/IP**

---

Ethernet/IP (Industrial Protocol) is a communication protocol widely used in industrial automation systems. It is based on the Common Industrial Protocol (CIP) and uses the TCP/IP stack for communication.

### **Protocol Overview**

Ethernet/IP uses the CIP protocol to exchange data between devices in an industrial network. It supports various types of devices, including programmable logic controllers (PLCs), human-machine interfaces (HMIs), and sensors.

The protocol operates at the application layer of the TCP/IP stack and uses the User Datagram Protocol (UDP) and Transmission Control Protocol (TCP) for communication. UDP is used for multicast and broadcast messages, while TCP is used for unicast messages.

### **Enumeration Techniques**

To enumerate Ethernet/IP devices, you can use the following techniques:

1. **ARP Scanning**: Send an Address Resolution Protocol (ARP) request to the network to discover Ethernet/IP devices. This technique is effective for devices on the same subnet.

2. **Port Scanning**: Perform a port scan on the target IP addresses to identify open ports associated with Ethernet/IP services. Common ports used by Ethernet/IP include TCP port 44818 and UDP port 2222.

3. **Banner Grabbing**: Connect to the target device's open ports and retrieve the banners or service information. This can provide valuable information about the device and its Ethernet/IP services.

4. **Protocol-Specific Tools**: Use specialized tools like `nmap` or `Wireshark` with Ethernet/IP protocol support to perform enumeration and analysis of Ethernet/IP devices.

### **Enumeration Results**

During the enumeration process, you may discover the following information about Ethernet/IP devices:

- IP addresses and MAC addresses of the devices
- Open ports associated with Ethernet/IP services
- Device names and descriptions
- Firmware versions and software information
- Network topology and device relationships

This information can be used to further analyze and exploit the Ethernet/IP devices during a penetration test.

---

## **Ethernet/IP**

---

Ethernet/IPï¼ˆIndustrial Protocolï¼‰ã¯ã€ç”£æ¥­ã‚ªãƒ¼ãƒˆãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã§åºƒãä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹é€šä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã™ã€‚ã“ã‚Œã¯Common Industrial Protocolï¼ˆCIPï¼‰ã«åŸºã¥ã„ã¦ãŠã‚Šã€é€šä¿¡ã«ã¯TCP/IPã‚¹ã‚¿ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚

### **ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®æ¦‚è¦**

Ethernet/IPã¯ã€ç”£æ¥­ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã®ãƒ‡ãƒã‚¤ã‚¹é–“ã§ãƒ‡ãƒ¼ã‚¿ã‚’äº¤æ›ã™ã‚‹ãŸã‚ã«CIPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ–ãƒ«ãƒ­ã‚¸ãƒƒã‚¯ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ï¼ˆPLCï¼‰ã€äººé–“æ©Ÿæ¢°ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆHMIï¼‰ã€ã‚»ãƒ³ã‚µãƒ¼ãªã©ã€ã•ã¾ã–ã¾ãªã‚¿ã‚¤ãƒ—ã®ãƒ‡ãƒã‚¤ã‚¹ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

ã“ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¯ã€TCP/IPã‚¹ã‚¿ãƒƒã‚¯ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã§å‹•ä½œã—ã€é€šä¿¡ã«ã¯User Datagram Protocolï¼ˆUDPï¼‰ã¨Transmission Control Protocolï¼ˆTCPï¼‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚UDPã¯ãƒãƒ«ãƒã‚­ãƒ£ã‚¹ãƒˆã‚„ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ä½¿ç”¨ã•ã‚Œã€TCPã¯ãƒ¦ãƒ‹ã‚­ãƒ£ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

### **åˆ—æŒ™ã®æ‰‹æ³•**

Ethernet/IPãƒ‡ãƒã‚¤ã‚¹ã‚’åˆ—æŒ™ã™ã‚‹ãŸã‚ã«ã€æ¬¡ã®æ‰‹æ³•ã‚’ä½¿ç”¨ã§ãã¾ã™ï¼š

1. **ARPã‚¹ã‚­ãƒ£ãƒ³**ï¼šãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«Address Resolution Protocolï¼ˆARPï¼‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¦ã€Ethernet/IPãƒ‡ãƒã‚¤ã‚¹ã‚’æ¤œå‡ºã—ã¾ã™ã€‚ã“ã®æ‰‹æ³•ã¯ã€åŒã˜ã‚µãƒ–ãƒãƒƒãƒˆä¸Šã®ãƒ‡ãƒã‚¤ã‚¹ã«å¯¾ã—ã¦åŠ¹æœçš„ã§ã™ã€‚

2. **ãƒãƒ¼ãƒˆã‚¹ã‚­ãƒ£ãƒ³**ï¼šå¯¾è±¡ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¯¾ã—ã¦ãƒãƒ¼ãƒˆã‚¹ã‚­ãƒ£ãƒ³ã‚’å®Ÿè¡Œã—ã€Ethernet/IPã‚µãƒ¼ãƒ“ã‚¹ã«é–¢é€£ä»˜ã‘ã‚‰ã‚ŒãŸã‚ªãƒ¼ãƒ—ãƒ³ãƒãƒ¼ãƒˆã‚’ç‰¹å®šã—ã¾ã™ã€‚Ethernet/IPã§ä½¿ç”¨ã•ã‚Œã‚‹ä¸€èˆ¬çš„ãªãƒãƒ¼ãƒˆã«ã¯ã€TCPãƒãƒ¼ãƒˆ44818ã¨UDPãƒãƒ¼ãƒˆ2222ãŒã‚ã‚Šã¾ã™ã€‚

3. **ãƒãƒŠãƒ¼ã‚°ãƒ©ãƒ“ãƒ³ã‚°**ï¼šå¯¾è±¡ãƒ‡ãƒã‚¤ã‚¹ã®ã‚ªãƒ¼ãƒ—ãƒ³ãƒãƒ¼ãƒˆã«æ¥ç¶šã—ã€ãƒãƒŠãƒ¼ã‚„ã‚µãƒ¼ãƒ“ã‚¹æƒ…å ±ã‚’å–å¾—ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ‡ãƒã‚¤ã‚¹ã¨ãã®Ethernet/IPã‚µãƒ¼ãƒ“ã‚¹ã«é–¢ã™ã‚‹è²´é‡ãªæƒ…å ±ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚

4. **ãƒ—ãƒ­ãƒˆã‚³ãƒ«å›ºæœ‰ã®ãƒ„ãƒ¼ãƒ«**ï¼šEthernet/IPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹`nmap`ã‚„`Wireshark`ãªã©ã®å°‚ç”¨ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã€Ethernet/IPãƒ‡ãƒã‚¤ã‚¹ã®åˆ—æŒ™ã¨åˆ†æã‚’è¡Œã„ã¾ã™ã€‚

### **åˆ—æŒ™ã®çµæœ**

åˆ—æŒ™ãƒ—ãƒ­ã‚»ã‚¹ä¸­ã«ã€Ethernet/IPãƒ‡ãƒã‚¤ã‚¹ã«é–¢ã™ã‚‹æ¬¡ã®æƒ…å ±ã‚’ç™ºè¦‹ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ï¼š

- ãƒ‡ãƒã‚¤ã‚¹ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¨MACã‚¢ãƒ‰ãƒ¬ã‚¹
- Ethernet/IPã‚µãƒ¼ãƒ“ã‚¹ã«é–¢é€£ä»˜ã‘ã‚‰ã‚ŒãŸã‚ªãƒ¼ãƒ—ãƒ³ãƒãƒ¼ãƒˆ
- ãƒ‡ãƒã‚¤ã‚¹ã®åå‰ã¨èª¬æ˜
- ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢æƒ…å ±
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ãƒˆãƒãƒ­ã‚¸ãƒ¼ã¨ãƒ‡ãƒã‚¤ã‚¹ã®é–¢ä¿‚

ã“ã®æƒ…å ±ã¯ã€ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆä¸­ã«Ethernet/IPãƒ‡ãƒã‚¤ã‚¹ã‚’ã•ã‚‰ã«åˆ†æã—ã€æ‚ªç”¨ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã¾ã™ã€‚
```bash
nmap -n -sV --script enip-info -p 44818 <IP>
pip3 install cpppo
python3 -m cpppo.server.enip.list_services [--udp] [--broadcast] --list-identity -a <IP>
```
# Shodan

* `port:44818 "è£½å“å"`


<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ** HackTricksã§**ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼

- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã¾ã—ã‚‡ã†ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚

- [**å…¬å¼ã®PEASSï¼†HackTricksã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚

- [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€[hacktricksãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks)ã¨[hacktricks-cloudãƒªãƒã‚¸ãƒˆãƒª](https://github.com/carlospolop/hacktricks-cloud)**ã«PRã‚’æå‡ºã—ã¦ãã ã•ã„ã€‚

</details>
