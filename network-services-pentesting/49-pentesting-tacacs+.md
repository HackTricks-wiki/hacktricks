# 49 - Pentesting TACACS+

<details>

<summary><strong>Aprende hacking en AWS de cero a h茅roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆gueme** en **Twitter**  [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Informaci贸n B谩sica

**Terminal Access Controller Access Control System (TACACS)** es un protocolo de seguridad que proporciona validaci贸n centralizada de usuarios que intentan obtener **acceso a un router o NAS**. TACACS+, una versi贸n m谩s reciente del protocolo TACACS original, proporciona servicios separados de autenticaci贸n, autorizaci贸n y contabilidad (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Puerto predeterminado:** 49

## Interceptaci贸n de la Clave de Autenticaci贸n

Si un atacante intercepta la comunicaci贸n entre el cliente y el servidor TACACS, la **clave de autenticaci贸n cifrada puede ser interceptada**. El atacante puede entonces intentar un **ataque de fuerza bruta local contra la clave sin ser detectado en los registros**. Si tiene 茅xito en descifrar la clave, el atacante obtiene acceso al equipo de red y puede descifrar el tr谩fico utilizando herramientas como Wireshark.

### Realizaci贸n de un Ataque MitM

Un **ataque de suplantaci贸n ARP puede ser utilizado para realizar un ataque de Hombre en el Medio (MitM)**.

### Fuerza Bruta de la Clave

[Loki](https://c0decafe.de/svn/codename\_loki/trunk/) puede ser utilizado para realizar la fuerza bruta de la clave:
```
sudo loki_gtk.py
```
Si la clave se **bruteforcea** con 茅xito (**generalmente en formato encriptado MD5**), **podemos acceder al equipo y descifrar el tr谩fico encriptado con TACACS.**

### Descifrando el Tr谩fico
Una vez que la clave se ha descifrado con 茅xito, el siguiente paso es **descifrar el tr谩fico encriptado con TACACS**. Wireshark puede manejar el tr谩fico TACACS encriptado si se proporciona la clave. Al analizar el tr谩fico descifrado, se puede obtener informaci贸n como el **banner utilizado y el nombre de usuario del administrador**.

Al obtener acceso al panel de control del equipo de red utilizando las credenciales obtenidas, el atacante puede ejercer control sobre la red. Es importante se帽alar que estas acciones son estrictamente para fines educativos y no deben utilizarse sin la debida autorizaci贸n.

## Referencias

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)


<details>

<summary><strong>Aprende hacking en AWS de cero a h茅roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver a tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** Consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Consigue el [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n de [**NFTs**](https://opensea.io/collection/the-peass-family) exclusivos
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sigue** a **Twitter**  [**@carlospolopm**](https://twitter.com/carlospolopm)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de github de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
