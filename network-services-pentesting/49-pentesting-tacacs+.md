# 49 - Pentesting TACACS+

<details>

<summary><strong>Aprende hacking en AWS de cero a h茅roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Experto en Red de HackTricks AWS)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** Consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Obt茅n la [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆guenos** en **Twitter**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

## Informaci贸n B谩sica

El protocolo **Terminal Access Controller Access Control System (TACACS)** se utiliza para validar de forma centralizada a los usuarios que intentan acceder a routers o Servidores de Acceso a la Red (NAS). Su versi贸n mejorada, **TACACS+**, separa los servicios en autenticaci贸n, autorizaci贸n y contabilidad (AAA).
```
PORT   STATE  SERVICE
49/tcp open   tacacs
```
**Puerto predeterminado:** 49

## Interceptar la clave de autenticaci贸n

Si la comunicaci贸n entre el cliente y el servidor TACACS es interceptada por un atacante, la **clave de autenticaci贸n encriptada puede ser interceptada**. El atacante puede intentar entonces un **ataque de fuerza bruta local contra la clave sin ser detectado en los registros**. Si tiene 茅xito en el ataque de fuerza bruta a la clave, el atacante obtiene acceso al equipo de red y puede descifrar el tr谩fico utilizando herramientas como Wireshark.

### Realizaci贸n de un ataque MitM

Un ataque de suplantaci贸n de ARP puede ser utilizado para realizar un ataque de Hombre en el Medio (MitM).

### Ataque de fuerza bruta a la clave

[Loki](https://c0decafe.de/svn/codename\_loki/trunk/) puede ser utilizado para realizar un ataque de fuerza bruta a la clave:
```
sudo loki_gtk.py
```
Si la clave se **descifra con 茅xito** (**generalmente en formato encriptado MD5)**, **podemos acceder al equipo y descifrar el tr谩fico encriptado de TACACS.**

### Descifrando el Tr谩fico
Una vez que la clave se ha descifrado con 茅xito, el siguiente paso es **descifrar el tr谩fico encriptado de TACACS**. Wireshark puede manejar el tr谩fico encriptado de TACACS si se proporciona la clave. Al analizar el tr谩fico descifrado, se pueden obtener informaci贸n como el **banner utilizado y el nombre de usuario del usuario administrador**.

Al obtener acceso al panel de control del equipo de red utilizando las credenciales obtenidas, el atacante puede ejercer control sobre la red. Es importante tener en cuenta que estas acciones son estrictamente con fines educativos y no deben utilizarse sin la autorizaci贸n adecuada.

## Referencias

* [https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9](https://medium.com/@in9uz/cisco-nightmare-pentesting-cisco-networks-like-a-devil-f4032eb437b9)


<details>

<summary><strong>Aprende a hackear AWS de cero a h茅roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** 隆Consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Obt茅n la [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆guenos** en **Twitter**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github.

</details>
