# 4786 - Cisco Smart Install

<details>

<summary><strong>Aprende hacking de AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Experto en Red Team de AWS de HackTricks)</strong></a><strong>!</strong></summary>

* ¬øTrabajas en una **empresa de ciberseguridad**? ¬øQuieres ver tu **empresa anunciada en HackTricks**? ¬øO quieres tener acceso a la **√∫ltima versi√≥n del PEASS o descargar HackTricks en PDF**? ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obt√©n el [**swag oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* **√önete al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

## Informaci√≥n B√°sica

**Cisco Smart Install** es un dise√±o de Cisco para automatizar la configuraci√≥n inicial y la carga de una imagen del sistema operativo para nuevo hardware de Cisco. **De forma predeterminada, Cisco Smart Install est√° activo en el hardware de Cisco y utiliza el protocolo de capa de transporte, TCP, con el n√∫mero de puerto 4786.**

**Puerto predeterminado:** 4786
```
PORT      STATE  SERVICE
4786/tcp  open   smart-install
```
## **Herramienta de Explotaci√≥n de Smart Install**

**En 2018, se encontr√≥ una vulnerabilidad cr√≠tica, CVE-2018‚Äì0171, en este protocolo. El nivel de amenaza es de 9.8 en la escala CVSS.**

**Un paquete especialmente dise√±ado enviado al puerto TCP/4786, donde est√° activo el Cisco Smart Install, desencadena un desbordamiento de b√∫fer, lo que permite a un atacante:**

* reiniciar forzosamente el dispositivo
* llamar a RCE
* robar configuraciones de equipos de red.

**El** [**SIET**](https://github.com/frostbits-security/SIET) **(Herramienta de Explotaci√≥n de Smart Install)** fue desarrollado para explotar esta vulnerabilidad, lo que te permite abusar de Cisco Smart Install. En este art√≠culo te mostrar√© c√≥mo puedes leer un archivo de configuraci√≥n leg√≠timo de hardware de red. La configuraci√≥n de exfiltraci√≥n puede ser valiosa para un pentester porque aprender√° sobre las caracter√≠sticas √∫nicas de la red. Y esto facilitar√° la vida y permitir√° encontrar nuevos vectores para un ataque.

**El dispositivo objetivo ser√° un switch Cisco Catalyst 2960 "en vivo". Las im√°genes virtuales no tienen Cisco Smart Install, por lo que solo puedes practicar en el hardware real.**

La direcci√≥n del switch objetivo es **10.10.100.10 y CSI est√° activo.** Carga SIET y comienza el ataque. **El argumento -g** significa exfiltraci√≥n de la configuraci√≥n del dispositivo, **el argumento -i** te permite establecer la direcci√≥n IP del objetivo vulnerable.
```
~/opt/tools/SIET$ sudo python2 siet.py -g -i 10.10.100.10
```
<figure><img src="../.gitbook/assets/image (773).png" alt=""><figcaption></figcaption></figure>

La configuraci√≥n del switch **10.10.100.10** estar√° en la carpeta **tftp/**

<figure><img src="../.gitbook/assets/image (1116).png" alt=""><figcaption></figcaption></figure>

<figure><img src="https://pentest.eu/RENDER_WebSec_10fps_21sec_9MB_29042024.gif" alt=""><figcaption></figcaption></figure>

{% embed url="https://websec.nl/" %}

<details>

<summary><strong>Aprende hacking en AWS de cero a h√©roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* ¬øTrabajas en una **empresa de ciberseguridad**? ¬øQuieres ver tu **empresa anunciada en HackTricks**? ¬øO quieres tener acceso a la **√∫ltima versi√≥n del PEASS o descargar HackTricks en PDF**? ¬°Consulta los [**PLANES DE SUSCRIPCI√ìN**](https://github.com/sponsors/carlospolop)!
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci√≥n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* Obt√©n el [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **√önete al** [**üí¨**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s√≠gueme** en **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks\_live)**.**
* **Comparte tus trucos de hacking enviando PRs al** [**repositorio de hacktricks**](https://github.com/carlospolop/hacktricks) **y al** [**repositorio de hacktricks-cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
