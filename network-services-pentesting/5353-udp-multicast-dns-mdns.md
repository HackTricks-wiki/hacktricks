# 5353/UDP Multicast DNS (mDNS) y DNS-SD

<details>

<summary><strong>Aprende hacking en AWS desde cero hasta experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Experto en Equipos Rojos de AWS de HackTricks)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** Consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Obt茅n la [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆guenos** en **Twitter**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositorios de github.

</details>

## **Informaci贸n B谩sica**

**Multicast DNS (mDNS)** permite realizar **operaciones similares a DNS** dentro de redes locales sin necesidad de un servidor DNS tradicional. Opera en el puerto **UDP 5353** y permite a los dispositivos descubrirse mutuamente y sus servicios, com煤nmente visto en varios dispositivos IoT. **Descubrimiento de Servicios DNS (DNS-SD)**, a menudo utilizado junto con mDNS, ayuda a identificar los servicios disponibles en la red a trav茅s de consultas DNS est谩ndar.
```
PORT     STATE SERVICE
5353/udp open  zeroconf
```
### **Operaci贸n de mDNS**

En entornos sin un servidor DNS est谩ndar, mDNS permite a los dispositivos resolver nombres de dominio que terminan en **.local** al consultar la direcci贸n de multidifusi贸n **224.0.0.251** (IPv4) o **FF02::FB** (IPv6). Aspectos importantes de mDNS incluyen un valor de **Tiempo de Vida (TTL)** que indica la validez del registro y un bit **QU** que distingue entre consultas unicast y multicast. En t茅rminos de seguridad, es crucial que las implementaciones de mDNS verifiquen que la direcci贸n de origen del paquete se alinee con la subred local.

### **Funcionamiento de DNS-SD**

DNS-SD facilita el descubrimiento de servicios de red al consultar registros de puntero (PTR) que mapean tipos de servicio a sus instancias. Los servicios se identifican utilizando un patr贸n **_\<Servicio>.\_tcp o \_\<Servicio>.\_udp** dentro del dominio **.local**, lo que lleva al descubrimiento de registros **SRV** y **TXT** correspondientes que proporcionan informaci贸n detallada del servicio.

### **Exploraci贸n de la Red**

#### **Uso de nmap**

Un comando 煤til para escanear la red local en busca de servicios mDNS es:
```bash
nmap -Pn -sUC -p5353 [target IP address]
```
Este comando ayuda a identificar los puertos mDNS abiertos y los servicios anunciados a trav茅s de ellos.

#### **Enumeraci贸n de Red con Pholus**

Para enviar activamente solicitudes mDNS y capturar tr谩fico, la herramienta **Pholus** puede ser utilizada de la siguiente manera:
```bash
sudo python3 pholus3.py [network interface] -rq -stimeout 10
```
## Ataques

### **Explotando la Sonda mDNS**

Un vector de ataque implica enviar respuestas falsificadas a las sondas mDNS, sugiriendo que todos los nombres potenciales ya est谩n en uso, dificultando as铆 que los nuevos dispositivos seleccionen un nombre 煤nico. Esto se puede ejecutar utilizando:
```bash
sudo python pholus.py [network interface] -afre -stimeout 1000
```
Esta t茅cnica bloquea efectivamente que nuevos dispositivos registren sus servicios en la red.

**En resumen**, entender el funcionamiento de mDNS y DNS-SD es crucial para la gesti贸n y seguridad de la red. Herramientas como **nmap** y **Pholus** ofrecen informaci贸n valiosa sobre los servicios de red locales, mientras que la conciencia de las vulnerabilidades potenciales ayuda a protegerse contra ataques.


### Suplantaci贸n de identidad/Ataque de intermediario

El ataque m谩s interesante que puedes realizar sobre este servicio es llevar a cabo un **Ataque de intermediario** en la **comunicaci贸n entre el cliente y el servidor real**. Podr铆as obtener archivos sensibles (intermediar la comunicaci贸n con la impresora) o incluso credenciales (autenticaci贸n de Windows).\
Para m谩s informaci贸n, consulta:

{% content-ref url="../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md" %}
[spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md](../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.md)
{% endcontent-ref %}

## Referencias

* [Hacking pr谩ctico de IoT: La gu铆a definitiva para atacar el Internet de las cosas](https://books.google.co.uk/books/about/Practical\_IoT\_Hacking.html?id=GbYEEAAAQBAJ\&redir\_esc=y)

<details>

<summary><strong>Aprende a hackear AWS desde cero hasta convertirte en un experto con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si quieres ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** 隆Consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Obt茅n la [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆guenos** en **Twitter**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los repositorios de** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud).

</details>
